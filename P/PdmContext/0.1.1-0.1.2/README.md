# Comparing `tmp/pdmcontext-0.1.1.tar.gz` & `tmp/pdmcontext-0.1.2.tar.gz`

## Comparing `pdmcontext-0.1.1.tar` & `pdmcontext-0.1.2.tar`

### file list

```diff
@@ -1,35 +1,35 @@
--rw-r--r--   0        0        0    26047 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/ContextClustering.html
--rw-r--r--   0        0        0   109317 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/ContextGeneration.html
--rw-r--r--   0        0        0    28792 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/Pipelines.html
--rw-r--r--   0        0        0  1238528 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/index.html
--rw-r--r--   0        0        0     7227 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/index_old.html
--rw-r--r--   0        0        0     8957 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/causal_discovery_functions.html
--rw-r--r--   0        0        0    54557 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/dbconnector.html
--rw-r--r--   0        0        0    32718 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/distances.html
--rw-r--r--   0        0        0     8085 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/index.html
--rw-r--r--   0        0        0    20025 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/showcontext.html
--rw-r--r--   0        0        0    17227 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/simulate_stream.html
--rw-r--r--   0        0        0    21819 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/Documentation/PdmContext/utils/structure.html
--rw-r--r--   0        0        0   570434 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/Example.ipynb
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/__init__.py
--rw-r--r--   0        0        0      835 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/dummy_data.csv
--rw-r--r--   0        0        0    11537 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/test_main.py
--rw-r--r--   0        0        0   570434 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/.ipynb_checkpoints/Example-checkpoint.ipynb
--rw-r--r--   0        0        0     8610 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/.ipynb_checkpoints/test_main-checkpoint.py
--rw-r--r--   0        0        0     5371 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/ContextClustering.py
--rw-r--r--   0        0        0    27967 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/ContextGeneration.py
--rw-r--r--   0        0        0     5607 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/Pipelines.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/__init__.py
--rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/__init__.py
--rw-r--r--   0        0        0      716 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/causal_discovery_functions.py
--rw-r--r--   0        0        0    11063 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/dbconnector.py
--rw-r--r--   0        0        0    10398 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/distances.py
--rw-r--r--   0        0        0     5146 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/showcontext.py
--rw-r--r--   0        0        0     3847 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/simulate_stream.py
--rw-r--r--   0        0        0     4105 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/PdmContext/utils/structure.py
--rw-r--r--   0        0        0    68806 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/images/CDextraction.png
--rw-r--r--   0        0        0    68806 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/src/images/.ipynb_checkpoints/CDextraction-checkpoint.png
--rw-r--r--   0        0        0      219 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/.gitignore
--rw-r--r--   0        0        0     1913 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/README.md
--rw-r--r--   0        0        0     1069 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/pyproject.toml
--rw-r--r--   0        0        0     2930 2020-02-02 00:00:00.000000 pdmcontext-0.1.1/PKG-INFO
+-rw-r--r--   0        0        0    26047 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/ContextClustering.html
+-rw-r--r--   0        0        0   136236 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/ContextGeneration.html
+-rw-r--r--   0        0        0    28792 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/Pipelines.html
+-rw-r--r--   0        0        0  1238528 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/index.html
+-rw-r--r--   0        0        0     7227 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/index_old.html
+-rw-r--r--   0        0        0     8957 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/causal_discovery_functions.html
+-rw-r--r--   0        0        0    54557 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/dbconnector.html
+-rw-r--r--   0        0        0    40517 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/distances.html
+-rw-r--r--   0        0        0     8085 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/index.html
+-rw-r--r--   0        0        0    20025 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/showcontext.html
+-rw-r--r--   0        0        0    17227 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/simulate_stream.html
+-rw-r--r--   0        0        0    21819 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/Documentation/PdmContext/utils/structure.html
+-rw-r--r--   0        0        0   570434 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/Example.ipynb
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/__init__.py
+-rw-r--r--   0        0        0      835 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/dummy_data.csv
+-rw-r--r--   0        0        0    11537 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/test_main.py
+-rw-r--r--   0        0        0   570434 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/.ipynb_checkpoints/Example-checkpoint.ipynb
+-rw-r--r--   0        0        0     8610 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/.ipynb_checkpoints/test_main-checkpoint.py
+-rw-r--r--   0        0        0     5371 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/ContextClustering.py
+-rw-r--r--   0        0        0    36167 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/ContextGeneration.py
+-rw-r--r--   0        0        0     5607 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/Pipelines.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/__init__.py
+-rw-r--r--   0        0        0        0 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/__init__.py
+-rw-r--r--   0        0        0      716 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/causal_discovery_functions.py
+-rw-r--r--   0        0        0    11063 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/dbconnector.py
+-rw-r--r--   0        0        0    13303 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/distances.py
+-rw-r--r--   0        0        0     5146 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/showcontext.py
+-rw-r--r--   0        0        0     3847 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/simulate_stream.py
+-rw-r--r--   0        0        0     4105 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/PdmContext/utils/structure.py
+-rw-r--r--   0        0        0    68806 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/images/CDextraction.png
+-rw-r--r--   0        0        0    68806 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/src/images/.ipynb_checkpoints/CDextraction-checkpoint.png
+-rw-r--r--   0        0        0      219 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/.gitignore
+-rw-r--r--   0        0        0     1913 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/README.md
+-rw-r--r--   0        0        0     1069 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/pyproject.toml
+-rw-r--r--   0        0        0     2930 2020-02-02 00:00:00.000000 pdmcontext-0.1.2/PKG-INFO
```

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/ContextClustering.html` & `pdmcontext-0.1.2/Documentation/PdmContext/ContextClustering.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/ContextGeneration.html` & `pdmcontext-0.1.2/Documentation/PdmContext/ContextGeneration.html`

 * *Files 12% similar despite different names*

```diff
@@ -369,6465 +369,8147 @@
 00001700: 6e63 7469 6f6e 7320 696d 706f 7274 2063  nctions import c
 00001710: 616c 6375 6c61 7465 5f77 6974 685f 7063  alculate_with_pc
 00001720: 0a66 726f 6d20 5064 6d43 6f6e 7465 7874  .from PdmContext
 00001730: 2e75 7469 6c73 2e73 686f 7763 6f6e 7465  .utils.showconte
 00001740: 7874 2069 6d70 6f72 7420 7368 6f77 5f63  xt import show_c
 00001750: 6f6e 7465 7874 5f6c 6973 742c 2073 686f  ontext_list, sho
 00001760: 775f 636f 6e74 6578 745f 696e 7465 7270  w_context_interp
-00001770: 7265 7461 7469 6f6e 730a 0a0a 636c 6173  retations...clas
-00001780: 7320 436f 6e74 6578 7447 656e 6572 6174  s ContextGenerat
-00001790: 6f72 3a0a 0a20 2020 2064 6566 205f 5f69  or:..    def __i
-000017a0: 6e69 745f 5f28 7365 6c66 2c20 7461 7267  nit__(self, targ
-000017b0: 6574 2c20 636f 6e74 6578 745f 686f 7269  et, context_hori
-000017c0: 7a6f 6e3d 2623 3334 3b38 2623 3334 3b2c  zon=&#34;8&#34;,
-000017d0: 2043 6175 7361 6c69 7479 6675 6e63 743d   Causalityfunct=
-000017e0: 6361 6c63 756c 6174 655f 7769 7468 5f70  calculate_with_p
-000017f0: 632c 2064 6562 7567 3d46 616c 7365 293a  c, debug=False):
-00001800: 0a20 2020 2020 2020 2026 2333 343b 2623  .        &#34;&#
-00001810: 3334 3b26 2333 343b 0a20 2020 2020 2020  34;&#34;.       
-00001820: 2054 6869 7320 436c 6173 7320 6861 6e64   This Class hand
-00001830: 6c65 2074 6865 2043 6f6e 7465 7874 2047  le the Context G
-00001840: 656e 6572 6174 696f 6e2e 2049 7420 6b65  eneration. It ke
-00001850: 6570 7320 616e 2069 6e74 6572 6e61 6c20  eps an internal 
-00001860: 6275 6666 6572 2074 6f20 6275 696c 6420  buffer to build 
-00001870: 7468 6520 636f 6e74 6578 7420 666f 7220  the context for 
-00001880: 6120 7461 7267 6574 2073 6572 6965 7320  a target series 
-00001890: 6261 7365 640a 2020 2020 2020 2020 6f6e  based.        on
-000018a0: 2074 6865 2070 726f 7669 6465 6420 636f   the provided co
-000018b0: 6e74 6578 745f 686f 7269 7a6f 6e2e 2041  ntext_horizon. A
-000018c0: 6c6c 2064 6174 6120 6172 6520 7061 7373  ll data are pass
-000018d0: 6564 2074 686f 7567 6820 7468 6520 636f  ed though the co
-000018e0: 6c6c 6563 745f 6461 7461 206d 6574 686f  llect_data metho
-000018f0: 642c 2077 6869 6368 2072 6574 7572 6e20  d, which return 
-00001900: 6120 636f 7272 6573 706f 6469 6e67 0a20  a correspoding. 
-00001910: 2020 2020 2020 2043 6f6e 7465 7874 2077         Context w
-00001920: 6865 6e20 7461 7267 6574 2064 6174 6120  hen target data 
-00001930: 6172 6520 7061 7373 6564 2e0a 0a0a 2020  are passed....  
-00001940: 2020 2020 2020 2a2a 5061 7261 6d65 7465        **Paramete
-00001950: 7273 2a2a 3a0a 0a20 2020 2020 2020 202a  rs**:..        *
-00001960: 2a74 6172 6765 742a 2a3a 2054 6865 206e  *target**: The n
-00001970: 616d 6520 6f66 2074 6865 2074 6172 6765  ame of the targe
-00001980: 7420 736f 7572 6365 2c20 7768 6963 6820  t source, which 
-00001990: 7769 6c6c 2062 6520 7573 6564 2061 7320  will be used as 
-000019a0: 7468 6520 6261 7365 6c69 6e65 2069 6e20  the baseline in 
-000019b0: 6f72 6465 7220 746f 206d 6170 2064 6966  order to map dif
-000019c0: 6665 7265 6e74 2073 616d 706c 6573 0a20  ferent samples. 
-000019d0: 2020 2020 2020 2020 7261 7465 2074 6f20          rate to 
-000019e0: 7468 6174 206f 6620 7468 6520 7461 7267  that of the targ
-000019f0: 6574 2073 616d 706c 6520 7261 7465 2e0a  et sample rate..
-00001a00: 0a20 2020 2020 2020 202a 2a63 6f6e 7465  .        **conte
-00001a10: 7874 5f68 6f72 697a 6f6e 2a2a 3a20 5468  xt_horizon**: Th
-00001a20: 6520 7469 6d65 2070 6572 696f 6420 746f  e time period to
-00001a30: 206c 6f6f 6b20 6261 636b 2066 6f72 2063   look back for c
-00001a40: 6f6e 7465 7874 2064 6174 612c 2074 6865  ontext data, the
-00001a50: 2066 6f72 6d20 6f66 2074 6861 7420 7061   form of that pa
-00001a60: 7261 6d65 7465 7220 6973 2026 2333 343b  rameter is &#34;
-00001a70: 3820 686f 7572 7326 2333 343b 0a0a 2020  8 hours&#34;..  
-00001a80: 2020 2020 2020 2a2a 4361 7573 616c 6974        **Causalit
-00001a90: 7966 756e 6374 2a2a 3a20 7468 6520 6361  yfunct**: the ca
-00001aa0: 7573 616c 6974 7920 6469 7363 6f76 6572  usality discover
-00001ab0: 7920 6d65 7468 6f64 2074 6f20 7573 6520  y method to use 
-00001ac0: 746f 2070 726f 6475 6365 2063 6175 7361  to produce causa
-00001ad0: 6c20 7265 6c61 7469 6f6e 7368 6970 7320  l relationships 
-00001ae0: 6265 7477 6565 6e20 636f 6e74 6578 7420  between context 
-00001af0: 6461 7461 2c0a 2020 2020 2020 2020 2020  data,.          
-00001b00: 2020 5468 6973 206d 7573 7420 6265 2061    This must be a
-00001b10: 2066 756e 6374 696f 6e20 7769 7468 2070   function with p
-00001b20: 6172 616d 6574 6572 7320 7477 6f20 6571  arameters two eq
-00001b30: 7561 6c20 7369 7a65 206c 6973 7473 2c20  ual size lists, 
-00001b40: 6f6e 6520 7769 7468 206e 616d 6573 2061  one with names a
-00001b50: 6e64 2074 6865 206f 7468 6572 0a20 2020  nd the other.   
-00001b60: 2020 2020 2020 2020 2077 6974 6820 6461           with da
-00001b70: 7461 2028 6120 6c69 7374 206f 6620 6c69  ta (a list of li
-00001b80: 7374 206f 7220 3244 206e 756d 7079 2061  st or 2D numpy a
-00001b90: 7272 6179 292e 0a0a 2020 2020 2020 2020  rray)...        
-00001ba0: 2a2a 6465 6275 672a 2a3a 2049 6620 6974  **debug**: If it
-00001bb0: 2072 756e 7320 6f6e 2064 6562 7567 206d   runs on debug m
-00001bc0: 6f64 650a 2020 2020 2020 2020 2623 3334  ode.        &#34
-00001bd0: 3b26 2333 343b 2623 3334 3b0a 0a20 2020  ;&#34;&#34;..   
-00001be0: 2020 2020 2073 656c 662e 6465 6275 6720       self.debug 
-00001bf0: 3d20 6465 6275 670a 2020 2020 2020 2020  = debug.        
-00001c00: 7365 6c66 2e74 6172 6765 7420 3d20 7461  self.target = ta
-00001c10: 7267 6574 0a0a 2020 2020 2020 2020 7365  rget..        se
-00001c20: 6c66 2e63 6f6e 7465 7874 7320 3d20 5b5d  lf.contexts = []
-00001c30: 0a0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
-00001c40: 6175 7361 6c69 7479 5f64 6973 636f 7665  ausality_discove
-00001c50: 7279 203d 2043 6175 7361 6c69 7479 6675  ry = Causalityfu
-00001c60: 6e63 740a 2020 2020 2020 2020 7365 6c66  nct.        self
-00001c70: 2e62 7566 6665 7220 3d20 5b5d 0a0a 2020  .buffer = []..  
-00001c80: 2020 2020 2020 2320 6865 6c70 6572 730a        # helpers.
-00001c90: 2020 2020 2020 2020 7365 6c66 2e74 7970          self.typ
-00001ca0: 655f 6f66 5f73 6572 6965 7320 3d20 7b7d  e_of_series = {}
-00001cb0: 0a20 2020 2020 2020 2073 656c 662e 686f  .        self.ho
-00001cc0: 7269 7a6f 6e20 3d20 636f 6e74 6578 745f  rizon = context_
-00001cd0: 686f 7269 7a6f 6e2e 7370 6c69 7428 2623  horizon.split(&#
-00001ce0: 3334 3b20 2623 3334 3b29 5b30 5d0a 2020  34; &#34;)[0].  
-00001cf0: 2020 2020 2020 6966 206c 656e 2863 6f6e        if len(con
-00001d00: 7465 7874 5f68 6f72 697a 6f6e 2e73 706c  text_horizon.spl
-00001d10: 6974 2826 2333 343b 2026 2333 343b 2929  it(&#34; &#34;))
-00001d20: 203d 3d20 313a 0a20 2020 2020 2020 2020   == 1:.         
-00001d30: 2020 2073 656c 662e 686f 7269 7a6f 6e5f     self.horizon_
-00001d40: 7469 6d65 203d 2026 2333 343b 686f 7572  time = &#34;hour
-00001d50: 7326 2333 343b 0a20 2020 2020 2020 2065  s&#34;.        e
-00001d60: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00001d70: 2069 6620 636f 6e74 6578 745f 686f 7269   if context_hori
-00001d80: 7a6f 6e2e 7370 6c69 7428 2623 3334 3b20  zon.split(&#34; 
-00001d90: 2623 3334 3b29 5b31 5d20 696e 205b 2623  &#34;)[1] in [&#
-00001da0: 3334 3b64 6179 7326 2333 343b 2c20 2623  34;days&#34;, &#
-00001db0: 3334 3b68 6f75 7273 2623 3334 3b2c 2026  34;hours&#34;, &
-00001dc0: 2333 343b 6d69 6e75 7465 7326 2333 343b  #34;minutes&#34;
-00001dd0: 2c20 2623 3334 3b73 6563 6f6e 6473 2623  , &#34;seconds&#
-00001de0: 3334 3b5d 3a0a 2020 2020 2020 2020 2020  34;]:.          
-00001df0: 2020 2020 2020 7365 6c66 2e68 6f72 697a        self.horiz
-00001e00: 6f6e 5f74 696d 6520 3d20 636f 6e74 6578  on_time = contex
-00001e10: 745f 686f 7269 7a6f 6e2e 7370 6c69 7428  t_horizon.split(
-00001e20: 2623 3334 3b20 2623 3334 3b29 5b31 5d0a  &#34; &#34;)[1].
-00001e30: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00001e40: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00001e50: 2020 6173 7365 7274 2046 616c 7365 2c20    assert False, 
-00001e60: 2623 3334 3b54 696d 6520 686f 7269 7a6f  &#34;Time horizo
-00001e70: 6e20 6d75 7374 2062 6520 6569 7468 6572  n must be either
-00001e80: 2061 2073 696e 676c 6520 6e75 6d62 6572   a single number
-00001e90: 206f 7220 696e 2066 6f72 6d20 6f66 205c   or in form of \
-00001ea0: 2623 3334 3b38 2068 6f75 7273 5c26 2333  &#34;8 hours\&#3
-00001eb0: 343b 2077 6865 7265 2061 6363 6570 7461  4; where accepta
-00001ec0: 626c 6520 7469 6d65 2066 7261 6d65 7320  ble time frames 
-00001ed0: 6172 6520 686f 7572 732c 6461 7973 2c6d  are hours,days,m
-00001ee0: 696e 7574 6573 2c73 6563 6f6e 6473 2623  inutes,seconds&#
-00001ef0: 3334 3b0a 0a20 2020 2020 2020 2073 656c  34;..        sel
-00001f00: 662e 686f 7269 7a6f 6e20 3d20 696e 7428  f.horizon = int(
-00001f10: 7365 6c66 2e68 6f72 697a 6f6e 290a 2020  self.horizon).  
-00001f20: 2020 2020 2020 7365 6c66 2e69 6e74 6572        self.inter
-00001f30: 7072 6574 5f68 6973 746f 7279 5f70 6f73  pret_history_pos
-00001f40: 203d 2030 0a20 2020 2020 2020 2073 656c   = 0.        sel
-00001f50: 662e 636f 6e74 6578 745f 706f 7320 3d20  f.context_pos = 
-00001f60: 300a 0a20 2020 2064 6566 2063 6f6c 6c65  0..    def colle
-00001f70: 6374 5f64 6174 6128 7365 6c66 2c20 7469  ct_data(self, ti
-00001f80: 6d65 7374 616d 702c 2073 6f75 7263 652c  mestamp, source,
-00001f90: 206e 616d 652c 2076 616c 7565 3d4e 6f6e   name, value=Non
-00001fa0: 652c 2074 7970 653d 2623 3334 3b55 6e69  e, type=&#34;Uni
-00001fb0: 7661 7269 6174 6526 2333 343b 293a 0a20  variate&#34;):. 
-00001fc0: 2020 2020 2020 2026 2333 393b 2623 3339         &#39;&#39
-00001fd0: 3b26 2333 393b 0a20 2020 2020 2020 2054  ;&#39;.        T
-00001fe0: 6869 7320 6d65 7468 6f64 2069 7320 7573  his method is us
-00001ff0: 6564 2077 6865 6e20 6461 7461 2061 7265  ed when data are
-00002000: 2070 6173 7365 6420 6974 6572 6174 6976   passed iterativ
-00002010: 656c 792c 2061 6e64 2073 746f 7265 6420  ely, and stored 
-00002020: 696e 2062 7566 6665 720a 2020 2020 2020  in buffer.      
-00002030: 2020 5768 656e 2064 6174 6120 6f66 2074    When data of t
-00002040: 6172 6765 7420 736f 7572 6365 2061 7272  arget source arr
-00002050: 6976 652c 2061 2063 6f72 7265 7370 6f6e  ive, a correspon
-00002060: 6469 6e67 2063 6f6e 7465 7874 2069 7320  ding context is 
-00002070: 7072 6f64 7563 6564 2e0a 2020 2020 2020  produced..      
-00002080: 2020 536f 7572 6365 7320 6361 6e20 6265    Sources can be
-00002090: 206f 6620 6469 6666 6572 656e 7420 7361   of different sa
-000020a0: 6d70 6c65 2072 6174 6520 2861 6c6c 2073  mple rate (all s
-000020b0: 6f75 7263 6573 2061 7265 206d 6170 7065  ources are mappe
-000020c0: 6420 746f 2074 6865 2074 6172 6765 7473  d to the targets
-000020d0: 2073 616d 706c 6520 7261 7465 2077 6865   sample rate whe
-000020e0: 6e20 636f 6e74 6578 7420 6973 2070 726f  n context is pro
-000020f0: 6475 6365 6429 0a0a 2020 2020 2020 2020  duced)..        
-00002100: 536f 7572 6365 7320 6361 6e20 6265 206f  Sources can be o
-00002110: 6620 6569 7468 6572 3a0a 0a20 2020 2020  f either:..     
-00002120: 2020 2031 2920 436f 6e74 696e 756f 7573     1) Continuous
-00002130: 2074 7970 6520 2874 686f 7365 2074 6861   type (those tha
-00002140: 7420 6861 7665 2073 6f6d 6520 6b69 6e64  t have some kind
-00002150: 206f 6620 6172 6974 686d 6574 6963 2076   of arithmetic v
-00002160: 616c 7565 290a 0a20 2020 2020 2020 2032  alue)..        2
-00002170: 2920 4469 7363 7265 7465 2065 7665 6e74  ) Discrete event
-00002180: 7320 2877 6974 686f 7574 2076 616c 7565  s (without value
-00002190: 2920 2c20 7768 6572 6520 6f6e 6520 6f66  ) , where one of
-000021a0: 2074 6865 2074 7970 6520 6973 6f6c 6174   the type isolat
-000021b0: 6564 206f 7220 636f 6e66 6967 7572 6174  ed or configurat
-000021c0: 696f 6e20 6d75 7374 2062 6520 6173 7369  ion must be assi
-000021d0: 676e 6564 0a20 2020 2020 2020 2020 2020  gned.           
-000021e0: 2041 2067 7569 6465 206f 6e20 686f 7720   A guide on how 
-000021f0: 746f 2073 7065 6369 6679 2074 6865 2074  to specify the t
-00002200: 7970 6520 6973 2c20 7468 6174 2065 7665  ype is, that eve
-00002210: 6e74 7320 7768 6963 6820 6173 7375 6d65  nts which assume
-00002220: 6420 746f 2068 6176 6520 696d 7061 6374  d to have impact
-00002230: 206f 6e6c 7920 6f6e 2074 6865 6972 206f   only on their o
-00002240: 6363 7572 7265 6e63 652c 2061 7265 2063  ccurrence, are c
-00002250: 616c 6c65 640a 2020 2020 2020 2020 2020  alled.          
-00002260: 2020 6973 6f6c 6174 6564 2c20 7768 696c    isolated, whil
-00002270: 6520 6f74 6865 7273 2074 6861 7420 6172  e others that ar
-00002280: 6520 7265 6c61 7465 6420 746f 2073 6f6d  e related to som
-00002290: 6520 6b69 6e64 206f 6620 636f 6e66 6967  e kind of config
-000022a0: 7572 6174 696f 6e20 7769 7468 206d 6f72  uration with mor
-000022b0: 6520 7065 726d 616e 656e 7420 696d 7061  e permanent impa
-000022c0: 6374 2c20 6172 6520 6361 6c6c 6564 2063  ct, are called c
-000022d0: 6f6e 6669 6775 7261 7469 6f6e 2e0a 2020  onfiguration..  
-000022e0: 2020 2020 2020 2020 2020 4573 7365 6e74            Essent
-000022f0: 6961 6c6c 7920 7468 6520 7479 7065 206f  ially the type o
-00002300: 6620 7468 6520 6576 656e 7473 2064 6566  f the events def
-00002310: 696e 6520 7468 6520 7761 7920 7468 6174  ine the way that
-00002320: 2077 696c 6c20 6265 2074 7261 6e73 666f   will be transfo
-00002330: 726d 6564 2074 6f20 7265 616c 2076 616c  rmed to real val
-00002340: 7565 7320 7469 6d65 2d73 6572 6965 732e  ues time-series.
-00002350: 0a0a 2020 2020 2020 2020 2a2a 5061 7261  ..        **Para
-00002360: 6d65 7465 7273 2a2a 3a0a 0a20 2020 2020  meters**:..     
-00002370: 2020 202a 2a74 696d 6573 7461 6d70 2a2a     **timestamp**
-00002380: 3a20 2054 6865 2074 696d 6573 7461 6d70  :  The timestamp
-00002390: 206f 6620 7468 6520 6172 7269 7665 6420   of the arrived 
-000023a0: 7661 6c75 650a 0a20 2020 2020 2020 202a  value..        *
-000023b0: 2a73 6f75 7263 652a 2a3a 2054 6865 2073  *source**: The s
-000023c0: 6f75 7263 6520 6f66 2074 6865 2061 7272  ource of the arr
-000023d0: 6976 6564 2076 616c 7565 0a0a 2020 2020  ived value..    
-000023e0: 2020 2020 2a2a 6e61 6d65 2a2a 3a20 5468      **name**: Th
-000023f0: 6520 6e61 6d65 2028 6f72 2069 6465 6e74  e name (or ident
-00002400: 6966 6965 7229 206f 6620 7468 6520 6172  ifier) of the ar
-00002410: 7269 7665 6420 7661 6c75 650a 0a20 2020  rived value..   
-00002420: 2020 2020 202a 2a76 616c 7565 2a2a 3a20       **value**: 
-00002430: 5468 6520 7661 6c75 6520 2866 6c6f 6174  The value (float
-00002440: 292c 2069 6e20 6361 7365 2074 6869 7320  ), in case this 
-00002450: 6973 204e 6f6e 6520 7468 6520 6172 7269  is None the arri
-00002460: 7665 6420 6461 7461 2069 7320 636f 6e73  ved data is cons
-00002470: 6964 6572 6564 2061 7320 6576 656e 740a  idered as event.
-00002480: 0a20 2020 2020 2020 202a 2a74 7970 652a  .        **type*
-00002490: 2a3a 2074 6865 2074 7970 6520 6f66 2074  *: the type of t
-000024a0: 6865 2064 6174 6120 6361 6e20 6265 206f  he data can be o
-000024b0: 6e65 206f 6620 2623 3334 3b69 736f 6c61  ne of &#34;isola
-000024c0: 7465 6426 2333 343b 2c26 2333 343b 636f  ted&#34;,&#34;co
-000024d0: 6e66 6967 7572 6174 696f 6e26 2333 343b  nfiguration&#34;
-000024e0: 2077 6865 6e20 6e6f 2076 616c 7565 2069   when no value i
-000024f0: 7320 7061 7373 6564 0a0a 2020 2020 2020  s passed..      
-00002500: 2020 2a2a 7265 7475 726e 2a2a 3a20 2073    **return**:  s
-00002510: 7472 7563 7475 7265 2e43 6f6e 7465 7874  tructure.Context
-00002520: 206f 626a 6563 7420 7768 656e 2074 6865   object when the
-00002530: 2064 6174 6120 6e61 6d65 206d 6174 6368   data name match
-00002540: 2074 6f20 7468 6520 7461 7267 6574 206e   to the target n
-00002550: 616d 6520 6f72 204e 6f6e 652e 0a20 2020  ame or None..   
-00002560: 2020 2020 2026 2333 393b 2623 3339 3b26       &#39;&#39;&
-00002570: 2333 393b 0a0a 2020 2020 2020 2020 6966  #39;..        if
-00002580: 2076 616c 7565 2069 7320 4e6f 6e65 3a0a   value is None:.
-00002590: 2020 2020 2020 2020 2020 2020 6966 2074              if t
-000025a0: 7970 6520 6e6f 7420 696e 205b 2623 3334  ype not in [&#34
-000025b0: 3b69 736f 6c61 7465 6426 2333 343b 2c20  ;isolated&#34;, 
-000025c0: 2623 3334 3b63 6f6e 6669 6775 7261 7469  &#34;configurati
-000025d0: 6f6e 2623 3334 3b5d 3a0a 2020 2020 2020  on&#34;]:.      
-000025e0: 2020 2020 2020 2020 2020 6173 7365 7274            assert
-000025f0: 2046 616c 7365 2c20 2623 3334 3b54 6865   False, &#34;The
-00002600: 2074 7970 6520 6d75 7374 2062 6520 6465   type must be de
-00002610: 6669 6e65 6420 6173 206f 6e65 206f 6620  fined as one of 
-00002620: 5c26 2333 343b 6973 6f6c 6174 6564 5c26  \&#34;isolated\&
-00002630: 2333 343b 2061 6e64 205c 2623 3334 3b63  #34; and \&#34;c
-00002640: 6f6e 6669 6775 7261 7469 6f6e 5c26 2333  onfiguration\&#3
-00002650: 343b 2077 6865 6e20 6e6f 2076 616c 7565  4; when no value
-00002660: 2069 7320 7061 7373 6564 2623 3334 3b0a   is passed&#34;.
-00002670: 2020 2020 2020 2020 6576 656e 7470 6f69          eventpoi
-00002680: 6e74 203d 2045 7665 6e74 706f 696e 7428  nt = Eventpoint(
-00002690: 636f 6465 3d6e 616d 652c 2073 6f75 7263  code=name, sourc
-000026a0: 653d 736f 7572 6365 2c20 7469 6d65 7374  e=source, timest
-000026b0: 616d 703d 7469 6d65 7374 616d 702c 2064  amp=timestamp, d
-000026c0: 6574 6169 6c73 3d76 616c 7565 2c20 7479  etails=value, ty
-000026d0: 7065 3d74 7970 6529 0a20 2020 2020 2020  pe=type).       
-000026e0: 2073 656c 662e 6164 645f 746f 5f62 7566   self.add_to_buf
-000026f0: 6665 7228 6576 656e 7470 6f69 6e74 290a  fer(eventpoint).
-00002700: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00002710: 7461 7267 6574 203d 3d20 6e61 6d65 206f  target == name o
-00002720: 7220 7365 6c66 2e74 6172 6765 7420 3d3d  r self.target ==
-00002730: 2066 2623 3334 3b7b 6e61 6d65 7d40 7b73   f&#34;{name}@{s
-00002740: 6f75 7263 657d 2623 3334 3b3a 0a20 2020  ource}&#34;:.   
-00002750: 2020 2020 2020 2020 2063 6f6e 7465 7874           context
-00002760: 6f62 6a65 6374 203d 2073 656c 662e 6765  object = self.ge
-00002770: 6e65 7261 7465 5f63 6f6e 7465 7874 2865  nerate_context(e
-00002780: 3d65 7665 6e74 706f 696e 742c 2062 7566  =eventpoint, buf
-00002790: 6665 723d 7365 6c66 2e62 7566 6665 7229  fer=self.buffer)
-000027a0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000027b0: 7572 6e20 636f 6e74 6578 746f 626a 6563  urn contextobjec
-000027c0: 740a 2020 2020 2020 2020 656c 7365 3a0a  t.        else:.
-000027d0: 2020 2020 2020 2020 2020 2020 7265 7475              retu
-000027e0: 726e 204e 6f6e 650a 0a20 2020 2064 6566  rn None..    def
-000027f0: 2061 6464 5f74 6f5f 6275 6666 6572 2873   add_to_buffer(s
-00002800: 656c 662c 2065 3a20 4576 656e 7470 6f69  elf, e: Eventpoi
-00002810: 6e74 293a 0a20 2020 2020 2020 2026 2333  nt):.        &#3
-00002820: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
-00002830: 2020 2020 2041 6464 7320 616e 2045 7665       Adds an Eve
-00002840: 6e74 2070 6f69 6e74 2074 6f20 7468 6520  nt point to the 
-00002850: 6275 6666 6572 2028 6b65 6570 696e 6720  buffer (keeping 
-00002860: 7468 6520 6275 6666 6572 2074 696d 6520  the buffer time 
-00002870: 6f72 6465 7265 6429 0a20 2020 2020 2020  ordered).       
-00002880: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
-00002890: 0a20 2020 2020 2020 2069 6e64 6578 203d  .        index =
-000028a0: 206c 656e 2873 656c 662e 6275 6666 6572   len(self.buffer
-000028b0: 290a 2020 2020 2020 2020 666f 7220 6920  ).        for i 
-000028c0: 696e 2072 616e 6765 286c 656e 2873 656c  in range(len(sel
-000028d0: 662e 6275 6666 6572 2920 2d20 312c 2030  f.buffer) - 1, 0
-000028e0: 2c20 2d31 293a 0a20 2020 2020 2020 2020  , -1):.         
-000028f0: 2020 2069 6620 7365 6c66 2e62 7566 6665     if self.buffe
-00002900: 725b 695d 2e74 696d 6573 7461 6d70 2026  r[i].timestamp &
-00002910: 6c74 3b3d 2065 2e74 696d 6573 7461 6d70  lt;= e.timestamp
-00002920: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00002930: 2020 696e 6465 7820 3d20 6920 2b20 310a    index = i + 1.
-00002940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002950: 6272 6561 6b0a 2020 2020 2020 2020 6966  break.        if
-00002960: 2069 6e64 6578 203d 3d20 6c65 6e28 7365   index == len(se
-00002970: 6c66 2e62 7566 6665 7229 3a0a 2020 2020  lf.buffer):.    
-00002980: 2020 2020 2020 2020 7365 6c66 2e62 7566          self.buf
-00002990: 6665 722e 6170 7065 6e64 2865 290a 2020  fer.append(e).  
-000029a0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000029b0: 2020 2020 2020 2020 7365 6c66 2e62 7566          self.buf
-000029c0: 6665 7220 3d20 7365 6c66 2e62 7566 6665  fer = self.buffe
-000029d0: 725b 3a20 696e 6465 785d 202b 205b 655d  r[: index] + [e]
-000029e0: 202b 2073 656c 662e 6275 6666 6572 5b69   + self.buffer[i
-000029f0: 6e64 6578 3a5d 0a0a 2020 2020 2020 2020  ndex:]..        
-00002a00: 6c61 7374 203d 2073 656c 662e 6275 6666  last = self.buff
-00002a10: 6572 5b2d 315d 0a20 2020 2020 2020 2070  er[-1].        p
-00002a20: 6f73 203d 206c 656e 2873 656c 662e 6275  os = len(self.bu
-00002a30: 6666 6572 2920 2d20 310a 2020 2020 2020  ffer) - 1.      
-00002a40: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00002a50: 286c 656e 2873 656c 662e 6275 6666 6572  (len(self.buffer
-00002a60: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00002a70: 6966 2073 656c 662e 6275 6666 6572 5b69  if self.buffer[i
-00002a80: 5d2e 7469 6d65 7374 616d 7020 2667 743b  ].timestamp &gt;
-00002a90: 3d20 286c 6173 742e 7469 6d65 7374 616d  = (last.timestam
-00002aa0: 7020 2d20 7064 2e54 696d 6564 656c 7461  p - pd.Timedelta
-00002ab0: 2873 656c 662e 686f 7269 7a6f 6e2c 2073  (self.horizon, s
-00002ac0: 656c 662e 686f 7269 7a6f 6e5f 7469 6d65  elf.horizon_time
-00002ad0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00002ae0: 2020 2020 706f 7320 3d20 690a 2020 2020      pos = i.    
-00002af0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-00002b00: 6b0a 2020 2020 2020 2020 7365 6c66 2e62  k.        self.b
-00002b10: 7566 6665 7220 3d20 7365 6c66 2e62 7566  uffer = self.buf
-00002b20: 6665 725b 706f 733a 5d0a 0a20 2020 2064  fer[pos:]..    d
-00002b30: 6566 2067 656e 6572 6174 655f 636f 6e74  ef generate_cont
-00002b40: 6578 7428 7365 6c66 2c20 653a 2045 7665  ext(self, e: Eve
-00002b50: 6e74 706f 696e 742c 2062 7566 6665 7229  ntpoint, buffer)
-00002b60: 3a0a 2020 2020 2020 2020 2623 3334 3b26  :.        &#34;&
-00002b70: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
-00002b80: 2020 4765 6e65 7261 7465 2063 6f6e 7465    Generate conte
-00002b90: 7874 2061 6e64 2069 6e74 6572 7072 6574  xt and interpret
-00002ba0: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00002bb0: 2a2a 5061 7261 6d65 7465 7273 2a2a 3a0a  **Parameters**:.
-00002bc0: 0a20 2020 2020 2020 202a 2a65 2a2a 3a20  .        **e**: 
-00002bd0: 4576 656e 7470 6f69 6e74 2072 656c 6174  Eventpoint relat
-00002be0: 6564 2074 6f20 7468 6520 6c61 7374 2074  ed to the last t
-00002bf0: 6172 6765 7426 2333 393b 7320 6461 7461  arget&#39;s data
-00002c00: 2e0a 0a20 2020 2020 2020 202a 2a62 7566  ...        **buf
-00002c10: 6665 722a 2a3a 2041 206c 6973 7420 7769  fer**: A list wi
-00002c20: 7468 2061 6c6c 2045 7665 6e74 706f 696e  th all Eventpoin
-00002c30: 7473 2069 6e20 7468 6520 7469 6d65 2068  ts in the time h
-00002c40: 6f72 697a 6f6e 0a20 2020 2020 2020 2026  orizon.        &
-00002c50: 2333 343b 2623 3334 3b26 2333 343b 0a0a  #34;&#34;&#34;..
-00002c60: 2020 2020 2020 2020 636f 6e74 6578 7463          contextc
-00002c70: 7572 7265 6e74 2c20 7461 7267 6574 5f73  urrent, target_s
-00002c80: 6572 6965 735f 6e61 6d65 203d 2073 656c  eries_name = sel
-00002c90: 662e 6372 6561 7465 5f63 6f6e 7465 7874  f.create_context
-00002ca0: 2865 2c20 6275 6666 6572 290a 0a20 2020  (e, buffer)..   
-00002cb0: 2020 2020 2073 656c 662e 636f 6e74 6578       self.contex
-00002cc0: 7473 2e61 7070 656e 6428 636f 6e74 6578  ts.append(contex
-00002cd0: 7463 7572 7265 6e74 290a 2020 2020 2020  tcurrent).      
-00002ce0: 2020 7365 6c66 2e63 7265 6174 655f 696e    self.create_in
-00002cf0: 7465 7270 7265 7461 7469 6f6e 2863 6f6e  terpretation(con
-00002d00: 7465 7874 6375 7272 656e 742c 2074 6172  textcurrent, tar
-00002d10: 6765 745f 7365 7269 6573 5f6e 616d 6529  get_series_name)
-00002d20: 0a0a 2020 2020 2020 2020 696e 7465 7274  ..        intert
-00002d30: 7570 7320 3d20 5b74 7474 7570 2066 6f72  ups = [tttup for
-00002d40: 2074 7474 7570 2069 6e0a 2020 2020 2020   tttup in.      
-00002d50: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00002d60: 656c 662e 636f 6e74 6578 7473 5b2d 315d  elf.contexts[-1]
-00002d70: 2e43 525b 2623 3334 3b69 6e74 6572 7072  .CR[&#34;interpr
-00002d80: 6574 6174 696f 6e26 2333 343b 5d5d 0a20  etation&#34;]]. 
-00002d90: 2020 2020 2020 2023 2074 6869 7320 6973         # this is
-00002da0: 2075 7365 6675 6c6c 2066 6f72 2070 6c6f   usefull for plo
-00002db0: 7469 6e67 0a20 2020 2020 2020 2073 656c  ting.        sel
-00002dc0: 662e 636f 6e74 6578 7473 5b2d 315d 2e43  f.contexts[-1].C
-00002dd0: 525b 2623 3334 3b69 6e74 6572 7072 6574  R[&#34;interpret
-00002de0: 6174 696f 6e26 2333 343b 5d20 3d20 696e  ation&#34;] = in
-00002df0: 7465 7274 7570 730a 0a20 2020 2020 2020  tertups..       
-00002e00: 2072 6574 7572 6e20 7365 6c66 2e63 6f6e   return self.con
-00002e10: 7465 7874 735b 2d31 5d0a 0a20 2020 2064  texts[-1]..    d
-00002e20: 6566 2063 7265 6174 655f 696e 7465 7270  ef create_interp
-00002e30: 7265 7461 7469 6f6e 2873 656c 662c 2063  retation(self, c
-00002e40: 6f6e 7465 7874 6375 7272 656e 743a 2043  ontextcurrent: C
-00002e50: 6f6e 7465 7874 2c20 7461 7267 6574 5f73  ontext, target_s
-00002e60: 6572 6965 735f 6e61 6d65 293a 0a20 2020  eries_name):.   
-00002e70: 2020 2020 2026 2333 343b 2623 3334 3b26       &#34;&#34;&
-00002e80: 2333 343b 0a20 2020 2020 2020 2054 6869  #34;.        Thi
-00002e90: 7320 6d65 7468 6f64 2063 6f6c 6c65 6374  s method collect
-00002ea0: 2061 6c6c 2074 6865 2063 6f6e 7465 7874   all the context
-00002eb0: 7320 696e 2074 6865 2068 6f72 697a 6f6e  s in the horizon
-00002ec0: 2061 6e64 2063 616c 6c73 2074 6865 2069   and calls the i
-00002ed0: 6e74 6572 7072 6574 6174 696f 6e20 6d65  nterpretation me
-00002ee0: 7468 6f64 2e0a 0a20 2020 2020 2020 202a  thod...        *
-00002ef0: 2a50 6172 616d 6574 6572 732a 2a3a 0a0a  *Parameters**:..
-00002f00: 2020 2020 2020 2020 2a2a 636f 6e74 6578          **contex
-00002f10: 7463 7572 7265 6e74 2a2a 3a20 5468 6520  tcurrent**: The 
-00002f20: 436f 6e74 6578 7420 666f 7220 7768 6963  Context for whic
-00002f30: 6820 7468 6520 696e 7465 7270 7265 7461  h the interpreta
-00002f40: 7469 6f6e 2069 7320 6361 6c63 756c 6174  tion is calculat
-00002f50: 6564 0a0a 2020 2020 2020 2020 2a2a 7461  ed..        **ta
-00002f60: 7267 6574 5f73 6572 6965 735f 6e61 6d65  rget_series_name
-00002f70: 2a2a 3a20 5468 656e 206e 616d 6520 6f66  **: Then name of
-00002f80: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
-00002f90: 6162 6c65 0a20 2020 2020 2020 2026 2333  able.        &#3
-00002fa0: 343b 2623 3334 3b26 2333 343b 0a0a 2020  4;&#34;&#34;..  
-00002fb0: 2020 2020 2020 7269 6b69 636f 6e74 6578        rikicontex
-00002fc0: 7420 3d20 7365 6c66 2e63 6f6e 7465 7874  t = self.context
-00002fd0: 730a 2020 2020 2020 2020 706f 7320 3d20  s.        pos = 
-00002fe0: 7365 6c66 2e69 6e74 6572 7072 6574 5f68  self.interpret_h
-00002ff0: 6973 746f 7279 5f70 6f73 0a20 2020 2020  istory_pos.     
-00003000: 2020 2074 656d 7070 6f73 203d 2070 6f73     temppos = pos
-00003010: 0a20 2020 2020 2020 2066 6f72 2071 2069  .        for q i
-00003020: 6e20 7261 6e67 6528 706f 732c 206c 656e  n range(pos, len
-00003030: 2872 696b 6963 6f6e 7465 7874 2929 3a0a  (rikicontext)):.
-00003040: 2020 2020 2020 2020 2020 2020 7465 6d70              temp
-00003050: 706f 7320 3d20 710a 2020 2020 2020 2020  pos = q.        
-00003060: 2020 2020 6966 2070 642e 746f 5f64 6174      if pd.to_dat
-00003070: 6574 696d 6528 7269 6b69 636f 6e74 6578  etime(rikicontex
-00003080: 745b 715d 2e74 696d 6573 7461 6d70 2920  t[q].timestamp) 
-00003090: 2667 743b 3d20 280a 2020 2020 2020 2020  &gt;= (.        
-000030a0: 2020 2020 2020 2020 2020 2020 7064 2e74              pd.t
-000030b0: 6f5f 6461 7465 7469 6d65 2863 6f6e 7465  o_datetime(conte
-000030c0: 7874 6375 7272 656e 742e 7469 6d65 7374  xtcurrent.timest
-000030d0: 616d 7029 202d 2070 642e 5469 6d65 6465  amp) - pd.Timede
-000030e0: 6c74 6128 7365 6c66 2e68 6f72 697a 6f6e  lta(self.horizon
-000030f0: 2c20 7365 6c66 2e68 6f72 697a 6f6e 5f74  , self.horizon_t
-00003100: 696d 6529 293a 0a20 2020 2020 2020 2020  ime)):.         
-00003110: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-00003120: 2020 2020 2063 6175 7365 7377 696e 646f       causeswindo
-00003130: 7720 3d20 7269 6b69 636f 6e74 6578 745b  w = rikicontext[
-00003140: 7465 6d70 706f 733a 5d0a 2020 2020 2020  temppos:].      
-00003150: 2020 7365 6c66 2e69 6e74 6572 7072 6574    self.interpret
-00003160: 5f68 6973 746f 7279 5f70 6f73 203d 2074  _history_pos = t
-00003170: 656d 7070 6f73 0a20 2020 2020 2020 2069  emppos.        i
-00003180: 6e74 6572 7072 203d 2073 656c 662e 696e  nterpr = self.in
-00003190: 7465 7270 7265 7428 636f 6e74 6578 7463  terpret(contextc
-000031a0: 7572 7265 6e74 2c20 6361 7573 6573 7769  urrent, causeswi
-000031b0: 6e64 6f77 2c20 7461 7267 6574 5f73 6572  ndow, target_ser
-000031c0: 6965 735f 6e61 6d65 2c20 7365 6c66 2e74  ies_name, self.t
-000031d0: 7970 655f 6f66 5f73 6572 6965 7329 0a20  ype_of_series). 
-000031e0: 2020 2020 2020 2073 656c 662e 636f 6e74         self.cont
-000031f0: 6578 7473 5b2d 315d 2e43 525b 2623 3334  exts[-1].CR[&#34
-00003200: 3b69 6e74 6572 7072 6574 6174 696f 6e26  ;interpretation&
-00003210: 2333 343b 5d20 3d20 696e 7465 7270 720a  #34;] = interpr.
-00003220: 0a20 2020 2064 6566 2069 6e74 6572 7072  .    def interpr
-00003230: 6574 2873 656c 662c 2063 6f6e 7465 7874  et(self, context
-00003240: 3a20 436f 6e74 6578 742c 2063 6175 7365  : Context, cause
-00003250: 7377 696e 646f 772c 2074 6172 6765 742c  swindow, target,
-00003260: 2074 7970 655f 6f66 5f73 6572 6965 7329   type_of_series)
-00003270: 3a0a 2020 2020 2020 2020 2623 3334 3b26  :.        &#34;&
-00003280: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
-00003290: 2020 5468 6973 206d 6574 686f 6420 656e    This method en
-000032a0: 6861 6e63 6520 7468 6520 4352 2070 6172  hance the CR par
-000032b0: 7420 6f66 2074 6865 2043 6f6e 7465 7874  t of the Context
-000032c0: 2077 6974 6820 696e 7465 7270 7265 7461   with interpreta
-000032d0: 7469 6f6e 2072 656c 6174 696e 6720 746f  tion relating to
-000032e0: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
-000032f0: 6162 6c65 2e0a 2020 2020 2020 2020 5468  able..        Th
-00003300: 6520 696e 7465 7270 7265 7461 7469 6f6e  e interpretation
-00003310: 2061 7265 2062 6173 6564 206f 6e20 7468   are based on th
-00003320: 6520 6564 6765 7320 6578 7472 6163 7465  e edges extracte
-00003330: 6420 6672 6f6d 2074 6865 2043 6173 7561  d from the Casua
-00003340: 6c74 7920 6469 7363 6f76 6572 792e 0a20  lty discovery.. 
-00003350: 2020 2020 2020 2046 6f72 2065 6163 6820         For each 
-00003360: 6564 6765 206f 6620 7479 7065 2028 7365  edge of type (se
-00003370: 7269 6573 4120 2d26 6774 3b20 7461 7267  riesA -&gt; targ
-00003380: 6574 2920 696e 2074 6865 2065 6467 6573  et) in the edges
-00003390: 2077 6520 7465 7374 2069 6620 7468 6520   we test if the 
-000033a0: 7365 7269 6573 4120 696e 7465 7270 7265  seriesA interpre
-000033b0: 7473 0a20 2020 2020 2020 2074 6865 2074  ts.        the t
-000033c0: 6172 6765 7420 7573 696e 6720 7468 6520  arget using the 
-000033d0: 666f 6c6c 6f77 696e 6720 7275 6c65 733a  following rules:
-000033e0: 0a0a 2020 2020 2020 2020 2a2a 6966 2073  ..        **if s
-000033f0: 6572 6965 7341 2069 7320 6973 6f6c 6174  eriesA is isolat
-00003400: 6564 2a2a 3a20 5765 2063 6865 636b 2069  ed**: We check i
-00003410: 6620 6974 7320 6c61 7374 206f 6363 7572  f its last occur
-00003420: 7265 6e63 6520 6973 2074 6865 2063 7572  rence is the cur
-00003430: 7265 6e74 2074 696d 6573 7461 6d70 206f  rent timestamp o
-00003440: 7220 7468 6520 7072 6576 696f 7573 206f  r the previous o
-00003450: 6e65 2e0a 0a20 2020 2020 2020 202a 2a69  ne...        **i
-00003460: 6620 7365 7269 6573 4120 6973 2063 6f6e  f seriesA is con
-00003470: 6669 6775 7261 7469 6f6e 2a2a 3a20 5765  figuration**: We
-00003480: 2063 6865 636b 2069 6620 7468 6520 6564   check if the ed
-00003490: 6765 7320 2873 6572 6965 7341 202d 2667  ges (seriesA -&g
-000034a0: 743b 2074 6172 6765 7429 2061 7070 6561  t; target) appea
-000034b0: 7273 0a20 2020 2020 2020 2069 6e20 6174  rs.        in at
-000034c0: 206c 6561 7374 2038 3025 2063 6f6e 7465   least 80% conte
-000034d0: 7874 7320 696e 2074 6865 2068 6f72 697a  xts in the horiz
-000034e0: 6f6e 2028 692e 652e 2069 6e20 6361 7573  on (i.e. in caus
-000034f0: 6573 7769 6e64 6f77 206c 6973 7429 2e0a  eswindow list)..
-00003500: 0a20 2020 2020 2020 202a 2a69 6620 7365  .        **if se
-00003510: 7269 6573 4120 6973 2063 6f6e 7469 6e75  riesA is continu
-00003520: 6f75 732a 2a3a 2054 6865 6e20 7468 6174  ous**: Then that
-00003530: 206d 6561 6e73 2074 6865 2074 6172 6765   means the targe
-00003540: 7420 6973 2072 656c 6174 6564 2077 6974  t is related wit
-00003550: 6820 7365 7269 6573 410a 2020 2020 2020  h seriesA.      
-00003560: 2020 616e 6420 7765 2061 6464 2069 7420    and we add it 
-00003570: 746f 2074 6865 2069 6e74 6572 7072 6574  to the interpret
-00003580: 6174 696f 6e2e 0a0a 2020 2020 2020 2020  ation...        
-00003590: 416c 6c20 7468 6520 696e 7465 7270 7265  All the interpre
-000035a0: 7461 7469 6f6e 7320 6172 6520 7461 6767  tations are tagg
-000035b0: 6564 2077 6974 6820 6120 7469 6d65 7374  ed with a timest
-000035c0: 616d 7020 7768 6963 6820 7265 6665 7273  amp which refers
-000035d0: 2074 6f20 7468 6520 6669 7273 7420 7469   to the first ti
-000035e0: 6d65 0a20 2020 2020 2020 206f 6620 6170  me.        of ap
-000035f0: 7065 6172 656e 7365 206f 6620 636f 6e73  pearense of cons
-00003600: 6563 7574 6976 6520 696e 7465 7270 7265  ecutive interpre
-00003610: 7461 7469 6f6e 732e 2054 6865 6e20 7468  tations. Then th
-00003620: 6520 696e 7465 7270 7265 7461 7469 6f6e  e interpretation
-00003630: 2061 7265 2073 6f72 7465 6420 7573 696e   are sorted usin
-00003640: 670a 2020 2020 2020 2020 7468 6973 2074  g.        this t
-00003650: 696d 6573 7461 6d70 2e20 5468 6973 2069  imestamp. This i
-00003660: 7320 646f 6e65 2074 6f20 7072 6f76 6964  s done to provid
-00003670: 6520 6120 6869 6572 6172 6368 7920 746f  e a hierarchy to
-00003680: 2074 6865 2069 6e74 6572 7072 6574 6174   the interpretat
-00003690: 696f 6e20 7369 6e63 6520 6974 206d 6179  ion since it may
-000036a0: 2062 6520 7468 6520 6361 7365 2c0a 2020   be the case,.  
-000036b0: 2020 2020 2020 7468 6174 2077 6865 6e20        that when 
-000036c0: 7365 7269 6573 4120 6361 7573 6520 7461  seriesA cause ta
-000036d0: 7267 6574 202c 2061 6e64 2053 6572 6965  rget , and Serie
-000036e0: 7342 2063 6175 7365 2074 6172 6765 742c  sB cause target,
-000036f0: 2074 6865 206f 6c64 6573 7420 6f6e 6520   the oldest one 
-00003700: 6973 2073 7472 6f6e 6765 7220 7369 6e63  is stronger sinc
-00003710: 6520 7468 6520 5365 7269 6573 4220 6d61  e the SeriesB ma
-00003720: 7920 6265 0a20 2020 2020 2020 2065 6666  y be.        eff
-00003730: 6563 7420 6f66 2073 6572 6965 7341 2e0a  ect of seriesA..
-00003740: 0a20 2020 2020 2020 202a 2a50 6172 616d  .        **Param
-00003750: 6574 6572 732a 2a3a 0a0a 2020 2020 2020  eters**:..      
-00003760: 2020 2a2a 636f 6e74 6578 742a 2a3a 2043    **context**: C
-00003770: 6f6e 7465 7874 204f 626a 6563 7420 746f  ontext Object to
-00003780: 2062 6520 696e 7465 7270 7265 7465 640a   be interpreted.
-00003790: 0a20 2020 2020 2020 202a 2a63 6175 7365  .        **cause
-000037a0: 7377 696e 646f 772a 2a3a 206c 6973 7420  swindow**: list 
-000037b0: 7769 7468 2074 6865 206c 6173 7420 686f  with the last ho
-000037c0: 7269 7a6f 6e20 636f 6e74 6578 7473 0a0a  rizon contexts..
-000037d0: 2020 2020 2020 2020 2a2a 7461 7267 6574          **target
-000037e0: 2a2a 3a20 7468 6520 6e61 6d65 206f 6620  **: the name of 
-000037f0: 7468 6520 7461 7267 6574 2076 6172 6961  the target varia
-00003800: 626c 6520 746f 2069 6e74 6572 7072 6574  ble to interpret
-00003810: 0a0a 2020 2020 2020 2020 2a2a 7479 7065  ..        **type
-00003820: 5f6f 665f 7365 7269 6573 2a2a 3a20 6469  _of_series**: di
-00003830: 6374 696f 6e61 7279 2077 6869 6368 2064  ctionary which d
-00003840: 6566 696e 6520 7468 6520 7479 7065 206f  efine the type o
-00003850: 6620 6561 6368 2073 6572 6965 7320 2869  f each series (i
-00003860: 736f 6c61 7465 642c 636f 6e66 6967 7572  solated,configur
-00003870: 6174 696f 6e20 6f72 2063 6f6e 7469 6e75  ation or continu
-00003880: 6f75 7329 0a20 2020 2020 2020 2026 2333  ous).        &#3
-00003890: 343b 2623 3334 3b26 2333 343b 0a0a 2020  4;&#34;&#34;..  
-000038a0: 2020 2020 2020 7061 6972 7320 3d20 5b28        pairs = [(
-000038b0: 7061 6972 5b30 5d2c 2070 6169 725b 315d  pair[0], pair[1]
-000038c0: 2c20 6361 7229 2066 6f72 2070 6169 722c  , car) for pair,
-000038d0: 2063 6172 2069 6e20 7a69 7028 636f 6e74   car in zip(cont
-000038e0: 6578 742e 4352 5b26 2333 393b 6564 6765  ext.CR[&#39;edge
-000038f0: 7326 2333 393b 5d2c 2063 6f6e 7465 7874  s&#39;], context
-00003900: 2e43 525b 2623 3339 3b63 6861 7261 6374  .CR[&#39;charact
-00003910: 6572 697a 6174 696f 6e26 2333 393b 5d29  erization&#39;])
-00003920: 2069 660a 2020 2020 2020 2020 2020 2020   if.            
-00003930: 2020 2020 2074 6172 6765 7420 696e 2070       target in p
-00003940: 6169 725b 315d 5d0a 0a20 2020 2020 2020  air[1]]..       
-00003950: 2023 2070 6169 7273 686f 7032 203d 205b   # pairshop2 = [
-00003960: 5d0a 2020 2020 2020 2020 2320 696e 7465  ].        # inte
-00003970: 726d 6564 6961 7465 733d 5b70 6169 725b  rmediates=[pair[
-00003980: 305d 2066 6f72 2070 6169 7220 696e 2070  0] for pair in p
-00003990: 6169 7273 5d0a 2020 2020 2020 2020 2320  airs].        # 
-000039a0: 616c 6c6f 7468 6573 3d5b 7061 6972 2066  allothes=[pair f
-000039b0: 6f72 2070 6169 7220 696e 2063 6f6e 7465  or pair in conte
-000039c0: 7874 2e43 442e 6b65 7973 2829 2069 6620  xt.CD.keys() if 
-000039d0: 7061 6972 206e 6f74 2069 6e20 696e 7465  pair not in inte
-000039e0: 726d 6564 6961 7465 735d 0a20 2020 2020  rmediates].     
-000039f0: 2020 2023 0a20 2020 2020 2020 2023 2066     #.        # f
-00003a00: 6f72 2069 6e74 6572 5f70 6169 7220 696e  or inter_pair in
-00003a10: 2069 6e74 6572 6d65 6469 6174 6573 3a0a   intermediates:.
-00003a20: 2020 2020 2020 2020 2320 2020 2020 666f          #     fo
-00003a30: 7220 6e61 6d65 2069 6e20 616c 6c6f 7468  r name in alloth
-00003a40: 6573 3a0a 2020 2020 2020 2020 2320 2020  es:.        #   
-00003a50: 2020 2020 2020 6966 2028 6e61 6d65 2c69        if (name,i
-00003a60: 6e74 6572 5f70 6169 7229 2069 6e20 636f  nter_pair) in co
-00003a70: 6e74 6578 742e 4352 5b26 2333 343b 6564  ntext.CR[&#34;ed
-00003a80: 6765 7326 2333 343b 5d3a 0a20 2020 2020  ges&#34;]:.     
-00003a90: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-00003aa0: 2070 6169 7273 686f 7032 2e61 7070 656e   pairshop2.appen
-00003ab0: 6428 286e 616d 652c 696e 7465 725f 7061  d((name,inter_pa
-00003ac0: 6972 2929 0a0a 2020 2020 2020 2020 696e  ir))..        in
-00003ad0: 7465 7270 7265 7461 7469 6f6e 203d 205b  terpretation = [
-00003ae0: 5d0a 2020 2020 2020 2020 7479 7065 636f  ].        typeco
-00003af0: 6e65 6374 696f 6e20 3d20 5b5d 0a20 2020  nection = [].   
-00003b00: 2020 2020 2069 6620 6c65 6e28 7061 6972       if len(pair
-00003b10: 7329 203d 3d20 303a 0a20 2020 2020 2020  s) == 0:.       
-00003b20: 2020 2020 2072 6574 7572 6e20 5b5d 0a20       return []. 
-00003b30: 2020 2020 2020 2066 6f72 2070 6169 7220         for pair 
-00003b40: 696e 2070 6169 7273 3a0a 2020 2020 2020  in pairs:.      
-00003b50: 2020 2020 2020 6966 2074 7970 655f 6f66        if type_of
-00003b60: 5f73 6572 6965 735b 7061 6972 5b30 5d5d  _series[pair[0]]
-00003b70: 203d 3d20 2623 3334 3b69 736f 6c61 7465   == &#34;isolate
-00003b80: 6426 2333 343b 3a0a 2020 2020 2020 2020  d&#34;:.        
-00003b90: 2020 2020 2020 2020 7661 6c75 6573 3120          values1 
-00003ba0: 3d20 636f 6e74 6578 742e 4344 5b70 6169  = context.CD[pai
-00003bb0: 725b 305d 5d0a 2020 2020 2020 2020 2020  r[0]].          
-00003bc0: 2020 2020 2020 6966 2076 616c 7565 7331        if values1
-00003bd0: 5b2d 315d 203d 3d20 313a 0a20 2020 2020  [-1] == 1:.     
-00003be0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00003bf0: 6e74 6572 7072 6574 6174 696f 6e2e 6170  nterpretation.ap
-00003c00: 7065 6e64 2828 7061 6972 5b30 5d2c 2070  pend((pair[0], p
-00003c10: 6169 725b 315d 2c20 7061 6972 5b32 5d2c  air[1], pair[2],
-00003c20: 2063 6f6e 7465 7874 2e74 696d 6573 7461   context.timesta
-00003c30: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
-00003c40: 2020 2020 2065 6c69 6620 7661 6c75 6573       elif values
-00003c50: 315b 2d32 5d20 3d3d 2031 3a0a 2020 2020  1[-2] == 1:.    
-00003c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003c70: 7465 6d70 7469 6d65 7374 616d 7020 3d20  temptimestamp = 
-00003c80: 636f 6e74 6578 742e 7469 6d65 7374 616d  context.timestam
-00003c90: 700a 2020 2020 2020 2020 2020 2020 2020  p.              
-00003ca0: 2020 2020 2020 6c61 7374 636f 6e74 6578        lastcontex
-00003cb0: 7420 3d20 7365 6c66 2e63 6f6e 7465 7874  t = self.context
-00003cc0: 735b 6d61 7828 6c65 6e28 7365 6c66 2e63  s[max(len(self.c
-00003cd0: 6f6e 7465 7874 7329 202d 2032 2c20 3029  ontexts) - 2, 0)
-00003ce0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00003cf0: 2020 2020 2020 666f 7220 696e 7465 7270        for interp
-00003d00: 6169 7220 696e 206c 6173 7463 6f6e 7465  air in lastconte
-00003d10: 7874 2e43 525b 2623 3334 3b69 6e74 6572  xt.CR[&#34;inter
-00003d20: 7072 6574 6174 696f 6e26 2333 343b 5d3a  pretation&#34;]:
-00003d30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003d40: 2020 2020 2020 2020 2069 6620 696e 7465           if inte
-00003d50: 7270 6169 725b 305d 203d 3d20 7061 6972  rpair[0] == pair
-00003d60: 5b30 5d20 616e 6420 696e 7465 7270 6169  [0] and interpai
-00003d70: 725b 315d 203d 3d20 7061 6972 5b31 5d3a  r[1] == pair[1]:
-00003d80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003d90: 2020 2020 2020 2020 2020 2020 2074 656d               tem
-00003da0: 7074 696d 6573 7461 6d70 203d 2069 6e74  ptimestamp = int
-00003db0: 6572 7061 6972 5b33 5d0a 2020 2020 2020  erpair[3].      
-00003dc0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-00003dd0: 7465 7270 7265 7461 7469 6f6e 2e61 7070  terpretation.app
-00003de0: 656e 6428 2870 6169 725b 305d 2c20 7061  end((pair[0], pa
-00003df0: 6972 5b31 5d2c 2070 6169 725b 325d 2c20  ir[1], pair[2], 
-00003e00: 7465 6d70 7469 6d65 7374 616d 7029 290a  temptimestamp)).
-00003e10: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00003e20: 2074 7970 655f 6f66 5f73 6572 6965 735b   type_of_series[
-00003e30: 7061 6972 5b30 5d5d 203d 3d20 2623 3334  pair[0]] == &#34
-00003e40: 3b63 6f6e 6669 6775 7261 7469 6f6e 2623  ;configuration&#
-00003e50: 3334 3b3a 0a20 2020 2020 2020 2020 2020  34;:.           
-00003e60: 2020 2020 2076 616c 7565 7331 203d 2063       values1 = c
-00003e70: 6f6e 7465 7874 2e43 445b 7061 6972 5b30  ontext.CD[pair[0
-00003e80: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
-00003e90: 2020 206f 6363 7572 656e 6365 203d 2030     occurence = 0
-00003ea0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003eb0: 2066 6f72 2071 2069 6e20 7261 6e67 6528   for q in range(
-00003ec0: 6c65 6e28 7661 6c75 6573 3129 293a 0a20  len(values1)):. 
-00003ed0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003ee0: 2020 2069 6620 7661 6c75 6573 315b 715d     if values1[q]
-00003ef0: 203d 3d20 7661 6c75 6573 315b 2d31 5d20   == values1[-1] 
-00003f00: 616e 6420 7661 6c75 6573 315b 715d 2026  and values1[q] &
-00003f10: 6774 3b20 303a 0a20 2020 2020 2020 2020  gt; 0:.         
-00003f20: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00003f30: 6363 7572 656e 6365 203d 2071 0a20 2020  ccurence = q.   
-00003f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003f50: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-00003f60: 2020 2020 2020 2020 2020 2069 6620 6f63             if oc
-00003f70: 6375 7265 6e63 6520 3d3d 206c 656e 2876  curence == len(v
-00003f80: 616c 7565 7331 2920 2d20 313a 0a20 2020  alues1) - 1:.   
-00003f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003fa0: 2069 6e74 6572 7072 6574 6174 696f 6e2e   interpretation.
-00003fb0: 6170 7065 6e64 2828 7061 6972 5b30 5d2c  append((pair[0],
-00003fc0: 2070 6169 725b 315d 2c20 7061 6972 5b32   pair[1], pair[2
-00003fd0: 5d2c 2063 6f6e 7465 7874 2e74 696d 6573  ], context.times
-00003fe0: 7461 6d70 2929 0a20 2020 2020 2020 2020  tamp)).         
-00003ff0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00004000: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004010: 206c 6561 6420 3d20 6c65 6e28 7661 6c75   lead = len(valu
-00004020: 6573 3129 202d 206f 6363 7572 656e 6365  es1) - occurence
-00004030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004040: 2020 2020 2063 6f75 6e74 6572 203d 2030       counter = 0
-00004050: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004060: 2020 2020 206c 6561 6463 6f6e 7465 7874       leadcontext
-00004070: 203d 2063 6175 7365 7377 696e 646f 775b   = causeswindow[
-00004080: 2d6c 6561 643a 5d0a 2020 2020 2020 2020  -lead:].        
-00004090: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000040a0: 636f 6e74 6520 696e 206c 6561 6463 6f6e  conte in leadcon
-000040b0: 7465 7874 3a0a 2020 2020 2020 2020 2020  text:.          
-000040c0: 2020 2020 2020 2020 2020 2020 2020 7472                tr
-000040d0: 793a 0a20 2020 2020 2020 2020 2020 2020  y:.             
-000040e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-000040f0: 6f73 203d 206c 6973 7428 636f 6e74 652e  os = list(conte.
-00004100: 4352 5b26 2333 343b 6564 6765 7326 2333  CR[&#34;edges&#3
-00004110: 343b 5d29 2e69 6e64 6578 2828 7061 6972  4;]).index((pair
-00004120: 5b30 5d2c 2070 6169 725b 315d 2929 0a20  [0], pair[1])). 
-00004130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004140: 2020 2020 2020 2065 7863 6570 743a 0a20         except:. 
-00004150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004160: 2020 2020 2020 2020 2020 2070 6f73 203d             pos =
-00004170: 202d 310a 2020 2020 2020 2020 2020 2020   -1.            
-00004180: 2020 2020 2020 2020 2020 2020 6966 2070              if p
-00004190: 6f73 2021 3d20 2d31 3a0a 2020 2020 2020  os != -1:.      
-000041a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000041b0: 2020 2020 2020 6966 2063 6f6e 7465 2e43        if conte.C
-000041c0: 525b 2623 3334 3b63 6861 7261 6374 6572  R[&#34;character
-000041d0: 697a 6174 696f 6e26 2333 343b 5d5b 706f  ization&#34;][po
-000041e0: 735d 203d 3d20 7061 6972 5b32 5d3a 0a20  s] == pair[2]:. 
-000041f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004200: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00004210: 6f75 6e74 6572 202b 3d20 310a 2020 2020  ounter += 1.    
-00004220: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004230: 6966 2063 6f75 6e74 6572 2026 6774 3b3d  if counter &gt;=
-00004240: 2030 2e38 202a 206c 6561 643a 0a20 2020   0.8 * lead:.   
-00004250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004260: 2020 2020 2074 656d 7074 696d 6573 7461       temptimesta
-00004270: 6d70 203d 2063 6f6e 7465 7874 2e74 696d  mp = context.tim
-00004280: 6573 7461 6d70 0a20 2020 2020 2020 2020  estamp.         
-00004290: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-000042a0: 6173 7463 6f6e 7465 7874 203d 2073 656c  astcontext = sel
-000042b0: 662e 636f 6e74 6578 7473 5b6d 6178 286c  f.contexts[max(l
-000042c0: 656e 2873 656c 662e 636f 6e74 6578 7473  en(self.contexts
-000042d0: 2920 2d20 322c 2030 295d 0a20 2020 2020  ) - 2, 0)].     
-000042e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000042f0: 2020 2066 6f72 2069 6e74 6572 7061 6972     for interpair
-00004300: 2069 6e20 6c61 7374 636f 6e74 6578 742e   in lastcontext.
-00004310: 4352 5b26 2333 343b 696e 7465 7270 7265  CR[&#34;interpre
-00004320: 7461 7469 6f6e 2623 3334 3b5d 3a0a 2020  tation&#34;]:.  
-00004330: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004340: 2020 2020 2020 2020 2020 6966 2069 6e74            if int
-00004350: 6572 7061 6972 5b30 5d20 3d3d 2070 6169  erpair[0] == pai
-00004360: 725b 305d 2061 6e64 2069 6e74 6572 7061  r[0] and interpa
-00004370: 6972 5b31 5d20 3d3d 2070 6169 725b 315d  ir[1] == pair[1]
-00004380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00004390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000043a0: 2020 7465 6d70 7469 6d65 7374 616d 7020    temptimestamp 
-000043b0: 3d20 696e 7465 7270 6169 725b 335d 0a20  = interpair[3]. 
-000043c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000043d0: 2020 2020 2020 2069 6e74 6572 7072 6574         interpret
-000043e0: 6174 696f 6e2e 6170 7065 6e64 2828 7061  ation.append((pa
-000043f0: 6972 5b30 5d2c 2070 6169 725b 315d 2c20  ir[0], pair[1], 
-00004400: 7061 6972 5b32 5d2c 2074 656d 7074 696d  pair[2], temptim
-00004410: 6573 7461 6d70 2929 0a20 2020 2020 2020  estamp)).       
-00004420: 2020 2020 2023 2066 6f72 2072 6561 6c20       # for real 
-00004430: 7661 6c75 6520 7365 7269 6573 0a20 2020  value series.   
-00004440: 2020 2020 2020 2020 2065 6c69 6620 6c65           elif le
-00004450: 6e28 7365 7428 636f 6e74 6578 742e 4344  n(set(context.CD
-00004460: 5b70 6169 725b 305d 5d29 2920 2667 743b  [pair[0]])) &gt;
-00004470: 2032 3a0a 2020 2020 2020 2020 2020 2020   2:.            
-00004480: 2020 2020 7465 6d70 7469 6d65 7374 616d      temptimestam
-00004490: 7020 3d20 636f 6e74 6578 742e 7469 6d65  p = context.time
-000044a0: 7374 616d 700a 2020 2020 2020 2020 2020  stamp.          
-000044b0: 2020 2020 2020 6c61 7374 636f 6e74 6578        lastcontex
-000044c0: 7420 3d20 7365 6c66 2e63 6f6e 7465 7874  t = self.context
-000044d0: 735b 6d61 7828 6c65 6e28 7365 6c66 2e63  s[max(len(self.c
-000044e0: 6f6e 7465 7874 7329 202d 2032 2c20 3029  ontexts) - 2, 0)
-000044f0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-00004500: 2020 666f 7220 696e 7465 7270 6169 7220    for interpair 
-00004510: 696e 206c 6173 7463 6f6e 7465 7874 2e43  in lastcontext.C
-00004520: 525b 2623 3334 3b69 6e74 6572 7072 6574  R[&#34;interpret
-00004530: 6174 696f 6e26 2333 343b 5d3a 0a20 2020  ation&#34;]:.   
-00004540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004550: 2069 6620 696e 7465 7270 6169 725b 305d   if interpair[0]
-00004560: 203d 3d20 7061 6972 5b30 5d20 616e 6420   == pair[0] and 
-00004570: 696e 7465 7270 6169 725b 315d 203d 3d20  interpair[1] == 
-00004580: 7061 6972 5b31 5d3a 0a20 2020 2020 2020  pair[1]:.       
-00004590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000045a0: 2074 656d 7074 696d 6573 7461 6d70 203d   temptimestamp =
-000045b0: 2069 6e74 6572 7061 6972 5b33 5d0a 2020   interpair[3].  
-000045c0: 2020 2020 2020 2020 2020 2020 2020 696e                in
-000045d0: 7465 7270 7265 7461 7469 6f6e 2e61 7070  terpretation.app
-000045e0: 656e 6428 2870 6169 725b 305d 2c20 7061  end((pair[0], pa
-000045f0: 6972 5b31 5d2c 2070 6169 725b 325d 2c20  ir[1], pair[2], 
-00004600: 7465 6d70 7469 6d65 7374 616d 7029 290a  temptimestamp)).
-00004610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004620: 636f 6e74 696e 7565 0a20 2020 2020 2020  continue.       
-00004630: 2023 2073 6f72 7420 7769 7468 2074 696d   # sort with tim
-00004640: 650a 2020 2020 2020 2020 6669 6e74 6572  e.        finter
-00004650: 7072 6574 203d 205b 5d0a 2020 2020 2020  pret = [].      
-00004660: 2020 666f 7220 7061 6972 2069 6e20 696e    for pair in in
-00004670: 7465 7270 7265 7461 7469 6f6e 3a0a 2020  terpretation:.  
-00004680: 2020 2020 2020 2020 2020 6669 6e74 6572            finter
-00004690: 7072 6574 2e61 7070 656e 6428 2870 6169  pret.append((pai
-000046a0: 725b 305d 2c20 7061 6972 5b31 5d2c 2070  r[0], pair[1], p
-000046b0: 6169 725b 325d 2c20 7061 6972 5b33 5d29  air[2], pair[3])
-000046c0: 290a 2020 2020 2020 2020 6669 6e74 6572  ).        finter
-000046d0: 7072 6574 2e73 6f72 7428 6b65 793d 6c61  pret.sort(key=la
-000046e0: 6d62 6461 2074 7570 3a20 7475 705b 335d  mbda tup: tup[3]
-000046f0: 2920 2023 2073 6f72 7473 2069 6e20 706c  )  # sorts in pl
-00004700: 6163 650a 2020 2020 2020 2020 7265 7475  ace.        retu
-00004710: 726e 2066 696e 7465 7270 7265 740a 0a20  rn finterpret.. 
-00004720: 2020 2064 6566 2063 7265 6174 655f 636f     def create_co
-00004730: 6e74 6578 7428 7365 6c66 2c20 6375 7272  ntext(self, curr
-00004740: 656e 743a 2045 7665 6e74 706f 696e 742c  ent: Eventpoint,
-00004750: 2062 7566 6665 7229 3a0a 2020 2020 2020   buffer):.      
-00004760: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
-00004770: 3b0a 2020 2020 2020 2020 5472 616e 7366  ;.        Transf
-00004780: 6f72 6d20 7468 6520 6461 7461 2063 6f6c  orm the data col
-00004790: 6c65 6374 6564 2074 6f20 7468 6520 6275  lected to the bu
-000047a0: 6666 6572 2069 6e20 746f 2073 7569 7461  ffer in to suita
-000047b0: 626c 6520 666f 726d 2061 6e64 2067 656e  ble form and gen
-000047c0: 6572 6174 6573 2074 6865 2043 4420 7061  erates the CD pa
-000047d0: 7274 206f 6620 7468 6520 636f 6e74 6578  rt of the contex
-000047e0: 7420 616c 6f6e 6720 7769 7468 0a20 2020  t along with.   
-000047f0: 2020 2020 2074 6865 2065 6467 6573 2061       the edges a
-00004800: 6e64 2063 6861 7261 6374 6572 697a 6174  nd characterizat
-00004810: 696f 6e73 3a0a 0a20 2020 2020 2020 202a  ions:..        *
-00004820: 2a53 7465 7073 3a2a 2a0a 0a20 2020 2020  *Steps:**..     
-00004830: 2020 202a 2a43 7265 6174 6520 4344 2a2a     **Create CD**
-00004840: 3a20 5061 7261 6c6c 656c 2063 6f6e 7469  : Parallel conti
-00004850: 6e75 6f75 7320 7265 7072 6573 656e 7461  nuous representa
-00004860: 7469 6f6e 7320 6f66 2061 6c6c 2064 6966  tions of all dif
-00004870: 6665 7265 6e74 2073 6f75 7263 6573 2069  ferent sources i
-00004880: 6e20 7468 6520 6275 6666 6572 2e0a 2020  n the buffer..  
-00004890: 2020 2020 2020 5468 6973 2073 7465 7020        This step 
-000048a0: 696e 766f 6c76 6573 2c20 6d61 7463 6869  involves, matchi
-000048b0: 6e67 2074 6865 2064 6966 6665 7265 6e74  ng the different
-000048c0: 2073 616d 706c 6520 7261 7465 7320 6f66   sample rates of
-000048d0: 2064 6966 6665 7265 6e74 2073 6f75 7263   different sourc
-000048e0: 6573 2074 6f20 7468 6174 206f 6620 7468  es to that of th
-000048f0: 6520 7461 7267 6574 2e0a 2020 2020 2020  e target..      
-00004900: 2020 5472 616e 7366 6f72 6d20 7468 6520    Transform the 
-00004910: 4576 656e 7420 736f 7572 6365 7320 746f  Event sources to
-00004920: 2063 6f6e 7469 6e75 6f75 7320 7265 7072   continuous repr
-00004930: 6573 656e 7461 7469 6f6e 2e0a 2020 2020  esentation..    
-00004940: 2020 2020 0a20 2020 2020 2020 202a 2a43      .        **C
-00004950: 616c 6375 6c61 7465 2043 6175 7361 6c69  alculate Causali
-00004960: 7479 2065 6467 6573 2a2a 3a20 5065 7266  ty edges**: Perf
-00004970: 6f72 6d20 4361 7573 616c 2044 6973 636f  orm Causal Disco
-00004980: 7665 7279 2075 7369 6e67 2074 6865 2063  very using the c
-00004990: 6175 7361 6c69 7479 2066 756e 6374 696f  ausality functio
-000049a0: 6e2c 2074 6f20 6372 6561 7465 2065 6467  n, to create edg
-000049b0: 6573 200a 2020 2020 2020 2020 2870 6172  es .        (par
-000049c0: 7420 6f66 2043 5220 6f66 2074 6865 2043  t of CR of the C
-000049d0: 6f6e 7465 7874 290a 2020 2020 2020 2020  ontext).        
-000049e0: 0a20 2020 2020 2020 202a 2a54 6167 2065  .        **Tag e
-000049f0: 6163 6820 6564 6765 2077 6974 6820 6368  ach edge with ch
-00004a00: 6172 6163 7465 7269 7a61 7469 6f6e 2a2a  aracterization**
-00004a10: 3a20 666f 7220 6561 6368 2028 612c 6229  : for each (a,b)
-00004a20: 2069 6e20 7468 6520 6564 6765 732c 2061   in the edges, a
-00004a30: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
-00004a40: 6e20 6f66 2028 756e 6b6e 6f77 6e2c 2064  n of (unknown, d
-00004a50: 6563 7265 6173 652c 0a20 2020 2020 2020  ecrease,.       
-00004a60: 2020 696e 6372 6561 7365 292c 2062 6173    increase), bas
-00004a70: 6564 206f 6e20 7468 6520 7479 7065 206f  ed on the type o
-00004a80: 6620 7468 6520 612e 0a0a 2020 2020 2020  f the a...      
-00004a90: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
-00004aa0: 2a3a 0a0a 2020 2020 2020 2020 202a 2a63  *:..         **c
-00004ab0: 7572 7265 6e74 2a2a 3a20 5468 6520 6375  urrent**: The cu
-00004ac0: 7272 656e 7420 4576 656e 7420 6f66 2074  rrent Event of t
-00004ad0: 6172 6765 7426 2333 393b 7320 6461 7461  arget&#39;s data
-00004ae0: 2077 6869 6368 2074 7269 6765 7220 7468   which triger th
-00004af0: 6520 636f 6e74 6578 7420 6372 6561 7469  e context creati
-00004b00: 6f6e 0a0a 2020 2020 2020 2020 202a 2a62  on..         **b
-00004b10: 7566 6665 722a 2a3a 206f 7264 6572 6564  uffer**: ordered
-00004b20: 206c 6973 7420 7769 7468 2045 7665 6e74   list with Event
-00004b30: 706f 696e 7420 6f66 2061 6c6c 2073 6f75  point of all sou
-00004b40: 7263 6573 2e0a 0a20 2020 2020 2020 2020  rces...         
-00004b50: 2a2a 7265 7475 726e 2a2a 3a20 436f 6e74  **return**: Cont
-00004b60: 6578 7420 6f62 6a65 6374 2e0a 2020 2020  ext object..    
-00004b70: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
-00004b80: 3334 3b0a 2020 2020 2020 2020 2320 7374  34;.        # st
-00004b90: 6172 7420 3d20 7469 6d65 2e74 696d 6528  art = time.time(
-00004ba0: 290a 2020 2020 2020 2020 2320 6466 2077  ).        # df w
-00004bb0: 6974 6820 2c64 742c 636f 6465 2c73 6f75  ith ,dt,code,sou
-00004bc0: 7263 652c 7661 6c75 650a 2020 2020 2020  rce,value.      
-00004bd0: 2020 706f 7320 3d20 7365 6c66 2e63 6f6e    pos = self.con
-00004be0: 7465 7874 5f70 6f73 0a20 2020 2020 2020  text_pos.       
-00004bf0: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00004c00: 706f 732c 206c 656e 2862 7566 6665 7229  pos, len(buffer)
-00004c10: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
-00004c20: 6620 6275 6666 6572 5b69 5d2e 7469 6d65  f buffer[i].time
-00004c30: 7374 616d 7020 266c 743b 3d20 2863 7572  stamp &lt;= (cur
-00004c40: 7265 6e74 2e74 696d 6573 7461 6d70 202d  rent.timestamp -
-00004c50: 2070 642e 5469 6d65 6465 6c74 6128 7365   pd.Timedelta(se
-00004c60: 6c66 2e68 6f72 697a 6f6e 2c20 7365 6c66  lf.horizon, self
-00004c70: 2e68 6f72 697a 6f6e 5f74 696d 6529 293a  .horizon_time)):
-00004c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004c90: 2070 6f73 203d 2069 0a20 2020 2020 2020   pos = i.       
-00004ca0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00004cb0: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00004cc0: 0a0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
-00004cd0: 6f6e 7465 7874 5f70 6f73 203d 2070 6f73  ontext_pos = pos
-00004ce0: 0a20 2020 2020 2020 2023 2065 6e64 3d74  .        # end=t
-00004cf0: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
-00004d00: 2020 2023 2070 7269 6e74 2866 2623 3334     # print(f&#34
-00004d10: 3b66 696e 6420 706f 7369 7469 6f6e 206f  ;find position o
-00004d20: 6e20 6275 6666 6572 3a20 7b65 6e64 2d73  n buffer: {end-s
-00004d30: 7461 7274 7d26 2333 343b 290a 0a20 2020  tart}&#34;)..   
-00004d40: 2020 2020 2023 2073 7461 7274 203d 2074       # start = t
-00004d50: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
-00004d60: 2020 2064 6174 6166 6f72 636f 6e74 6578     dataforcontex
-00004d70: 7420 3d20 6275 6666 6572 5b70 6f73 3a5d  t = buffer[pos:]
-00004d80: 0a20 2020 2020 2020 2064 6174 6174 6f64  .        datatod
-00004d90: 6620 3d20 5b5b 7064 2e74 6f5f 6461 7465  f = [[pd.to_date
-00004da0: 7469 6d65 2865 2e74 696d 6573 7461 6d70  time(e.timestamp
-00004db0: 2920 666f 7220 6520 696e 2064 6174 6166  ) for e in dataf
-00004dc0: 6f72 636f 6e74 6578 745d 2c0a 2020 2020  orcontext],.    
-00004dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004de0: 5b73 7472 2865 2e63 6f64 6529 2066 6f72  [str(e.code) for
-00004df0: 2065 2069 6e20 6461 7461 666f 7263 6f6e   e in dataforcon
-00004e00: 7465 7874 5d2c 0a20 2020 2020 2020 2020  text],.         
-00004e10: 2020 2020 2020 2020 2020 205b 7374 7228             [str(
-00004e20: 652e 736f 7572 6365 2920 666f 7220 6520  e.source) for e 
-00004e30: 696e 2064 6174 6166 6f72 636f 6e74 6578  in dataforcontex
-00004e40: 745d 2c0a 2020 2020 2020 2020 2020 2020  t],.            
-00004e50: 2020 2020 2020 2020 5b65 2e64 6574 6169          [e.detai
-00004e60: 6c73 2066 6f72 2065 2069 6e20 6461 7461  ls for e in data
-00004e70: 666f 7263 6f6e 7465 7874 5d2c 0a20 2020  forcontext],.   
+00001770: 7265 7461 7469 6f6e 730a 6672 6f6d 2070  retations.from p
+00001780: 6174 686c 6962 2069 6d70 6f72 7420 5061  athlib import Pa
+00001790: 7468 0a69 6d70 6f72 7420 7069 636b 6c65  th.import pickle
+000017a0: 0a0a 636c 6173 7320 436f 6e74 6578 7447  ..class ContextG
+000017b0: 656e 6572 6174 6f72 4261 7463 6828 293a  eneratorBatch():
+000017c0: 0a20 2020 2064 6566 205f 5f69 6e69 745f  .    def __init_
+000017d0: 5f28 7365 6c66 2c64 665f 6461 7461 2c74  _(self,df_data,t
+000017e0: 6172 6765 742c 7479 7065 5f6f 665f 7365  arget,type_of_se
+000017f0: 7269 6573 2c63 6f6e 7465 7874 5f68 6f72  ries,context_hor
+00001800: 697a 6f6e 3d26 2333 343b 3820 686f 7572  izon=&#34;8 hour
+00001810: 7326 2333 343b 2c43 6175 7361 6c69 7479  s&#34;,Causality
+00001820: 6675 6e63 743d 6361 6c63 756c 6174 655f  funct=calculate_
+00001830: 7769 7468 5f70 632c 6465 6275 673d 4661  with_pc,debug=Fa
+00001840: 6c73 652c 6669 6c65 5f70 6174 683d 4e6f  lse,file_path=No
+00001850: 6e65 293a 0a20 2020 2020 2020 2026 2333  ne):.        &#3
+00001860: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
+00001870: 2020 2020 2054 6869 7320 7665 7273 696f       This versio
+00001880: 6e20 646f 6573 6e26 2333 393b 7420 7375  n doesn&#39;t su
+00001890: 7070 6f72 7420 696e 7465 7270 7265 7461  pport interpreta
+000018a0: 7469 6f6e 2061 6e64 2069 7320 6372 6561  tion and is crea
+000018b0: 7465 6420 666f 7220 6661 7374 6572 2065  ted for faster e
+000018c0: 7870 6572 696d 656e 7473 2075 7369 6e67  xperiments using
+000018d0: 2043 6f6e 7465 7874 2e0a 0a20 2020 2020   Context...     
+000018e0: 2020 202a 2a64 665f 6461 7461 2a2a 2054     **df_data** T
+000018f0: 6865 2064 6174 6120 746f 2063 6f6e 7369  he data to consi
+00001900: 6465 7220 696e 2063 6f6e 7465 7874 2069  der in context i
+00001910: 6e20 666f 726d 206f 6620 4461 7461 2046  n form of Data F
+00001920: 7261 6d65 2e0a 0a20 2020 2020 2020 202a  rame...        *
+00001930: 2a20 7461 7267 6574 2a2a 2054 6865 206e  * target** The n
+00001940: 616d 6520 6f66 2074 6865 2074 6172 6765  ame of the targe
+00001950: 7420 736f 7572 6365 2c20 7768 6963 6820  t source, which 
+00001960: 7769 6c6c 2062 6520 7573 6564 2061 7320  will be used as 
+00001970: 7468 6520 6261 7365 6c69 6e65 2069 6e20  the baseline in 
+00001980: 6f72 6465 7220 746f 206d 6170 2064 6966  order to map dif
+00001990: 6665 7265 6e74 2073 616d 706c 6573 0a0a  ferent samples..
+000019a0: 2020 2020 2020 2020 2a2a 7479 7065 5f6f          **type_o
+000019b0: 665f 7365 7269 6573 2a2a 3a20 6469 6374  f_series**: dict
+000019c0: 696f 6e61 7279 2077 6869 6368 2064 6566  ionary which def
+000019d0: 696e 6520 7468 6520 7479 7065 206f 6620  ine the type of 
+000019e0: 6561 6368 2073 6572 6965 7320 2869 736f  each series (iso
+000019f0: 6c61 7465 642c 636f 6e66 6967 7572 6174  lated,configurat
+00001a00: 696f 6e20 6f72 2063 6f6e 7469 6e75 6f75  ion or continuou
+00001a10: 7329 0a20 2020 2020 2020 2020 7261 7465  s).         rate
+00001a20: 2074 6f20 7468 6174 206f 6620 7468 6520   to that of the 
+00001a30: 7461 7267 6574 2073 616d 706c 6520 7261  target sample ra
+00001a40: 7465 2e0a 0a20 2020 2020 2020 202a 2a63  te...        **c
+00001a50: 6f6e 7465 7874 5f68 6f72 697a 6f6e 2a2a  ontext_horizon**
+00001a60: 2054 6865 2074 696d 6520 7065 7269 6f64   The time period
+00001a70: 2074 6f20 6c6f 6f6b 2062 6163 6b20 666f   to look back fo
+00001a80: 7220 636f 6e74 6578 7420 6461 7461 2c20  r context data, 
+00001a90: 7468 6520 666f 726d 206f 6620 7468 6174  the form of that
+00001aa0: 2070 6172 616d 6574 6572 2069 7320 2623   parameter is &#
+00001ab0: 3334 3b38 2068 6f75 7273 2623 3334 3b0a  34;8 hours&#34;.
+00001ac0: 0a20 2020 2020 2020 202a 2a43 6175 7361  .        **Causa
+00001ad0: 6c69 7479 6675 6e63 742a 2a20 7468 6520  lityfunct** the 
+00001ae0: 6361 7573 616c 6974 7920 6469 7363 6f76  causality discov
+00001af0: 6572 7920 6d65 7468 6f64 2074 6f20 7573  ery method to us
+00001b00: 6520 746f 2070 726f 6475 6365 2063 6175  e to produce cau
+00001b10: 7361 6c20 7265 6c61 7469 6f6e 7368 6970  sal relationship
+00001b20: 7320 6265 7477 6565 6e20 636f 6e74 6578  s between contex
+00001b30: 7420 6461 7461 2c0a 2020 2020 2020 2020  t data,.        
+00001b40: 2020 2020 5468 6973 206d 7573 7420 6265      This must be
+00001b50: 2061 2066 756e 6374 696f 6e20 7769 7468   a function with
+00001b60: 2070 6172 616d 6574 6572 7320 7477 6f20   parameters two 
+00001b70: 6571 7561 6c20 7369 7a65 206c 6973 7473  equal size lists
+00001b80: 2c20 6f6e 6520 7769 7468 206e 616d 6573  , one with names
+00001b90: 2061 6e64 2074 6865 206f 7468 6572 0a20   and the other. 
+00001ba0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+00001bb0: 6461 7461 2028 6120 6c69 7374 206f 6620  data (a list of 
+00001bc0: 6c69 7374 206f 7220 3244 206e 756d 7079  list or 2D numpy
+00001bd0: 2061 7272 6179 292e 0a0a 2020 2020 2020   array)...      
+00001be0: 2020 2a2a 6465 6275 672a 2a20 4966 2069    **debug** If i
+00001bf0: 7420 7275 6e73 206f 6e20 6465 6275 6720  t runs on debug 
+00001c00: 6d6f 6465 0a0a 2020 2020 2020 2020 2a2a  mode..        **
+00001c10: 6669 6c65 5f70 6174 682a 2a20 5374 6f72  file_path** Stor
+00001c20: 6520 7468 6520 7265 7375 6c74 7320 6f66  e the results of
+00001c30: 2063 6f6e 7465 7874 2069 6e20 7069 636b   context in pick
+00001c40: 6c65 2066 696c 652c 2063 6f6e 7369 6465  le file, conside
+00001c50: 7265 6420 6f6e 6c79 2077 6865 6e20 6974  red only when it
+00001c60: 2069 7320 6e6f 7420 4e6f 6e65 2e0a 2020   is not None..  
+00001c70: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
+00001c80: 2623 3334 3b0a 0a20 2020 2020 2020 2073  &#34;..        s
+00001c90: 656c 662e 6669 6c65 5f70 6174 683d 6669  elf.file_path=fi
+00001ca0: 6c65 5f70 6174 680a 2020 2020 2020 2020  le_path.        
+00001cb0: 7365 6c66 2e64 6562 7567 3d64 6562 7567  self.debug=debug
+00001cc0: 0a20 2020 2020 2020 2073 656c 662e 7461  .        self.ta
+00001cd0: 7267 6574 3d74 6172 6765 740a 2020 2020  rget=target.    
+00001ce0: 2020 2020 7365 6c66 2e64 665f 6461 7461      self.df_data
+00001cf0: 3d64 665f 6461 7461 0a0a 0a20 2020 2020  =df_data...     
+00001d00: 2020 2073 656c 662e 636f 6e74 6578 7473     self.contexts
+00001d10: 3d73 656c 662e 5f6c 6f61 645f 636f 6e74  =self._load_cont
+00001d20: 6578 7473 2829 0a0a 2020 2020 2020 2020  exts()..        
+00001d30: 7365 6c66 2e63 6175 7361 6c69 7479 5f64  self.causality_d
+00001d40: 6973 636f 7665 7279 3d43 6175 7361 6c69  iscovery=Causali
+00001d50: 7479 6675 6e63 740a 2020 2020 2020 2020  tyfunct.        
+00001d60: 7365 6c66 2e62 7566 6665 723d 5b5d 0a0a  self.buffer=[]..
+00001d70: 0a20 2020 2020 2020 2023 6865 6c70 6572  .        #helper
+00001d80: 730a 2020 2020 2020 2020 7365 6c66 2e74  s.        self.t
+00001d90: 7970 655f 6f66 5f73 6572 6965 7320 3d20  ype_of_series = 
+00001da0: 7479 7065 5f6f 665f 7365 7269 6573 0a20  type_of_series. 
+00001db0: 2020 2020 2020 2073 656c 662e 686f 7269         self.hori
+00001dc0: 7a6f 6e20 3d20 636f 6e74 6578 745f 686f  zon = context_ho
+00001dd0: 7269 7a6f 6e2e 7370 6c69 7428 2623 3334  rizon.split(&#34
+00001de0: 3b20 2623 3334 3b29 5b30 5d0a 2020 2020  ; &#34;)[0].    
+00001df0: 2020 2020 6966 206c 656e 2863 6f6e 7465      if len(conte
+00001e00: 7874 5f68 6f72 697a 6f6e 2e73 706c 6974  xt_horizon.split
+00001e10: 2826 2333 343b 2026 2333 343b 2929 203d  (&#34; &#34;)) =
+00001e20: 3d20 313a 0a20 2020 2020 2020 2020 2020  = 1:.           
+00001e30: 2073 656c 662e 686f 7269 7a6f 6e5f 7469   self.horizon_ti
+00001e40: 6d65 203d 2026 2333 343b 686f 7572 7326  me = &#34;hours&
+00001e50: 2333 343b 0a20 2020 2020 2020 2065 6c73  #34;.        els
+00001e60: 653a 0a20 2020 2020 2020 2020 2020 2069  e:.            i
+00001e70: 6620 636f 6e74 6578 745f 686f 7269 7a6f  f context_horizo
+00001e80: 6e2e 7370 6c69 7428 2623 3334 3b20 2623  n.split(&#34; &#
+00001e90: 3334 3b29 5b31 5d20 696e 205b 2623 3334  34;)[1] in [&#34
+00001ea0: 3b64 6179 7326 2333 343b 2c20 2623 3334  ;days&#34;, &#34
+00001eb0: 3b68 6f75 7273 2623 3334 3b2c 2026 2333  ;hours&#34;, &#3
+00001ec0: 343b 6d69 6e75 7465 7326 2333 343b 2c20  4;minutes&#34;, 
+00001ed0: 2623 3334 3b73 6563 6f6e 6473 2623 3334  &#34;seconds&#34
+00001ee0: 3b5d 3a0a 2020 2020 2020 2020 2020 2020  ;]:.            
+00001ef0: 2020 2020 7365 6c66 2e68 6f72 697a 6f6e      self.horizon
+00001f00: 5f74 696d 6520 3d20 636f 6e74 6578 745f  _time = context_
+00001f10: 686f 7269 7a6f 6e2e 7370 6c69 7428 2623  horizon.split(&#
+00001f20: 3334 3b20 2623 3334 3b29 5b31 5d0a 2020  34; &#34;)[1].  
+00001f30: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00001f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001f50: 6173 7365 7274 2046 616c 7365 2c20 2623  assert False, &#
+00001f60: 3334 3b54 696d 6520 686f 7269 7a6f 6e20  34;Time horizon 
+00001f70: 6d75 7374 2062 6520 6569 7468 6572 2061  must be either a
+00001f80: 2073 696e 676c 6520 6e75 6d62 6572 206f   single number o
+00001f90: 7220 696e 2066 6f72 6d20 6f66 205c 2623  r in form of \&#
+00001fa0: 3334 3b38 2068 6f75 7273 5c26 2333 343b  34;8 hours\&#34;
+00001fb0: 2077 6865 7265 2061 6363 6570 7461 626c   where acceptabl
+00001fc0: 6520 7469 6d65 2066 7261 6d65 7320 6172  e time frames ar
+00001fd0: 6520 686f 7572 732c 6461 7973 2c6d 696e  e hours,days,min
+00001fe0: 7574 6573 2c73 6563 6f6e 6473 2623 3334  utes,seconds&#34
+00001ff0: 3b0a 0a20 2020 2020 2020 2073 656c 662e  ;..        self.
+00002000: 686f 7269 7a6f 6e20 3d20 696e 7428 7365  horizon = int(se
+00002010: 6c66 2e68 6f72 697a 6f6e 290a 2020 2020  lf.horizon).    
+00002020: 2020 2020 7365 6c66 2e69 6e74 6572 7072      self.interpr
+00002030: 6574 5f68 6973 746f 7279 5f70 6f73 203d  et_history_pos =
+00002040: 2030 0a20 2020 2020 2020 2073 656c 662e   0.        self.
+00002050: 636f 6e74 6578 745f 706f 7320 3d20 300a  context_pos = 0.
+00002060: 0a0a 2020 2020 6465 6620 6765 6e65 7261  ..    def genera
+00002070: 7465 5f63 6f6e 7465 7874 2873 656c 662c  te_context(self,
+00002080: 6461 7465 7469 6d65 5f69 6e64 6578 293a  datetime_index):
+00002090: 0a20 2020 2020 2020 2063 6f6e 7465 7874  .        context
+000020a0: 7062 6a65 6374 2c20 7461 7267 6574 5f73  pbject, target_s
+000020b0: 6572 6965 735f 6e61 6d65 2c74 696d 655f  eries_name,time_
+000020c0: 696e 6465 783d 7365 6c66 2e63 7265 6174  index=self.creat
+000020d0: 655f 636f 6e74 6578 7428 6461 7465 7469  e_context(dateti
+000020e0: 6d65 5f69 6e64 6578 290a 0a20 2020 2020  me_index)..     
+000020f0: 2020 2073 656c 662e 636f 6e74 6578 7473     self.contexts
+00002100: 5b74 696d 655f 696e 6465 785d 3d63 6f6e  [time_index]=con
+00002110: 7465 7874 7062 6a65 6374 0a0a 2020 2020  textpbject..    
+00002120: 2020 2020 7265 7475 726e 2063 6f6e 7465      return conte
+00002130: 7874 7062 6a65 6374 0a0a 2020 2020 6465  xtpbject..    de
+00002140: 6620 5f73 6176 655f 636f 6e74 6578 7473  f _save_contexts
+00002150: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00002160: 6966 2073 656c 662e 6669 6c65 5f70 6174  if self.file_pat
+00002170: 6820 6973 204e 6f6e 653a 0a20 2020 2020  h is None:.     
+00002180: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+00002190: 2020 2020 2020 7769 7468 206f 7065 6e28        with open(
+000021a0: 7365 6c66 2e66 696c 655f 7061 7468 2c20  self.file_path, 
+000021b0: 2623 3339 3b77 6226 2333 393b 2920 6173  &#39;wb&#39;) as
+000021c0: 2066 3a0a 2020 2020 2020 2020 2020 2020   f:.            
+000021d0: 7069 636b 6c65 2e64 756d 7028 7365 6c66  pickle.dump(self
+000021e0: 2e63 6f6e 7465 7874 732c 2066 290a 0a20  .contexts, f).. 
+000021f0: 2020 2064 6566 205f 6c6f 6164 5f63 6f6e     def _load_con
+00002200: 7465 7874 7328 7365 6c66 293a 0a20 2020  texts(self):.   
+00002210: 2020 2020 2069 6620 7365 6c66 2e66 696c       if self.fil
+00002220: 655f 7061 7468 2069 7320 4e6f 6e65 3a0a  e_path is None:.
+00002230: 2020 2020 2020 2020 2020 2020 7265 7475              retu
+00002240: 726e 207b 7d0a 0a20 2020 2020 2020 206d  rn {}..        m
+00002250: 795f 6669 6c65 203d 2050 6174 6828 7365  y_file = Path(se
+00002260: 6c66 2e66 696c 655f 7061 7468 290a 2020  lf.file_path).  
+00002270: 2020 2020 2020 6966 206d 795f 6669 6c65        if my_file
+00002280: 2e69 735f 6669 6c65 2829 3a0a 2020 2020  .is_file():.    
+00002290: 2020 2020 2020 2020 7769 7468 206f 7065          with ope
+000022a0: 6e28 7365 6c66 2e66 696c 655f 7061 7468  n(self.file_path
+000022b0: 2c20 2623 3339 3b72 6226 2333 393b 2920  , &#39;rb&#39;) 
+000022c0: 6173 2066 3a0a 2020 2020 2020 2020 2020  as f:.          
+000022d0: 2020 2020 2020 7265 7475 726e 2070 6963        return pic
+000022e0: 6b6c 652e 6c6f 6164 2866 290a 2020 2020  kle.load(f).    
+000022f0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00002300: 2020 2020 2020 7265 7475 726e 2020 7b7d        return  {}
+00002310: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
+00002320: 636f 6e74 6578 7428 7365 6c66 2c20 6461  context(self, da
+00002330: 7465 7469 6d65 5f69 6e64 6578 293a 0a0a  tetime_index):..
+00002340: 2020 2020 2020 2020 7374 6172 745f 696e          start_in
+00002350: 6465 7820 3d20 6461 7465 7469 6d65 5f69  dex = datetime_i
+00002360: 6e64 6578 202d 2070 642e 5469 6d65 6465  ndex - pd.Timede
+00002370: 6c74 6128 7365 6c66 2e68 6f72 697a 6f6e  lta(self.horizon
+00002380: 2c20 7365 6c66 2e68 6f72 697a 6f6e 5f74  , self.horizon_t
+00002390: 696d 6529 0a0a 2020 2020 2020 2020 636f  ime)..        co
+000023a0: 6e74 6578 743d 7365 6c66 2e64 665f 6461  ntext=self.df_da
+000023b0: 7461 2e6c 6f63 5b73 7461 7274 5f69 6e64  ta.loc[start_ind
+000023c0: 6578 3a64 6174 6574 696d 655f 696e 6465  ex:datetime_inde
+000023d0: 785d 0a0a 2020 2020 2020 2020 616c 6c63  x]..        allc
+000023e0: 6f64 6573 203d 206e 702e 756e 6971 7565  odes = np.unique
+000023f0: 2873 656c 662e 6466 5f64 6174 612e 636f  (self.df_data.co
+00002400: 6c75 6d6e 7329 0a20 2020 2020 2020 2061  lumns).        a
+00002410: 6c6c 636f 6465 7320 3d20 5b63 6f64 6520  llcodes = [code 
+00002420: 666f 7220 636f 6465 2069 6e20 616c 6c63  for code in allc
+00002430: 6f64 6573 5d0a 2020 2020 2020 2020 616c  odes].        al
+00002440: 6c63 6f64 6573 203d 2073 6574 2861 6c6c  lcodes = set(all
+00002450: 636f 6465 7329 0a0a 2020 2020 2020 2020  codes)..        
+00002460: 2323 2062 7569 6c64 2074 6172 6765 7420  ## build target 
+00002470: 7365 7269 6573 0a20 2020 2020 2020 2074  series.        t
+00002480: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
+00002490: 653d 2073 656c 662e 7461 7267 6574 0a20  e= self.target. 
+000024a0: 2020 2020 2020 2074 6172 6765 745f 7365         target_se
+000024b0: 7269 6573 3d63 6f6e 7465 7874 5b73 656c  ries=context[sel
+000024c0: 662e 7461 7267 6574 5d2e 7661 6c75 6573  f.target].values
+000024d0: 0a0a 2020 2020 2020 2020 2323 2063 7265  ..        ## cre
+000024e0: 6174 6520 7365 7269 6573 2066 6f72 2065  ate series for e
+000024f0: 6163 6820 736f 7572 6365 2028 616c 6c64  ach source (alld
+00002500: 6174 6129 0a20 2020 2020 2020 2061 6c6c  ata).        all
+00002510: 6461 7461 203d 205b 5d0a 2020 2020 2020  data = [].      
+00002520: 2020 666f 7220 636f 6c20 696e 2063 6f6e    for col in con
+00002530: 7465 7874 2e63 6f6c 756d 6e73 3a0a 2020  text.columns:.  
+00002540: 2020 2020 2020 2020 2020 616c 6c64 6174            alldat
+00002550: 612e 6170 7065 6e64 2828 636f 6c2c 2063  a.append((col, c
+00002560: 6f6e 7465 7874 5b63 6f6c 5d2e 7661 6c75  ontext[col].valu
+00002570: 6573 2929 0a20 2020 2020 2020 2023 2065  es)).        # e
+00002580: 6e64 203d 2074 696d 652e 7469 6d65 2829  nd = time.time()
+00002590: 0a20 2020 2020 2020 2023 2070 7269 6e74  .        # print
+000025a0: 2866 2623 3334 3b43 7265 6174 6520 7365  (f&#34;Create se
+000025b0: 7269 6573 3a20 7b65 6e64 2d73 7461 7274  ries: {end-start
+000025c0: 7d26 2333 343b 290a 0a20 2020 2020 2020  }&#34;)..       
+000025d0: 2073 746f 7269 6e67 203d 2073 656c 662e   storing = self.
+000025e0: 6361 6c63 756c 6174 655f 6564 6765 7328  calculate_edges(
+000025f0: 616c 6c64 6174 612c 2063 6f6e 7465 7874  alldata, context
+00002600: 2e69 6e64 6578 5b2d 315d 290a 2020 2020  .index[-1]).    
+00002610: 2020 2020 7374 6f72 696e 675b 2623 3334      storing[&#34
+00002620: 3b63 6861 7261 6374 6572 697a 6174 696f  ;characterizatio
+00002630: 6e26 2333 343b 5d20 3d20 7365 6c66 2e67  n&#34;] = self.g
+00002640: 6574 6361 7261 6374 6572 697a 6528 7374  etcaracterize(st
+00002650: 6f72 696e 6729 0a0a 2020 2020 2020 2020  oring)..        
+00002660: 2320 7072 696e 7428 6626 2333 343b 4361  # print(f&#34;Ca
+00002670: 6c63 756c 6174 6520 6564 6765 733a 207b  lculate edges: {
+00002680: 656e 6420 2d20 7374 6172 747d 2623 3334  end - start}&#34
+00002690: 3b29 0a20 2020 2020 2020 2023 2070 7269  ;).        # pri
+000026a0: 6e74 2826 2333 343b 3d3d 3d3d 3d3d 3d3d  nt(&#34;========
+000026b0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+000026c0: 2623 3334 3b29 0a0a 2020 2020 2020 2020  &#34;)..        
+000026d0: 636f 6e74 6578 7470 626a 6563 7420 3d20  contextpbject = 
+000026e0: 436f 6e74 6578 742e 636f 6e74 6578 745f  Context.context_
+000026f0: 6672 6f6d 5f64 6963 7428 7374 6f72 696e  from_dict(storin
+00002700: 6729 0a20 2020 2020 2020 2072 6574 7572  g).        retur
+00002710: 6e20 636f 6e74 6578 7470 626a 6563 742c  n contextpbject,
+00002720: 2074 6172 6765 745f 7365 7269 6573 5f6e   target_series_n
+00002730: 616d 652c 636f 6e74 6578 742e 696e 6465  ame,context.inde
+00002740: 785b 2d31 5d0a 0a20 2020 2064 6566 2063  x[-1]..    def c
+00002750: 616c 6375 6c61 7465 5f65 6467 6573 2873  alculate_edges(s
+00002760: 656c 662c 616c 6c64 6174 612c 2074 696d  elf,alldata, tim
+00002770: 6573 7461 6d70 293a 0a20 2020 2020 2020  estamp):.       
+00002780: 2023 7374 6172 7420 3d20 7469 6d65 2e74   #start = time.t
+00002790: 696d 6528 290a 2020 2020 2020 2020 7374  ime().        st
+000027a0: 6f72 696e 6720 3d20 7b7d 0a20 2020 2020  oring = {}.     
+000027b0: 2020 2073 746f 7269 6e67 5b26 2333 343b     storing[&#34;
+000027c0: 7469 6d65 7374 616d 7026 2333 343b 5d20  timestamp&#34;] 
+000027d0: 3d20 7469 6d65 7374 616d 700a 0a20 2020  = timestamp..   
+000027e0: 2020 2020 2061 6c6c 6461 7461 5f6e 616d       alldata_nam
+000027f0: 6573 203d 205b 6e6e 5b30 5d20 666f 7220  es = [nn[0] for 
+00002800: 6e6e 2069 6e20 616c 6c64 6174 615d 0a20  nn in alldata]. 
+00002810: 2020 2020 2020 2061 6c6c 6461 7461 5f64         alldata_d
+00002820: 6174 6120 3d20 5b6e 6e5b 315d 2066 6f72  ata = [nn[1] for
+00002830: 206e 6e20 696e 2061 6c6c 6461 7461 5d0a   nn in alldata].
+00002840: 0a20 2020 2020 2020 2066 6f72 206e 616d  .        for nam
+00002850: 6564 642c 2064 6174 6164 6420 696e 207a  edd, datadd in z
+00002860: 6970 2861 6c6c 6461 7461 5f6e 616d 6573  ip(alldata_names
+00002870: 2c20 616c 6c64 6174 615f 6461 7461 293a  , alldata_data):
+00002880: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
+00002890: 7269 6e67 5b6e 616d 6564 645d 203d 2064  ring[namedd] = d
+000028a0: 6174 6164 640a 0a20 2020 2020 2020 2023  atadd..        #
+000028b0: 2046 6f72 2063 6f6e 7465 7874 2077 6974   For context wit
+000028c0: 6820 6d6f 7265 2074 6861 6e20 7477 6f20  h more than two 
+000028d0: 7365 7269 6573 2063 616c 6375 6c61 7465  series calculate
+000028e0: 2050 4320 6361 7375 616c 6974 6965 730a   PC casualities.
+000028f0: 2020 2020 2020 2020 636f 756e 7420 3d20          count = 
+00002900: 6c65 6e28 5b31 2066 6f72 206c 6973 7461  len([1 for lista
+00002910: 2069 6e20 616c 6c64 6174 615f 6461 7461   in alldata_data
+00002920: 2069 6620 6c69 7374 6120 6973 206e 6f74   if lista is not
+00002930: 204e 6f6e 655d 290a 2020 2020 2020 2020   None]).        
+00002940: 6966 2063 6f75 6e74 2026 6774 3b20 3120  if count &gt; 1 
+00002950: 616e 6420 6c65 6e28 616c 6c64 6174 615b  and len(alldata[
+00002960: 305d 5b31 5d29 2026 6774 3b20 353a 0a20  0][1]) &gt; 5:. 
+00002970: 2020 2020 2020 2020 2020 2061 6c6c 6461             allda
+00002980: 7461 5f6e 616d 6573 203d 205b 6e6e 5b30  ta_names = [nn[0
+00002990: 5d20 666f 7220 6e6e 2069 6e20 616c 6c64  ] for nn in alld
+000029a0: 6174 6120 6966 206e 6e5b 315d 2069 7320  ata if nn[1] is 
+000029b0: 6e6f 7420 4e6f 6e65 2061 6e64 206c 656e  not None and len
+000029c0: 2873 6574 286e 6e5b 315d 2929 2667 743b  (set(nn[1]))&gt;
+000029d0: 315d 0a20 2020 2020 2020 2020 2020 2061  1].            a
+000029e0: 6c6c 6461 7461 5f64 6174 6120 3d20 5b6e  lldata_data = [n
+000029f0: 6e5b 315d 2066 6f72 206e 6e20 696e 2061  n[1] for nn in a
+00002a00: 6c6c 6461 7461 2069 6620 6e6e 5b31 5d20  lldata if nn[1] 
+00002a10: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+00002a20: 6c65 6e28 7365 7428 6e6e 5b31 5d29 2926  len(set(nn[1]))&
+00002a30: 6774 3b31 5d0a 0a20 2020 2020 2020 2020  gt;1]..         
+00002a40: 2020 2023 656e 6420 3d20 7469 6d65 2e74     #end = time.t
+00002a50: 696d 6528 290a 2020 2020 2020 2020 2020  ime().          
+00002a60: 2020 2370 7269 6e74 2866 2623 3334 3b62    #print(f&#34;b
+00002a70: 6566 6f72 6520 7b65 6e64 202d 2073 7461  efore {end - sta
+00002a80: 7274 7d26 2333 343b 290a 2020 2020 2020  rt}&#34;).      
+00002a90: 2020 2020 2020 2373 7461 7274 3d74 696d        #start=tim
+00002aa0: 652e 7469 6d65 2829 0a0a 2020 2020 2020  e.time()..      
+00002ab0: 2020 2020 2020 6966 206c 656e 2861 6c6c        if len(all
+00002ac0: 6461 7461 2920 266c 743b 3d20 313a 0a20  data) &lt;= 1:. 
+00002ad0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00002ae0: 6467 6573 203d 205b 5d0a 2020 2020 2020  dges = [].      
+00002af0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00002b00: 2020 2020 2020 2020 2020 2020 6564 6765              edge
+00002b10: 7320 3d20 7365 6c66 2e63 616c 6375 6c61  s = self.calcula
+00002b20: 7465 5f63 6175 7361 6c69 7479 286e 702e  te_causality(np.
+00002b30: 636f 6c75 6d6e 5f73 7461 636b 2861 6c6c  column_stack(all
+00002b40: 6461 7461 5f64 6174 6129 2c20 616c 6c64  data_data), alld
+00002b50: 6174 615f 6e61 6d65 7329 0a20 2020 2020  ata_names).     
+00002b60: 2020 2020 2020 2023 656e 643d 7469 6d65         #end=time
+00002b70: 2e74 696d 6528 290a 2020 2020 2020 2020  .time().        
+00002b80: 2020 2020 2370 7269 6e74 2866 2623 3334      #print(f&#34
+00002b90: 3b61 6374 7561 6c20 6564 6765 2063 616c  ;actual edge cal
+00002ba0: 6375 6c61 7469 6f6e 207b 656e 642d 7374  culation {end-st
+00002bb0: 6172 747d 2623 3334 3b29 0a20 2020 2020  art}&#34;).     
+00002bc0: 2020 2020 2020 2069 6620 6564 6765 7320         if edges 
+00002bd0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00002be0: 2020 2020 2020 2020 2073 696e 676c 6565           singlee
+00002bf0: 6467 6573 203d 205b 5d0a 2020 2020 2020  dges = [].      
+00002c00: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+00002c10: 2020 2020 2020 2020 2020 2020 7369 6e67              sing
+00002c20: 6c65 6564 6765 7320 3d20 6564 6765 730a  leedges = edges.
+00002c30: 2020 2020 2020 2020 2020 2020 2320 7072              # pr
+00002c40: 696e 7428 6564 6765 7329 0a20 2020 2020  int(edges).     
+00002c50: 2020 2020 2020 2073 746f 7269 6e67 5b26         storing[&
+00002c60: 2333 343b 6564 6765 7326 2333 343b 5d20  #34;edges&#34;] 
+00002c70: 3d20 7369 6e67 6c65 6564 6765 730a 2020  = singleedges.  
+00002c80: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00002c90: 2073 746f 7269 6e67 0a20 2020 2020 2020   storing.       
+00002ca0: 2073 746f 7269 6e67 5b26 2333 343b 6564   storing[&#34;ed
+00002cb0: 6765 7326 2333 343b 5d20 3d20 5b5d 0a20  ges&#34;] = []. 
+00002cc0: 2020 2020 2020 2072 6574 7572 6e20 7374         return st
+00002cd0: 6f72 696e 670a 0a20 2020 2064 6566 2063  oring..    def c
+00002ce0: 616c 6375 6c61 7465 5f63 6175 7361 6c69  alculate_causali
+00002cf0: 7479 2873 656c 662c 2064 6174 616f 722c  ty(self, dataor,
+00002d00: 206e 616d 6573 293a 0a20 2020 2020 2020   names):.       
+00002d10: 206e 756d 5f74 696d 655f 7365 7269 6573   num_time_series
+00002d20: 203d 206c 656e 2864 6174 616f 7229 0a20   = len(dataor). 
+00002d30: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
+00002d40: 2e61 7272 6179 2864 6174 616f 7229 0a20  .array(dataor). 
+00002d50: 2020 2020 2020 2065 6467 6573 203d 2073         edges = s
+00002d60: 656c 662e 6361 7573 616c 6974 795f 6469  elf.causality_di
+00002d70: 7363 6f76 6572 7928 6e61 6d65 732c 2064  scovery(names, d
+00002d80: 6174 6129 0a20 2020 2020 2020 2023 2065  ata).        # e
+00002d90: 6467 6573 3d73 656c 662e 6361 6c63 756c  dges=self.calcul
+00002da0: 6174 6577 6974 6850 6328 6e61 6d65 732c  atewithPc(names,
+00002db0: 6461 7461 290a 2020 2020 2020 2020 2320  data).        # 
+00002dc0: 6564 6765 733d 7365 6c66 2e63 616c 6375  edges=self.calcu
+00002dd0: 6c61 7465 7769 7468 5f66 6369 286e 616d  latewith_fci(nam
+00002de0: 6573 2c64 6174 6129 0a20 2020 2020 2020  es,data).       
+00002df0: 2023 2065 6467 6573 3d73 656c 662e 7361   # edges=self.sa
+00002e00: 6c65 7366 6f72 6365 5043 286e 616d 6573  lesforcePC(names
+00002e10: 2c64 6174 6129 0a20 2020 2020 2020 2072  ,data).        r
+00002e20: 6574 7572 6e20 6564 6765 730a 2020 2020  eturn edges.    
+00002e30: 6465 6620 6765 7463 6172 6163 7465 7269  def getcaracteri
+00002e40: 7a65 2873 656c 662c 636f 6e74 6578 7429  ze(self,context)
+00002e50: 3a0a 2020 2020 2020 2020 6564 6765 7320  :.        edges 
+00002e60: 3d20 636f 6e74 6578 745b 2623 3334 3b65  = context[&#34;e
+00002e70: 6467 6573 2623 3334 3b5d 0a20 2020 2020  dges&#34;].     
+00002e80: 2020 2063 6861 7261 6374 6572 697a 6174     characterizat
+00002e90: 696f 6e73 203d 205b 5d0a 2020 2020 2020  ions = [].      
+00002ea0: 2020 666f 7220 6564 6765 2069 6e20 6564    for edge in ed
+00002eb0: 6765 733a 0a20 2020 2020 2020 2020 2020  ges:.           
+00002ec0: 206e 616d 6531 203d 2065 6467 655b 305d   name1 = edge[0]
+00002ed0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
+00002ee0: 6532 203d 2065 6467 655b 315d 0a20 2020  e2 = edge[1].   
+00002ef0: 2020 2020 2020 2020 2076 616c 7565 7331           values1
+00002f00: 203d 2063 6f6e 7465 7874 5b6e 616d 6531   = context[name1
+00002f10: 5d0a 2020 2020 2020 2020 2020 2020 7661  ].            va
+00002f20: 6c75 6573 3220 3d20 5b66 6c6f 6174 286b  lues2 = [float(k
+00002f30: 6174 6929 2066 6f72 206b 6174 6920 696e  ati) for kati in
+00002f40: 2063 6f6e 7465 7874 5b6e 616d 6532 5d5d   context[name2]]
+00002f50: 0a0a 2020 2020 2020 2020 2020 2020 6f63  ..            oc
+00002f60: 6375 7265 6e63 653d 6c65 6e28 7661 6c75  curence=len(valu
+00002f70: 6573 3129 2d31 0a20 2020 2020 2020 2020  es1)-1.         
+00002f80: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+00002f90: 6528 6c65 6e28 7661 6c75 6573 3129 2d32  e(len(values1)-2
+00002fa0: 2c30 2c2d 3129 3a0a 2020 2020 2020 2020  ,0,-1):.        
+00002fb0: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+00002fc0: 7331 5b69 5d20 213d 2076 616c 7565 7331  s1[i] != values1
+00002fd0: 5b2d 315d 3a0a 2020 2020 2020 2020 2020  [-1]:.          
+00002fe0: 2020 2020 2020 2020 2020 6f63 6375 7265            occure
+00002ff0: 6e63 6520 3d20 692b 310a 2020 2020 2020  nce = i+1.      
+00003000: 2020 2020 2020 2020 2020 2020 2020 6272                br
+00003010: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
+00003020: 7072 6576 6975 736f 6363 7572 656e 6365  previusoccurence
+00003030: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+00003040: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00003050: 6f63 6375 7265 6e63 652d 322c 302c 2d31  occurence-2,0,-1
+00003060: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+00003070: 2020 2069 6620 7661 6c75 6573 315b 695d     if values1[i]
+00003080: 2021 3d20 2076 616c 7565 7331 5b6f 6363   !=  values1[occ
+00003090: 7572 656e 6365 2d31 5d3a 0a20 2020 2020  urence-1]:.     
+000030a0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000030b0: 7265 7669 7573 6f63 6375 7265 6e63 6520  reviusoccurence 
+000030c0: 3d20 690a 0a20 2020 2020 2020 2020 2020  = i..           
+000030d0: 2069 6620 6f63 6375 7265 6e63 6520 2d20   if occurence - 
+000030e0: 7072 6576 6975 736f 6363 7572 656e 6365  previusoccurence
+000030f0: 2026 6c74 3b20 323a 2020 2320 6f72 206c   &lt; 2:  # or l
+00003100: 656e 2876 616c 7565 7332 292d 6f63 6375  en(values2)-occu
+00003110: 7265 6e63 6526 6c74 3b32 3a0a 2020 2020  rence&lt;2:.    
+00003120: 2020 2020 2020 2020 2020 2020 6368 6172              char
+00003130: 6163 7465 7269 7a61 7469 6f6e 732e 6170  acterizations.ap
+00003140: 7065 6e64 2826 2333 343b 756b 6e6f 776e  pend(&#34;uknown
+00003150: 2623 3334 3b29 0a20 2020 2020 2020 2020  &#34;).         
+00003160: 2020 2020 2020 2063 6f6e 7469 6e75 650a         continue.
+00003170: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00003180: 6573 3262 6566 6f72 6520 3d20 7661 6c75  es2before = valu
+00003190: 6573 325b 7072 6576 6975 736f 6363 7572  es2[previusoccur
+000031a0: 656e 6365 3a6f 6363 7572 656e 6365 5d0a  ence:occurence].
+000031b0: 2020 2020 2020 2020 2020 2020 2320 7374              # st
+000031c0: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
+000031d0: 7374 6465 7628 7661 6c75 6573 3262 6566  stdev(values2bef
+000031e0: 6f72 6529 0a20 2020 2020 2020 2020 2020  ore).           
+000031f0: 2023 206d 6561 6e20 3d20 7374 6174 6973   # mean = statis
+00003200: 7469 6373 2e73 7464 6576 2876 616c 7565  tics.stdev(value
+00003210: 7332 6265 666f 7265 290a 2020 2020 2020  s2before).      
+00003220: 2020 2020 2020 2320 7661 6c75 6573 3262        # values2b
+00003230: 6566 6f72 653d 5b76 2069 6620 7626 6c74  efore=[v if v&lt
+00003240: 3b6d 6561 6e2b 352a 7374 6476 2065 6c73  ;mean+5*stdv els
+00003250: 6520 6d65 616e 2066 6f72 2076 2069 6e20  e mean for v in 
+00003260: 7661 6c75 6573 3262 6566 6f72 655d 0a0a  values2before]..
+00003270: 2020 2020 2020 2020 2020 2020 2320 7661              # va
+00003280: 6c75 6573 3261 6674 6572 3d76 616c 7565  lues2after=value
+00003290: 7332 5b6f 6363 7572 656e 6365 3a5d 0a20  s2[occurence:]. 
+000032a0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+000032b0: 7332 6166 7465 7220 3d20 5b76 616c 7565  s2after = [value
+000032c0: 7332 5b2d 315d 5d0a 2020 2020 2020 2020  s2[-1]].        
+000032d0: 2020 2020 2320 7374 6476 203d 2073 7461      # stdv = sta
+000032e0: 7469 7374 6963 732e 7374 6465 7628 7661  tistics.stdev(va
+000032f0: 6c75 6573 3261 6674 6572 290a 2020 2020  lues2after).    
+00003300: 2020 2020 2020 2020 2320 6d65 616e 203d          # mean =
+00003310: 2073 7461 7469 7374 6963 732e 7374 6465   statistics.stde
+00003320: 7628 7661 6c75 6573 3261 6674 6572 290a  v(values2after).
+00003330: 2020 2020 2020 2020 2020 2020 2320 7661              # va
+00003340: 6c75 6573 3261 6674 6572 203d 205b 7620  lues2after = [v 
+00003350: 6966 2076 2026 6c74 3b20 6d65 616e 202b  if v &lt; mean +
+00003360: 2033 202a 2073 7464 7620 656c 7365 206d   3 * stdv else m
+00003370: 6561 6e20 666f 7220 7620 696e 2076 616c  ean for v in val
+00003380: 7565 7332 6166 7465 725d 0a0a 2020 2020  ues2after]..    
+00003390: 2020 2020 2020 2020 7374 6476 203d 2073          stdv = s
+000033a0: 7461 7469 7374 6963 732e 7374 6465 7628  tatistics.stdev(
+000033b0: 7661 6c75 6573 3262 6566 6f72 6529 0a20  values2before). 
+000033c0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+000033d0: 6e28 7661 6c75 6573 3262 6566 6f72 6529  n(values2before)
+000033e0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+000033f0: 2020 2020 2020 2063 6861 7220 3d20 2623         char = &#
+00003400: 3334 3b75 6b6e 6f77 6e26 2333 343b 0a20  34;uknown&#34;. 
+00003410: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+00003420: 7374 6174 6973 7469 6373 2e6d 6564 6961  statistics.media
+00003430: 6e28 7661 6c75 6573 3262 6566 6f72 6529  n(values2before)
+00003440: 202d 2073 7461 7469 7374 6963 732e 6d65   - statistics.me
+00003450: 6469 616e 2876 616c 7565 7332 6166 7465  dian(values2afte
+00003460: 7229 2026 6774 3b20 3220 2a20 7374 6476  r) &gt; 2 * stdv
+00003470: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00003480: 2020 6368 6172 203d 2026 2333 343b 6465    char = &#34;de
+00003490: 6372 6561 7365 2623 3334 3b0a 2020 2020  crease&#34;.    
+000034a0: 2020 2020 2020 2020 656c 6966 2073 7461          elif sta
+000034b0: 7469 7374 6963 732e 6d65 6469 616e 2876  tistics.median(v
+000034c0: 616c 7565 7332 6166 7465 7229 202d 2073  alues2after) - s
+000034d0: 7461 7469 7374 6963 732e 6d65 6469 616e  tatistics.median
+000034e0: 2876 616c 7565 7332 6265 666f 7265 2920  (values2before) 
+000034f0: 2667 743b 2032 202a 2073 7464 763a 0a20  &gt; 2 * stdv:. 
+00003500: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00003510: 6861 7220 3d20 2623 3334 3b69 6e63 7265  har = &#34;incre
+00003520: 6173 6526 2333 343b 0a20 2020 2020 2020  ase&#34;.       
+00003530: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00003540: 2020 2020 2020 2020 2020 2063 6861 7220             char 
+00003550: 3d20 2623 3334 3b75 6b6e 6f77 6e26 2333  = &#34;uknown&#3
+00003560: 343b 0a20 2020 2020 2020 2020 2020 2063  4;.            c
+00003570: 6861 7261 6374 6572 697a 6174 696f 6e73  haracterizations
+00003580: 2e61 7070 656e 6428 6368 6172 290a 2020  .append(char).  
+00003590: 2020 2020 2020 7265 7475 726e 2063 6861        return cha
+000035a0: 7261 6374 6572 697a 6174 696f 6e73 0a0a  racterizations..
+000035b0: 0a20 2020 2064 6566 205f 5f64 656c 5f5f  .    def __del__
+000035c0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000035d0: 6966 2073 656c 662e 6669 6c65 5f70 6174  if self.file_pat
+000035e0: 6820 6973 204e 6f6e 653a 0a20 2020 2020  h is None:.     
+000035f0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+00003600: 2020 2020 2020 6d79 5f66 696c 6520 3d20        my_file = 
+00003610: 5061 7468 2873 656c 662e 6669 6c65 5f70  Path(self.file_p
+00003620: 6174 6829 0a20 2020 2020 2020 2069 6620  ath).        if 
+00003630: 6d79 5f66 696c 652e 6973 5f66 696c 6528  my_file.is_file(
+00003640: 293a 0a20 2020 2020 2020 2020 2020 2072  ):.            r
+00003650: 6574 7572 6e0a 2020 2020 2020 2020 656c  eturn.        el
+00003660: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00003670: 7365 6c66 2e5f 7361 7665 5f63 6f6e 7465  self._save_conte
+00003680: 7874 7328 290a 0a63 6c61 7373 2043 6f6e  xts()..class Con
+00003690: 7465 7874 4765 6e65 7261 746f 723a 0a0a  textGenerator:..
+000036a0: 2020 2020 6465 6620 5f5f 696e 6974 5f5f      def __init__
+000036b0: 2873 656c 662c 2074 6172 6765 742c 2063  (self, target, c
+000036c0: 6f6e 7465 7874 5f68 6f72 697a 6f6e 3d26  ontext_horizon=&
+000036d0: 2333 343b 3826 2333 343b 2c20 4361 7573  #34;8&#34;, Caus
+000036e0: 616c 6974 7966 756e 6374 3d63 616c 6375  alityfunct=calcu
+000036f0: 6c61 7465 5f77 6974 685f 7063 2c20 6465  late_with_pc, de
+00003700: 6275 673d 4661 6c73 6529 3a0a 2020 2020  bug=False):.    
+00003710: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
+00003720: 3334 3b0a 2020 2020 2020 2020 5468 6973  34;.        This
+00003730: 2043 6c61 7373 2068 616e 646c 6520 7468   Class handle th
+00003740: 6520 436f 6e74 6578 7420 4765 6e65 7261  e Context Genera
+00003750: 7469 6f6e 2e20 4974 206b 6565 7073 2061  tion. It keeps a
+00003760: 6e20 696e 7465 726e 616c 2062 7566 6665  n internal buffe
+00003770: 7220 746f 2062 7569 6c64 2074 6865 2063  r to build the c
+00003780: 6f6e 7465 7874 2066 6f72 2061 2074 6172  ontext for a tar
+00003790: 6765 7420 7365 7269 6573 2062 6173 6564  get series based
+000037a0: 0a20 2020 2020 2020 206f 6e20 7468 6520  .        on the 
+000037b0: 7072 6f76 6964 6564 2063 6f6e 7465 7874  provided context
+000037c0: 5f68 6f72 697a 6f6e 2e20 416c 6c20 6461  _horizon. All da
+000037d0: 7461 2061 7265 2070 6173 7365 6420 7468  ta are passed th
+000037e0: 6f75 6768 2074 6865 2063 6f6c 6c65 6374  ough the collect
+000037f0: 5f64 6174 6120 6d65 7468 6f64 2c20 7768  _data method, wh
+00003800: 6963 6820 7265 7475 726e 2061 2063 6f72  ich return a cor
+00003810: 7265 7370 6f64 696e 670a 2020 2020 2020  respoding.      
+00003820: 2020 436f 6e74 6578 7420 7768 656e 2074    Context when t
+00003830: 6172 6765 7420 6461 7461 2061 7265 2070  arget data are p
+00003840: 6173 7365 642e 0a0a 0a20 2020 2020 2020  assed....       
+00003850: 202a 2a50 6172 616d 6574 6572 732a 2a3a   **Parameters**:
+00003860: 0a0a 2020 2020 2020 2020 2a2a 7461 7267  ..        **targ
+00003870: 6574 2a2a 3a20 5468 6520 6e61 6d65 206f  et**: The name o
+00003880: 6620 7468 6520 7461 7267 6574 2073 6f75  f the target sou
+00003890: 7263 652c 2077 6869 6368 2077 696c 6c20  rce, which will 
+000038a0: 6265 2075 7365 6420 6173 2074 6865 2062  be used as the b
+000038b0: 6173 656c 696e 6520 696e 206f 7264 6572  aseline in order
+000038c0: 2074 6f20 6d61 7020 6469 6666 6572 656e   to map differen
+000038d0: 7420 7361 6d70 6c65 730a 2020 2020 2020  t samples.      
+000038e0: 2020 2072 6174 6520 746f 2074 6861 7420     rate to that 
+000038f0: 6f66 2074 6865 2074 6172 6765 7420 7361  of the target sa
+00003900: 6d70 6c65 2072 6174 652e 0a0a 2020 2020  mple rate...    
+00003910: 2020 2020 2a2a 636f 6e74 6578 745f 686f      **context_ho
+00003920: 7269 7a6f 6e2a 2a3a 2054 6865 2074 696d  rizon**: The tim
+00003930: 6520 7065 7269 6f64 2074 6f20 6c6f 6f6b  e period to look
+00003940: 2062 6163 6b20 666f 7220 636f 6e74 6578   back for contex
+00003950: 7420 6461 7461 2c20 7468 6520 666f 726d  t data, the form
+00003960: 206f 6620 7468 6174 2070 6172 616d 6574   of that paramet
+00003970: 6572 2069 7320 2623 3334 3b38 2068 6f75  er is &#34;8 hou
+00003980: 7273 2623 3334 3b0a 0a20 2020 2020 2020  rs&#34;..       
+00003990: 202a 2a43 6175 7361 6c69 7479 6675 6e63   **Causalityfunc
+000039a0: 742a 2a3a 2074 6865 2063 6175 7361 6c69  t**: the causali
+000039b0: 7479 2064 6973 636f 7665 7279 206d 6574  ty discovery met
+000039c0: 686f 6420 746f 2075 7365 2074 6f20 7072  hod to use to pr
+000039d0: 6f64 7563 6520 6361 7573 616c 2072 656c  oduce causal rel
+000039e0: 6174 696f 6e73 6869 7073 2062 6574 7765  ationships betwe
+000039f0: 656e 2063 6f6e 7465 7874 2064 6174 612c  en context data,
+00003a00: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
+00003a10: 7320 6d75 7374 2062 6520 6120 6675 6e63  s must be a func
+00003a20: 7469 6f6e 2077 6974 6820 7061 7261 6d65  tion with parame
+00003a30: 7465 7273 2074 776f 2065 7175 616c 2073  ters two equal s
+00003a40: 697a 6520 6c69 7374 732c 206f 6e65 2077  ize lists, one w
+00003a50: 6974 6820 6e61 6d65 7320 616e 6420 7468  ith names and th
+00003a60: 6520 6f74 6865 720a 2020 2020 2020 2020  e other.        
+00003a70: 2020 2020 7769 7468 2064 6174 6120 2861      with data (a
+00003a80: 206c 6973 7420 6f66 206c 6973 7420 6f72   list of list or
+00003a90: 2032 4420 6e75 6d70 7920 6172 7261 7929   2D numpy array)
+00003aa0: 2e0a 0a20 2020 2020 2020 202a 2a64 6562  ...        **deb
+00003ab0: 7567 2a2a 3a20 4966 2069 7420 7275 6e73  ug**: If it runs
+00003ac0: 206f 6e20 6465 6275 6720 6d6f 6465 0a20   on debug mode. 
+00003ad0: 2020 2020 2020 2026 2333 343b 2623 3334         &#34;&#34
+00003ae0: 3b26 2333 343b 0a0a 2020 2020 2020 2020  ;&#34;..        
+00003af0: 7365 6c66 2e64 6562 7567 203d 2064 6562  self.debug = deb
+00003b00: 7567 0a20 2020 2020 2020 2073 656c 662e  ug.        self.
+00003b10: 7461 7267 6574 203d 2074 6172 6765 740a  target = target.
+00003b20: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+00003b30: 6e74 6578 7473 203d 205b 5d0a 0a20 2020  ntexts = []..   
+00003b40: 2020 2020 2073 656c 662e 6361 7573 616c       self.causal
+00003b50: 6974 795f 6469 7363 6f76 6572 7920 3d20  ity_discovery = 
+00003b60: 4361 7573 616c 6974 7966 756e 6374 0a20  Causalityfunct. 
+00003b70: 2020 2020 2020 2073 656c 662e 6275 6666         self.buff
+00003b80: 6572 203d 205b 5d0a 0a20 2020 2020 2020  er = []..       
+00003b90: 2023 2068 656c 7065 7273 0a20 2020 2020   # helpers.     
+00003ba0: 2020 2073 656c 662e 7479 7065 5f6f 665f     self.type_of_
+00003bb0: 7365 7269 6573 203d 207b 7d0a 2020 2020  series = {}.    
+00003bc0: 2020 2020 7365 6c66 2e68 6f72 697a 6f6e      self.horizon
+00003bd0: 203d 2063 6f6e 7465 7874 5f68 6f72 697a   = context_horiz
+00003be0: 6f6e 2e73 706c 6974 2826 2333 343b 2026  on.split(&#34; &
+00003bf0: 2333 343b 295b 305d 0a20 2020 2020 2020  #34;)[0].       
+00003c00: 2069 6620 6c65 6e28 636f 6e74 6578 745f   if len(context_
+00003c10: 686f 7269 7a6f 6e2e 7370 6c69 7428 2623  horizon.split(&#
+00003c20: 3334 3b20 2623 3334 3b29 2920 3d3d 2031  34; &#34;)) == 1
+00003c30: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00003c40: 6c66 2e68 6f72 697a 6f6e 5f74 696d 6520  lf.horizon_time 
+00003c50: 3d20 2623 3334 3b68 6f75 7273 2623 3334  = &#34;hours&#34
+00003c60: 3b0a 2020 2020 2020 2020 656c 7365 3a0a  ;.        else:.
+00003c70: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00003c80: 6f6e 7465 7874 5f68 6f72 697a 6f6e 2e73  ontext_horizon.s
+00003c90: 706c 6974 2826 2333 343b 2026 2333 343b  plit(&#34; &#34;
+00003ca0: 295b 315d 2069 6e20 5b26 2333 343b 6461  )[1] in [&#34;da
+00003cb0: 7973 2623 3334 3b2c 2026 2333 343b 686f  ys&#34;, &#34;ho
+00003cc0: 7572 7326 2333 343b 2c20 2623 3334 3b6d  urs&#34;, &#34;m
+00003cd0: 696e 7574 6573 2623 3334 3b2c 2026 2333  inutes&#34;, &#3
+00003ce0: 343b 7365 636f 6e64 7326 2333 343b 5d3a  4;seconds&#34;]:
+00003cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003d00: 2073 656c 662e 686f 7269 7a6f 6e5f 7469   self.horizon_ti
+00003d10: 6d65 203d 2063 6f6e 7465 7874 5f68 6f72  me = context_hor
+00003d20: 697a 6f6e 2e73 706c 6974 2826 2333 343b  izon.split(&#34;
+00003d30: 2026 2333 343b 295b 315d 0a20 2020 2020   &#34;)[1].     
+00003d40: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00003d50: 2020 2020 2020 2020 2020 2020 2061 7373               ass
+00003d60: 6572 7420 4661 6c73 652c 2026 2333 343b  ert False, &#34;
+00003d70: 5469 6d65 2068 6f72 697a 6f6e 206d 7573  Time horizon mus
+00003d80: 7420 6265 2065 6974 6865 7220 6120 7369  t be either a si
+00003d90: 6e67 6c65 206e 756d 6265 7220 6f72 2069  ngle number or i
+00003da0: 6e20 666f 726d 206f 6620 5c26 2333 343b  n form of \&#34;
+00003db0: 3820 686f 7572 735c 2623 3334 3b20 7768  8 hours\&#34; wh
+00003dc0: 6572 6520 6163 6365 7074 6162 6c65 2074  ere acceptable t
+00003dd0: 696d 6520 6672 616d 6573 2061 7265 2068  ime frames are h
+00003de0: 6f75 7273 2c64 6179 732c 6d69 6e75 7465  ours,days,minute
+00003df0: 732c 7365 636f 6e64 7326 2333 343b 0a0a  s,seconds&#34;..
+00003e00: 2020 2020 2020 2020 7365 6c66 2e68 6f72          self.hor
+00003e10: 697a 6f6e 203d 2069 6e74 2873 656c 662e  izon = int(self.
+00003e20: 686f 7269 7a6f 6e29 0a20 2020 2020 2020  horizon).       
+00003e30: 2073 656c 662e 696e 7465 7270 7265 745f   self.interpret_
+00003e40: 6869 7374 6f72 795f 706f 7320 3d20 300a  history_pos = 0.
+00003e50: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+00003e60: 7465 7874 5f70 6f73 203d 2030 0a0a 2020  text_pos = 0..  
+00003e70: 2020 6465 6620 636f 6c6c 6563 745f 6461    def collect_da
+00003e80: 7461 2873 656c 662c 2074 696d 6573 7461  ta(self, timesta
+00003e90: 6d70 2c20 736f 7572 6365 2c20 6e61 6d65  mp, source, name
+00003ea0: 2c20 7661 6c75 653d 4e6f 6e65 2c20 7479  , value=None, ty
+00003eb0: 7065 3d26 2333 343b 556e 6976 6172 6961  pe=&#34;Univaria
+00003ec0: 7465 2623 3334 3b2c 7265 706c 6163 653d  te&#34;,replace=
+00003ed0: 5b5d 293a 0a20 2020 2020 2020 2026 2333  []):.        &#3
+00003ee0: 393b 2623 3339 3b26 2333 393b 0a20 2020  9;&#39;&#39;.   
+00003ef0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00003f00: 2069 7320 7573 6564 2077 6865 6e20 6461   is used when da
+00003f10: 7461 2061 7265 2070 6173 7365 6420 6974  ta are passed it
+00003f20: 6572 6174 6976 656c 792c 2061 6e64 2073  eratively, and s
+00003f30: 746f 7265 6420 696e 2062 7566 6665 720a  tored in buffer.
+00003f40: 2020 2020 2020 2020 5768 656e 2064 6174          When dat
+00003f50: 6120 6f66 2074 6172 6765 7420 736f 7572  a of target sour
+00003f60: 6365 2061 7272 6976 652c 2061 2063 6f72  ce arrive, a cor
+00003f70: 7265 7370 6f6e 6469 6e67 2063 6f6e 7465  responding conte
+00003f80: 7874 2069 7320 7072 6f64 7563 6564 2e0a  xt is produced..
+00003f90: 2020 2020 2020 2020 536f 7572 6365 7320          Sources 
+00003fa0: 6361 6e20 6265 206f 6620 6469 6666 6572  can be of differ
+00003fb0: 656e 7420 7361 6d70 6c65 2072 6174 6520  ent sample rate 
+00003fc0: 2861 6c6c 2073 6f75 7263 6573 2061 7265  (all sources are
+00003fd0: 206d 6170 7065 6420 746f 2074 6865 2074   mapped to the t
+00003fe0: 6172 6765 7473 2073 616d 706c 6520 7261  argets sample ra
+00003ff0: 7465 2077 6865 6e20 636f 6e74 6578 7420  te when context 
+00004000: 6973 2070 726f 6475 6365 6429 0a0a 2020  is produced)..  
+00004010: 2020 2020 2020 536f 7572 6365 7320 6361        Sources ca
+00004020: 6e20 6265 206f 6620 6569 7468 6572 3a0a  n be of either:.
+00004030: 0a20 2020 2020 2020 2031 2920 436f 6e74  .        1) Cont
+00004040: 696e 756f 7573 2074 7970 6520 2874 686f  inuous type (tho
+00004050: 7365 2074 6861 7420 6861 7665 2073 6f6d  se that have som
+00004060: 6520 6b69 6e64 206f 6620 6172 6974 686d  e kind of arithm
+00004070: 6574 6963 2076 616c 7565 290a 0a20 2020  etic value)..   
+00004080: 2020 2020 2032 2920 4469 7363 7265 7465       2) Discrete
+00004090: 2065 7665 6e74 7320 2877 6974 686f 7574   events (without
+000040a0: 2076 616c 7565 2920 2c20 7768 6572 6520   value) , where 
+000040b0: 6f6e 6520 6f66 2074 6865 2074 7970 6520  one of the type 
+000040c0: 6973 6f6c 6174 6564 206f 7220 636f 6e66  isolated or conf
+000040d0: 6967 7572 6174 696f 6e20 6d75 7374 2062  iguration must b
+000040e0: 6520 6173 7369 676e 6564 0a20 2020 2020  e assigned.     
+000040f0: 2020 2020 2020 2041 2067 7569 6465 206f         A guide o
+00004100: 6e20 686f 7720 746f 2073 7065 6369 6679  n how to specify
+00004110: 2074 6865 2074 7970 6520 6973 2c20 7468   the type is, th
+00004120: 6174 2065 7665 6e74 7320 7768 6963 6820  at events which 
+00004130: 6173 7375 6d65 6420 746f 2068 6176 6520  assumed to have 
+00004140: 696d 7061 6374 206f 6e6c 7920 6f6e 2074  impact only on t
+00004150: 6865 6972 206f 6363 7572 7265 6e63 652c  heir occurrence,
+00004160: 2061 7265 2063 616c 6c65 640a 2020 2020   are called.    
+00004170: 2020 2020 2020 2020 6973 6f6c 6174 6564          isolated
+00004180: 2c20 7768 696c 6520 6f74 6865 7273 2074  , while others t
+00004190: 6861 7420 6172 6520 7265 6c61 7465 6420  hat are related 
+000041a0: 746f 2073 6f6d 6520 6b69 6e64 206f 6620  to some kind of 
+000041b0: 636f 6e66 6967 7572 6174 696f 6e20 7769  configuration wi
+000041c0: 7468 206d 6f72 6520 7065 726d 616e 656e  th more permanen
+000041d0: 7420 696d 7061 6374 2c20 6172 6520 6361  t impact, are ca
+000041e0: 6c6c 6564 2063 6f6e 6669 6775 7261 7469  lled configurati
+000041f0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+00004200: 4573 7365 6e74 6961 6c6c 7920 7468 6520  Essentially the 
+00004210: 7479 7065 206f 6620 7468 6520 6576 656e  type of the even
+00004220: 7473 2064 6566 696e 6520 7468 6520 7761  ts define the wa
+00004230: 7920 7468 6174 2077 696c 6c20 6265 2074  y that will be t
+00004240: 7261 6e73 666f 726d 6564 2074 6f20 7265  ransformed to re
+00004250: 616c 2076 616c 7565 7320 7469 6d65 2d73  al values time-s
+00004260: 6572 6965 732e 0a0a 2020 2020 2020 2020  eries...        
+00004270: 2a2a 5061 7261 6d65 7465 7273 2a2a 3a0a  **Parameters**:.
+00004280: 0a20 2020 2020 2020 202a 2a74 696d 6573  .        **times
+00004290: 7461 6d70 2a2a 3a20 2054 6865 2074 696d  tamp**:  The tim
+000042a0: 6573 7461 6d70 206f 6620 7468 6520 6172  estamp of the ar
+000042b0: 7269 7665 6420 7661 6c75 650a 0a20 2020  rived value..   
+000042c0: 2020 2020 202a 2a73 6f75 7263 652a 2a3a       **source**:
+000042d0: 2054 6865 2073 6f75 7263 6520 6f66 2074   The source of t
+000042e0: 6865 2061 7272 6976 6564 2076 616c 7565  he arrived value
+000042f0: 0a0a 2020 2020 2020 2020 2a2a 6e61 6d65  ..        **name
+00004300: 2a2a 3a20 5468 6520 6e61 6d65 2028 6f72  **: The name (or
+00004310: 2069 6465 6e74 6966 6965 7229 206f 6620   identifier) of 
+00004320: 7468 6520 6172 7269 7665 6420 7661 6c75  the arrived valu
+00004330: 650a 0a20 2020 2020 2020 202a 2a76 616c  e..        **val
+00004340: 7565 2a2a 3a20 5468 6520 7661 6c75 6520  ue**: The value 
+00004350: 2866 6c6f 6174 292c 2069 6e20 6361 7365  (float), in case
+00004360: 2074 6869 7320 6973 204e 6f6e 6520 7468   this is None th
+00004370: 6520 6172 7269 7665 6420 6461 7461 2069  e arrived data i
+00004380: 7320 636f 6e73 6964 6572 6564 2061 7320  s considered as 
+00004390: 6576 656e 740a 0a20 2020 2020 2020 202a  event..        *
+000043a0: 2a74 7970 652a 2a3a 2074 6865 2074 7970  *type**: the typ
+000043b0: 6520 6f66 2074 6865 2064 6174 6120 6361  e of the data ca
+000043c0: 6e20 6265 206f 6e65 206f 6620 2623 3334  n be one of &#34
+000043d0: 3b69 736f 6c61 7465 6426 2333 343b 2c26  ;isolated&#34;,&
+000043e0: 2333 343b 636f 6e66 6967 7572 6174 696f  #34;configuratio
+000043f0: 6e26 2333 343b 2077 6865 6e20 6e6f 2076  n&#34; when no v
+00004400: 616c 7565 2069 7320 7061 7373 6564 0a0a  alue is passed..
+00004410: 2020 2020 2020 2020 2a2a 7265 706c 6163          **replac
+00004420: 652a 2a3a 2061 206c 6973 7420 6f66 2074  e**: a list of t
+00004430: 7570 6c65 732c 2077 6869 6368 2064 6566  uples, which def
+00004440: 696e 6520 6120 7265 706c 6163 656d 656e  ine a replacemen
+00004450: 7420 706f 6c69 6379 2e20 4966 2061 2074  t policy. If a t
+00004460: 7570 6c65 2028 652c 6229 2065 7869 7374  uple (e,b) exist
+00004470: 2069 6e20 7265 706c 6163 6520 6c69 7374   in replace list
+00004480: 2c20 7468 656e 0a20 2020 2020 2020 2077  , then.        w
+00004490: 6865 6e20 6120 6220 6576 656e 7420 6973  hen a b event is
+000044a0: 2069 6e73 6572 7465 642c 2069 7420 7769   inserted, it wi
+000044b0: 6c6c 2072 6570 6c61 6365 2061 6e20 6520  ll replace an e 
+000044c0: 6576 656e 7420 7769 7468 2074 6865 2073  event with the s
+000044d0: 616d 6520 7469 6d65 7374 616d 7020 2869  ame timestamp (i
+000044e0: 6620 6578 6973 7473 292e 0a0a 2020 2020  f exists)...    
+000044f0: 2020 2020 2a2a 7265 7475 726e 2a2a 3a20      **return**: 
+00004500: 2073 7472 7563 7475 7265 2e43 6f6e 7465   structure.Conte
+00004510: 7874 206f 626a 6563 7420 7768 656e 2074  xt object when t
+00004520: 6865 2064 6174 6120 6e61 6d65 206d 6174  he data name mat
+00004530: 6368 2074 6f20 7468 6520 7461 7267 6574  ch to the target
+00004540: 206e 616d 6520 6f72 204e 6f6e 652e 0a20   name or None.. 
+00004550: 2020 2020 2020 2026 2333 393b 2623 3339         &#39;&#39
+00004560: 3b26 2333 393b 0a0a 2020 2020 2020 2020  ;&#39;..        
+00004570: 6966 2076 616c 7565 2069 7320 4e6f 6e65  if value is None
+00004580: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00004590: 2074 7970 6520 6e6f 7420 696e 205b 2623   type not in [&#
+000045a0: 3334 3b69 736f 6c61 7465 6426 2333 343b  34;isolated&#34;
+000045b0: 2c20 2623 3334 3b63 6f6e 6669 6775 7261  , &#34;configura
+000045c0: 7469 6f6e 2623 3334 3b5d 3a0a 2020 2020  tion&#34;]:.    
+000045d0: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+000045e0: 7274 2046 616c 7365 2c20 2623 3334 3b54  rt False, &#34;T
+000045f0: 6865 2074 7970 6520 6d75 7374 2062 6520  he type must be 
+00004600: 6465 6669 6e65 6420 6173 206f 6e65 206f  defined as one o
+00004610: 6620 5c26 2333 343b 6973 6f6c 6174 6564  f \&#34;isolated
+00004620: 5c26 2333 343b 2061 6e64 205c 2623 3334  \&#34; and \&#34
+00004630: 3b63 6f6e 6669 6775 7261 7469 6f6e 5c26  ;configuration\&
+00004640: 2333 343b 2077 6865 6e20 6e6f 2076 616c  #34; when no val
+00004650: 7565 2069 7320 7061 7373 6564 2623 3334  ue is passed&#34
+00004660: 3b0a 2020 2020 2020 2020 6576 656e 7470  ;.        eventp
+00004670: 6f69 6e74 203d 2045 7665 6e74 706f 696e  oint = Eventpoin
+00004680: 7428 636f 6465 3d6e 616d 652c 2073 6f75  t(code=name, sou
+00004690: 7263 653d 736f 7572 6365 2c20 7469 6d65  rce=source, time
+000046a0: 7374 616d 703d 7469 6d65 7374 616d 702c  stamp=timestamp,
+000046b0: 2064 6574 6169 6c73 3d76 616c 7565 2c20   details=value, 
+000046c0: 7479 7065 3d74 7970 6529 0a20 2020 2020  type=type).     
+000046d0: 2020 2073 656c 662e 6164 645f 746f 5f62     self.add_to_b
+000046e0: 7566 6665 7228 6576 656e 7470 6f69 6e74  uffer(eventpoint
+000046f0: 2c72 6570 6c61 6365 290a 2020 2020 2020  ,replace).      
+00004700: 2020 6966 2073 656c 662e 7461 7267 6574    if self.target
+00004710: 203d 3d20 6e61 6d65 206f 7220 7365 6c66   == name or self
+00004720: 2e74 6172 6765 7420 3d3d 2066 2623 3334  .target == f&#34
+00004730: 3b7b 6e61 6d65 7d40 7b73 6f75 7263 657d  ;{name}@{source}
+00004740: 2623 3334 3b3a 0a20 2020 2020 2020 2020  &#34;:.         
+00004750: 2020 2063 6f6e 7465 7874 6f62 6a65 6374     contextobject
+00004760: 203d 2073 656c 662e 6765 6e65 7261 7465   = self.generate
+00004770: 5f63 6f6e 7465 7874 2865 3d65 7665 6e74  _context(e=event
+00004780: 706f 696e 742c 2062 7566 6665 723d 7365  point, buffer=se
+00004790: 6c66 2e62 7566 6665 7229 0a20 2020 2020  lf.buffer).     
+000047a0: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+000047b0: 6e74 6578 746f 626a 6563 740a 2020 2020  ntextobject.    
+000047c0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+000047d0: 2020 2020 2020 7265 7475 726e 204e 6f6e        return Non
+000047e0: 650a 0a20 2020 2064 6566 2061 6464 5f74  e..    def add_t
+000047f0: 6f5f 6275 6666 6572 2873 656c 662c 2065  o_buffer(self, e
+00004800: 3a20 4576 656e 7470 6f69 6e74 2c20 7265  : Eventpoint, re
+00004810: 706c 6163 653a 206c 6973 7429 3a0a 2020  place: list):.  
+00004820: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
+00004830: 2623 3334 3b0a 2020 2020 2020 2020 4164  &#34;.        Ad
+00004840: 6473 2061 6e20 4576 656e 7420 706f 696e  ds an Event poin
+00004850: 7420 746f 2074 6865 2062 7566 6665 7220  t to the buffer 
+00004860: 286b 6565 7069 6e67 2074 6865 2062 7566  (keeping the buf
+00004870: 6665 7220 7469 6d65 206f 7264 6572 6564  fer time ordered
+00004880: 290a 2020 2020 2020 2020 2623 3334 3b26  ).        &#34;&
+00004890: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
+000048a0: 2020 696e 6465 7820 3d20 6c65 6e28 7365    index = len(se
+000048b0: 6c66 2e62 7566 6665 7229 0a20 2020 2020  lf.buffer).     
+000048c0: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+000048d0: 6528 6c65 6e28 7365 6c66 2e62 7566 6665  e(len(self.buffe
+000048e0: 7229 202d 2031 2c20 302c 202d 3129 3a0a  r) - 1, 0, -1):.
+000048f0: 2020 2020 2020 2020 2020 2020 2320 6368              # ch
+00004900: 6563 6b20 666f 7220 7265 706c 6163 656d  eck for replacem
+00004910: 656e 740a 2020 2020 2020 2020 2020 2020  ent.            
+00004920: 6966 2073 656c 662e 6275 6666 6572 5b69  if self.buffer[i
+00004930: 5d2e 7469 6d65 7374 616d 7020 3d3d 2065  ].timestamp == e
+00004940: 2e74 696d 6573 7461 6d70 3a0a 2020 2020  .timestamp:.    
+00004950: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00004960: 7265 7020 696e 2072 6570 6c61 6365 3a0a  rep in replace:.
+00004970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004980: 2020 2020 6966 2073 656c 662e 6275 6666      if self.buff
+00004990: 6572 5b69 5d2e 636f 6465 3d3d 7265 705b  er[i].code==rep[
+000049a0: 305d 2061 6e64 2065 2e63 6f64 653d 3d72  0] and e.code==r
+000049b0: 6570 5b31 5d3a 0a20 2020 2020 2020 2020  ep[1]:.         
+000049c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+000049d0: 656c 662e 6275 6666 6572 5b69 5d3d 650a  elf.buffer[i]=e.
+000049e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049f0: 2020 2020 2020 2020 7265 7475 726e 0a20          return. 
+00004a00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00004a10: 6e64 6578 203d 2069 202b 2031 0a20 2020  ndex = i + 1.   
+00004a20: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+00004a30: 2e62 7566 6665 725b 695d 2e74 696d 6573  .buffer[i].times
+00004a40: 7461 6d70 2026 6c74 3b20 652e 7469 6d65  tamp &lt; e.time
+00004a50: 7374 616d 703a 0a20 2020 2020 2020 2020  stamp:.         
+00004a60: 2020 2020 2020 2069 6e64 6578 203d 2069         index = i
+00004a70: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
+00004a80: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+00004a90: 2020 2069 6620 696e 6465 7820 3d3d 206c     if index == l
+00004aa0: 656e 2873 656c 662e 6275 6666 6572 293a  en(self.buffer):
+00004ab0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00004ac0: 662e 6275 6666 6572 2e61 7070 656e 6428  f.buffer.append(
+00004ad0: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
+00004ae0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00004af0: 662e 6275 6666 6572 203d 2073 656c 662e  f.buffer = self.
+00004b00: 6275 6666 6572 5b3a 2069 6e64 6578 5d20  buffer[: index] 
+00004b10: 2b20 5b65 5d20 2b20 7365 6c66 2e62 7566  + [e] + self.buf
+00004b20: 6665 725b 696e 6465 783a 5d0a 0a20 2020  fer[index:]..   
+00004b30: 2020 2020 206c 6173 7420 3d20 7365 6c66       last = self
+00004b40: 2e62 7566 6665 725b 2d31 5d0a 2020 2020  .buffer[-1].    
+00004b50: 2020 2020 706f 7320 3d20 6c65 6e28 7365      pos = len(se
+00004b60: 6c66 2e62 7566 6665 7229 202d 2031 0a20  lf.buffer) - 1. 
+00004b70: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00004b80: 7261 6e67 6528 6c65 6e28 7365 6c66 2e62  range(len(self.b
+00004b90: 7566 6665 7229 293a 0a20 2020 2020 2020  uffer)):.       
+00004ba0: 2020 2020 2069 6620 7365 6c66 2e62 7566       if self.buf
+00004bb0: 6665 725b 695d 2e74 696d 6573 7461 6d70  fer[i].timestamp
+00004bc0: 2026 6774 3b3d 2028 6c61 7374 2e74 696d   &gt;= (last.tim
+00004bd0: 6573 7461 6d70 202d 2070 642e 5469 6d65  estamp - pd.Time
+00004be0: 6465 6c74 6128 7365 6c66 2e68 6f72 697a  delta(self.horiz
+00004bf0: 6f6e 2c20 7365 6c66 2e68 6f72 697a 6f6e  on, self.horizon
+00004c00: 5f74 696d 6529 293a 0a20 2020 2020 2020  _time)):.       
+00004c10: 2020 2020 2020 2020 2070 6f73 203d 2069           pos = i
+00004c20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00004c30: 2062 7265 616b 0a20 2020 2020 2020 2073   break.        s
+00004c40: 656c 662e 6275 6666 6572 203d 2073 656c  elf.buffer = sel
+00004c50: 662e 6275 6666 6572 5b70 6f73 3a5d 0a0a  f.buffer[pos:]..
+00004c60: 2020 2020 6465 6620 6765 6e65 7261 7465      def generate
+00004c70: 5f63 6f6e 7465 7874 2873 656c 662c 2065  _context(self, e
+00004c80: 3a20 4576 656e 7470 6f69 6e74 2c20 6275  : Eventpoint, bu
+00004c90: 6666 6572 293a 0a20 2020 2020 2020 2026  ffer):.        &
+00004ca0: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
+00004cb0: 2020 2020 2020 2047 656e 6572 6174 6520         Generate 
+00004cc0: 636f 6e74 6578 7420 616e 6420 696e 7465  context and inte
+00004cd0: 7270 7265 7461 7469 6f6e 2e0a 0a20 2020  rpretation...   
+00004ce0: 2020 2020 202a 2a50 6172 616d 6574 6572       **Parameter
+00004cf0: 732a 2a3a 0a0a 2020 2020 2020 2020 2a2a  s**:..        **
+00004d00: 652a 2a3a 2045 7665 6e74 706f 696e 7420  e**: Eventpoint 
+00004d10: 7265 6c61 7465 6420 746f 2074 6865 206c  related to the l
+00004d20: 6173 7420 7461 7267 6574 2623 3339 3b73  ast target&#39;s
+00004d30: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
+00004d40: 2a2a 6275 6666 6572 2a2a 3a20 4120 6c69  **buffer**: A li
+00004d50: 7374 2077 6974 6820 616c 6c20 4576 656e  st with all Even
+00004d60: 7470 6f69 6e74 7320 696e 2074 6865 2074  tpoints in the t
+00004d70: 696d 6520 686f 7269 7a6f 6e0a 2020 2020  ime horizon.    
+00004d80: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
+00004d90: 3334 3b0a 0a20 2020 2020 2020 2063 6f6e  34;..        con
+00004da0: 7465 7874 6375 7272 656e 742c 2074 6172  textcurrent, tar
+00004db0: 6765 745f 7365 7269 6573 5f6e 616d 6520  get_series_name 
+00004dc0: 3d20 7365 6c66 2e63 7265 6174 655f 636f  = self.create_co
+00004dd0: 6e74 6578 7428 652c 2062 7566 6665 7229  ntext(e, buffer)
+00004de0: 0a0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
+00004df0: 6f6e 7465 7874 732e 6170 7065 6e64 2863  ontexts.append(c
+00004e00: 6f6e 7465 7874 6375 7272 656e 7429 0a20  ontextcurrent). 
+00004e10: 2020 2020 2020 2073 656c 662e 6372 6561         self.crea
+00004e20: 7465 5f69 6e74 6572 7072 6574 6174 696f  te_interpretatio
+00004e30: 6e28 636f 6e74 6578 7463 7572 7265 6e74  n(contextcurrent
+00004e40: 2c20 7461 7267 6574 5f73 6572 6965 735f  , target_series_
+00004e50: 6e61 6d65 290a 0a20 2020 2020 2020 2069  name)..        i
+00004e60: 6e74 6572 7475 7073 203d 205b 7474 7475  ntertups = [tttu
+00004e70: 7020 666f 7220 7474 7475 7020 696e 0a20  p for tttup in. 
 00004e80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004e90: 205b 652e 7479 7065 2066 6f72 2065 2069   [e.type for e i
-00004ea0: 6e20 6461 7461 666f 7263 6f6e 7465 7874  n dataforcontext
-00004eb0: 5d5d 0a0a 2020 2020 2020 2020 6e70 636f  ]]..        npco
-00004ec0: 6e74 6578 7420 3d20 6e70 2e61 7272 6179  ntext = np.array
-00004ed0: 2864 6174 6174 6f64 6629 0a20 2020 2020  (datatodf).     
-00004ee0: 2020 206e 7063 6f6e 7465 7874 203d 206e     npcontext = n
-00004ef0: 7063 6f6e 7465 7874 2e54 0a0a 2020 2020  pcontext.T..    
-00004f00: 2020 2020 6e70 636f 6e74 6578 7420 3d20      npcontext = 
-00004f10: 7365 6c66 2e4e 756d 7079 5f70 7265 7072  self.Numpy_prepr
-00004f20: 6f63 6365 7373 286e 7063 6f6e 7465 7874  occess(npcontext
-00004f30: 290a 0a20 2020 2020 2020 2023 2065 6e64  )..        # end
-00004f40: 203d 2074 696d 652e 7469 6d65 2829 0a20   = time.time(). 
-00004f50: 2020 2020 2020 2023 2070 7269 6e74 2866         # print(f
-00004f60: 2623 3334 3b70 7265 7072 6f63 6573 7320  &#34;preprocess 
-00004f70: 6466 3a20 7b65 6e64 202d 2073 7461 7274  df: {end - start
-00004f80: 7d26 2333 343b 290a 2020 2020 2020 2020  }&#34;).        
-00004f90: 2323 2323 2323 2323 2323 2323 2320 6372  ############# cr
-00004fa0: 6561 7465 2063 6f6e 7465 7874 2023 2323  eate context ###
-00004fb0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00004fc0: 2323 2323 2323 2323 230a 2020 2020 2020  #########.      
-00004fd0: 2020 2320 7374 6172 7420 3d20 7469 6d65    # start = time
-00004fe0: 2e74 696d 6528 290a 2020 2020 2020 2020  .time().        
-00004ff0: 2323 2063 6f6c 6c65 6374 2075 6e69 7165  ## collect uniqe
-00005000: 7520 6461 7461 2073 6572 6965 730a 2020  u data series.  
-00005010: 2020 2020 2020 2320 616c 6c63 6f64 6573        # allcodes
-00005020: 203d 2064 665b 2623 3339 3b63 6f64 6526   = df[&#39;code&
-00005030: 2333 393b 5d2e 756e 6971 7565 2829 0a20  #39;].unique(). 
-00005040: 2020 2020 2020 2061 6c6c 636f 6465 7320         allcodes 
-00005050: 3d20 6e70 2e75 6e69 7175 6528 6e70 636f  = np.unique(npco
-00005060: 6e74 6578 745b 3a2c 2031 5d29 0a20 2020  ntext[:, 1]).   
-00005070: 2020 2020 2061 6c6c 636f 6465 7320 3d20       allcodes = 
-00005080: 5b63 6f64 6520 666f 7220 636f 6465 2069  [code for code i
-00005090: 6e20 616c 6c63 6f64 6573 5d0a 2020 2020  n allcodes].    
-000050a0: 2020 2020 616c 6c63 6f64 6573 203d 2073      allcodes = s
-000050b0: 6574 2861 6c6c 636f 6465 7329 0a0a 2020  et(allcodes)..  
-000050c0: 2020 2020 2020 666f 7220 756e 636f 6465        for uncode
-000050d0: 2069 6e20 616c 6c63 6f64 6573 3a0a 2020   in allcodes:.  
-000050e0: 2020 2020 2020 2020 2020 666f 7220 7171            for qq
-000050f0: 2069 6e20 7261 6e67 6528 6c65 6e28 6e70   in range(len(np
-00005100: 636f 6e74 6578 7429 293a 0a20 2020 2020  context)):.     
-00005110: 2020 2020 2020 2020 2020 2069 6620 756e             if un
-00005120: 636f 6465 2069 6e20 6e70 636f 6e74 6578  code in npcontex
-00005130: 745b 7171 5d5b 315d 3a0a 2020 2020 2020  t[qq][1]:.      
-00005140: 2020 2020 2020 2020 2020 2020 2020 7365                se
-00005150: 6c66 2e74 7970 655f 6f66 5f73 6572 6965  lf.type_of_serie
-00005160: 735b 756e 636f 6465 5d20 3d20 6e70 636f  s[uncode] = npco
-00005170: 6e74 6578 745b 7171 5d5b 345d 0a20 2020  ntext[qq][4].   
-00005180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005190: 2062 7265 616b 0a0a 2020 2020 2020 2020   break..        
-000051a0: 2323 2062 7569 6c64 2074 6172 6765 7420  ## build target 
-000051b0: 7365 7269 6573 0a20 2020 2020 2020 2074  series.        t
-000051c0: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
-000051d0: 652c 2074 6172 6765 745f 7365 7269 6573  e, target_series
-000051e0: 203d 2073 656c 662e 6275 696c 645f 7461   = self.build_ta
-000051f0: 7267 6574 5f73 6572 6965 735f 666f 725f  rget_series_for_
-00005200: 636f 6e74 6578 7428 6375 7272 656e 742c  context(current,
-00005210: 206e 7063 6f6e 7465 7874 290a 0a20 2020   npcontext)..   
-00005220: 2020 2020 2023 2320 6372 6561 7465 2073       ## create s
-00005230: 6572 6965 7320 666f 7220 6561 6368 2073  eries for each s
-00005240: 6f75 7263 6520 2861 6c6c 6461 7461 290a  ource (alldata).
-00005250: 2020 2020 2020 2020 616c 6c64 6174 6120          alldata 
-00005260: 3d20 7365 6c66 2e63 7265 6174 655f 636f  = self.create_co
-00005270: 6e74 696e 756f 7573 5f72 6570 7265 7365  ntinuous_represe
-00005280: 6e74 6174 696f 6e28 7461 7267 6574 5f73  ntation(target_s
-00005290: 6572 6965 735f 6e61 6d65 2c20 7461 7267  eries_name, targ
-000052a0: 6574 5f73 6572 6965 732c 206e 7063 6f6e  et_series, npcon
-000052b0: 7465 7874 2c0a 2020 2020 2020 2020 2020  text,.          
-000052c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000052e0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-000052f0: 6c66 2e74 7970 655f 6f66 5f73 6572 6965  lf.type_of_serie
-00005300: 732c 2061 6c6c 636f 6465 7329 0a20 2020  s, allcodes).   
-00005310: 2020 2020 2023 2065 6e64 203d 2074 696d       # end = tim
-00005320: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
-00005330: 2023 2070 7269 6e74 2866 2623 3334 3b43   # print(f&#34;C
-00005340: 7265 6174 6520 7365 7269 6573 3a20 7b65  reate series: {e
-00005350: 6e64 2d73 7461 7274 7d26 2333 343b 290a  nd-start}&#34;).
-00005360: 0a20 2020 2020 2020 2073 746f 7269 6e67  .        storing
-00005370: 203d 2073 656c 662e 6361 6c63 756c 6174   = self.calculat
-00005380: 655f 6564 6765 7328 616c 6c64 6174 612c  e_edges(alldata,
-00005390: 2063 7572 7265 6e74 2e74 696d 6573 7461   current.timesta
-000053a0: 6d70 290a 2020 2020 2020 2020 7374 6f72  mp).        stor
-000053b0: 696e 675b 2623 3334 3b63 6861 7261 6374  ing[&#34;charact
-000053c0: 6572 697a 6174 696f 6e26 2333 343b 5d20  erization&#34;] 
-000053d0: 3d20 7365 6c66 2e67 6574 5f63 6861 7261  = self.get_chara
-000053e0: 6374 6572 697a 6174 696f 6e28 7374 6f72  cterization(stor
-000053f0: 696e 6729 0a0a 2020 2020 2020 2020 2320  ing)..        # 
-00005400: 7072 696e 7428 6626 2333 343b 4361 6c63  print(f&#34;Calc
-00005410: 756c 6174 6520 6564 6765 733a 207b 656e  ulate edges: {en
-00005420: 6420 2d20 7374 6172 747d 2623 3334 3b29  d - start}&#34;)
-00005430: 0a20 2020 2020 2020 2023 2070 7269 6e74  .        # print
-00005440: 2826 2333 343b 3d3d 3d3d 3d3d 3d3d 3d3d  (&#34;==========
-00005450: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2623  ==============&#
-00005460: 3334 3b29 0a0a 2020 2020 2020 2020 636f  34;)..        co
-00005470: 6e74 6578 7470 626a 6563 7420 3d20 436f  ntextpbject = Co
-00005480: 6e74 6578 742e 636f 6e74 6578 745f 6672  ntext.context_fr
-00005490: 6f6d 5f64 6963 7428 7374 6f72 696e 6729  om_dict(storing)
-000054a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000054b0: 636f 6e74 6578 7470 626a 6563 742c 2074  contextpbject, t
-000054c0: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
-000054d0: 650a 0a20 2020 2064 6566 2067 6574 5f63  e..    def get_c
-000054e0: 6861 7261 6374 6572 697a 6174 696f 6e28  haracterization(
-000054f0: 7365 6c66 2c20 636f 6e74 6578 7429 3a0a  self, context):.
-00005500: 2020 2020 2020 2020 2623 3334 3b26 2333          &#34;&#3
-00005510: 343b 2623 3334 3b0a 2020 2020 2020 2020  4;&#34;.        
-00005520: 5468 6973 206d 6574 686f 6420 6361 6c63  This method calc
-00005530: 756c 6174 6520 7468 6520 6368 6172 6163  ulate the charac
-00005540: 7465 7269 7a61 7469 6f6e 7320 6f66 2028  terizations of (
-00005550: 612c 6229 2065 6467 6573 2074 6f20 6368  a,b) edges to ch
-00005560: 6172 6163 7465 7269 7a65 2074 6865 2069  aracterize the i
-00005570: 6e66 6c75 656e 6365 206f 6620 6120 696e  nfluence of a in
-00005580: 2062 2062 7920 6f6e 6520 6f66 2074 6865   b by one of the
-00005590: 0a20 2020 2020 2020 2074 6872 6565 2063  .        three c
-000055a0: 6861 7261 6374 6572 697a 6174 696f 6e73  haracterizations
-000055b0: 3a20 756e 6b6e 6f77 6e2c 2064 6563 7265  : unknown, decre
-000055c0: 6173 652c 2069 6e63 7265 6173 652e 0a0a  ase, increase...
-000055d0: 2020 2020 2020 2020 5468 6520 6368 6172          The char
-000055e0: 6163 7465 7269 7a61 7469 6f6e 2069 7320  acterization is 
-000055f0: 6361 6c63 756c 6174 6564 2064 6966 6665  calculated diffe
-00005600: 7265 6e74 6c79 2066 6f72 2065 7665 6e74  rently for event
-00005610: 2061 6e64 2063 6f6e 7469 6e75 6f75 7320   and continuous 
-00005620: 6461 7461 2e0a 2020 2020 2020 2020 2a2a  data..        **
-00005630: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
-00005640: 2020 2020 2020 202a 2a63 6f6e 7465 7874         **context
-00005650: 2a2a 3a20 6469 6374 696f 6e61 7279 2077  **: dictionary w
-00005660: 6974 6820 6120 6b79 6520 2623 3339 3b65  ith a kye &#39;e
-00005670: 6467 6573 2623 3339 3b20 666f 7220 7768  dges&#39; for wh
-00005680: 6963 6820 6120 7061 7261 6c6c 656c 206c  ich a parallel l
-00005690: 6973 7420 6f66 2063 6861 7261 6374 6572  ist of character
-000056a0: 697a 6174 696f 6e73 2077 696c 6c20 6265  izations will be
-000056b0: 2063 7265 6174 6564 2e0a 2020 2020 2020   created..      
-000056c0: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
-000056d0: 3b0a 2020 2020 2020 2020 6564 6765 7320  ;.        edges 
-000056e0: 3d20 636f 6e74 6578 745b 2623 3334 3b65  = context[&#34;e
-000056f0: 6467 6573 2623 3334 3b5d 0a20 2020 2020  dges&#34;].     
-00005700: 2020 2063 6861 7261 6374 6572 697a 6174     characterizat
-00005710: 696f 6e73 203d 205b 5d0a 2020 2020 2020  ions = [].      
-00005720: 2020 666f 7220 6564 6765 2069 6e20 6564    for edge in ed
-00005730: 6765 733a 0a20 2020 2020 2020 2020 2020  ges:.           
-00005740: 2069 6620 7365 6c66 2e74 6172 6765 7420   if self.target 
-00005750: 696e 2065 6467 655b 305d 3a0a 2020 2020  in edge[0]:.    
-00005760: 2020 2020 2020 2020 2020 2020 6368 6172              char
-00005770: 203d 2073 656c 662e 6368 6172 6163 7465   = self.characte
-00005780: 7269 7a65 5f65 7665 6e74 5f63 6f6e 7469  rize_event_conti
-00005790: 6e75 6f75 7328 636f 6e74 6578 742c 2065  nuous(context, e
-000057a0: 6467 6529 0a20 2020 2020 2020 2020 2020  dge).           
-000057b0: 2065 6c69 6620 7365 6c66 2e74 7970 655f   elif self.type_
-000057c0: 6f66 5f73 6572 6965 735b 6564 6765 5b30  of_series[edge[0
-000057d0: 5d5d 203d 3d20 2623 3334 3b69 736f 6c61  ]] == &#34;isola
-000057e0: 7469 6f6e 2623 3334 3b20 6f72 2073 656c  tion&#34; or sel
-000057f0: 662e 7479 7065 5f6f 665f 7365 7269 6573  f.type_of_series
-00005800: 5b65 6467 655b 305d 5d20 3d3d 2026 2333  [edge[0]] == &#3
-00005810: 343b 636f 6e66 6967 7572 6174 696f 6e26  4;configuration&
-00005820: 2333 343b 3a0a 2020 2020 2020 2020 2020  #34;:.          
-00005830: 2020 2020 2020 6368 6172 203d 2073 656c        char = sel
-00005840: 662e 6368 6172 6163 7465 7269 7a65 5f65  f.characterize_e
-00005850: 7665 6e74 5f65 6467 6528 636f 6e74 6578  vent_edge(contex
-00005860: 742c 2065 6467 6529 0a20 2020 2020 2020  t, edge).       
-00005870: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00005880: 2020 2020 2020 2020 2020 2063 6861 7220             char 
-00005890: 3d20 7365 6c66 2e63 6861 7261 6374 6572  = self.character
-000058a0: 697a 655f 6576 656e 745f 636f 6e74 696e  ize_event_contin
-000058b0: 756f 7573 2863 6f6e 7465 7874 2c20 6564  uous(context, ed
-000058c0: 6765 290a 2020 2020 2020 2020 2020 2020  ge).            
-000058d0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
-000058e0: 732e 6170 7065 6e64 2863 6861 7229 0a20  s.append(char). 
-000058f0: 2020 2020 2020 2072 6574 7572 6e20 6368         return ch
-00005900: 6172 6163 7465 7269 7a61 7469 6f6e 730a  aracterizations.
-00005910: 0a20 2020 2064 6566 2063 6861 7261 6374  .    def charact
-00005920: 6572 697a 655f 6576 656e 745f 6564 6765  erize_event_edge
-00005930: 2873 656c 662c 2063 6f6e 7465 7874 2c20  (self, context, 
-00005940: 6564 6765 293a 0a20 2020 2020 2020 2026  edge):.        &
-00005950: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-00005960: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00005970: 6f64 2063 6861 7261 6374 6572 697a 6573  od characterizes
-00005980: 2074 6865 2065 6467 6520 2861 2c62 2920   the edge (a,b) 
-00005990: 7768 656e 2061 2069 7320 6973 6f6c 6174  when a is isolat
-000059a0: 6564 206f 7220 636f 6e66 6967 7572 6174  ed or configurat
-000059b0: 696f 6e20 6576 656e 742e 0a20 2020 2020  ion event..     
-000059c0: 2020 2054 6f20 646f 2074 6869 732c 2069     To do this, i
-000059d0: 7420 6465 7465 6374 7320 7468 6520 6c61  t detects the la
-000059e0: 7374 206f 6363 7572 7265 6e63 6520 6f66  st occurrence of
-000059f0: 2061 2061 6e64 2073 706c 6974 2074 6865   a and split the
-00005a00: 2064 6174 6120 6f66 2073 6572 6965 7320   data of series 
-00005a10: 6120 616e 6420 7365 7269 6573 2062 2062  a and series b b
-00005a20: 6173 6564 206f 6e20 7468 6174 2e0a 2020  ased on that..  
-00005a30: 2020 2020 2020 5468 656e 2063 6865 636b        Then check
-00005a40: 7320 6966 2074 6865 206d 6564 6961 6e20  s if the median 
-00005a50: 6f66 2062 2061 6674 6572 2074 6865 206f  of b after the o
-00005a60: 6363 7572 7265 6e63 6520 6973 2061 7420  ccurrence is at 
-00005a70: 6c61 7267 6572 2074 6861 6e20 7468 6520  larger than the 
-00005a80: 6d65 6469 616e 2062 2062 6566 6f72 650a  median b before.
-00005a90: 2020 2020 2020 2020 706c 7573 2074 776f          plus two
-00005aa0: 2074 696d 6573 2074 6865 2073 7461 6e64   times the stand
-00005ab0: 6172 6420 6465 7669 6174 696f 6e20 6f66  ard deviation of
-00005ac0: 2062 2073 6572 6965 7320 6265 666f 7265   b series before
-00005ad0: 2074 6865 206f 6363 7572 7265 6e63 652e   the occurrence.
-00005ae0: 0a20 2020 2020 2020 2049 6620 7468 6174  .        If that
-00005af0: 2069 7320 7472 7565 2074 6865 6e20 6973   is true then is
-00005b00: 2063 6861 7261 6374 6572 697a 6564 2061   characterized a
-00005b10: 7320 696e 6372 6561 7365 2e20 456c 7365  s increase. Else
-00005b20: 2069 7420 6973 2063 6865 636b 6564 2066   it is checked f
-00005b30: 6f72 2074 6865 206f 7070 6f73 6974 652c  or the opposite,
-00005b40: 2028 6966 2069 7420 6973 2073 6d61 6c6c   (if it is small
-00005b50: 6572 0a20 2020 2020 2020 2066 6f72 2061  er.        for a
-00005b60: 7420 6c65 6173 7420 3220 7469 6d65 7320  t least 2 times 
-00005b70: 7468 6520 7374 616e 6461 7264 2064 6576  the standard dev
-00005b80: 6961 7469 6f6e 206f 6620 6229 2061 6e64  iation of b) and
-00005b90: 2063 6861 7261 6374 6572 697a 6564 2061   characterized a
-00005ba0: 7320 6465 6372 6561 7365 2e20 4f74 6865  s decrease. Othe
-00005bb0: 7277 6973 652c 2069 7320 6368 6172 6163  rwise, is charac
-00005bc0: 7465 7269 7a65 6420 6173 0a20 2020 2020  terized as.     
-00005bd0: 2020 2020 756e 6b6e 6f77 6e2e 0a0a 2020      unknown...  
-00005be0: 2020 2020 2020 2a2a 5061 7261 6d65 7465        **Paramete
-00005bf0: 7273 2a2a 3a0a 0a20 2020 2020 2020 202a  rs**:..        *
-00005c00: 2a63 6f6e 7465 7874 2a2a 3a20 7468 6174  *context**: that
-00005c10: 2074 6865 2065 6467 6520 746f 2062 6520   the edge to be 
-00005c20: 6368 6172 6163 7465 7269 7a65 6420 6265  characterized be
-00005c30: 6c6f 6e67 732e 0a0a 2020 2020 2020 2020  longs...        
-00005c40: 2a2a 6564 6765 2a2a 3a20 4120 7475 706c  **edge**: A tupl
-00005c50: 6520 2861 2c62 2920 7768 6572 6520 6120  e (a,b) where a 
-00005c60: 6973 2069 736f 6c61 7465 6420 6f72 2063  is isolated or c
-00005c70: 6f6e 6669 6775 7261 7469 6f6e 2065 7665  onfiguration eve
-00005c80: 6e74 2e0a 0a20 2020 2020 2020 202a 2a72  nt...        **r
-00005c90: 6574 7572 6e2a 2a3a 2041 2063 6861 7261  eturn**: A chara
-00005ca0: 6374 6572 697a 6174 696f 6e20 666f 7220  cterization for 
-00005cb0: 7468 6520 6564 6765 2028 756e 6b6e 6f77  the edge (unknow
-00005cc0: 6e2c 2064 6563 7265 6173 6520 6f72 2069  n, decrease or i
-00005cd0: 6e63 7265 6173 6529 0a20 2020 2020 2020  ncrease).       
-00005ce0: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
-00005cf0: 0a20 2020 2020 2020 206e 616d 6531 203d  .        name1 =
-00005d00: 2065 6467 655b 305d 0a20 2020 2020 2020   edge[0].       
-00005d10: 206e 616d 6532 203d 2065 6467 655b 315d   name2 = edge[1]
-00005d20: 0a20 2020 2020 2020 2076 616c 7565 7331  .        values1
-00005d30: 203d 2063 6f6e 7465 7874 5b6e 616d 6531   = context[name1
-00005d40: 5d0a 2020 2020 2020 2020 7661 6c75 6573  ].        values
-00005d50: 3220 3d20 5b66 6c6f 6174 286b 6174 6929  2 = [float(kati)
-00005d60: 2066 6f72 206b 6174 6920 696e 2063 6f6e   for kati in con
-00005d70: 7465 7874 5b6e 616d 6532 5d5d 0a0a 2020  text[name2]]..  
-00005d80: 2020 2020 2020 6f63 6375 7265 6e63 6520        occurence 
-00005d90: 3d20 6c65 6e28 7661 6c75 6573 3129 202d  = len(values1) -
-00005da0: 2031 0a20 2020 2020 2020 2066 6f72 2069   1.        for i
-00005db0: 2069 6e20 7261 6e67 6528 6c65 6e28 7661   in range(len(va
-00005dc0: 6c75 6573 3129 202d 2032 2c20 302c 202d  lues1) - 2, 0, -
-00005dd0: 3129 3a0a 2020 2020 2020 2020 2020 2020  1):.            
-00005de0: 6966 2076 616c 7565 7331 5b69 5d20 213d  if values1[i] !=
-00005df0: 2076 616c 7565 7331 5b2d 315d 3a0a 2020   values1[-1]:.  
-00005e00: 2020 2020 2020 2020 2020 2020 2020 6f63                oc
-00005e10: 6375 7265 6e63 6520 3d20 6920 2b20 310a  curence = i + 1.
-00005e20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005e30: 6272 6561 6b0a 2020 2020 2020 2020 7072  break.        pr
-00005e40: 6576 6975 736f 6363 7572 656e 6365 203d  eviusoccurence =
-00005e50: 2030 0a20 2020 2020 2020 2066 6f72 2069   0.        for i
-00005e60: 2069 6e20 7261 6e67 6528 6f63 6375 7265   in range(occure
-00005e70: 6e63 6520 2d20 322c 2030 2c20 2d31 293a  nce - 2, 0, -1):
-00005e80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00005e90: 7661 6c75 6573 315b 695d 2021 3d20 7661  values1[i] != va
-00005ea0: 6c75 6573 315b 6f63 6375 7265 6e63 6520  lues1[occurence 
-00005eb0: 2d20 315d 3a0a 2020 2020 2020 2020 2020  - 1]:.          
-00005ec0: 2020 2020 2020 7072 6576 6975 736f 6363        previusocc
-00005ed0: 7572 656e 6365 203d 2069 0a0a 2020 2020  urence = i..    
-00005ee0: 2020 2020 6966 206f 6363 7572 656e 6365      if occurence
-00005ef0: 202d 2070 7265 7669 7573 6f63 6375 7265   - previusoccure
-00005f00: 6e63 6520 266c 743b 2032 3a20 2023 206f  nce &lt; 2:  # o
-00005f10: 7220 6c65 6e28 7661 6c75 6573 3229 2d6f  r len(values2)-o
-00005f20: 6363 7572 656e 6365 266c 743b 323a 0a20  ccurence&lt;2:. 
-00005f30: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00005f40: 6e20 2623 3334 3b75 6e6b 6e6f 776e 2623  n &#34;unknown&#
-00005f50: 3334 3b0a 2020 2020 2020 2020 7661 6c75  34;.        valu
-00005f60: 6573 3262 6566 6f72 6520 3d20 7661 6c75  es2before = valu
-00005f70: 6573 325b 7072 6576 6975 736f 6363 7572  es2[previusoccur
-00005f80: 656e 6365 3a6f 6363 7572 656e 6365 5d0a  ence:occurence].
-00005f90: 2020 2020 2020 2020 2320 7374 6476 203d          # stdv =
-00005fa0: 2073 7461 7469 7374 6963 732e 7374 6465   statistics.stde
-00005fb0: 7628 7661 6c75 6573 3262 6566 6f72 6529  v(values2before)
-00005fc0: 0a20 2020 2020 2020 2023 206d 6561 6e20  .        # mean 
-00005fd0: 3d20 7374 6174 6973 7469 6373 2e73 7464  = statistics.std
-00005fe0: 6576 2876 616c 7565 7332 6265 666f 7265  ev(values2before
-00005ff0: 290a 2020 2020 2020 2020 2320 7661 6c75  ).        # valu
-00006000: 6573 3262 6566 6f72 653d 5b76 2069 6620  es2before=[v if 
-00006010: 7626 6c74 3b6d 6561 6e2b 352a 7374 6476  v&lt;mean+5*stdv
-00006020: 2065 6c73 6520 6d65 616e 2066 6f72 2076   else mean for v
-00006030: 2069 6e20 7661 6c75 6573 3262 6566 6f72   in values2befor
-00006040: 655d 0a0a 2020 2020 2020 2020 2320 7661  e]..        # va
-00006050: 6c75 6573 3261 6674 6572 3d76 616c 7565  lues2after=value
-00006060: 7332 5b6f 6363 7572 656e 6365 3a5d 0a20  s2[occurence:]. 
-00006070: 2020 2020 2020 2076 616c 7565 7332 6166         values2af
-00006080: 7465 7220 3d20 5b76 616c 7565 7332 5b2d  ter = [values2[-
-00006090: 315d 5d0a 2020 2020 2020 2020 2320 7374  1]].        # st
-000060a0: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
-000060b0: 7374 6465 7628 7661 6c75 6573 3261 6674  stdev(values2aft
-000060c0: 6572 290a 2020 2020 2020 2020 2320 6d65  er).        # me
-000060d0: 616e 203d 2073 7461 7469 7374 6963 732e  an = statistics.
-000060e0: 7374 6465 7628 7661 6c75 6573 3261 6674  stdev(values2aft
-000060f0: 6572 290a 2020 2020 2020 2020 2320 7661  er).        # va
-00006100: 6c75 6573 3261 6674 6572 203d 205b 7620  lues2after = [v 
-00006110: 6966 2076 2026 6c74 3b20 6d65 616e 202b  if v &lt; mean +
-00006120: 2033 202a 2073 7464 7620 656c 7365 206d   3 * stdv else m
-00006130: 6561 6e20 666f 7220 7620 696e 2076 616c  ean for v in val
-00006140: 7565 7332 6166 7465 725d 0a0a 2020 2020  ues2after]..    
-00006150: 2020 2020 7374 6476 203d 2073 7461 7469      stdv = stati
-00006160: 7374 6963 732e 7374 6465 7628 7661 6c75  stics.stdev(valu
-00006170: 6573 3262 6566 6f72 6529 0a20 2020 2020  es2before).     
-00006180: 2020 2069 6620 6c65 6e28 7661 6c75 6573     if len(values
-00006190: 3262 6566 6f72 6529 203d 3d20 303a 0a20  2before) == 0:. 
-000061a0: 2020 2020 2020 2020 2020 2063 6861 7220             char 
-000061b0: 3d20 2623 3334 3b75 6e6b 6e6f 776e 2623  = &#34;unknown&#
-000061c0: 3334 3b0a 2020 2020 2020 2020 656c 6966  34;.        elif
-000061d0: 2073 7461 7469 7374 6963 732e 6d65 6469   statistics.medi
-000061e0: 616e 2876 616c 7565 7332 6265 666f 7265  an(values2before
-000061f0: 2920 2d20 7374 6174 6973 7469 6373 2e6d  ) - statistics.m
-00006200: 6564 6961 6e28 7661 6c75 6573 3261 6674  edian(values2aft
-00006210: 6572 2920 2667 743b 2032 202a 2073 7464  er) &gt; 2 * std
-00006220: 763a 0a20 2020 2020 2020 2020 2020 2063  v:.            c
-00006230: 6861 7220 3d20 2623 3334 3b64 6563 7265  har = &#34;decre
-00006240: 6173 6526 2333 343b 0a20 2020 2020 2020  ase&#34;.       
-00006250: 2065 6c69 6620 7374 6174 6973 7469 6373   elif statistics
-00006260: 2e6d 6564 6961 6e28 7661 6c75 6573 3261  .median(values2a
-00006270: 6674 6572 2920 2d20 7374 6174 6973 7469  fter) - statisti
-00006280: 6373 2e6d 6564 6961 6e28 7661 6c75 6573  cs.median(values
-00006290: 3262 6566 6f72 6529 2026 6774 3b20 3220  2before) &gt; 2 
-000062a0: 2a20 7374 6476 3a0a 2020 2020 2020 2020  * stdv:.        
-000062b0: 2020 2020 6368 6172 203d 2026 2333 343b      char = &#34;
-000062c0: 696e 6372 6561 7365 2623 3334 3b0a 2020  increase&#34;.  
-000062d0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000062e0: 2020 2020 2020 2020 6368 6172 203d 2026          char = &
-000062f0: 2333 343b 756e 6b6e 6f77 6e26 2333 343b  #34;unknown&#34;
-00006300: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00006310: 6368 6172 0a0a 2020 2020 6465 6620 6368  char..    def ch
-00006320: 6172 6163 7465 7269 7a65 5f65 7665 6e74  aracterize_event
-00006330: 5f63 6f6e 7469 6e75 6f75 7328 7365 6c66  _continuous(self
-00006340: 2c20 636f 6e74 6578 742c 2065 6467 6529  , context, edge)
-00006350: 3a0a 2020 2020 2020 2020 2623 3334 3b26  :.        &#34;&
-00006360: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
-00006370: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-00006380: 6420 6368 6172 6163 7465 7269 7a65 7320  d characterizes 
-00006390: 7468 6520 6564 6765 2028 612c 6229 2077  the edge (a,b) w
-000063a0: 6865 6e20 6120 6973 2063 6f6e 7469 6e75  hen a is continu
-000063b0: 6f75 732e 0a20 2020 2020 2020 2020 2020  ous..           
-000063c0: 2054 6f20 646f 2074 6869 732c 2074 6865   To do this, the
-000063d0: 2064 656c 7461 2062 6574 7765 656e 2074   delta between t
-000063e0: 6865 2074 696d 6573 7461 6d70 7320 6f66  he timestamps of
-000063f0: 2074 6865 2073 6572 6965 7320 6220 6973   the series b is
-00006400: 2063 616c 6375 6c61 7465 640a 2020 2020   calculated.    
-00006410: 2020 2020 2020 2020 2869 2e65 2e20 7468          (i.e. th
-00006420: 6520 6469 6666 6572 656e 6365 2062 6574  e difference bet
-00006430: 7765 656e 2063 7572 7265 6e74 2061 6e64  ween current and
-00006440: 206e 6578 7420 7469 6d65 7374 616d 7073   next timestamps
-00006450: 292e 2049 6620 7468 6520 7375 6d6d 206f  ). If the summ o
-00006460: 6620 7468 6520 6465 6c74 6173 2062 6574  f the deltas bet
-00006470: 7765 656e 2062 2073 6572 6965 7320 6461  ween b series da
-00006480: 7461 2c20 6973 0a20 2020 2020 2020 2020  ta, is.         
-00006490: 2020 2067 7265 6174 6572 2074 6861 6e20     greater than 
-000064a0: 3220 7469 6d65 7320 7468 6520 7374 616e  2 times the stan
-000064b0: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
-000064c0: 6620 7468 6520 622c 2074 6865 6e20 7468  f the b, then th
-000064d0: 6520 696e 6372 6561 7365 2063 6861 7261  e increase chara
-000064e0: 6374 6572 697a 6174 696f 6e20 6973 2072  cterization is r
-000064f0: 6574 7572 6e65 642e 2049 6620 7468 6520  eturned. If the 
-00006500: 7375 6d0a 2020 2020 2020 2020 2020 2020  sum.            
-00006510: 6973 206c 6f77 6572 2074 6861 6e20 3220  is lower than 2 
-00006520: 7469 6d65 7320 7468 6520 7374 616e 6461  times the standa
-00006530: 7264 2064 6576 6961 7469 6f6e 2074 6865  rd deviation the
-00006540: 2064 6563 7265 6173 6564 2063 6861 7261   decreased chara
-00006550: 6374 6572 697a 6174 696f 6e20 6973 2072  cterization is r
-00006560: 6574 7572 6e65 642e 204f 7468 6572 7769  eturned. Otherwi
-00006570: 7365 2c20 7468 6520 756e 6b6e 6f77 6e0a  se, the unknown.
-00006580: 2020 2020 2020 2020 2020 2020 6368 6172              char
-00006590: 6163 7465 7269 7a61 7469 6f6e 2069 7320  acterization is 
-000065a0: 7265 7475 726e 6564 2e0a 0a20 2020 2020  returned...     
-000065b0: 2020 2020 2020 202a 2a50 6172 616d 6574         **Paramet
-000065c0: 6572 732a 2a3a 0a0a 2020 2020 2020 2020  ers**:..        
-000065d0: 2020 2020 2a2a 636f 6e74 6578 742a 2a3a      **context**:
-000065e0: 2074 6861 7420 7468 6520 6564 6765 2074   that the edge t
-000065f0: 6f20 6265 2063 6861 7261 6374 6572 697a  o be characteriz
-00006600: 6564 2062 656c 6f6e 6773 2e0a 0a20 2020  ed belongs...   
-00006610: 2020 2020 2020 2020 202a 2a65 6467 652a           **edge*
-00006620: 2a3a 2041 2074 7570 6c65 2028 612c 6229  *: A tuple (a,b)
-00006630: 2077 6865 7265 2061 2069 7320 6973 6f6c   where a is isol
-00006640: 6174 6564 206f 7220 636f 6e66 6967 7572  ated or configur
-00006650: 6174 696f 6e20 6576 656e 742e 0a0a 2020  ation event...  
-00006660: 2020 2020 2020 2020 2020 2a2a 7265 7475            **retu
-00006670: 726e 2a2a 3a20 4120 6368 6172 6163 7465  rn**: A characte
-00006680: 7269 7a61 7469 6f6e 2066 6f72 2074 6865  rization for the
-00006690: 2065 6467 6520 2875 6e6b 6e6f 776e 2c20   edge (unknown, 
-000066a0: 6465 6372 6561 7365 206f 7220 696e 6372  decrease or incr
-000066b0: 6561 7365 290a 2020 2020 2020 2020 2623  ease).        &#
-000066c0: 3334 3b26 2333 343b 2623 3334 3b0a 2020  34;&#34;&#34;.  
-000066d0: 2020 2020 2020 6e61 6d65 3120 3d20 6564        name1 = ed
-000066e0: 6765 5b30 5d0a 2020 2020 2020 2020 6e61  ge[0].        na
-000066f0: 6d65 3220 3d20 6564 6765 5b31 5d0a 2020  me2 = edge[1].  
-00006700: 2020 2020 2020 7661 6c75 6573 3120 3d20        values1 = 
-00006710: 5b66 6c6f 6174 286b 6174 6929 2066 6f72  [float(kati) for
-00006720: 206b 6174 6920 696e 2063 6f6e 7465 7874   kati in context
-00006730: 5b6e 616d 6531 5d5d 0a20 2020 2020 2020  [name1]].       
-00006740: 2076 616c 7565 7332 203d 205b 666c 6f61   values2 = [floa
-00006750: 7428 6b61 7469 2920 666f 7220 6b61 7469  t(kati) for kati
-00006760: 2069 6e20 636f 6e74 6578 745b 6e61 6d65   in context[name
-00006770: 325d 5d0a 0a20 2020 2020 2020 2070 7265  2]]..        pre
-00006780: 7620 3d20 7661 6c75 6573 325b 305d 0a20  v = values2[0]. 
-00006790: 2020 2020 2020 2064 6966 6620 3d20 300a         diff = 0.
-000067a0: 2020 2020 2020 2020 666f 7220 7620 696e          for v in
-000067b0: 2076 616c 7565 7332 5b31 3a5d 3a0a 2020   values2[1:]:.  
-000067c0: 2020 2020 2020 2020 2020 6469 6666 202b            diff +
-000067d0: 3d20 2876 202d 2070 7265 7629 0a0a 2020  = (v - prev)..  
-000067e0: 2020 2020 2020 6966 206c 656e 2876 616c        if len(val
-000067f0: 7565 7332 2920 3d3d 2030 3a0a 2020 2020  ues2) == 0:.    
-00006800: 2020 2020 2020 2020 6368 6172 203d 2026          char = &
-00006810: 2333 343b 756e 6b6e 6f77 6e26 2333 343b  #34;unknown&#34;
-00006820: 0a20 2020 2020 2020 2073 7464 7620 3d20  .        stdv = 
-00006830: 7374 6174 6973 7469 6373 2e73 7464 6576  statistics.stdev
-00006840: 2876 616c 7565 7332 290a 2020 2020 2020  (values2).      
-00006850: 2020 6966 2064 6966 6620 2667 743b 2032    if diff &gt; 2
-00006860: 202a 2073 7464 763a 0a20 2020 2020 2020   * stdv:.       
-00006870: 2020 2020 2063 6861 7220 3d20 2623 3334       char = &#34
-00006880: 3b69 6e63 7265 6173 6526 2333 343b 0a20  ;increase&#34;. 
-00006890: 2020 2020 2020 2065 6c69 6620 6469 6666         elif diff
-000068a0: 2026 6c74 3b20 2d32 202a 2073 7464 763a   &lt; -2 * stdv:
-000068b0: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
-000068c0: 7220 3d20 2623 3334 3b64 6563 7265 6173  r = &#34;decreas
-000068d0: 6526 2333 343b 0a20 2020 2020 2020 2065  e&#34;.        e
-000068e0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000068f0: 2063 6861 7220 3d20 2623 3334 3b75 6e6b   char = &#34;unk
-00006900: 6e6f 776e 2623 3334 3b0a 2020 2020 2020  nown&#34;.      
-00006910: 2020 7265 7475 726e 2063 6861 720a 0a20    return char.. 
-00006920: 2020 2064 6566 2063 616c 6375 6c61 7465     def calculate
-00006930: 5f65 6467 6573 2873 656c 662c 2061 6c6c  _edges(self, all
-00006940: 6461 7461 2c20 7469 6d65 7374 616d 7029  data, timestamp)
-00006950: 3a0a 2020 2020 2020 2020 2623 3334 3b26  :.        &#34;&
-00006960: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
-00006970: 2020 466f 726d 756c 6174 6520 7468 6520    Formulate the 
-00006980: 6461 7461 2069 6e20 6170 7072 6f70 7269  data in appropri
-00006990: 6174 6520 666f 726d 2074 6f20 6361 6c6c  ate form to call
-000069a0: 2073 656c 662e 6361 6c63 756c 6174 655f   self.calculate_
-000069b0: 6361 7573 616c 6974 790a 2020 2020 2020  causality.      
-000069c0: 2020 7768 6963 6820 7265 7475 726e 2074    which return t
-000069d0: 6865 2065 6467 6573 2066 6f72 2074 6865  he edges for the
-000069e0: 2063 6f6e 7465 7874 2e0a 0a20 2020 2020   context...     
-000069f0: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
-00006a00: 2a3a 0a0a 2020 2020 2020 2020 2a2a 616c  *:..        **al
-00006a10: 6c64 6174 612a 2a3a 2061 2032 4420 6e75  ldata**: a 2D nu
-00006a20: 6d70 7920 6172 7261 7920 7769 7468 2061  mpy array with a
-00006a30: 6c6c 2073 6572 6965 7320 6461 7461 2028  ll series data (
-00006a40: 6571 7569 7661 6c65 6e74 2074 6f20 7468  equivalent to th
-00006a50: 6520 4344 206f 6620 7468 6520 436f 6e74  e CD of the Cont
-00006a60: 6578 7429 0a0a 2020 2020 2020 2020 2a2a  ext)..        **
-00006a70: 7469 6d65 7374 616d 702a 2a3a 2074 696d  timestamp**: tim
-00006a80: 6573 7461 6d70 206f 6620 7468 6520 636f  estamp of the co
-00006a90: 6e74 6578 7420 6672 6f6d 2077 6869 6368  ntext from which
-00006aa0: 2074 6865 2065 6467 6573 2061 7265 2063   the edges are c
-00006ab0: 616c 6375 6c61 7465 642e 0a0a 2020 2020  alculated...    
-00006ac0: 2020 2020 2a2a 7265 7475 726e 2a2a 3a20      **return**: 
-00006ad0: 6120 6469 6374 696f 6e61 7279 2077 6974  a dictionary wit
-00006ae0: 6820 2623 3339 3b65 6467 6573 2623 3339  h &#39;edges&#39
-00006af0: 3b20 6b65 7920 2863 6f6e 7461 696e 696e  ; key (containin
-00006b00: 6720 7468 6520 6361 6c63 756c 6174 6564  g the calculated
-00006b10: 2065 6467 6573 2061 6674 6572 2043 6175   edges after Cau
-00006b20: 7361 6c69 7479 2064 6973 636f 7665 7279  sality discovery
-00006b30: 292e 0a20 2020 2020 2020 2026 2333 343b  )..        &#34;
-00006b40: 2623 3334 3b26 2333 343b 0a20 2020 2020  &#34;&#34;.     
-00006b50: 2020 2023 2073 7461 7274 203d 2074 696d     # start = tim
-00006b60: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
-00006b70: 2073 746f 7269 6e67 203d 207b 7d0a 2020   storing = {}.  
-00006b80: 2020 2020 2020 7374 6f72 696e 675b 2623        storing[&#
-00006b90: 3334 3b74 696d 6573 7461 6d70 2623 3334  34;timestamp&#34
-00006ba0: 3b5d 203d 2074 696d 6573 7461 6d70 0a0a  ;] = timestamp..
-00006bb0: 2020 2020 2020 2020 616c 6c64 6174 615f          alldata_
-00006bc0: 6e61 6d65 7320 3d20 5b6e 6e5b 305d 2066  names = [nn[0] f
-00006bd0: 6f72 206e 6e20 696e 2061 6c6c 6461 7461  or nn in alldata
-00006be0: 5d0a 2020 2020 2020 2020 616c 6c64 6174  ].        alldat
-00006bf0: 615f 6461 7461 203d 205b 6e6e 5b31 5d20  a_data = [nn[1] 
-00006c00: 666f 7220 6e6e 2069 6e20 616c 6c64 6174  for nn in alldat
-00006c10: 615d 0a0a 2020 2020 2020 2020 666f 7220  a]..        for 
-00006c20: 6e61 6d65 6464 2c20 6461 7461 6464 2069  namedd, datadd i
-00006c30: 6e20 7a69 7028 616c 6c64 6174 615f 6e61  n zip(alldata_na
-00006c40: 6d65 732c 2061 6c6c 6461 7461 5f64 6174  mes, alldata_dat
-00006c50: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
-00006c60: 7374 6f72 696e 675b 6e61 6d65 6464 5d20  storing[namedd] 
-00006c70: 3d20 6461 7461 6464 0a0a 2020 2020 2020  = datadd..      
-00006c80: 2020 2320 466f 7220 636f 6e74 6578 7420    # For context 
-00006c90: 7769 7468 206d 6f72 6520 7468 616e 2074  with more than t
-00006ca0: 776f 2073 6572 6965 7320 6361 6c63 756c  wo series calcul
-00006cb0: 6174 6520 5043 2063 6173 7561 6c69 7469  ate PC casualiti
-00006cc0: 6573 0a20 2020 2020 2020 2063 6f75 6e74  es.        count
-00006cd0: 203d 206c 656e 285b 3120 666f 7220 6c69   = len([1 for li
-00006ce0: 7374 6120 696e 2061 6c6c 6461 7461 5f64  sta in alldata_d
-00006cf0: 6174 6120 6966 206c 6973 7461 2069 7320  ata if lista is 
-00006d00: 6e6f 7420 4e6f 6e65 5d29 0a20 2020 2020  not None]).     
-00006d10: 2020 2069 6620 636f 756e 7420 2667 743b     if count &gt;
-00006d20: 2031 2061 6e64 206c 656e 2861 6c6c 6461   1 and len(allda
-00006d30: 7461 5b30 5d5b 315d 2920 2667 743b 2035  ta[0][1]) &gt; 5
-00006d40: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
-00006d50: 6c64 6174 615f 6e61 6d65 7320 3d20 5b6e  ldata_names = [n
-00006d60: 6e5b 305d 2066 6f72 206e 6e20 696e 2061  n[0] for nn in a
-00006d70: 6c6c 6461 7461 2069 6620 6e6e 5b31 5d20  lldata if nn[1] 
-00006d80: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
-00006d90: 6c65 6e28 7365 7428 6e6e 5b31 5d29 2920  len(set(nn[1])) 
-00006da0: 2667 743b 2031 5d0a 2020 2020 2020 2020  &gt; 1].        
-00006db0: 2020 2020 616c 6c64 6174 615f 6461 7461      alldata_data
-00006dc0: 203d 205b 6e6e 5b31 5d20 666f 7220 6e6e   = [nn[1] for nn
-00006dd0: 2069 6e20 616c 6c64 6174 6120 6966 206e   in alldata if n
-00006de0: 6e5b 315d 2069 7320 6e6f 7420 4e6f 6e65  n[1] is not None
-00006df0: 2061 6e64 206c 656e 2873 6574 286e 6e5b   and len(set(nn[
-00006e00: 315d 2929 2026 6774 3b20 315d 0a0a 2020  1])) &gt; 1]..  
-00006e10: 2020 2020 2020 2020 2020 2320 656e 6420            # end 
-00006e20: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-00006e30: 2020 2020 2020 2020 2020 2320 7072 696e            # prin
-00006e40: 7428 6626 2333 343b 6265 666f 7265 207b  t(f&#34;before {
-00006e50: 656e 6420 2d20 7374 6172 747d 2623 3334  end - start}&#34
-00006e60: 3b29 0a20 2020 2020 2020 2020 2020 2023  ;).            #
-00006e70: 2073 7461 7274 3d74 696d 652e 7469 6d65   start=time.time
-00006e80: 2829 0a0a 2020 2020 2020 2020 2020 2020  ()..            
-00006e90: 6564 6765 7320 3d20 7365 6c66 2e63 616c  edges = self.cal
-00006ea0: 6375 6c61 7465 5f63 6175 7361 6c69 7479  culate_causality
-00006eb0: 286e 702e 636f 6c75 6d6e 5f73 7461 636b  (np.column_stack
-00006ec0: 2861 6c6c 6461 7461 5f64 6174 6129 2c20  (alldata_data), 
-00006ed0: 616c 6c64 6174 615f 6e61 6d65 7329 0a20  alldata_names). 
-00006ee0: 2020 2020 2020 2020 2020 2023 2065 6e64             # end
-00006ef0: 3d74 696d 652e 7469 6d65 2829 0a20 2020  =time.time().   
-00006f00: 2020 2020 2020 2020 2023 2070 7269 6e74           # print
-00006f10: 2866 2623 3334 3b61 6374 7561 6c20 6564  (f&#34;actual ed
-00006f20: 6765 2063 616c 6375 6c61 7469 6f6e 207b  ge calculation {
-00006f30: 656e 642d 7374 6172 747d 2623 3334 3b29  end-start}&#34;)
-00006f40: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00006f50: 6564 6765 7320 6973 204e 6f6e 653a 0a20  edges is None:. 
-00006f60: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00006f70: 696e 676c 6565 6467 6573 203d 205b 5d0a  ingleedges = [].
-00006f80: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00006f90: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00006fa0: 2020 7369 6e67 6c65 6564 6765 7320 3d20    singleedges = 
-00006fb0: 6564 6765 730a 2020 2020 2020 2020 2020  edges.          
-00006fc0: 2020 2320 7072 696e 7428 6564 6765 7329    # print(edges)
-00006fd0: 0a20 2020 2020 2020 2020 2020 2073 746f  .            sto
-00006fe0: 7269 6e67 5b26 2333 343b 6564 6765 7326  ring[&#34;edges&
-00006ff0: 2333 343b 5d20 3d20 7369 6e67 6c65 6564  #34;] = singleed
-00007000: 6765 730a 2020 2020 2020 2020 2020 2020  ges.            
-00007010: 7265 7475 726e 2073 746f 7269 6e67 0a20  return storing. 
-00007020: 2020 2020 2020 2073 746f 7269 6e67 5b26         storing[&
-00007030: 2333 343b 6564 6765 7326 2333 343b 5d20  #34;edges&#34;] 
-00007040: 3d20 5b5d 0a20 2020 2020 2020 2072 6574  = [].        ret
-00007050: 7572 6e20 7374 6f72 696e 670a 0a20 2020  urn storing..   
-00007060: 2064 6566 2063 7265 6174 655f 636f 6e74   def create_cont
-00007070: 696e 756f 7573 5f72 6570 7265 7365 6e74  inuous_represent
-00007080: 6174 696f 6e28 7365 6c66 2c20 7461 7267  ation(self, targ
-00007090: 6574 5f73 6572 6965 735f 6e61 6d65 2c20  et_series_name, 
-000070a0: 7461 7267 6574 5f73 6572 6965 732c 2064  target_series, d
-000070b0: 662c 2074 7970 655f 6f66 5f73 6572 6965  f, type_of_serie
-000070c0: 732c 2061 6c6c 636f 6465 7329 3a0a 2020  s, allcodes):.  
-000070d0: 2020 2020 2020 2320 6966 206c 656e 2874        # if len(t
-000070e0: 6172 6765 745f 7365 7269 6573 2920 266c  arget_series) &l
-000070f0: 743b 2035 3a0a 2020 2020 2020 2020 2320  t; 5:.        # 
-00007100: 2020 2020 616c 6c64 6174 6120 3d20 5b5d      alldata = []
-00007110: 0a20 2020 2020 2020 2023 2020 2020 2070  .        #     p
-00007120: 6164 6469 6e67 3d5b 3020 666f 7220 7120  adding=[0 for q 
-00007130: 696e 2072 616e 6765 2835 2d6c 656e 2874  in range(5-len(t
-00007140: 6172 6765 745f 7365 7269 6573 2929 5d0a  arget_series))].
-00007150: 2020 2020 2020 2020 2320 2020 2020 7061          #     pa
-00007160: 6464 696e 672e 6578 7465 6e64 285b 7461  dding.extend([ta
-00007170: 6773 5b30 5d20 666f 7220 7461 6773 2069  gs[0] for tags i
-00007180: 6e20 7461 7267 6574 5f73 6572 6965 735d  n target_series]
-00007190: 290a 2020 2020 2020 2020 2320 2020 2020  ).        #     
-000071a0: 616c 6c64 6174 612e 6170 7065 6e64 2828  alldata.append((
-000071b0: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
-000071c0: 6d65 2c20 7061 6464 696e 6729 290a 2020  me, padding)).  
-000071d0: 2020 2020 2020 2320 2020 2020 7265 7475        #     retu
-000071e0: 726e 2061 6c6c 6461 7461 0a20 2020 2020  rn alldata.     
-000071f0: 2020 2077 696e 646f 7776 616c 7565 7320     windowvalues 
-00007200: 3d20 6466 2020 2320 2e76 616c 7565 730a  = df  # .values.
-00007210: 2020 2020 2020 2020 616c 6c64 6174 6120          alldata 
-00007220: 3d20 5b5d 0a20 2020 2020 2020 2061 6c6c  = [].        all
-00007230: 6461 7461 2e61 7070 656e 6428 2874 6172  data.append((tar
-00007240: 6765 745f 7365 7269 6573 5f6e 616d 652c  get_series_name,
-00007250: 205b 7461 675b 305d 2066 6f72 2074 6167   [tag[0] for tag
-00007260: 2069 6e20 7461 7267 6574 5f73 6572 6965   in target_serie
-00007270: 735d 2929 0a20 2020 2020 2020 2066 6f72  s])).        for
-00007280: 206e 616d 6520 696e 2061 6c6c 636f 6465   name in allcode
-00007290: 733a 0a20 2020 2020 2020 2020 2020 2023  s:.            #
-000072a0: 2061 6c72 6561 6479 2063 616c 6375 6c61   already calcula
-000072b0: 7465 6420 696e 2074 6172 6765 7473 6572  ted in targetser
-000072c0: 6965 732e 0a20 2020 2020 2020 2020 2020  ies..           
-000072d0: 2069 6620 7461 7267 6574 5f73 6572 6965   if target_serie
-000072e0: 735f 6e61 6d65 2069 6e20 6e61 6d65 3a0a  s_name in name:.
-000072f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007300: 636f 6e74 696e 7565 0a0a 2020 2020 2020  continue..      
-00007310: 2020 2020 2020 2320 6465 7465 6374 2074        # detect t
-00007320: 6865 206f 6363 7572 616e 6369 6573 0a20  he occurancies. 
-00007330: 2020 2020 2020 2020 2020 206f 6363 7572             occur
-00007340: 656e 6369 6573 203d 205b 2876 616c 7565  encies = [(value
-00007350: 2c20 7469 6d65 2920 666f 7220 636f 6465  , time) for code
-00007360: 2c20 7661 6c75 652c 2074 696d 6520 696e  , value, time in
-00007370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007380: 2020 2020 2020 2020 2020 2020 7a69 7028              zip(
-00007390: 7769 6e64 6f77 7661 6c75 6573 5b3a 2c20  windowvalues[:, 
-000073a0: 315d 2c20 7769 6e64 6f77 7661 6c75 6573  1], windowvalues
-000073b0: 5b3a 2c20 335d 2c20 7769 6e64 6f77 7661  [:, 3], windowva
-000073c0: 6c75 6573 5b3a 2c20 305d 2920 6966 206e  lues[:, 0]) if n
-000073d0: 616d 6520 696e 2063 6f64 655d 0a0a 2020  ame in code]..  
-000073e0: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
-000073f0: 203d 205b 3020 666f 7220 6920 696e 2072   = [0 for i in r
-00007400: 616e 6765 286c 656e 2874 6172 6765 745f  ange(len(target_
-00007410: 7365 7269 6573 2929 5d0a 2020 2020 2020  series))].      
-00007420: 2020 2020 2020 6966 206c 656e 286f 6363        if len(occ
-00007430: 7572 656e 6369 6573 2920 3d3d 2030 3a0a  urencies) == 0:.
-00007440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007450: 7665 6374 6f72 203d 205b 3020 666f 7220  vector = [0 for 
-00007460: 6920 696e 2072 616e 6765 286c 656e 2874  i in range(len(t
-00007470: 6172 6765 745f 7365 7269 6573 2929 5d0a  arget_series))].
-00007480: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00007490: 206f 6363 7572 656e 6369 6573 5b30 5d5b   occurencies[0][
-000074a0: 305d 2069 7320 6e6f 7420 4e6f 6e65 3a0a  0] is not None:.
-000074b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000074c0: 7665 6374 6f72 203d 2073 656c 662e 6275  vector = self.bu
-000074d0: 696c 645f 636f 6e74 6578 745f 666f 725f  ild_context_for_
-000074e0: 756e 6976 6172 6961 7465 2874 6172 6765  univariate(targe
-000074f0: 745f 7365 7269 6573 2c20 6f63 6375 7265  t_series, occure
-00007500: 6e63 6965 7329 0a20 2020 2020 2020 2020  ncies).         
-00007510: 2020 2065 6c69 6620 7479 7065 5f6f 665f     elif type_of_
-00007520: 7365 7269 6573 5b6e 616d 655d 203d 3d20  series[name] == 
-00007530: 2623 3334 3b69 736f 6c61 7465 6426 2333  &#34;isolated&#3
-00007540: 343b 3a0a 2020 2020 2020 2020 2020 2020  4;:.            
-00007550: 2020 2020 7665 6374 6f72 203d 2073 656c      vector = sel
-00007560: 662e 6275 696c 645f 636f 6e74 6578 745f  f.build_context_
-00007570: 666f 725f 6973 6f6c 6174 6564 2874 6172  for_isolated(tar
-00007580: 6765 745f 7365 7269 6573 2c20 6f63 6375  get_series, occu
-00007590: 7265 6e63 6965 7329 0a20 2020 2020 2020  rencies).       
-000075a0: 2020 2020 2065 6c69 6620 7479 7065 5f6f       elif type_o
-000075b0: 665f 7365 7269 6573 5b6e 616d 655d 203d  f_series[name] =
-000075c0: 3d20 2623 3334 3b63 6f6e 6669 6775 7261  = &#34;configura
-000075d0: 7469 6f6e 2623 3334 3b3a 0a20 2020 2020  tion&#34;:.     
-000075e0: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
-000075f0: 7220 3d20 7365 6c66 2e62 7569 6c64 5f63  r = self.build_c
-00007600: 6f6e 7465 7874 5f66 6f72 5f63 6f6e 6669  ontext_for_confi
-00007610: 7567 7572 6174 696f 6e28 7461 7267 6574  uguration(target
-00007620: 5f73 6572 6965 732c 206f 6363 7572 656e  _series, occuren
-00007630: 6369 6573 290a 0a20 2020 2020 2020 2020  cies)..         
-00007640: 2020 206f 6b20 3d20 2623 3334 3b6f 6b26     ok = &#34;ok&
-00007650: 2333 343b 0a20 2020 2020 2020 2020 2020  #34;.           
-00007660: 2023 2069 6620 7665 6374 6f72 2069 7320   # if vector is 
-00007670: 7374 6174 696f 6e61 7279 2074 6865 6e20  stationary then 
-00007680: 6e6f 2063 6f6e 7465 7874 2e0a 2020 2020  no context..    
-00007690: 2020 2020 2020 2020 6966 206d 6178 2876          if max(v
-000076a0: 6563 746f 7229 203d 3d20 3020 616e 6420  ector) == 0 and 
-000076b0: 6d69 6e28 7665 6374 6f72 2920 3d3d 2030  min(vector) == 0
-000076c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-000076d0: 2020 7665 6374 6f72 203d 204e 6f6e 650a    vector = None.
-000076e0: 2020 2020 2020 2020 2020 2020 616c 6c64              alld
-000076f0: 6174 612e 6170 7065 6e64 2828 6e61 6d65  ata.append((name
-00007700: 2c20 7665 6374 6f72 2929 0a20 2020 2020  , vector)).     
-00007710: 2020 2072 6574 7572 6e20 616c 6c64 6174     return alldat
-00007720: 610a 0a20 2020 2064 6566 2062 7569 6c64  a..    def build
-00007730: 5f74 6172 6765 745f 7365 7269 6573 5f66  _target_series_f
-00007740: 6f72 5f63 6f6e 7465 7874 2873 656c 662c  or_context(self,
-00007750: 2063 7572 7265 6e74 3a20 4576 656e 7470   current: Eventp
-00007760: 6f69 6e74 2c20 6466 3a20 6e70 2e6e 6461  oint, df: np.nda
-00007770: 7272 6179 293a 0a20 2020 2020 2020 2074  rray):.        t
-00007780: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
-00007790: 6520 3d20 6375 7272 656e 742e 636f 6465  e = current.code
-000077a0: 0a20 2020 2020 2020 2077 696e 646f 7776  .        windowv
-000077b0: 616c 7565 7320 3d20 6466 2020 2320 2e76  alues = df  # .v
-000077c0: 616c 7565 730a 2020 2020 2020 2020 7461  alues.        ta
-000077d0: 7267 6574 5f73 6572 6965 7320 3d20 5b28  rget_series = [(
-000077e0: 7661 6c75 652c 2074 696d 6529 2066 6f72  value, time) for
-000077f0: 2063 6f64 652c 2076 616c 7565 2c20 7469   code, value, ti
-00007800: 6d65 2069 6e0a 2020 2020 2020 2020 2020  me in.          
-00007810: 2020 2020 2020 2020 2020 2020 2020 207a                 z
-00007820: 6970 2877 696e 646f 7776 616c 7565 735b  ip(windowvalues[
-00007830: 3a2c 2031 5d2c 2077 696e 646f 7776 616c  :, 1], windowval
-00007840: 7565 735b 3a2c 2033 5d2c 2077 696e 646f  ues[:, 3], windo
-00007850: 7776 616c 7565 735b 3a2c 2030 5d29 2069  wvalues[:, 0]) i
-00007860: 6620 7461 7267 6574 5f73 6572 6965 735f  f target_series_
-00007870: 6e61 6d65 2069 6e20 636f 6465 5d0a 0a20  name in code].. 
-00007880: 2020 2020 2020 2072 6574 7572 6e20 7461         return ta
-00007890: 7267 6574 5f73 6572 6965 735f 6e61 6d65  rget_series_name
-000078a0: 2c20 7461 7267 6574 5f73 6572 6965 730a  , target_series.
-000078b0: 0a20 2020 2064 6566 204e 756d 7079 5f70  .    def Numpy_p
-000078c0: 7265 7072 6f63 6365 7373 2873 656c 662c  reproccess(self,
-000078d0: 206e 7063 6f6e 7465 7874 293a 0a20 2020   npcontext):.   
-000078e0: 2020 2020 206e 7063 6f6e 7465 7874 203d       npcontext =
-000078f0: 206e 702e 7768 6572 6528 6e70 636f 6e74   np.where(npcont
-00007900: 6578 7420 3d3d 2026 2333 343b 6e61 6e26  ext == &#34;nan&
-00007910: 2333 343b 2c20 4e6f 6e65 2c20 6e70 636f  #34;, None, npco
-00007920: 6e74 6578 7429 0a0a 2020 2020 2020 2020  ntext)..        
-00007930: 6d61 736b 203d 205b 2826 2333 393b 305f  mask = [(&#39;0_
-00007940: 2623 3339 3b20 696e 2063 6f64 6520 616e  &#39; in code an
-00007950: 6420 7661 6c75 6520 6973 204e 6f6e 6529  d value is None)
-00007960: 2066 6f72 2063 6f64 652c 2076 616c 7565   for code, value
-00007970: 2069 6e20 7a69 7028 6e70 636f 6e74 6578   in zip(npcontex
-00007980: 745b 3a2c 2031 5d2c 206e 7063 6f6e 7465  t[:, 1], npconte
-00007990: 7874 5b3a 2c20 335d 295d 0a0a 2020 2020  xt[:, 3])]..    
-000079a0: 2020 2020 2320 6966 2069 7369 6e73 7461      # if isinsta
-000079b0: 6e63 6528 6d61 736b 2c63 6f6c 6c65 6374  nce(mask,collect
-000079c0: 696f 6e73 2e61 6263 2e53 6571 7565 6e63  ions.abc.Sequenc
-000079d0: 6529 3d3d 4661 6c73 653a 0a20 2020 2020  e)==False:.     
-000079e0: 2020 2023 2020 2020 206d 6173 6b3d 5b6d     #     mask=[m
-000079f0: 6173 6b5d 0a20 2020 2020 2020 206e 7063  ask].        npc
-00007a00: 6f6e 7465 7874 5b6d 6173 6b2c 2033 5d20  ontext[mask, 3] 
-00007a10: 3d20 300a 2020 2020 2020 2020 6d61 736b  = 0.        mask
-00007a20: 203d 205b 2826 2333 393b 315f 2623 3339   = [(&#39;1_&#39
-00007a30: 3b20 696e 2063 6f64 6520 616e 6420 7661  ; in code and va
-00007a40: 6c75 6520 6973 204e 6f6e 6529 2066 6f72  lue is None) for
-00007a50: 2063 6f64 652c 2076 616c 7565 2069 6e20   code, value in 
-00007a60: 7a69 7028 6e70 636f 6e74 6578 745b 3a2c  zip(npcontext[:,
-00007a70: 2031 5d2c 206e 7063 6f6e 7465 7874 5b3a   1], npcontext[:
-00007a80: 2c20 335d 295d 0a20 2020 2020 2020 206e  , 3])].        n
-00007a90: 7063 6f6e 7465 7874 5b6d 6173 6b2c 2033  pcontext[mask, 3
-00007aa0: 5d20 3d20 310a 2020 2020 2020 2020 636f  ] = 1.        co
-00007ab0: 6465 5f77 6974 685f 736f 7572 6365 203d  de_with_source =
-00007ac0: 205b 6626 2333 343b 7b63 6f64 657d 7b73   [f&#34;{code}{s
-00007ad0: 6f75 7263 657d 2623 3334 3b20 6966 2073  ource}&#34; if s
-00007ae0: 6f75 7263 655b 305d 203d 3d20 2623 3334  ource[0] == &#34
-00007af0: 3b40 2623 3334 3b20 656c 7365 2066 2623  ;@&#34; else f&#
-00007b00: 3334 3b7b 636f 6465 7d40 7b73 6f75 7263  34;{code}@{sourc
-00007b10: 657d 2623 3334 3b20 666f 7220 636f 6465  e}&#34; for code
-00007b20: 2c20 736f 7572 6365 2069 6e0a 2020 2020  , source in.    
-00007b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007b40: 2020 2020 2020 2020 7a69 7028 6e70 636f          zip(npco
-00007b50: 6e74 6578 745b 3a2c 2031 5d2c 206e 7063  ntext[:, 1], npc
-00007b60: 6f6e 7465 7874 5b3a 2c20 325d 295d 0a20  ontext[:, 2])]. 
-00007b70: 2020 2020 2020 206e 7063 6f6e 7465 7874         npcontext
-00007b80: 5b3a 2c20 315d 203d 2063 6f64 655f 7769  [:, 1] = code_wi
-00007b90: 7468 5f73 6f75 7263 650a 0a20 2020 2020  th_source..     
-00007ba0: 2020 2072 6574 7572 6e20 6e70 636f 6e74     return npcont
-00007bb0: 6578 740a 0a20 2020 2064 6566 2062 7569  ext..    def bui
-00007bc0: 6c64 5f63 6f6e 7465 7874 5f66 6f72 5f63  ld_context_for_c
-00007bd0: 6f6e 6669 7567 7572 6174 696f 6e28 7365  onfiuguration(se
-00007be0: 6c66 2c20 7461 7267 6574 5f73 6572 6965  lf, target_serie
-00007bf0: 732c 206f 6363 7572 656e 6369 6573 293a  s, occurencies):
-00007c00: 0a20 2020 2020 2020 2076 6563 746f 7220  .        vector 
-00007c10: 3d20 5b30 2066 6f72 2069 2069 6e20 7261  = [0 for i in ra
-00007c20: 6e67 6528 6c65 6e28 7461 7267 6574 5f73  nge(len(target_s
-00007c30: 6572 6965 7329 295d 0a20 2020 2020 2020  eries))].       
-00007c40: 2066 6f72 206f 6363 2069 6e20 6f63 6375   for occ in occu
-00007c50: 7265 6e63 6965 733a 0a20 2020 2020 2020  rencies:.       
-00007c60: 2020 2020 2066 6f72 2071 2069 6e20 7261       for q in ra
-00007c70: 6e67 6528 6c65 6e28 7461 7267 6574 5f73  nge(len(target_s
-00007c80: 6572 6965 7329 293a 0a20 2020 2020 2020  eries)):.       
-00007c90: 2020 2020 2020 2020 2069 6620 7461 7267           if targ
-00007ca0: 6574 5f73 6572 6965 735b 715d 5b31 5d20  et_series[q][1] 
-00007cb0: 2667 743b 3d20 6f63 635b 315d 3a0a 2020  &gt;= occ[1]:.  
-00007cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007cd0: 2020 666f 7220 6b20 696e 2072 616e 6765    for k in range
-00007ce0: 2871 2c20 6c65 6e28 7665 6374 6f72 2929  (q, len(vector))
-00007cf0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00007d00: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
-00007d10: 5b6b 5d20 2b3d 2031 0a20 2020 2020 2020  [k] += 1.       
-00007d20: 2020 2020 2020 2020 2020 2020 2062 7265               bre
-00007d30: 616b 0a20 2020 2020 2020 2023 2320 6e6f  ak.        ## no
-00007d40: 7420 7374 6162 6c65 0a20 2020 2020 2020  t stable.       
-00007d50: 2069 6620 6c65 6e28 7365 7428 7665 6374   if len(set(vect
-00007d60: 6f72 2929 203d 3d20 313a 0a20 2020 2020  or)) == 1:.     
-00007d70: 2020 2020 2020 2076 6563 746f 725b 305d         vector[0]
-00007d80: 203d 2030 0a20 2020 2020 2020 2072 6574   = 0.        ret
-00007d90: 7572 6e20 7665 6374 6f72 0a0a 2020 2020  urn vector..    
-00007da0: 6465 6620 6275 696c 645f 636f 6e74 6578  def build_contex
-00007db0: 745f 666f 725f 6973 6f6c 6174 6564 2873  t_for_isolated(s
-00007dc0: 656c 662c 2074 6172 6765 745f 7365 7269  elf, target_seri
-00007dd0: 6573 2c20 6f63 6375 7265 6e63 6965 7329  es, occurencies)
-00007de0: 3a0a 2020 2020 2020 2020 7665 6374 6f72  :.        vector
-00007df0: 203d 205b 3020 666f 7220 6920 696e 2072   = [0 for i in r
-00007e00: 616e 6765 286c 656e 2874 6172 6765 745f  ange(len(target_
-00007e10: 7365 7269 6573 2929 5d0a 2020 2020 2020  series))].      
-00007e20: 2020 666f 7220 6f63 6320 696e 206f 6363    for occ in occ
-00007e30: 7572 656e 6369 6573 3a0a 2020 2020 2020  urencies:.      
-00007e40: 2020 2020 2020 666f 7220 7120 696e 2072        for q in r
-00007e50: 616e 6765 286c 656e 2874 6172 6765 745f  ange(len(target_
-00007e60: 7365 7269 6573 2929 3a0a 2020 2020 2020  series)):.      
-00007e70: 2020 2020 2020 2020 2020 6966 2074 6172            if tar
-00007e80: 6765 745f 7365 7269 6573 5b71 5d5b 315d  get_series[q][1]
-00007e90: 2026 6774 3b20 6f63 635b 315d 3a0a 2020   &gt; occ[1]:.  
-00007ea0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007eb0: 2020 7665 6374 6f72 5b71 5d20 3d20 310a    vector[q] = 1.
-00007ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007ed0: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
-00007ee0: 2020 7265 7475 726e 2076 6563 746f 720a    return vector.
-00007ef0: 0a20 2020 2064 6566 2062 7569 6c64 5f63  .    def build_c
-00007f00: 6f6e 7465 7874 5f66 6f72 5f75 6e69 7661  ontext_for_univa
-00007f10: 7269 6174 6528 7365 6c66 2c20 7461 7267  riate(self, targ
-00007f20: 6574 5f73 6572 6965 732c 206f 6363 7572  et_series, occur
-00007f30: 656e 6369 6573 293a 0a20 2020 2020 2020  encies):.       
-00007f40: 2061 6c6c 7661 6c75 6573 203d 205b 5d0a   allvalues = [].
-00007f50: 2020 2020 2020 2020 7665 6374 6f72 203d          vector =
-00007f60: 205b 3020 666f 7220 6920 696e 2072 616e   [0 for i in ran
-00007f70: 6765 286c 656e 2874 6172 6765 745f 7365  ge(len(target_se
-00007f80: 7269 6573 2929 5d0a 2020 2020 2020 2020  ries))].        
-00007f90: 706f 7320 3d20 300a 2020 2020 2020 2020  pos = 0.        
-00007fa0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00007fb0: 656e 2874 6172 6765 745f 7365 7269 6573  en(target_series
-00007fc0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00007fd0: 7469 6d65 7374 616d 7020 3d20 7461 7267  timestamp = targ
-00007fe0: 6574 5f73 6572 6965 735b 695d 5b31 5d0a  et_series[i][1].
-00007ff0: 2020 2020 2020 2020 2020 2020 6375 7272              curr
-00008000: 656e 745f 706f 7320 3d20 706f 730a 2020  ent_pos = pos.  
-00008010: 2020 2020 2020 2020 2020 666f 7220 7120            for q 
-00008020: 696e 2072 616e 6765 2870 6f73 2c20 6c65  in range(pos, le
-00008030: 6e28 6f63 6375 7265 6e63 6965 7329 293a  n(occurencies)):
-00008040: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008050: 2069 6620 6f63 6375 7265 6e63 6965 735b   if occurencies[
-00008060: 715d 5b31 5d20 2667 743b 2074 696d 6573  q][1] &gt; times
-00008070: 7461 6d70 3a0a 2020 2020 2020 2020 2020  tamp:.          
-00008080: 2020 2020 2020 2020 2020 6375 7272 656e            curren
-00008090: 745f 706f 7320 3d20 710a 2020 2020 2020  t_pos = q.      
-000080a0: 2020 2020 2020 2020 2020 2020 2020 6272                br
-000080b0: 6561 6b0a 2020 2020 2020 2020 2020 2020  eak.            
-000080c0: 2320 6e6f 2064 6174 6120 666f 756e 640a  # no data found.
-000080d0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000080e0: 6375 7272 656e 745f 706f 7320 3d3d 2070  current_pos == p
-000080f0: 6f73 3a0a 2020 2020 2020 2020 2020 2020  os:.            
-00008100: 2020 2020 2320 6966 206e 6f20 6461 7461      # if no data
-00008110: 2069 6e20 6265 7477 7765 6e20 7661 6c75   in betwwen valu
-00008120: 6573 2075 7365 2074 6865 2070 7265 7669  es use the previ
-00008130: 7573 2076 616c 7565 0a20 2020 2020 2020  us value.       
-00008140: 2020 2020 2020 2020 2069 6620 6920 2667           if i &g
-00008150: 743b 2030 3a0a 2020 2020 2020 2020 2020  t; 0:.          
-00008160: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
-00008170: 5b69 5d20 3d20 7665 6374 6f72 5b69 202d  [i] = vector[i -
-00008180: 2031 5d0a 2020 2020 2020 2020 2020 2020   1].            
-00008190: 2020 2020 2320 6966 206e 6f20 6461 7461      # if no data
-000081a0: 2075 6e74 696c 2069 2074 696d 6573 7461   until i timesta
-000081b0: 6d70 2075 7365 2074 6865 2066 6972 7374  mp use the first
-000081c0: 206f 6363 7572 656e 6365 2061 7320 7661   occurence as va
-000081d0: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-000081e0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-000081f0: 2020 2020 2020 2020 2020 2020 2020 7665                ve
-00008200: 6374 6f72 5b69 5d20 3d20 6f63 6375 7265  ctor[i] = occure
-00008210: 6e63 6965 735b 305d 5b30 5d0a 2020 2020  ncies[0][0].    
-00008220: 2020 2020 2020 2020 2320 6966 206d 756c          # if mul
-00008230: 7469 706c 6520 7661 6c75 6573 2069 6e20  tiple values in 
-00008240: 6265 7477 6565 6e20 7477 6f20 7469 6d65  between two time
-00008250: 7374 616d 7073 2075 7365 2074 6865 206d  stamps use the m
-00008260: 6561 6e20 6f66 2074 6865 6d20 6173 2076  ean of them as v
-00008270: 616c 7565 0a20 2020 2020 2020 2020 2020  alue.           
-00008280: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00008290: 2020 2020 2020 2064 6174 6149 6e42 6574         dataInBet
-000082a0: 7765 656e 203d 205b 7661 6c75 6520 666f  ween = [value fo
-000082b0: 7220 7661 6c75 652c 2074 696d 6520 696e  r value, time in
-000082c0: 206f 6363 7572 656e 6369 6573 5b70 6f73   occurencies[pos
-000082d0: 3a63 7572 7265 6e74 5f70 6f73 5d5d 0a20  :current_pos]]. 
-000082e0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000082f0: 6563 746f 725b 695d 203d 2073 756d 2864  ector[i] = sum(d
-00008300: 6174 6149 6e42 6574 7765 656e 2920 2f20  ataInBetween) / 
-00008310: 6c65 6e28 6461 7461 496e 4265 7477 6565  len(dataInBetwee
-00008320: 6e29 0a20 2020 2020 2020 2020 2020 2023  n).            #
-00008330: 2069 6620 6e6f 206f 7468 6572 206f 6363   if no other occ
-00008340: 7572 656e 6369 6573 206a 7573 7420 7265  urencies just re
-00008350: 7065 6174 2074 6865 206c 6173 7420 7661  peat the last va
-00008360: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-00008370: 6966 2063 7572 7265 6e74 5f70 6f73 203d  if current_pos =
-00008380: 3d20 6c65 6e28 6f63 6375 7265 6e63 6965  = len(occurencie
-00008390: 7329 3a0a 2020 2020 2020 2020 2020 2020  s):.            
-000083a0: 2020 2020 666f 7220 6b20 696e 2072 616e      for k in ran
-000083b0: 6765 2869 202b 2031 2c20 6c65 6e28 7665  ge(i + 1, len(ve
-000083c0: 6374 6f72 2929 3a0a 2020 2020 2020 2020  ctor)):.        
-000083d0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
-000083e0: 6f72 5b6b 5d20 3d20 7665 6374 6f72 5b6b  or[k] = vector[k
-000083f0: 202d 2031 5d0a 2020 2020 2020 2020 2020   - 1].          
-00008400: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-00008410: 2020 2020 2020 2020 706f 7320 3d20 6375          pos = cu
-00008420: 7272 656e 745f 706f 730a 0a20 2020 2020  rrent_pos..     
-00008430: 2020 2072 6574 7572 6e20 7665 6374 6f72     return vector
-00008440: 0a0a 2020 2020 6465 6620 6361 6c63 756c  ..    def calcul
-00008450: 6174 655f 6361 7573 616c 6974 7928 7365  ate_causality(se
-00008460: 6c66 2c20 6461 7461 6f72 2c20 6e61 6d65  lf, dataor, name
-00008470: 7329 3a0a 2020 2020 2020 2020 6e75 6d5f  s):.        num_
-00008480: 7469 6d65 5f73 6572 6965 7320 3d20 6c65  time_series = le
-00008490: 6e28 6461 7461 6f72 290a 2020 2020 2020  n(dataor).      
-000084a0: 2020 6461 7461 203d 206e 702e 6172 7261    data = np.arra
-000084b0: 7928 6461 7461 6f72 290a 2020 2020 2020  y(dataor).      
-000084c0: 2020 6564 6765 7320 3d20 7365 6c66 2e63    edges = self.c
-000084d0: 6175 7361 6c69 7479 5f64 6973 636f 7665  ausality_discove
-000084e0: 7279 286e 616d 6573 2c20 6461 7461 290a  ry(names, data).
-000084f0: 2020 2020 2020 2020 2320 6564 6765 733d          # edges=
-00008500: 7365 6c66 2e63 616c 6375 6c61 7465 7769  self.calculatewi
-00008510: 7468 5063 286e 616d 6573 2c64 6174 6129  thPc(names,data)
-00008520: 0a20 2020 2020 2020 2023 2065 6467 6573  .        # edges
-00008530: 3d73 656c 662e 6361 6c63 756c 6174 6577  =self.calculatew
-00008540: 6974 685f 6663 6928 6e61 6d65 732c 6461  ith_fci(names,da
-00008550: 7461 290a 2020 2020 2020 2020 2320 6564  ta).        # ed
-00008560: 6765 733d 7365 6c66 2e73 616c 6573 666f  ges=self.salesfo
-00008570: 7263 6550 4328 6e61 6d65 732c 6461 7461  rcePC(names,data
-00008580: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00008590: 2065 6467 6573 0a0a 2020 2020 6465 6620   edges..    def 
-000085a0: 706c 6f74 2873 656c 662c 2066 696c 7465  plot(self, filte
-000085b0: 7265 6467 6573 3d4e 6f6e 6529 3a0a 2020  redges=None):.  
-000085c0: 2020 2020 2020 6966 2066 696c 7465 7265        if filtere
-000085d0: 6467 6573 2069 7320 4e6f 6e65 3a0a 2020  dges is None:.  
-000085e0: 2020 2020 2020 2020 2020 6669 6c74 6572            filter
-000085f0: 6564 6765 7320 3d20 5b5b 2623 3334 3b26  edges = [[&#34;&
-00008600: 2333 343b 2c20 2623 3334 3b26 2333 343b  #34;, &#34;&#34;
-00008610: 2c20 2623 3334 3b26 2333 343b 5d5d 0a20  , &#34;&#34;]]. 
-00008620: 2020 2020 2020 2073 686f 775f 636f 6e74         show_cont
-00008630: 6578 745f 6c69 7374 2873 656c 662e 636f  ext_list(self.co
-00008640: 6e74 6578 7473 2c20 7365 6c66 2e74 6172  ntexts, self.tar
-00008650: 6765 742c 2066 696c 7465 7265 6467 6573  get, filteredges
-00008660: 3d66 696c 7465 7265 6467 6573 290a 0a20  =filteredges).. 
-00008670: 2020 2064 6566 2070 6c6f 745f 696e 7465     def plot_inte
-00008680: 7270 7265 7461 7469 6f6e 2873 656c 662c  rpretation(self,
-00008690: 2066 696c 7465 7265 6467 6573 3d4e 6f6e   filteredges=Non
-000086a0: 6529 3a0a 2020 2020 2020 2020 6966 2066  e):.        if f
-000086b0: 696c 7465 7265 6467 6573 2069 7320 4e6f  ilteredges is No
-000086c0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-000086d0: 6669 6c74 6572 6564 6765 7320 3d20 5b5b  filteredges = [[
-000086e0: 2623 3334 3b26 2333 343b 2c20 2623 3334  &#34;&#34;, &#34
-000086f0: 3b26 2333 343b 2c20 2623 3334 3b26 2333  ;&#34;, &#34;&#3
-00008700: 343b 5d5d 0a20 2020 2020 2020 2073 686f  4;]].        sho
-00008710: 775f 636f 6e74 6578 745f 696e 7465 7270  w_context_interp
-00008720: 7265 7461 7469 6f6e 7328 7365 6c66 2e63  retations(self.c
-00008730: 6f6e 7465 7874 732c 2073 656c 662e 7461  ontexts, self.ta
-00008740: 7267 6574 2c20 6669 6c74 6572 6564 6765  rget, filteredge
-00008750: 733d 6669 6c74 6572 6564 6765 7329 3c2f  s=filteredges)</
-00008760: 636f 6465 3e3c 2f70 7265 3e0a 3c2f 6465  code></pre>.</de
-00008770: 7461 696c 733e 0a3c 2f73 6563 7469 6f6e  tails>.</section
-00008780: 3e0a 3c73 6563 7469 6f6e 3e0a 3c2f 7365  >.<section>.</se
-00008790: 6374 696f 6e3e 0a3c 7365 6374 696f 6e3e  ction>.<section>
-000087a0: 0a3c 2f73 6563 7469 6f6e 3e0a 3c73 6563  .</section>.<sec
-000087b0: 7469 6f6e 3e0a 3c2f 7365 6374 696f 6e3e  tion>.</section>
-000087c0: 0a3c 7365 6374 696f 6e3e 0a3c 6832 2063  .<section>.<h2 c
-000087d0: 6c61 7373 3d22 7365 6374 696f 6e2d 7469  lass="section-ti
-000087e0: 746c 6522 2069 643d 2268 6561 6465 722d  tle" id="header-
-000087f0: 636c 6173 7365 7322 3e43 6c61 7373 6573  classes">Classes
-00008800: 3c2f 6832 3e0a 3c64 6c3e 0a3c 6474 2069  </h2>.<dl>.<dt i
-00008810: 643d 2250 646d 436f 6e74 6578 742e 436f  d="PdmContext.Co
-00008820: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
-00008830: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
-00008840: 223e 3c63 6f64 6520 636c 6173 733d 2266  "><code class="f
-00008850: 6c65 7820 6e61 6d65 2063 6c61 7373 223e  lex name class">
-00008860: 0a3c 7370 616e 3e63 6c61 7373 203c 7370  .<span>class <sp
-00008870: 616e 2063 6c61 7373 3d22 6964 656e 7422  an class="ident"
-00008880: 3e43 6f6e 7465 7874 4765 6e65 7261 746f  >ContextGenerato
-00008890: 723c 2f73 7061 6e3e 3c2f 7370 616e 3e0a  r</span></span>.
-000088a0: 3c73 7061 6e3e 283c 2f73 7061 6e3e 3c73  <span>(</span><s
-000088b0: 7061 6e3e 7461 7267 6574 2c20 636f 6e74  pan>target, cont
-000088c0: 6578 745f 686f 7269 7a6f 6e3d 2738 272c  ext_horizon='8',
-000088d0: 2043 6175 7361 6c69 7479 6675 6e63 743d   Causalityfunct=
-000088e0: 266c 743b 6675 6e63 7469 6f6e 2063 616c  &lt;function cal
-000088f0: 6375 6c61 7465 5f77 6974 685f 7063 2667  culate_with_pc&g
-00008900: 743b 2c20 6465 6275 673d 4661 6c73 6529  t;, debug=False)
-00008910: 3c2f 7370 616e 3e0a 3c2f 636f 6465 3e3c  </span>.</code><
-00008920: 2f64 743e 0a3c 6464 3e0a 3c64 6976 2063  /dt>.<dd>.<div c
-00008930: 6c61 7373 3d22 6465 7363 223e 3c70 3e54  lass="desc"><p>T
-00008940: 6869 7320 436c 6173 7320 6861 6e64 6c65  his Class handle
-00008950: 2074 6865 2043 6f6e 7465 7874 2047 656e   the Context Gen
-00008960: 6572 6174 696f 6e2e 2049 7420 6b65 6570  eration. It keep
-00008970: 7320 616e 2069 6e74 6572 6e61 6c20 6275  s an internal bu
-00008980: 6666 6572 2074 6f20 6275 696c 6420 7468  ffer to build th
-00008990: 6520 636f 6e74 6578 7420 666f 7220 6120  e context for a 
-000089a0: 7461 7267 6574 2073 6572 6965 7320 6261  target series ba
-000089b0: 7365 640a 6f6e 2074 6865 2070 726f 7669  sed.on the provi
-000089c0: 6465 6420 636f 6e74 6578 745f 686f 7269  ded context_hori
-000089d0: 7a6f 6e2e 2041 6c6c 2064 6174 6120 6172  zon. All data ar
-000089e0: 6520 7061 7373 6564 2074 686f 7567 6820  e passed though 
-000089f0: 7468 6520 636f 6c6c 6563 745f 6461 7461  the collect_data
-00008a00: 206d 6574 686f 642c 2077 6869 6368 2072   method, which r
-00008a10: 6574 7572 6e20 6120 636f 7272 6573 706f  eturn a correspo
-00008a20: 6469 6e67 0a43 6f6e 7465 7874 2077 6865  ding.Context whe
-00008a30: 6e20 7461 7267 6574 2064 6174 6120 6172  n target data ar
-00008a40: 6520 7061 7373 6564 2e3c 2f70 3e0a 3c70  e passed.</p>.<p
-00008a50: 3e3c 7374 726f 6e67 3e50 6172 616d 6574  ><strong>Paramet
-00008a60: 6572 733c 2f73 7472 6f6e 673e 3a3c 2f70  ers</strong>:</p
-00008a70: 3e0a 3c70 3e3c 7374 726f 6e67 3e74 6172  >.<p><strong>tar
-00008a80: 6765 743c 2f73 7472 6f6e 673e 3a20 5468  get</strong>: Th
-00008a90: 6520 6e61 6d65 206f 6620 7468 6520 7461  e name of the ta
-00008aa0: 7267 6574 2073 6f75 7263 652c 2077 6869  rget source, whi
-00008ab0: 6368 2077 696c 6c20 6265 2075 7365 6420  ch will be used 
-00008ac0: 6173 2074 6865 2062 6173 656c 696e 6520  as the baseline 
-00008ad0: 696e 206f 7264 6572 2074 6f20 6d61 7020  in order to map 
-00008ae0: 6469 6666 6572 656e 7420 7361 6d70 6c65  different sample
-00008af0: 730a 7261 7465 2074 6f20 7468 6174 206f  s.rate to that o
-00008b00: 6620 7468 6520 7461 7267 6574 2073 616d  f the target sam
-00008b10: 706c 6520 7261 7465 2e3c 2f70 3e0a 3c70  ple rate.</p>.<p
-00008b20: 3e3c 7374 726f 6e67 3e63 6f6e 7465 7874  ><strong>context
-00008b30: 5f68 6f72 697a 6f6e 3c2f 7374 726f 6e67  _horizon</strong
-00008b40: 3e3a 2054 6865 2074 696d 6520 7065 7269  >: The time peri
-00008b50: 6f64 2074 6f20 6c6f 6f6b 2062 6163 6b20  od to look back 
-00008b60: 666f 7220 636f 6e74 6578 7420 6461 7461  for context data
-00008b70: 2c20 7468 6520 666f 726d 206f 6620 7468  , the form of th
-00008b80: 6174 2070 6172 616d 6574 6572 2069 7320  at parameter is 
-00008b90: 2238 2068 6f75 7273 223c 2f70 3e0a 3c70  "8 hours"</p>.<p
-00008ba0: 3e3c 7374 726f 6e67 3e43 6175 7361 6c69  ><strong>Causali
-00008bb0: 7479 6675 6e63 743c 2f73 7472 6f6e 673e  tyfunct</strong>
-00008bc0: 3a20 7468 6520 6361 7573 616c 6974 7920  : the causality 
-00008bd0: 6469 7363 6f76 6572 7920 6d65 7468 6f64  discovery method
-00008be0: 2074 6f20 7573 6520 746f 2070 726f 6475   to use to produ
-00008bf0: 6365 2063 6175 7361 6c20 7265 6c61 7469  ce causal relati
-00008c00: 6f6e 7368 6970 7320 6265 7477 6565 6e20  onships between 
-00008c10: 636f 6e74 6578 7420 6461 7461 2c0a 5468  context data,.Th
-00008c20: 6973 206d 7573 7420 6265 2061 2066 756e  is must be a fun
-00008c30: 6374 696f 6e20 7769 7468 2070 6172 616d  ction with param
-00008c40: 6574 6572 7320 7477 6f20 6571 7561 6c20  eters two equal 
-00008c50: 7369 7a65 206c 6973 7473 2c20 6f6e 6520  size lists, one 
-00008c60: 7769 7468 206e 616d 6573 2061 6e64 2074  with names and t
-00008c70: 6865 206f 7468 6572 0a77 6974 6820 6461  he other.with da
-00008c80: 7461 2028 6120 6c69 7374 206f 6620 6c69  ta (a list of li
-00008c90: 7374 206f 7220 3244 206e 756d 7079 2061  st or 2D numpy a
-00008ca0: 7272 6179 292e 3c2f 703e 0a3c 703e 3c73  rray).</p>.<p><s
-00008cb0: 7472 6f6e 673e 6465 6275 673c 2f73 7472  trong>debug</str
-00008cc0: 6f6e 673e 3a20 4966 2069 7420 7275 6e73  ong>: If it runs
-00008cd0: 206f 6e20 6465 6275 6720 6d6f 6465 3c2f   on debug mode</
-00008ce0: 703e 3c2f 6469 763e 0a3c 6465 7461 696c  p></div>.<detail
-00008cf0: 7320 636c 6173 733d 2273 6f75 7263 6522  s class="source"
-00008d00: 3e0a 3c73 756d 6d61 7279 3e0a 3c73 7061  >.<summary>.<spa
-00008d10: 6e3e 4578 7061 6e64 2073 6f75 7263 6520  n>Expand source 
-00008d20: 636f 6465 3c2f 7370 616e 3e0a 3c2f 7375  code</span>.</su
-00008d30: 6d6d 6172 793e 0a3c 7072 653e 3c63 6f64  mmary>.<pre><cod
-00008d40: 6520 636c 6173 733d 2270 7974 686f 6e22  e class="python"
-00008d50: 3e63 6c61 7373 2043 6f6e 7465 7874 4765  >class ContextGe
-00008d60: 6e65 7261 746f 723a 0a0a 2020 2020 6465  nerator:..    de
-00008d70: 6620 5f5f 696e 6974 5f5f 2873 656c 662c  f __init__(self,
-00008d80: 2074 6172 6765 742c 2063 6f6e 7465 7874   target, context
-00008d90: 5f68 6f72 697a 6f6e 3d26 2333 343b 3826  _horizon=&#34;8&
-00008da0: 2333 343b 2c20 4361 7573 616c 6974 7966  #34;, Causalityf
-00008db0: 756e 6374 3d63 616c 6375 6c61 7465 5f77  unct=calculate_w
-00008dc0: 6974 685f 7063 2c20 6465 6275 673d 4661  ith_pc, debug=Fa
-00008dd0: 6c73 6529 3a0a 2020 2020 2020 2020 2623  lse):.        &#
-00008de0: 3334 3b26 2333 343b 2623 3334 3b0a 2020  34;&#34;&#34;.  
-00008df0: 2020 2020 2020 5468 6973 2043 6c61 7373        This Class
-00008e00: 2068 616e 646c 6520 7468 6520 436f 6e74   handle the Cont
-00008e10: 6578 7420 4765 6e65 7261 7469 6f6e 2e20  ext Generation. 
-00008e20: 4974 206b 6565 7073 2061 6e20 696e 7465  It keeps an inte
-00008e30: 726e 616c 2062 7566 6665 7220 746f 2062  rnal buffer to b
-00008e40: 7569 6c64 2074 6865 2063 6f6e 7465 7874  uild the context
-00008e50: 2066 6f72 2061 2074 6172 6765 7420 7365   for a target se
-00008e60: 7269 6573 2062 6173 6564 0a20 2020 2020  ries based.     
-00008e70: 2020 206f 6e20 7468 6520 7072 6f76 6964     on the provid
-00008e80: 6564 2063 6f6e 7465 7874 5f68 6f72 697a  ed context_horiz
-00008e90: 6f6e 2e20 416c 6c20 6461 7461 2061 7265  on. All data are
-00008ea0: 2070 6173 7365 6420 7468 6f75 6768 2074   passed though t
-00008eb0: 6865 2063 6f6c 6c65 6374 5f64 6174 6120  he collect_data 
-00008ec0: 6d65 7468 6f64 2c20 7768 6963 6820 7265  method, which re
-00008ed0: 7475 726e 2061 2063 6f72 7265 7370 6f64  turn a correspod
-00008ee0: 696e 670a 2020 2020 2020 2020 436f 6e74  ing.        Cont
-00008ef0: 6578 7420 7768 656e 2074 6172 6765 7420  ext when target 
-00008f00: 6461 7461 2061 7265 2070 6173 7365 642e  data are passed.
-00008f10: 0a0a 0a20 2020 2020 2020 202a 2a50 6172  ...        **Par
-00008f20: 616d 6574 6572 732a 2a3a 0a0a 2020 2020  ameters**:..    
-00008f30: 2020 2020 2a2a 7461 7267 6574 2a2a 3a20      **target**: 
-00008f40: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
-00008f50: 7461 7267 6574 2073 6f75 7263 652c 2077  target source, w
-00008f60: 6869 6368 2077 696c 6c20 6265 2075 7365  hich will be use
-00008f70: 6420 6173 2074 6865 2062 6173 656c 696e  d as the baselin
-00008f80: 6520 696e 206f 7264 6572 2074 6f20 6d61  e in order to ma
-00008f90: 7020 6469 6666 6572 656e 7420 7361 6d70  p different samp
-00008fa0: 6c65 730a 2020 2020 2020 2020 2072 6174  les.         rat
-00008fb0: 6520 746f 2074 6861 7420 6f66 2074 6865  e to that of the
-00008fc0: 2074 6172 6765 7420 7361 6d70 6c65 2072   target sample r
-00008fd0: 6174 652e 0a0a 2020 2020 2020 2020 2a2a  ate...        **
-00008fe0: 636f 6e74 6578 745f 686f 7269 7a6f 6e2a  context_horizon*
-00008ff0: 2a3a 2054 6865 2074 696d 6520 7065 7269  *: The time peri
-00009000: 6f64 2074 6f20 6c6f 6f6b 2062 6163 6b20  od to look back 
-00009010: 666f 7220 636f 6e74 6578 7420 6461 7461  for context data
-00009020: 2c20 7468 6520 666f 726d 206f 6620 7468  , the form of th
-00009030: 6174 2070 6172 616d 6574 6572 2069 7320  at parameter is 
-00009040: 2623 3334 3b38 2068 6f75 7273 2623 3334  &#34;8 hours&#34
-00009050: 3b0a 0a20 2020 2020 2020 202a 2a43 6175  ;..        **Cau
-00009060: 7361 6c69 7479 6675 6e63 742a 2a3a 2074  salityfunct**: t
-00009070: 6865 2063 6175 7361 6c69 7479 2064 6973  he causality dis
-00009080: 636f 7665 7279 206d 6574 686f 6420 746f  covery method to
-00009090: 2075 7365 2074 6f20 7072 6f64 7563 6520   use to produce 
-000090a0: 6361 7573 616c 2072 656c 6174 696f 6e73  causal relations
-000090b0: 6869 7073 2062 6574 7765 656e 2063 6f6e  hips between con
-000090c0: 7465 7874 2064 6174 612c 0a20 2020 2020  text data,.     
-000090d0: 2020 2020 2020 2054 6869 7320 6d75 7374         This must
-000090e0: 2062 6520 6120 6675 6e63 7469 6f6e 2077   be a function w
-000090f0: 6974 6820 7061 7261 6d65 7465 7273 2074  ith parameters t
-00009100: 776f 2065 7175 616c 2073 697a 6520 6c69  wo equal size li
-00009110: 7374 732c 206f 6e65 2077 6974 6820 6e61  sts, one with na
-00009120: 6d65 7320 616e 6420 7468 6520 6f74 6865  mes and the othe
-00009130: 720a 2020 2020 2020 2020 2020 2020 7769  r.            wi
-00009140: 7468 2064 6174 6120 2861 206c 6973 7420  th data (a list 
-00009150: 6f66 206c 6973 7420 6f72 2032 4420 6e75  of list or 2D nu
-00009160: 6d70 7920 6172 7261 7929 2e0a 0a20 2020  mpy array)...   
-00009170: 2020 2020 202a 2a64 6562 7567 2a2a 3a20       **debug**: 
-00009180: 4966 2069 7420 7275 6e73 206f 6e20 6465  If it runs on de
-00009190: 6275 6720 6d6f 6465 0a20 2020 2020 2020  bug mode.       
-000091a0: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
-000091b0: 0a0a 2020 2020 2020 2020 7365 6c66 2e64  ..        self.d
-000091c0: 6562 7567 203d 2064 6562 7567 0a20 2020  ebug = debug.   
-000091d0: 2020 2020 2073 656c 662e 7461 7267 6574       self.target
-000091e0: 203d 2074 6172 6765 740a 0a20 2020 2020   = target..     
-000091f0: 2020 2073 656c 662e 636f 6e74 6578 7473     self.contexts
-00009200: 203d 205b 5d0a 0a20 2020 2020 2020 2073   = []..        s
-00009210: 656c 662e 6361 7573 616c 6974 795f 6469  elf.causality_di
-00009220: 7363 6f76 6572 7920 3d20 4361 7573 616c  scovery = Causal
-00009230: 6974 7966 756e 6374 0a20 2020 2020 2020  ityfunct.       
-00009240: 2073 656c 662e 6275 6666 6572 203d 205b   self.buffer = [
-00009250: 5d0a 0a20 2020 2020 2020 2023 2068 656c  ]..        # hel
-00009260: 7065 7273 0a20 2020 2020 2020 2073 656c  pers.        sel
-00009270: 662e 7479 7065 5f6f 665f 7365 7269 6573  f.type_of_series
-00009280: 203d 207b 7d0a 2020 2020 2020 2020 7365   = {}.        se
-00009290: 6c66 2e68 6f72 697a 6f6e 203d 2063 6f6e  lf.horizon = con
-000092a0: 7465 7874 5f68 6f72 697a 6f6e 2e73 706c  text_horizon.spl
-000092b0: 6974 2826 2333 343b 2026 2333 343b 295b  it(&#34; &#34;)[
-000092c0: 305d 0a20 2020 2020 2020 2069 6620 6c65  0].        if le
-000092d0: 6e28 636f 6e74 6578 745f 686f 7269 7a6f  n(context_horizo
-000092e0: 6e2e 7370 6c69 7428 2623 3334 3b20 2623  n.split(&#34; &#
-000092f0: 3334 3b29 2920 3d3d 2031 3a0a 2020 2020  34;)) == 1:.    
-00009300: 2020 2020 2020 2020 7365 6c66 2e68 6f72          self.hor
-00009310: 697a 6f6e 5f74 696d 6520 3d20 2623 3334  izon_time = &#34
-00009320: 3b68 6f75 7273 2623 3334 3b0a 2020 2020  ;hours&#34;.    
-00009330: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00009340: 2020 2020 2020 6966 2063 6f6e 7465 7874        if context
-00009350: 5f68 6f72 697a 6f6e 2e73 706c 6974 2826  _horizon.split(&
-00009360: 2333 343b 2026 2333 343b 295b 315d 2069  #34; &#34;)[1] i
-00009370: 6e20 5b26 2333 343b 6461 7973 2623 3334  n [&#34;days&#34
-00009380: 3b2c 2026 2333 343b 686f 7572 7326 2333  ;, &#34;hours&#3
-00009390: 343b 2c20 2623 3334 3b6d 696e 7574 6573  4;, &#34;minutes
-000093a0: 2623 3334 3b2c 2026 2333 343b 7365 636f  &#34;, &#34;seco
-000093b0: 6e64 7326 2333 343b 5d3a 0a20 2020 2020  nds&#34;]:.     
-000093c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000093d0: 686f 7269 7a6f 6e5f 7469 6d65 203d 2063  horizon_time = c
-000093e0: 6f6e 7465 7874 5f68 6f72 697a 6f6e 2e73  ontext_horizon.s
-000093f0: 706c 6974 2826 2333 343b 2026 2333 343b  plit(&#34; &#34;
-00009400: 295b 315d 0a20 2020 2020 2020 2020 2020  )[1].           
-00009410: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00009420: 2020 2020 2020 2061 7373 6572 7420 4661         assert Fa
-00009430: 6c73 652c 2026 2333 343b 5469 6d65 2068  lse, &#34;Time h
-00009440: 6f72 697a 6f6e 206d 7573 7420 6265 2065  orizon must be e
-00009450: 6974 6865 7220 6120 7369 6e67 6c65 206e  ither a single n
-00009460: 756d 6265 7220 6f72 2069 6e20 666f 726d  umber or in form
-00009470: 206f 6620 5c26 2333 343b 3820 686f 7572   of \&#34;8 hour
-00009480: 735c 2623 3334 3b20 7768 6572 6520 6163  s\&#34; where ac
-00009490: 6365 7074 6162 6c65 2074 696d 6520 6672  ceptable time fr
-000094a0: 616d 6573 2061 7265 2068 6f75 7273 2c64  ames are hours,d
-000094b0: 6179 732c 6d69 6e75 7465 732c 7365 636f  ays,minutes,seco
-000094c0: 6e64 7326 2333 343b 0a0a 2020 2020 2020  nds&#34;..      
-000094d0: 2020 7365 6c66 2e68 6f72 697a 6f6e 203d    self.horizon =
-000094e0: 2069 6e74 2873 656c 662e 686f 7269 7a6f   int(self.horizo
-000094f0: 6e29 0a20 2020 2020 2020 2073 656c 662e  n).        self.
-00009500: 696e 7465 7270 7265 745f 6869 7374 6f72  interpret_histor
-00009510: 795f 706f 7320 3d20 300a 2020 2020 2020  y_pos = 0.      
-00009520: 2020 7365 6c66 2e63 6f6e 7465 7874 5f70    self.context_p
-00009530: 6f73 203d 2030 0a0a 2020 2020 6465 6620  os = 0..    def 
-00009540: 636f 6c6c 6563 745f 6461 7461 2873 656c  collect_data(sel
-00009550: 662c 2074 696d 6573 7461 6d70 2c20 736f  f, timestamp, so
-00009560: 7572 6365 2c20 6e61 6d65 2c20 7661 6c75  urce, name, valu
-00009570: 653d 4e6f 6e65 2c20 7479 7065 3d26 2333  e=None, type=&#3
-00009580: 343b 556e 6976 6172 6961 7465 2623 3334  4;Univariate&#34
-00009590: 3b29 3a0a 2020 2020 2020 2020 2623 3339  ;):.        &#39
-000095a0: 3b26 2333 393b 2623 3339 3b0a 2020 2020  ;&#39;&#39;.    
-000095b0: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
-000095c0: 6973 2075 7365 6420 7768 656e 2064 6174  is used when dat
-000095d0: 6120 6172 6520 7061 7373 6564 2069 7465  a are passed ite
-000095e0: 7261 7469 7665 6c79 2c20 616e 6420 7374  ratively, and st
-000095f0: 6f72 6564 2069 6e20 6275 6666 6572 0a20  ored in buffer. 
-00009600: 2020 2020 2020 2057 6865 6e20 6461 7461         When data
-00009610: 206f 6620 7461 7267 6574 2073 6f75 7263   of target sourc
-00009620: 6520 6172 7269 7665 2c20 6120 636f 7272  e arrive, a corr
-00009630: 6573 706f 6e64 696e 6720 636f 6e74 6578  esponding contex
-00009640: 7420 6973 2070 726f 6475 6365 642e 0a20  t is produced.. 
-00009650: 2020 2020 2020 2053 6f75 7263 6573 2063         Sources c
-00009660: 616e 2062 6520 6f66 2064 6966 6665 7265  an be of differe
-00009670: 6e74 2073 616d 706c 6520 7261 7465 2028  nt sample rate (
-00009680: 616c 6c20 736f 7572 6365 7320 6172 6520  all sources are 
-00009690: 6d61 7070 6564 2074 6f20 7468 6520 7461  mapped to the ta
-000096a0: 7267 6574 7320 7361 6d70 6c65 2072 6174  rgets sample rat
-000096b0: 6520 7768 656e 2063 6f6e 7465 7874 2069  e when context i
-000096c0: 7320 7072 6f64 7563 6564 290a 0a20 2020  s produced)..   
-000096d0: 2020 2020 2053 6f75 7263 6573 2063 616e       Sources can
-000096e0: 2062 6520 6f66 2065 6974 6865 723a 0a0a   be of either:..
-000096f0: 2020 2020 2020 2020 3129 2043 6f6e 7469          1) Conti
-00009700: 6e75 6f75 7320 7479 7065 2028 7468 6f73  nuous type (thos
-00009710: 6520 7468 6174 2068 6176 6520 736f 6d65  e that have some
-00009720: 206b 696e 6420 6f66 2061 7269 7468 6d65   kind of arithme
-00009730: 7469 6320 7661 6c75 6529 0a0a 2020 2020  tic value)..    
-00009740: 2020 2020 3229 2044 6973 6372 6574 6520      2) Discrete 
-00009750: 6576 656e 7473 2028 7769 7468 6f75 7420  events (without 
-00009760: 7661 6c75 6529 202c 2077 6865 7265 206f  value) , where o
-00009770: 6e65 206f 6620 7468 6520 7479 7065 2069  ne of the type i
-00009780: 736f 6c61 7465 6420 6f72 2063 6f6e 6669  solated or confi
-00009790: 6775 7261 7469 6f6e 206d 7573 7420 6265  guration must be
-000097a0: 2061 7373 6967 6e65 640a 2020 2020 2020   assigned.      
-000097b0: 2020 2020 2020 4120 6775 6964 6520 6f6e        A guide on
-000097c0: 2068 6f77 2074 6f20 7370 6563 6966 7920   how to specify 
-000097d0: 7468 6520 7479 7065 2069 732c 2074 6861  the type is, tha
-000097e0: 7420 6576 656e 7473 2077 6869 6368 2061  t events which a
-000097f0: 7373 756d 6564 2074 6f20 6861 7665 2069  ssumed to have i
-00009800: 6d70 6163 7420 6f6e 6c79 206f 6e20 7468  mpact only on th
-00009810: 6569 7220 6f63 6375 7272 656e 6365 2c20  eir occurrence, 
-00009820: 6172 6520 6361 6c6c 6564 0a20 2020 2020  are called.     
-00009830: 2020 2020 2020 2069 736f 6c61 7465 642c         isolated,
-00009840: 2077 6869 6c65 206f 7468 6572 7320 7468   while others th
-00009850: 6174 2061 7265 2072 656c 6174 6564 2074  at are related t
-00009860: 6f20 736f 6d65 206b 696e 6420 6f66 2063  o some kind of c
-00009870: 6f6e 6669 6775 7261 7469 6f6e 2077 6974  onfiguration wit
-00009880: 6820 6d6f 7265 2070 6572 6d61 6e65 6e74  h more permanent
-00009890: 2069 6d70 6163 742c 2061 7265 2063 616c   impact, are cal
-000098a0: 6c65 6420 636f 6e66 6967 7572 6174 696f  led configuratio
-000098b0: 6e2e 0a20 2020 2020 2020 2020 2020 2045  n..            E
-000098c0: 7373 656e 7469 616c 6c79 2074 6865 2074  ssentially the t
-000098d0: 7970 6520 6f66 2074 6865 2065 7665 6e74  ype of the event
-000098e0: 7320 6465 6669 6e65 2074 6865 2077 6179  s define the way
-000098f0: 2074 6861 7420 7769 6c6c 2062 6520 7472   that will be tr
-00009900: 616e 7366 6f72 6d65 6420 746f 2072 6561  ansformed to rea
-00009910: 6c20 7661 6c75 6573 2074 696d 652d 7365  l values time-se
-00009920: 7269 6573 2e0a 0a20 2020 2020 2020 202a  ries...        *
-00009930: 2a50 6172 616d 6574 6572 732a 2a3a 0a0a  *Parameters**:..
-00009940: 2020 2020 2020 2020 2a2a 7469 6d65 7374          **timest
-00009950: 616d 702a 2a3a 2020 5468 6520 7469 6d65  amp**:  The time
-00009960: 7374 616d 7020 6f66 2074 6865 2061 7272  stamp of the arr
-00009970: 6976 6564 2076 616c 7565 0a0a 2020 2020  ived value..    
-00009980: 2020 2020 2a2a 736f 7572 6365 2a2a 3a20      **source**: 
-00009990: 5468 6520 736f 7572 6365 206f 6620 7468  The source of th
-000099a0: 6520 6172 7269 7665 6420 7661 6c75 650a  e arrived value.
-000099b0: 0a20 2020 2020 2020 202a 2a6e 616d 652a  .        **name*
-000099c0: 2a3a 2054 6865 206e 616d 6520 286f 7220  *: The name (or 
-000099d0: 6964 656e 7469 6669 6572 2920 6f66 2074  identifier) of t
-000099e0: 6865 2061 7272 6976 6564 2076 616c 7565  he arrived value
-000099f0: 0a0a 2020 2020 2020 2020 2a2a 7661 6c75  ..        **valu
-00009a00: 652a 2a3a 2054 6865 2076 616c 7565 2028  e**: The value (
-00009a10: 666c 6f61 7429 2c20 696e 2063 6173 6520  float), in case 
-00009a20: 7468 6973 2069 7320 4e6f 6e65 2074 6865  this is None the
-00009a30: 2061 7272 6976 6564 2064 6174 6120 6973   arrived data is
-00009a40: 2063 6f6e 7369 6465 7265 6420 6173 2065   considered as e
-00009a50: 7665 6e74 0a0a 2020 2020 2020 2020 2a2a  vent..        **
-00009a60: 7479 7065 2a2a 3a20 7468 6520 7479 7065  type**: the type
-00009a70: 206f 6620 7468 6520 6461 7461 2063 616e   of the data can
-00009a80: 2062 6520 6f6e 6520 6f66 2026 2333 343b   be one of &#34;
-00009a90: 6973 6f6c 6174 6564 2623 3334 3b2c 2623  isolated&#34;,&#
-00009aa0: 3334 3b63 6f6e 6669 6775 7261 7469 6f6e  34;configuration
-00009ab0: 2623 3334 3b20 7768 656e 206e 6f20 7661  &#34; when no va
-00009ac0: 6c75 6520 6973 2070 6173 7365 640a 0a20  lue is passed.. 
-00009ad0: 2020 2020 2020 202a 2a72 6574 7572 6e2a         **return*
-00009ae0: 2a3a 2020 7374 7275 6374 7572 652e 436f  *:  structure.Co
-00009af0: 6e74 6578 7420 6f62 6a65 6374 2077 6865  ntext object whe
-00009b00: 6e20 7468 6520 6461 7461 206e 616d 6520  n the data name 
-00009b10: 6d61 7463 6820 746f 2074 6865 2074 6172  match to the tar
-00009b20: 6765 7420 6e61 6d65 206f 7220 4e6f 6e65  get name or None
-00009b30: 2e0a 2020 2020 2020 2020 2623 3339 3b26  ..        &#39;&
-00009b40: 2333 393b 2623 3339 3b0a 0a20 2020 2020  #39;&#39;..     
-00009b50: 2020 2069 6620 7661 6c75 6520 6973 204e     if value is N
-00009b60: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00009b70: 2069 6620 7479 7065 206e 6f74 2069 6e20   if type not in 
-00009b80: 5b26 2333 343b 6973 6f6c 6174 6564 2623  [&#34;isolated&#
-00009b90: 3334 3b2c 2026 2333 343b 636f 6e66 6967  34;, &#34;config
-00009ba0: 7572 6174 696f 6e26 2333 343b 5d3a 0a20  uration&#34;]:. 
-00009bb0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00009bc0: 7373 6572 7420 4661 6c73 652c 2026 2333  ssert False, &#3
-00009bd0: 343b 5468 6520 7479 7065 206d 7573 7420  4;The type must 
-00009be0: 6265 2064 6566 696e 6564 2061 7320 6f6e  be defined as on
-00009bf0: 6520 6f66 205c 2623 3334 3b69 736f 6c61  e of \&#34;isola
-00009c00: 7465 645c 2623 3334 3b20 616e 6420 5c26  ted\&#34; and \&
-00009c10: 2333 343b 636f 6e66 6967 7572 6174 696f  #34;configuratio
-00009c20: 6e5c 2623 3334 3b20 7768 656e 206e 6f20  n\&#34; when no 
-00009c30: 7661 6c75 6520 6973 2070 6173 7365 6426  value is passed&
-00009c40: 2333 343b 0a20 2020 2020 2020 2065 7665  #34;.        eve
-00009c50: 6e74 706f 696e 7420 3d20 4576 656e 7470  ntpoint = Eventp
-00009c60: 6f69 6e74 2863 6f64 653d 6e61 6d65 2c20  oint(code=name, 
-00009c70: 736f 7572 6365 3d73 6f75 7263 652c 2074  source=source, t
-00009c80: 696d 6573 7461 6d70 3d74 696d 6573 7461  imestamp=timesta
-00009c90: 6d70 2c20 6465 7461 696c 733d 7661 6c75  mp, details=valu
-00009ca0: 652c 2074 7970 653d 7479 7065 290a 2020  e, type=type).  
-00009cb0: 2020 2020 2020 7365 6c66 2e61 6464 5f74        self.add_t
-00009cc0: 6f5f 6275 6666 6572 2865 7665 6e74 706f  o_buffer(eventpo
-00009cd0: 696e 7429 0a20 2020 2020 2020 2069 6620  int).        if 
-00009ce0: 7365 6c66 2e74 6172 6765 7420 3d3d 206e  self.target == n
-00009cf0: 616d 6520 6f72 2073 656c 662e 7461 7267  ame or self.targ
-00009d00: 6574 203d 3d20 6626 2333 343b 7b6e 616d  et == f&#34;{nam
-00009d10: 657d 407b 736f 7572 6365 7d26 2333 343b  e}@{source}&#34;
-00009d20: 3a0a 2020 2020 2020 2020 2020 2020 636f  :.            co
-00009d30: 6e74 6578 746f 626a 6563 7420 3d20 7365  ntextobject = se
-00009d40: 6c66 2e67 656e 6572 6174 655f 636f 6e74  lf.generate_cont
-00009d50: 6578 7428 653d 6576 656e 7470 6f69 6e74  ext(e=eventpoint
-00009d60: 2c20 6275 6666 6572 3d73 656c 662e 6275  , buffer=self.bu
-00009d70: 6666 6572 290a 2020 2020 2020 2020 2020  ffer).          
-00009d80: 2020 7265 7475 726e 2063 6f6e 7465 7874    return context
-00009d90: 6f62 6a65 6374 0a20 2020 2020 2020 2065  object.        e
-00009da0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00009db0: 2072 6574 7572 6e20 4e6f 6e65 0a0a 2020   return None..  
-00009dc0: 2020 6465 6620 6164 645f 746f 5f62 7566    def add_to_buf
-00009dd0: 6665 7228 7365 6c66 2c20 653a 2045 7665  fer(self, e: Eve
-00009de0: 6e74 706f 696e 7429 3a0a 2020 2020 2020  ntpoint):.      
-00009df0: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
-00009e00: 3b0a 2020 2020 2020 2020 4164 6473 2061  ;.        Adds a
-00009e10: 6e20 4576 656e 7420 706f 696e 7420 746f  n Event point to
-00009e20: 2074 6865 2062 7566 6665 7220 286b 6565   the buffer (kee
-00009e30: 7069 6e67 2074 6865 2062 7566 6665 7220  ping the buffer 
-00009e40: 7469 6d65 206f 7264 6572 6564 290a 2020  time ordered).  
-00009e50: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
-00009e60: 2623 3334 3b0a 2020 2020 2020 2020 696e  &#34;.        in
-00009e70: 6465 7820 3d20 6c65 6e28 7365 6c66 2e62  dex = len(self.b
-00009e80: 7566 6665 7229 0a20 2020 2020 2020 2066  uffer).        f
-00009e90: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00009ea0: 6e28 7365 6c66 2e62 7566 6665 7229 202d  n(self.buffer) -
-00009eb0: 2031 2c20 302c 202d 3129 3a0a 2020 2020   1, 0, -1):.    
-00009ec0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00009ed0: 6275 6666 6572 5b69 5d2e 7469 6d65 7374  buffer[i].timest
-00009ee0: 616d 7020 266c 743b 3d20 652e 7469 6d65  amp &lt;= e.time
-00009ef0: 7374 616d 703a 0a20 2020 2020 2020 2020  stamp:.         
-00009f00: 2020 2020 2020 2069 6e64 6578 203d 2069         index = i
-00009f10: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-00009f20: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-00009f30: 2020 2069 6620 696e 6465 7820 3d3d 206c     if index == l
-00009f40: 656e 2873 656c 662e 6275 6666 6572 293a  en(self.buffer):
-00009f50: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009f60: 662e 6275 6666 6572 2e61 7070 656e 6428  f.buffer.append(
-00009f70: 6529 0a20 2020 2020 2020 2065 6c73 653a  e).        else:
-00009f80: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00009f90: 662e 6275 6666 6572 203d 2073 656c 662e  f.buffer = self.
-00009fa0: 6275 6666 6572 5b3a 2069 6e64 6578 5d20  buffer[: index] 
-00009fb0: 2b20 5b65 5d20 2b20 7365 6c66 2e62 7566  + [e] + self.buf
-00009fc0: 6665 725b 696e 6465 783a 5d0a 0a20 2020  fer[index:]..   
-00009fd0: 2020 2020 206c 6173 7420 3d20 7365 6c66       last = self
-00009fe0: 2e62 7566 6665 725b 2d31 5d0a 2020 2020  .buffer[-1].    
-00009ff0: 2020 2020 706f 7320 3d20 6c65 6e28 7365      pos = len(se
-0000a000: 6c66 2e62 7566 6665 7229 202d 2031 0a20  lf.buffer) - 1. 
-0000a010: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0000a020: 7261 6e67 6528 6c65 6e28 7365 6c66 2e62  range(len(self.b
-0000a030: 7566 6665 7229 293a 0a20 2020 2020 2020  uffer)):.       
-0000a040: 2020 2020 2069 6620 7365 6c66 2e62 7566       if self.buf
-0000a050: 6665 725b 695d 2e74 696d 6573 7461 6d70  fer[i].timestamp
-0000a060: 2026 6774 3b3d 2028 6c61 7374 2e74 696d   &gt;= (last.tim
-0000a070: 6573 7461 6d70 202d 2070 642e 5469 6d65  estamp - pd.Time
-0000a080: 6465 6c74 6128 7365 6c66 2e68 6f72 697a  delta(self.horiz
-0000a090: 6f6e 2c20 7365 6c66 2e68 6f72 697a 6f6e  on, self.horizon
-0000a0a0: 5f74 696d 6529 293a 0a20 2020 2020 2020  _time)):.       
-0000a0b0: 2020 2020 2020 2020 2070 6f73 203d 2069           pos = i
-0000a0c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a0d0: 2062 7265 616b 0a20 2020 2020 2020 2073   break.        s
-0000a0e0: 656c 662e 6275 6666 6572 203d 2073 656c  elf.buffer = sel
-0000a0f0: 662e 6275 6666 6572 5b70 6f73 3a5d 0a0a  f.buffer[pos:]..
-0000a100: 2020 2020 6465 6620 6765 6e65 7261 7465      def generate
-0000a110: 5f63 6f6e 7465 7874 2873 656c 662c 2065  _context(self, e
-0000a120: 3a20 4576 656e 7470 6f69 6e74 2c20 6275  : Eventpoint, bu
-0000a130: 6666 6572 293a 0a20 2020 2020 2020 2026  ffer):.        &
-0000a140: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-0000a150: 2020 2020 2020 2047 656e 6572 6174 6520         Generate 
-0000a160: 636f 6e74 6578 7420 616e 6420 696e 7465  context and inte
-0000a170: 7270 7265 7461 7469 6f6e 2e0a 0a20 2020  rpretation...   
-0000a180: 2020 2020 202a 2a50 6172 616d 6574 6572       **Parameter
-0000a190: 732a 2a3a 0a0a 2020 2020 2020 2020 2a2a  s**:..        **
-0000a1a0: 652a 2a3a 2045 7665 6e74 706f 696e 7420  e**: Eventpoint 
-0000a1b0: 7265 6c61 7465 6420 746f 2074 6865 206c  related to the l
-0000a1c0: 6173 7420 7461 7267 6574 2623 3339 3b73  ast target&#39;s
-0000a1d0: 2064 6174 612e 0a0a 2020 2020 2020 2020   data...        
-0000a1e0: 2a2a 6275 6666 6572 2a2a 3a20 4120 6c69  **buffer**: A li
-0000a1f0: 7374 2077 6974 6820 616c 6c20 4576 656e  st with all Even
-0000a200: 7470 6f69 6e74 7320 696e 2074 6865 2074  tpoints in the t
-0000a210: 696d 6520 686f 7269 7a6f 6e0a 2020 2020  ime horizon.    
-0000a220: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
-0000a230: 3334 3b0a 0a20 2020 2020 2020 2063 6f6e  34;..        con
-0000a240: 7465 7874 6375 7272 656e 742c 2074 6172  textcurrent, tar
-0000a250: 6765 745f 7365 7269 6573 5f6e 616d 6520  get_series_name 
-0000a260: 3d20 7365 6c66 2e63 7265 6174 655f 636f  = self.create_co
-0000a270: 6e74 6578 7428 652c 2062 7566 6665 7229  ntext(e, buffer)
-0000a280: 0a0a 2020 2020 2020 2020 7365 6c66 2e63  ..        self.c
-0000a290: 6f6e 7465 7874 732e 6170 7065 6e64 2863  ontexts.append(c
-0000a2a0: 6f6e 7465 7874 6375 7272 656e 7429 0a20  ontextcurrent). 
-0000a2b0: 2020 2020 2020 2073 656c 662e 6372 6561         self.crea
-0000a2c0: 7465 5f69 6e74 6572 7072 6574 6174 696f  te_interpretatio
-0000a2d0: 6e28 636f 6e74 6578 7463 7572 7265 6e74  n(contextcurrent
-0000a2e0: 2c20 7461 7267 6574 5f73 6572 6965 735f  , target_series_
-0000a2f0: 6e61 6d65 290a 0a20 2020 2020 2020 2069  name)..        i
-0000a300: 6e74 6572 7475 7073 203d 205b 7474 7475  ntertups = [tttu
-0000a310: 7020 666f 7220 7474 7475 7020 696e 0a20  p for tttup in. 
+00004e90: 2020 2020 7365 6c66 2e63 6f6e 7465 7874      self.context
+00004ea0: 735b 2d31 5d2e 4352 5b26 2333 343b 696e  s[-1].CR[&#34;in
+00004eb0: 7465 7270 7265 7461 7469 6f6e 2623 3334  terpretation&#34
+00004ec0: 3b5d 5d0a 2020 2020 2020 2020 2320 7468  ;]].        # th
+00004ed0: 6973 2069 7320 7573 6566 756c 6c20 666f  is is usefull fo
+00004ee0: 7220 706c 6f74 696e 670a 2020 2020 2020  r ploting.      
+00004ef0: 2020 7365 6c66 2e63 6f6e 7465 7874 735b    self.contexts[
+00004f00: 2d31 5d2e 4352 5b26 2333 343b 696e 7465  -1].CR[&#34;inte
+00004f10: 7270 7265 7461 7469 6f6e 2623 3334 3b5d  rpretation&#34;]
+00004f20: 203d 2069 6e74 6572 7475 7073 0a0a 2020   = intertups..  
+00004f30: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00004f40: 662e 636f 6e74 6578 7473 5b2d 315d 0a0a  f.contexts[-1]..
+00004f50: 2020 2020 6465 6620 6372 6561 7465 5f69      def create_i
+00004f60: 6e74 6572 7072 6574 6174 696f 6e28 7365  nterpretation(se
+00004f70: 6c66 2c20 636f 6e74 6578 7463 7572 7265  lf, contextcurre
+00004f80: 6e74 3a20 436f 6e74 6578 742c 2074 6172  nt: Context, tar
+00004f90: 6765 745f 7365 7269 6573 5f6e 616d 6529  get_series_name)
+00004fa0: 3a0a 2020 2020 2020 2020 2623 3334 3b26  :.        &#34;&
+00004fb0: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
+00004fc0: 2020 5468 6973 206d 6574 686f 6420 636f    This method co
+00004fd0: 6c6c 6563 7420 616c 6c20 7468 6520 636f  llect all the co
+00004fe0: 6e74 6578 7473 2069 6e20 7468 6520 686f  ntexts in the ho
+00004ff0: 7269 7a6f 6e20 616e 6420 6361 6c6c 7320  rizon and calls 
+00005000: 7468 6520 696e 7465 7270 7265 7461 7469  the interpretati
+00005010: 6f6e 206d 6574 686f 642e 0a0a 2020 2020  on method...    
+00005020: 2020 2020 2a2a 5061 7261 6d65 7465 7273      **Parameters
+00005030: 2a2a 3a0a 0a20 2020 2020 2020 202a 2a63  **:..        **c
+00005040: 6f6e 7465 7874 6375 7272 656e 742a 2a3a  ontextcurrent**:
+00005050: 2054 6865 2043 6f6e 7465 7874 2066 6f72   The Context for
+00005060: 2077 6869 6368 2074 6865 2069 6e74 6572   which the inter
+00005070: 7072 6574 6174 696f 6e20 6973 2063 616c  pretation is cal
+00005080: 6375 6c61 7465 640a 0a20 2020 2020 2020  culated..       
+00005090: 202a 2a74 6172 6765 745f 7365 7269 6573   **target_series
+000050a0: 5f6e 616d 652a 2a3a 2054 6865 6e20 6e61  _name**: Then na
+000050b0: 6d65 206f 6620 7468 6520 7461 7267 6574  me of the target
+000050c0: 2076 6172 6961 626c 650a 2020 2020 2020   variable.      
+000050d0: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
+000050e0: 3b0a 0a20 2020 2020 2020 2072 696b 6963  ;..        rikic
+000050f0: 6f6e 7465 7874 203d 2073 656c 662e 636f  ontext = self.co
+00005100: 6e74 6578 7473 0a20 2020 2020 2020 2070  ntexts.        p
+00005110: 6f73 203d 2073 656c 662e 696e 7465 7270  os = self.interp
+00005120: 7265 745f 6869 7374 6f72 795f 706f 730a  ret_history_pos.
+00005130: 2020 2020 2020 2020 7465 6d70 706f 7320          temppos 
+00005140: 3d20 706f 730a 2020 2020 2020 2020 666f  = pos.        fo
+00005150: 7220 7120 696e 2072 616e 6765 2870 6f73  r q in range(pos
+00005160: 2c20 6c65 6e28 7269 6b69 636f 6e74 6578  , len(rikicontex
+00005170: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
+00005180: 2074 656d 7070 6f73 203d 2071 0a20 2020   temppos = q.   
+00005190: 2020 2020 2020 2020 2069 6620 7064 2e74           if pd.t
+000051a0: 6f5f 6461 7465 7469 6d65 2872 696b 6963  o_datetime(rikic
+000051b0: 6f6e 7465 7874 5b71 5d2e 7469 6d65 7374  ontext[q].timest
+000051c0: 616d 7029 2026 6774 3b3d 2028 0a20 2020  amp) &gt;= (.   
+000051d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000051e0: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
+000051f0: 636f 6e74 6578 7463 7572 7265 6e74 2e74  contextcurrent.t
+00005200: 696d 6573 7461 6d70 2920 2d20 7064 2e54  imestamp) - pd.T
+00005210: 696d 6564 656c 7461 2873 656c 662e 686f  imedelta(self.ho
+00005220: 7269 7a6f 6e2c 2073 656c 662e 686f 7269  rizon, self.hori
+00005230: 7a6f 6e5f 7469 6d65 2929 3a0a 2020 2020  zon_time)):.    
+00005240: 2020 2020 2020 2020 2020 2020 6272 6561              brea
+00005250: 6b0a 2020 2020 2020 2020 6361 7573 6573  k.        causes
+00005260: 7769 6e64 6f77 203d 2072 696b 6963 6f6e  window = rikicon
+00005270: 7465 7874 5b74 656d 7070 6f73 3a5d 0a20  text[temppos:]. 
+00005280: 2020 2020 2020 2073 656c 662e 696e 7465         self.inte
+00005290: 7270 7265 745f 6869 7374 6f72 795f 706f  rpret_history_po
+000052a0: 7320 3d20 7465 6d70 706f 730a 2020 2020  s = temppos.    
+000052b0: 2020 2020 696e 7465 7270 7220 3d20 7365      interpr = se
+000052c0: 6c66 2e69 6e74 6572 7072 6574 2863 6f6e  lf.interpret(con
+000052d0: 7465 7874 6375 7272 656e 742c 2063 6175  textcurrent, cau
+000052e0: 7365 7377 696e 646f 772c 2074 6172 6765  seswindow, targe
+000052f0: 745f 7365 7269 6573 5f6e 616d 652c 2073  t_series_name, s
+00005300: 656c 662e 7479 7065 5f6f 665f 7365 7269  elf.type_of_seri
+00005310: 6573 290a 2020 2020 2020 2020 7365 6c66  es).        self
+00005320: 2e63 6f6e 7465 7874 735b 2d31 5d2e 4352  .contexts[-1].CR
+00005330: 5b26 2333 343b 696e 7465 7270 7265 7461  [&#34;interpreta
+00005340: 7469 6f6e 2623 3334 3b5d 203d 2069 6e74  tion&#34;] = int
+00005350: 6572 7072 0a0a 2020 2020 6465 6620 696e  erpr..    def in
+00005360: 7465 7270 7265 7428 7365 6c66 2c20 636f  terpret(self, co
+00005370: 6e74 6578 743a 2043 6f6e 7465 7874 2c20  ntext: Context, 
+00005380: 6361 7573 6573 7769 6e64 6f77 2c20 7461  causeswindow, ta
+00005390: 7267 6574 2c20 7479 7065 5f6f 665f 7365  rget, type_of_se
+000053a0: 7269 6573 293a 0a20 2020 2020 2020 2026  ries):.        &
+000053b0: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
+000053c0: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
+000053d0: 6f64 2065 6e68 616e 6365 2074 6865 2043  od enhance the C
+000053e0: 5220 7061 7274 206f 6620 7468 6520 436f  R part of the Co
+000053f0: 6e74 6578 7420 7769 7468 2069 6e74 6572  ntext with inter
+00005400: 7072 6574 6174 696f 6e20 7265 6c61 7469  pretation relati
+00005410: 6e67 2074 6f20 7468 6520 7461 7267 6574  ng to the target
+00005420: 2076 6172 6961 626c 652e 0a20 2020 2020   variable..     
+00005430: 2020 2054 6865 2069 6e74 6572 7072 6574     The interpret
+00005440: 6174 696f 6e20 6172 6520 6261 7365 6420  ation are based 
+00005450: 6f6e 2074 6865 2065 6467 6573 2065 7874  on the edges ext
+00005460: 7261 6374 6564 2066 726f 6d20 7468 6520  racted from the 
+00005470: 4361 7375 616c 7479 2064 6973 636f 7665  Casualty discove
+00005480: 7279 2e0a 2020 2020 2020 2020 466f 7220  ry..        For 
+00005490: 6561 6368 2065 6467 6520 6f66 2074 7970  each edge of typ
+000054a0: 6520 2873 6572 6965 7341 202d 2667 743b  e (seriesA -&gt;
+000054b0: 2074 6172 6765 7429 2069 6e20 7468 6520   target) in the 
+000054c0: 6564 6765 7320 7765 2074 6573 7420 6966  edges we test if
+000054d0: 2074 6865 2073 6572 6965 7341 2069 6e74   the seriesA int
+000054e0: 6572 7072 6574 730a 2020 2020 2020 2020  erprets.        
+000054f0: 7468 6520 7461 7267 6574 2075 7369 6e67  the target using
+00005500: 2074 6865 2066 6f6c 6c6f 7769 6e67 2072   the following r
+00005510: 756c 6573 3a0a 0a20 2020 2020 2020 202a  ules:..        *
+00005520: 2a69 6620 7365 7269 6573 4120 6973 2069  *if seriesA is i
+00005530: 736f 6c61 7465 642a 2a3a 2057 6520 6368  solated**: We ch
+00005540: 6563 6b20 6966 2069 7473 206c 6173 7420  eck if its last 
+00005550: 6f63 6375 7272 656e 6365 2069 7320 7468  occurrence is th
+00005560: 6520 6375 7272 656e 7420 7469 6d65 7374  e current timest
+00005570: 616d 7020 6f72 2074 6865 2070 7265 7669  amp or the previ
+00005580: 6f75 7320 6f6e 652e 0a0a 2020 2020 2020  ous one...      
+00005590: 2020 2a2a 6966 2073 6572 6965 7341 2069    **if seriesA i
+000055a0: 7320 636f 6e66 6967 7572 6174 696f 6e2a  s configuration*
+000055b0: 2a3a 2057 6520 6368 6563 6b20 6966 2074  *: We check if t
+000055c0: 6865 2065 6467 6573 2028 7365 7269 6573  he edges (series
+000055d0: 4120 2d26 6774 3b20 7461 7267 6574 2920  A -&gt; target) 
+000055e0: 6170 7065 6172 730a 2020 2020 2020 2020  appears.        
+000055f0: 696e 2061 7420 6c65 6173 7420 3830 2520  in at least 80% 
+00005600: 636f 6e74 6578 7473 2069 6e20 7468 6520  contexts in the 
+00005610: 686f 7269 7a6f 6e20 2869 2e65 2e20 696e  horizon (i.e. in
+00005620: 2063 6175 7365 7377 696e 646f 7720 6c69   causeswindow li
+00005630: 7374 292e 0a0a 2020 2020 2020 2020 2a2a  st)...        **
+00005640: 6966 2073 6572 6965 7341 2069 7320 636f  if seriesA is co
+00005650: 6e74 696e 756f 7573 2a2a 3a20 5468 656e  ntinuous**: Then
+00005660: 2074 6861 7420 6d65 616e 7320 7468 6520   that means the 
+00005670: 7461 7267 6574 2069 7320 7265 6c61 7465  target is relate
+00005680: 6420 7769 7468 2073 6572 6965 7341 0a20  d with seriesA. 
+00005690: 2020 2020 2020 2061 6e64 2077 6520 6164         and we ad
+000056a0: 6420 6974 2074 6f20 7468 6520 696e 7465  d it to the inte
+000056b0: 7270 7265 7461 7469 6f6e 2e0a 0a20 2020  rpretation...   
+000056c0: 2020 2020 2041 6c6c 2074 6865 2069 6e74       All the int
+000056d0: 6572 7072 6574 6174 696f 6e73 2061 7265  erpretations are
+000056e0: 2074 6167 6765 6420 7769 7468 2061 2074   tagged with a t
+000056f0: 696d 6573 7461 6d70 2077 6869 6368 2072  imestamp which r
+00005700: 6566 6572 7320 746f 2074 6865 2066 6972  efers to the fir
+00005710: 7374 2074 696d 650a 2020 2020 2020 2020  st time.        
+00005720: 6f66 2061 7070 6561 7265 6e73 6520 6f66  of appearense of
+00005730: 2063 6f6e 7365 6375 7469 7665 2069 6e74   consecutive int
+00005740: 6572 7072 6574 6174 696f 6e73 2e20 5468  erpretations. Th
+00005750: 656e 2074 6865 2069 6e74 6572 7072 6574  en the interpret
+00005760: 6174 696f 6e20 6172 6520 736f 7274 6564  ation are sorted
+00005770: 2075 7369 6e67 0a20 2020 2020 2020 2074   using.        t
+00005780: 6869 7320 7469 6d65 7374 616d 702e 2054  his timestamp. T
+00005790: 6869 7320 6973 2064 6f6e 6520 746f 2070  his is done to p
+000057a0: 726f 7669 6465 2061 2068 6965 7261 7263  rovide a hierarc
+000057b0: 6879 2074 6f20 7468 6520 696e 7465 7270  hy to the interp
+000057c0: 7265 7461 7469 6f6e 2073 696e 6365 2069  retation since i
+000057d0: 7420 6d61 7920 6265 2074 6865 2063 6173  t may be the cas
+000057e0: 652c 0a20 2020 2020 2020 2074 6861 7420  e,.        that 
+000057f0: 7768 656e 2073 6572 6965 7341 2063 6175  when seriesA cau
+00005800: 7365 2074 6172 6765 7420 2c20 616e 6420  se target , and 
+00005810: 5365 7269 6573 4220 6361 7573 6520 7461  SeriesB cause ta
+00005820: 7267 6574 2c20 7468 6520 6f6c 6465 7374  rget, the oldest
+00005830: 206f 6e65 2069 7320 7374 726f 6e67 6572   one is stronger
+00005840: 2073 696e 6365 2074 6865 2053 6572 6965   since the Serie
+00005850: 7342 206d 6179 2062 650a 2020 2020 2020  sB may be.      
+00005860: 2020 6566 6665 6374 206f 6620 7365 7269    effect of seri
+00005870: 6573 412e 0a0a 2020 2020 2020 2020 2a2a  esA...        **
+00005880: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
+00005890: 2020 2020 2020 202a 2a63 6f6e 7465 7874         **context
+000058a0: 2a2a 3a20 436f 6e74 6578 7420 4f62 6a65  **: Context Obje
+000058b0: 6374 2074 6f20 6265 2069 6e74 6572 7072  ct to be interpr
+000058c0: 6574 6564 0a0a 2020 2020 2020 2020 2a2a  eted..        **
+000058d0: 6361 7573 6573 7769 6e64 6f77 2a2a 3a20  causeswindow**: 
+000058e0: 6c69 7374 2077 6974 6820 7468 6520 6c61  list with the la
+000058f0: 7374 2068 6f72 697a 6f6e 2063 6f6e 7465  st horizon conte
+00005900: 7874 730a 0a20 2020 2020 2020 202a 2a74  xts..        **t
+00005910: 6172 6765 742a 2a3a 2074 6865 206e 616d  arget**: the nam
+00005920: 6520 6f66 2074 6865 2074 6172 6765 7420  e of the target 
+00005930: 7661 7269 6162 6c65 2074 6f20 696e 7465  variable to inte
+00005940: 7270 7265 740a 0a20 2020 2020 2020 202a  rpret..        *
+00005950: 2a74 7970 655f 6f66 5f73 6572 6965 732a  *type_of_series*
+00005960: 2a3a 2064 6963 7469 6f6e 6172 7920 7768  *: dictionary wh
+00005970: 6963 6820 6465 6669 6e65 2074 6865 2074  ich define the t
+00005980: 7970 6520 6f66 2065 6163 6820 7365 7269  ype of each seri
+00005990: 6573 2028 6973 6f6c 6174 6564 2c63 6f6e  es (isolated,con
+000059a0: 6669 6775 7261 7469 6f6e 206f 7220 636f  figuration or co
+000059b0: 6e74 696e 756f 7573 290a 2020 2020 2020  ntinuous).      
+000059c0: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
+000059d0: 3b0a 0a20 2020 2020 2020 2070 6169 7273  ;..        pairs
+000059e0: 203d 205b 2870 6169 725b 305d 2c20 7061   = [(pair[0], pa
+000059f0: 6972 5b31 5d2c 2063 6172 2920 666f 7220  ir[1], car) for 
+00005a00: 7061 6972 2c20 6361 7220 696e 207a 6970  pair, car in zip
+00005a10: 2863 6f6e 7465 7874 2e43 525b 2623 3339  (context.CR[&#39
+00005a20: 3b65 6467 6573 2623 3339 3b5d 2c20 636f  ;edges&#39;], co
+00005a30: 6e74 6578 742e 4352 5b26 2333 393b 6368  ntext.CR[&#39;ch
+00005a40: 6172 6163 7465 7269 7a61 7469 6f6e 2623  aracterization&#
+00005a50: 3339 3b5d 2920 6966 0a20 2020 2020 2020  39;]) if.       
+00005a60: 2020 2020 2020 2020 2020 7461 7267 6574            target
+00005a70: 2069 6e20 7061 6972 5b31 5d5d 0a0a 2020   in pair[1]]..  
+00005a80: 2020 2020 2020 2320 7061 6972 7368 6f70        # pairshop
+00005a90: 3220 3d20 5b5d 0a20 2020 2020 2020 2023  2 = [].        #
+00005aa0: 2069 6e74 6572 6d65 6469 6174 6573 3d5b   intermediates=[
+00005ab0: 7061 6972 5b30 5d20 666f 7220 7061 6972  pair[0] for pair
+00005ac0: 2069 6e20 7061 6972 735d 0a20 2020 2020   in pairs].     
+00005ad0: 2020 2023 2061 6c6c 6f74 6865 733d 5b70     # allothes=[p
+00005ae0: 6169 7220 666f 7220 7061 6972 2069 6e20  air for pair in 
+00005af0: 636f 6e74 6578 742e 4344 2e6b 6579 7328  context.CD.keys(
+00005b00: 2920 6966 2070 6169 7220 6e6f 7420 696e  ) if pair not in
+00005b10: 2069 6e74 6572 6d65 6469 6174 6573 5d0a   intermediates].
+00005b20: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
+00005b30: 2020 2320 666f 7220 696e 7465 725f 7061    # for inter_pa
+00005b40: 6972 2069 6e20 696e 7465 726d 6564 6961  ir in intermedia
+00005b50: 7465 733a 0a20 2020 2020 2020 2023 2020  tes:.        #  
+00005b60: 2020 2066 6f72 206e 616d 6520 696e 2061     for name in a
+00005b70: 6c6c 6f74 6865 733a 0a20 2020 2020 2020  llothes:.       
+00005b80: 2023 2020 2020 2020 2020 2069 6620 286e   #         if (n
+00005b90: 616d 652c 696e 7465 725f 7061 6972 2920  ame,inter_pair) 
+00005ba0: 696e 2063 6f6e 7465 7874 2e43 525b 2623  in context.CR[&#
+00005bb0: 3334 3b65 6467 6573 2623 3334 3b5d 3a0a  34;edges&#34;]:.
+00005bc0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+00005bd0: 2020 2020 2020 7061 6972 7368 6f70 322e        pairshop2.
+00005be0: 6170 7065 6e64 2828 6e61 6d65 2c69 6e74  append((name,int
+00005bf0: 6572 5f70 6169 7229 290a 0a20 2020 2020  er_pair))..     
+00005c00: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
+00005c10: 6e20 3d20 5b5d 0a20 2020 2020 2020 2074  n = [].        t
+00005c20: 7970 6563 6f6e 6563 7469 6f6e 203d 205b  ypeconection = [
+00005c30: 5d0a 2020 2020 2020 2020 6966 206c 656e  ].        if len
+00005c40: 2870 6169 7273 2920 3d3d 2030 3a0a 2020  (pairs) == 0:.  
+00005c50: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00005c60: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
+00005c70: 7061 6972 2069 6e20 7061 6972 733a 0a20  pair in pairs:. 
+00005c80: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
+00005c90: 7065 5f6f 665f 7365 7269 6573 5b70 6169  pe_of_series[pai
+00005ca0: 725b 305d 5d20 3d3d 2026 2333 343b 6973  r[0]] == &#34;is
+00005cb0: 6f6c 6174 6564 2623 3334 3b3a 0a20 2020  olated&#34;:.   
+00005cc0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00005cd0: 7565 7331 203d 2063 6f6e 7465 7874 2e43  ues1 = context.C
+00005ce0: 445b 7061 6972 5b30 5d5d 0a20 2020 2020  D[pair[0]].     
+00005cf0: 2020 2020 2020 2020 2020 2069 6620 7661             if va
+00005d00: 6c75 6573 315b 2d31 5d20 3d3d 2031 3a0a  lues1[-1] == 1:.
+00005d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005d20: 2020 2020 696e 7465 7270 7265 7461 7469      interpretati
+00005d30: 6f6e 2e61 7070 656e 6428 2870 6169 725b  on.append((pair[
+00005d40: 305d 2c20 7061 6972 5b31 5d2c 2070 6169  0], pair[1], pai
+00005d50: 725b 325d 2c20 636f 6e74 6578 742e 7469  r[2], context.ti
+00005d60: 6d65 7374 616d 7029 290a 2020 2020 2020  mestamp)).      
+00005d70: 2020 2020 2020 2020 2020 656c 6966 2076            elif v
+00005d80: 616c 7565 7331 5b2d 325d 203d 3d20 313a  alues1[-2] == 1:
+00005d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00005da0: 2020 2020 2074 656d 7074 696d 6573 7461       temptimesta
+00005db0: 6d70 203d 2063 6f6e 7465 7874 2e74 696d  mp = context.tim
+00005dc0: 6573 7461 6d70 0a20 2020 2020 2020 2020  estamp.         
+00005dd0: 2020 2020 2020 2020 2020 206c 6173 7463             lastc
+00005de0: 6f6e 7465 7874 203d 2073 656c 662e 636f  ontext = self.co
+00005df0: 6e74 6578 7473 5b6d 6178 286c 656e 2873  ntexts[max(len(s
+00005e00: 656c 662e 636f 6e74 6578 7473 2920 2d20  elf.contexts) - 
+00005e10: 322c 2030 295d 0a20 2020 2020 2020 2020  2, 0)].         
+00005e20: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
+00005e30: 6e74 6572 7061 6972 2069 6e20 6c61 7374  nterpair in last
+00005e40: 636f 6e74 6578 742e 4352 5b26 2333 343b  context.CR[&#34;
+00005e50: 696e 7465 7270 7265 7461 7469 6f6e 2623  interpretation&#
+00005e60: 3334 3b5d 3a0a 2020 2020 2020 2020 2020  34;]:.          
+00005e70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00005e80: 2069 6e74 6572 7061 6972 5b30 5d20 3d3d   interpair[0] ==
+00005e90: 2070 6169 725b 305d 2061 6e64 2069 6e74   pair[0] and int
+00005ea0: 6572 7061 6972 5b31 5d20 3d3d 2070 6169  erpair[1] == pai
+00005eb0: 725b 315d 3a0a 2020 2020 2020 2020 2020  r[1]:.          
+00005ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005ed0: 2020 7465 6d70 7469 6d65 7374 616d 7020    temptimestamp 
+00005ee0: 3d20 696e 7465 7270 6169 725b 335d 0a20  = interpair[3]. 
+00005ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f00: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
+00005f10: 6e2e 6170 7065 6e64 2828 7061 6972 5b30  n.append((pair[0
+00005f20: 5d2c 2070 6169 725b 315d 2c20 7061 6972  ], pair[1], pair
+00005f30: 5b32 5d2c 2074 656d 7074 696d 6573 7461  [2], temptimesta
+00005f40: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
+00005f50: 2065 6c69 6620 7479 7065 5f6f 665f 7365   elif type_of_se
+00005f60: 7269 6573 5b70 6169 725b 305d 5d20 3d3d  ries[pair[0]] ==
+00005f70: 2026 2333 343b 636f 6e66 6967 7572 6174   &#34;configurat
+00005f80: 696f 6e26 2333 343b 3a0a 2020 2020 2020  ion&#34;:.      
+00005f90: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+00005fa0: 3120 3d20 636f 6e74 6578 742e 4344 5b70  1 = context.CD[p
+00005fb0: 6169 725b 305d 5d0a 2020 2020 2020 2020  air[0]].        
+00005fc0: 2020 2020 2020 2020 6f63 6375 7265 6e63          occurenc
+00005fd0: 6520 3d20 300a 2020 2020 2020 2020 2020  e = 0.          
+00005fe0: 2020 2020 2020 666f 7220 7120 696e 2072        for q in r
+00005ff0: 616e 6765 286c 656e 2876 616c 7565 7331  ange(len(values1
+00006000: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00006010: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+00006020: 7331 5b71 5d20 3d3d 2076 616c 7565 7331  s1[q] == values1
+00006030: 5b2d 315d 2061 6e64 2076 616c 7565 7331  [-1] and values1
+00006040: 5b71 5d20 2667 743b 2030 3a0a 2020 2020  [q] &gt; 0:.    
+00006050: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006060: 2020 2020 6f63 6375 7265 6e63 6520 3d20      occurence = 
+00006070: 710a 2020 2020 2020 2020 2020 2020 2020  q.              
+00006080: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+00006090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000060a0: 6966 206f 6363 7572 656e 6365 203d 3d20  if occurence == 
+000060b0: 6c65 6e28 7661 6c75 6573 3129 202d 2031  len(values1) - 1
+000060c0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000060d0: 2020 2020 2020 696e 7465 7270 7265 7461        interpreta
+000060e0: 7469 6f6e 2e61 7070 656e 6428 2870 6169  tion.append((pai
+000060f0: 725b 305d 2c20 7061 6972 5b31 5d2c 2070  r[0], pair[1], p
+00006100: 6169 725b 325d 2c20 636f 6e74 6578 742e  air[2], context.
+00006110: 7469 6d65 7374 616d 7029 290a 2020 2020  timestamp)).    
+00006120: 2020 2020 2020 2020 2020 2020 656c 7365              else
+00006130: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006140: 2020 2020 2020 6c65 6164 203d 206c 656e        lead = len
+00006150: 2876 616c 7565 7331 2920 2d20 6f63 6375  (values1) - occu
+00006160: 7265 6e63 650a 2020 2020 2020 2020 2020  rence.          
+00006170: 2020 2020 2020 2020 2020 636f 756e 7465            counte
+00006180: 7220 3d20 300a 2020 2020 2020 2020 2020  r = 0.          
+00006190: 2020 2020 2020 2020 2020 6c65 6164 636f            leadco
+000061a0: 6e74 6578 7420 3d20 6361 7573 6573 7769  ntext = causeswi
+000061b0: 6e64 6f77 5b2d 6c65 6164 3a5d 0a20 2020  ndow[-lead:].   
+000061c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000061d0: 2066 6f72 2063 6f6e 7465 2069 6e20 6c65   for conte in le
+000061e0: 6164 636f 6e74 6578 743a 0a20 2020 2020  adcontext:.     
+000061f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006200: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
+00006210: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006220: 2020 2020 706f 7320 3d20 6c69 7374 2863      pos = list(c
+00006230: 6f6e 7465 2e43 525b 2623 3334 3b65 6467  onte.CR[&#34;edg
+00006240: 6573 2623 3334 3b5d 292e 696e 6465 7828  es&#34;]).index(
+00006250: 2870 6169 725b 305d 2c20 7061 6972 5b31  (pair[0], pair[1
+00006260: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
+00006270: 2020 2020 2020 2020 2020 2020 6578 6365              exce
+00006280: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
+00006290: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000062a0: 706f 7320 3d20 2d31 0a20 2020 2020 2020  pos = -1.       
+000062b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000062c0: 2069 6620 706f 7320 213d 202d 313a 0a20   if pos != -1:. 
+000062d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000062e0: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+000062f0: 6e74 652e 4352 5b26 2333 343b 6368 6172  nte.CR[&#34;char
+00006300: 6163 7465 7269 7a61 7469 6f6e 2623 3334  acterization&#34
+00006310: 3b5d 5b70 6f73 5d20 3d3d 2070 6169 725b  ;][pos] == pair[
+00006320: 325d 3a0a 2020 2020 2020 2020 2020 2020  2]:.            
+00006330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006340: 2020 2020 636f 756e 7465 7220 2b3d 2031      counter += 1
+00006350: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006360: 2020 2020 2069 6620 636f 756e 7465 7220       if counter 
+00006370: 2667 743b 3d20 302e 3820 2a20 6c65 6164  &gt;= 0.8 * lead
+00006380: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006390: 2020 2020 2020 2020 2020 7465 6d70 7469            tempti
+000063a0: 6d65 7374 616d 7020 3d20 636f 6e74 6578  mestamp = contex
+000063b0: 742e 7469 6d65 7374 616d 700a 2020 2020  t.timestamp.    
+000063c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000063d0: 2020 2020 6c61 7374 636f 6e74 6578 7420      lastcontext 
+000063e0: 3d20 7365 6c66 2e63 6f6e 7465 7874 735b  = self.contexts[
+000063f0: 6d61 7828 6c65 6e28 7365 6c66 2e63 6f6e  max(len(self.con
+00006400: 7465 7874 7329 202d 2032 2c20 3029 5d0a  texts) - 2, 0)].
+00006410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006420: 2020 2020 2020 2020 666f 7220 696e 7465          for inte
+00006430: 7270 6169 7220 696e 206c 6173 7463 6f6e  rpair in lastcon
+00006440: 7465 7874 2e43 525b 2623 3334 3b69 6e74  text.CR[&#34;int
+00006450: 6572 7072 6574 6174 696f 6e26 2333 343b  erpretation&#34;
+00006460: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00006470: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00006480: 6620 696e 7465 7270 6169 725b 305d 203d  f interpair[0] =
+00006490: 3d20 7061 6972 5b30 5d20 616e 6420 696e  = pair[0] and in
+000064a0: 7465 7270 6169 725b 315d 203d 3d20 7061  terpair[1] == pa
+000064b0: 6972 5b31 5d3a 0a20 2020 2020 2020 2020  ir[1]:.         
+000064c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000064d0: 2020 2020 2020 2074 656d 7074 696d 6573         temptimes
+000064e0: 7461 6d70 203d 2069 6e74 6572 7061 6972  tamp = interpair
+000064f0: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+00006500: 2020 2020 2020 2020 2020 2020 696e 7465              inte
+00006510: 7270 7265 7461 7469 6f6e 2e61 7070 656e  rpretation.appen
+00006520: 6428 2870 6169 725b 305d 2c20 7061 6972  d((pair[0], pair
+00006530: 5b31 5d2c 2070 6169 725b 325d 2c20 7465  [1], pair[2], te
+00006540: 6d70 7469 6d65 7374 616d 7029 290a 2020  mptimestamp)).  
+00006550: 2020 2020 2020 2020 2020 2320 666f 7220            # for 
+00006560: 7265 616c 2076 616c 7565 2073 6572 6965  real value serie
+00006570: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
+00006580: 6966 206c 656e 2873 6574 2863 6f6e 7465  if len(set(conte
+00006590: 7874 2e43 445b 7061 6972 5b30 5d5d 2929  xt.CD[pair[0]]))
+000065a0: 2026 6774 3b20 323a 0a20 2020 2020 2020   &gt; 2:.       
+000065b0: 2020 2020 2020 2020 2074 656d 7074 696d           temptim
+000065c0: 6573 7461 6d70 203d 2063 6f6e 7465 7874  estamp = context
+000065d0: 2e74 696d 6573 7461 6d70 0a20 2020 2020  .timestamp.     
+000065e0: 2020 2020 2020 2020 2020 206c 6173 7463             lastc
+000065f0: 6f6e 7465 7874 203d 2073 656c 662e 636f  ontext = self.co
+00006600: 6e74 6578 7473 5b6d 6178 286c 656e 2873  ntexts[max(len(s
+00006610: 656c 662e 636f 6e74 6578 7473 2920 2d20  elf.contexts) - 
+00006620: 322c 2030 295d 0a20 2020 2020 2020 2020  2, 0)].         
+00006630: 2020 2020 2020 2066 6f72 2069 6e74 6572         for inter
+00006640: 7061 6972 2069 6e20 6c61 7374 636f 6e74  pair in lastcont
+00006650: 6578 742e 4352 5b26 2333 343b 696e 7465  ext.CR[&#34;inte
+00006660: 7270 7265 7461 7469 6f6e 2623 3334 3b5d  rpretation&#34;]
+00006670: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00006680: 2020 2020 2020 6966 2069 6e74 6572 7061        if interpa
+00006690: 6972 5b30 5d20 3d3d 2070 6169 725b 305d  ir[0] == pair[0]
+000066a0: 2061 6e64 2069 6e74 6572 7061 6972 5b31   and interpair[1
+000066b0: 5d20 3d3d 2070 6169 725b 315d 3a0a 2020  ] == pair[1]:.  
+000066c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000066d0: 2020 2020 2020 7465 6d70 7469 6d65 7374        temptimest
+000066e0: 616d 7020 3d20 696e 7465 7270 6169 725b  amp = interpair[
+000066f0: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+00006700: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
+00006710: 6e2e 6170 7065 6e64 2828 7061 6972 5b30  n.append((pair[0
+00006720: 5d2c 2070 6169 725b 315d 2c20 7061 6972  ], pair[1], pair
+00006730: 5b32 5d2c 2074 656d 7074 696d 6573 7461  [2], temptimesta
+00006740: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
+00006750: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
+00006760: 2020 2020 2020 2320 736f 7274 2077 6974        # sort wit
+00006770: 6820 7469 6d65 0a20 2020 2020 2020 2066  h time.        f
+00006780: 696e 7465 7270 7265 7420 3d20 5b5d 0a20  interpret = []. 
+00006790: 2020 2020 2020 2066 6f72 2070 6169 7220         for pair 
+000067a0: 696e 2069 6e74 6572 7072 6574 6174 696f  in interpretatio
+000067b0: 6e3a 0a20 2020 2020 2020 2020 2020 2066  n:.            f
+000067c0: 696e 7465 7270 7265 742e 6170 7065 6e64  interpret.append
+000067d0: 2828 7061 6972 5b30 5d2c 2070 6169 725b  ((pair[0], pair[
+000067e0: 315d 2c20 7061 6972 5b32 5d2c 2070 6169  1], pair[2], pai
+000067f0: 725b 335d 2929 0a20 2020 2020 2020 2066  r[3])).        f
+00006800: 696e 7465 7270 7265 742e 736f 7274 286b  interpret.sort(k
+00006810: 6579 3d6c 616d 6264 6120 7475 703a 2074  ey=lambda tup: t
+00006820: 7570 5b33 5d29 2020 2320 736f 7274 7320  up[3])  # sorts 
+00006830: 696e 2070 6c61 6365 0a20 2020 2020 2020  in place.       
+00006840: 2072 6574 7572 6e20 6669 6e74 6572 7072   return finterpr
+00006850: 6574 0a0a 2020 2020 6465 6620 6372 6561  et..    def crea
+00006860: 7465 5f63 6f6e 7465 7874 2873 656c 662c  te_context(self,
+00006870: 2063 7572 7265 6e74 3a20 4576 656e 7470   current: Eventp
+00006880: 6f69 6e74 2c20 6275 6666 6572 293a 0a20  oint, buffer):. 
+00006890: 2020 2020 2020 2026 2333 343b 2623 3334         &#34;&#34
+000068a0: 3b26 2333 343b 0a20 2020 2020 2020 2054  ;&#34;.        T
+000068b0: 7261 6e73 666f 726d 2074 6865 2064 6174  ransform the dat
+000068c0: 6120 636f 6c6c 6563 7465 6420 746f 2074  a collected to t
+000068d0: 6865 2062 7566 6665 7220 696e 2074 6f20  he buffer in to 
+000068e0: 7375 6974 6162 6c65 2066 6f72 6d20 616e  suitable form an
+000068f0: 6420 6765 6e65 7261 7465 7320 7468 6520  d generates the 
+00006900: 4344 2070 6172 7420 6f66 2074 6865 2063  CD part of the c
+00006910: 6f6e 7465 7874 2061 6c6f 6e67 2077 6974  ontext along wit
+00006920: 680a 2020 2020 2020 2020 7468 6520 6564  h.        the ed
+00006930: 6765 7320 616e 6420 6368 6172 6163 7465  ges and characte
+00006940: 7269 7a61 7469 6f6e 733a 0a0a 2020 2020  rizations:..    
+00006950: 2020 2020 2a2a 5374 6570 733a 2a2a 0a0a      **Steps:**..
+00006960: 2020 2020 2020 2020 2a2a 4372 6561 7465          **Create
+00006970: 2043 442a 2a3a 2050 6172 616c 6c65 6c20   CD**: Parallel 
+00006980: 636f 6e74 696e 756f 7573 2072 6570 7265  continuous repre
+00006990: 7365 6e74 6174 696f 6e73 206f 6620 616c  sentations of al
+000069a0: 6c20 6469 6666 6572 656e 7420 736f 7572  l different sour
+000069b0: 6365 7320 696e 2074 6865 2062 7566 6665  ces in the buffe
+000069c0: 722e 0a20 2020 2020 2020 2054 6869 7320  r..        This 
+000069d0: 7374 6570 2069 6e76 6f6c 7665 732c 206d  step involves, m
+000069e0: 6174 6368 696e 6720 7468 6520 6469 6666  atching the diff
+000069f0: 6572 656e 7420 7361 6d70 6c65 2072 6174  erent sample rat
+00006a00: 6573 206f 6620 6469 6666 6572 656e 7420  es of different 
+00006a10: 736f 7572 6365 7320 746f 2074 6861 7420  sources to that 
+00006a20: 6f66 2074 6865 2074 6172 6765 742e 0a20  of the target.. 
+00006a30: 2020 2020 2020 2054 7261 6e73 666f 726d         Transform
+00006a40: 2074 6865 2045 7665 6e74 2073 6f75 7263   the Event sourc
+00006a50: 6573 2074 6f20 636f 6e74 696e 756f 7573  es to continuous
+00006a60: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
+00006a70: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
+00006a80: 2020 2a2a 4361 6c63 756c 6174 6520 4361    **Calculate Ca
+00006a90: 7573 616c 6974 7920 6564 6765 732a 2a3a  usality edges**:
+00006aa0: 2050 6572 666f 726d 2043 6175 7361 6c20   Perform Causal 
+00006ab0: 4469 7363 6f76 6572 7920 7573 696e 6720  Discovery using 
+00006ac0: 7468 6520 6361 7573 616c 6974 7920 6675  the causality fu
+00006ad0: 6e63 7469 6f6e 2c20 746f 2063 7265 6174  nction, to creat
+00006ae0: 6520 6564 6765 7320 0a20 2020 2020 2020  e edges .       
+00006af0: 2028 7061 7274 206f 6620 4352 206f 6620   (part of CR of 
+00006b00: 7468 6520 436f 6e74 6578 7429 0a20 2020  the Context).   
+00006b10: 2020 2020 200a 2020 2020 2020 2020 2a2a       .        **
+00006b20: 5461 6720 6561 6368 2065 6467 6520 7769  Tag each edge wi
+00006b30: 7468 2063 6861 7261 6374 6572 697a 6174  th characterizat
+00006b40: 696f 6e2a 2a3a 2066 6f72 2065 6163 6820  ion**: for each 
+00006b50: 2861 2c62 2920 696e 2074 6865 2065 6467  (a,b) in the edg
+00006b60: 6573 2c20 6120 6368 6172 6163 7465 7269  es, a characteri
+00006b70: 7a61 7469 6f6e 206f 6620 2875 6e6b 6e6f  zation of (unkno
+00006b80: 776e 2c20 6465 6372 6561 7365 2c0a 2020  wn, decrease,.  
+00006b90: 2020 2020 2020 2069 6e63 7265 6173 6529         increase)
+00006ba0: 2c20 6261 7365 6420 6f6e 2074 6865 2074  , based on the t
+00006bb0: 7970 6520 6f66 2074 6865 2061 2e0a 0a20  ype of the a... 
+00006bc0: 2020 2020 2020 2020 2a2a 5061 7261 6d65          **Parame
+00006bd0: 7465 7273 2a2a 3a0a 0a20 2020 2020 2020  ters**:..       
+00006be0: 2020 2a2a 6375 7272 656e 742a 2a3a 2054    **current**: T
+00006bf0: 6865 2063 7572 7265 6e74 2045 7665 6e74  he current Event
+00006c00: 206f 6620 7461 7267 6574 2623 3339 3b73   of target&#39;s
+00006c10: 2064 6174 6120 7768 6963 6820 7472 6967   data which trig
+00006c20: 6572 2074 6865 2063 6f6e 7465 7874 2063  er the context c
+00006c30: 7265 6174 696f 6e0a 0a20 2020 2020 2020  reation..       
+00006c40: 2020 2a2a 6275 6666 6572 2a2a 3a20 6f72    **buffer**: or
+00006c50: 6465 7265 6420 6c69 7374 2077 6974 6820  dered list with 
+00006c60: 4576 656e 7470 6f69 6e74 206f 6620 616c  Eventpoint of al
+00006c70: 6c20 736f 7572 6365 732e 0a0a 2020 2020  l sources...    
+00006c80: 2020 2020 202a 2a72 6574 7572 6e2a 2a3a       **return**:
+00006c90: 2043 6f6e 7465 7874 206f 626a 6563 742e   Context object.
+00006ca0: 0a20 2020 2020 2020 2026 2333 343b 2623  .        &#34;&#
+00006cb0: 3334 3b26 2333 343b 0a20 2020 2020 2020  34;&#34;.       
+00006cc0: 2023 2073 7461 7274 203d 2074 696d 652e   # start = time.
+00006cd0: 7469 6d65 2829 0a20 2020 2020 2020 2023  time().        #
+00006ce0: 2064 6620 7769 7468 202c 6474 2c63 6f64   df with ,dt,cod
+00006cf0: 652c 736f 7572 6365 2c76 616c 7565 0a20  e,source,value. 
+00006d00: 2020 2020 2020 2070 6f73 203d 2073 656c         pos = sel
+00006d10: 662e 636f 6e74 6578 745f 706f 730a 2020  f.context_pos.  
+00006d20: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+00006d30: 616e 6765 2870 6f73 2c20 6c65 6e28 6275  ange(pos, len(bu
+00006d40: 6666 6572 2929 3a0a 2020 2020 2020 2020  ffer)):.        
+00006d50: 2020 2020 6966 2062 7566 6665 725b 695d      if buffer[i]
+00006d60: 2e74 696d 6573 7461 6d70 2026 6c74 3b3d  .timestamp &lt;=
+00006d70: 2028 6375 7272 656e 742e 7469 6d65 7374   (current.timest
+00006d80: 616d 7020 2d20 7064 2e54 696d 6564 656c  amp - pd.Timedel
+00006d90: 7461 2873 656c 662e 686f 7269 7a6f 6e2c  ta(self.horizon,
+00006da0: 2073 656c 662e 686f 7269 7a6f 6e5f 7469   self.horizon_ti
+00006db0: 6d65 2929 3a0a 2020 2020 2020 2020 2020  me)):.          
+00006dc0: 2020 2020 2020 706f 7320 3d20 690a 2020        pos = i.  
+00006dd0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+00006de0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006df0: 6272 6561 6b0a 0a20 2020 2020 2020 2073  break..        s
+00006e00: 656c 662e 636f 6e74 6578 745f 706f 7320  elf.context_pos 
+00006e10: 3d20 706f 730a 2020 2020 2020 2020 2320  = pos.        # 
+00006e20: 656e 643d 7469 6d65 2e74 696d 6528 290a  end=time.time().
+00006e30: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
+00006e40: 6626 2333 343b 6669 6e64 2070 6f73 6974  f&#34;find posit
+00006e50: 696f 6e20 6f6e 2062 7566 6665 723a 207b  ion on buffer: {
+00006e60: 656e 642d 7374 6172 747d 2623 3334 3b29  end-start}&#34;)
+00006e70: 0a0a 2020 2020 2020 2020 2320 7374 6172  ..        # star
+00006e80: 7420 3d20 7469 6d65 2e74 696d 6528 290a  t = time.time().
+00006e90: 2020 2020 2020 2020 6461 7461 666f 7263          dataforc
+00006ea0: 6f6e 7465 7874 203d 2062 7566 6665 725b  ontext = buffer[
+00006eb0: 706f 733a 5d0a 2020 2020 2020 2020 6461  pos:].        da
+00006ec0: 7461 746f 6466 203d 205b 5b70 642e 746f  tatodf = [[pd.to
+00006ed0: 5f64 6174 6574 696d 6528 652e 7469 6d65  _datetime(e.time
+00006ee0: 7374 616d 7029 2066 6f72 2065 2069 6e20  stamp) for e in 
+00006ef0: 6461 7461 666f 7263 6f6e 7465 7874 5d2c  dataforcontext],
+00006f00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006f10: 2020 2020 205b 7374 7228 652e 636f 6465       [str(e.code
+00006f20: 2920 666f 7220 6520 696e 2064 6174 6166  ) for e in dataf
+00006f30: 6f72 636f 6e74 6578 745d 2c0a 2020 2020  orcontext],.    
+00006f40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006f50: 5b73 7472 2865 2e73 6f75 7263 6529 2066  [str(e.source) f
+00006f60: 6f72 2065 2069 6e20 6461 7461 666f 7263  or e in dataforc
+00006f70: 6f6e 7465 7874 5d2c 0a20 2020 2020 2020  ontext],.       
+00006f80: 2020 2020 2020 2020 2020 2020 205b 652e               [e.
+00006f90: 6465 7461 696c 7320 666f 7220 6520 696e  details for e in
+00006fa0: 2064 6174 6166 6f72 636f 6e74 6578 745d   dataforcontext]
+00006fb0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00006fc0: 2020 2020 2020 5b65 2e74 7970 6520 666f        [e.type fo
+00006fd0: 7220 6520 696e 2064 6174 6166 6f72 636f  r e in dataforco
+00006fe0: 6e74 6578 745d 5d0a 0a20 2020 2020 2020  ntext]]..       
+00006ff0: 206e 7063 6f6e 7465 7874 203d 206e 702e   npcontext = np.
+00007000: 6172 7261 7928 6461 7461 746f 6466 290a  array(datatodf).
+00007010: 2020 2020 2020 2020 6e70 636f 6e74 6578          npcontex
+00007020: 7420 3d20 6e70 636f 6e74 6578 742e 540a  t = npcontext.T.
+00007030: 0a20 2020 2020 2020 206e 7063 6f6e 7465  .        npconte
+00007040: 7874 203d 2073 656c 662e 4e75 6d70 795f  xt = self.Numpy_
+00007050: 7072 6570 726f 6363 6573 7328 6e70 636f  preproccess(npco
+00007060: 6e74 6578 7429 0a0a 2020 2020 2020 2020  ntext)..        
+00007070: 2320 656e 6420 3d20 7469 6d65 2e74 696d  # end = time.tim
+00007080: 6528 290a 2020 2020 2020 2020 2320 7072  e().        # pr
+00007090: 696e 7428 6626 2333 343b 7072 6570 726f  int(f&#34;prepro
+000070a0: 6365 7373 2064 663a 207b 656e 6420 2d20  cess df: {end - 
+000070b0: 7374 6172 747d 2623 3334 3b29 0a20 2020  start}&#34;).   
+000070c0: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
+000070d0: 2323 2063 7265 6174 6520 636f 6e74 6578  ## create contex
+000070e0: 7420 2323 2323 2323 2323 2323 2323 2323  t ##############
+000070f0: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
+00007100: 2020 2020 2020 2023 2073 7461 7274 203d         # start =
+00007110: 2074 696d 652e 7469 6d65 2829 0a20 2020   time.time().   
+00007120: 2020 2020 2023 2320 636f 6c6c 6563 7420       ## collect 
+00007130: 756e 6971 6575 2064 6174 6120 7365 7269  uniqeu data seri
+00007140: 6573 0a20 2020 2020 2020 2023 2061 6c6c  es.        # all
+00007150: 636f 6465 7320 3d20 6466 5b26 2333 393b  codes = df[&#39;
+00007160: 636f 6465 2623 3339 3b5d 2e75 6e69 7175  code&#39;].uniqu
+00007170: 6528 290a 2020 2020 2020 2020 616c 6c63  e().        allc
+00007180: 6f64 6573 203d 206e 702e 756e 6971 7565  odes = np.unique
+00007190: 286e 7063 6f6e 7465 7874 5b3a 2c20 315d  (npcontext[:, 1]
+000071a0: 290a 2020 2020 2020 2020 616c 6c63 6f64  ).        allcod
+000071b0: 6573 203d 205b 636f 6465 2066 6f72 2063  es = [code for c
+000071c0: 6f64 6520 696e 2061 6c6c 636f 6465 735d  ode in allcodes]
+000071d0: 0a20 2020 2020 2020 2061 6c6c 636f 6465  .        allcode
+000071e0: 7320 3d20 7365 7428 616c 6c63 6f64 6573  s = set(allcodes
+000071f0: 290a 0a20 2020 2020 2020 2066 6f72 2075  )..        for u
+00007200: 6e63 6f64 6520 696e 2061 6c6c 636f 6465  ncode in allcode
+00007210: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
+00007220: 6f72 2071 7120 696e 2072 616e 6765 286c  or qq in range(l
+00007230: 656e 286e 7063 6f6e 7465 7874 2929 3a0a  en(npcontext)):.
+00007240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007250: 6966 2075 6e63 6f64 6520 696e 206e 7063  if uncode in npc
+00007260: 6f6e 7465 7874 5b71 715d 5b31 5d3a 0a20  ontext[qq][1]:. 
+00007270: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007280: 2020 2073 656c 662e 7479 7065 5f6f 665f     self.type_of_
+00007290: 7365 7269 6573 5b75 6e63 6f64 655d 203d  series[uncode] =
+000072a0: 206e 7063 6f6e 7465 7874 5b71 715d 5b34   npcontext[qq][4
+000072b0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+000072c0: 2020 2020 2020 6272 6561 6b0a 0a20 2020        break..   
+000072d0: 2020 2020 2023 2320 6275 696c 6420 7461       ## build ta
+000072e0: 7267 6574 2073 6572 6965 730a 2020 2020  rget series.    
+000072f0: 2020 2020 7461 7267 6574 5f73 6572 6965      target_serie
+00007300: 735f 6e61 6d65 2c20 7461 7267 6574 5f73  s_name, target_s
+00007310: 6572 6965 7320 3d20 7365 6c66 2e62 7569  eries = self.bui
+00007320: 6c64 5f74 6172 6765 745f 7365 7269 6573  ld_target_series
+00007330: 5f66 6f72 5f63 6f6e 7465 7874 2863 7572  _for_context(cur
+00007340: 7265 6e74 2c20 6e70 636f 6e74 6578 7429  rent, npcontext)
+00007350: 0a0a 2020 2020 2020 2020 2323 2063 7265  ..        ## cre
+00007360: 6174 6520 7365 7269 6573 2066 6f72 2065  ate series for e
+00007370: 6163 6820 736f 7572 6365 2028 616c 6c64  ach source (alld
+00007380: 6174 6129 0a20 2020 2020 2020 2061 6c6c  ata).        all
+00007390: 6461 7461 203d 2073 656c 662e 6372 6561  data = self.crea
+000073a0: 7465 5f63 6f6e 7469 6e75 6f75 735f 7265  te_continuous_re
+000073b0: 7072 6573 656e 7461 7469 6f6e 2874 6172  presentation(tar
+000073c0: 6765 745f 7365 7269 6573 5f6e 616d 652c  get_series_name,
+000073d0: 2074 6172 6765 745f 7365 7269 6573 2c20   target_series, 
+000073e0: 6e70 636f 6e74 6578 742c 0a20 2020 2020  npcontext,.     
+000073f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007400: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007410: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007420: 2020 2073 656c 662e 7479 7065 5f6f 665f     self.type_of_
+00007430: 7365 7269 6573 2c20 616c 6c63 6f64 6573  series, allcodes
+00007440: 290a 2020 2020 2020 2020 2320 656e 6420  ).        # end 
+00007450: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
+00007460: 2020 2020 2020 2320 7072 696e 7428 6626        # print(f&
+00007470: 2333 343b 4372 6561 7465 2073 6572 6965  #34;Create serie
+00007480: 733a 207b 656e 642d 7374 6172 747d 2623  s: {end-start}&#
+00007490: 3334 3b29 0a0a 2020 2020 2020 2020 7374  34;)..        st
+000074a0: 6f72 696e 6720 3d20 7365 6c66 2e63 616c  oring = self.cal
+000074b0: 6375 6c61 7465 5f65 6467 6573 2861 6c6c  culate_edges(all
+000074c0: 6461 7461 2c20 6375 7272 656e 742e 7469  data, current.ti
+000074d0: 6d65 7374 616d 7029 0a20 2020 2020 2020  mestamp).       
+000074e0: 2073 746f 7269 6e67 5b26 2333 343b 6368   storing[&#34;ch
+000074f0: 6172 6163 7465 7269 7a61 7469 6f6e 2623  aracterization&#
+00007500: 3334 3b5d 203d 2073 656c 662e 6765 745f  34;] = self.get_
+00007510: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+00007520: 2873 746f 7269 6e67 290a 0a20 2020 2020  (storing)..     
+00007530: 2020 2023 2070 7269 6e74 2866 2623 3334     # print(f&#34
+00007540: 3b43 616c 6375 6c61 7465 2065 6467 6573  ;Calculate edges
+00007550: 3a20 7b65 6e64 202d 2073 7461 7274 7d26  : {end - start}&
+00007560: 2333 343b 290a 2020 2020 2020 2020 2320  #34;).        # 
+00007570: 7072 696e 7428 2623 3334 3b3d 3d3d 3d3d  print(&#34;=====
+00007580: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+00007590: 3d3d 3d26 2333 343b 290a 0a20 2020 2020  ===&#34;)..     
+000075a0: 2020 2063 6f6e 7465 7874 7062 6a65 6374     contextpbject
+000075b0: 203d 2043 6f6e 7465 7874 2e63 6f6e 7465   = Context.conte
+000075c0: 7874 5f66 726f 6d5f 6469 6374 2873 746f  xt_from_dict(sto
+000075d0: 7269 6e67 290a 2020 2020 2020 2020 7265  ring).        re
+000075e0: 7475 726e 2063 6f6e 7465 7874 7062 6a65  turn contextpbje
+000075f0: 6374 2c20 7461 7267 6574 5f73 6572 6965  ct, target_serie
+00007600: 735f 6e61 6d65 0a0a 2020 2020 6465 6620  s_name..    def 
+00007610: 6765 745f 6368 6172 6163 7465 7269 7a61  get_characteriza
+00007620: 7469 6f6e 2873 656c 662c 2063 6f6e 7465  tion(self, conte
+00007630: 7874 293a 0a20 2020 2020 2020 2026 2333  xt):.        &#3
+00007640: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
+00007650: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00007660: 2063 616c 6375 6c61 7465 2074 6865 2063   calculate the c
+00007670: 6861 7261 6374 6572 697a 6174 696f 6e73  haracterizations
+00007680: 206f 6620 2861 2c62 2920 6564 6765 7320   of (a,b) edges 
+00007690: 746f 2063 6861 7261 6374 6572 697a 6520  to characterize 
+000076a0: 7468 6520 696e 666c 7565 6e63 6520 6f66  the influence of
+000076b0: 2061 2069 6e20 6220 6279 206f 6e65 206f   a in b by one o
+000076c0: 6620 7468 650a 2020 2020 2020 2020 7468  f the.        th
+000076d0: 7265 6520 6368 6172 6163 7465 7269 7a61  ree characteriza
+000076e0: 7469 6f6e 733a 2075 6e6b 6e6f 776e 2c20  tions: unknown, 
+000076f0: 6465 6372 6561 7365 2c20 696e 6372 6561  decrease, increa
+00007700: 7365 2e0a 0a20 2020 2020 2020 2054 6865  se...        The
+00007710: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
+00007720: 6e20 6973 2063 616c 6375 6c61 7465 6420  n is calculated 
+00007730: 6469 6666 6572 656e 746c 7920 666f 7220  differently for 
+00007740: 6576 656e 7420 616e 6420 636f 6e74 696e  event and contin
+00007750: 756f 7573 2064 6174 612e 0a20 2020 2020  uous data..     
+00007760: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
+00007770: 2a3a 0a0a 2020 2020 2020 2020 2a2a 636f  *:..        **co
+00007780: 6e74 6578 742a 2a3a 2064 6963 7469 6f6e  ntext**: diction
+00007790: 6172 7920 7769 7468 2061 206b 7965 2026  ary with a kye &
+000077a0: 2333 393b 6564 6765 7326 2333 393b 2066  #39;edges&#39; f
+000077b0: 6f72 2077 6869 6368 2061 2070 6172 616c  or which a paral
+000077c0: 6c65 6c20 6c69 7374 206f 6620 6368 6172  lel list of char
+000077d0: 6163 7465 7269 7a61 7469 6f6e 7320 7769  acterizations wi
+000077e0: 6c6c 2062 6520 6372 6561 7465 642e 0a20  ll be created.. 
+000077f0: 2020 2020 2020 2026 2333 343b 2623 3334         &#34;&#34
+00007800: 3b26 2333 343b 0a20 2020 2020 2020 2065  ;&#34;.        e
+00007810: 6467 6573 203d 2063 6f6e 7465 7874 5b26  dges = context[&
+00007820: 2333 343b 6564 6765 7326 2333 343b 5d0a  #34;edges&#34;].
+00007830: 2020 2020 2020 2020 6368 6172 6163 7465          characte
+00007840: 7269 7a61 7469 6f6e 7320 3d20 5b5d 0a20  rizations = []. 
+00007850: 2020 2020 2020 2066 6f72 2065 6467 6520         for edge 
+00007860: 696e 2065 6467 6573 3a0a 2020 2020 2020  in edges:.      
+00007870: 2020 2020 2020 6966 2073 656c 662e 7461        if self.ta
+00007880: 7267 6574 2069 6e20 6564 6765 5b30 5d3a  rget in edge[0]:
+00007890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000078a0: 2063 6861 7220 3d20 7365 6c66 2e63 6861   char = self.cha
+000078b0: 7261 6374 6572 697a 655f 6576 656e 745f  racterize_event_
+000078c0: 636f 6e74 696e 756f 7573 2863 6f6e 7465  continuous(conte
+000078d0: 7874 2c20 6564 6765 290a 2020 2020 2020  xt, edge).      
+000078e0: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
+000078f0: 7479 7065 5f6f 665f 7365 7269 6573 5b65  type_of_series[e
+00007900: 6467 655b 305d 5d20 3d3d 2026 2333 343b  dge[0]] == &#34;
+00007910: 6973 6f6c 6174 696f 6e26 2333 343b 206f  isolation&#34; o
+00007920: 7220 7365 6c66 2e74 7970 655f 6f66 5f73  r self.type_of_s
+00007930: 6572 6965 735b 6564 6765 5b30 5d5d 203d  eries[edge[0]] =
+00007940: 3d20 2623 3334 3b63 6f6e 6669 6775 7261  = &#34;configura
+00007950: 7469 6f6e 2623 3334 3b3a 0a20 2020 2020  tion&#34;:.     
+00007960: 2020 2020 2020 2020 2020 2063 6861 7220             char 
+00007970: 3d20 7365 6c66 2e63 6861 7261 6374 6572  = self.character
+00007980: 697a 655f 6576 656e 745f 6564 6765 2863  ize_event_edge(c
+00007990: 6f6e 7465 7874 2c20 6564 6765 290a 2020  ontext, edge).  
+000079a0: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
+000079b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000079c0: 6368 6172 203d 2073 656c 662e 6368 6172  char = self.char
+000079d0: 6163 7465 7269 7a65 5f65 7665 6e74 5f63  acterize_event_c
+000079e0: 6f6e 7469 6e75 6f75 7328 636f 6e74 6578  ontinuous(contex
+000079f0: 742c 2065 6467 6529 0a20 2020 2020 2020  t, edge).       
+00007a00: 2020 2020 2063 6861 7261 6374 6572 697a       characteriz
+00007a10: 6174 696f 6e73 2e61 7070 656e 6428 6368  ations.append(ch
+00007a20: 6172 290a 2020 2020 2020 2020 7265 7475  ar).        retu
+00007a30: 726e 2063 6861 7261 6374 6572 697a 6174  rn characterizat
+00007a40: 696f 6e73 0a0a 2020 2020 6465 6620 6368  ions..    def ch
+00007a50: 6172 6163 7465 7269 7a65 5f65 7665 6e74  aracterize_event
+00007a60: 5f65 6467 6528 7365 6c66 2c20 636f 6e74  _edge(self, cont
+00007a70: 6578 742c 2065 6467 6529 3a0a 2020 2020  ext, edge):.    
+00007a80: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
+00007a90: 3334 3b0a 2020 2020 2020 2020 5468 6973  34;.        This
+00007aa0: 206d 6574 686f 6420 6368 6172 6163 7465   method characte
+00007ab0: 7269 7a65 7320 7468 6520 6564 6765 2028  rizes the edge (
+00007ac0: 612c 6229 2077 6865 6e20 6120 6973 2069  a,b) when a is i
+00007ad0: 736f 6c61 7465 6420 6f72 2063 6f6e 6669  solated or confi
+00007ae0: 6775 7261 7469 6f6e 2065 7665 6e74 2e0a  guration event..
+00007af0: 2020 2020 2020 2020 546f 2064 6f20 7468          To do th
+00007b00: 6973 2c20 6974 2064 6574 6563 7473 2074  is, it detects t
+00007b10: 6865 206c 6173 7420 6f63 6375 7272 656e  he last occurren
+00007b20: 6365 206f 6620 6120 616e 6420 7370 6c69  ce of a and spli
+00007b30: 7420 7468 6520 6461 7461 206f 6620 7365  t the data of se
+00007b40: 7269 6573 2061 2061 6e64 2073 6572 6965  ries a and serie
+00007b50: 7320 6220 6261 7365 6420 6f6e 2074 6861  s b based on tha
+00007b60: 742e 0a20 2020 2020 2020 2054 6865 6e20  t..        Then 
+00007b70: 6368 6563 6b73 2069 6620 7468 6520 6d65  checks if the me
+00007b80: 6469 616e 206f 6620 6220 6166 7465 7220  dian of b after 
+00007b90: 7468 6520 6f63 6375 7272 656e 6365 2069  the occurrence i
+00007ba0: 7320 6174 206c 6172 6765 7220 7468 616e  s at larger than
+00007bb0: 2074 6865 206d 6564 6961 6e20 6220 6265   the median b be
+00007bc0: 666f 7265 0a20 2020 2020 2020 2070 6c75  fore.        plu
+00007bd0: 7320 7477 6f20 7469 6d65 7320 7468 6520  s two times the 
+00007be0: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+00007bf0: 6f6e 206f 6620 6220 7365 7269 6573 2062  on of b series b
+00007c00: 6566 6f72 6520 7468 6520 6f63 6375 7272  efore the occurr
+00007c10: 656e 6365 2e0a 2020 2020 2020 2020 4966  ence..        If
+00007c20: 2074 6861 7420 6973 2074 7275 6520 7468   that is true th
+00007c30: 656e 2069 7320 6368 6172 6163 7465 7269  en is characteri
+00007c40: 7a65 6420 6173 2069 6e63 7265 6173 652e  zed as increase.
+00007c50: 2045 6c73 6520 6974 2069 7320 6368 6563   Else it is chec
+00007c60: 6b65 6420 666f 7220 7468 6520 6f70 706f  ked for the oppo
+00007c70: 7369 7465 2c20 2869 6620 6974 2069 7320  site, (if it is 
+00007c80: 736d 616c 6c65 720a 2020 2020 2020 2020  smaller.        
+00007c90: 666f 7220 6174 206c 6561 7374 2032 2074  for at least 2 t
+00007ca0: 696d 6573 2074 6865 2073 7461 6e64 6172  imes the standar
+00007cb0: 6420 6465 7669 6174 696f 6e20 6f66 2062  d deviation of b
+00007cc0: 2920 616e 6420 6368 6172 6163 7465 7269  ) and characteri
+00007cd0: 7a65 6420 6173 2064 6563 7265 6173 652e  zed as decrease.
+00007ce0: 204f 7468 6572 7769 7365 2c20 6973 2063   Otherwise, is c
+00007cf0: 6861 7261 6374 6572 697a 6564 2061 730a  haracterized as.
+00007d00: 2020 2020 2020 2020 2075 6e6b 6e6f 776e           unknown
+00007d10: 2e0a 0a20 2020 2020 2020 202a 2a50 6172  ...        **Par
+00007d20: 616d 6574 6572 732a 2a3a 0a0a 2020 2020  ameters**:..    
+00007d30: 2020 2020 2a2a 636f 6e74 6578 742a 2a3a      **context**:
+00007d40: 2074 6861 7420 7468 6520 6564 6765 2074   that the edge t
+00007d50: 6f20 6265 2063 6861 7261 6374 6572 697a  o be characteriz
+00007d60: 6564 2062 656c 6f6e 6773 2e0a 0a20 2020  ed belongs...   
+00007d70: 2020 2020 202a 2a65 6467 652a 2a3a 2041       **edge**: A
+00007d80: 2074 7570 6c65 2028 612c 6229 2077 6865   tuple (a,b) whe
+00007d90: 7265 2061 2069 7320 6973 6f6c 6174 6564  re a is isolated
+00007da0: 206f 7220 636f 6e66 6967 7572 6174 696f   or configuratio
+00007db0: 6e20 6576 656e 742e 0a0a 2020 2020 2020  n event...      
+00007dc0: 2020 2a2a 7265 7475 726e 2a2a 3a20 4120    **return**: A 
+00007dd0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+00007de0: 2066 6f72 2074 6865 2065 6467 6520 2875   for the edge (u
+00007df0: 6e6b 6e6f 776e 2c20 6465 6372 6561 7365  nknown, decrease
+00007e00: 206f 7220 696e 6372 6561 7365 290a 2020   or increase).  
+00007e10: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
+00007e20: 2623 3334 3b0a 2020 2020 2020 2020 6e61  &#34;.        na
+00007e30: 6d65 3120 3d20 6564 6765 5b30 5d0a 2020  me1 = edge[0].  
+00007e40: 2020 2020 2020 6e61 6d65 3220 3d20 6564        name2 = ed
+00007e50: 6765 5b31 5d0a 2020 2020 2020 2020 7661  ge[1].        va
+00007e60: 6c75 6573 3120 3d20 636f 6e74 6578 745b  lues1 = context[
+00007e70: 6e61 6d65 315d 0a20 2020 2020 2020 2076  name1].        v
+00007e80: 616c 7565 7332 203d 205b 666c 6f61 7428  alues2 = [float(
+00007e90: 6b61 7469 2920 666f 7220 6b61 7469 2069  kati) for kati i
+00007ea0: 6e20 636f 6e74 6578 745b 6e61 6d65 325d  n context[name2]
+00007eb0: 5d0a 0a20 2020 2020 2020 206f 6363 7572  ]..        occur
+00007ec0: 656e 6365 203d 206c 656e 2876 616c 7565  ence = len(value
+00007ed0: 7331 2920 2d20 310a 2020 2020 2020 2020  s1) - 1.        
+00007ee0: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00007ef0: 656e 2876 616c 7565 7331 2920 2d20 322c  en(values1) - 2,
+00007f00: 2030 2c20 2d31 293a 0a20 2020 2020 2020   0, -1):.       
+00007f10: 2020 2020 2069 6620 7661 6c75 6573 315b       if values1[
+00007f20: 695d 2021 3d20 7661 6c75 6573 315b 2d31  i] != values1[-1
+00007f30: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00007f40: 2020 206f 6363 7572 656e 6365 203d 2069     occurence = i
+00007f50: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
+00007f60: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
+00007f70: 2020 2070 7265 7669 7573 6f63 6375 7265     previusoccure
+00007f80: 6e63 6520 3d20 300a 2020 2020 2020 2020  nce = 0.        
+00007f90: 666f 7220 6920 696e 2072 616e 6765 286f  for i in range(o
+00007fa0: 6363 7572 656e 6365 202d 2032 2c20 302c  ccurence - 2, 0,
+00007fb0: 202d 3129 3a0a 2020 2020 2020 2020 2020   -1):.          
+00007fc0: 2020 6966 2076 616c 7565 7331 5b69 5d20    if values1[i] 
+00007fd0: 213d 2076 616c 7565 7331 5b6f 6363 7572  != values1[occur
+00007fe0: 656e 6365 202d 2031 5d3a 0a20 2020 2020  ence - 1]:.     
+00007ff0: 2020 2020 2020 2020 2020 2070 7265 7669             previ
+00008000: 7573 6f63 6375 7265 6e63 6520 3d20 690a  usoccurence = i.
+00008010: 0a20 2020 2020 2020 2069 6620 6f63 6375  .        if occu
+00008020: 7265 6e63 6520 2d20 7072 6576 6975 736f  rence - previuso
+00008030: 6363 7572 656e 6365 2026 6c74 3b20 323a  ccurence &lt; 2:
+00008040: 2020 2320 6f72 206c 656e 2876 616c 7565    # or len(value
+00008050: 7332 292d 6f63 6375 7265 6e63 6526 6c74  s2)-occurence&lt
+00008060: 3b32 3a0a 2020 2020 2020 2020 2020 2020  ;2:.            
+00008070: 7265 7475 726e 2026 2333 343b 756e 6b6e  return &#34;unkn
+00008080: 6f77 6e26 2333 343b 0a20 2020 2020 2020  own&#34;.       
+00008090: 2076 616c 7565 7332 6265 666f 7265 203d   values2before =
+000080a0: 2076 616c 7565 7332 5b70 7265 7669 7573   values2[previus
+000080b0: 6f63 6375 7265 6e63 653a 6f63 6375 7265  occurence:occure
+000080c0: 6e63 655d 0a20 2020 2020 2020 2023 2073  nce].        # s
+000080d0: 7464 7620 3d20 7374 6174 6973 7469 6373  tdv = statistics
+000080e0: 2e73 7464 6576 2876 616c 7565 7332 6265  .stdev(values2be
+000080f0: 666f 7265 290a 2020 2020 2020 2020 2320  fore).        # 
+00008100: 6d65 616e 203d 2073 7461 7469 7374 6963  mean = statistic
+00008110: 732e 7374 6465 7628 7661 6c75 6573 3262  s.stdev(values2b
+00008120: 6566 6f72 6529 0a20 2020 2020 2020 2023  efore).        #
+00008130: 2076 616c 7565 7332 6265 666f 7265 3d5b   values2before=[
+00008140: 7620 6966 2076 266c 743b 6d65 616e 2b35  v if v&lt;mean+5
+00008150: 2a73 7464 7620 656c 7365 206d 6561 6e20  *stdv else mean 
+00008160: 666f 7220 7620 696e 2076 616c 7565 7332  for v in values2
+00008170: 6265 666f 7265 5d0a 0a20 2020 2020 2020  before]..       
+00008180: 2023 2076 616c 7565 7332 6166 7465 723d   # values2after=
+00008190: 7661 6c75 6573 325b 6f63 6375 7265 6e63  values2[occurenc
+000081a0: 653a 5d0a 2020 2020 2020 2020 7661 6c75  e:].        valu
+000081b0: 6573 3261 6674 6572 203d 205b 7661 6c75  es2after = [valu
+000081c0: 6573 325b 2d31 5d5d 0a20 2020 2020 2020  es2[-1]].       
+000081d0: 2023 2073 7464 7620 3d20 7374 6174 6973   # stdv = statis
+000081e0: 7469 6373 2e73 7464 6576 2876 616c 7565  tics.stdev(value
+000081f0: 7332 6166 7465 7229 0a20 2020 2020 2020  s2after).       
+00008200: 2023 206d 6561 6e20 3d20 7374 6174 6973   # mean = statis
+00008210: 7469 6373 2e73 7464 6576 2876 616c 7565  tics.stdev(value
+00008220: 7332 6166 7465 7229 0a20 2020 2020 2020  s2after).       
+00008230: 2023 2076 616c 7565 7332 6166 7465 7220   # values2after 
+00008240: 3d20 5b76 2069 6620 7620 266c 743b 206d  = [v if v &lt; m
+00008250: 6561 6e20 2b20 3320 2a20 7374 6476 2065  ean + 3 * stdv e
+00008260: 6c73 6520 6d65 616e 2066 6f72 2076 2069  lse mean for v i
+00008270: 6e20 7661 6c75 6573 3261 6674 6572 5d0a  n values2after].
+00008280: 0a20 2020 2020 2020 2073 7464 7620 3d20  .        stdv = 
+00008290: 7374 6174 6973 7469 6373 2e73 7464 6576  statistics.stdev
+000082a0: 2876 616c 7565 7332 6265 666f 7265 290a  (values2before).
+000082b0: 2020 2020 2020 2020 6966 206c 656e 2876          if len(v
+000082c0: 616c 7565 7332 6265 666f 7265 2920 3d3d  alues2before) ==
+000082d0: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+000082e0: 6368 6172 203d 2026 2333 343b 756e 6b6e  char = &#34;unkn
+000082f0: 6f77 6e26 2333 343b 0a20 2020 2020 2020  own&#34;.       
+00008300: 2065 6c69 6620 7374 6174 6973 7469 6373   elif statistics
+00008310: 2e6d 6564 6961 6e28 7661 6c75 6573 3262  .median(values2b
+00008320: 6566 6f72 6529 202d 2073 7461 7469 7374  efore) - statist
+00008330: 6963 732e 6d65 6469 616e 2876 616c 7565  ics.median(value
+00008340: 7332 6166 7465 7229 2026 6774 3b20 3220  s2after) &gt; 2 
+00008350: 2a20 7374 6476 3a0a 2020 2020 2020 2020  * stdv:.        
+00008360: 2020 2020 6368 6172 203d 2026 2333 343b      char = &#34;
+00008370: 6465 6372 6561 7365 2623 3334 3b0a 2020  decrease&#34;.  
+00008380: 2020 2020 2020 656c 6966 2073 7461 7469        elif stati
+00008390: 7374 6963 732e 6d65 6469 616e 2876 616c  stics.median(val
+000083a0: 7565 7332 6166 7465 7229 202d 2073 7461  ues2after) - sta
+000083b0: 7469 7374 6963 732e 6d65 6469 616e 2876  tistics.median(v
+000083c0: 616c 7565 7332 6265 666f 7265 2920 2667  alues2before) &g
+000083d0: 743b 2032 202a 2073 7464 763a 0a20 2020  t; 2 * stdv:.   
+000083e0: 2020 2020 2020 2020 2063 6861 7220 3d20           char = 
+000083f0: 2623 3334 3b69 6e63 7265 6173 6526 2333  &#34;increase&#3
+00008400: 343b 0a20 2020 2020 2020 2065 6c73 653a  4;.        else:
+00008410: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
+00008420: 7220 3d20 2623 3334 3b75 6e6b 6e6f 776e  r = &#34;unknown
+00008430: 2623 3334 3b0a 2020 2020 2020 2020 7265  &#34;.        re
+00008440: 7475 726e 2063 6861 720a 0a20 2020 2064  turn char..    d
+00008450: 6566 2063 6861 7261 6374 6572 697a 655f  ef characterize_
+00008460: 6576 656e 745f 636f 6e74 696e 756f 7573  event_continuous
+00008470: 2873 656c 662c 2063 6f6e 7465 7874 2c20  (self, context, 
+00008480: 6564 6765 293a 0a20 2020 2020 2020 2026  edge):.        &
+00008490: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
+000084a0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
+000084b0: 6d65 7468 6f64 2063 6861 7261 6374 6572  method character
+000084c0: 697a 6573 2074 6865 2065 6467 6520 2861  izes the edge (a
+000084d0: 2c62 2920 7768 656e 2061 2069 7320 636f  ,b) when a is co
+000084e0: 6e74 696e 756f 7573 2e0a 2020 2020 2020  ntinuous..      
+000084f0: 2020 2020 2020 546f 2064 6f20 7468 6973        To do this
+00008500: 2c20 7468 6520 6465 6c74 6120 6265 7477  , the delta betw
+00008510: 6565 6e20 7468 6520 7469 6d65 7374 616d  een the timestam
+00008520: 7073 206f 6620 7468 6520 7365 7269 6573  ps of the series
+00008530: 2062 2069 7320 6361 6c63 756c 6174 6564   b is calculated
+00008540: 0a20 2020 2020 2020 2020 2020 2028 692e  .            (i.
+00008550: 652e 2074 6865 2064 6966 6665 7265 6e63  e. the differenc
+00008560: 6520 6265 7477 6565 6e20 6375 7272 656e  e between curren
+00008570: 7420 616e 6420 6e65 7874 2074 696d 6573  t and next times
+00008580: 7461 6d70 7329 2e20 4966 2074 6865 2073  tamps). If the s
+00008590: 756d 6d20 6f66 2074 6865 2064 656c 7461  umm of the delta
+000085a0: 7320 6265 7477 6565 6e20 6220 7365 7269  s between b seri
+000085b0: 6573 2064 6174 612c 2069 730a 2020 2020  es data, is.    
+000085c0: 2020 2020 2020 2020 6772 6561 7465 7220          greater 
+000085d0: 7468 616e 2032 2074 696d 6573 2074 6865  than 2 times the
+000085e0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+000085f0: 696f 6e20 6f66 2074 6865 2062 2c20 7468  ion of the b, th
+00008600: 656e 2074 6865 2069 6e63 7265 6173 6520  en the increase 
+00008610: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+00008620: 2069 7320 7265 7475 726e 6564 2e20 4966   is returned. If
+00008630: 2074 6865 2073 756d 0a20 2020 2020 2020   the sum.       
+00008640: 2020 2020 2069 7320 6c6f 7765 7220 7468       is lower th
+00008650: 616e 2032 2074 696d 6573 2074 6865 2073  an 2 times the s
+00008660: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+00008670: 6e20 7468 6520 6465 6372 6561 7365 6420  n the decreased 
+00008680: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+00008690: 2069 7320 7265 7475 726e 6564 2e20 4f74   is returned. Ot
+000086a0: 6865 7277 6973 652c 2074 6865 2075 6e6b  herwise, the unk
+000086b0: 6e6f 776e 0a20 2020 2020 2020 2020 2020  nown.           
+000086c0: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
+000086d0: 6e20 6973 2072 6574 7572 6e65 642e 0a0a  n is returned...
+000086e0: 2020 2020 2020 2020 2020 2020 2a2a 5061              **Pa
+000086f0: 7261 6d65 7465 7273 2a2a 3a0a 0a20 2020  rameters**:..   
+00008700: 2020 2020 2020 2020 202a 2a63 6f6e 7465           **conte
+00008710: 7874 2a2a 3a20 7468 6174 2074 6865 2065  xt**: that the e
+00008720: 6467 6520 746f 2062 6520 6368 6172 6163  dge to be charac
+00008730: 7465 7269 7a65 6420 6265 6c6f 6e67 732e  terized belongs.
+00008740: 0a0a 2020 2020 2020 2020 2020 2020 2a2a  ..            **
+00008750: 6564 6765 2a2a 3a20 4120 7475 706c 6520  edge**: A tuple 
+00008760: 2861 2c62 2920 7768 6572 6520 6120 6973  (a,b) where a is
+00008770: 2069 736f 6c61 7465 6420 6f72 2063 6f6e   isolated or con
+00008780: 6669 6775 7261 7469 6f6e 2065 7665 6e74  figuration event
+00008790: 2e0a 0a20 2020 2020 2020 2020 2020 202a  ...            *
+000087a0: 2a72 6574 7572 6e2a 2a3a 2041 2063 6861  *return**: A cha
+000087b0: 7261 6374 6572 697a 6174 696f 6e20 666f  racterization fo
+000087c0: 7220 7468 6520 6564 6765 2028 756e 6b6e  r the edge (unkn
+000087d0: 6f77 6e2c 2064 6563 7265 6173 6520 6f72  own, decrease or
+000087e0: 2069 6e63 7265 6173 6529 0a20 2020 2020   increase).     
+000087f0: 2020 2026 2333 343b 2623 3334 3b26 2333     &#34;&#34;&#3
+00008800: 343b 0a20 2020 2020 2020 206e 616d 6531  4;.        name1
+00008810: 203d 2065 6467 655b 305d 0a20 2020 2020   = edge[0].     
+00008820: 2020 206e 616d 6532 203d 2065 6467 655b     name2 = edge[
+00008830: 315d 0a20 2020 2020 2020 2076 616c 7565  1].        value
+00008840: 7331 203d 205b 666c 6f61 7428 6b61 7469  s1 = [float(kati
+00008850: 2920 666f 7220 6b61 7469 2069 6e20 636f  ) for kati in co
+00008860: 6e74 6578 745b 6e61 6d65 315d 5d0a 2020  ntext[name1]].  
+00008870: 2020 2020 2020 7661 6c75 6573 3220 3d20        values2 = 
+00008880: 5b66 6c6f 6174 286b 6174 6929 2066 6f72  [float(kati) for
+00008890: 206b 6174 6920 696e 2063 6f6e 7465 7874   kati in context
+000088a0: 5b6e 616d 6532 5d5d 0a0a 2020 2020 2020  [name2]]..      
+000088b0: 2020 7072 6576 203d 2076 616c 7565 7332    prev = values2
+000088c0: 5b30 5d0a 2020 2020 2020 2020 6469 6666  [0].        diff
+000088d0: 203d 2030 0a20 2020 2020 2020 2066 6f72   = 0.        for
+000088e0: 2076 2069 6e20 7661 6c75 6573 325b 313a   v in values2[1:
+000088f0: 5d3a 0a20 2020 2020 2020 2020 2020 2064  ]:.            d
+00008900: 6966 6620 2b3d 2028 7620 2d20 7072 6576  iff += (v - prev
+00008910: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
+00008920: 6e28 7661 6c75 6573 3229 203d 3d20 303a  n(values2) == 0:
+00008930: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
+00008940: 7220 3d20 2623 3334 3b75 6e6b 6e6f 776e  r = &#34;unknown
+00008950: 2623 3334 3b0a 2020 2020 2020 2020 7374  &#34;.        st
+00008960: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
+00008970: 7374 6465 7628 7661 6c75 6573 3229 0a20  stdev(values2). 
+00008980: 2020 2020 2020 2069 6620 6469 6666 2026         if diff &
+00008990: 6774 3b20 3220 2a20 7374 6476 3a0a 2020  gt; 2 * stdv:.  
+000089a0: 2020 2020 2020 2020 2020 6368 6172 203d            char =
+000089b0: 2026 2333 343b 696e 6372 6561 7365 2623   &#34;increase&#
+000089c0: 3334 3b0a 2020 2020 2020 2020 656c 6966  34;.        elif
+000089d0: 2064 6966 6620 266c 743b 202d 3220 2a20   diff &lt; -2 * 
+000089e0: 7374 6476 3a0a 2020 2020 2020 2020 2020  stdv:.          
+000089f0: 2020 6368 6172 203d 2026 2333 343b 6465    char = &#34;de
+00008a00: 6372 6561 7365 2623 3334 3b0a 2020 2020  crease&#34;.    
+00008a10: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
+00008a20: 2020 2020 2020 6368 6172 203d 2026 2333        char = &#3
+00008a30: 343b 756e 6b6e 6f77 6e26 2333 343b 0a20  4;unknown&#34;. 
+00008a40: 2020 2020 2020 2072 6574 7572 6e20 6368         return ch
+00008a50: 6172 0a0a 2020 2020 6465 6620 6361 6c63  ar..    def calc
+00008a60: 756c 6174 655f 6564 6765 7328 7365 6c66  ulate_edges(self
+00008a70: 2c20 616c 6c64 6174 612c 2074 696d 6573  , alldata, times
+00008a80: 7461 6d70 293a 0a20 2020 2020 2020 2026  tamp):.        &
+00008a90: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
+00008aa0: 2020 2020 2020 2046 6f72 6d75 6c61 7465         Formulate
+00008ab0: 2074 6865 2064 6174 6120 696e 2061 7070   the data in app
+00008ac0: 726f 7072 6961 7465 2066 6f72 6d20 746f  ropriate form to
+00008ad0: 2063 616c 6c20 7365 6c66 2e63 616c 6375   call self.calcu
+00008ae0: 6c61 7465 5f63 6175 7361 6c69 7479 0a20  late_causality. 
+00008af0: 2020 2020 2020 2077 6869 6368 2072 6574         which ret
+00008b00: 7572 6e20 7468 6520 6564 6765 7320 666f  urn the edges fo
+00008b10: 7220 7468 6520 636f 6e74 6578 742e 0a0a  r the context...
+00008b20: 2020 2020 2020 2020 2a2a 5061 7261 6d65          **Parame
+00008b30: 7465 7273 2a2a 3a0a 0a20 2020 2020 2020  ters**:..       
+00008b40: 202a 2a61 6c6c 6461 7461 2a2a 3a20 6120   **alldata**: a 
+00008b50: 3244 206e 756d 7079 2061 7272 6179 2077  2D numpy array w
+00008b60: 6974 6820 616c 6c20 7365 7269 6573 2064  ith all series d
+00008b70: 6174 6120 2865 7175 6976 616c 656e 7420  ata (equivalent 
+00008b80: 746f 2074 6865 2043 4420 6f66 2074 6865  to the CD of the
+00008b90: 2043 6f6e 7465 7874 290a 0a20 2020 2020   Context)..     
+00008ba0: 2020 202a 2a74 696d 6573 7461 6d70 2a2a     **timestamp**
+00008bb0: 3a20 7469 6d65 7374 616d 7020 6f66 2074  : timestamp of t
+00008bc0: 6865 2063 6f6e 7465 7874 2066 726f 6d20  he context from 
+00008bd0: 7768 6963 6820 7468 6520 6564 6765 7320  which the edges 
+00008be0: 6172 6520 6361 6c63 756c 6174 6564 2e0a  are calculated..
+00008bf0: 0a20 2020 2020 2020 202a 2a72 6574 7572  .        **retur
+00008c00: 6e2a 2a3a 2061 2064 6963 7469 6f6e 6172  n**: a dictionar
+00008c10: 7920 7769 7468 2026 2333 393b 6564 6765  y with &#39;edge
+00008c20: 7326 2333 393b 206b 6579 2028 636f 6e74  s&#39; key (cont
+00008c30: 6169 6e69 6e67 2074 6865 2063 616c 6375  aining the calcu
+00008c40: 6c61 7465 6420 6564 6765 7320 6166 7465  lated edges afte
+00008c50: 7220 4361 7573 616c 6974 7920 6469 7363  r Causality disc
+00008c60: 6f76 6572 7929 2e0a 2020 2020 2020 2020  overy)..        
+00008c70: 2623 3334 3b26 2333 343b 2623 3334 3b0a  &#34;&#34;&#34;.
+00008c80: 2020 2020 2020 2020 2320 7374 6172 7420          # start 
+00008c90: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
+00008ca0: 2020 2020 2020 7374 6f72 696e 6720 3d20        storing = 
+00008cb0: 7b7d 0a20 2020 2020 2020 2073 746f 7269  {}.        stori
+00008cc0: 6e67 5b26 2333 343b 7469 6d65 7374 616d  ng[&#34;timestam
+00008cd0: 7026 2333 343b 5d20 3d20 7469 6d65 7374  p&#34;] = timest
+00008ce0: 616d 700a 0a20 2020 2020 2020 2061 6c6c  amp..        all
+00008cf0: 6461 7461 5f6e 616d 6573 203d 205b 6e6e  data_names = [nn
+00008d00: 5b30 5d20 666f 7220 6e6e 2069 6e20 616c  [0] for nn in al
+00008d10: 6c64 6174 615d 0a20 2020 2020 2020 2061  ldata].        a
+00008d20: 6c6c 6461 7461 5f64 6174 6120 3d20 5b6e  lldata_data = [n
+00008d30: 6e5b 315d 2066 6f72 206e 6e20 696e 2061  n[1] for nn in a
+00008d40: 6c6c 6461 7461 5d0a 0a20 2020 2020 2020  lldata]..       
+00008d50: 2066 6f72 206e 616d 6564 642c 2064 6174   for namedd, dat
+00008d60: 6164 6420 696e 207a 6970 2861 6c6c 6461  add in zip(allda
+00008d70: 7461 5f6e 616d 6573 2c20 616c 6c64 6174  ta_names, alldat
+00008d80: 615f 6461 7461 293a 0a20 2020 2020 2020  a_data):.       
+00008d90: 2020 2020 2073 746f 7269 6e67 5b6e 616d       storing[nam
+00008da0: 6564 645d 203d 2064 6174 6164 640a 0a20  edd] = datadd.. 
+00008db0: 2020 2020 2020 2023 2046 6f72 2063 6f6e         # For con
+00008dc0: 7465 7874 2077 6974 6820 6d6f 7265 2074  text with more t
+00008dd0: 6861 6e20 7477 6f20 7365 7269 6573 2063  han two series c
+00008de0: 616c 6375 6c61 7465 2050 4320 6361 7375  alculate PC casu
+00008df0: 616c 6974 6965 730a 2020 2020 2020 2020  alities.        
+00008e00: 636f 756e 7420 3d20 6c65 6e28 5b31 2066  count = len([1 f
+00008e10: 6f72 206c 6973 7461 2069 6e20 616c 6c64  or lista in alld
+00008e20: 6174 615f 6461 7461 2069 6620 6c69 7374  ata_data if list
+00008e30: 6120 6973 206e 6f74 204e 6f6e 655d 290a  a is not None]).
+00008e40: 2020 2020 2020 2020 6966 2063 6f75 6e74          if count
+00008e50: 2026 6774 3b20 3120 616e 6420 6c65 6e28   &gt; 1 and len(
+00008e60: 616c 6c64 6174 615b 305d 5b31 5d29 2026  alldata[0][1]) &
+00008e70: 6774 3b20 353a 0a20 2020 2020 2020 2020  gt; 5:.         
+00008e80: 2020 2061 6c6c 6461 7461 5f6e 616d 6573     alldata_names
+00008e90: 203d 205b 6e6e 5b30 5d20 666f 7220 6e6e   = [nn[0] for nn
+00008ea0: 2069 6e20 616c 6c64 6174 6120 6966 206e   in alldata if n
+00008eb0: 6e5b 315d 2069 7320 6e6f 7420 4e6f 6e65  n[1] is not None
+00008ec0: 2061 6e64 206c 656e 2873 6574 286e 6e5b   and len(set(nn[
+00008ed0: 315d 2929 2026 6774 3b20 315d 0a20 2020  1])) &gt; 1].   
+00008ee0: 2020 2020 2020 2020 2061 6c6c 6461 7461           alldata
+00008ef0: 5f64 6174 6120 3d20 5b6e 6e5b 315d 2066  _data = [nn[1] f
+00008f00: 6f72 206e 6e20 696e 2061 6c6c 6461 7461  or nn in alldata
+00008f10: 2069 6620 6e6e 5b31 5d20 6973 206e 6f74   if nn[1] is not
+00008f20: 204e 6f6e 6520 616e 6420 6c65 6e28 7365   None and len(se
+00008f30: 7428 6e6e 5b31 5d29 2920 2667 743b 2031  t(nn[1])) &gt; 1
+00008f40: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
+00008f50: 2065 6e64 203d 2074 696d 652e 7469 6d65   end = time.time
+00008f60: 2829 0a20 2020 2020 2020 2020 2020 2023  ().            #
+00008f70: 2070 7269 6e74 2866 2623 3334 3b62 6566   print(f&#34;bef
+00008f80: 6f72 6520 7b65 6e64 202d 2073 7461 7274  ore {end - start
+00008f90: 7d26 2333 343b 290a 2020 2020 2020 2020  }&#34;).        
+00008fa0: 2020 2020 2320 7374 6172 743d 7469 6d65      # start=time
+00008fb0: 2e74 696d 6528 290a 0a20 2020 2020 2020  .time()..       
+00008fc0: 2020 2020 2065 6467 6573 203d 2073 656c       edges = sel
+00008fd0: 662e 6361 6c63 756c 6174 655f 6361 7573  f.calculate_caus
+00008fe0: 616c 6974 7928 6e70 2e63 6f6c 756d 6e5f  ality(np.column_
+00008ff0: 7374 6163 6b28 616c 6c64 6174 615f 6461  stack(alldata_da
+00009000: 7461 292c 2061 6c6c 6461 7461 5f6e 616d  ta), alldata_nam
+00009010: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
+00009020: 2320 656e 643d 7469 6d65 2e74 696d 6528  # end=time.time(
+00009030: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00009040: 7072 696e 7428 6626 2333 343b 6163 7475  print(f&#34;actu
+00009050: 616c 2065 6467 6520 6361 6c63 756c 6174  al edge calculat
+00009060: 696f 6e20 7b65 6e64 2d73 7461 7274 7d26  ion {end-start}&
+00009070: 2333 343b 290a 2020 2020 2020 2020 2020  #34;).          
+00009080: 2020 6966 2065 6467 6573 2069 7320 4e6f    if edges is No
+00009090: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000090a0: 2020 2020 7369 6e67 6c65 6564 6765 7320      singleedges 
+000090b0: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
+000090c0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+000090d0: 2020 2020 2020 2073 696e 676c 6565 6467         singleedg
+000090e0: 6573 203d 2065 6467 6573 0a20 2020 2020  es = edges.     
+000090f0: 2020 2020 2020 2023 2070 7269 6e74 2865         # print(e
+00009100: 6467 6573 290a 2020 2020 2020 2020 2020  dges).          
+00009110: 2020 7374 6f72 696e 675b 2623 3334 3b65    storing[&#34;e
+00009120: 6467 6573 2623 3334 3b5d 203d 2073 696e  dges&#34;] = sin
+00009130: 676c 6565 6467 6573 0a20 2020 2020 2020  gleedges.       
+00009140: 2020 2020 2072 6574 7572 6e20 7374 6f72       return stor
+00009150: 696e 670a 2020 2020 2020 2020 7374 6f72  ing.        stor
+00009160: 696e 675b 2623 3334 3b65 6467 6573 2623  ing[&#34;edges&#
+00009170: 3334 3b5d 203d 205b 5d0a 2020 2020 2020  34;] = [].      
+00009180: 2020 7265 7475 726e 2073 746f 7269 6e67    return storing
+00009190: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
+000091a0: 5f63 6f6e 7469 6e75 6f75 735f 7265 7072  _continuous_repr
+000091b0: 6573 656e 7461 7469 6f6e 2873 656c 662c  esentation(self,
+000091c0: 2074 6172 6765 745f 7365 7269 6573 5f6e   target_series_n
+000091d0: 616d 652c 2074 6172 6765 745f 7365 7269  ame, target_seri
+000091e0: 6573 2c20 6466 2c20 7479 7065 5f6f 665f  es, df, type_of_
+000091f0: 7365 7269 6573 2c20 616c 6c63 6f64 6573  series, allcodes
+00009200: 293a 0a20 2020 2020 2020 2023 2069 6620  ):.        # if 
+00009210: 6c65 6e28 7461 7267 6574 5f73 6572 6965  len(target_serie
+00009220: 7329 2026 6c74 3b20 353a 0a20 2020 2020  s) &lt; 5:.     
+00009230: 2020 2023 2020 2020 2061 6c6c 6461 7461     #     alldata
+00009240: 203d 205b 5d0a 2020 2020 2020 2020 2320   = [].        # 
+00009250: 2020 2020 7061 6464 696e 673d 5b30 2066      padding=[0 f
+00009260: 6f72 2071 2069 6e20 7261 6e67 6528 352d  or q in range(5-
+00009270: 6c65 6e28 7461 7267 6574 5f73 6572 6965  len(target_serie
+00009280: 7329 295d 0a20 2020 2020 2020 2023 2020  s))].        #  
+00009290: 2020 2070 6164 6469 6e67 2e65 7874 656e     padding.exten
+000092a0: 6428 5b74 6167 735b 305d 2066 6f72 2074  d([tags[0] for t
+000092b0: 6167 7320 696e 2074 6172 6765 745f 7365  ags in target_se
+000092c0: 7269 6573 5d29 0a20 2020 2020 2020 2023  ries]).        #
+000092d0: 2020 2020 2061 6c6c 6461 7461 2e61 7070       alldata.app
+000092e0: 656e 6428 2874 6172 6765 745f 7365 7269  end((target_seri
+000092f0: 6573 5f6e 616d 652c 2070 6164 6469 6e67  es_name, padding
+00009300: 2929 0a20 2020 2020 2020 2023 2020 2020  )).        #    
+00009310: 2072 6574 7572 6e20 616c 6c64 6174 610a   return alldata.
+00009320: 2020 2020 2020 2020 7769 6e64 6f77 7661          windowva
+00009330: 6c75 6573 203d 2064 6620 2023 202e 7661  lues = df  # .va
+00009340: 6c75 6573 0a20 2020 2020 2020 2061 6c6c  lues.        all
+00009350: 6461 7461 203d 205b 5d0a 2020 2020 2020  data = [].      
+00009360: 2020 616c 6c64 6174 612e 6170 7065 6e64    alldata.append
+00009370: 2828 7461 7267 6574 5f73 6572 6965 735f  ((target_series_
+00009380: 6e61 6d65 2c20 5b74 6167 5b30 5d20 666f  name, [tag[0] fo
+00009390: 7220 7461 6720 696e 2074 6172 6765 745f  r tag in target_
+000093a0: 7365 7269 6573 5d29 290a 2020 2020 2020  series])).      
+000093b0: 2020 666f 7220 6e61 6d65 2069 6e20 616c    for name in al
+000093c0: 6c63 6f64 6573 3a0a 2020 2020 2020 2020  lcodes:.        
+000093d0: 2020 2020 2320 616c 7265 6164 7920 6361      # already ca
+000093e0: 6c63 756c 6174 6564 2069 6e20 7461 7267  lculated in targ
+000093f0: 6574 7365 7269 6573 2e0a 2020 2020 2020  etseries..      
+00009400: 2020 2020 2020 6966 2074 6172 6765 745f        if target_
+00009410: 7365 7269 6573 5f6e 616d 6520 696e 206e  series_name in n
+00009420: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
+00009430: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
+00009440: 2020 2020 2020 2020 2020 2023 2064 6574             # det
+00009450: 6563 7420 7468 6520 6f63 6375 7261 6e63  ect the occuranc
+00009460: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
+00009470: 6f63 6375 7265 6e63 6965 7320 3d20 5b28  occurencies = [(
+00009480: 7661 6c75 652c 2074 696d 6529 2066 6f72  value, time) for
+00009490: 2063 6f64 652c 2076 616c 7565 2c20 7469   code, value, ti
+000094a0: 6d65 2069 6e0a 2020 2020 2020 2020 2020  me in.          
+000094b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000094c0: 207a 6970 2877 696e 646f 7776 616c 7565   zip(windowvalue
+000094d0: 735b 3a2c 2031 5d2c 2077 696e 646f 7776  s[:, 1], windowv
+000094e0: 616c 7565 735b 3a2c 2033 5d2c 2077 696e  alues[:, 3], win
+000094f0: 646f 7776 616c 7565 735b 3a2c 2030 5d29  dowvalues[:, 0])
+00009500: 2069 6620 6e61 6d65 2069 6e20 636f 6465   if name in code
+00009510: 5d0a 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+00009520: 6563 746f 7220 3d20 5b30 2066 6f72 2069  ector = [0 for i
+00009530: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
+00009540: 7267 6574 5f73 6572 6965 7329 295d 0a20  rget_series))]. 
+00009550: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
+00009560: 6e28 6f63 6375 7265 6e63 6965 7329 203d  n(occurencies) =
+00009570: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
+00009580: 2020 2020 2076 6563 746f 7220 3d20 5b30       vector = [0
+00009590: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+000095a0: 6c65 6e28 7461 7267 6574 5f73 6572 6965  len(target_serie
+000095b0: 7329 295d 0a20 2020 2020 2020 2020 2020  s))].           
+000095c0: 2065 6c69 6620 6f63 6375 7265 6e63 6965   elif occurencie
+000095d0: 735b 305d 5b30 5d20 6973 206e 6f74 204e  s[0][0] is not N
+000095e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000095f0: 2020 2020 2076 6563 746f 7220 3d20 7365       vector = se
+00009600: 6c66 2e62 7569 6c64 5f63 6f6e 7465 7874  lf.build_context
+00009610: 5f66 6f72 5f75 6e69 7661 7269 6174 6528  _for_univariate(
+00009620: 7461 7267 6574 5f73 6572 6965 732c 206f  target_series, o
+00009630: 6363 7572 656e 6369 6573 290a 2020 2020  ccurencies).    
+00009640: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
+00009650: 655f 6f66 5f73 6572 6965 735b 6e61 6d65  e_of_series[name
+00009660: 5d20 3d3d 2026 2333 343b 6973 6f6c 6174  ] == &#34;isolat
+00009670: 6564 2623 3334 3b3a 0a20 2020 2020 2020  ed&#34;:.       
+00009680: 2020 2020 2020 2020 2076 6563 746f 7220           vector 
+00009690: 3d20 7365 6c66 2e62 7569 6c64 5f63 6f6e  = self.build_con
+000096a0: 7465 7874 5f66 6f72 5f69 736f 6c61 7465  text_for_isolate
+000096b0: 6428 7461 7267 6574 5f73 6572 6965 732c  d(target_series,
+000096c0: 206f 6363 7572 656e 6369 6573 290a 2020   occurencies).  
+000096d0: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
+000096e0: 7970 655f 6f66 5f73 6572 6965 735b 6e61  ype_of_series[na
+000096f0: 6d65 5d20 3d3d 2026 2333 343b 636f 6e66  me] == &#34;conf
+00009700: 6967 7572 6174 696f 6e26 2333 343b 3a0a  iguration&#34;:.
+00009710: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009720: 7665 6374 6f72 203d 2073 656c 662e 6275  vector = self.bu
+00009730: 696c 645f 636f 6e74 6578 745f 666f 725f  ild_context_for_
+00009740: 636f 6e66 6975 6775 7261 7469 6f6e 2874  confiuguration(t
+00009750: 6172 6765 745f 7365 7269 6573 2c20 6f63  arget_series, oc
+00009760: 6375 7265 6e63 6965 7329 0a0a 2020 2020  curencies)..    
+00009770: 2020 2020 2020 2020 6f6b 203d 2026 2333          ok = &#3
+00009780: 343b 6f6b 2623 3334 3b0a 2020 2020 2020  4;ok&#34;.      
+00009790: 2020 2020 2020 2320 6966 2076 6563 746f        # if vecto
+000097a0: 7220 6973 2073 7461 7469 6f6e 6172 7920  r is stationary 
+000097b0: 7468 656e 206e 6f20 636f 6e74 6578 742e  then no context.
+000097c0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000097d0: 6d61 7828 7665 6374 6f72 2920 3d3d 2030  max(vector) == 0
+000097e0: 2061 6e64 206d 696e 2876 6563 746f 7229   and min(vector)
+000097f0: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
+00009800: 2020 2020 2020 2076 6563 746f 7220 3d20         vector = 
+00009810: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00009820: 2061 6c6c 6461 7461 2e61 7070 656e 6428   alldata.append(
+00009830: 286e 616d 652c 2076 6563 746f 7229 290a  (name, vector)).
+00009840: 2020 2020 2020 2020 7265 7475 726e 2061          return a
+00009850: 6c6c 6461 7461 0a0a 2020 2020 6465 6620  lldata..    def 
+00009860: 6275 696c 645f 7461 7267 6574 5f73 6572  build_target_ser
+00009870: 6965 735f 666f 725f 636f 6e74 6578 7428  ies_for_context(
+00009880: 7365 6c66 2c20 6375 7272 656e 743a 2045  self, current: E
+00009890: 7665 6e74 706f 696e 742c 2064 663a 206e  ventpoint, df: n
+000098a0: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
+000098b0: 2020 2020 7461 7267 6574 5f73 6572 6965      target_serie
+000098c0: 735f 6e61 6d65 203d 2063 7572 7265 6e74  s_name = current
+000098d0: 2e63 6f64 650a 2020 2020 2020 2020 7769  .code.        wi
+000098e0: 6e64 6f77 7661 6c75 6573 203d 2064 6620  ndowvalues = df 
+000098f0: 2023 202e 7661 6c75 6573 0a20 2020 2020   # .values.     
+00009900: 2020 2074 6172 6765 745f 7365 7269 6573     target_series
+00009910: 203d 205b 2876 616c 7565 2c20 7469 6d65   = [(value, time
+00009920: 2920 666f 7220 636f 6465 2c20 7661 6c75  ) for code, valu
+00009930: 652c 2074 696d 6520 696e 0a20 2020 2020  e, time in.     
+00009940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009950: 2020 2020 7a69 7028 7769 6e64 6f77 7661      zip(windowva
+00009960: 6c75 6573 5b3a 2c20 315d 2c20 7769 6e64  lues[:, 1], wind
+00009970: 6f77 7661 6c75 6573 5b3a 2c20 335d 2c20  owvalues[:, 3], 
+00009980: 7769 6e64 6f77 7661 6c75 6573 5b3a 2c20  windowvalues[:, 
+00009990: 305d 2920 6966 2074 6172 6765 745f 7365  0]) if target_se
+000099a0: 7269 6573 5f6e 616d 6520 696e 2063 6f64  ries_name in cod
+000099b0: 655d 0a0a 2020 2020 2020 2020 7265 7475  e]..        retu
+000099c0: 726e 2074 6172 6765 745f 7365 7269 6573  rn target_series
+000099d0: 5f6e 616d 652c 2074 6172 6765 745f 7365  _name, target_se
+000099e0: 7269 6573 0a0a 2020 2020 6465 6620 4e75  ries..    def Nu
+000099f0: 6d70 795f 7072 6570 726f 6363 6573 7328  mpy_preproccess(
+00009a00: 7365 6c66 2c20 6e70 636f 6e74 6578 7429  self, npcontext)
+00009a10: 3a0a 2020 2020 2020 2020 6e70 636f 6e74  :.        npcont
+00009a20: 6578 7420 3d20 6e70 2e77 6865 7265 286e  ext = np.where(n
+00009a30: 7063 6f6e 7465 7874 203d 3d20 2623 3334  pcontext == &#34
+00009a40: 3b6e 616e 2623 3334 3b2c 204e 6f6e 652c  ;nan&#34;, None,
+00009a50: 206e 7063 6f6e 7465 7874 290a 0a20 2020   npcontext)..   
+00009a60: 2020 2020 206d 6173 6b20 3d20 5b28 2623       mask = [(&#
+00009a70: 3339 3b30 5f26 2333 393b 2069 6e20 636f  39;0_&#39; in co
+00009a80: 6465 2061 6e64 2076 616c 7565 2069 7320  de and value is 
+00009a90: 4e6f 6e65 2920 666f 7220 636f 6465 2c20  None) for code, 
+00009aa0: 7661 6c75 6520 696e 207a 6970 286e 7063  value in zip(npc
+00009ab0: 6f6e 7465 7874 5b3a 2c20 315d 2c20 6e70  ontext[:, 1], np
+00009ac0: 636f 6e74 6578 745b 3a2c 2033 5d29 5d0a  context[:, 3])].
+00009ad0: 0a20 2020 2020 2020 2023 2069 6620 6973  .        # if is
+00009ae0: 696e 7374 616e 6365 286d 6173 6b2c 636f  instance(mask,co
+00009af0: 6c6c 6563 7469 6f6e 732e 6162 632e 5365  llections.abc.Se
+00009b00: 7175 656e 6365 293d 3d46 616c 7365 3a0a  quence)==False:.
+00009b10: 2020 2020 2020 2020 2320 2020 2020 6d61          #     ma
+00009b20: 736b 3d5b 6d61 736b 5d0a 2020 2020 2020  sk=[mask].      
+00009b30: 2020 6e70 636f 6e74 6578 745b 6d61 736b    npcontext[mask
+00009b40: 2c20 335d 203d 2030 0a20 2020 2020 2020  , 3] = 0.       
+00009b50: 206d 6173 6b20 3d20 5b28 2623 3339 3b31   mask = [(&#39;1
+00009b60: 5f26 2333 393b 2069 6e20 636f 6465 2061  _&#39; in code a
+00009b70: 6e64 2076 616c 7565 2069 7320 4e6f 6e65  nd value is None
+00009b80: 2920 666f 7220 636f 6465 2c20 7661 6c75  ) for code, valu
+00009b90: 6520 696e 207a 6970 286e 7063 6f6e 7465  e in zip(npconte
+00009ba0: 7874 5b3a 2c20 315d 2c20 6e70 636f 6e74  xt[:, 1], npcont
+00009bb0: 6578 745b 3a2c 2033 5d29 5d0a 2020 2020  ext[:, 3])].    
+00009bc0: 2020 2020 6e70 636f 6e74 6578 745b 6d61      npcontext[ma
+00009bd0: 736b 2c20 335d 203d 2031 0a20 2020 2020  sk, 3] = 1.     
+00009be0: 2020 2063 6f64 655f 7769 7468 5f73 6f75     code_with_sou
+00009bf0: 7263 6520 3d20 5b66 2623 3334 3b7b 636f  rce = [f&#34;{co
+00009c00: 6465 7d7b 736f 7572 6365 7d26 2333 343b  de}{source}&#34;
+00009c10: 2069 6620 736f 7572 6365 5b30 5d20 3d3d   if source[0] ==
+00009c20: 2026 2333 343b 4026 2333 343b 2065 6c73   &#34;@&#34; els
+00009c30: 6520 6626 2333 343b 7b63 6f64 657d 407b  e f&#34;{code}@{
+00009c40: 736f 7572 6365 7d26 2333 343b 2066 6f72  source}&#34; for
+00009c50: 2063 6f64 652c 2073 6f75 7263 6520 696e   code, source in
+00009c60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009c70: 2020 2020 2020 2020 2020 2020 207a 6970               zip
+00009c80: 286e 7063 6f6e 7465 7874 5b3a 2c20 315d  (npcontext[:, 1]
+00009c90: 2c20 6e70 636f 6e74 6578 745b 3a2c 2032  , npcontext[:, 2
+00009ca0: 5d29 5d0a 2020 2020 2020 2020 6e70 636f  ])].        npco
+00009cb0: 6e74 6578 745b 3a2c 2031 5d20 3d20 636f  ntext[:, 1] = co
+00009cc0: 6465 5f77 6974 685f 736f 7572 6365 0a0a  de_with_source..
+00009cd0: 2020 2020 2020 2020 7265 7475 726e 206e          return n
+00009ce0: 7063 6f6e 7465 7874 0a0a 2020 2020 6465  pcontext..    de
+00009cf0: 6620 6275 696c 645f 636f 6e74 6578 745f  f build_context_
+00009d00: 666f 725f 636f 6e66 6975 6775 7261 7469  for_confiugurati
+00009d10: 6f6e 2873 656c 662c 2074 6172 6765 745f  on(self, target_
+00009d20: 7365 7269 6573 2c20 6f63 6375 7265 6e63  series, occurenc
+00009d30: 6965 7329 3a0a 2020 2020 2020 2020 7665  ies):.        ve
+00009d40: 6374 6f72 203d 205b 3020 666f 7220 6920  ctor = [0 for i 
+00009d50: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
+00009d60: 6765 745f 7365 7269 6573 2929 5d0a 2020  get_series))].  
+00009d70: 2020 2020 2020 666f 7220 6f63 6320 696e        for occ in
+00009d80: 206f 6363 7572 656e 6369 6573 3a0a 2020   occurencies:.  
+00009d90: 2020 2020 2020 2020 2020 666f 7220 7120            for q 
+00009da0: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
+00009db0: 6765 745f 7365 7269 6573 2929 3a0a 2020  get_series)):.  
+00009dc0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00009dd0: 2074 6172 6765 745f 7365 7269 6573 5b71   target_series[q
+00009de0: 5d5b 315d 2026 6774 3b3d 206f 6363 5b31  ][1] &gt;= occ[1
+00009df0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00009e00: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
+00009e10: 7261 6e67 6528 712c 206c 656e 2876 6563  range(q, len(vec
+00009e20: 746f 7229 293a 0a20 2020 2020 2020 2020  tor)):.         
+00009e30: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00009e40: 6563 746f 725b 6b5d 202b 3d20 310a 2020  ector[k] += 1.  
+00009e50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009e60: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+00009e70: 2323 206e 6f74 2073 7461 626c 650a 2020  ## not stable.  
+00009e80: 2020 2020 2020 6966 206c 656e 2873 6574        if len(set
+00009e90: 2876 6563 746f 7229 2920 3d3d 2031 3a0a  (vector)) == 1:.
+00009ea0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
+00009eb0: 6f72 5b30 5d20 3d20 300a 2020 2020 2020  or[0] = 0.      
+00009ec0: 2020 7265 7475 726e 2076 6563 746f 720a    return vector.
+00009ed0: 0a20 2020 2064 6566 2062 7569 6c64 5f63  .    def build_c
+00009ee0: 6f6e 7465 7874 5f66 6f72 5f69 736f 6c61  ontext_for_isola
+00009ef0: 7465 6428 7365 6c66 2c20 7461 7267 6574  ted(self, target
+00009f00: 5f73 6572 6965 732c 206f 6363 7572 656e  _series, occuren
+00009f10: 6369 6573 293a 0a20 2020 2020 2020 2076  cies):.        v
+00009f20: 6563 746f 7220 3d20 5b30 2066 6f72 2069  ector = [0 for i
+00009f30: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
+00009f40: 7267 6574 5f73 6572 6965 7329 295d 0a20  rget_series))]. 
+00009f50: 2020 2020 2020 2066 6f72 206f 6363 2069         for occ i
+00009f60: 6e20 6f63 6375 7265 6e63 6965 733a 0a20  n occurencies:. 
+00009f70: 2020 2020 2020 2020 2020 2066 6f72 2071             for q
+00009f80: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
+00009f90: 7267 6574 5f73 6572 6965 7329 293a 0a20  rget_series)):. 
+00009fa0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00009fb0: 6620 7461 7267 6574 5f73 6572 6965 735b  f target_series[
+00009fc0: 715d 5b31 5d20 2667 743b 206f 6363 5b31  q][1] &gt; occ[1
+00009fd0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+00009fe0: 2020 2020 2020 2076 6563 746f 725b 715d         vector[q]
+00009ff0: 203d 2031 0a20 2020 2020 2020 2020 2020   = 1.           
+0000a000: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
+0000a010: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
+0000a020: 6374 6f72 0a0a 2020 2020 6465 6620 6275  ctor..    def bu
+0000a030: 696c 645f 636f 6e74 6578 745f 666f 725f  ild_context_for_
+0000a040: 756e 6976 6172 6961 7465 2873 656c 662c  univariate(self,
+0000a050: 2074 6172 6765 745f 7365 7269 6573 2c20   target_series, 
+0000a060: 6f63 6375 7265 6e63 6965 7329 3a0a 2020  occurencies):.  
+0000a070: 2020 2020 2020 616c 6c76 616c 7565 7320        allvalues 
+0000a080: 3d20 5b5d 0a20 2020 2020 2020 2076 6563  = [].        vec
+0000a090: 746f 7220 3d20 5b30 2066 6f72 2069 2069  tor = [0 for i i
+0000a0a0: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
+0000a0b0: 6574 5f73 6572 6965 7329 295d 0a20 2020  et_series))].   
+0000a0c0: 2020 2020 2070 6f73 203d 2030 0a20 2020       pos = 0.   
+0000a0d0: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+0000a0e0: 6e67 6528 6c65 6e28 7461 7267 6574 5f73  nge(len(target_s
+0000a0f0: 6572 6965 7329 293a 0a20 2020 2020 2020  eries)):.       
+0000a100: 2020 2020 2074 696d 6573 7461 6d70 203d       timestamp =
+0000a110: 2074 6172 6765 745f 7365 7269 6573 5b69   target_series[i
+0000a120: 5d5b 315d 0a20 2020 2020 2020 2020 2020  ][1].           
+0000a130: 2063 7572 7265 6e74 5f70 6f73 203d 2070   current_pos = p
+0000a140: 6f73 0a20 2020 2020 2020 2020 2020 2066  os.            f
+0000a150: 6f72 2071 2069 6e20 7261 6e67 6528 706f  or q in range(po
+0000a160: 732c 206c 656e 286f 6363 7572 656e 6369  s, len(occurenci
+0000a170: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
+0000a180: 2020 2020 2020 6966 206f 6363 7572 656e        if occuren
+0000a190: 6369 6573 5b71 5d5b 315d 2026 6774 3b20  cies[q][1] &gt; 
+0000a1a0: 7469 6d65 7374 616d 703a 0a20 2020 2020  timestamp:.     
+0000a1b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000a1c0: 7572 7265 6e74 5f70 6f73 203d 2071 0a20  urrent_pos = q. 
+0000a1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a1e0: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+0000a1f0: 2020 2020 2023 206e 6f20 6461 7461 2066       # no data f
+0000a200: 6f75 6e64 0a0a 2020 2020 2020 2020 2020  ound..          
+0000a210: 2020 6966 2063 7572 7265 6e74 5f70 6f73    if current_pos
+0000a220: 203d 3d20 706f 733a 0a20 2020 2020 2020   == pos:.       
+0000a230: 2020 2020 2020 2020 2023 2069 6620 6e6f           # if no
+0000a240: 2064 6174 6120 696e 2062 6574 7777 656e   data in betwwen
+0000a250: 2076 616c 7565 7320 7573 6520 7468 6520   values use the 
+0000a260: 7072 6576 6975 7320 7661 6c75 650a 2020  previus value.  
+0000a270: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000a280: 2069 2026 6774 3b20 303a 0a20 2020 2020   i &gt; 0:.     
+0000a290: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+0000a2a0: 6563 746f 725b 695d 203d 2076 6563 746f  ector[i] = vecto
+0000a2b0: 725b 6920 2d20 315d 0a20 2020 2020 2020  r[i - 1].       
+0000a2c0: 2020 2020 2020 2020 2023 2069 6620 6e6f           # if no
+0000a2d0: 2064 6174 6120 756e 7469 6c20 6920 7469   data until i ti
+0000a2e0: 6d65 7374 616d 7020 7573 6520 7468 6520  mestamp use the 
+0000a2f0: 6669 7273 7420 6f63 6375 7265 6e63 6520  first occurence 
+0000a300: 6173 2076 616c 7565 0a20 2020 2020 2020  as value.       
+0000a310: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
 0000a320: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a330: 2020 2020 7365 6c66 2e63 6f6e 7465 7874      self.context
-0000a340: 735b 2d31 5d2e 4352 5b26 2333 343b 696e  s[-1].CR[&#34;in
-0000a350: 7465 7270 7265 7461 7469 6f6e 2623 3334  terpretation&#34
-0000a360: 3b5d 5d0a 2020 2020 2020 2020 2320 7468  ;]].        # th
-0000a370: 6973 2069 7320 7573 6566 756c 6c20 666f  is is usefull fo
-0000a380: 7220 706c 6f74 696e 670a 2020 2020 2020  r ploting.      
-0000a390: 2020 7365 6c66 2e63 6f6e 7465 7874 735b    self.contexts[
-0000a3a0: 2d31 5d2e 4352 5b26 2333 343b 696e 7465  -1].CR[&#34;inte
-0000a3b0: 7270 7265 7461 7469 6f6e 2623 3334 3b5d  rpretation&#34;]
-0000a3c0: 203d 2069 6e74 6572 7475 7073 0a0a 2020   = intertups..  
-0000a3d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-0000a3e0: 662e 636f 6e74 6578 7473 5b2d 315d 0a0a  f.contexts[-1]..
-0000a3f0: 2020 2020 6465 6620 6372 6561 7465 5f69      def create_i
-0000a400: 6e74 6572 7072 6574 6174 696f 6e28 7365  nterpretation(se
-0000a410: 6c66 2c20 636f 6e74 6578 7463 7572 7265  lf, contextcurre
-0000a420: 6e74 3a20 436f 6e74 6578 742c 2074 6172  nt: Context, tar
-0000a430: 6765 745f 7365 7269 6573 5f6e 616d 6529  get_series_name)
-0000a440: 3a0a 2020 2020 2020 2020 2623 3334 3b26  :.        &#34;&
-0000a450: 2333 343b 2623 3334 3b0a 2020 2020 2020  #34;&#34;.      
-0000a460: 2020 5468 6973 206d 6574 686f 6420 636f    This method co
-0000a470: 6c6c 6563 7420 616c 6c20 7468 6520 636f  llect all the co
-0000a480: 6e74 6578 7473 2069 6e20 7468 6520 686f  ntexts in the ho
-0000a490: 7269 7a6f 6e20 616e 6420 6361 6c6c 7320  rizon and calls 
-0000a4a0: 7468 6520 696e 7465 7270 7265 7461 7469  the interpretati
-0000a4b0: 6f6e 206d 6574 686f 642e 0a0a 2020 2020  on method...    
-0000a4c0: 2020 2020 2a2a 5061 7261 6d65 7465 7273      **Parameters
-0000a4d0: 2a2a 3a0a 0a20 2020 2020 2020 202a 2a63  **:..        **c
-0000a4e0: 6f6e 7465 7874 6375 7272 656e 742a 2a3a  ontextcurrent**:
-0000a4f0: 2054 6865 2043 6f6e 7465 7874 2066 6f72   The Context for
-0000a500: 2077 6869 6368 2074 6865 2069 6e74 6572   which the inter
-0000a510: 7072 6574 6174 696f 6e20 6973 2063 616c  pretation is cal
-0000a520: 6375 6c61 7465 640a 0a20 2020 2020 2020  culated..       
-0000a530: 202a 2a74 6172 6765 745f 7365 7269 6573   **target_series
-0000a540: 5f6e 616d 652a 2a3a 2054 6865 6e20 6e61  _name**: Then na
-0000a550: 6d65 206f 6620 7468 6520 7461 7267 6574  me of the target
-0000a560: 2076 6172 6961 626c 650a 2020 2020 2020   variable.      
-0000a570: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
-0000a580: 3b0a 0a20 2020 2020 2020 2072 696b 6963  ;..        rikic
-0000a590: 6f6e 7465 7874 203d 2073 656c 662e 636f  ontext = self.co
-0000a5a0: 6e74 6578 7473 0a20 2020 2020 2020 2070  ntexts.        p
-0000a5b0: 6f73 203d 2073 656c 662e 696e 7465 7270  os = self.interp
-0000a5c0: 7265 745f 6869 7374 6f72 795f 706f 730a  ret_history_pos.
-0000a5d0: 2020 2020 2020 2020 7465 6d70 706f 7320          temppos 
-0000a5e0: 3d20 706f 730a 2020 2020 2020 2020 666f  = pos.        fo
-0000a5f0: 7220 7120 696e 2072 616e 6765 2870 6f73  r q in range(pos
-0000a600: 2c20 6c65 6e28 7269 6b69 636f 6e74 6578  , len(rikicontex
-0000a610: 7429 293a 0a20 2020 2020 2020 2020 2020  t)):.           
-0000a620: 2074 656d 7070 6f73 203d 2071 0a20 2020   temppos = q.   
-0000a630: 2020 2020 2020 2020 2069 6620 7064 2e74           if pd.t
-0000a640: 6f5f 6461 7465 7469 6d65 2872 696b 6963  o_datetime(rikic
-0000a650: 6f6e 7465 7874 5b71 5d2e 7469 6d65 7374  ontext[q].timest
-0000a660: 616d 7029 2026 6774 3b3d 2028 0a20 2020  amp) &gt;= (.   
-0000a670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a680: 2070 642e 746f 5f64 6174 6574 696d 6528   pd.to_datetime(
-0000a690: 636f 6e74 6578 7463 7572 7265 6e74 2e74  contextcurrent.t
-0000a6a0: 696d 6573 7461 6d70 2920 2d20 7064 2e54  imestamp) - pd.T
-0000a6b0: 696d 6564 656c 7461 2873 656c 662e 686f  imedelta(self.ho
-0000a6c0: 7269 7a6f 6e2c 2073 656c 662e 686f 7269  rizon, self.hori
-0000a6d0: 7a6f 6e5f 7469 6d65 2929 3a0a 2020 2020  zon_time)):.    
-0000a6e0: 2020 2020 2020 2020 2020 2020 6272 6561              brea
-0000a6f0: 6b0a 2020 2020 2020 2020 6361 7573 6573  k.        causes
-0000a700: 7769 6e64 6f77 203d 2072 696b 6963 6f6e  window = rikicon
-0000a710: 7465 7874 5b74 656d 7070 6f73 3a5d 0a20  text[temppos:]. 
-0000a720: 2020 2020 2020 2073 656c 662e 696e 7465         self.inte
-0000a730: 7270 7265 745f 6869 7374 6f72 795f 706f  rpret_history_po
-0000a740: 7320 3d20 7465 6d70 706f 730a 2020 2020  s = temppos.    
-0000a750: 2020 2020 696e 7465 7270 7220 3d20 7365      interpr = se
-0000a760: 6c66 2e69 6e74 6572 7072 6574 2863 6f6e  lf.interpret(con
-0000a770: 7465 7874 6375 7272 656e 742c 2063 6175  textcurrent, cau
-0000a780: 7365 7377 696e 646f 772c 2074 6172 6765  seswindow, targe
-0000a790: 745f 7365 7269 6573 5f6e 616d 652c 2073  t_series_name, s
-0000a7a0: 656c 662e 7479 7065 5f6f 665f 7365 7269  elf.type_of_seri
-0000a7b0: 6573 290a 2020 2020 2020 2020 7365 6c66  es).        self
-0000a7c0: 2e63 6f6e 7465 7874 735b 2d31 5d2e 4352  .contexts[-1].CR
-0000a7d0: 5b26 2333 343b 696e 7465 7270 7265 7461  [&#34;interpreta
-0000a7e0: 7469 6f6e 2623 3334 3b5d 203d 2069 6e74  tion&#34;] = int
-0000a7f0: 6572 7072 0a0a 2020 2020 6465 6620 696e  erpr..    def in
-0000a800: 7465 7270 7265 7428 7365 6c66 2c20 636f  terpret(self, co
-0000a810: 6e74 6578 743a 2043 6f6e 7465 7874 2c20  ntext: Context, 
-0000a820: 6361 7573 6573 7769 6e64 6f77 2c20 7461  causeswindow, ta
-0000a830: 7267 6574 2c20 7479 7065 5f6f 665f 7365  rget, type_of_se
-0000a840: 7269 6573 293a 0a20 2020 2020 2020 2026  ries):.        &
-0000a850: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-0000a860: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-0000a870: 6f64 2065 6e68 616e 6365 2074 6865 2043  od enhance the C
-0000a880: 5220 7061 7274 206f 6620 7468 6520 436f  R part of the Co
-0000a890: 6e74 6578 7420 7769 7468 2069 6e74 6572  ntext with inter
-0000a8a0: 7072 6574 6174 696f 6e20 7265 6c61 7469  pretation relati
-0000a8b0: 6e67 2074 6f20 7468 6520 7461 7267 6574  ng to the target
-0000a8c0: 2076 6172 6961 626c 652e 0a20 2020 2020   variable..     
-0000a8d0: 2020 2054 6865 2069 6e74 6572 7072 6574     The interpret
-0000a8e0: 6174 696f 6e20 6172 6520 6261 7365 6420  ation are based 
-0000a8f0: 6f6e 2074 6865 2065 6467 6573 2065 7874  on the edges ext
-0000a900: 7261 6374 6564 2066 726f 6d20 7468 6520  racted from the 
-0000a910: 4361 7375 616c 7479 2064 6973 636f 7665  Casualty discove
-0000a920: 7279 2e0a 2020 2020 2020 2020 466f 7220  ry..        For 
-0000a930: 6561 6368 2065 6467 6520 6f66 2074 7970  each edge of typ
-0000a940: 6520 2873 6572 6965 7341 202d 2667 743b  e (seriesA -&gt;
-0000a950: 2074 6172 6765 7429 2069 6e20 7468 6520   target) in the 
-0000a960: 6564 6765 7320 7765 2074 6573 7420 6966  edges we test if
-0000a970: 2074 6865 2073 6572 6965 7341 2069 6e74   the seriesA int
-0000a980: 6572 7072 6574 730a 2020 2020 2020 2020  erprets.        
-0000a990: 7468 6520 7461 7267 6574 2075 7369 6e67  the target using
-0000a9a0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2072   the following r
-0000a9b0: 756c 6573 3a0a 0a20 2020 2020 2020 202a  ules:..        *
-0000a9c0: 2a69 6620 7365 7269 6573 4120 6973 2069  *if seriesA is i
-0000a9d0: 736f 6c61 7465 642a 2a3a 2057 6520 6368  solated**: We ch
-0000a9e0: 6563 6b20 6966 2069 7473 206c 6173 7420  eck if its last 
-0000a9f0: 6f63 6375 7272 656e 6365 2069 7320 7468  occurrence is th
-0000aa00: 6520 6375 7272 656e 7420 7469 6d65 7374  e current timest
-0000aa10: 616d 7020 6f72 2074 6865 2070 7265 7669  amp or the previ
-0000aa20: 6f75 7320 6f6e 652e 0a0a 2020 2020 2020  ous one...      
-0000aa30: 2020 2a2a 6966 2073 6572 6965 7341 2069    **if seriesA i
-0000aa40: 7320 636f 6e66 6967 7572 6174 696f 6e2a  s configuration*
-0000aa50: 2a3a 2057 6520 6368 6563 6b20 6966 2074  *: We check if t
-0000aa60: 6865 2065 6467 6573 2028 7365 7269 6573  he edges (series
-0000aa70: 4120 2d26 6774 3b20 7461 7267 6574 2920  A -&gt; target) 
-0000aa80: 6170 7065 6172 730a 2020 2020 2020 2020  appears.        
-0000aa90: 696e 2061 7420 6c65 6173 7420 3830 2520  in at least 80% 
-0000aaa0: 636f 6e74 6578 7473 2069 6e20 7468 6520  contexts in the 
-0000aab0: 686f 7269 7a6f 6e20 2869 2e65 2e20 696e  horizon (i.e. in
-0000aac0: 2063 6175 7365 7377 696e 646f 7720 6c69   causeswindow li
-0000aad0: 7374 292e 0a0a 2020 2020 2020 2020 2a2a  st)...        **
-0000aae0: 6966 2073 6572 6965 7341 2069 7320 636f  if seriesA is co
-0000aaf0: 6e74 696e 756f 7573 2a2a 3a20 5468 656e  ntinuous**: Then
-0000ab00: 2074 6861 7420 6d65 616e 7320 7468 6520   that means the 
-0000ab10: 7461 7267 6574 2069 7320 7265 6c61 7465  target is relate
-0000ab20: 6420 7769 7468 2073 6572 6965 7341 0a20  d with seriesA. 
-0000ab30: 2020 2020 2020 2061 6e64 2077 6520 6164         and we ad
-0000ab40: 6420 6974 2074 6f20 7468 6520 696e 7465  d it to the inte
-0000ab50: 7270 7265 7461 7469 6f6e 2e0a 0a20 2020  rpretation...   
-0000ab60: 2020 2020 2041 6c6c 2074 6865 2069 6e74       All the int
-0000ab70: 6572 7072 6574 6174 696f 6e73 2061 7265  erpretations are
-0000ab80: 2074 6167 6765 6420 7769 7468 2061 2074   tagged with a t
-0000ab90: 696d 6573 7461 6d70 2077 6869 6368 2072  imestamp which r
-0000aba0: 6566 6572 7320 746f 2074 6865 2066 6972  efers to the fir
-0000abb0: 7374 2074 696d 650a 2020 2020 2020 2020  st time.        
-0000abc0: 6f66 2061 7070 6561 7265 6e73 6520 6f66  of appearense of
-0000abd0: 2063 6f6e 7365 6375 7469 7665 2069 6e74   consecutive int
-0000abe0: 6572 7072 6574 6174 696f 6e73 2e20 5468  erpretations. Th
-0000abf0: 656e 2074 6865 2069 6e74 6572 7072 6574  en the interpret
-0000ac00: 6174 696f 6e20 6172 6520 736f 7274 6564  ation are sorted
-0000ac10: 2075 7369 6e67 0a20 2020 2020 2020 2074   using.        t
-0000ac20: 6869 7320 7469 6d65 7374 616d 702e 2054  his timestamp. T
-0000ac30: 6869 7320 6973 2064 6f6e 6520 746f 2070  his is done to p
-0000ac40: 726f 7669 6465 2061 2068 6965 7261 7263  rovide a hierarc
-0000ac50: 6879 2074 6f20 7468 6520 696e 7465 7270  hy to the interp
-0000ac60: 7265 7461 7469 6f6e 2073 696e 6365 2069  retation since i
-0000ac70: 7420 6d61 7920 6265 2074 6865 2063 6173  t may be the cas
-0000ac80: 652c 0a20 2020 2020 2020 2074 6861 7420  e,.        that 
-0000ac90: 7768 656e 2073 6572 6965 7341 2063 6175  when seriesA cau
-0000aca0: 7365 2074 6172 6765 7420 2c20 616e 6420  se target , and 
-0000acb0: 5365 7269 6573 4220 6361 7573 6520 7461  SeriesB cause ta
-0000acc0: 7267 6574 2c20 7468 6520 6f6c 6465 7374  rget, the oldest
-0000acd0: 206f 6e65 2069 7320 7374 726f 6e67 6572   one is stronger
-0000ace0: 2073 696e 6365 2074 6865 2053 6572 6965   since the Serie
-0000acf0: 7342 206d 6179 2062 650a 2020 2020 2020  sB may be.      
-0000ad00: 2020 6566 6665 6374 206f 6620 7365 7269    effect of seri
-0000ad10: 6573 412e 0a0a 2020 2020 2020 2020 2a2a  esA...        **
-0000ad20: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
-0000ad30: 2020 2020 2020 202a 2a63 6f6e 7465 7874         **context
-0000ad40: 2a2a 3a20 436f 6e74 6578 7420 4f62 6a65  **: Context Obje
-0000ad50: 6374 2074 6f20 6265 2069 6e74 6572 7072  ct to be interpr
-0000ad60: 6574 6564 0a0a 2020 2020 2020 2020 2a2a  eted..        **
-0000ad70: 6361 7573 6573 7769 6e64 6f77 2a2a 3a20  causeswindow**: 
-0000ad80: 6c69 7374 2077 6974 6820 7468 6520 6c61  list with the la
-0000ad90: 7374 2068 6f72 697a 6f6e 2063 6f6e 7465  st horizon conte
-0000ada0: 7874 730a 0a20 2020 2020 2020 202a 2a74  xts..        **t
-0000adb0: 6172 6765 742a 2a3a 2074 6865 206e 616d  arget**: the nam
-0000adc0: 6520 6f66 2074 6865 2074 6172 6765 7420  e of the target 
-0000add0: 7661 7269 6162 6c65 2074 6f20 696e 7465  variable to inte
-0000ade0: 7270 7265 740a 0a20 2020 2020 2020 202a  rpret..        *
-0000adf0: 2a74 7970 655f 6f66 5f73 6572 6965 732a  *type_of_series*
-0000ae00: 2a3a 2064 6963 7469 6f6e 6172 7920 7768  *: dictionary wh
-0000ae10: 6963 6820 6465 6669 6e65 2074 6865 2074  ich define the t
-0000ae20: 7970 6520 6f66 2065 6163 6820 7365 7269  ype of each seri
-0000ae30: 6573 2028 6973 6f6c 6174 6564 2c63 6f6e  es (isolated,con
-0000ae40: 6669 6775 7261 7469 6f6e 206f 7220 636f  figuration or co
-0000ae50: 6e74 696e 756f 7573 290a 2020 2020 2020  ntinuous).      
-0000ae60: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
-0000ae70: 3b0a 0a20 2020 2020 2020 2070 6169 7273  ;..        pairs
-0000ae80: 203d 205b 2870 6169 725b 305d 2c20 7061   = [(pair[0], pa
-0000ae90: 6972 5b31 5d2c 2063 6172 2920 666f 7220  ir[1], car) for 
-0000aea0: 7061 6972 2c20 6361 7220 696e 207a 6970  pair, car in zip
-0000aeb0: 2863 6f6e 7465 7874 2e43 525b 2623 3339  (context.CR[&#39
-0000aec0: 3b65 6467 6573 2623 3339 3b5d 2c20 636f  ;edges&#39;], co
-0000aed0: 6e74 6578 742e 4352 5b26 2333 393b 6368  ntext.CR[&#39;ch
-0000aee0: 6172 6163 7465 7269 7a61 7469 6f6e 2623  aracterization&#
-0000aef0: 3339 3b5d 2920 6966 0a20 2020 2020 2020  39;]) if.       
-0000af00: 2020 2020 2020 2020 2020 7461 7267 6574            target
-0000af10: 2069 6e20 7061 6972 5b31 5d5d 0a0a 2020   in pair[1]]..  
-0000af20: 2020 2020 2020 2320 7061 6972 7368 6f70        # pairshop
-0000af30: 3220 3d20 5b5d 0a20 2020 2020 2020 2023  2 = [].        #
-0000af40: 2069 6e74 6572 6d65 6469 6174 6573 3d5b   intermediates=[
-0000af50: 7061 6972 5b30 5d20 666f 7220 7061 6972  pair[0] for pair
-0000af60: 2069 6e20 7061 6972 735d 0a20 2020 2020   in pairs].     
-0000af70: 2020 2023 2061 6c6c 6f74 6865 733d 5b70     # allothes=[p
-0000af80: 6169 7220 666f 7220 7061 6972 2069 6e20  air for pair in 
-0000af90: 636f 6e74 6578 742e 4344 2e6b 6579 7328  context.CD.keys(
-0000afa0: 2920 6966 2070 6169 7220 6e6f 7420 696e  ) if pair not in
-0000afb0: 2069 6e74 6572 6d65 6469 6174 6573 5d0a   intermediates].
-0000afc0: 2020 2020 2020 2020 230a 2020 2020 2020          #.      
-0000afd0: 2020 2320 666f 7220 696e 7465 725f 7061    # for inter_pa
-0000afe0: 6972 2069 6e20 696e 7465 726d 6564 6961  ir in intermedia
-0000aff0: 7465 733a 0a20 2020 2020 2020 2023 2020  tes:.        #  
-0000b000: 2020 2066 6f72 206e 616d 6520 696e 2061     for name in a
-0000b010: 6c6c 6f74 6865 733a 0a20 2020 2020 2020  llothes:.       
-0000b020: 2023 2020 2020 2020 2020 2069 6620 286e   #         if (n
-0000b030: 616d 652c 696e 7465 725f 7061 6972 2920  ame,inter_pair) 
-0000b040: 696e 2063 6f6e 7465 7874 2e43 525b 2623  in context.CR[&#
-0000b050: 3334 3b65 6467 6573 2623 3334 3b5d 3a0a  34;edges&#34;]:.
-0000b060: 2020 2020 2020 2020 2320 2020 2020 2020          #       
-0000b070: 2020 2020 2020 7061 6972 7368 6f70 322e        pairshop2.
-0000b080: 6170 7065 6e64 2828 6e61 6d65 2c69 6e74  append((name,int
-0000b090: 6572 5f70 6169 7229 290a 0a20 2020 2020  er_pair))..     
-0000b0a0: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
-0000b0b0: 6e20 3d20 5b5d 0a20 2020 2020 2020 2074  n = [].        t
-0000b0c0: 7970 6563 6f6e 6563 7469 6f6e 203d 205b  ypeconection = [
-0000b0d0: 5d0a 2020 2020 2020 2020 6966 206c 656e  ].        if len
-0000b0e0: 2870 6169 7273 2920 3d3d 2030 3a0a 2020  (pairs) == 0:.  
-0000b0f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000b100: 205b 5d0a 2020 2020 2020 2020 666f 7220   [].        for 
-0000b110: 7061 6972 2069 6e20 7061 6972 733a 0a20  pair in pairs:. 
-0000b120: 2020 2020 2020 2020 2020 2069 6620 7479             if ty
-0000b130: 7065 5f6f 665f 7365 7269 6573 5b70 6169  pe_of_series[pai
-0000b140: 725b 305d 5d20 3d3d 2026 2333 343b 6973  r[0]] == &#34;is
-0000b150: 6f6c 6174 6564 2623 3334 3b3a 0a20 2020  olated&#34;:.   
-0000b160: 2020 2020 2020 2020 2020 2020 2076 616c               val
-0000b170: 7565 7331 203d 2063 6f6e 7465 7874 2e43  ues1 = context.C
-0000b180: 445b 7061 6972 5b30 5d5d 0a20 2020 2020  D[pair[0]].     
-0000b190: 2020 2020 2020 2020 2020 2069 6620 7661             if va
-0000b1a0: 6c75 6573 315b 2d31 5d20 3d3d 2031 3a0a  lues1[-1] == 1:.
-0000b1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b1c0: 2020 2020 696e 7465 7270 7265 7461 7469      interpretati
-0000b1d0: 6f6e 2e61 7070 656e 6428 2870 6169 725b  on.append((pair[
-0000b1e0: 305d 2c20 7061 6972 5b31 5d2c 2070 6169  0], pair[1], pai
-0000b1f0: 725b 325d 2c20 636f 6e74 6578 742e 7469  r[2], context.ti
-0000b200: 6d65 7374 616d 7029 290a 2020 2020 2020  mestamp)).      
-0000b210: 2020 2020 2020 2020 2020 656c 6966 2076            elif v
-0000b220: 616c 7565 7331 5b2d 325d 203d 3d20 313a  alues1[-2] == 1:
-0000b230: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b240: 2020 2020 2074 656d 7074 696d 6573 7461       temptimesta
-0000b250: 6d70 203d 2063 6f6e 7465 7874 2e74 696d  mp = context.tim
-0000b260: 6573 7461 6d70 0a20 2020 2020 2020 2020  estamp.         
-0000b270: 2020 2020 2020 2020 2020 206c 6173 7463             lastc
-0000b280: 6f6e 7465 7874 203d 2073 656c 662e 636f  ontext = self.co
-0000b290: 6e74 6578 7473 5b6d 6178 286c 656e 2873  ntexts[max(len(s
-0000b2a0: 656c 662e 636f 6e74 6578 7473 2920 2d20  elf.contexts) - 
-0000b2b0: 322c 2030 295d 0a20 2020 2020 2020 2020  2, 0)].         
-0000b2c0: 2020 2020 2020 2020 2020 2066 6f72 2069             for i
-0000b2d0: 6e74 6572 7061 6972 2069 6e20 6c61 7374  nterpair in last
-0000b2e0: 636f 6e74 6578 742e 4352 5b26 2333 343b  context.CR[&#34;
-0000b2f0: 696e 7465 7270 7265 7461 7469 6f6e 2623  interpretation&#
-0000b300: 3334 3b5d 3a0a 2020 2020 2020 2020 2020  34;]:.          
-0000b310: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000b320: 2069 6e74 6572 7061 6972 5b30 5d20 3d3d   interpair[0] ==
-0000b330: 2070 6169 725b 305d 2061 6e64 2069 6e74   pair[0] and int
-0000b340: 6572 7061 6972 5b31 5d20 3d3d 2070 6169  erpair[1] == pai
-0000b350: 725b 315d 3a0a 2020 2020 2020 2020 2020  r[1]:.          
-0000b360: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b370: 2020 7465 6d70 7469 6d65 7374 616d 7020    temptimestamp 
-0000b380: 3d20 696e 7465 7270 6169 725b 335d 0a20  = interpair[3]. 
-0000b390: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b3a0: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
-0000b3b0: 6e2e 6170 7065 6e64 2828 7061 6972 5b30  n.append((pair[0
-0000b3c0: 5d2c 2070 6169 725b 315d 2c20 7061 6972  ], pair[1], pair
-0000b3d0: 5b32 5d2c 2074 656d 7074 696d 6573 7461  [2], temptimesta
-0000b3e0: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
-0000b3f0: 2065 6c69 6620 7479 7065 5f6f 665f 7365   elif type_of_se
-0000b400: 7269 6573 5b70 6169 725b 305d 5d20 3d3d  ries[pair[0]] ==
-0000b410: 2026 2333 343b 636f 6e66 6967 7572 6174   &#34;configurat
-0000b420: 696f 6e26 2333 343b 3a0a 2020 2020 2020  ion&#34;:.      
-0000b430: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-0000b440: 3120 3d20 636f 6e74 6578 742e 4344 5b70  1 = context.CD[p
-0000b450: 6169 725b 305d 5d0a 2020 2020 2020 2020  air[0]].        
-0000b460: 2020 2020 2020 2020 6f63 6375 7265 6e63          occurenc
-0000b470: 6520 3d20 300a 2020 2020 2020 2020 2020  e = 0.          
-0000b480: 2020 2020 2020 666f 7220 7120 696e 2072        for q in r
-0000b490: 616e 6765 286c 656e 2876 616c 7565 7331  ange(len(values1
-0000b4a0: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-0000b4b0: 2020 2020 2020 2020 6966 2076 616c 7565          if value
-0000b4c0: 7331 5b71 5d20 3d3d 2076 616c 7565 7331  s1[q] == values1
-0000b4d0: 5b2d 315d 2061 6e64 2076 616c 7565 7331  [-1] and values1
-0000b4e0: 5b71 5d20 2667 743b 2030 3a0a 2020 2020  [q] &gt; 0:.    
+0000a330: 2020 2076 6563 746f 725b 695d 203d 206f     vector[i] = o
+0000a340: 6363 7572 656e 6369 6573 5b30 5d5b 305d  ccurencies[0][0]
+0000a350: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+0000a360: 6620 6d75 6c74 6970 6c65 2076 616c 7565  f multiple value
+0000a370: 7320 696e 2062 6574 7765 656e 2074 776f  s in between two
+0000a380: 2074 696d 6573 7461 6d70 7320 7573 6520   timestamps use 
+0000a390: 7468 6520 6d65 616e 206f 6620 7468 656d  the mean of them
+0000a3a0: 2061 7320 7661 6c75 650a 2020 2020 2020   as value.      
+0000a3b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000a3c0: 2020 2020 2020 2020 2020 2020 6461 7461              data
+0000a3d0: 496e 4265 7477 6565 6e20 3d20 5b76 616c  InBetween = [val
+0000a3e0: 7565 2066 6f72 2076 616c 7565 2c20 7469  ue for value, ti
+0000a3f0: 6d65 2069 6e20 6f63 6375 7265 6e63 6965  me in occurencie
+0000a400: 735b 706f 733a 6375 7272 656e 745f 706f  s[pos:current_po
+0000a410: 735d 5d0a 2020 2020 2020 2020 2020 2020  s]].            
+0000a420: 2020 2020 7665 6374 6f72 5b69 5d20 3d20      vector[i] = 
+0000a430: 7375 6d28 6461 7461 496e 4265 7477 6565  sum(dataInBetwee
+0000a440: 6e29 202f 206c 656e 2864 6174 6149 6e42  n) / len(dataInB
+0000a450: 6574 7765 656e 290a 2020 2020 2020 2020  etween).        
+0000a460: 2020 2020 2320 6966 206e 6f20 6f74 6865      # if no othe
+0000a470: 7220 6f63 6375 7265 6e63 6965 7320 6a75  r occurencies ju
+0000a480: 7374 2072 6570 6561 7420 7468 6520 6c61  st repeat the la
+0000a490: 7374 2076 616c 7565 0a20 2020 2020 2020  st value.       
+0000a4a0: 2020 2020 2069 6620 6375 7272 656e 745f       if current_
+0000a4b0: 706f 7320 3d3d 206c 656e 286f 6363 7572  pos == len(occur
+0000a4c0: 656e 6369 6573 293a 0a20 2020 2020 2020  encies):.       
+0000a4d0: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
+0000a4e0: 6e20 7261 6e67 6528 6920 2b20 312c 206c  n range(i + 1, l
+0000a4f0: 656e 2876 6563 746f 7229 293a 0a20 2020  en(vector)):.   
+0000a500: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a510: 2076 6563 746f 725b 6b5d 203d 2076 6563   vector[k] = vec
+0000a520: 746f 725b 6b20 2d20 315d 0a20 2020 2020  tor[k - 1].     
+0000a530: 2020 2020 2020 2020 2020 2062 7265 616b             break
+0000a540: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
+0000a550: 203d 2063 7572 7265 6e74 5f70 6f73 0a0a   = current_pos..
+0000a560: 2020 2020 2020 2020 7265 7475 726e 2076          return v
+0000a570: 6563 746f 720a 0a20 2020 2064 6566 2063  ector..    def c
+0000a580: 616c 6375 6c61 7465 5f63 6175 7361 6c69  alculate_causali
+0000a590: 7479 2873 656c 662c 2064 6174 616f 722c  ty(self, dataor,
+0000a5a0: 206e 616d 6573 293a 0a20 2020 2020 2020   names):.       
+0000a5b0: 206e 756d 5f74 696d 655f 7365 7269 6573   num_time_series
+0000a5c0: 203d 206c 656e 2864 6174 616f 7229 0a20   = len(dataor). 
+0000a5d0: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
+0000a5e0: 2e61 7272 6179 2864 6174 616f 7229 0a20  .array(dataor). 
+0000a5f0: 2020 2020 2020 2065 6467 6573 203d 2073         edges = s
+0000a600: 656c 662e 6361 7573 616c 6974 795f 6469  elf.causality_di
+0000a610: 7363 6f76 6572 7928 6e61 6d65 732c 2064  scovery(names, d
+0000a620: 6174 6129 0a20 2020 2020 2020 2023 2065  ata).        # e
+0000a630: 6467 6573 3d73 656c 662e 6361 6c63 756c  dges=self.calcul
+0000a640: 6174 6577 6974 6850 6328 6e61 6d65 732c  atewithPc(names,
+0000a650: 6461 7461 290a 2020 2020 2020 2020 2320  data).        # 
+0000a660: 6564 6765 733d 7365 6c66 2e63 616c 6375  edges=self.calcu
+0000a670: 6c61 7465 7769 7468 5f66 6369 286e 616d  latewith_fci(nam
+0000a680: 6573 2c64 6174 6129 0a20 2020 2020 2020  es,data).       
+0000a690: 2023 2065 6467 6573 3d73 656c 662e 7361   # edges=self.sa
+0000a6a0: 6c65 7366 6f72 6365 5043 286e 616d 6573  lesforcePC(names
+0000a6b0: 2c64 6174 6129 0a20 2020 2020 2020 2072  ,data).        r
+0000a6c0: 6574 7572 6e20 6564 6765 730a 0a20 2020  eturn edges..   
+0000a6d0: 2064 6566 2070 6c6f 7428 7365 6c66 2c20   def plot(self, 
+0000a6e0: 6669 6c74 6572 6564 6765 733d 4e6f 6e65  filteredges=None
+0000a6f0: 293a 0a20 2020 2020 2020 2069 6620 6669  ):.        if fi
+0000a700: 6c74 6572 6564 6765 7320 6973 204e 6f6e  lteredges is Non
+0000a710: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
+0000a720: 696c 7465 7265 6467 6573 203d 205b 5b26  ilteredges = [[&
+0000a730: 2333 343b 2623 3334 3b2c 2026 2333 343b  #34;&#34;, &#34;
+0000a740: 2623 3334 3b2c 2026 2333 343b 2623 3334  &#34;, &#34;&#34
+0000a750: 3b5d 5d0a 2020 2020 2020 2020 7368 6f77  ;]].        show
+0000a760: 5f63 6f6e 7465 7874 5f6c 6973 7428 7365  _context_list(se
+0000a770: 6c66 2e63 6f6e 7465 7874 732c 2073 656c  lf.contexts, sel
+0000a780: 662e 7461 7267 6574 2c20 6669 6c74 6572  f.target, filter
+0000a790: 6564 6765 733d 6669 6c74 6572 6564 6765  edges=filteredge
+0000a7a0: 7329 0a0a 2020 2020 6465 6620 706c 6f74  s)..    def plot
+0000a7b0: 5f69 6e74 6572 7072 6574 6174 696f 6e28  _interpretation(
+0000a7c0: 7365 6c66 2c20 6669 6c74 6572 6564 6765  self, filteredge
+0000a7d0: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
+0000a7e0: 2069 6620 6669 6c74 6572 6564 6765 7320   if filteredges 
+0000a7f0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0000a800: 2020 2020 2066 696c 7465 7265 6467 6573       filteredges
+0000a810: 203d 205b 5b26 2333 343b 2623 3334 3b2c   = [[&#34;&#34;,
+0000a820: 2026 2333 343b 2623 3334 3b2c 2026 2333   &#34;&#34;, &#3
+0000a830: 343b 2623 3334 3b5d 5d0a 2020 2020 2020  4;&#34;]].      
+0000a840: 2020 7368 6f77 5f63 6f6e 7465 7874 5f69    show_context_i
+0000a850: 6e74 6572 7072 6574 6174 696f 6e73 2873  nterpretations(s
+0000a860: 656c 662e 636f 6e74 6578 7473 2c20 7365  elf.contexts, se
+0000a870: 6c66 2e74 6172 6765 742c 2066 696c 7465  lf.target, filte
+0000a880: 7265 6467 6573 3d66 696c 7465 7265 6467  redges=filteredg
+0000a890: 6573 293c 2f63 6f64 653e 3c2f 7072 653e  es)</code></pre>
+0000a8a0: 0a3c 2f64 6574 6169 6c73 3e0a 3c2f 7365  .</details>.</se
+0000a8b0: 6374 696f 6e3e 0a3c 7365 6374 696f 6e3e  ction>.<section>
+0000a8c0: 0a3c 2f73 6563 7469 6f6e 3e0a 3c73 6563  .</section>.<sec
+0000a8d0: 7469 6f6e 3e0a 3c2f 7365 6374 696f 6e3e  tion>.</section>
+0000a8e0: 0a3c 7365 6374 696f 6e3e 0a3c 2f73 6563  .<section>.</sec
+0000a8f0: 7469 6f6e 3e0a 3c73 6563 7469 6f6e 3e0a  tion>.<section>.
+0000a900: 3c68 3220 636c 6173 733d 2273 6563 7469  <h2 class="secti
+0000a910: 6f6e 2d74 6974 6c65 2220 6964 3d22 6865  on-title" id="he
+0000a920: 6164 6572 2d63 6c61 7373 6573 223e 436c  ader-classes">Cl
+0000a930: 6173 7365 733c 2f68 323e 0a3c 646c 3e0a  asses</h2>.<dl>.
+0000a940: 3c64 7420 6964 3d22 5064 6d43 6f6e 7465  <dt id="PdmConte
+0000a950: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
+0000a960: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
+0000a970: 7261 746f 7222 3e3c 636f 6465 2063 6c61  rator"><code cla
+0000a980: 7373 3d22 666c 6578 206e 616d 6520 636c  ss="flex name cl
+0000a990: 6173 7322 3e0a 3c73 7061 6e3e 636c 6173  ass">.<span>clas
+0000a9a0: 7320 3c73 7061 6e20 636c 6173 733d 2269  s <span class="i
+0000a9b0: 6465 6e74 223e 436f 6e74 6578 7447 656e  dent">ContextGen
+0000a9c0: 6572 6174 6f72 3c2f 7370 616e 3e3c 2f73  erator</span></s
+0000a9d0: 7061 6e3e 0a3c 7370 616e 3e28 3c2f 7370  pan>.<span>(</sp
+0000a9e0: 616e 3e3c 7370 616e 3e74 6172 6765 742c  an><span>target,
+0000a9f0: 2063 6f6e 7465 7874 5f68 6f72 697a 6f6e   context_horizon
+0000aa00: 3d27 3827 2c20 4361 7573 616c 6974 7966  ='8', Causalityf
+0000aa10: 756e 6374 3d26 6c74 3b66 756e 6374 696f  unct=&lt;functio
+0000aa20: 6e20 6361 6c63 756c 6174 655f 7769 7468  n calculate_with
+0000aa30: 5f70 6326 6774 3b2c 2064 6562 7567 3d46  _pc&gt;, debug=F
+0000aa40: 616c 7365 293c 2f73 7061 6e3e 0a3c 2f63  alse)</span>.</c
+0000aa50: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
+0000aa60: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
+0000aa70: 3e3c 703e 5468 6973 2043 6c61 7373 2068  ><p>This Class h
+0000aa80: 616e 646c 6520 7468 6520 436f 6e74 6578  andle the Contex
+0000aa90: 7420 4765 6e65 7261 7469 6f6e 2e20 4974  t Generation. It
+0000aaa0: 206b 6565 7073 2061 6e20 696e 7465 726e   keeps an intern
+0000aab0: 616c 2062 7566 6665 7220 746f 2062 7569  al buffer to bui
+0000aac0: 6c64 2074 6865 2063 6f6e 7465 7874 2066  ld the context f
+0000aad0: 6f72 2061 2074 6172 6765 7420 7365 7269  or a target seri
+0000aae0: 6573 2062 6173 6564 0a6f 6e20 7468 6520  es based.on the 
+0000aaf0: 7072 6f76 6964 6564 2063 6f6e 7465 7874  provided context
+0000ab00: 5f68 6f72 697a 6f6e 2e20 416c 6c20 6461  _horizon. All da
+0000ab10: 7461 2061 7265 2070 6173 7365 6420 7468  ta are passed th
+0000ab20: 6f75 6768 2074 6865 2063 6f6c 6c65 6374  ough the collect
+0000ab30: 5f64 6174 6120 6d65 7468 6f64 2c20 7768  _data method, wh
+0000ab40: 6963 6820 7265 7475 726e 2061 2063 6f72  ich return a cor
+0000ab50: 7265 7370 6f64 696e 670a 436f 6e74 6578  respoding.Contex
+0000ab60: 7420 7768 656e 2074 6172 6765 7420 6461  t when target da
+0000ab70: 7461 2061 7265 2070 6173 7365 642e 3c2f  ta are passed.</
+0000ab80: 703e 0a3c 703e 3c73 7472 6f6e 673e 5061  p>.<p><strong>Pa
+0000ab90: 7261 6d65 7465 7273 3c2f 7374 726f 6e67  rameters</strong
+0000aba0: 3e3a 3c2f 703e 0a3c 703e 3c73 7472 6f6e  >:</p>.<p><stron
+0000abb0: 673e 7461 7267 6574 3c2f 7374 726f 6e67  g>target</strong
+0000abc0: 3e3a 2054 6865 206e 616d 6520 6f66 2074  >: The name of t
+0000abd0: 6865 2074 6172 6765 7420 736f 7572 6365  he target source
+0000abe0: 2c20 7768 6963 6820 7769 6c6c 2062 6520  , which will be 
+0000abf0: 7573 6564 2061 7320 7468 6520 6261 7365  used as the base
+0000ac00: 6c69 6e65 2069 6e20 6f72 6465 7220 746f  line in order to
+0000ac10: 206d 6170 2064 6966 6665 7265 6e74 2073   map different s
+0000ac20: 616d 706c 6573 0a72 6174 6520 746f 2074  amples.rate to t
+0000ac30: 6861 7420 6f66 2074 6865 2074 6172 6765  hat of the targe
+0000ac40: 7420 7361 6d70 6c65 2072 6174 652e 3c2f  t sample rate.</
+0000ac50: 703e 0a3c 703e 3c73 7472 6f6e 673e 636f  p>.<p><strong>co
+0000ac60: 6e74 6578 745f 686f 7269 7a6f 6e3c 2f73  ntext_horizon</s
+0000ac70: 7472 6f6e 673e 3a20 5468 6520 7469 6d65  trong>: The time
+0000ac80: 2070 6572 696f 6420 746f 206c 6f6f 6b20   period to look 
+0000ac90: 6261 636b 2066 6f72 2063 6f6e 7465 7874  back for context
+0000aca0: 2064 6174 612c 2074 6865 2066 6f72 6d20   data, the form 
+0000acb0: 6f66 2074 6861 7420 7061 7261 6d65 7465  of that paramete
+0000acc0: 7220 6973 2022 3820 686f 7572 7322 3c2f  r is "8 hours"</
+0000acd0: 703e 0a3c 703e 3c73 7472 6f6e 673e 4361  p>.<p><strong>Ca
+0000ace0: 7573 616c 6974 7966 756e 6374 3c2f 7374  usalityfunct</st
+0000acf0: 726f 6e67 3e3a 2074 6865 2063 6175 7361  rong>: the causa
+0000ad00: 6c69 7479 2064 6973 636f 7665 7279 206d  lity discovery m
+0000ad10: 6574 686f 6420 746f 2075 7365 2074 6f20  ethod to use to 
+0000ad20: 7072 6f64 7563 6520 6361 7573 616c 2072  produce causal r
+0000ad30: 656c 6174 696f 6e73 6869 7073 2062 6574  elationships bet
+0000ad40: 7765 656e 2063 6f6e 7465 7874 2064 6174  ween context dat
+0000ad50: 612c 0a54 6869 7320 6d75 7374 2062 6520  a,.This must be 
+0000ad60: 6120 6675 6e63 7469 6f6e 2077 6974 6820  a function with 
+0000ad70: 7061 7261 6d65 7465 7273 2074 776f 2065  parameters two e
+0000ad80: 7175 616c 2073 697a 6520 6c69 7374 732c  qual size lists,
+0000ad90: 206f 6e65 2077 6974 6820 6e61 6d65 7320   one with names 
+0000ada0: 616e 6420 7468 6520 6f74 6865 720a 7769  and the other.wi
+0000adb0: 7468 2064 6174 6120 2861 206c 6973 7420  th data (a list 
+0000adc0: 6f66 206c 6973 7420 6f72 2032 4420 6e75  of list or 2D nu
+0000add0: 6d70 7920 6172 7261 7929 2e3c 2f70 3e0a  mpy array).</p>.
+0000ade0: 3c70 3e3c 7374 726f 6e67 3e64 6562 7567  <p><strong>debug
+0000adf0: 3c2f 7374 726f 6e67 3e3a 2049 6620 6974  </strong>: If it
+0000ae00: 2072 756e 7320 6f6e 2064 6562 7567 206d   runs on debug m
+0000ae10: 6f64 653c 2f70 3e3c 2f64 6976 3e0a 3c64  ode</p></div>.<d
+0000ae20: 6574 6169 6c73 2063 6c61 7373 3d22 736f  etails class="so
+0000ae30: 7572 6365 223e 0a3c 7375 6d6d 6172 793e  urce">.<summary>
+0000ae40: 0a3c 7370 616e 3e45 7870 616e 6420 736f  .<span>Expand so
+0000ae50: 7572 6365 2063 6f64 653c 2f73 7061 6e3e  urce code</span>
+0000ae60: 0a3c 2f73 756d 6d61 7279 3e0a 3c70 7265  .</summary>.<pre
+0000ae70: 3e3c 636f 6465 2063 6c61 7373 3d22 7079  ><code class="py
+0000ae80: 7468 6f6e 223e 636c 6173 7320 436f 6e74  thon">class Cont
+0000ae90: 6578 7447 656e 6572 6174 6f72 3a0a 0a20  extGenerator:.. 
+0000aea0: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+0000aeb0: 7365 6c66 2c20 7461 7267 6574 2c20 636f  self, target, co
+0000aec0: 6e74 6578 745f 686f 7269 7a6f 6e3d 2623  ntext_horizon=&#
+0000aed0: 3334 3b38 2623 3334 3b2c 2043 6175 7361  34;8&#34;, Causa
+0000aee0: 6c69 7479 6675 6e63 743d 6361 6c63 756c  lityfunct=calcul
+0000aef0: 6174 655f 7769 7468 5f70 632c 2064 6562  ate_with_pc, deb
+0000af00: 7567 3d46 616c 7365 293a 0a20 2020 2020  ug=False):.     
+0000af10: 2020 2026 2333 343b 2623 3334 3b26 2333     &#34;&#34;&#3
+0000af20: 343b 0a20 2020 2020 2020 2054 6869 7320  4;.        This 
+0000af30: 436c 6173 7320 6861 6e64 6c65 2074 6865  Class handle the
+0000af40: 2043 6f6e 7465 7874 2047 656e 6572 6174   Context Generat
+0000af50: 696f 6e2e 2049 7420 6b65 6570 7320 616e  ion. It keeps an
+0000af60: 2069 6e74 6572 6e61 6c20 6275 6666 6572   internal buffer
+0000af70: 2074 6f20 6275 696c 6420 7468 6520 636f   to build the co
+0000af80: 6e74 6578 7420 666f 7220 6120 7461 7267  ntext for a targ
+0000af90: 6574 2073 6572 6965 7320 6261 7365 640a  et series based.
+0000afa0: 2020 2020 2020 2020 6f6e 2074 6865 2070          on the p
+0000afb0: 726f 7669 6465 6420 636f 6e74 6578 745f  rovided context_
+0000afc0: 686f 7269 7a6f 6e2e 2041 6c6c 2064 6174  horizon. All dat
+0000afd0: 6120 6172 6520 7061 7373 6564 2074 686f  a are passed tho
+0000afe0: 7567 6820 7468 6520 636f 6c6c 6563 745f  ugh the collect_
+0000aff0: 6461 7461 206d 6574 686f 642c 2077 6869  data method, whi
+0000b000: 6368 2072 6574 7572 6e20 6120 636f 7272  ch return a corr
+0000b010: 6573 706f 6469 6e67 0a20 2020 2020 2020  espoding.       
+0000b020: 2043 6f6e 7465 7874 2077 6865 6e20 7461   Context when ta
+0000b030: 7267 6574 2064 6174 6120 6172 6520 7061  rget data are pa
+0000b040: 7373 6564 2e0a 0a0a 2020 2020 2020 2020  ssed....        
+0000b050: 2a2a 5061 7261 6d65 7465 7273 2a2a 3a0a  **Parameters**:.
+0000b060: 0a20 2020 2020 2020 202a 2a74 6172 6765  .        **targe
+0000b070: 742a 2a3a 2054 6865 206e 616d 6520 6f66  t**: The name of
+0000b080: 2074 6865 2074 6172 6765 7420 736f 7572   the target sour
+0000b090: 6365 2c20 7768 6963 6820 7769 6c6c 2062  ce, which will b
+0000b0a0: 6520 7573 6564 2061 7320 7468 6520 6261  e used as the ba
+0000b0b0: 7365 6c69 6e65 2069 6e20 6f72 6465 7220  seline in order 
+0000b0c0: 746f 206d 6170 2064 6966 6665 7265 6e74  to map different
+0000b0d0: 2073 616d 706c 6573 0a20 2020 2020 2020   samples.       
+0000b0e0: 2020 7261 7465 2074 6f20 7468 6174 206f    rate to that o
+0000b0f0: 6620 7468 6520 7461 7267 6574 2073 616d  f the target sam
+0000b100: 706c 6520 7261 7465 2e0a 0a20 2020 2020  ple rate...     
+0000b110: 2020 202a 2a63 6f6e 7465 7874 5f68 6f72     **context_hor
+0000b120: 697a 6f6e 2a2a 3a20 5468 6520 7469 6d65  izon**: The time
+0000b130: 2070 6572 696f 6420 746f 206c 6f6f 6b20   period to look 
+0000b140: 6261 636b 2066 6f72 2063 6f6e 7465 7874  back for context
+0000b150: 2064 6174 612c 2074 6865 2066 6f72 6d20   data, the form 
+0000b160: 6f66 2074 6861 7420 7061 7261 6d65 7465  of that paramete
+0000b170: 7220 6973 2026 2333 343b 3820 686f 7572  r is &#34;8 hour
+0000b180: 7326 2333 343b 0a0a 2020 2020 2020 2020  s&#34;..        
+0000b190: 2a2a 4361 7573 616c 6974 7966 756e 6374  **Causalityfunct
+0000b1a0: 2a2a 3a20 7468 6520 6361 7573 616c 6974  **: the causalit
+0000b1b0: 7920 6469 7363 6f76 6572 7920 6d65 7468  y discovery meth
+0000b1c0: 6f64 2074 6f20 7573 6520 746f 2070 726f  od to use to pro
+0000b1d0: 6475 6365 2063 6175 7361 6c20 7265 6c61  duce causal rela
+0000b1e0: 7469 6f6e 7368 6970 7320 6265 7477 6565  tionships betwee
+0000b1f0: 6e20 636f 6e74 6578 7420 6461 7461 2c0a  n context data,.
+0000b200: 2020 2020 2020 2020 2020 2020 5468 6973              This
+0000b210: 206d 7573 7420 6265 2061 2066 756e 6374   must be a funct
+0000b220: 696f 6e20 7769 7468 2070 6172 616d 6574  ion with paramet
+0000b230: 6572 7320 7477 6f20 6571 7561 6c20 7369  ers two equal si
+0000b240: 7a65 206c 6973 7473 2c20 6f6e 6520 7769  ze lists, one wi
+0000b250: 7468 206e 616d 6573 2061 6e64 2074 6865  th names and the
+0000b260: 206f 7468 6572 0a20 2020 2020 2020 2020   other.         
+0000b270: 2020 2077 6974 6820 6461 7461 2028 6120     with data (a 
+0000b280: 6c69 7374 206f 6620 6c69 7374 206f 7220  list of list or 
+0000b290: 3244 206e 756d 7079 2061 7272 6179 292e  2D numpy array).
+0000b2a0: 0a0a 2020 2020 2020 2020 2a2a 6465 6275  ..        **debu
+0000b2b0: 672a 2a3a 2049 6620 6974 2072 756e 7320  g**: If it runs 
+0000b2c0: 6f6e 2064 6562 7567 206d 6f64 650a 2020  on debug mode.  
+0000b2d0: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
+0000b2e0: 2623 3334 3b0a 0a20 2020 2020 2020 2073  &#34;..        s
+0000b2f0: 656c 662e 6465 6275 6720 3d20 6465 6275  elf.debug = debu
+0000b300: 670a 2020 2020 2020 2020 7365 6c66 2e74  g.        self.t
+0000b310: 6172 6765 7420 3d20 7461 7267 6574 0a0a  arget = target..
+0000b320: 2020 2020 2020 2020 7365 6c66 2e63 6f6e          self.con
+0000b330: 7465 7874 7320 3d20 5b5d 0a0a 2020 2020  texts = []..    
+0000b340: 2020 2020 7365 6c66 2e63 6175 7361 6c69      self.causali
+0000b350: 7479 5f64 6973 636f 7665 7279 203d 2043  ty_discovery = C
+0000b360: 6175 7361 6c69 7479 6675 6e63 740a 2020  ausalityfunct.  
+0000b370: 2020 2020 2020 7365 6c66 2e62 7566 6665        self.buffe
+0000b380: 7220 3d20 5b5d 0a0a 2020 2020 2020 2020  r = []..        
+0000b390: 2320 6865 6c70 6572 730a 2020 2020 2020  # helpers.      
+0000b3a0: 2020 7365 6c66 2e74 7970 655f 6f66 5f73    self.type_of_s
+0000b3b0: 6572 6965 7320 3d20 7b7d 0a20 2020 2020  eries = {}.     
+0000b3c0: 2020 2073 656c 662e 686f 7269 7a6f 6e20     self.horizon 
+0000b3d0: 3d20 636f 6e74 6578 745f 686f 7269 7a6f  = context_horizo
+0000b3e0: 6e2e 7370 6c69 7428 2623 3334 3b20 2623  n.split(&#34; &#
+0000b3f0: 3334 3b29 5b30 5d0a 2020 2020 2020 2020  34;)[0].        
+0000b400: 6966 206c 656e 2863 6f6e 7465 7874 5f68  if len(context_h
+0000b410: 6f72 697a 6f6e 2e73 706c 6974 2826 2333  orizon.split(&#3
+0000b420: 343b 2026 2333 343b 2929 203d 3d20 313a  4; &#34;)) == 1:
+0000b430: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+0000b440: 662e 686f 7269 7a6f 6e5f 7469 6d65 203d  f.horizon_time =
+0000b450: 2026 2333 343b 686f 7572 7326 2333 343b   &#34;hours&#34;
+0000b460: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0000b470: 2020 2020 2020 2020 2020 2069 6620 636f             if co
+0000b480: 6e74 6578 745f 686f 7269 7a6f 6e2e 7370  ntext_horizon.sp
+0000b490: 6c69 7428 2623 3334 3b20 2623 3334 3b29  lit(&#34; &#34;)
+0000b4a0: 5b31 5d20 696e 205b 2623 3334 3b64 6179  [1] in [&#34;day
+0000b4b0: 7326 2333 343b 2c20 2623 3334 3b68 6f75  s&#34;, &#34;hou
+0000b4c0: 7273 2623 3334 3b2c 2026 2333 343b 6d69  rs&#34;, &#34;mi
+0000b4d0: 6e75 7465 7326 2333 343b 2c20 2623 3334  nutes&#34;, &#34
+0000b4e0: 3b73 6563 6f6e 6473 2623 3334 3b5d 3a0a  ;seconds&#34;]:.
 0000b4f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b500: 2020 2020 6f63 6375 7265 6e63 6520 3d20      occurence = 
-0000b510: 710a 2020 2020 2020 2020 2020 2020 2020  q.              
-0000b520: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-0000b530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b540: 6966 206f 6363 7572 656e 6365 203d 3d20  if occurence == 
-0000b550: 6c65 6e28 7661 6c75 6573 3129 202d 2031  len(values1) - 1
-0000b560: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b570: 2020 2020 2020 696e 7465 7270 7265 7461        interpreta
-0000b580: 7469 6f6e 2e61 7070 656e 6428 2870 6169  tion.append((pai
-0000b590: 725b 305d 2c20 7061 6972 5b31 5d2c 2070  r[0], pair[1], p
-0000b5a0: 6169 725b 325d 2c20 636f 6e74 6578 742e  air[2], context.
-0000b5b0: 7469 6d65 7374 616d 7029 290a 2020 2020  timestamp)).    
-0000b5c0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000b5d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b5e0: 2020 2020 2020 6c65 6164 203d 206c 656e        lead = len
-0000b5f0: 2876 616c 7565 7331 2920 2d20 6f63 6375  (values1) - occu
-0000b600: 7265 6e63 650a 2020 2020 2020 2020 2020  rence.          
-0000b610: 2020 2020 2020 2020 2020 636f 756e 7465            counte
-0000b620: 7220 3d20 300a 2020 2020 2020 2020 2020  r = 0.          
-0000b630: 2020 2020 2020 2020 2020 6c65 6164 636f            leadco
-0000b640: 6e74 6578 7420 3d20 6361 7573 6573 7769  ntext = causeswi
-0000b650: 6e64 6f77 5b2d 6c65 6164 3a5d 0a20 2020  ndow[-lead:].   
-0000b660: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b670: 2066 6f72 2063 6f6e 7465 2069 6e20 6c65   for conte in le
-0000b680: 6164 636f 6e74 6578 743a 0a20 2020 2020  adcontext:.     
-0000b690: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b6a0: 2020 2074 7279 3a0a 2020 2020 2020 2020     try:.        
-0000b6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b6c0: 2020 2020 706f 7320 3d20 6c69 7374 2863      pos = list(c
-0000b6d0: 6f6e 7465 2e43 525b 2623 3334 3b65 6467  onte.CR[&#34;edg
-0000b6e0: 6573 2623 3334 3b5d 292e 696e 6465 7828  es&#34;]).index(
-0000b6f0: 2870 6169 725b 305d 2c20 7061 6972 5b31  (pair[0], pair[1
-0000b700: 5d29 290a 2020 2020 2020 2020 2020 2020  ])).            
-0000b710: 2020 2020 2020 2020 2020 2020 6578 6365              exce
-0000b720: 7074 3a0a 2020 2020 2020 2020 2020 2020  pt:.            
-0000b730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b740: 706f 7320 3d20 2d31 0a20 2020 2020 2020  pos = -1.       
-0000b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b760: 2069 6620 706f 7320 213d 202d 313a 0a20   if pos != -1:. 
-0000b770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b780: 2020 2020 2020 2020 2020 2069 6620 636f             if co
-0000b790: 6e74 652e 4352 5b26 2333 343b 6368 6172  nte.CR[&#34;char
-0000b7a0: 6163 7465 7269 7a61 7469 6f6e 2623 3334  acterization&#34
-0000b7b0: 3b5d 5b70 6f73 5d20 3d3d 2070 6169 725b  ;][pos] == pair[
-0000b7c0: 325d 3a0a 2020 2020 2020 2020 2020 2020  2]:.            
-0000b7d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b7e0: 2020 2020 636f 756e 7465 7220 2b3d 2031      counter += 1
-0000b7f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000b800: 2020 2020 2069 6620 636f 756e 7465 7220       if counter 
-0000b810: 2667 743b 3d20 302e 3820 2a20 6c65 6164  &gt;= 0.8 * lead
-0000b820: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000b830: 2020 2020 2020 2020 2020 7465 6d70 7469            tempti
-0000b840: 6d65 7374 616d 7020 3d20 636f 6e74 6578  mestamp = contex
-0000b850: 742e 7469 6d65 7374 616d 700a 2020 2020  t.timestamp.    
-0000b860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b870: 2020 2020 6c61 7374 636f 6e74 6578 7420      lastcontext 
-0000b880: 3d20 7365 6c66 2e63 6f6e 7465 7874 735b  = self.contexts[
-0000b890: 6d61 7828 6c65 6e28 7365 6c66 2e63 6f6e  max(len(self.con
-0000b8a0: 7465 7874 7329 202d 2032 2c20 3029 5d0a  texts) - 2, 0)].
-0000b8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b8c0: 2020 2020 2020 2020 666f 7220 696e 7465          for inte
-0000b8d0: 7270 6169 7220 696e 206c 6173 7463 6f6e  rpair in lastcon
-0000b8e0: 7465 7874 2e43 525b 2623 3334 3b69 6e74  text.CR[&#34;int
-0000b8f0: 6572 7072 6574 6174 696f 6e26 2333 343b  erpretation&#34;
-0000b900: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0000b910: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000b920: 6620 696e 7465 7270 6169 725b 305d 203d  f interpair[0] =
-0000b930: 3d20 7061 6972 5b30 5d20 616e 6420 696e  = pair[0] and in
-0000b940: 7465 7270 6169 725b 315d 203d 3d20 7061  terpair[1] == pa
-0000b950: 6972 5b31 5d3a 0a20 2020 2020 2020 2020  ir[1]:.         
-0000b960: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b970: 2020 2020 2020 2074 656d 7074 696d 6573         temptimes
-0000b980: 7461 6d70 203d 2069 6e74 6572 7061 6972  tamp = interpair
-0000b990: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
-0000b9a0: 2020 2020 2020 2020 2020 2020 696e 7465              inte
-0000b9b0: 7270 7265 7461 7469 6f6e 2e61 7070 656e  rpretation.appen
-0000b9c0: 6428 2870 6169 725b 305d 2c20 7061 6972  d((pair[0], pair
-0000b9d0: 5b31 5d2c 2070 6169 725b 325d 2c20 7465  [1], pair[2], te
-0000b9e0: 6d70 7469 6d65 7374 616d 7029 290a 2020  mptimestamp)).  
-0000b9f0: 2020 2020 2020 2020 2020 2320 666f 7220            # for 
-0000ba00: 7265 616c 2076 616c 7565 2073 6572 6965  real value serie
-0000ba10: 730a 2020 2020 2020 2020 2020 2020 656c  s.            el
-0000ba20: 6966 206c 656e 2873 6574 2863 6f6e 7465  if len(set(conte
-0000ba30: 7874 2e43 445b 7061 6972 5b30 5d5d 2929  xt.CD[pair[0]]))
-0000ba40: 2026 6774 3b20 323a 0a20 2020 2020 2020   &gt; 2:.       
-0000ba50: 2020 2020 2020 2020 2074 656d 7074 696d           temptim
-0000ba60: 6573 7461 6d70 203d 2063 6f6e 7465 7874  estamp = context
-0000ba70: 2e74 696d 6573 7461 6d70 0a20 2020 2020  .timestamp.     
-0000ba80: 2020 2020 2020 2020 2020 206c 6173 7463             lastc
-0000ba90: 6f6e 7465 7874 203d 2073 656c 662e 636f  ontext = self.co
-0000baa0: 6e74 6578 7473 5b6d 6178 286c 656e 2873  ntexts[max(len(s
-0000bab0: 656c 662e 636f 6e74 6578 7473 2920 2d20  elf.contexts) - 
-0000bac0: 322c 2030 295d 0a20 2020 2020 2020 2020  2, 0)].         
-0000bad0: 2020 2020 2020 2066 6f72 2069 6e74 6572         for inter
-0000bae0: 7061 6972 2069 6e20 6c61 7374 636f 6e74  pair in lastcont
-0000baf0: 6578 742e 4352 5b26 2333 343b 696e 7465  ext.CR[&#34;inte
-0000bb00: 7270 7265 7461 7469 6f6e 2623 3334 3b5d  rpretation&#34;]
-0000bb10: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0000bb20: 2020 2020 2020 6966 2069 6e74 6572 7061        if interpa
-0000bb30: 6972 5b30 5d20 3d3d 2070 6169 725b 305d  ir[0] == pair[0]
-0000bb40: 2061 6e64 2069 6e74 6572 7061 6972 5b31   and interpair[1
-0000bb50: 5d20 3d3d 2070 6169 725b 315d 3a0a 2020  ] == pair[1]:.  
-0000bb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000bb70: 2020 2020 2020 7465 6d70 7469 6d65 7374        temptimest
-0000bb80: 616d 7020 3d20 696e 7465 7270 6169 725b  amp = interpair[
-0000bb90: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
-0000bba0: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
-0000bbb0: 6e2e 6170 7065 6e64 2828 7061 6972 5b30  n.append((pair[0
-0000bbc0: 5d2c 2070 6169 725b 315d 2c20 7061 6972  ], pair[1], pair
-0000bbd0: 5b32 5d2c 2074 656d 7074 696d 6573 7461  [2], temptimesta
-0000bbe0: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
-0000bbf0: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-0000bc00: 2020 2020 2020 2320 736f 7274 2077 6974        # sort wit
-0000bc10: 6820 7469 6d65 0a20 2020 2020 2020 2066  h time.        f
-0000bc20: 696e 7465 7270 7265 7420 3d20 5b5d 0a20  interpret = []. 
-0000bc30: 2020 2020 2020 2066 6f72 2070 6169 7220         for pair 
-0000bc40: 696e 2069 6e74 6572 7072 6574 6174 696f  in interpretatio
-0000bc50: 6e3a 0a20 2020 2020 2020 2020 2020 2066  n:.            f
-0000bc60: 696e 7465 7270 7265 742e 6170 7065 6e64  interpret.append
-0000bc70: 2828 7061 6972 5b30 5d2c 2070 6169 725b  ((pair[0], pair[
-0000bc80: 315d 2c20 7061 6972 5b32 5d2c 2070 6169  1], pair[2], pai
-0000bc90: 725b 335d 2929 0a20 2020 2020 2020 2066  r[3])).        f
-0000bca0: 696e 7465 7270 7265 742e 736f 7274 286b  interpret.sort(k
-0000bcb0: 6579 3d6c 616d 6264 6120 7475 703a 2074  ey=lambda tup: t
-0000bcc0: 7570 5b33 5d29 2020 2320 736f 7274 7320  up[3])  # sorts 
-0000bcd0: 696e 2070 6c61 6365 0a20 2020 2020 2020  in place.       
-0000bce0: 2072 6574 7572 6e20 6669 6e74 6572 7072   return finterpr
-0000bcf0: 6574 0a0a 2020 2020 6465 6620 6372 6561  et..    def crea
-0000bd00: 7465 5f63 6f6e 7465 7874 2873 656c 662c  te_context(self,
-0000bd10: 2063 7572 7265 6e74 3a20 4576 656e 7470   current: Eventp
-0000bd20: 6f69 6e74 2c20 6275 6666 6572 293a 0a20  oint, buffer):. 
-0000bd30: 2020 2020 2020 2026 2333 343b 2623 3334         &#34;&#34
-0000bd40: 3b26 2333 343b 0a20 2020 2020 2020 2054  ;&#34;.        T
-0000bd50: 7261 6e73 666f 726d 2074 6865 2064 6174  ransform the dat
-0000bd60: 6120 636f 6c6c 6563 7465 6420 746f 2074  a collected to t
-0000bd70: 6865 2062 7566 6665 7220 696e 2074 6f20  he buffer in to 
-0000bd80: 7375 6974 6162 6c65 2066 6f72 6d20 616e  suitable form an
-0000bd90: 6420 6765 6e65 7261 7465 7320 7468 6520  d generates the 
-0000bda0: 4344 2070 6172 7420 6f66 2074 6865 2063  CD part of the c
-0000bdb0: 6f6e 7465 7874 2061 6c6f 6e67 2077 6974  ontext along wit
-0000bdc0: 680a 2020 2020 2020 2020 7468 6520 6564  h.        the ed
-0000bdd0: 6765 7320 616e 6420 6368 6172 6163 7465  ges and characte
-0000bde0: 7269 7a61 7469 6f6e 733a 0a0a 2020 2020  rizations:..    
-0000bdf0: 2020 2020 2a2a 5374 6570 733a 2a2a 0a0a      **Steps:**..
-0000be00: 2020 2020 2020 2020 2a2a 4372 6561 7465          **Create
-0000be10: 2043 442a 2a3a 2050 6172 616c 6c65 6c20   CD**: Parallel 
-0000be20: 636f 6e74 696e 756f 7573 2072 6570 7265  continuous repre
-0000be30: 7365 6e74 6174 696f 6e73 206f 6620 616c  sentations of al
-0000be40: 6c20 6469 6666 6572 656e 7420 736f 7572  l different sour
-0000be50: 6365 7320 696e 2074 6865 2062 7566 6665  ces in the buffe
-0000be60: 722e 0a20 2020 2020 2020 2054 6869 7320  r..        This 
-0000be70: 7374 6570 2069 6e76 6f6c 7665 732c 206d  step involves, m
-0000be80: 6174 6368 696e 6720 7468 6520 6469 6666  atching the diff
-0000be90: 6572 656e 7420 7361 6d70 6c65 2072 6174  erent sample rat
-0000bea0: 6573 206f 6620 6469 6666 6572 656e 7420  es of different 
-0000beb0: 736f 7572 6365 7320 746f 2074 6861 7420  sources to that 
-0000bec0: 6f66 2074 6865 2074 6172 6765 742e 0a20  of the target.. 
-0000bed0: 2020 2020 2020 2054 7261 6e73 666f 726d         Transform
-0000bee0: 2074 6865 2045 7665 6e74 2073 6f75 7263   the Event sourc
-0000bef0: 6573 2074 6f20 636f 6e74 696e 756f 7573  es to continuous
-0000bf00: 2072 6570 7265 7365 6e74 6174 696f 6e2e   representation.
-0000bf10: 0a20 2020 2020 2020 200a 2020 2020 2020  .        .      
-0000bf20: 2020 2a2a 4361 6c63 756c 6174 6520 4361    **Calculate Ca
-0000bf30: 7573 616c 6974 7920 6564 6765 732a 2a3a  usality edges**:
-0000bf40: 2050 6572 666f 726d 2043 6175 7361 6c20   Perform Causal 
-0000bf50: 4469 7363 6f76 6572 7920 7573 696e 6720  Discovery using 
-0000bf60: 7468 6520 6361 7573 616c 6974 7920 6675  the causality fu
-0000bf70: 6e63 7469 6f6e 2c20 746f 2063 7265 6174  nction, to creat
-0000bf80: 6520 6564 6765 7320 0a20 2020 2020 2020  e edges .       
-0000bf90: 2028 7061 7274 206f 6620 4352 206f 6620   (part of CR of 
-0000bfa0: 7468 6520 436f 6e74 6578 7429 0a20 2020  the Context).   
-0000bfb0: 2020 2020 200a 2020 2020 2020 2020 2a2a       .        **
-0000bfc0: 5461 6720 6561 6368 2065 6467 6520 7769  Tag each edge wi
-0000bfd0: 7468 2063 6861 7261 6374 6572 697a 6174  th characterizat
-0000bfe0: 696f 6e2a 2a3a 2066 6f72 2065 6163 6820  ion**: for each 
-0000bff0: 2861 2c62 2920 696e 2074 6865 2065 6467  (a,b) in the edg
-0000c000: 6573 2c20 6120 6368 6172 6163 7465 7269  es, a characteri
-0000c010: 7a61 7469 6f6e 206f 6620 2875 6e6b 6e6f  zation of (unkno
-0000c020: 776e 2c20 6465 6372 6561 7365 2c0a 2020  wn, decrease,.  
-0000c030: 2020 2020 2020 2069 6e63 7265 6173 6529         increase)
-0000c040: 2c20 6261 7365 6420 6f6e 2074 6865 2074  , based on the t
-0000c050: 7970 6520 6f66 2074 6865 2061 2e0a 0a20  ype of the a... 
-0000c060: 2020 2020 2020 2020 2a2a 5061 7261 6d65          **Parame
-0000c070: 7465 7273 2a2a 3a0a 0a20 2020 2020 2020  ters**:..       
-0000c080: 2020 2a2a 6375 7272 656e 742a 2a3a 2054    **current**: T
-0000c090: 6865 2063 7572 7265 6e74 2045 7665 6e74  he current Event
-0000c0a0: 206f 6620 7461 7267 6574 2623 3339 3b73   of target&#39;s
-0000c0b0: 2064 6174 6120 7768 6963 6820 7472 6967   data which trig
-0000c0c0: 6572 2074 6865 2063 6f6e 7465 7874 2063  er the context c
-0000c0d0: 7265 6174 696f 6e0a 0a20 2020 2020 2020  reation..       
-0000c0e0: 2020 2a2a 6275 6666 6572 2a2a 3a20 6f72    **buffer**: or
-0000c0f0: 6465 7265 6420 6c69 7374 2077 6974 6820  dered list with 
-0000c100: 4576 656e 7470 6f69 6e74 206f 6620 616c  Eventpoint of al
-0000c110: 6c20 736f 7572 6365 732e 0a0a 2020 2020  l sources...    
-0000c120: 2020 2020 202a 2a72 6574 7572 6e2a 2a3a       **return**:
-0000c130: 2043 6f6e 7465 7874 206f 626a 6563 742e   Context object.
-0000c140: 0a20 2020 2020 2020 2026 2333 343b 2623  .        &#34;&#
-0000c150: 3334 3b26 2333 343b 0a20 2020 2020 2020  34;&#34;.       
-0000c160: 2023 2073 7461 7274 203d 2074 696d 652e   # start = time.
-0000c170: 7469 6d65 2829 0a20 2020 2020 2020 2023  time().        #
-0000c180: 2064 6620 7769 7468 202c 6474 2c63 6f64   df with ,dt,cod
-0000c190: 652c 736f 7572 6365 2c76 616c 7565 0a20  e,source,value. 
-0000c1a0: 2020 2020 2020 2070 6f73 203d 2073 656c         pos = sel
-0000c1b0: 662e 636f 6e74 6578 745f 706f 730a 2020  f.context_pos.  
-0000c1c0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-0000c1d0: 616e 6765 2870 6f73 2c20 6c65 6e28 6275  ange(pos, len(bu
-0000c1e0: 6666 6572 2929 3a0a 2020 2020 2020 2020  ffer)):.        
-0000c1f0: 2020 2020 6966 2062 7566 6665 725b 695d      if buffer[i]
-0000c200: 2e74 696d 6573 7461 6d70 2026 6c74 3b3d  .timestamp &lt;=
-0000c210: 2028 6375 7272 656e 742e 7469 6d65 7374   (current.timest
-0000c220: 616d 7020 2d20 7064 2e54 696d 6564 656c  amp - pd.Timedel
-0000c230: 7461 2873 656c 662e 686f 7269 7a6f 6e2c  ta(self.horizon,
-0000c240: 2073 656c 662e 686f 7269 7a6f 6e5f 7469   self.horizon_ti
-0000c250: 6d65 2929 3a0a 2020 2020 2020 2020 2020  me)):.          
-0000c260: 2020 2020 2020 706f 7320 3d20 690a 2020        pos = i.  
-0000c270: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000c280: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c290: 6272 6561 6b0a 0a20 2020 2020 2020 2073  break..        s
-0000c2a0: 656c 662e 636f 6e74 6578 745f 706f 7320  elf.context_pos 
-0000c2b0: 3d20 706f 730a 2020 2020 2020 2020 2320  = pos.        # 
-0000c2c0: 656e 643d 7469 6d65 2e74 696d 6528 290a  end=time.time().
-0000c2d0: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
-0000c2e0: 6626 2333 343b 6669 6e64 2070 6f73 6974  f&#34;find posit
-0000c2f0: 696f 6e20 6f6e 2062 7566 6665 723a 207b  ion on buffer: {
-0000c300: 656e 642d 7374 6172 747d 2623 3334 3b29  end-start}&#34;)
-0000c310: 0a0a 2020 2020 2020 2020 2320 7374 6172  ..        # star
-0000c320: 7420 3d20 7469 6d65 2e74 696d 6528 290a  t = time.time().
-0000c330: 2020 2020 2020 2020 6461 7461 666f 7263          dataforc
-0000c340: 6f6e 7465 7874 203d 2062 7566 6665 725b  ontext = buffer[
-0000c350: 706f 733a 5d0a 2020 2020 2020 2020 6461  pos:].        da
-0000c360: 7461 746f 6466 203d 205b 5b70 642e 746f  tatodf = [[pd.to
-0000c370: 5f64 6174 6574 696d 6528 652e 7469 6d65  _datetime(e.time
-0000c380: 7374 616d 7029 2066 6f72 2065 2069 6e20  stamp) for e in 
-0000c390: 6461 7461 666f 7263 6f6e 7465 7874 5d2c  dataforcontext],
-0000c3a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000c3b0: 2020 2020 205b 7374 7228 652e 636f 6465       [str(e.code
-0000c3c0: 2920 666f 7220 6520 696e 2064 6174 6166  ) for e in dataf
-0000c3d0: 6f72 636f 6e74 6578 745d 2c0a 2020 2020  orcontext],.    
-0000c3e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c3f0: 5b73 7472 2865 2e73 6f75 7263 6529 2066  [str(e.source) f
-0000c400: 6f72 2065 2069 6e20 6461 7461 666f 7263  or e in dataforc
-0000c410: 6f6e 7465 7874 5d2c 0a20 2020 2020 2020  ontext],.       
-0000c420: 2020 2020 2020 2020 2020 2020 205b 652e               [e.
-0000c430: 6465 7461 696c 7320 666f 7220 6520 696e  details for e in
-0000c440: 2064 6174 6166 6f72 636f 6e74 6578 745d   dataforcontext]
-0000c450: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-0000c460: 2020 2020 2020 5b65 2e74 7970 6520 666f        [e.type fo
-0000c470: 7220 6520 696e 2064 6174 6166 6f72 636f  r e in dataforco
-0000c480: 6e74 6578 745d 5d0a 0a20 2020 2020 2020  ntext]]..       
-0000c490: 206e 7063 6f6e 7465 7874 203d 206e 702e   npcontext = np.
-0000c4a0: 6172 7261 7928 6461 7461 746f 6466 290a  array(datatodf).
-0000c4b0: 2020 2020 2020 2020 6e70 636f 6e74 6578          npcontex
-0000c4c0: 7420 3d20 6e70 636f 6e74 6578 742e 540a  t = npcontext.T.
-0000c4d0: 0a20 2020 2020 2020 206e 7063 6f6e 7465  .        npconte
-0000c4e0: 7874 203d 2073 656c 662e 4e75 6d70 795f  xt = self.Numpy_
-0000c4f0: 7072 6570 726f 6363 6573 7328 6e70 636f  preproccess(npco
-0000c500: 6e74 6578 7429 0a0a 2020 2020 2020 2020  ntext)..        
-0000c510: 2320 656e 6420 3d20 7469 6d65 2e74 696d  # end = time.tim
-0000c520: 6528 290a 2020 2020 2020 2020 2320 7072  e().        # pr
-0000c530: 696e 7428 6626 2333 343b 7072 6570 726f  int(f&#34;prepro
-0000c540: 6365 7373 2064 663a 207b 656e 6420 2d20  cess df: {end - 
-0000c550: 7374 6172 747d 2623 3334 3b29 0a20 2020  start}&#34;).   
-0000c560: 2020 2020 2023 2323 2323 2323 2323 2323       ###########
-0000c570: 2323 2063 7265 6174 6520 636f 6e74 6578  ## create contex
-0000c580: 7420 2323 2323 2323 2323 2323 2323 2323  t ##############
-0000c590: 2323 2323 2323 2323 2323 2323 2323 0a20  ##############. 
-0000c5a0: 2020 2020 2020 2023 2073 7461 7274 203d         # start =
-0000c5b0: 2074 696d 652e 7469 6d65 2829 0a20 2020   time.time().   
-0000c5c0: 2020 2020 2023 2320 636f 6c6c 6563 7420       ## collect 
-0000c5d0: 756e 6971 6575 2064 6174 6120 7365 7269  uniqeu data seri
-0000c5e0: 6573 0a20 2020 2020 2020 2023 2061 6c6c  es.        # all
-0000c5f0: 636f 6465 7320 3d20 6466 5b26 2333 393b  codes = df[&#39;
-0000c600: 636f 6465 2623 3339 3b5d 2e75 6e69 7175  code&#39;].uniqu
-0000c610: 6528 290a 2020 2020 2020 2020 616c 6c63  e().        allc
-0000c620: 6f64 6573 203d 206e 702e 756e 6971 7565  odes = np.unique
-0000c630: 286e 7063 6f6e 7465 7874 5b3a 2c20 315d  (npcontext[:, 1]
-0000c640: 290a 2020 2020 2020 2020 616c 6c63 6f64  ).        allcod
-0000c650: 6573 203d 205b 636f 6465 2066 6f72 2063  es = [code for c
-0000c660: 6f64 6520 696e 2061 6c6c 636f 6465 735d  ode in allcodes]
-0000c670: 0a20 2020 2020 2020 2061 6c6c 636f 6465  .        allcode
-0000c680: 7320 3d20 7365 7428 616c 6c63 6f64 6573  s = set(allcodes
-0000c690: 290a 0a20 2020 2020 2020 2066 6f72 2075  )..        for u
-0000c6a0: 6e63 6f64 6520 696e 2061 6c6c 636f 6465  ncode in allcode
-0000c6b0: 733a 0a20 2020 2020 2020 2020 2020 2066  s:.            f
-0000c6c0: 6f72 2071 7120 696e 2072 616e 6765 286c  or qq in range(l
-0000c6d0: 656e 286e 7063 6f6e 7465 7874 2929 3a0a  en(npcontext)):.
-0000c6e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c6f0: 6966 2075 6e63 6f64 6520 696e 206e 7063  if uncode in npc
-0000c700: 6f6e 7465 7874 5b71 715d 5b31 5d3a 0a20  ontext[qq][1]:. 
-0000c710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c720: 2020 2073 656c 662e 7479 7065 5f6f 665f     self.type_of_
-0000c730: 7365 7269 6573 5b75 6e63 6f64 655d 203d  series[uncode] =
-0000c740: 206e 7063 6f6e 7465 7874 5b71 715d 5b34   npcontext[qq][4
-0000c750: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000c760: 2020 2020 2020 6272 6561 6b0a 0a20 2020        break..   
-0000c770: 2020 2020 2023 2320 6275 696c 6420 7461       ## build ta
-0000c780: 7267 6574 2073 6572 6965 730a 2020 2020  rget series.    
-0000c790: 2020 2020 7461 7267 6574 5f73 6572 6965      target_serie
-0000c7a0: 735f 6e61 6d65 2c20 7461 7267 6574 5f73  s_name, target_s
-0000c7b0: 6572 6965 7320 3d20 7365 6c66 2e62 7569  eries = self.bui
-0000c7c0: 6c64 5f74 6172 6765 745f 7365 7269 6573  ld_target_series
-0000c7d0: 5f66 6f72 5f63 6f6e 7465 7874 2863 7572  _for_context(cur
-0000c7e0: 7265 6e74 2c20 6e70 636f 6e74 6578 7429  rent, npcontext)
-0000c7f0: 0a0a 2020 2020 2020 2020 2323 2063 7265  ..        ## cre
-0000c800: 6174 6520 7365 7269 6573 2066 6f72 2065  ate series for e
-0000c810: 6163 6820 736f 7572 6365 2028 616c 6c64  ach source (alld
-0000c820: 6174 6129 0a20 2020 2020 2020 2061 6c6c  ata).        all
-0000c830: 6461 7461 203d 2073 656c 662e 6372 6561  data = self.crea
-0000c840: 7465 5f63 6f6e 7469 6e75 6f75 735f 7265  te_continuous_re
-0000c850: 7072 6573 656e 7461 7469 6f6e 2874 6172  presentation(tar
-0000c860: 6765 745f 7365 7269 6573 5f6e 616d 652c  get_series_name,
-0000c870: 2074 6172 6765 745f 7365 7269 6573 2c20   target_series, 
-0000c880: 6e70 636f 6e74 6578 742c 0a20 2020 2020  npcontext,.     
-0000c890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000c8c0: 2020 2073 656c 662e 7479 7065 5f6f 665f     self.type_of_
-0000c8d0: 7365 7269 6573 2c20 616c 6c63 6f64 6573  series, allcodes
-0000c8e0: 290a 2020 2020 2020 2020 2320 656e 6420  ).        # end 
-0000c8f0: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-0000c900: 2020 2020 2020 2320 7072 696e 7428 6626        # print(f&
-0000c910: 2333 343b 4372 6561 7465 2073 6572 6965  #34;Create serie
-0000c920: 733a 207b 656e 642d 7374 6172 747d 2623  s: {end-start}&#
-0000c930: 3334 3b29 0a0a 2020 2020 2020 2020 7374  34;)..        st
-0000c940: 6f72 696e 6720 3d20 7365 6c66 2e63 616c  oring = self.cal
-0000c950: 6375 6c61 7465 5f65 6467 6573 2861 6c6c  culate_edges(all
-0000c960: 6461 7461 2c20 6375 7272 656e 742e 7469  data, current.ti
-0000c970: 6d65 7374 616d 7029 0a20 2020 2020 2020  mestamp).       
-0000c980: 2073 746f 7269 6e67 5b26 2333 343b 6368   storing[&#34;ch
-0000c990: 6172 6163 7465 7269 7a61 7469 6f6e 2623  aracterization&#
-0000c9a0: 3334 3b5d 203d 2073 656c 662e 6765 745f  34;] = self.get_
-0000c9b0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
-0000c9c0: 2873 746f 7269 6e67 290a 0a20 2020 2020  (storing)..     
-0000c9d0: 2020 2023 2070 7269 6e74 2866 2623 3334     # print(f&#34
-0000c9e0: 3b43 616c 6375 6c61 7465 2065 6467 6573  ;Calculate edges
-0000c9f0: 3a20 7b65 6e64 202d 2073 7461 7274 7d26  : {end - start}&
-0000ca00: 2333 343b 290a 2020 2020 2020 2020 2320  #34;).        # 
-0000ca10: 7072 696e 7428 2623 3334 3b3d 3d3d 3d3d  print(&#34;=====
-0000ca20: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
-0000ca30: 3d3d 3d26 2333 343b 290a 0a20 2020 2020  ===&#34;)..     
-0000ca40: 2020 2063 6f6e 7465 7874 7062 6a65 6374     contextpbject
-0000ca50: 203d 2043 6f6e 7465 7874 2e63 6f6e 7465   = Context.conte
-0000ca60: 7874 5f66 726f 6d5f 6469 6374 2873 746f  xt_from_dict(sto
-0000ca70: 7269 6e67 290a 2020 2020 2020 2020 7265  ring).        re
-0000ca80: 7475 726e 2063 6f6e 7465 7874 7062 6a65  turn contextpbje
-0000ca90: 6374 2c20 7461 7267 6574 5f73 6572 6965  ct, target_serie
-0000caa0: 735f 6e61 6d65 0a0a 2020 2020 6465 6620  s_name..    def 
-0000cab0: 6765 745f 6368 6172 6163 7465 7269 7a61  get_characteriza
-0000cac0: 7469 6f6e 2873 656c 662c 2063 6f6e 7465  tion(self, conte
-0000cad0: 7874 293a 0a20 2020 2020 2020 2026 2333  xt):.        &#3
-0000cae0: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
-0000caf0: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
-0000cb00: 2063 616c 6375 6c61 7465 2074 6865 2063   calculate the c
-0000cb10: 6861 7261 6374 6572 697a 6174 696f 6e73  haracterizations
-0000cb20: 206f 6620 2861 2c62 2920 6564 6765 7320   of (a,b) edges 
-0000cb30: 746f 2063 6861 7261 6374 6572 697a 6520  to characterize 
-0000cb40: 7468 6520 696e 666c 7565 6e63 6520 6f66  the influence of
-0000cb50: 2061 2069 6e20 6220 6279 206f 6e65 206f   a in b by one o
-0000cb60: 6620 7468 650a 2020 2020 2020 2020 7468  f the.        th
-0000cb70: 7265 6520 6368 6172 6163 7465 7269 7a61  ree characteriza
-0000cb80: 7469 6f6e 733a 2075 6e6b 6e6f 776e 2c20  tions: unknown, 
-0000cb90: 6465 6372 6561 7365 2c20 696e 6372 6561  decrease, increa
-0000cba0: 7365 2e0a 0a20 2020 2020 2020 2054 6865  se...        The
-0000cbb0: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
-0000cbc0: 6e20 6973 2063 616c 6375 6c61 7465 6420  n is calculated 
-0000cbd0: 6469 6666 6572 656e 746c 7920 666f 7220  differently for 
-0000cbe0: 6576 656e 7420 616e 6420 636f 6e74 696e  event and contin
-0000cbf0: 756f 7573 2064 6174 612e 0a20 2020 2020  uous data..     
-0000cc00: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
-0000cc10: 2a3a 0a0a 2020 2020 2020 2020 2a2a 636f  *:..        **co
-0000cc20: 6e74 6578 742a 2a3a 2064 6963 7469 6f6e  ntext**: diction
-0000cc30: 6172 7920 7769 7468 2061 206b 7965 2026  ary with a kye &
-0000cc40: 2333 393b 6564 6765 7326 2333 393b 2066  #39;edges&#39; f
-0000cc50: 6f72 2077 6869 6368 2061 2070 6172 616c  or which a paral
-0000cc60: 6c65 6c20 6c69 7374 206f 6620 6368 6172  lel list of char
-0000cc70: 6163 7465 7269 7a61 7469 6f6e 7320 7769  acterizations wi
-0000cc80: 6c6c 2062 6520 6372 6561 7465 642e 0a20  ll be created.. 
-0000cc90: 2020 2020 2020 2026 2333 343b 2623 3334         &#34;&#34
-0000cca0: 3b26 2333 343b 0a20 2020 2020 2020 2065  ;&#34;.        e
-0000ccb0: 6467 6573 203d 2063 6f6e 7465 7874 5b26  dges = context[&
-0000ccc0: 2333 343b 6564 6765 7326 2333 343b 5d0a  #34;edges&#34;].
-0000ccd0: 2020 2020 2020 2020 6368 6172 6163 7465          characte
-0000cce0: 7269 7a61 7469 6f6e 7320 3d20 5b5d 0a20  rizations = []. 
-0000ccf0: 2020 2020 2020 2066 6f72 2065 6467 6520         for edge 
-0000cd00: 696e 2065 6467 6573 3a0a 2020 2020 2020  in edges:.      
-0000cd10: 2020 2020 2020 6966 2073 656c 662e 7461        if self.ta
-0000cd20: 7267 6574 2069 6e20 6564 6765 5b30 5d3a  rget in edge[0]:
-0000cd30: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000cd40: 2063 6861 7220 3d20 7365 6c66 2e63 6861   char = self.cha
-0000cd50: 7261 6374 6572 697a 655f 6576 656e 745f  racterize_event_
-0000cd60: 636f 6e74 696e 756f 7573 2863 6f6e 7465  continuous(conte
-0000cd70: 7874 2c20 6564 6765 290a 2020 2020 2020  xt, edge).      
-0000cd80: 2020 2020 2020 656c 6966 2073 656c 662e        elif self.
-0000cd90: 7479 7065 5f6f 665f 7365 7269 6573 5b65  type_of_series[e
-0000cda0: 6467 655b 305d 5d20 3d3d 2026 2333 343b  dge[0]] == &#34;
-0000cdb0: 6973 6f6c 6174 696f 6e26 2333 343b 206f  isolation&#34; o
-0000cdc0: 7220 7365 6c66 2e74 7970 655f 6f66 5f73  r self.type_of_s
-0000cdd0: 6572 6965 735b 6564 6765 5b30 5d5d 203d  eries[edge[0]] =
-0000cde0: 3d20 2623 3334 3b63 6f6e 6669 6775 7261  = &#34;configura
-0000cdf0: 7469 6f6e 2623 3334 3b3a 0a20 2020 2020  tion&#34;:.     
-0000ce00: 2020 2020 2020 2020 2020 2063 6861 7220             char 
-0000ce10: 3d20 7365 6c66 2e63 6861 7261 6374 6572  = self.character
-0000ce20: 697a 655f 6576 656e 745f 6564 6765 2863  ize_event_edge(c
-0000ce30: 6f6e 7465 7874 2c20 6564 6765 290a 2020  ontext, edge).  
-0000ce40: 2020 2020 2020 2020 2020 656c 7365 3a0a            else:.
-0000ce50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ce60: 6368 6172 203d 2073 656c 662e 6368 6172  char = self.char
-0000ce70: 6163 7465 7269 7a65 5f65 7665 6e74 5f63  acterize_event_c
-0000ce80: 6f6e 7469 6e75 6f75 7328 636f 6e74 6578  ontinuous(contex
-0000ce90: 742c 2065 6467 6529 0a20 2020 2020 2020  t, edge).       
-0000cea0: 2020 2020 2063 6861 7261 6374 6572 697a       characteriz
-0000ceb0: 6174 696f 6e73 2e61 7070 656e 6428 6368  ations.append(ch
-0000cec0: 6172 290a 2020 2020 2020 2020 7265 7475  ar).        retu
-0000ced0: 726e 2063 6861 7261 6374 6572 697a 6174  rn characterizat
-0000cee0: 696f 6e73 0a0a 2020 2020 6465 6620 6368  ions..    def ch
-0000cef0: 6172 6163 7465 7269 7a65 5f65 7665 6e74  aracterize_event
-0000cf00: 5f65 6467 6528 7365 6c66 2c20 636f 6e74  _edge(self, cont
-0000cf10: 6578 742c 2065 6467 6529 3a0a 2020 2020  ext, edge):.    
-0000cf20: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
-0000cf30: 3334 3b0a 2020 2020 2020 2020 5468 6973  34;.        This
-0000cf40: 206d 6574 686f 6420 6368 6172 6163 7465   method characte
-0000cf50: 7269 7a65 7320 7468 6520 6564 6765 2028  rizes the edge (
-0000cf60: 612c 6229 2077 6865 6e20 6120 6973 2069  a,b) when a is i
-0000cf70: 736f 6c61 7465 6420 6f72 2063 6f6e 6669  solated or confi
-0000cf80: 6775 7261 7469 6f6e 2065 7665 6e74 2e0a  guration event..
-0000cf90: 2020 2020 2020 2020 546f 2064 6f20 7468          To do th
-0000cfa0: 6973 2c20 6974 2064 6574 6563 7473 2074  is, it detects t
-0000cfb0: 6865 206c 6173 7420 6f63 6375 7272 656e  he last occurren
-0000cfc0: 6365 206f 6620 6120 616e 6420 7370 6c69  ce of a and spli
-0000cfd0: 7420 7468 6520 6461 7461 206f 6620 7365  t the data of se
-0000cfe0: 7269 6573 2061 2061 6e64 2073 6572 6965  ries a and serie
-0000cff0: 7320 6220 6261 7365 6420 6f6e 2074 6861  s b based on tha
-0000d000: 742e 0a20 2020 2020 2020 2054 6865 6e20  t..        Then 
-0000d010: 6368 6563 6b73 2069 6620 7468 6520 6d65  checks if the me
-0000d020: 6469 616e 206f 6620 6220 6166 7465 7220  dian of b after 
-0000d030: 7468 6520 6f63 6375 7272 656e 6365 2069  the occurrence i
-0000d040: 7320 6174 206c 6172 6765 7220 7468 616e  s at larger than
-0000d050: 2074 6865 206d 6564 6961 6e20 6220 6265   the median b be
-0000d060: 666f 7265 0a20 2020 2020 2020 2070 6c75  fore.        plu
-0000d070: 7320 7477 6f20 7469 6d65 7320 7468 6520  s two times the 
-0000d080: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
-0000d090: 6f6e 206f 6620 6220 7365 7269 6573 2062  on of b series b
-0000d0a0: 6566 6f72 6520 7468 6520 6f63 6375 7272  efore the occurr
-0000d0b0: 656e 6365 2e0a 2020 2020 2020 2020 4966  ence..        If
-0000d0c0: 2074 6861 7420 6973 2074 7275 6520 7468   that is true th
-0000d0d0: 656e 2069 7320 6368 6172 6163 7465 7269  en is characteri
-0000d0e0: 7a65 6420 6173 2069 6e63 7265 6173 652e  zed as increase.
-0000d0f0: 2045 6c73 6520 6974 2069 7320 6368 6563   Else it is chec
-0000d100: 6b65 6420 666f 7220 7468 6520 6f70 706f  ked for the oppo
-0000d110: 7369 7465 2c20 2869 6620 6974 2069 7320  site, (if it is 
-0000d120: 736d 616c 6c65 720a 2020 2020 2020 2020  smaller.        
-0000d130: 666f 7220 6174 206c 6561 7374 2032 2074  for at least 2 t
-0000d140: 696d 6573 2074 6865 2073 7461 6e64 6172  imes the standar
-0000d150: 6420 6465 7669 6174 696f 6e20 6f66 2062  d deviation of b
-0000d160: 2920 616e 6420 6368 6172 6163 7465 7269  ) and characteri
-0000d170: 7a65 6420 6173 2064 6563 7265 6173 652e  zed as decrease.
-0000d180: 204f 7468 6572 7769 7365 2c20 6973 2063   Otherwise, is c
-0000d190: 6861 7261 6374 6572 697a 6564 2061 730a  haracterized as.
-0000d1a0: 2020 2020 2020 2020 2075 6e6b 6e6f 776e           unknown
-0000d1b0: 2e0a 0a20 2020 2020 2020 202a 2a50 6172  ...        **Par
-0000d1c0: 616d 6574 6572 732a 2a3a 0a0a 2020 2020  ameters**:..    
-0000d1d0: 2020 2020 2a2a 636f 6e74 6578 742a 2a3a      **context**:
-0000d1e0: 2074 6861 7420 7468 6520 6564 6765 2074   that the edge t
-0000d1f0: 6f20 6265 2063 6861 7261 6374 6572 697a  o be characteriz
-0000d200: 6564 2062 656c 6f6e 6773 2e0a 0a20 2020  ed belongs...   
-0000d210: 2020 2020 202a 2a65 6467 652a 2a3a 2041       **edge**: A
-0000d220: 2074 7570 6c65 2028 612c 6229 2077 6865   tuple (a,b) whe
-0000d230: 7265 2061 2069 7320 6973 6f6c 6174 6564  re a is isolated
-0000d240: 206f 7220 636f 6e66 6967 7572 6174 696f   or configuratio
-0000d250: 6e20 6576 656e 742e 0a0a 2020 2020 2020  n event...      
-0000d260: 2020 2a2a 7265 7475 726e 2a2a 3a20 4120    **return**: A 
-0000d270: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
-0000d280: 2066 6f72 2074 6865 2065 6467 6520 2875   for the edge (u
-0000d290: 6e6b 6e6f 776e 2c20 6465 6372 6561 7365  nknown, decrease
-0000d2a0: 206f 7220 696e 6372 6561 7365 290a 2020   or increase).  
-0000d2b0: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
-0000d2c0: 2623 3334 3b0a 2020 2020 2020 2020 6e61  &#34;.        na
-0000d2d0: 6d65 3120 3d20 6564 6765 5b30 5d0a 2020  me1 = edge[0].  
-0000d2e0: 2020 2020 2020 6e61 6d65 3220 3d20 6564        name2 = ed
-0000d2f0: 6765 5b31 5d0a 2020 2020 2020 2020 7661  ge[1].        va
-0000d300: 6c75 6573 3120 3d20 636f 6e74 6578 745b  lues1 = context[
-0000d310: 6e61 6d65 315d 0a20 2020 2020 2020 2076  name1].        v
-0000d320: 616c 7565 7332 203d 205b 666c 6f61 7428  alues2 = [float(
-0000d330: 6b61 7469 2920 666f 7220 6b61 7469 2069  kati) for kati i
-0000d340: 6e20 636f 6e74 6578 745b 6e61 6d65 325d  n context[name2]
-0000d350: 5d0a 0a20 2020 2020 2020 206f 6363 7572  ]..        occur
-0000d360: 656e 6365 203d 206c 656e 2876 616c 7565  ence = len(value
-0000d370: 7331 2920 2d20 310a 2020 2020 2020 2020  s1) - 1.        
-0000d380: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-0000d390: 656e 2876 616c 7565 7331 2920 2d20 322c  en(values1) - 2,
-0000d3a0: 2030 2c20 2d31 293a 0a20 2020 2020 2020   0, -1):.       
-0000d3b0: 2020 2020 2069 6620 7661 6c75 6573 315b       if values1[
-0000d3c0: 695d 2021 3d20 7661 6c75 6573 315b 2d31  i] != values1[-1
-0000d3d0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0000d3e0: 2020 206f 6363 7572 656e 6365 203d 2069     occurence = i
-0000d3f0: 202b 2031 0a20 2020 2020 2020 2020 2020   + 1.           
-0000d400: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-0000d410: 2020 2070 7265 7669 7573 6f63 6375 7265     previusoccure
-0000d420: 6e63 6520 3d20 300a 2020 2020 2020 2020  nce = 0.        
-0000d430: 666f 7220 6920 696e 2072 616e 6765 286f  for i in range(o
-0000d440: 6363 7572 656e 6365 202d 2032 2c20 302c  ccurence - 2, 0,
-0000d450: 202d 3129 3a0a 2020 2020 2020 2020 2020   -1):.          
-0000d460: 2020 6966 2076 616c 7565 7331 5b69 5d20    if values1[i] 
-0000d470: 213d 2076 616c 7565 7331 5b6f 6363 7572  != values1[occur
-0000d480: 656e 6365 202d 2031 5d3a 0a20 2020 2020  ence - 1]:.     
-0000d490: 2020 2020 2020 2020 2020 2070 7265 7669             previ
-0000d4a0: 7573 6f63 6375 7265 6e63 6520 3d20 690a  usoccurence = i.
-0000d4b0: 0a20 2020 2020 2020 2069 6620 6f63 6375  .        if occu
-0000d4c0: 7265 6e63 6520 2d20 7072 6576 6975 736f  rence - previuso
-0000d4d0: 6363 7572 656e 6365 2026 6c74 3b20 323a  ccurence &lt; 2:
-0000d4e0: 2020 2320 6f72 206c 656e 2876 616c 7565    # or len(value
-0000d4f0: 7332 292d 6f63 6375 7265 6e63 6526 6c74  s2)-occurence&lt
-0000d500: 3b32 3a0a 2020 2020 2020 2020 2020 2020  ;2:.            
-0000d510: 7265 7475 726e 2026 2333 343b 756e 6b6e  return &#34;unkn
-0000d520: 6f77 6e26 2333 343b 0a20 2020 2020 2020  own&#34;.       
-0000d530: 2076 616c 7565 7332 6265 666f 7265 203d   values2before =
-0000d540: 2076 616c 7565 7332 5b70 7265 7669 7573   values2[previus
-0000d550: 6f63 6375 7265 6e63 653a 6f63 6375 7265  occurence:occure
-0000d560: 6e63 655d 0a20 2020 2020 2020 2023 2073  nce].        # s
-0000d570: 7464 7620 3d20 7374 6174 6973 7469 6373  tdv = statistics
-0000d580: 2e73 7464 6576 2876 616c 7565 7332 6265  .stdev(values2be
-0000d590: 666f 7265 290a 2020 2020 2020 2020 2320  fore).        # 
-0000d5a0: 6d65 616e 203d 2073 7461 7469 7374 6963  mean = statistic
-0000d5b0: 732e 7374 6465 7628 7661 6c75 6573 3262  s.stdev(values2b
-0000d5c0: 6566 6f72 6529 0a20 2020 2020 2020 2023  efore).        #
-0000d5d0: 2076 616c 7565 7332 6265 666f 7265 3d5b   values2before=[
-0000d5e0: 7620 6966 2076 266c 743b 6d65 616e 2b35  v if v&lt;mean+5
-0000d5f0: 2a73 7464 7620 656c 7365 206d 6561 6e20  *stdv else mean 
-0000d600: 666f 7220 7620 696e 2076 616c 7565 7332  for v in values2
-0000d610: 6265 666f 7265 5d0a 0a20 2020 2020 2020  before]..       
-0000d620: 2023 2076 616c 7565 7332 6166 7465 723d   # values2after=
-0000d630: 7661 6c75 6573 325b 6f63 6375 7265 6e63  values2[occurenc
-0000d640: 653a 5d0a 2020 2020 2020 2020 7661 6c75  e:].        valu
-0000d650: 6573 3261 6674 6572 203d 205b 7661 6c75  es2after = [valu
-0000d660: 6573 325b 2d31 5d5d 0a20 2020 2020 2020  es2[-1]].       
-0000d670: 2023 2073 7464 7620 3d20 7374 6174 6973   # stdv = statis
-0000d680: 7469 6373 2e73 7464 6576 2876 616c 7565  tics.stdev(value
-0000d690: 7332 6166 7465 7229 0a20 2020 2020 2020  s2after).       
-0000d6a0: 2023 206d 6561 6e20 3d20 7374 6174 6973   # mean = statis
-0000d6b0: 7469 6373 2e73 7464 6576 2876 616c 7565  tics.stdev(value
-0000d6c0: 7332 6166 7465 7229 0a20 2020 2020 2020  s2after).       
-0000d6d0: 2023 2076 616c 7565 7332 6166 7465 7220   # values2after 
-0000d6e0: 3d20 5b76 2069 6620 7620 266c 743b 206d  = [v if v &lt; m
-0000d6f0: 6561 6e20 2b20 3320 2a20 7374 6476 2065  ean + 3 * stdv e
-0000d700: 6c73 6520 6d65 616e 2066 6f72 2076 2069  lse mean for v i
-0000d710: 6e20 7661 6c75 6573 3261 6674 6572 5d0a  n values2after].
-0000d720: 0a20 2020 2020 2020 2073 7464 7620 3d20  .        stdv = 
-0000d730: 7374 6174 6973 7469 6373 2e73 7464 6576  statistics.stdev
-0000d740: 2876 616c 7565 7332 6265 666f 7265 290a  (values2before).
-0000d750: 2020 2020 2020 2020 6966 206c 656e 2876          if len(v
-0000d760: 616c 7565 7332 6265 666f 7265 2920 3d3d  alues2before) ==
-0000d770: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
-0000d780: 6368 6172 203d 2026 2333 343b 756e 6b6e  char = &#34;unkn
-0000d790: 6f77 6e26 2333 343b 0a20 2020 2020 2020  own&#34;.       
-0000d7a0: 2065 6c69 6620 7374 6174 6973 7469 6373   elif statistics
-0000d7b0: 2e6d 6564 6961 6e28 7661 6c75 6573 3262  .median(values2b
-0000d7c0: 6566 6f72 6529 202d 2073 7461 7469 7374  efore) - statist
-0000d7d0: 6963 732e 6d65 6469 616e 2876 616c 7565  ics.median(value
-0000d7e0: 7332 6166 7465 7229 2026 6774 3b20 3220  s2after) &gt; 2 
-0000d7f0: 2a20 7374 6476 3a0a 2020 2020 2020 2020  * stdv:.        
-0000d800: 2020 2020 6368 6172 203d 2026 2333 343b      char = &#34;
-0000d810: 6465 6372 6561 7365 2623 3334 3b0a 2020  decrease&#34;.  
-0000d820: 2020 2020 2020 656c 6966 2073 7461 7469        elif stati
-0000d830: 7374 6963 732e 6d65 6469 616e 2876 616c  stics.median(val
-0000d840: 7565 7332 6166 7465 7229 202d 2073 7461  ues2after) - sta
-0000d850: 7469 7374 6963 732e 6d65 6469 616e 2876  tistics.median(v
-0000d860: 616c 7565 7332 6265 666f 7265 2920 2667  alues2before) &g
-0000d870: 743b 2032 202a 2073 7464 763a 0a20 2020  t; 2 * stdv:.   
-0000d880: 2020 2020 2020 2020 2063 6861 7220 3d20           char = 
-0000d890: 2623 3334 3b69 6e63 7265 6173 6526 2333  &#34;increase&#3
-0000d8a0: 343b 0a20 2020 2020 2020 2065 6c73 653a  4;.        else:
-0000d8b0: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
-0000d8c0: 7220 3d20 2623 3334 3b75 6e6b 6e6f 776e  r = &#34;unknown
-0000d8d0: 2623 3334 3b0a 2020 2020 2020 2020 7265  &#34;.        re
-0000d8e0: 7475 726e 2063 6861 720a 0a20 2020 2064  turn char..    d
-0000d8f0: 6566 2063 6861 7261 6374 6572 697a 655f  ef characterize_
-0000d900: 6576 656e 745f 636f 6e74 696e 756f 7573  event_continuous
-0000d910: 2873 656c 662c 2063 6f6e 7465 7874 2c20  (self, context, 
-0000d920: 6564 6765 293a 0a20 2020 2020 2020 2026  edge):.        &
-0000d930: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-0000d940: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-0000d950: 6d65 7468 6f64 2063 6861 7261 6374 6572  method character
-0000d960: 697a 6573 2074 6865 2065 6467 6520 2861  izes the edge (a
-0000d970: 2c62 2920 7768 656e 2061 2069 7320 636f  ,b) when a is co
-0000d980: 6e74 696e 756f 7573 2e0a 2020 2020 2020  ntinuous..      
-0000d990: 2020 2020 2020 546f 2064 6f20 7468 6973        To do this
-0000d9a0: 2c20 7468 6520 6465 6c74 6120 6265 7477  , the delta betw
-0000d9b0: 6565 6e20 7468 6520 7469 6d65 7374 616d  een the timestam
-0000d9c0: 7073 206f 6620 7468 6520 7365 7269 6573  ps of the series
-0000d9d0: 2062 2069 7320 6361 6c63 756c 6174 6564   b is calculated
-0000d9e0: 0a20 2020 2020 2020 2020 2020 2028 692e  .            (i.
-0000d9f0: 652e 2074 6865 2064 6966 6665 7265 6e63  e. the differenc
-0000da00: 6520 6265 7477 6565 6e20 6375 7272 656e  e between curren
-0000da10: 7420 616e 6420 6e65 7874 2074 696d 6573  t and next times
-0000da20: 7461 6d70 7329 2e20 4966 2074 6865 2073  tamps). If the s
-0000da30: 756d 6d20 6f66 2074 6865 2064 656c 7461  umm of the delta
-0000da40: 7320 6265 7477 6565 6e20 6220 7365 7269  s between b seri
-0000da50: 6573 2064 6174 612c 2069 730a 2020 2020  es data, is.    
-0000da60: 2020 2020 2020 2020 6772 6561 7465 7220          greater 
-0000da70: 7468 616e 2032 2074 696d 6573 2074 6865  than 2 times the
-0000da80: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-0000da90: 696f 6e20 6f66 2074 6865 2062 2c20 7468  ion of the b, th
-0000daa0: 656e 2074 6865 2069 6e63 7265 6173 6520  en the increase 
-0000dab0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
-0000dac0: 2069 7320 7265 7475 726e 6564 2e20 4966   is returned. If
-0000dad0: 2074 6865 2073 756d 0a20 2020 2020 2020   the sum.       
-0000dae0: 2020 2020 2069 7320 6c6f 7765 7220 7468       is lower th
-0000daf0: 616e 2032 2074 696d 6573 2074 6865 2073  an 2 times the s
-0000db00: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
-0000db10: 6e20 7468 6520 6465 6372 6561 7365 6420  n the decreased 
-0000db20: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
-0000db30: 2069 7320 7265 7475 726e 6564 2e20 4f74   is returned. Ot
-0000db40: 6865 7277 6973 652c 2074 6865 2075 6e6b  herwise, the unk
-0000db50: 6e6f 776e 0a20 2020 2020 2020 2020 2020  nown.           
-0000db60: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
-0000db70: 6e20 6973 2072 6574 7572 6e65 642e 0a0a  n is returned...
-0000db80: 2020 2020 2020 2020 2020 2020 2a2a 5061              **Pa
-0000db90: 7261 6d65 7465 7273 2a2a 3a0a 0a20 2020  rameters**:..   
-0000dba0: 2020 2020 2020 2020 202a 2a63 6f6e 7465           **conte
-0000dbb0: 7874 2a2a 3a20 7468 6174 2074 6865 2065  xt**: that the e
-0000dbc0: 6467 6520 746f 2062 6520 6368 6172 6163  dge to be charac
-0000dbd0: 7465 7269 7a65 6420 6265 6c6f 6e67 732e  terized belongs.
-0000dbe0: 0a0a 2020 2020 2020 2020 2020 2020 2a2a  ..            **
-0000dbf0: 6564 6765 2a2a 3a20 4120 7475 706c 6520  edge**: A tuple 
-0000dc00: 2861 2c62 2920 7768 6572 6520 6120 6973  (a,b) where a is
-0000dc10: 2069 736f 6c61 7465 6420 6f72 2063 6f6e   isolated or con
-0000dc20: 6669 6775 7261 7469 6f6e 2065 7665 6e74  figuration event
-0000dc30: 2e0a 0a20 2020 2020 2020 2020 2020 202a  ...            *
-0000dc40: 2a72 6574 7572 6e2a 2a3a 2041 2063 6861  *return**: A cha
-0000dc50: 7261 6374 6572 697a 6174 696f 6e20 666f  racterization fo
-0000dc60: 7220 7468 6520 6564 6765 2028 756e 6b6e  r the edge (unkn
-0000dc70: 6f77 6e2c 2064 6563 7265 6173 6520 6f72  own, decrease or
-0000dc80: 2069 6e63 7265 6173 6529 0a20 2020 2020   increase).     
-0000dc90: 2020 2026 2333 343b 2623 3334 3b26 2333     &#34;&#34;&#3
-0000dca0: 343b 0a20 2020 2020 2020 206e 616d 6531  4;.        name1
-0000dcb0: 203d 2065 6467 655b 305d 0a20 2020 2020   = edge[0].     
-0000dcc0: 2020 206e 616d 6532 203d 2065 6467 655b     name2 = edge[
-0000dcd0: 315d 0a20 2020 2020 2020 2076 616c 7565  1].        value
-0000dce0: 7331 203d 205b 666c 6f61 7428 6b61 7469  s1 = [float(kati
-0000dcf0: 2920 666f 7220 6b61 7469 2069 6e20 636f  ) for kati in co
-0000dd00: 6e74 6578 745b 6e61 6d65 315d 5d0a 2020  ntext[name1]].  
-0000dd10: 2020 2020 2020 7661 6c75 6573 3220 3d20        values2 = 
-0000dd20: 5b66 6c6f 6174 286b 6174 6929 2066 6f72  [float(kati) for
-0000dd30: 206b 6174 6920 696e 2063 6f6e 7465 7874   kati in context
-0000dd40: 5b6e 616d 6532 5d5d 0a0a 2020 2020 2020  [name2]]..      
-0000dd50: 2020 7072 6576 203d 2076 616c 7565 7332    prev = values2
-0000dd60: 5b30 5d0a 2020 2020 2020 2020 6469 6666  [0].        diff
-0000dd70: 203d 2030 0a20 2020 2020 2020 2066 6f72   = 0.        for
-0000dd80: 2076 2069 6e20 7661 6c75 6573 325b 313a   v in values2[1:
-0000dd90: 5d3a 0a20 2020 2020 2020 2020 2020 2064  ]:.            d
-0000dda0: 6966 6620 2b3d 2028 7620 2d20 7072 6576  iff += (v - prev
-0000ddb0: 290a 0a20 2020 2020 2020 2069 6620 6c65  )..        if le
-0000ddc0: 6e28 7661 6c75 6573 3229 203d 3d20 303a  n(values2) == 0:
-0000ddd0: 0a20 2020 2020 2020 2020 2020 2063 6861  .            cha
-0000dde0: 7220 3d20 2623 3334 3b75 6e6b 6e6f 776e  r = &#34;unknown
-0000ddf0: 2623 3334 3b0a 2020 2020 2020 2020 7374  &#34;.        st
-0000de00: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
-0000de10: 7374 6465 7628 7661 6c75 6573 3229 0a20  stdev(values2). 
-0000de20: 2020 2020 2020 2069 6620 6469 6666 2026         if diff &
-0000de30: 6774 3b20 3220 2a20 7374 6476 3a0a 2020  gt; 2 * stdv:.  
-0000de40: 2020 2020 2020 2020 2020 6368 6172 203d            char =
-0000de50: 2026 2333 343b 696e 6372 6561 7365 2623   &#34;increase&#
-0000de60: 3334 3b0a 2020 2020 2020 2020 656c 6966  34;.        elif
-0000de70: 2064 6966 6620 266c 743b 202d 3220 2a20   diff &lt; -2 * 
-0000de80: 7374 6476 3a0a 2020 2020 2020 2020 2020  stdv:.          
-0000de90: 2020 6368 6172 203d 2026 2333 343b 6465    char = &#34;de
-0000dea0: 6372 6561 7365 2623 3334 3b0a 2020 2020  crease&#34;.    
-0000deb0: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-0000dec0: 2020 2020 2020 6368 6172 203d 2026 2333        char = &#3
-0000ded0: 343b 756e 6b6e 6f77 6e26 2333 343b 0a20  4;unknown&#34;. 
-0000dee0: 2020 2020 2020 2072 6574 7572 6e20 6368         return ch
-0000def0: 6172 0a0a 2020 2020 6465 6620 6361 6c63  ar..    def calc
-0000df00: 756c 6174 655f 6564 6765 7328 7365 6c66  ulate_edges(self
-0000df10: 2c20 616c 6c64 6174 612c 2074 696d 6573  , alldata, times
-0000df20: 7461 6d70 293a 0a20 2020 2020 2020 2026  tamp):.        &
-0000df30: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-0000df40: 2020 2020 2020 2046 6f72 6d75 6c61 7465         Formulate
-0000df50: 2074 6865 2064 6174 6120 696e 2061 7070   the data in app
-0000df60: 726f 7072 6961 7465 2066 6f72 6d20 746f  ropriate form to
-0000df70: 2063 616c 6c20 7365 6c66 2e63 616c 6375   call self.calcu
-0000df80: 6c61 7465 5f63 6175 7361 6c69 7479 0a20  late_causality. 
-0000df90: 2020 2020 2020 2077 6869 6368 2072 6574         which ret
-0000dfa0: 7572 6e20 7468 6520 6564 6765 7320 666f  urn the edges fo
-0000dfb0: 7220 7468 6520 636f 6e74 6578 742e 0a0a  r the context...
-0000dfc0: 2020 2020 2020 2020 2a2a 5061 7261 6d65          **Parame
-0000dfd0: 7465 7273 2a2a 3a0a 0a20 2020 2020 2020  ters**:..       
-0000dfe0: 202a 2a61 6c6c 6461 7461 2a2a 3a20 6120   **alldata**: a 
-0000dff0: 3244 206e 756d 7079 2061 7272 6179 2077  2D numpy array w
-0000e000: 6974 6820 616c 6c20 7365 7269 6573 2064  ith all series d
-0000e010: 6174 6120 2865 7175 6976 616c 656e 7420  ata (equivalent 
-0000e020: 746f 2074 6865 2043 4420 6f66 2074 6865  to the CD of the
-0000e030: 2043 6f6e 7465 7874 290a 0a20 2020 2020   Context)..     
-0000e040: 2020 202a 2a74 696d 6573 7461 6d70 2a2a     **timestamp**
-0000e050: 3a20 7469 6d65 7374 616d 7020 6f66 2074  : timestamp of t
-0000e060: 6865 2063 6f6e 7465 7874 2066 726f 6d20  he context from 
-0000e070: 7768 6963 6820 7468 6520 6564 6765 7320  which the edges 
-0000e080: 6172 6520 6361 6c63 756c 6174 6564 2e0a  are calculated..
-0000e090: 0a20 2020 2020 2020 202a 2a72 6574 7572  .        **retur
-0000e0a0: 6e2a 2a3a 2061 2064 6963 7469 6f6e 6172  n**: a dictionar
-0000e0b0: 7920 7769 7468 2026 2333 393b 6564 6765  y with &#39;edge
-0000e0c0: 7326 2333 393b 206b 6579 2028 636f 6e74  s&#39; key (cont
-0000e0d0: 6169 6e69 6e67 2074 6865 2063 616c 6375  aining the calcu
-0000e0e0: 6c61 7465 6420 6564 6765 7320 6166 7465  lated edges afte
-0000e0f0: 7220 4361 7573 616c 6974 7920 6469 7363  r Causality disc
-0000e100: 6f76 6572 7929 2e0a 2020 2020 2020 2020  overy)..        
-0000e110: 2623 3334 3b26 2333 343b 2623 3334 3b0a  &#34;&#34;&#34;.
-0000e120: 2020 2020 2020 2020 2320 7374 6172 7420          # start 
-0000e130: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-0000e140: 2020 2020 2020 7374 6f72 696e 6720 3d20        storing = 
-0000e150: 7b7d 0a20 2020 2020 2020 2073 746f 7269  {}.        stori
-0000e160: 6e67 5b26 2333 343b 7469 6d65 7374 616d  ng[&#34;timestam
-0000e170: 7026 2333 343b 5d20 3d20 7469 6d65 7374  p&#34;] = timest
-0000e180: 616d 700a 0a20 2020 2020 2020 2061 6c6c  amp..        all
-0000e190: 6461 7461 5f6e 616d 6573 203d 205b 6e6e  data_names = [nn
-0000e1a0: 5b30 5d20 666f 7220 6e6e 2069 6e20 616c  [0] for nn in al
-0000e1b0: 6c64 6174 615d 0a20 2020 2020 2020 2061  ldata].        a
-0000e1c0: 6c6c 6461 7461 5f64 6174 6120 3d20 5b6e  lldata_data = [n
-0000e1d0: 6e5b 315d 2066 6f72 206e 6e20 696e 2061  n[1] for nn in a
-0000e1e0: 6c6c 6461 7461 5d0a 0a20 2020 2020 2020  lldata]..       
-0000e1f0: 2066 6f72 206e 616d 6564 642c 2064 6174   for namedd, dat
-0000e200: 6164 6420 696e 207a 6970 2861 6c6c 6461  add in zip(allda
-0000e210: 7461 5f6e 616d 6573 2c20 616c 6c64 6174  ta_names, alldat
-0000e220: 615f 6461 7461 293a 0a20 2020 2020 2020  a_data):.       
-0000e230: 2020 2020 2073 746f 7269 6e67 5b6e 616d       storing[nam
-0000e240: 6564 645d 203d 2064 6174 6164 640a 0a20  edd] = datadd.. 
-0000e250: 2020 2020 2020 2023 2046 6f72 2063 6f6e         # For con
-0000e260: 7465 7874 2077 6974 6820 6d6f 7265 2074  text with more t
-0000e270: 6861 6e20 7477 6f20 7365 7269 6573 2063  han two series c
-0000e280: 616c 6375 6c61 7465 2050 4320 6361 7375  alculate PC casu
-0000e290: 616c 6974 6965 730a 2020 2020 2020 2020  alities.        
-0000e2a0: 636f 756e 7420 3d20 6c65 6e28 5b31 2066  count = len([1 f
-0000e2b0: 6f72 206c 6973 7461 2069 6e20 616c 6c64  or lista in alld
-0000e2c0: 6174 615f 6461 7461 2069 6620 6c69 7374  ata_data if list
-0000e2d0: 6120 6973 206e 6f74 204e 6f6e 655d 290a  a is not None]).
-0000e2e0: 2020 2020 2020 2020 6966 2063 6f75 6e74          if count
-0000e2f0: 2026 6774 3b20 3120 616e 6420 6c65 6e28   &gt; 1 and len(
-0000e300: 616c 6c64 6174 615b 305d 5b31 5d29 2026  alldata[0][1]) &
-0000e310: 6774 3b20 353a 0a20 2020 2020 2020 2020  gt; 5:.         
-0000e320: 2020 2061 6c6c 6461 7461 5f6e 616d 6573     alldata_names
-0000e330: 203d 205b 6e6e 5b30 5d20 666f 7220 6e6e   = [nn[0] for nn
-0000e340: 2069 6e20 616c 6c64 6174 6120 6966 206e   in alldata if n
-0000e350: 6e5b 315d 2069 7320 6e6f 7420 4e6f 6e65  n[1] is not None
-0000e360: 2061 6e64 206c 656e 2873 6574 286e 6e5b   and len(set(nn[
-0000e370: 315d 2929 2026 6774 3b20 315d 0a20 2020  1])) &gt; 1].   
-0000e380: 2020 2020 2020 2020 2061 6c6c 6461 7461           alldata
-0000e390: 5f64 6174 6120 3d20 5b6e 6e5b 315d 2066  _data = [nn[1] f
-0000e3a0: 6f72 206e 6e20 696e 2061 6c6c 6461 7461  or nn in alldata
-0000e3b0: 2069 6620 6e6e 5b31 5d20 6973 206e 6f74   if nn[1] is not
-0000e3c0: 204e 6f6e 6520 616e 6420 6c65 6e28 7365   None and len(se
-0000e3d0: 7428 6e6e 5b31 5d29 2920 2667 743b 2031  t(nn[1])) &gt; 1
-0000e3e0: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
-0000e3f0: 2065 6e64 203d 2074 696d 652e 7469 6d65   end = time.time
-0000e400: 2829 0a20 2020 2020 2020 2020 2020 2023  ().            #
-0000e410: 2070 7269 6e74 2866 2623 3334 3b62 6566   print(f&#34;bef
-0000e420: 6f72 6520 7b65 6e64 202d 2073 7461 7274  ore {end - start
-0000e430: 7d26 2333 343b 290a 2020 2020 2020 2020  }&#34;).        
-0000e440: 2020 2020 2320 7374 6172 743d 7469 6d65      # start=time
-0000e450: 2e74 696d 6528 290a 0a20 2020 2020 2020  .time()..       
-0000e460: 2020 2020 2065 6467 6573 203d 2073 656c       edges = sel
-0000e470: 662e 6361 6c63 756c 6174 655f 6361 7573  f.calculate_caus
-0000e480: 616c 6974 7928 6e70 2e63 6f6c 756d 6e5f  ality(np.column_
-0000e490: 7374 6163 6b28 616c 6c64 6174 615f 6461  stack(alldata_da
-0000e4a0: 7461 292c 2061 6c6c 6461 7461 5f6e 616d  ta), alldata_nam
-0000e4b0: 6573 290a 2020 2020 2020 2020 2020 2020  es).            
-0000e4c0: 2320 656e 643d 7469 6d65 2e74 696d 6528  # end=time.time(
-0000e4d0: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0000e4e0: 7072 696e 7428 6626 2333 343b 6163 7475  print(f&#34;actu
-0000e4f0: 616c 2065 6467 6520 6361 6c63 756c 6174  al edge calculat
-0000e500: 696f 6e20 7b65 6e64 2d73 7461 7274 7d26  ion {end-start}&
-0000e510: 2333 343b 290a 2020 2020 2020 2020 2020  #34;).          
-0000e520: 2020 6966 2065 6467 6573 2069 7320 4e6f    if edges is No
-0000e530: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-0000e540: 2020 2020 7369 6e67 6c65 6564 6765 7320      singleedges 
-0000e550: 3d20 5b5d 0a20 2020 2020 2020 2020 2020  = [].           
-0000e560: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000e570: 2020 2020 2020 2073 696e 676c 6565 6467         singleedg
-0000e580: 6573 203d 2065 6467 6573 0a20 2020 2020  es = edges.     
-0000e590: 2020 2020 2020 2023 2070 7269 6e74 2865         # print(e
-0000e5a0: 6467 6573 290a 2020 2020 2020 2020 2020  dges).          
-0000e5b0: 2020 7374 6f72 696e 675b 2623 3334 3b65    storing[&#34;e
-0000e5c0: 6467 6573 2623 3334 3b5d 203d 2073 696e  dges&#34;] = sin
-0000e5d0: 676c 6565 6467 6573 0a20 2020 2020 2020  gleedges.       
-0000e5e0: 2020 2020 2072 6574 7572 6e20 7374 6f72       return stor
-0000e5f0: 696e 670a 2020 2020 2020 2020 7374 6f72  ing.        stor
-0000e600: 696e 675b 2623 3334 3b65 6467 6573 2623  ing[&#34;edges&#
-0000e610: 3334 3b5d 203d 205b 5d0a 2020 2020 2020  34;] = [].      
-0000e620: 2020 7265 7475 726e 2073 746f 7269 6e67    return storing
-0000e630: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-0000e640: 5f63 6f6e 7469 6e75 6f75 735f 7265 7072  _continuous_repr
-0000e650: 6573 656e 7461 7469 6f6e 2873 656c 662c  esentation(self,
-0000e660: 2074 6172 6765 745f 7365 7269 6573 5f6e   target_series_n
-0000e670: 616d 652c 2074 6172 6765 745f 7365 7269  ame, target_seri
-0000e680: 6573 2c20 6466 2c20 7479 7065 5f6f 665f  es, df, type_of_
-0000e690: 7365 7269 6573 2c20 616c 6c63 6f64 6573  series, allcodes
-0000e6a0: 293a 0a20 2020 2020 2020 2023 2069 6620  ):.        # if 
-0000e6b0: 6c65 6e28 7461 7267 6574 5f73 6572 6965  len(target_serie
-0000e6c0: 7329 2026 6c74 3b20 353a 0a20 2020 2020  s) &lt; 5:.     
-0000e6d0: 2020 2023 2020 2020 2061 6c6c 6461 7461     #     alldata
-0000e6e0: 203d 205b 5d0a 2020 2020 2020 2020 2320   = [].        # 
-0000e6f0: 2020 2020 7061 6464 696e 673d 5b30 2066      padding=[0 f
-0000e700: 6f72 2071 2069 6e20 7261 6e67 6528 352d  or q in range(5-
-0000e710: 6c65 6e28 7461 7267 6574 5f73 6572 6965  len(target_serie
-0000e720: 7329 295d 0a20 2020 2020 2020 2023 2020  s))].        #  
-0000e730: 2020 2070 6164 6469 6e67 2e65 7874 656e     padding.exten
-0000e740: 6428 5b74 6167 735b 305d 2066 6f72 2074  d([tags[0] for t
-0000e750: 6167 7320 696e 2074 6172 6765 745f 7365  ags in target_se
-0000e760: 7269 6573 5d29 0a20 2020 2020 2020 2023  ries]).        #
-0000e770: 2020 2020 2061 6c6c 6461 7461 2e61 7070       alldata.app
-0000e780: 656e 6428 2874 6172 6765 745f 7365 7269  end((target_seri
-0000e790: 6573 5f6e 616d 652c 2070 6164 6469 6e67  es_name, padding
-0000e7a0: 2929 0a20 2020 2020 2020 2023 2020 2020  )).        #    
-0000e7b0: 2072 6574 7572 6e20 616c 6c64 6174 610a   return alldata.
-0000e7c0: 2020 2020 2020 2020 7769 6e64 6f77 7661          windowva
-0000e7d0: 6c75 6573 203d 2064 6620 2023 202e 7661  lues = df  # .va
-0000e7e0: 6c75 6573 0a20 2020 2020 2020 2061 6c6c  lues.        all
-0000e7f0: 6461 7461 203d 205b 5d0a 2020 2020 2020  data = [].      
-0000e800: 2020 616c 6c64 6174 612e 6170 7065 6e64    alldata.append
-0000e810: 2828 7461 7267 6574 5f73 6572 6965 735f  ((target_series_
-0000e820: 6e61 6d65 2c20 5b74 6167 5b30 5d20 666f  name, [tag[0] fo
-0000e830: 7220 7461 6720 696e 2074 6172 6765 745f  r tag in target_
-0000e840: 7365 7269 6573 5d29 290a 2020 2020 2020  series])).      
-0000e850: 2020 666f 7220 6e61 6d65 2069 6e20 616c    for name in al
-0000e860: 6c63 6f64 6573 3a0a 2020 2020 2020 2020  lcodes:.        
-0000e870: 2020 2020 2320 616c 7265 6164 7920 6361      # already ca
-0000e880: 6c63 756c 6174 6564 2069 6e20 7461 7267  lculated in targ
-0000e890: 6574 7365 7269 6573 2e0a 2020 2020 2020  etseries..      
-0000e8a0: 2020 2020 2020 6966 2074 6172 6765 745f        if target_
-0000e8b0: 7365 7269 6573 5f6e 616d 6520 696e 206e  series_name in n
-0000e8c0: 616d 653a 0a20 2020 2020 2020 2020 2020  ame:.           
-0000e8d0: 2020 2020 2063 6f6e 7469 6e75 650a 0a20       continue.. 
-0000e8e0: 2020 2020 2020 2020 2020 2023 2064 6574             # det
-0000e8f0: 6563 7420 7468 6520 6f63 6375 7261 6e63  ect the occuranc
-0000e900: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
-0000e910: 6f63 6375 7265 6e63 6965 7320 3d20 5b28  occurencies = [(
-0000e920: 7661 6c75 652c 2074 696d 6529 2066 6f72  value, time) for
-0000e930: 2063 6f64 652c 2076 616c 7565 2c20 7469   code, value, ti
-0000e940: 6d65 2069 6e0a 2020 2020 2020 2020 2020  me in.          
-0000e950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e960: 207a 6970 2877 696e 646f 7776 616c 7565   zip(windowvalue
-0000e970: 735b 3a2c 2031 5d2c 2077 696e 646f 7776  s[:, 1], windowv
-0000e980: 616c 7565 735b 3a2c 2033 5d2c 2077 696e  alues[:, 3], win
-0000e990: 646f 7776 616c 7565 735b 3a2c 2030 5d29  dowvalues[:, 0])
-0000e9a0: 2069 6620 6e61 6d65 2069 6e20 636f 6465   if name in code
-0000e9b0: 5d0a 0a20 2020 2020 2020 2020 2020 2076  ]..            v
-0000e9c0: 6563 746f 7220 3d20 5b30 2066 6f72 2069  ector = [0 for i
-0000e9d0: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
-0000e9e0: 7267 6574 5f73 6572 6965 7329 295d 0a20  rget_series))]. 
-0000e9f0: 2020 2020 2020 2020 2020 2069 6620 6c65             if le
-0000ea00: 6e28 6f63 6375 7265 6e63 6965 7329 203d  n(occurencies) =
-0000ea10: 3d20 303a 0a20 2020 2020 2020 2020 2020  = 0:.           
-0000ea20: 2020 2020 2076 6563 746f 7220 3d20 5b30       vector = [0
-0000ea30: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-0000ea40: 6c65 6e28 7461 7267 6574 5f73 6572 6965  len(target_serie
-0000ea50: 7329 295d 0a20 2020 2020 2020 2020 2020  s))].           
-0000ea60: 2065 6c69 6620 6f63 6375 7265 6e63 6965   elif occurencie
-0000ea70: 735b 305d 5b30 5d20 6973 206e 6f74 204e  s[0][0] is not N
-0000ea80: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-0000ea90: 2020 2020 2076 6563 746f 7220 3d20 7365       vector = se
-0000eaa0: 6c66 2e62 7569 6c64 5f63 6f6e 7465 7874  lf.build_context
-0000eab0: 5f66 6f72 5f75 6e69 7661 7269 6174 6528  _for_univariate(
-0000eac0: 7461 7267 6574 5f73 6572 6965 732c 206f  target_series, o
-0000ead0: 6363 7572 656e 6369 6573 290a 2020 2020  ccurencies).    
-0000eae0: 2020 2020 2020 2020 656c 6966 2074 7970          elif typ
-0000eaf0: 655f 6f66 5f73 6572 6965 735b 6e61 6d65  e_of_series[name
-0000eb00: 5d20 3d3d 2026 2333 343b 6973 6f6c 6174  ] == &#34;isolat
-0000eb10: 6564 2623 3334 3b3a 0a20 2020 2020 2020  ed&#34;:.       
-0000eb20: 2020 2020 2020 2020 2076 6563 746f 7220           vector 
-0000eb30: 3d20 7365 6c66 2e62 7569 6c64 5f63 6f6e  = self.build_con
-0000eb40: 7465 7874 5f66 6f72 5f69 736f 6c61 7465  text_for_isolate
-0000eb50: 6428 7461 7267 6574 5f73 6572 6965 732c  d(target_series,
-0000eb60: 206f 6363 7572 656e 6369 6573 290a 2020   occurencies).  
-0000eb70: 2020 2020 2020 2020 2020 656c 6966 2074            elif t
-0000eb80: 7970 655f 6f66 5f73 6572 6965 735b 6e61  ype_of_series[na
-0000eb90: 6d65 5d20 3d3d 2026 2333 343b 636f 6e66  me] == &#34;conf
-0000eba0: 6967 7572 6174 696f 6e26 2333 343b 3a0a  iguration&#34;:.
-0000ebb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000ebc0: 7665 6374 6f72 203d 2073 656c 662e 6275  vector = self.bu
-0000ebd0: 696c 645f 636f 6e74 6578 745f 666f 725f  ild_context_for_
-0000ebe0: 636f 6e66 6975 6775 7261 7469 6f6e 2874  confiuguration(t
-0000ebf0: 6172 6765 745f 7365 7269 6573 2c20 6f63  arget_series, oc
-0000ec00: 6375 7265 6e63 6965 7329 0a0a 2020 2020  curencies)..    
-0000ec10: 2020 2020 2020 2020 6f6b 203d 2026 2333          ok = &#3
-0000ec20: 343b 6f6b 2623 3334 3b0a 2020 2020 2020  4;ok&#34;.      
-0000ec30: 2020 2020 2020 2320 6966 2076 6563 746f        # if vecto
-0000ec40: 7220 6973 2073 7461 7469 6f6e 6172 7920  r is stationary 
-0000ec50: 7468 656e 206e 6f20 636f 6e74 6578 742e  then no context.
-0000ec60: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ec70: 6d61 7828 7665 6374 6f72 2920 3d3d 2030  max(vector) == 0
-0000ec80: 2061 6e64 206d 696e 2876 6563 746f 7229   and min(vector)
-0000ec90: 203d 3d20 303a 0a20 2020 2020 2020 2020   == 0:.         
-0000eca0: 2020 2020 2020 2076 6563 746f 7220 3d20         vector = 
-0000ecb0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-0000ecc0: 2061 6c6c 6461 7461 2e61 7070 656e 6428   alldata.append(
-0000ecd0: 286e 616d 652c 2076 6563 746f 7229 290a  (name, vector)).
-0000ece0: 2020 2020 2020 2020 7265 7475 726e 2061          return a
-0000ecf0: 6c6c 6461 7461 0a0a 2020 2020 6465 6620  lldata..    def 
-0000ed00: 6275 696c 645f 7461 7267 6574 5f73 6572  build_target_ser
-0000ed10: 6965 735f 666f 725f 636f 6e74 6578 7428  ies_for_context(
-0000ed20: 7365 6c66 2c20 6375 7272 656e 743a 2045  self, current: E
-0000ed30: 7665 6e74 706f 696e 742c 2064 663a 206e  ventpoint, df: n
-0000ed40: 702e 6e64 6172 7261 7929 3a0a 2020 2020  p.ndarray):.    
-0000ed50: 2020 2020 7461 7267 6574 5f73 6572 6965      target_serie
-0000ed60: 735f 6e61 6d65 203d 2063 7572 7265 6e74  s_name = current
-0000ed70: 2e63 6f64 650a 2020 2020 2020 2020 7769  .code.        wi
-0000ed80: 6e64 6f77 7661 6c75 6573 203d 2064 6620  ndowvalues = df 
-0000ed90: 2023 202e 7661 6c75 6573 0a20 2020 2020   # .values.     
-0000eda0: 2020 2074 6172 6765 745f 7365 7269 6573     target_series
-0000edb0: 203d 205b 2876 616c 7565 2c20 7469 6d65   = [(value, time
-0000edc0: 2920 666f 7220 636f 6465 2c20 7661 6c75  ) for code, valu
-0000edd0: 652c 2074 696d 6520 696e 0a20 2020 2020  e, time in.     
-0000ede0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000edf0: 2020 2020 7a69 7028 7769 6e64 6f77 7661      zip(windowva
-0000ee00: 6c75 6573 5b3a 2c20 315d 2c20 7769 6e64  lues[:, 1], wind
-0000ee10: 6f77 7661 6c75 6573 5b3a 2c20 335d 2c20  owvalues[:, 3], 
-0000ee20: 7769 6e64 6f77 7661 6c75 6573 5b3a 2c20  windowvalues[:, 
-0000ee30: 305d 2920 6966 2074 6172 6765 745f 7365  0]) if target_se
-0000ee40: 7269 6573 5f6e 616d 6520 696e 2063 6f64  ries_name in cod
-0000ee50: 655d 0a0a 2020 2020 2020 2020 7265 7475  e]..        retu
-0000ee60: 726e 2074 6172 6765 745f 7365 7269 6573  rn target_series
-0000ee70: 5f6e 616d 652c 2074 6172 6765 745f 7365  _name, target_se
-0000ee80: 7269 6573 0a0a 2020 2020 6465 6620 4e75  ries..    def Nu
-0000ee90: 6d70 795f 7072 6570 726f 6363 6573 7328  mpy_preproccess(
-0000eea0: 7365 6c66 2c20 6e70 636f 6e74 6578 7429  self, npcontext)
-0000eeb0: 3a0a 2020 2020 2020 2020 6e70 636f 6e74  :.        npcont
-0000eec0: 6578 7420 3d20 6e70 2e77 6865 7265 286e  ext = np.where(n
-0000eed0: 7063 6f6e 7465 7874 203d 3d20 2623 3334  pcontext == &#34
-0000eee0: 3b6e 616e 2623 3334 3b2c 204e 6f6e 652c  ;nan&#34;, None,
-0000eef0: 206e 7063 6f6e 7465 7874 290a 0a20 2020   npcontext)..   
-0000ef00: 2020 2020 206d 6173 6b20 3d20 5b28 2623       mask = [(&#
-0000ef10: 3339 3b30 5f26 2333 393b 2069 6e20 636f  39;0_&#39; in co
-0000ef20: 6465 2061 6e64 2076 616c 7565 2069 7320  de and value is 
-0000ef30: 4e6f 6e65 2920 666f 7220 636f 6465 2c20  None) for code, 
-0000ef40: 7661 6c75 6520 696e 207a 6970 286e 7063  value in zip(npc
-0000ef50: 6f6e 7465 7874 5b3a 2c20 315d 2c20 6e70  ontext[:, 1], np
-0000ef60: 636f 6e74 6578 745b 3a2c 2033 5d29 5d0a  context[:, 3])].
-0000ef70: 0a20 2020 2020 2020 2023 2069 6620 6973  .        # if is
-0000ef80: 696e 7374 616e 6365 286d 6173 6b2c 636f  instance(mask,co
-0000ef90: 6c6c 6563 7469 6f6e 732e 6162 632e 5365  llections.abc.Se
-0000efa0: 7175 656e 6365 293d 3d46 616c 7365 3a0a  quence)==False:.
-0000efb0: 2020 2020 2020 2020 2320 2020 2020 6d61          #     ma
-0000efc0: 736b 3d5b 6d61 736b 5d0a 2020 2020 2020  sk=[mask].      
-0000efd0: 2020 6e70 636f 6e74 6578 745b 6d61 736b    npcontext[mask
-0000efe0: 2c20 335d 203d 2030 0a20 2020 2020 2020  , 3] = 0.       
-0000eff0: 206d 6173 6b20 3d20 5b28 2623 3339 3b31   mask = [(&#39;1
-0000f000: 5f26 2333 393b 2069 6e20 636f 6465 2061  _&#39; in code a
-0000f010: 6e64 2076 616c 7565 2069 7320 4e6f 6e65  nd value is None
-0000f020: 2920 666f 7220 636f 6465 2c20 7661 6c75  ) for code, valu
-0000f030: 6520 696e 207a 6970 286e 7063 6f6e 7465  e in zip(npconte
-0000f040: 7874 5b3a 2c20 315d 2c20 6e70 636f 6e74  xt[:, 1], npcont
-0000f050: 6578 745b 3a2c 2033 5d29 5d0a 2020 2020  ext[:, 3])].    
-0000f060: 2020 2020 6e70 636f 6e74 6578 745b 6d61      npcontext[ma
-0000f070: 736b 2c20 335d 203d 2031 0a20 2020 2020  sk, 3] = 1.     
-0000f080: 2020 2063 6f64 655f 7769 7468 5f73 6f75     code_with_sou
-0000f090: 7263 6520 3d20 5b66 2623 3334 3b7b 636f  rce = [f&#34;{co
-0000f0a0: 6465 7d7b 736f 7572 6365 7d26 2333 343b  de}{source}&#34;
-0000f0b0: 2069 6620 736f 7572 6365 5b30 5d20 3d3d   if source[0] ==
-0000f0c0: 2026 2333 343b 4026 2333 343b 2065 6c73   &#34;@&#34; els
-0000f0d0: 6520 6626 2333 343b 7b63 6f64 657d 407b  e f&#34;{code}@{
-0000f0e0: 736f 7572 6365 7d26 2333 343b 2066 6f72  source}&#34; for
-0000f0f0: 2063 6f64 652c 2073 6f75 7263 6520 696e   code, source in
-0000f100: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000f110: 2020 2020 2020 2020 2020 2020 207a 6970               zip
-0000f120: 286e 7063 6f6e 7465 7874 5b3a 2c20 315d  (npcontext[:, 1]
-0000f130: 2c20 6e70 636f 6e74 6578 745b 3a2c 2032  , npcontext[:, 2
-0000f140: 5d29 5d0a 2020 2020 2020 2020 6e70 636f  ])].        npco
-0000f150: 6e74 6578 745b 3a2c 2031 5d20 3d20 636f  ntext[:, 1] = co
-0000f160: 6465 5f77 6974 685f 736f 7572 6365 0a0a  de_with_source..
-0000f170: 2020 2020 2020 2020 7265 7475 726e 206e          return n
-0000f180: 7063 6f6e 7465 7874 0a0a 2020 2020 6465  pcontext..    de
-0000f190: 6620 6275 696c 645f 636f 6e74 6578 745f  f build_context_
-0000f1a0: 666f 725f 636f 6e66 6975 6775 7261 7469  for_confiugurati
-0000f1b0: 6f6e 2873 656c 662c 2074 6172 6765 745f  on(self, target_
-0000f1c0: 7365 7269 6573 2c20 6f63 6375 7265 6e63  series, occurenc
-0000f1d0: 6965 7329 3a0a 2020 2020 2020 2020 7665  ies):.        ve
-0000f1e0: 6374 6f72 203d 205b 3020 666f 7220 6920  ctor = [0 for i 
-0000f1f0: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
-0000f200: 6765 745f 7365 7269 6573 2929 5d0a 2020  get_series))].  
-0000f210: 2020 2020 2020 666f 7220 6f63 6320 696e        for occ in
-0000f220: 206f 6363 7572 656e 6369 6573 3a0a 2020   occurencies:.  
-0000f230: 2020 2020 2020 2020 2020 666f 7220 7120            for q 
-0000f240: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
-0000f250: 6765 745f 7365 7269 6573 2929 3a0a 2020  get_series)):.  
-0000f260: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000f270: 2074 6172 6765 745f 7365 7269 6573 5b71   target_series[q
-0000f280: 5d5b 315d 2026 6774 3b3d 206f 6363 5b31  ][1] &gt;= occ[1
-0000f290: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0000f2a0: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-0000f2b0: 7261 6e67 6528 712c 206c 656e 2876 6563  range(q, len(vec
-0000f2c0: 746f 7229 293a 0a20 2020 2020 2020 2020  tor)):.         
-0000f2d0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000f2e0: 6563 746f 725b 6b5d 202b 3d20 310a 2020  ector[k] += 1.  
-0000f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f300: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
-0000f310: 2323 206e 6f74 2073 7461 626c 650a 2020  ## not stable.  
-0000f320: 2020 2020 2020 6966 206c 656e 2873 6574        if len(set
-0000f330: 2876 6563 746f 7229 2920 3d3d 2031 3a0a  (vector)) == 1:.
-0000f340: 2020 2020 2020 2020 2020 2020 7665 6374              vect
-0000f350: 6f72 5b30 5d20 3d20 300a 2020 2020 2020  or[0] = 0.      
-0000f360: 2020 7265 7475 726e 2076 6563 746f 720a    return vector.
-0000f370: 0a20 2020 2064 6566 2062 7569 6c64 5f63  .    def build_c
-0000f380: 6f6e 7465 7874 5f66 6f72 5f69 736f 6c61  ontext_for_isola
-0000f390: 7465 6428 7365 6c66 2c20 7461 7267 6574  ted(self, target
-0000f3a0: 5f73 6572 6965 732c 206f 6363 7572 656e  _series, occuren
-0000f3b0: 6369 6573 293a 0a20 2020 2020 2020 2076  cies):.        v
-0000f3c0: 6563 746f 7220 3d20 5b30 2066 6f72 2069  ector = [0 for i
-0000f3d0: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
-0000f3e0: 7267 6574 5f73 6572 6965 7329 295d 0a20  rget_series))]. 
-0000f3f0: 2020 2020 2020 2066 6f72 206f 6363 2069         for occ i
-0000f400: 6e20 6f63 6375 7265 6e63 6965 733a 0a20  n occurencies:. 
-0000f410: 2020 2020 2020 2020 2020 2066 6f72 2071             for q
-0000f420: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
-0000f430: 7267 6574 5f73 6572 6965 7329 293a 0a20  rget_series)):. 
-0000f440: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000f450: 6620 7461 7267 6574 5f73 6572 6965 735b  f target_series[
-0000f460: 715d 5b31 5d20 2667 743b 206f 6363 5b31  q][1] &gt; occ[1
-0000f470: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-0000f480: 2020 2020 2020 2076 6563 746f 725b 715d         vector[q]
-0000f490: 203d 2031 0a20 2020 2020 2020 2020 2020   = 1.           
-0000f4a0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-0000f4b0: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
-0000f4c0: 6374 6f72 0a0a 2020 2020 6465 6620 6275  ctor..    def bu
-0000f4d0: 696c 645f 636f 6e74 6578 745f 666f 725f  ild_context_for_
-0000f4e0: 756e 6976 6172 6961 7465 2873 656c 662c  univariate(self,
-0000f4f0: 2074 6172 6765 745f 7365 7269 6573 2c20   target_series, 
-0000f500: 6f63 6375 7265 6e63 6965 7329 3a0a 2020  occurencies):.  
-0000f510: 2020 2020 2020 616c 6c76 616c 7565 7320        allvalues 
-0000f520: 3d20 5b5d 0a20 2020 2020 2020 2076 6563  = [].        vec
-0000f530: 746f 7220 3d20 5b30 2066 6f72 2069 2069  tor = [0 for i i
-0000f540: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
-0000f550: 6574 5f73 6572 6965 7329 295d 0a20 2020  et_series))].   
-0000f560: 2020 2020 2070 6f73 203d 2030 0a20 2020       pos = 0.   
-0000f570: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
-0000f580: 6e67 6528 6c65 6e28 7461 7267 6574 5f73  nge(len(target_s
-0000f590: 6572 6965 7329 293a 0a20 2020 2020 2020  eries)):.       
-0000f5a0: 2020 2020 2074 696d 6573 7461 6d70 203d       timestamp =
-0000f5b0: 2074 6172 6765 745f 7365 7269 6573 5b69   target_series[i
-0000f5c0: 5d5b 315d 0a20 2020 2020 2020 2020 2020  ][1].           
-0000f5d0: 2063 7572 7265 6e74 5f70 6f73 203d 2070   current_pos = p
-0000f5e0: 6f73 0a20 2020 2020 2020 2020 2020 2066  os.            f
-0000f5f0: 6f72 2071 2069 6e20 7261 6e67 6528 706f  or q in range(po
-0000f600: 732c 206c 656e 286f 6363 7572 656e 6369  s, len(occurenci
-0000f610: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
-0000f620: 2020 2020 2020 6966 206f 6363 7572 656e        if occuren
-0000f630: 6369 6573 5b71 5d5b 315d 2026 6774 3b20  cies[q][1] &gt; 
-0000f640: 7469 6d65 7374 616d 703a 0a20 2020 2020  timestamp:.     
-0000f650: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-0000f660: 7572 7265 6e74 5f70 6f73 203d 2071 0a20  urrent_pos = q. 
-0000f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f680: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
-0000f690: 2020 2020 2023 206e 6f20 6461 7461 2066       # no data f
-0000f6a0: 6f75 6e64 0a0a 2020 2020 2020 2020 2020  ound..          
-0000f6b0: 2020 6966 2063 7572 7265 6e74 5f70 6f73    if current_pos
-0000f6c0: 203d 3d20 706f 733a 0a20 2020 2020 2020   == pos:.       
-0000f6d0: 2020 2020 2020 2020 2023 2069 6620 6e6f           # if no
-0000f6e0: 2064 6174 6120 696e 2062 6574 7777 656e   data in betwwen
-0000f6f0: 2076 616c 7565 7320 7573 6520 7468 6520   values use the 
-0000f700: 7072 6576 6975 7320 7661 6c75 650a 2020  previus value.  
-0000f710: 2020 2020 2020 2020 2020 2020 2020 6966                if
-0000f720: 2069 2026 6774 3b20 303a 0a20 2020 2020   i &gt; 0:.     
-0000f730: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0000f740: 6563 746f 725b 695d 203d 2076 6563 746f  ector[i] = vecto
-0000f750: 725b 6920 2d20 315d 0a20 2020 2020 2020  r[i - 1].       
-0000f760: 2020 2020 2020 2020 2023 2069 6620 6e6f           # if no
-0000f770: 2064 6174 6120 756e 7469 6c20 6920 7469   data until i ti
-0000f780: 6d65 7374 616d 7020 7573 6520 7468 6520  mestamp use the 
-0000f790: 6669 7273 7420 6f63 6375 7265 6e63 6520  first occurence 
-0000f7a0: 6173 2076 616c 7565 0a20 2020 2020 2020  as value.       
-0000f7b0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
-0000f7c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f7d0: 2020 2076 6563 746f 725b 695d 203d 206f     vector[i] = o
-0000f7e0: 6363 7572 656e 6369 6573 5b30 5d5b 305d  ccurencies[0][0]
-0000f7f0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-0000f800: 6620 6d75 6c74 6970 6c65 2076 616c 7565  f multiple value
-0000f810: 7320 696e 2062 6574 7765 656e 2074 776f  s in between two
-0000f820: 2074 696d 6573 7461 6d70 7320 7573 6520   timestamps use 
-0000f830: 7468 6520 6d65 616e 206f 6620 7468 656d  the mean of them
-0000f840: 2061 7320 7661 6c75 650a 2020 2020 2020   as value.      
-0000f850: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0000f860: 2020 2020 2020 2020 2020 2020 6461 7461              data
-0000f870: 496e 4265 7477 6565 6e20 3d20 5b76 616c  InBetween = [val
-0000f880: 7565 2066 6f72 2076 616c 7565 2c20 7469  ue for value, ti
-0000f890: 6d65 2069 6e20 6f63 6375 7265 6e63 6965  me in occurencie
-0000f8a0: 735b 706f 733a 6375 7272 656e 745f 706f  s[pos:current_po
-0000f8b0: 735d 5d0a 2020 2020 2020 2020 2020 2020  s]].            
-0000f8c0: 2020 2020 7665 6374 6f72 5b69 5d20 3d20      vector[i] = 
-0000f8d0: 7375 6d28 6461 7461 496e 4265 7477 6565  sum(dataInBetwee
-0000f8e0: 6e29 202f 206c 656e 2864 6174 6149 6e42  n) / len(dataInB
-0000f8f0: 6574 7765 656e 290a 2020 2020 2020 2020  etween).        
-0000f900: 2020 2020 2320 6966 206e 6f20 6f74 6865      # if no othe
-0000f910: 7220 6f63 6375 7265 6e63 6965 7320 6a75  r occurencies ju
-0000f920: 7374 2072 6570 6561 7420 7468 6520 6c61  st repeat the la
-0000f930: 7374 2076 616c 7565 0a20 2020 2020 2020  st value.       
-0000f940: 2020 2020 2069 6620 6375 7272 656e 745f       if current_
-0000f950: 706f 7320 3d3d 206c 656e 286f 6363 7572  pos == len(occur
-0000f960: 656e 6369 6573 293a 0a20 2020 2020 2020  encies):.       
-0000f970: 2020 2020 2020 2020 2066 6f72 206b 2069           for k i
-0000f980: 6e20 7261 6e67 6528 6920 2b20 312c 206c  n range(i + 1, l
-0000f990: 656e 2876 6563 746f 7229 293a 0a20 2020  en(vector)):.   
-0000f9a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000f9b0: 2076 6563 746f 725b 6b5d 203d 2076 6563   vector[k] = vec
-0000f9c0: 746f 725b 6b20 2d20 315d 0a20 2020 2020  tor[k - 1].     
-0000f9d0: 2020 2020 2020 2020 2020 2062 7265 616b             break
-0000f9e0: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
-0000f9f0: 203d 2063 7572 7265 6e74 5f70 6f73 0a0a   = current_pos..
-0000fa00: 2020 2020 2020 2020 7265 7475 726e 2076          return v
-0000fa10: 6563 746f 720a 0a20 2020 2064 6566 2063  ector..    def c
-0000fa20: 616c 6375 6c61 7465 5f63 6175 7361 6c69  alculate_causali
-0000fa30: 7479 2873 656c 662c 2064 6174 616f 722c  ty(self, dataor,
-0000fa40: 206e 616d 6573 293a 0a20 2020 2020 2020   names):.       
-0000fa50: 206e 756d 5f74 696d 655f 7365 7269 6573   num_time_series
-0000fa60: 203d 206c 656e 2864 6174 616f 7229 0a20   = len(dataor). 
-0000fa70: 2020 2020 2020 2064 6174 6120 3d20 6e70         data = np
-0000fa80: 2e61 7272 6179 2864 6174 616f 7229 0a20  .array(dataor). 
-0000fa90: 2020 2020 2020 2065 6467 6573 203d 2073         edges = s
-0000faa0: 656c 662e 6361 7573 616c 6974 795f 6469  elf.causality_di
-0000fab0: 7363 6f76 6572 7928 6e61 6d65 732c 2064  scovery(names, d
-0000fac0: 6174 6129 0a20 2020 2020 2020 2023 2065  ata).        # e
-0000fad0: 6467 6573 3d73 656c 662e 6361 6c63 756c  dges=self.calcul
-0000fae0: 6174 6577 6974 6850 6328 6e61 6d65 732c  atewithPc(names,
-0000faf0: 6461 7461 290a 2020 2020 2020 2020 2320  data).        # 
-0000fb00: 6564 6765 733d 7365 6c66 2e63 616c 6375  edges=self.calcu
-0000fb10: 6c61 7465 7769 7468 5f66 6369 286e 616d  latewith_fci(nam
-0000fb20: 6573 2c64 6174 6129 0a20 2020 2020 2020  es,data).       
-0000fb30: 2023 2065 6467 6573 3d73 656c 662e 7361   # edges=self.sa
-0000fb40: 6c65 7366 6f72 6365 5043 286e 616d 6573  lesforcePC(names
-0000fb50: 2c64 6174 6129 0a20 2020 2020 2020 2072  ,data).        r
-0000fb60: 6574 7572 6e20 6564 6765 730a 0a20 2020  eturn edges..   
-0000fb70: 2064 6566 2070 6c6f 7428 7365 6c66 2c20   def plot(self, 
-0000fb80: 6669 6c74 6572 6564 6765 733d 4e6f 6e65  filteredges=None
-0000fb90: 293a 0a20 2020 2020 2020 2069 6620 6669  ):.        if fi
-0000fba0: 6c74 6572 6564 6765 7320 6973 204e 6f6e  lteredges is Non
-0000fbb0: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
-0000fbc0: 696c 7465 7265 6467 6573 203d 205b 5b26  ilteredges = [[&
-0000fbd0: 2333 343b 2623 3334 3b2c 2026 2333 343b  #34;&#34;, &#34;
-0000fbe0: 2623 3334 3b2c 2026 2333 343b 2623 3334  &#34;, &#34;&#34
-0000fbf0: 3b5d 5d0a 2020 2020 2020 2020 7368 6f77  ;]].        show
-0000fc00: 5f63 6f6e 7465 7874 5f6c 6973 7428 7365  _context_list(se
-0000fc10: 6c66 2e63 6f6e 7465 7874 732c 2073 656c  lf.contexts, sel
-0000fc20: 662e 7461 7267 6574 2c20 6669 6c74 6572  f.target, filter
-0000fc30: 6564 6765 733d 6669 6c74 6572 6564 6765  edges=filteredge
-0000fc40: 7329 0a0a 2020 2020 6465 6620 706c 6f74  s)..    def plot
-0000fc50: 5f69 6e74 6572 7072 6574 6174 696f 6e28  _interpretation(
-0000fc60: 7365 6c66 2c20 6669 6c74 6572 6564 6765  self, filteredge
-0000fc70: 733d 4e6f 6e65 293a 0a20 2020 2020 2020  s=None):.       
-0000fc80: 2069 6620 6669 6c74 6572 6564 6765 7320   if filteredges 
-0000fc90: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-0000fca0: 2020 2020 2066 696c 7465 7265 6467 6573       filteredges
-0000fcb0: 203d 205b 5b26 2333 343b 2623 3334 3b2c   = [[&#34;&#34;,
-0000fcc0: 2026 2333 343b 2623 3334 3b2c 2026 2333   &#34;&#34;, &#3
-0000fcd0: 343b 2623 3334 3b5d 5d0a 2020 2020 2020  4;&#34;]].      
-0000fce0: 2020 7368 6f77 5f63 6f6e 7465 7874 5f69    show_context_i
-0000fcf0: 6e74 6572 7072 6574 6174 696f 6e73 2873  nterpretations(s
-0000fd00: 656c 662e 636f 6e74 6578 7473 2c20 7365  elf.contexts, se
-0000fd10: 6c66 2e74 6172 6765 742c 2066 696c 7465  lf.target, filte
-0000fd20: 7265 6467 6573 3d66 696c 7465 7265 6467  redges=filteredg
-0000fd30: 6573 293c 2f63 6f64 653e 3c2f 7072 653e  es)</code></pre>
-0000fd40: 0a3c 2f64 6574 6169 6c73 3e0a 3c68 333e  .</details>.<h3>
-0000fd50: 4d65 7468 6f64 733c 2f68 333e 0a3c 646c  Methods</h3>.<dl
-0000fd60: 3e0a 3c64 7420 6964 3d22 5064 6d43 6f6e  >.<dt id="PdmCon
-0000fd70: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
-0000fd80: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
-0000fd90: 6e65 7261 746f 722e 4e75 6d70 795f 7072  nerator.Numpy_pr
-0000fda0: 6570 726f 6363 6573 7322 3e3c 636f 6465  eproccess"><code
-0000fdb0: 2063 6c61 7373 3d22 6e61 6d65 2066 6c65   class="name fle
-0000fdc0: 7822 3e0a 3c73 7061 6e3e 6465 6620 3c73  x">.<span>def <s
-0000fdd0: 7061 6e20 636c 6173 733d 2269 6465 6e74  pan class="ident
-0000fde0: 223e 4e75 6d70 795f 7072 6570 726f 6363  ">Numpy_preprocc
-0000fdf0: 6573 733c 2f73 7061 6e3e 3c2f 7370 616e  ess</span></span
-0000fe00: 3e28 3c73 7061 6e3e 7365 6c66 2c20 6e70  >(<span>self, np
-0000fe10: 636f 6e74 6578 7429 3c2f 7370 616e 3e0a  context)</span>.
-0000fe20: 3c2f 636f 6465 3e3c 2f64 743e 0a3c 6464  </code></dt>.<dd
-0000fe30: 3e0a 3c64 6976 2063 6c61 7373 3d22 6465  >.<div class="de
-0000fe40: 7363 223e 3c2f 6469 763e 0a3c 6465 7461  sc"></div>.<deta
-0000fe50: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
-0000fe60: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
-0000fe70: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
-0000fe80: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
-0000fe90: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
-0000fea0: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
-0000feb0: 6e22 3e64 6566 204e 756d 7079 5f70 7265  n">def Numpy_pre
-0000fec0: 7072 6f63 6365 7373 2873 656c 662c 206e  proccess(self, n
-0000fed0: 7063 6f6e 7465 7874 293a 0a20 2020 206e  pcontext):.    n
-0000fee0: 7063 6f6e 7465 7874 203d 206e 702e 7768  pcontext = np.wh
-0000fef0: 6572 6528 6e70 636f 6e74 6578 7420 3d3d  ere(npcontext ==
-0000ff00: 2026 2333 343b 6e61 6e26 2333 343b 2c20   &#34;nan&#34;, 
-0000ff10: 4e6f 6e65 2c20 6e70 636f 6e74 6578 7429  None, npcontext)
-0000ff20: 0a0a 2020 2020 6d61 736b 203d 205b 2826  ..    mask = [(&
-0000ff30: 2333 393b 305f 2623 3339 3b20 696e 2063  #39;0_&#39; in c
-0000ff40: 6f64 6520 616e 6420 7661 6c75 6520 6973  ode and value is
-0000ff50: 204e 6f6e 6529 2066 6f72 2063 6f64 652c   None) for code,
-0000ff60: 2076 616c 7565 2069 6e20 7a69 7028 6e70   value in zip(np
-0000ff70: 636f 6e74 6578 745b 3a2c 2031 5d2c 206e  context[:, 1], n
-0000ff80: 7063 6f6e 7465 7874 5b3a 2c20 335d 295d  pcontext[:, 3])]
-0000ff90: 0a0a 2020 2020 2320 6966 2069 7369 6e73  ..    # if isins
-0000ffa0: 7461 6e63 6528 6d61 736b 2c63 6f6c 6c65  tance(mask,colle
-0000ffb0: 6374 696f 6e73 2e61 6263 2e53 6571 7565  ctions.abc.Seque
-0000ffc0: 6e63 6529 3d3d 4661 6c73 653a 0a20 2020  nce)==False:.   
-0000ffd0: 2023 2020 2020 206d 6173 6b3d 5b6d 6173   #     mask=[mas
-0000ffe0: 6b5d 0a20 2020 206e 7063 6f6e 7465 7874  k].    npcontext
-0000fff0: 5b6d 6173 6b2c 2033 5d20 3d20 300a 2020  [mask, 3] = 0.  
-00010000: 2020 6d61 736b 203d 205b 2826 2333 393b    mask = [(&#39;
-00010010: 315f 2623 3339 3b20 696e 2063 6f64 6520  1_&#39; in code 
-00010020: 616e 6420 7661 6c75 6520 6973 204e 6f6e  and value is Non
-00010030: 6529 2066 6f72 2063 6f64 652c 2076 616c  e) for code, val
-00010040: 7565 2069 6e20 7a69 7028 6e70 636f 6e74  ue in zip(npcont
-00010050: 6578 745b 3a2c 2031 5d2c 206e 7063 6f6e  ext[:, 1], npcon
-00010060: 7465 7874 5b3a 2c20 335d 295d 0a20 2020  text[:, 3])].   
-00010070: 206e 7063 6f6e 7465 7874 5b6d 6173 6b2c   npcontext[mask,
-00010080: 2033 5d20 3d20 310a 2020 2020 636f 6465   3] = 1.    code
-00010090: 5f77 6974 685f 736f 7572 6365 203d 205b  _with_source = [
-000100a0: 6626 2333 343b 7b63 6f64 657d 7b73 6f75  f&#34;{code}{sou
-000100b0: 7263 657d 2623 3334 3b20 6966 2073 6f75  rce}&#34; if sou
-000100c0: 7263 655b 305d 203d 3d20 2623 3334 3b40  rce[0] == &#34;@
-000100d0: 2623 3334 3b20 656c 7365 2066 2623 3334  &#34; else f&#34
-000100e0: 3b7b 636f 6465 7d40 7b73 6f75 7263 657d  ;{code}@{source}
-000100f0: 2623 3334 3b20 666f 7220 636f 6465 2c20  &#34; for code, 
-00010100: 736f 7572 6365 2069 6e0a 2020 2020 2020  source in.      
-00010110: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010120: 2020 7a69 7028 6e70 636f 6e74 6578 745b    zip(npcontext[
-00010130: 3a2c 2031 5d2c 206e 7063 6f6e 7465 7874  :, 1], npcontext
-00010140: 5b3a 2c20 325d 295d 0a20 2020 206e 7063  [:, 2])].    npc
-00010150: 6f6e 7465 7874 5b3a 2c20 315d 203d 2063  ontext[:, 1] = c
-00010160: 6f64 655f 7769 7468 5f73 6f75 7263 650a  ode_with_source.
-00010170: 0a20 2020 2072 6574 7572 6e20 6e70 636f  .    return npco
-00010180: 6e74 6578 743c 2f63 6f64 653e 3c2f 7072  ntext</code></pr
-00010190: 653e 0a3c 2f64 6574 6169 6c73 3e0a 3c2f  e>.</details>.</
-000101a0: 6464 3e0a 3c64 7420 6964 3d22 5064 6d43  dd>.<dt id="PdmC
-000101b0: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
-000101c0: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
-000101d0: 4765 6e65 7261 746f 722e 6164 645f 746f  Generator.add_to
-000101e0: 5f62 7566 6665 7222 3e3c 636f 6465 2063  _buffer"><code c
-000101f0: 6c61 7373 3d22 6e61 6d65 2066 6c65 7822  lass="name flex"
-00010200: 3e0a 3c73 7061 6e3e 6465 6620 3c73 7061  >.<span>def <spa
-00010210: 6e20 636c 6173 733d 2269 6465 6e74 223e  n class="ident">
-00010220: 6164 645f 746f 5f62 7566 6665 723c 2f73  add_to_buffer</s
-00010230: 7061 6e3e 3c2f 7370 616e 3e28 3c73 7061  pan></span>(<spa
-00010240: 6e3e 7365 6c66 2c20 653a c2a0 3c61 2074  n>self, e:..<a t
-00010250: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
-00010260: 2e75 7469 6c73 2e73 7472 7563 7475 7265  .utils.structure
-00010270: 2e45 7665 6e74 706f 696e 7422 2068 7265  .Eventpoint" hre
-00010280: 663d 2275 7469 6c73 2f73 7472 7563 7475  f="utils/structu
-00010290: 7265 2e68 746d 6c23 5064 6d43 6f6e 7465  re.html#PdmConte
-000102a0: 7874 2e75 7469 6c73 2e73 7472 7563 7475  xt.utils.structu
-000102b0: 7265 2e45 7665 6e74 706f 696e 7422 3e45  re.Eventpoint">E
-000102c0: 7665 6e74 706f 696e 743c 2f61 3e29 3c2f  ventpoint</a>)</
-000102d0: 7370 616e 3e0a 3c2f 636f 6465 3e3c 2f64  span>.</code></d
-000102e0: 743e 0a3c 6464 3e0a 3c64 6976 2063 6c61  t>.<dd>.<div cla
-000102f0: 7373 3d22 6465 7363 223e 3c70 3e41 6464  ss="desc"><p>Add
-00010300: 7320 616e 2045 7665 6e74 2070 6f69 6e74  s an Event point
-00010310: 2074 6f20 7468 6520 6275 6666 6572 2028   to the buffer (
-00010320: 6b65 6570 696e 6720 7468 6520 6275 6666  keeping the buff
-00010330: 6572 2074 696d 6520 6f72 6465 7265 6429  er time ordered)
-00010340: 3c2f 703e 3c2f 6469 763e 0a3c 6465 7461  </p></div>.<deta
-00010350: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
-00010360: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
-00010370: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
-00010380: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
-00010390: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
-000103a0: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
-000103b0: 6e22 3e64 6566 2061 6464 5f74 6f5f 6275  n">def add_to_bu
-000103c0: 6666 6572 2873 656c 662c 2065 3a20 4576  ffer(self, e: Ev
-000103d0: 656e 7470 6f69 6e74 293a 0a20 2020 2026  entpoint):.    &
-000103e0: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-000103f0: 2020 2041 6464 7320 616e 2045 7665 6e74     Adds an Event
-00010400: 2070 6f69 6e74 2074 6f20 7468 6520 6275   point to the bu
-00010410: 6666 6572 2028 6b65 6570 696e 6720 7468  ffer (keeping th
-00010420: 6520 6275 6666 6572 2074 696d 6520 6f72  e buffer time or
-00010430: 6465 7265 6429 0a20 2020 2026 2333 343b  dered).    &#34;
-00010440: 2623 3334 3b26 2333 343b 0a20 2020 2069  &#34;&#34;.    i
-00010450: 6e64 6578 203d 206c 656e 2873 656c 662e  ndex = len(self.
-00010460: 6275 6666 6572 290a 2020 2020 666f 7220  buffer).    for 
-00010470: 6920 696e 2072 616e 6765 286c 656e 2873  i in range(len(s
-00010480: 656c 662e 6275 6666 6572 2920 2d20 312c  elf.buffer) - 1,
-00010490: 2030 2c20 2d31 293a 0a20 2020 2020 2020   0, -1):.       
-000104a0: 2069 6620 7365 6c66 2e62 7566 6665 725b   if self.buffer[
-000104b0: 695d 2e74 696d 6573 7461 6d70 2026 6c74  i].timestamp &lt
-000104c0: 3b3d 2065 2e74 696d 6573 7461 6d70 3a0a  ;= e.timestamp:.
-000104d0: 2020 2020 2020 2020 2020 2020 696e 6465              inde
-000104e0: 7820 3d20 6920 2b20 310a 2020 2020 2020  x = i + 1.      
-000104f0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-00010500: 6966 2069 6e64 6578 203d 3d20 6c65 6e28  if index == len(
-00010510: 7365 6c66 2e62 7566 6665 7229 3a0a 2020  self.buffer):.  
-00010520: 2020 2020 2020 7365 6c66 2e62 7566 6665        self.buffe
-00010530: 722e 6170 7065 6e64 2865 290a 2020 2020  r.append(e).    
-00010540: 656c 7365 3a0a 2020 2020 2020 2020 7365  else:.        se
-00010550: 6c66 2e62 7566 6665 7220 3d20 7365 6c66  lf.buffer = self
-00010560: 2e62 7566 6665 725b 3a20 696e 6465 785d  .buffer[: index]
-00010570: 202b 205b 655d 202b 2073 656c 662e 6275   + [e] + self.bu
-00010580: 6666 6572 5b69 6e64 6578 3a5d 0a0a 2020  ffer[index:]..  
-00010590: 2020 6c61 7374 203d 2073 656c 662e 6275    last = self.bu
-000105a0: 6666 6572 5b2d 315d 0a20 2020 2070 6f73  ffer[-1].    pos
-000105b0: 203d 206c 656e 2873 656c 662e 6275 6666   = len(self.buff
-000105c0: 6572 2920 2d20 310a 2020 2020 666f 7220  er) - 1.    for 
-000105d0: 6920 696e 2072 616e 6765 286c 656e 2873  i in range(len(s
-000105e0: 656c 662e 6275 6666 6572 2929 3a0a 2020  elf.buffer)):.  
-000105f0: 2020 2020 2020 6966 2073 656c 662e 6275        if self.bu
-00010600: 6666 6572 5b69 5d2e 7469 6d65 7374 616d  ffer[i].timestam
-00010610: 7020 2667 743b 3d20 286c 6173 742e 7469  p &gt;= (last.ti
-00010620: 6d65 7374 616d 7020 2d20 7064 2e54 696d  mestamp - pd.Tim
-00010630: 6564 656c 7461 2873 656c 662e 686f 7269  edelta(self.hori
-00010640: 7a6f 6e2c 2073 656c 662e 686f 7269 7a6f  zon, self.horizo
-00010650: 6e5f 7469 6d65 2929 3a0a 2020 2020 2020  n_time)):.      
-00010660: 2020 2020 2020 706f 7320 3d20 690a 2020        pos = i.  
-00010670: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-00010680: 2020 2020 7365 6c66 2e62 7566 6665 7220      self.buffer 
-00010690: 3d20 7365 6c66 2e62 7566 6665 725b 706f  = self.buffer[po
-000106a0: 733a 5d3c 2f63 6f64 653e 3c2f 7072 653e  s:]</code></pre>
-000106b0: 0a3c 2f64 6574 6169 6c73 3e0a 3c2f 6464  .</details>.</dd
-000106c0: 3e0a 3c64 7420 6964 3d22 5064 6d43 6f6e  >.<dt id="PdmCon
-000106d0: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
-000106e0: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
-000106f0: 6e65 7261 746f 722e 6275 696c 645f 636f  nerator.build_co
-00010700: 6e74 6578 745f 666f 725f 636f 6e66 6975  ntext_for_confiu
-00010710: 6775 7261 7469 6f6e 223e 3c63 6f64 6520  guration"><code 
-00010720: 636c 6173 733d 226e 616d 6520 666c 6578  class="name flex
-00010730: 223e 0a3c 7370 616e 3e64 6566 203c 7370  ">.<span>def <sp
-00010740: 616e 2063 6c61 7373 3d22 6964 656e 7422  an class="ident"
-00010750: 3e62 7569 6c64 5f63 6f6e 7465 7874 5f66  >build_context_f
-00010760: 6f72 5f63 6f6e 6669 7567 7572 6174 696f  or_confiuguratio
-00010770: 6e3c 2f73 7061 6e3e 3c2f 7370 616e 3e28  n</span></span>(
-00010780: 3c73 7061 6e3e 7365 6c66 2c20 7461 7267  <span>self, targ
-00010790: 6574 5f73 6572 6965 732c 206f 6363 7572  et_series, occur
-000107a0: 656e 6369 6573 293c 2f73 7061 6e3e 0a3c  encies)</span>.<
-000107b0: 2f63 6f64 653e 3c2f 6474 3e0a 3c64 643e  /code></dt>.<dd>
-000107c0: 0a3c 6469 7620 636c 6173 733d 2264 6573  .<div class="des
-000107d0: 6322 3e3c 2f64 6976 3e0a 3c64 6574 6169  c"></div>.<detai
-000107e0: 6c73 2063 6c61 7373 3d22 736f 7572 6365  ls class="source
-000107f0: 223e 0a3c 7375 6d6d 6172 793e 0a3c 7370  ">.<summary>.<sp
-00010800: 616e 3e45 7870 616e 6420 736f 7572 6365  an>Expand source
-00010810: 2063 6f64 653c 2f73 7061 6e3e 0a3c 2f73   code</span>.</s
-00010820: 756d 6d61 7279 3e0a 3c70 7265 3e3c 636f  ummary>.<pre><co
-00010830: 6465 2063 6c61 7373 3d22 7079 7468 6f6e  de class="python
-00010840: 223e 6465 6620 6275 696c 645f 636f 6e74  ">def build_cont
-00010850: 6578 745f 666f 725f 636f 6e66 6975 6775  ext_for_confiugu
-00010860: 7261 7469 6f6e 2873 656c 662c 2074 6172  ration(self, tar
-00010870: 6765 745f 7365 7269 6573 2c20 6f63 6375  get_series, occu
-00010880: 7265 6e63 6965 7329 3a0a 2020 2020 7665  rencies):.    ve
-00010890: 6374 6f72 203d 205b 3020 666f 7220 6920  ctor = [0 for i 
-000108a0: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
-000108b0: 6765 745f 7365 7269 6573 2929 5d0a 2020  get_series))].  
-000108c0: 2020 666f 7220 6f63 6320 696e 206f 6363    for occ in occ
-000108d0: 7572 656e 6369 6573 3a0a 2020 2020 2020  urencies:.      
-000108e0: 2020 666f 7220 7120 696e 2072 616e 6765    for q in range
-000108f0: 286c 656e 2874 6172 6765 745f 7365 7269  (len(target_seri
-00010900: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
-00010910: 2020 6966 2074 6172 6765 745f 7365 7269    if target_seri
-00010920: 6573 5b71 5d5b 315d 2026 6774 3b3d 206f  es[q][1] &gt;= o
-00010930: 6363 5b31 5d3a 0a20 2020 2020 2020 2020  cc[1]:.         
-00010940: 2020 2020 2020 2066 6f72 206b 2069 6e20         for k in 
-00010950: 7261 6e67 6528 712c 206c 656e 2876 6563  range(q, len(vec
-00010960: 746f 7229 293a 0a20 2020 2020 2020 2020  tor)):.         
-00010970: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
-00010980: 725b 6b5d 202b 3d20 310a 2020 2020 2020  r[k] += 1.      
-00010990: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
-000109a0: 2020 2020 2323 206e 6f74 2073 7461 626c      ## not stabl
-000109b0: 650a 2020 2020 6966 206c 656e 2873 6574  e.    if len(set
-000109c0: 2876 6563 746f 7229 2920 3d3d 2031 3a0a  (vector)) == 1:.
-000109d0: 2020 2020 2020 2020 7665 6374 6f72 5b30          vector[0
-000109e0: 5d20 3d20 300a 2020 2020 7265 7475 726e  ] = 0.    return
-000109f0: 2076 6563 746f 723c 2f63 6f64 653e 3c2f   vector</code></
-00010a00: 7072 653e 0a3c 2f64 6574 6169 6c73 3e0a  pre>.</details>.
-00010a10: 3c2f 6464 3e0a 3c64 7420 6964 3d22 5064  </dd>.<dt id="Pd
-00010a20: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
-00010a30: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
-00010a40: 7874 4765 6e65 7261 746f 722e 6275 696c  xtGenerator.buil
-00010a50: 645f 636f 6e74 6578 745f 666f 725f 6973  d_context_for_is
-00010a60: 6f6c 6174 6564 223e 3c63 6f64 6520 636c  olated"><code cl
-00010a70: 6173 733d 226e 616d 6520 666c 6578 223e  ass="name flex">
-00010a80: 0a3c 7370 616e 3e64 6566 203c 7370 616e  .<span>def <span
-00010a90: 2063 6c61 7373 3d22 6964 656e 7422 3e62   class="ident">b
-00010aa0: 7569 6c64 5f63 6f6e 7465 7874 5f66 6f72  uild_context_for
-00010ab0: 5f69 736f 6c61 7465 643c 2f73 7061 6e3e  _isolated</span>
-00010ac0: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
-00010ad0: 6c66 2c20 7461 7267 6574 5f73 6572 6965  lf, target_serie
-00010ae0: 732c 206f 6363 7572 656e 6369 6573 293c  s, occurencies)<
-00010af0: 2f73 7061 6e3e 0a3c 2f63 6f64 653e 3c2f  /span>.</code></
-00010b00: 6474 3e0a 3c64 643e 0a3c 6469 7620 636c  dt>.<dd>.<div cl
-00010b10: 6173 733d 2264 6573 6322 3e3c 2f64 6976  ass="desc"></div
-00010b20: 3e0a 3c64 6574 6169 6c73 2063 6c61 7373  >.<details class
-00010b30: 3d22 736f 7572 6365 223e 0a3c 7375 6d6d  ="source">.<summ
-00010b40: 6172 793e 0a3c 7370 616e 3e45 7870 616e  ary>.<span>Expan
-00010b50: 6420 736f 7572 6365 2063 6f64 653c 2f73  d source code</s
-00010b60: 7061 6e3e 0a3c 2f73 756d 6d61 7279 3e0a  pan>.</summary>.
-00010b70: 3c70 7265 3e3c 636f 6465 2063 6c61 7373  <pre><code class
-00010b80: 3d22 7079 7468 6f6e 223e 6465 6620 6275  ="python">def bu
-00010b90: 696c 645f 636f 6e74 6578 745f 666f 725f  ild_context_for_
-00010ba0: 6973 6f6c 6174 6564 2873 656c 662c 2074  isolated(self, t
-00010bb0: 6172 6765 745f 7365 7269 6573 2c20 6f63  arget_series, oc
-00010bc0: 6375 7265 6e63 6965 7329 3a0a 2020 2020  curencies):.    
-00010bd0: 7665 6374 6f72 203d 205b 3020 666f 7220  vector = [0 for 
-00010be0: 6920 696e 2072 616e 6765 286c 656e 2874  i in range(len(t
-00010bf0: 6172 6765 745f 7365 7269 6573 2929 5d0a  arget_series))].
-00010c00: 2020 2020 666f 7220 6f63 6320 696e 206f      for occ in o
-00010c10: 6363 7572 656e 6369 6573 3a0a 2020 2020  ccurencies:.    
-00010c20: 2020 2020 666f 7220 7120 696e 2072 616e      for q in ran
-00010c30: 6765 286c 656e 2874 6172 6765 745f 7365  ge(len(target_se
-00010c40: 7269 6573 2929 3a0a 2020 2020 2020 2020  ries)):.        
-00010c50: 2020 2020 6966 2074 6172 6765 745f 7365      if target_se
-00010c60: 7269 6573 5b71 5d5b 315d 2026 6774 3b20  ries[q][1] &gt; 
-00010c70: 6f63 635b 315d 3a0a 2020 2020 2020 2020  occ[1]:.        
-00010c80: 2020 2020 2020 2020 7665 6374 6f72 5b71          vector[q
-00010c90: 5d20 3d20 310a 2020 2020 2020 2020 2020  ] = 1.          
-00010ca0: 2020 2020 2020 6272 6561 6b0a 2020 2020        break.    
-00010cb0: 7265 7475 726e 2076 6563 746f 723c 2f63  return vector</c
-00010cc0: 6f64 653e 3c2f 7072 653e 0a3c 2f64 6574  ode></pre>.</det
-00010cd0: 6169 6c73 3e0a 3c2f 6464 3e0a 3c64 7420  ails>.</dd>.<dt 
-00010ce0: 6964 3d22 5064 6d43 6f6e 7465 7874 2e43  id="PdmContext.C
-00010cf0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-00010d00: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-00010d10: 722e 6275 696c 645f 636f 6e74 6578 745f  r.build_context_
-00010d20: 666f 725f 756e 6976 6172 6961 7465 223e  for_univariate">
-00010d30: 3c63 6f64 6520 636c 6173 733d 226e 616d  <code class="nam
-00010d40: 6520 666c 6578 223e 0a3c 7370 616e 3e64  e flex">.<span>d
-00010d50: 6566 203c 7370 616e 2063 6c61 7373 3d22  ef <span class="
-00010d60: 6964 656e 7422 3e62 7569 6c64 5f63 6f6e  ident">build_con
-00010d70: 7465 7874 5f66 6f72 5f75 6e69 7661 7269  text_for_univari
-00010d80: 6174 653c 2f73 7061 6e3e 3c2f 7370 616e  ate</span></span
-00010d90: 3e28 3c73 7061 6e3e 7365 6c66 2c20 7461  >(<span>self, ta
-00010da0: 7267 6574 5f73 6572 6965 732c 206f 6363  rget_series, occ
-00010db0: 7572 656e 6369 6573 293c 2f73 7061 6e3e  urencies)</span>
-00010dc0: 0a3c 2f63 6f64 653e 3c2f 6474 3e0a 3c64  .</code></dt>.<d
-00010dd0: 643e 0a3c 6469 7620 636c 6173 733d 2264  d>.<div class="d
-00010de0: 6573 6322 3e3c 2f64 6976 3e0a 3c64 6574  esc"></div>.<det
-00010df0: 6169 6c73 2063 6c61 7373 3d22 736f 7572  ails class="sour
-00010e00: 6365 223e 0a3c 7375 6d6d 6172 793e 0a3c  ce">.<summary>.<
-00010e10: 7370 616e 3e45 7870 616e 6420 736f 7572  span>Expand sour
-00010e20: 6365 2063 6f64 653c 2f73 7061 6e3e 0a3c  ce code</span>.<
-00010e30: 2f73 756d 6d61 7279 3e0a 3c70 7265 3e3c  /summary>.<pre><
-00010e40: 636f 6465 2063 6c61 7373 3d22 7079 7468  code class="pyth
-00010e50: 6f6e 223e 6465 6620 6275 696c 645f 636f  on">def build_co
-00010e60: 6e74 6578 745f 666f 725f 756e 6976 6172  ntext_for_univar
-00010e70: 6961 7465 2873 656c 662c 2074 6172 6765  iate(self, targe
-00010e80: 745f 7365 7269 6573 2c20 6f63 6375 7265  t_series, occure
-00010e90: 6e63 6965 7329 3a0a 2020 2020 616c 6c76  ncies):.    allv
-00010ea0: 616c 7565 7320 3d20 5b5d 0a20 2020 2076  alues = [].    v
-00010eb0: 6563 746f 7220 3d20 5b30 2066 6f72 2069  ector = [0 for i
-00010ec0: 2069 6e20 7261 6e67 6528 6c65 6e28 7461   in range(len(ta
-00010ed0: 7267 6574 5f73 6572 6965 7329 295d 0a20  rget_series))]. 
-00010ee0: 2020 2070 6f73 203d 2030 0a20 2020 2066     pos = 0.    f
-00010ef0: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
-00010f00: 6e28 7461 7267 6574 5f73 6572 6965 7329  n(target_series)
-00010f10: 293a 0a20 2020 2020 2020 2074 696d 6573  ):.        times
-00010f20: 7461 6d70 203d 2074 6172 6765 745f 7365  tamp = target_se
-00010f30: 7269 6573 5b69 5d5b 315d 0a20 2020 2020  ries[i][1].     
-00010f40: 2020 2063 7572 7265 6e74 5f70 6f73 203d     current_pos =
-00010f50: 2070 6f73 0a20 2020 2020 2020 2066 6f72   pos.        for
-00010f60: 2071 2069 6e20 7261 6e67 6528 706f 732c   q in range(pos,
-00010f70: 206c 656e 286f 6363 7572 656e 6369 6573   len(occurencies
-00010f80: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
-00010f90: 6966 206f 6363 7572 656e 6369 6573 5b71  if occurencies[q
-00010fa0: 5d5b 315d 2026 6774 3b20 7469 6d65 7374  ][1] &gt; timest
-00010fb0: 616d 703a 0a20 2020 2020 2020 2020 2020  amp:.           
-00010fc0: 2020 2020 2063 7572 7265 6e74 5f70 6f73       current_pos
-00010fd0: 203d 2071 0a20 2020 2020 2020 2020 2020   = q.           
-00010fe0: 2020 2020 2062 7265 616b 0a20 2020 2020       break.     
-00010ff0: 2020 2023 206e 6f20 6461 7461 2066 6f75     # no data fou
-00011000: 6e64 0a0a 2020 2020 2020 2020 6966 2063  nd..        if c
-00011010: 7572 7265 6e74 5f70 6f73 203d 3d20 706f  urrent_pos == po
-00011020: 733a 0a20 2020 2020 2020 2020 2020 2023  s:.            #
-00011030: 2069 6620 6e6f 2064 6174 6120 696e 2062   if no data in b
-00011040: 6574 7777 656e 2076 616c 7565 7320 7573  etwwen values us
-00011050: 6520 7468 6520 7072 6576 6975 7320 7661  e the previus va
-00011060: 6c75 650a 2020 2020 2020 2020 2020 2020  lue.            
-00011070: 6966 2069 2026 6774 3b20 303a 0a20 2020  if i &gt; 0:.   
-00011080: 2020 2020 2020 2020 2020 2020 2076 6563               vec
-00011090: 746f 725b 695d 203d 2076 6563 746f 725b  tor[i] = vector[
-000110a0: 6920 2d20 315d 0a20 2020 2020 2020 2020  i - 1].         
-000110b0: 2020 2023 2069 6620 6e6f 2064 6174 6120     # if no data 
-000110c0: 756e 7469 6c20 6920 7469 6d65 7374 616d  until i timestam
-000110d0: 7020 7573 6520 7468 6520 6669 7273 7420  p use the first 
-000110e0: 6f63 6375 7265 6e63 6520 6173 2076 616c  occurence as val
-000110f0: 7565 0a20 2020 2020 2020 2020 2020 2065  ue.            e
-00011100: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-00011110: 2020 2020 2076 6563 746f 725b 695d 203d       vector[i] =
-00011120: 206f 6363 7572 656e 6369 6573 5b30 5d5b   occurencies[0][
-00011130: 305d 0a20 2020 2020 2020 2023 2069 6620  0].        # if 
-00011140: 6d75 6c74 6970 6c65 2076 616c 7565 7320  multiple values 
-00011150: 696e 2062 6574 7765 656e 2074 776f 2074  in between two t
-00011160: 696d 6573 7461 6d70 7320 7573 6520 7468  imestamps use th
-00011170: 6520 6d65 616e 206f 6620 7468 656d 2061  e mean of them a
-00011180: 7320 7661 6c75 650a 2020 2020 2020 2020  s value.        
-00011190: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
-000111a0: 2020 6461 7461 496e 4265 7477 6565 6e20    dataInBetween 
-000111b0: 3d20 5b76 616c 7565 2066 6f72 2076 616c  = [value for val
-000111c0: 7565 2c20 7469 6d65 2069 6e20 6f63 6375  ue, time in occu
-000111d0: 7265 6e63 6965 735b 706f 733a 6375 7272  rencies[pos:curr
-000111e0: 656e 745f 706f 735d 5d0a 2020 2020 2020  ent_pos]].      
-000111f0: 2020 2020 2020 7665 6374 6f72 5b69 5d20        vector[i] 
-00011200: 3d20 7375 6d28 6461 7461 496e 4265 7477  = sum(dataInBetw
-00011210: 6565 6e29 202f 206c 656e 2864 6174 6149  een) / len(dataI
-00011220: 6e42 6574 7765 656e 290a 2020 2020 2020  nBetween).      
-00011230: 2020 2320 6966 206e 6f20 6f74 6865 7220    # if no other 
-00011240: 6f63 6375 7265 6e63 6965 7320 6a75 7374  occurencies just
-00011250: 2072 6570 6561 7420 7468 6520 6c61 7374   repeat the last
-00011260: 2076 616c 7565 0a20 2020 2020 2020 2069   value.        i
-00011270: 6620 6375 7272 656e 745f 706f 7320 3d3d  f current_pos ==
-00011280: 206c 656e 286f 6363 7572 656e 6369 6573   len(occurencies
-00011290: 293a 0a20 2020 2020 2020 2020 2020 2066  ):.            f
-000112a0: 6f72 206b 2069 6e20 7261 6e67 6528 6920  or k in range(i 
-000112b0: 2b20 312c 206c 656e 2876 6563 746f 7229  + 1, len(vector)
-000112c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000112d0: 2020 2076 6563 746f 725b 6b5d 203d 2076     vector[k] = v
-000112e0: 6563 746f 725b 6b20 2d20 315d 0a20 2020  ector[k - 1].   
-000112f0: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
-00011300: 2020 2020 2020 2070 6f73 203d 2063 7572         pos = cur
-00011310: 7265 6e74 5f70 6f73 0a0a 2020 2020 7265  rent_pos..    re
-00011320: 7475 726e 2076 6563 746f 723c 2f63 6f64  turn vector</cod
-00011330: 653e 3c2f 7072 653e 0a3c 2f64 6574 6169  e></pre>.</detai
-00011340: 6c73 3e0a 3c2f 6464 3e0a 3c64 7420 6964  ls>.</dd>.<dt id
-00011350: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
-00011360: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
-00011370: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
-00011380: 6275 696c 645f 7461 7267 6574 5f73 6572  build_target_ser
-00011390: 6965 735f 666f 725f 636f 6e74 6578 7422  ies_for_context"
-000113a0: 3e3c 636f 6465 2063 6c61 7373 3d22 6e61  ><code class="na
-000113b0: 6d65 2066 6c65 7822 3e0a 3c73 7061 6e3e  me flex">.<span>
-000113c0: 6465 6620 3c73 7061 6e20 636c 6173 733d  def <span class=
-000113d0: 2269 6465 6e74 223e 6275 696c 645f 7461  "ident">build_ta
-000113e0: 7267 6574 5f73 6572 6965 735f 666f 725f  rget_series_for_
-000113f0: 636f 6e74 6578 743c 2f73 7061 6e3e 3c2f  context</span></
-00011400: 7370 616e 3e28 3c73 7061 6e3e 7365 6c66  span>(<span>self
-00011410: 2c20 6375 7272 656e 743a c2a0 3c61 2074  , current:..<a t
-00011420: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
-00011430: 2e75 7469 6c73 2e73 7472 7563 7475 7265  .utils.structure
-00011440: 2e45 7665 6e74 706f 696e 7422 2068 7265  .Eventpoint" hre
-00011450: 663d 2275 7469 6c73 2f73 7472 7563 7475  f="utils/structu
-00011460: 7265 2e68 746d 6c23 5064 6d43 6f6e 7465  re.html#PdmConte
-00011470: 7874 2e75 7469 6c73 2e73 7472 7563 7475  xt.utils.structu
-00011480: 7265 2e45 7665 6e74 706f 696e 7422 3e45  re.Eventpoint">E
-00011490: 7665 6e74 706f 696e 743c 2f61 3e2c 2064  ventpoint</a>, d
-000114a0: 663a c2a0 6e75 6d70 792e 6e64 6172 7261  f:..numpy.ndarra
-000114b0: 7929 3c2f 7370 616e 3e0a 3c2f 636f 6465  y)</span>.</code
-000114c0: 3e3c 2f64 743e 0a3c 6464 3e0a 3c64 6976  ></dt>.<dd>.<div
-000114d0: 2063 6c61 7373 3d22 6465 7363 223e 3c2f   class="desc"></
-000114e0: 6469 763e 0a3c 6465 7461 696c 7320 636c  div>.<details cl
-000114f0: 6173 733d 2273 6f75 7263 6522 3e0a 3c73  ass="source">.<s
-00011500: 756d 6d61 7279 3e0a 3c73 7061 6e3e 4578  ummary>.<span>Ex
-00011510: 7061 6e64 2073 6f75 7263 6520 636f 6465  pand source code
-00011520: 3c2f 7370 616e 3e0a 3c2f 7375 6d6d 6172  </span>.</summar
-00011530: 793e 0a3c 7072 653e 3c63 6f64 6520 636c  y>.<pre><code cl
-00011540: 6173 733d 2270 7974 686f 6e22 3e64 6566  ass="python">def
-00011550: 2062 7569 6c64 5f74 6172 6765 745f 7365   build_target_se
-00011560: 7269 6573 5f66 6f72 5f63 6f6e 7465 7874  ries_for_context
-00011570: 2873 656c 662c 2063 7572 7265 6e74 3a20  (self, current: 
-00011580: 4576 656e 7470 6f69 6e74 2c20 6466 3a20  Eventpoint, df: 
-00011590: 6e70 2e6e 6461 7272 6179 293a 0a20 2020  np.ndarray):.   
-000115a0: 2074 6172 6765 745f 7365 7269 6573 5f6e   target_series_n
-000115b0: 616d 6520 3d20 6375 7272 656e 742e 636f  ame = current.co
-000115c0: 6465 0a20 2020 2077 696e 646f 7776 616c  de.    windowval
-000115d0: 7565 7320 3d20 6466 2020 2320 2e76 616c  ues = df  # .val
-000115e0: 7565 730a 2020 2020 7461 7267 6574 5f73  ues.    target_s
-000115f0: 6572 6965 7320 3d20 5b28 7661 6c75 652c  eries = [(value,
-00011600: 2074 696d 6529 2066 6f72 2063 6f64 652c   time) for code,
-00011610: 2076 616c 7565 2c20 7469 6d65 2069 6e0a   value, time in.
-00011620: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011630: 2020 2020 207a 6970 2877 696e 646f 7776       zip(windowv
-00011640: 616c 7565 735b 3a2c 2031 5d2c 2077 696e  alues[:, 1], win
-00011650: 646f 7776 616c 7565 735b 3a2c 2033 5d2c  dowvalues[:, 3],
-00011660: 2077 696e 646f 7776 616c 7565 735b 3a2c   windowvalues[:,
-00011670: 2030 5d29 2069 6620 7461 7267 6574 5f73   0]) if target_s
-00011680: 6572 6965 735f 6e61 6d65 2069 6e20 636f  eries_name in co
-00011690: 6465 5d0a 0a20 2020 2072 6574 7572 6e20  de]..    return 
-000116a0: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
-000116b0: 6d65 2c20 7461 7267 6574 5f73 6572 6965  me, target_serie
-000116c0: 733c 2f63 6f64 653e 3c2f 7072 653e 0a3c  s</code></pre>.<
-000116d0: 2f64 6574 6169 6c73 3e0a 3c2f 6464 3e0a  /details>.</dd>.
-000116e0: 3c64 7420 6964 3d22 5064 6d43 6f6e 7465  <dt id="PdmConte
-000116f0: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
-00011700: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
-00011710: 7261 746f 722e 6361 6c63 756c 6174 655f  rator.calculate_
-00011720: 6361 7573 616c 6974 7922 3e3c 636f 6465  causality"><code
-00011730: 2063 6c61 7373 3d22 6e61 6d65 2066 6c65   class="name fle
-00011740: 7822 3e0a 3c73 7061 6e3e 6465 6620 3c73  x">.<span>def <s
-00011750: 7061 6e20 636c 6173 733d 2269 6465 6e74  pan class="ident
-00011760: 223e 6361 6c63 756c 6174 655f 6361 7573  ">calculate_caus
-00011770: 616c 6974 793c 2f73 7061 6e3e 3c2f 7370  ality</span></sp
-00011780: 616e 3e28 3c73 7061 6e3e 7365 6c66 2c20  an>(<span>self, 
-00011790: 6461 7461 6f72 2c20 6e61 6d65 7329 3c2f  dataor, names)</
-000117a0: 7370 616e 3e0a 3c2f 636f 6465 3e3c 2f64  span>.</code></d
-000117b0: 743e 0a3c 6464 3e0a 3c64 6976 2063 6c61  t>.<dd>.<div cla
-000117c0: 7373 3d22 6465 7363 223e 3c2f 6469 763e  ss="desc"></div>
-000117d0: 0a3c 6465 7461 696c 7320 636c 6173 733d  .<details class=
-000117e0: 2273 6f75 7263 6522 3e0a 3c73 756d 6d61  "source">.<summa
-000117f0: 7279 3e0a 3c73 7061 6e3e 4578 7061 6e64  ry>.<span>Expand
-00011800: 2073 6f75 7263 6520 636f 6465 3c2f 7370   source code</sp
-00011810: 616e 3e0a 3c2f 7375 6d6d 6172 793e 0a3c  an>.</summary>.<
-00011820: 7072 653e 3c63 6f64 6520 636c 6173 733d  pre><code class=
-00011830: 2270 7974 686f 6e22 3e64 6566 2063 616c  "python">def cal
-00011840: 6375 6c61 7465 5f63 6175 7361 6c69 7479  culate_causality
-00011850: 2873 656c 662c 2064 6174 616f 722c 206e  (self, dataor, n
-00011860: 616d 6573 293a 0a20 2020 206e 756d 5f74  ames):.    num_t
-00011870: 696d 655f 7365 7269 6573 203d 206c 656e  ime_series = len
-00011880: 2864 6174 616f 7229 0a20 2020 2064 6174  (dataor).    dat
-00011890: 6120 3d20 6e70 2e61 7272 6179 2864 6174  a = np.array(dat
-000118a0: 616f 7229 0a20 2020 2065 6467 6573 203d  aor).    edges =
-000118b0: 2073 656c 662e 6361 7573 616c 6974 795f   self.causality_
-000118c0: 6469 7363 6f76 6572 7928 6e61 6d65 732c  discovery(names,
-000118d0: 2064 6174 6129 0a20 2020 2023 2065 6467   data).    # edg
-000118e0: 6573 3d73 656c 662e 6361 6c63 756c 6174  es=self.calculat
-000118f0: 6577 6974 6850 6328 6e61 6d65 732c 6461  ewithPc(names,da
-00011900: 7461 290a 2020 2020 2320 6564 6765 733d  ta).    # edges=
-00011910: 7365 6c66 2e63 616c 6375 6c61 7465 7769  self.calculatewi
-00011920: 7468 5f66 6369 286e 616d 6573 2c64 6174  th_fci(names,dat
-00011930: 6129 0a20 2020 2023 2065 6467 6573 3d73  a).    # edges=s
-00011940: 656c 662e 7361 6c65 7366 6f72 6365 5043  elf.salesforcePC
-00011950: 286e 616d 6573 2c64 6174 6129 0a20 2020  (names,data).   
-00011960: 2072 6574 7572 6e20 6564 6765 733c 2f63   return edges</c
-00011970: 6f64 653e 3c2f 7072 653e 0a3c 2f64 6574  ode></pre>.</det
-00011980: 6169 6c73 3e0a 3c2f 6464 3e0a 3c64 7420  ails>.</dd>.<dt 
-00011990: 6964 3d22 5064 6d43 6f6e 7465 7874 2e43  id="PdmContext.C
-000119a0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-000119b0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-000119c0: 722e 6361 6c63 756c 6174 655f 6564 6765  r.calculate_edge
-000119d0: 7322 3e3c 636f 6465 2063 6c61 7373 3d22  s"><code class="
-000119e0: 6e61 6d65 2066 6c65 7822 3e0a 3c73 7061  name flex">.<spa
-000119f0: 6e3e 6465 6620 3c73 7061 6e20 636c 6173  n>def <span clas
-00011a00: 733d 2269 6465 6e74 223e 6361 6c63 756c  s="ident">calcul
-00011a10: 6174 655f 6564 6765 733c 2f73 7061 6e3e  ate_edges</span>
-00011a20: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
-00011a30: 6c66 2c20 616c 6c64 6174 612c 2074 696d  lf, alldata, tim
-00011a40: 6573 7461 6d70 293c 2f73 7061 6e3e 0a3c  estamp)</span>.<
-00011a50: 2f63 6f64 653e 3c2f 6474 3e0a 3c64 643e  /code></dt>.<dd>
-00011a60: 0a3c 6469 7620 636c 6173 733d 2264 6573  .<div class="des
-00011a70: 6322 3e3c 703e 466f 726d 756c 6174 6520  c"><p>Formulate 
-00011a80: 7468 6520 6461 7461 2069 6e20 6170 7072  the data in appr
-00011a90: 6f70 7269 6174 6520 666f 726d 2074 6f20  opriate form to 
-00011aa0: 6361 6c6c 2073 656c 662e 6361 6c63 756c  call self.calcul
-00011ab0: 6174 655f 6361 7573 616c 6974 790a 7768  ate_causality.wh
-00011ac0: 6963 6820 7265 7475 726e 2074 6865 2065  ich return the e
-00011ad0: 6467 6573 2066 6f72 2074 6865 2063 6f6e  dges for the con
-00011ae0: 7465 7874 2e3c 2f70 3e0a 3c70 3e3c 7374  text.</p>.<p><st
-00011af0: 726f 6e67 3e50 6172 616d 6574 6572 733c  rong>Parameters<
-00011b00: 2f73 7472 6f6e 673e 3a3c 2f70 3e0a 3c70  /strong>:</p>.<p
-00011b10: 3e3c 7374 726f 6e67 3e61 6c6c 6461 7461  ><strong>alldata
-00011b20: 3c2f 7374 726f 6e67 3e3a 2061 2032 4420  </strong>: a 2D 
-00011b30: 6e75 6d70 7920 6172 7261 7920 7769 7468  numpy array with
-00011b40: 2061 6c6c 2073 6572 6965 7320 6461 7461   all series data
-00011b50: 2028 6571 7569 7661 6c65 6e74 2074 6f20   (equivalent to 
-00011b60: 7468 6520 4344 206f 6620 7468 6520 436f  the CD of the Co
-00011b70: 6e74 6578 7429 3c2f 703e 0a3c 703e 3c73  ntext)</p>.<p><s
-00011b80: 7472 6f6e 673e 7469 6d65 7374 616d 703c  trong>timestamp<
-00011b90: 2f73 7472 6f6e 673e 3a20 7469 6d65 7374  /strong>: timest
-00011ba0: 616d 7020 6f66 2074 6865 2063 6f6e 7465  amp of the conte
-00011bb0: 7874 2066 726f 6d20 7768 6963 6820 7468  xt from which th
-00011bc0: 6520 6564 6765 7320 6172 6520 6361 6c63  e edges are calc
-00011bd0: 756c 6174 6564 2e3c 2f70 3e0a 3c70 3e3c  ulated.</p>.<p><
-00011be0: 7374 726f 6e67 3e72 6574 7572 6e3c 2f73  strong>return</s
-00011bf0: 7472 6f6e 673e 3a20 6120 6469 6374 696f  trong>: a dictio
-00011c00: 6e61 7279 2077 6974 6820 2765 6467 6573  nary with 'edges
-00011c10: 2720 6b65 7920 2863 6f6e 7461 696e 696e  ' key (containin
-00011c20: 6720 7468 6520 6361 6c63 756c 6174 6564  g the calculated
-00011c30: 2065 6467 6573 2061 6674 6572 2043 6175   edges after Cau
-00011c40: 7361 6c69 7479 2064 6973 636f 7665 7279  sality discovery
-00011c50: 292e 3c2f 703e 3c2f 6469 763e 0a3c 6465  ).</p></div>.<de
-00011c60: 7461 696c 7320 636c 6173 733d 2273 6f75  tails class="sou
-00011c70: 7263 6522 3e0a 3c73 756d 6d61 7279 3e0a  rce">.<summary>.
-00011c80: 3c73 7061 6e3e 4578 7061 6e64 2073 6f75  <span>Expand sou
-00011c90: 7263 6520 636f 6465 3c2f 7370 616e 3e0a  rce code</span>.
-00011ca0: 3c2f 7375 6d6d 6172 793e 0a3c 7072 653e  </summary>.<pre>
-00011cb0: 3c63 6f64 6520 636c 6173 733d 2270 7974  <code class="pyt
-00011cc0: 686f 6e22 3e64 6566 2063 616c 6375 6c61  hon">def calcula
-00011cd0: 7465 5f65 6467 6573 2873 656c 662c 2061  te_edges(self, a
-00011ce0: 6c6c 6461 7461 2c20 7469 6d65 7374 616d  lldata, timestam
-00011cf0: 7029 3a0a 2020 2020 2623 3334 3b26 2333  p):.    &#34;&#3
-00011d00: 343b 2623 3334 3b0a 2020 2020 466f 726d  4;&#34;.    Form
-00011d10: 756c 6174 6520 7468 6520 6461 7461 2069  ulate the data i
-00011d20: 6e20 6170 7072 6f70 7269 6174 6520 666f  n appropriate fo
-00011d30: 726d 2074 6f20 6361 6c6c 2073 656c 662e  rm to call self.
-00011d40: 6361 6c63 756c 6174 655f 6361 7573 616c  calculate_causal
-00011d50: 6974 790a 2020 2020 7768 6963 6820 7265  ity.    which re
-00011d60: 7475 726e 2074 6865 2065 6467 6573 2066  turn the edges f
-00011d70: 6f72 2074 6865 2063 6f6e 7465 7874 2e0a  or the context..
-00011d80: 0a20 2020 202a 2a50 6172 616d 6574 6572  .    **Parameter
-00011d90: 732a 2a3a 0a0a 2020 2020 2a2a 616c 6c64  s**:..    **alld
-00011da0: 6174 612a 2a3a 2061 2032 4420 6e75 6d70  ata**: a 2D nump
-00011db0: 7920 6172 7261 7920 7769 7468 2061 6c6c  y array with all
-00011dc0: 2073 6572 6965 7320 6461 7461 2028 6571   series data (eq
-00011dd0: 7569 7661 6c65 6e74 2074 6f20 7468 6520  uivalent to the 
-00011de0: 4344 206f 6620 7468 6520 436f 6e74 6578  CD of the Contex
-00011df0: 7429 0a0a 2020 2020 2a2a 7469 6d65 7374  t)..    **timest
-00011e00: 616d 702a 2a3a 2074 696d 6573 7461 6d70  amp**: timestamp
-00011e10: 206f 6620 7468 6520 636f 6e74 6578 7420   of the context 
-00011e20: 6672 6f6d 2077 6869 6368 2074 6865 2065  from which the e
-00011e30: 6467 6573 2061 7265 2063 616c 6375 6c61  dges are calcula
-00011e40: 7465 642e 0a0a 2020 2020 2a2a 7265 7475  ted...    **retu
-00011e50: 726e 2a2a 3a20 6120 6469 6374 696f 6e61  rn**: a dictiona
-00011e60: 7279 2077 6974 6820 2623 3339 3b65 6467  ry with &#39;edg
-00011e70: 6573 2623 3339 3b20 6b65 7920 2863 6f6e  es&#39; key (con
-00011e80: 7461 696e 696e 6720 7468 6520 6361 6c63  taining the calc
-00011e90: 756c 6174 6564 2065 6467 6573 2061 6674  ulated edges aft
-00011ea0: 6572 2043 6175 7361 6c69 7479 2064 6973  er Causality dis
-00011eb0: 636f 7665 7279 292e 0a20 2020 2026 2333  covery)..    &#3
-00011ec0: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
-00011ed0: 2023 2073 7461 7274 203d 2074 696d 652e   # start = time.
-00011ee0: 7469 6d65 2829 0a20 2020 2073 746f 7269  time().    stori
-00011ef0: 6e67 203d 207b 7d0a 2020 2020 7374 6f72  ng = {}.    stor
-00011f00: 696e 675b 2623 3334 3b74 696d 6573 7461  ing[&#34;timesta
-00011f10: 6d70 2623 3334 3b5d 203d 2074 696d 6573  mp&#34;] = times
-00011f20: 7461 6d70 0a0a 2020 2020 616c 6c64 6174  tamp..    alldat
-00011f30: 615f 6e61 6d65 7320 3d20 5b6e 6e5b 305d  a_names = [nn[0]
-00011f40: 2066 6f72 206e 6e20 696e 2061 6c6c 6461   for nn in allda
-00011f50: 7461 5d0a 2020 2020 616c 6c64 6174 615f  ta].    alldata_
-00011f60: 6461 7461 203d 205b 6e6e 5b31 5d20 666f  data = [nn[1] fo
-00011f70: 7220 6e6e 2069 6e20 616c 6c64 6174 615d  r nn in alldata]
-00011f80: 0a0a 2020 2020 666f 7220 6e61 6d65 6464  ..    for namedd
-00011f90: 2c20 6461 7461 6464 2069 6e20 7a69 7028  , datadd in zip(
-00011fa0: 616c 6c64 6174 615f 6e61 6d65 732c 2061  alldata_names, a
-00011fb0: 6c6c 6461 7461 5f64 6174 6129 3a0a 2020  lldata_data):.  
-00011fc0: 2020 2020 2020 7374 6f72 696e 675b 6e61        storing[na
-00011fd0: 6d65 6464 5d20 3d20 6461 7461 6464 0a0a  medd] = datadd..
-00011fe0: 2020 2020 2320 466f 7220 636f 6e74 6578      # For contex
-00011ff0: 7420 7769 7468 206d 6f72 6520 7468 616e  t with more than
-00012000: 2074 776f 2073 6572 6965 7320 6361 6c63   two series calc
-00012010: 756c 6174 6520 5043 2063 6173 7561 6c69  ulate PC casuali
-00012020: 7469 6573 0a20 2020 2063 6f75 6e74 203d  ties.    count =
-00012030: 206c 656e 285b 3120 666f 7220 6c69 7374   len([1 for list
-00012040: 6120 696e 2061 6c6c 6461 7461 5f64 6174  a in alldata_dat
-00012050: 6120 6966 206c 6973 7461 2069 7320 6e6f  a if lista is no
-00012060: 7420 4e6f 6e65 5d29 0a20 2020 2069 6620  t None]).    if 
-00012070: 636f 756e 7420 2667 743b 2031 2061 6e64  count &gt; 1 and
-00012080: 206c 656e 2861 6c6c 6461 7461 5b30 5d5b   len(alldata[0][
-00012090: 315d 2920 2667 743b 2035 3a0a 2020 2020  1]) &gt; 5:.    
-000120a0: 2020 2020 616c 6c64 6174 615f 6e61 6d65      alldata_name
-000120b0: 7320 3d20 5b6e 6e5b 305d 2066 6f72 206e  s = [nn[0] for n
-000120c0: 6e20 696e 2061 6c6c 6461 7461 2069 6620  n in alldata if 
-000120d0: 6e6e 5b31 5d20 6973 206e 6f74 204e 6f6e  nn[1] is not Non
-000120e0: 6520 616e 6420 6c65 6e28 7365 7428 6e6e  e and len(set(nn
-000120f0: 5b31 5d29 2920 2667 743b 2031 5d0a 2020  [1])) &gt; 1].  
-00012100: 2020 2020 2020 616c 6c64 6174 615f 6461        alldata_da
-00012110: 7461 203d 205b 6e6e 5b31 5d20 666f 7220  ta = [nn[1] for 
-00012120: 6e6e 2069 6e20 616c 6c64 6174 6120 6966  nn in alldata if
-00012130: 206e 6e5b 315d 2069 7320 6e6f 7420 4e6f   nn[1] is not No
-00012140: 6e65 2061 6e64 206c 656e 2873 6574 286e  ne and len(set(n
-00012150: 6e5b 315d 2929 2026 6774 3b20 315d 0a0a  n[1])) &gt; 1]..
-00012160: 2020 2020 2020 2020 2320 656e 6420 3d20          # end = 
-00012170: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
-00012180: 2020 2020 2320 7072 696e 7428 6626 2333      # print(f&#3
-00012190: 343b 6265 666f 7265 207b 656e 6420 2d20  4;before {end - 
-000121a0: 7374 6172 747d 2623 3334 3b29 0a20 2020  start}&#34;).   
-000121b0: 2020 2020 2023 2073 7461 7274 3d74 696d       # start=tim
-000121c0: 652e 7469 6d65 2829 0a0a 2020 2020 2020  e.time()..      
-000121d0: 2020 6564 6765 7320 3d20 7365 6c66 2e63    edges = self.c
-000121e0: 616c 6375 6c61 7465 5f63 6175 7361 6c69  alculate_causali
-000121f0: 7479 286e 702e 636f 6c75 6d6e 5f73 7461  ty(np.column_sta
-00012200: 636b 2861 6c6c 6461 7461 5f64 6174 6129  ck(alldata_data)
-00012210: 2c20 616c 6c64 6174 615f 6e61 6d65 7329  , alldata_names)
-00012220: 0a20 2020 2020 2020 2023 2065 6e64 3d74  .        # end=t
-00012230: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
-00012240: 2020 2023 2070 7269 6e74 2866 2623 3334     # print(f&#34
-00012250: 3b61 6374 7561 6c20 6564 6765 2063 616c  ;actual edge cal
-00012260: 6375 6c61 7469 6f6e 207b 656e 642d 7374  culation {end-st
-00012270: 6172 747d 2623 3334 3b29 0a20 2020 2020  art}&#34;).     
-00012280: 2020 2069 6620 6564 6765 7320 6973 204e     if edges is N
-00012290: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-000122a0: 2073 696e 676c 6565 6467 6573 203d 205b   singleedges = [
-000122b0: 5d0a 2020 2020 2020 2020 656c 7365 3a0a  ].        else:.
-000122c0: 2020 2020 2020 2020 2020 2020 7369 6e67              sing
-000122d0: 6c65 6564 6765 7320 3d20 6564 6765 730a  leedges = edges.
-000122e0: 2020 2020 2020 2020 2320 7072 696e 7428          # print(
-000122f0: 6564 6765 7329 0a20 2020 2020 2020 2073  edges).        s
-00012300: 746f 7269 6e67 5b26 2333 343b 6564 6765  toring[&#34;edge
-00012310: 7326 2333 343b 5d20 3d20 7369 6e67 6c65  s&#34;] = single
-00012320: 6564 6765 730a 2020 2020 2020 2020 7265  edges.        re
-00012330: 7475 726e 2073 746f 7269 6e67 0a20 2020  turn storing.   
-00012340: 2073 746f 7269 6e67 5b26 2333 343b 6564   storing[&#34;ed
-00012350: 6765 7326 2333 343b 5d20 3d20 5b5d 0a20  ges&#34;] = []. 
-00012360: 2020 2072 6574 7572 6e20 7374 6f72 696e     return storin
-00012370: 673c 2f63 6f64 653e 3c2f 7072 653e 0a3c  g</code></pre>.<
-00012380: 2f64 6574 6169 6c73 3e0a 3c2f 6464 3e0a  /details>.</dd>.
-00012390: 3c64 7420 6964 3d22 5064 6d43 6f6e 7465  <dt id="PdmConte
-000123a0: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
-000123b0: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
-000123c0: 7261 746f 722e 6368 6172 6163 7465 7269  rator.characteri
-000123d0: 7a65 5f65 7665 6e74 5f63 6f6e 7469 6e75  ze_event_continu
-000123e0: 6f75 7322 3e3c 636f 6465 2063 6c61 7373  ous"><code class
-000123f0: 3d22 6e61 6d65 2066 6c65 7822 3e0a 3c73  ="name flex">.<s
-00012400: 7061 6e3e 6465 6620 3c73 7061 6e20 636c  pan>def <span cl
-00012410: 6173 733d 2269 6465 6e74 223e 6368 6172  ass="ident">char
-00012420: 6163 7465 7269 7a65 5f65 7665 6e74 5f63  acterize_event_c
-00012430: 6f6e 7469 6e75 6f75 733c 2f73 7061 6e3e  ontinuous</span>
-00012440: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
-00012450: 6c66 2c20 636f 6e74 6578 742c 2065 6467  lf, context, edg
-00012460: 6529 3c2f 7370 616e 3e0a 3c2f 636f 6465  e)</span>.</code
-00012470: 3e3c 2f64 743e 0a3c 6464 3e0a 3c64 6976  ></dt>.<dd>.<div
-00012480: 2063 6c61 7373 3d22 6465 7363 223e 3c70   class="desc"><p
-00012490: 3e54 6869 7320 6d65 7468 6f64 2063 6861  >This method cha
-000124a0: 7261 6374 6572 697a 6573 2074 6865 2065  racterizes the e
-000124b0: 6467 6520 2861 2c62 2920 7768 656e 2061  dge (a,b) when a
-000124c0: 2069 7320 636f 6e74 696e 756f 7573 2e0a   is continuous..
-000124d0: 546f 2064 6f20 7468 6973 2c20 7468 6520  To do this, the 
-000124e0: 6465 6c74 6120 6265 7477 6565 6e20 7468  delta between th
-000124f0: 6520 7469 6d65 7374 616d 7073 206f 6620  e timestamps of 
-00012500: 7468 6520 7365 7269 6573 2062 2069 7320  the series b is 
-00012510: 6361 6c63 756c 6174 6564 0a28 692e 652e  calculated.(i.e.
-00012520: 2074 6865 2064 6966 6665 7265 6e63 6520   the difference 
-00012530: 6265 7477 6565 6e20 6375 7272 656e 7420  between current 
-00012540: 616e 6420 6e65 7874 2074 696d 6573 7461  and next timesta
-00012550: 6d70 7329 2e20 4966 2074 6865 2073 756d  mps). If the sum
-00012560: 6d20 6f66 2074 6865 2064 656c 7461 7320  m of the deltas 
-00012570: 6265 7477 6565 6e20 6220 7365 7269 6573  between b series
-00012580: 2064 6174 612c 2069 730a 6772 6561 7465   data, is.greate
-00012590: 7220 7468 616e 2032 2074 696d 6573 2074  r than 2 times t
-000125a0: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
-000125b0: 6174 696f 6e20 6f66 2074 6865 2062 2c20  ation of the b, 
-000125c0: 7468 656e 2074 6865 2069 6e63 7265 6173  then the increas
-000125d0: 6520 6368 6172 6163 7465 7269 7a61 7469  e characterizati
-000125e0: 6f6e 2069 7320 7265 7475 726e 6564 2e20  on is returned. 
-000125f0: 4966 2074 6865 2073 756d 0a69 7320 6c6f  If the sum.is lo
-00012600: 7765 7220 7468 616e 2032 2074 696d 6573  wer than 2 times
-00012610: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
-00012620: 7669 6174 696f 6e20 7468 6520 6465 6372  viation the decr
-00012630: 6561 7365 6420 6368 6172 6163 7465 7269  eased characteri
-00012640: 7a61 7469 6f6e 2069 7320 7265 7475 726e  zation is return
-00012650: 6564 2e20 4f74 6865 7277 6973 652c 2074  ed. Otherwise, t
-00012660: 6865 2075 6e6b 6e6f 776e 0a63 6861 7261  he unknown.chara
-00012670: 6374 6572 697a 6174 696f 6e20 6973 2072  cterization is r
-00012680: 6574 7572 6e65 642e 3c2f 703e 0a3c 703e  eturned.</p>.<p>
-00012690: 3c73 7472 6f6e 673e 5061 7261 6d65 7465  <strong>Paramete
-000126a0: 7273 3c2f 7374 726f 6e67 3e3a 3c2f 703e  rs</strong>:</p>
-000126b0: 0a3c 703e 3c73 7472 6f6e 673e 636f 6e74  .<p><strong>cont
-000126c0: 6578 743c 2f73 7472 6f6e 673e 3a20 7468  ext</strong>: th
-000126d0: 6174 2074 6865 2065 6467 6520 746f 2062  at the edge to b
-000126e0: 6520 6368 6172 6163 7465 7269 7a65 6420  e characterized 
-000126f0: 6265 6c6f 6e67 732e 3c2f 703e 0a3c 703e  belongs.</p>.<p>
-00012700: 3c73 7472 6f6e 673e 6564 6765 3c2f 7374  <strong>edge</st
-00012710: 726f 6e67 3e3a 2041 2074 7570 6c65 2028  rong>: A tuple (
-00012720: 612c 6229 2077 6865 7265 2061 2069 7320  a,b) where a is 
-00012730: 6973 6f6c 6174 6564 206f 7220 636f 6e66  isolated or conf
-00012740: 6967 7572 6174 696f 6e20 6576 656e 742e  iguration event.
-00012750: 3c2f 703e 0a3c 703e 3c73 7472 6f6e 673e  </p>.<p><strong>
-00012760: 7265 7475 726e 3c2f 7374 726f 6e67 3e3a  return</strong>:
-00012770: 2041 2063 6861 7261 6374 6572 697a 6174   A characterizat
-00012780: 696f 6e20 666f 7220 7468 6520 6564 6765  ion for the edge
-00012790: 2028 756e 6b6e 6f77 6e2c 2064 6563 7265   (unknown, decre
-000127a0: 6173 6520 6f72 2069 6e63 7265 6173 6529  ase or increase)
-000127b0: 3c2f 703e 3c2f 6469 763e 0a3c 6465 7461  </p></div>.<deta
-000127c0: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
-000127d0: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
-000127e0: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
-000127f0: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
-00012800: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
-00012810: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
-00012820: 6e22 3e64 6566 2063 6861 7261 6374 6572  n">def character
-00012830: 697a 655f 6576 656e 745f 636f 6e74 696e  ize_event_contin
-00012840: 756f 7573 2873 656c 662c 2063 6f6e 7465  uous(self, conte
-00012850: 7874 2c20 6564 6765 293a 0a20 2020 2026  xt, edge):.    &
-00012860: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
-00012870: 2020 2020 2020 2054 6869 7320 6d65 7468         This meth
-00012880: 6f64 2063 6861 7261 6374 6572 697a 6573  od characterizes
-00012890: 2074 6865 2065 6467 6520 2861 2c62 2920   the edge (a,b) 
-000128a0: 7768 656e 2061 2069 7320 636f 6e74 696e  when a is contin
-000128b0: 756f 7573 2e0a 2020 2020 2020 2020 546f  uous..        To
-000128c0: 2064 6f20 7468 6973 2c20 7468 6520 6465   do this, the de
-000128d0: 6c74 6120 6265 7477 6565 6e20 7468 6520  lta between the 
-000128e0: 7469 6d65 7374 616d 7073 206f 6620 7468  timestamps of th
-000128f0: 6520 7365 7269 6573 2062 2069 7320 6361  e series b is ca
-00012900: 6c63 756c 6174 6564 0a20 2020 2020 2020  lculated.       
-00012910: 2028 692e 652e 2074 6865 2064 6966 6665   (i.e. the diffe
-00012920: 7265 6e63 6520 6265 7477 6565 6e20 6375  rence between cu
-00012930: 7272 656e 7420 616e 6420 6e65 7874 2074  rrent and next t
-00012940: 696d 6573 7461 6d70 7329 2e20 4966 2074  imestamps). If t
-00012950: 6865 2073 756d 6d20 6f66 2074 6865 2064  he summ of the d
-00012960: 656c 7461 7320 6265 7477 6565 6e20 6220  eltas between b 
-00012970: 7365 7269 6573 2064 6174 612c 2069 730a  series data, is.
-00012980: 2020 2020 2020 2020 6772 6561 7465 7220          greater 
-00012990: 7468 616e 2032 2074 696d 6573 2074 6865  than 2 times the
-000129a0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
-000129b0: 696f 6e20 6f66 2074 6865 2062 2c20 7468  ion of the b, th
-000129c0: 656e 2074 6865 2069 6e63 7265 6173 6520  en the increase 
-000129d0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
-000129e0: 2069 7320 7265 7475 726e 6564 2e20 4966   is returned. If
-000129f0: 2074 6865 2073 756d 0a20 2020 2020 2020   the sum.       
-00012a00: 2069 7320 6c6f 7765 7220 7468 616e 2032   is lower than 2
-00012a10: 2074 696d 6573 2074 6865 2073 7461 6e64   times the stand
-00012a20: 6172 6420 6465 7669 6174 696f 6e20 7468  ard deviation th
-00012a30: 6520 6465 6372 6561 7365 6420 6368 6172  e decreased char
-00012a40: 6163 7465 7269 7a61 7469 6f6e 2069 7320  acterization is 
-00012a50: 7265 7475 726e 6564 2e20 4f74 6865 7277  returned. Otherw
-00012a60: 6973 652c 2074 6865 2075 6e6b 6e6f 776e  ise, the unknown
-00012a70: 0a20 2020 2020 2020 2063 6861 7261 6374  .        charact
-00012a80: 6572 697a 6174 696f 6e20 6973 2072 6574  erization is ret
-00012a90: 7572 6e65 642e 0a0a 2020 2020 2020 2020  urned...        
-00012aa0: 2a2a 5061 7261 6d65 7465 7273 2a2a 3a0a  **Parameters**:.
-00012ab0: 0a20 2020 2020 2020 202a 2a63 6f6e 7465  .        **conte
-00012ac0: 7874 2a2a 3a20 7468 6174 2074 6865 2065  xt**: that the e
-00012ad0: 6467 6520 746f 2062 6520 6368 6172 6163  dge to be charac
-00012ae0: 7465 7269 7a65 6420 6265 6c6f 6e67 732e  terized belongs.
-00012af0: 0a0a 2020 2020 2020 2020 2a2a 6564 6765  ..        **edge
-00012b00: 2a2a 3a20 4120 7475 706c 6520 2861 2c62  **: A tuple (a,b
-00012b10: 2920 7768 6572 6520 6120 6973 2069 736f  ) where a is iso
-00012b20: 6c61 7465 6420 6f72 2063 6f6e 6669 6775  lated or configu
-00012b30: 7261 7469 6f6e 2065 7665 6e74 2e0a 0a20  ration event... 
-00012b40: 2020 2020 2020 202a 2a72 6574 7572 6e2a         **return*
-00012b50: 2a3a 2041 2063 6861 7261 6374 6572 697a  *: A characteriz
-00012b60: 6174 696f 6e20 666f 7220 7468 6520 6564  ation for the ed
-00012b70: 6765 2028 756e 6b6e 6f77 6e2c 2064 6563  ge (unknown, dec
-00012b80: 7265 6173 6520 6f72 2069 6e63 7265 6173  rease or increas
-00012b90: 6529 0a20 2020 2026 2333 343b 2623 3334  e).    &#34;&#34
-00012ba0: 3b26 2333 343b 0a20 2020 206e 616d 6531  ;&#34;.    name1
-00012bb0: 203d 2065 6467 655b 305d 0a20 2020 206e   = edge[0].    n
-00012bc0: 616d 6532 203d 2065 6467 655b 315d 0a20  ame2 = edge[1]. 
-00012bd0: 2020 2076 616c 7565 7331 203d 205b 666c     values1 = [fl
-00012be0: 6f61 7428 6b61 7469 2920 666f 7220 6b61  oat(kati) for ka
-00012bf0: 7469 2069 6e20 636f 6e74 6578 745b 6e61  ti in context[na
-00012c00: 6d65 315d 5d0a 2020 2020 7661 6c75 6573  me1]].    values
-00012c10: 3220 3d20 5b66 6c6f 6174 286b 6174 6929  2 = [float(kati)
-00012c20: 2066 6f72 206b 6174 6920 696e 2063 6f6e   for kati in con
-00012c30: 7465 7874 5b6e 616d 6532 5d5d 0a0a 2020  text[name2]]..  
-00012c40: 2020 7072 6576 203d 2076 616c 7565 7332    prev = values2
-00012c50: 5b30 5d0a 2020 2020 6469 6666 203d 2030  [0].    diff = 0
-00012c60: 0a20 2020 2066 6f72 2076 2069 6e20 7661  .    for v in va
-00012c70: 6c75 6573 325b 313a 5d3a 0a20 2020 2020  lues2[1:]:.     
-00012c80: 2020 2064 6966 6620 2b3d 2028 7620 2d20     diff += (v - 
-00012c90: 7072 6576 290a 0a20 2020 2069 6620 6c65  prev)..    if le
-00012ca0: 6e28 7661 6c75 6573 3229 203d 3d20 303a  n(values2) == 0:
-00012cb0: 0a20 2020 2020 2020 2063 6861 7220 3d20  .        char = 
-00012cc0: 2623 3334 3b75 6e6b 6e6f 776e 2623 3334  &#34;unknown&#34
-00012cd0: 3b0a 2020 2020 7374 6476 203d 2073 7461  ;.    stdv = sta
-00012ce0: 7469 7374 6963 732e 7374 6465 7628 7661  tistics.stdev(va
-00012cf0: 6c75 6573 3229 0a20 2020 2069 6620 6469  lues2).    if di
-00012d00: 6666 2026 6774 3b20 3220 2a20 7374 6476  ff &gt; 2 * stdv
-00012d10: 3a0a 2020 2020 2020 2020 6368 6172 203d  :.        char =
-00012d20: 2026 2333 343b 696e 6372 6561 7365 2623   &#34;increase&#
-00012d30: 3334 3b0a 2020 2020 656c 6966 2064 6966  34;.    elif dif
-00012d40: 6620 266c 743b 202d 3220 2a20 7374 6476  f &lt; -2 * stdv
-00012d50: 3a0a 2020 2020 2020 2020 6368 6172 203d  :.        char =
-00012d60: 2026 2333 343b 6465 6372 6561 7365 2623   &#34;decrease&#
-00012d70: 3334 3b0a 2020 2020 656c 7365 3a0a 2020  34;.    else:.  
-00012d80: 2020 2020 2020 6368 6172 203d 2026 2333        char = &#3
-00012d90: 343b 756e 6b6e 6f77 6e26 2333 343b 0a20  4;unknown&#34;. 
-00012da0: 2020 2072 6574 7572 6e20 6368 6172 3c2f     return char</
-00012db0: 636f 6465 3e3c 2f70 7265 3e0a 3c2f 6465  code></pre>.</de
-00012dc0: 7461 696c 733e 0a3c 2f64 643e 0a3c 6474  tails>.</dd>.<dt
-00012dd0: 2069 643d 2250 646d 436f 6e74 6578 742e   id="PdmContext.
-00012de0: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
-00012df0: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
-00012e00: 6f72 2e63 6861 7261 6374 6572 697a 655f  or.characterize_
-00012e10: 6576 656e 745f 6564 6765 223e 3c63 6f64  event_edge"><cod
-00012e20: 6520 636c 6173 733d 226e 616d 6520 666c  e class="name fl
-00012e30: 6578 223e 0a3c 7370 616e 3e64 6566 203c  ex">.<span>def <
-00012e40: 7370 616e 2063 6c61 7373 3d22 6964 656e  span class="iden
-00012e50: 7422 3e63 6861 7261 6374 6572 697a 655f  t">characterize_
-00012e60: 6576 656e 745f 6564 6765 3c2f 7370 616e  event_edge</span
-00012e70: 3e3c 2f73 7061 6e3e 283c 7370 616e 3e73  ></span>(<span>s
-00012e80: 656c 662c 2063 6f6e 7465 7874 2c20 6564  elf, context, ed
-00012e90: 6765 293c 2f73 7061 6e3e 0a3c 2f63 6f64  ge)</span>.</cod
-00012ea0: 653e 3c2f 6474 3e0a 3c64 643e 0a3c 6469  e></dt>.<dd>.<di
-00012eb0: 7620 636c 6173 733d 2264 6573 6322 3e3c  v class="desc"><
-00012ec0: 703e 5468 6973 206d 6574 686f 6420 6368  p>This method ch
-00012ed0: 6172 6163 7465 7269 7a65 7320 7468 6520  aracterizes the 
-00012ee0: 6564 6765 2028 612c 6229 2077 6865 6e20  edge (a,b) when 
-00012ef0: 6120 6973 2069 736f 6c61 7465 6420 6f72  a is isolated or
-00012f00: 2063 6f6e 6669 6775 7261 7469 6f6e 2065   configuration e
-00012f10: 7665 6e74 2e0a 546f 2064 6f20 7468 6973  vent..To do this
-00012f20: 2c20 6974 2064 6574 6563 7473 2074 6865  , it detects the
-00012f30: 206c 6173 7420 6f63 6375 7272 656e 6365   last occurrence
-00012f40: 206f 6620 6120 616e 6420 7370 6c69 7420   of a and split 
-00012f50: 7468 6520 6461 7461 206f 6620 7365 7269  the data of seri
-00012f60: 6573 2061 2061 6e64 2073 6572 6965 7320  es a and series 
-00012f70: 6220 6261 7365 6420 6f6e 2074 6861 742e  b based on that.
-00012f80: 0a54 6865 6e20 6368 6563 6b73 2069 6620  .Then checks if 
-00012f90: 7468 6520 6d65 6469 616e 206f 6620 6220  the median of b 
-00012fa0: 6166 7465 7220 7468 6520 6f63 6375 7272  after the occurr
-00012fb0: 656e 6365 2069 7320 6174 206c 6172 6765  ence is at large
-00012fc0: 7220 7468 616e 2074 6865 206d 6564 6961  r than the media
-00012fd0: 6e20 6220 6265 666f 7265 0a70 6c75 7320  n b before.plus 
-00012fe0: 7477 6f20 7469 6d65 7320 7468 6520 7374  two times the st
-00012ff0: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
-00013000: 206f 6620 6220 7365 7269 6573 2062 6566   of b series bef
-00013010: 6f72 6520 7468 6520 6f63 6375 7272 656e  ore the occurren
-00013020: 6365 2e0a 4966 2074 6861 7420 6973 2074  ce..If that is t
-00013030: 7275 6520 7468 656e 2069 7320 6368 6172  rue then is char
-00013040: 6163 7465 7269 7a65 6420 6173 2069 6e63  acterized as inc
-00013050: 7265 6173 652e 2045 6c73 6520 6974 2069  rease. Else it i
-00013060: 7320 6368 6563 6b65 6420 666f 7220 7468  s checked for th
-00013070: 6520 6f70 706f 7369 7465 2c20 2869 6620  e opposite, (if 
-00013080: 6974 2069 7320 736d 616c 6c65 720a 666f  it is smaller.fo
-00013090: 7220 6174 206c 6561 7374 2032 2074 696d  r at least 2 tim
-000130a0: 6573 2074 6865 2073 7461 6e64 6172 6420  es the standard 
-000130b0: 6465 7669 6174 696f 6e20 6f66 2062 2920  deviation of b) 
-000130c0: 616e 6420 6368 6172 6163 7465 7269 7a65  and characterize
-000130d0: 6420 6173 2064 6563 7265 6173 652e 204f  d as decrease. O
-000130e0: 7468 6572 7769 7365 2c20 6973 2063 6861  therwise, is cha
-000130f0: 7261 6374 6572 697a 6564 2061 730a 756e  racterized as.un
-00013100: 6b6e 6f77 6e2e 3c2f 703e 0a3c 703e 3c73  known.</p>.<p><s
-00013110: 7472 6f6e 673e 5061 7261 6d65 7465 7273  trong>Parameters
-00013120: 3c2f 7374 726f 6e67 3e3a 3c2f 703e 0a3c  </strong>:</p>.<
-00013130: 703e 3c73 7472 6f6e 673e 636f 6e74 6578  p><strong>contex
-00013140: 743c 2f73 7472 6f6e 673e 3a20 7468 6174  t</strong>: that
-00013150: 2074 6865 2065 6467 6520 746f 2062 6520   the edge to be 
-00013160: 6368 6172 6163 7465 7269 7a65 6420 6265  characterized be
-00013170: 6c6f 6e67 732e 3c2f 703e 0a3c 703e 3c73  longs.</p>.<p><s
-00013180: 7472 6f6e 673e 6564 6765 3c2f 7374 726f  trong>edge</stro
-00013190: 6e67 3e3a 2041 2074 7570 6c65 2028 612c  ng>: A tuple (a,
-000131a0: 6229 2077 6865 7265 2061 2069 7320 6973  b) where a is is
-000131b0: 6f6c 6174 6564 206f 7220 636f 6e66 6967  olated or config
-000131c0: 7572 6174 696f 6e20 6576 656e 742e 3c2f  uration event.</
-000131d0: 703e 0a3c 703e 3c73 7472 6f6e 673e 7265  p>.<p><strong>re
-000131e0: 7475 726e 3c2f 7374 726f 6e67 3e3a 2041  turn</strong>: A
-000131f0: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
-00013200: 6e20 666f 7220 7468 6520 6564 6765 2028  n for the edge (
-00013210: 756e 6b6e 6f77 6e2c 2064 6563 7265 6173  unknown, decreas
-00013220: 6520 6f72 2069 6e63 7265 6173 6529 3c2f  e or increase)</
-00013230: 703e 3c2f 6469 763e 0a3c 6465 7461 696c  p></div>.<detail
-00013240: 7320 636c 6173 733d 2273 6f75 7263 6522  s class="source"
-00013250: 3e0a 3c73 756d 6d61 7279 3e0a 3c73 7061  >.<summary>.<spa
-00013260: 6e3e 4578 7061 6e64 2073 6f75 7263 6520  n>Expand source 
-00013270: 636f 6465 3c2f 7370 616e 3e0a 3c2f 7375  code</span>.</su
-00013280: 6d6d 6172 793e 0a3c 7072 653e 3c63 6f64  mmary>.<pre><cod
-00013290: 6520 636c 6173 733d 2270 7974 686f 6e22  e class="python"
-000132a0: 3e64 6566 2063 6861 7261 6374 6572 697a  >def characteriz
-000132b0: 655f 6576 656e 745f 6564 6765 2873 656c  e_event_edge(sel
-000132c0: 662c 2063 6f6e 7465 7874 2c20 6564 6765  f, context, edge
-000132d0: 293a 0a20 2020 2026 2333 343b 2623 3334  ):.    &#34;&#34
-000132e0: 3b26 2333 343b 0a20 2020 2054 6869 7320  ;&#34;.    This 
-000132f0: 6d65 7468 6f64 2063 6861 7261 6374 6572  method character
-00013300: 697a 6573 2074 6865 2065 6467 6520 2861  izes the edge (a
-00013310: 2c62 2920 7768 656e 2061 2069 7320 6973  ,b) when a is is
-00013320: 6f6c 6174 6564 206f 7220 636f 6e66 6967  olated or config
-00013330: 7572 6174 696f 6e20 6576 656e 742e 0a20  uration event.. 
-00013340: 2020 2054 6f20 646f 2074 6869 732c 2069     To do this, i
-00013350: 7420 6465 7465 6374 7320 7468 6520 6c61  t detects the la
-00013360: 7374 206f 6363 7572 7265 6e63 6520 6f66  st occurrence of
-00013370: 2061 2061 6e64 2073 706c 6974 2074 6865   a and split the
-00013380: 2064 6174 6120 6f66 2073 6572 6965 7320   data of series 
-00013390: 6120 616e 6420 7365 7269 6573 2062 2062  a and series b b
-000133a0: 6173 6564 206f 6e20 7468 6174 2e0a 2020  ased on that..  
-000133b0: 2020 5468 656e 2063 6865 636b 7320 6966    Then checks if
-000133c0: 2074 6865 206d 6564 6961 6e20 6f66 2062   the median of b
-000133d0: 2061 6674 6572 2074 6865 206f 6363 7572   after the occur
-000133e0: 7265 6e63 6520 6973 2061 7420 6c61 7267  rence is at larg
-000133f0: 6572 2074 6861 6e20 7468 6520 6d65 6469  er than the medi
-00013400: 616e 2062 2062 6566 6f72 650a 2020 2020  an b before.    
-00013410: 706c 7573 2074 776f 2074 696d 6573 2074  plus two times t
-00013420: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
-00013430: 6174 696f 6e20 6f66 2062 2073 6572 6965  ation of b serie
-00013440: 7320 6265 666f 7265 2074 6865 206f 6363  s before the occ
-00013450: 7572 7265 6e63 652e 0a20 2020 2049 6620  urrence..    If 
-00013460: 7468 6174 2069 7320 7472 7565 2074 6865  that is true the
-00013470: 6e20 6973 2063 6861 7261 6374 6572 697a  n is characteriz
-00013480: 6564 2061 7320 696e 6372 6561 7365 2e20  ed as increase. 
-00013490: 456c 7365 2069 7420 6973 2063 6865 636b  Else it is check
-000134a0: 6564 2066 6f72 2074 6865 206f 7070 6f73  ed for the oppos
-000134b0: 6974 652c 2028 6966 2069 7420 6973 2073  ite, (if it is s
-000134c0: 6d61 6c6c 6572 0a20 2020 2066 6f72 2061  maller.    for a
-000134d0: 7420 6c65 6173 7420 3220 7469 6d65 7320  t least 2 times 
-000134e0: 7468 6520 7374 616e 6461 7264 2064 6576  the standard dev
-000134f0: 6961 7469 6f6e 206f 6620 6229 2061 6e64  iation of b) and
-00013500: 2063 6861 7261 6374 6572 697a 6564 2061   characterized a
-00013510: 7320 6465 6372 6561 7365 2e20 4f74 6865  s decrease. Othe
-00013520: 7277 6973 652c 2069 7320 6368 6172 6163  rwise, is charac
-00013530: 7465 7269 7a65 6420 6173 0a20 2020 2020  terized as.     
-00013540: 756e 6b6e 6f77 6e2e 0a0a 2020 2020 2a2a  unknown...    **
-00013550: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
-00013560: 2020 202a 2a63 6f6e 7465 7874 2a2a 3a20     **context**: 
-00013570: 7468 6174 2074 6865 2065 6467 6520 746f  that the edge to
-00013580: 2062 6520 6368 6172 6163 7465 7269 7a65   be characterize
-00013590: 6420 6265 6c6f 6e67 732e 0a0a 2020 2020  d belongs...    
-000135a0: 2a2a 6564 6765 2a2a 3a20 4120 7475 706c  **edge**: A tupl
-000135b0: 6520 2861 2c62 2920 7768 6572 6520 6120  e (a,b) where a 
-000135c0: 6973 2069 736f 6c61 7465 6420 6f72 2063  is isolated or c
-000135d0: 6f6e 6669 6775 7261 7469 6f6e 2065 7665  onfiguration eve
-000135e0: 6e74 2e0a 0a20 2020 202a 2a72 6574 7572  nt...    **retur
-000135f0: 6e2a 2a3a 2041 2063 6861 7261 6374 6572  n**: A character
-00013600: 697a 6174 696f 6e20 666f 7220 7468 6520  ization for the 
-00013610: 6564 6765 2028 756e 6b6e 6f77 6e2c 2064  edge (unknown, d
-00013620: 6563 7265 6173 6520 6f72 2069 6e63 7265  ecrease or incre
-00013630: 6173 6529 0a20 2020 2026 2333 343b 2623  ase).    &#34;&#
-00013640: 3334 3b26 2333 343b 0a20 2020 206e 616d  34;&#34;.    nam
-00013650: 6531 203d 2065 6467 655b 305d 0a20 2020  e1 = edge[0].   
-00013660: 206e 616d 6532 203d 2065 6467 655b 315d   name2 = edge[1]
-00013670: 0a20 2020 2076 616c 7565 7331 203d 2063  .    values1 = c
-00013680: 6f6e 7465 7874 5b6e 616d 6531 5d0a 2020  ontext[name1].  
-00013690: 2020 7661 6c75 6573 3220 3d20 5b66 6c6f    values2 = [flo
-000136a0: 6174 286b 6174 6929 2066 6f72 206b 6174  at(kati) for kat
-000136b0: 6920 696e 2063 6f6e 7465 7874 5b6e 616d  i in context[nam
-000136c0: 6532 5d5d 0a0a 2020 2020 6f63 6375 7265  e2]]..    occure
-000136d0: 6e63 6520 3d20 6c65 6e28 7661 6c75 6573  nce = len(values
-000136e0: 3129 202d 2031 0a20 2020 2066 6f72 2069  1) - 1.    for i
-000136f0: 2069 6e20 7261 6e67 6528 6c65 6e28 7661   in range(len(va
-00013700: 6c75 6573 3129 202d 2032 2c20 302c 202d  lues1) - 2, 0, -
-00013710: 3129 3a0a 2020 2020 2020 2020 6966 2076  1):.        if v
-00013720: 616c 7565 7331 5b69 5d20 213d 2076 616c  alues1[i] != val
-00013730: 7565 7331 5b2d 315d 3a0a 2020 2020 2020  ues1[-1]:.      
-00013740: 2020 2020 2020 6f63 6375 7265 6e63 6520        occurence 
-00013750: 3d20 6920 2b20 310a 2020 2020 2020 2020  = i + 1.        
-00013760: 2020 2020 6272 6561 6b0a 2020 2020 7072      break.    pr
-00013770: 6576 6975 736f 6363 7572 656e 6365 203d  eviusoccurence =
-00013780: 2030 0a20 2020 2066 6f72 2069 2069 6e20   0.    for i in 
-00013790: 7261 6e67 6528 6f63 6375 7265 6e63 6520  range(occurence 
-000137a0: 2d20 322c 2030 2c20 2d31 293a 0a20 2020  - 2, 0, -1):.   
-000137b0: 2020 2020 2069 6620 7661 6c75 6573 315b       if values1[
-000137c0: 695d 2021 3d20 7661 6c75 6573 315b 6f63  i] != values1[oc
-000137d0: 6375 7265 6e63 6520 2d20 315d 3a0a 2020  curence - 1]:.  
-000137e0: 2020 2020 2020 2020 2020 7072 6576 6975            previu
-000137f0: 736f 6363 7572 656e 6365 203d 2069 0a0a  soccurence = i..
-00013800: 2020 2020 6966 206f 6363 7572 656e 6365      if occurence
-00013810: 202d 2070 7265 7669 7573 6f63 6375 7265   - previusoccure
-00013820: 6e63 6520 266c 743b 2032 3a20 2023 206f  nce &lt; 2:  # o
-00013830: 7220 6c65 6e28 7661 6c75 6573 3229 2d6f  r len(values2)-o
-00013840: 6363 7572 656e 6365 266c 743b 323a 0a20  ccurence&lt;2:. 
-00013850: 2020 2020 2020 2072 6574 7572 6e20 2623         return &#
-00013860: 3334 3b75 6e6b 6e6f 776e 2623 3334 3b0a  34;unknown&#34;.
-00013870: 2020 2020 7661 6c75 6573 3262 6566 6f72      values2befor
-00013880: 6520 3d20 7661 6c75 6573 325b 7072 6576  e = values2[prev
-00013890: 6975 736f 6363 7572 656e 6365 3a6f 6363  iusoccurence:occ
-000138a0: 7572 656e 6365 5d0a 2020 2020 2320 7374  urence].    # st
-000138b0: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
-000138c0: 7374 6465 7628 7661 6c75 6573 3262 6566  stdev(values2bef
-000138d0: 6f72 6529 0a20 2020 2023 206d 6561 6e20  ore).    # mean 
-000138e0: 3d20 7374 6174 6973 7469 6373 2e73 7464  = statistics.std
-000138f0: 6576 2876 616c 7565 7332 6265 666f 7265  ev(values2before
-00013900: 290a 2020 2020 2320 7661 6c75 6573 3262  ).    # values2b
-00013910: 6566 6f72 653d 5b76 2069 6620 7626 6c74  efore=[v if v&lt
-00013920: 3b6d 6561 6e2b 352a 7374 6476 2065 6c73  ;mean+5*stdv els
-00013930: 6520 6d65 616e 2066 6f72 2076 2069 6e20  e mean for v in 
-00013940: 7661 6c75 6573 3262 6566 6f72 655d 0a0a  values2before]..
-00013950: 2020 2020 2320 7661 6c75 6573 3261 6674      # values2aft
-00013960: 6572 3d76 616c 7565 7332 5b6f 6363 7572  er=values2[occur
-00013970: 656e 6365 3a5d 0a20 2020 2076 616c 7565  ence:].    value
-00013980: 7332 6166 7465 7220 3d20 5b76 616c 7565  s2after = [value
-00013990: 7332 5b2d 315d 5d0a 2020 2020 2320 7374  s2[-1]].    # st
-000139a0: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
-000139b0: 7374 6465 7628 7661 6c75 6573 3261 6674  stdev(values2aft
-000139c0: 6572 290a 2020 2020 2320 6d65 616e 203d  er).    # mean =
-000139d0: 2073 7461 7469 7374 6963 732e 7374 6465   statistics.stde
-000139e0: 7628 7661 6c75 6573 3261 6674 6572 290a  v(values2after).
-000139f0: 2020 2020 2320 7661 6c75 6573 3261 6674      # values2aft
-00013a00: 6572 203d 205b 7620 6966 2076 2026 6c74  er = [v if v &lt
-00013a10: 3b20 6d65 616e 202b 2033 202a 2073 7464  ; mean + 3 * std
-00013a20: 7620 656c 7365 206d 6561 6e20 666f 7220  v else mean for 
-00013a30: 7620 696e 2076 616c 7565 7332 6166 7465  v in values2afte
-00013a40: 725d 0a0a 2020 2020 7374 6476 203d 2073  r]..    stdv = s
-00013a50: 7461 7469 7374 6963 732e 7374 6465 7628  tatistics.stdev(
-00013a60: 7661 6c75 6573 3262 6566 6f72 6529 0a20  values2before). 
-00013a70: 2020 2069 6620 6c65 6e28 7661 6c75 6573     if len(values
-00013a80: 3262 6566 6f72 6529 203d 3d20 303a 0a20  2before) == 0:. 
-00013a90: 2020 2020 2020 2063 6861 7220 3d20 2623         char = &#
-00013aa0: 3334 3b75 6e6b 6e6f 776e 2623 3334 3b0a  34;unknown&#34;.
-00013ab0: 2020 2020 656c 6966 2073 7461 7469 7374      elif statist
-00013ac0: 6963 732e 6d65 6469 616e 2876 616c 7565  ics.median(value
-00013ad0: 7332 6265 666f 7265 2920 2d20 7374 6174  s2before) - stat
-00013ae0: 6973 7469 6373 2e6d 6564 6961 6e28 7661  istics.median(va
-00013af0: 6c75 6573 3261 6674 6572 2920 2667 743b  lues2after) &gt;
-00013b00: 2032 202a 2073 7464 763a 0a20 2020 2020   2 * stdv:.     
-00013b10: 2020 2063 6861 7220 3d20 2623 3334 3b64     char = &#34;d
-00013b20: 6563 7265 6173 6526 2333 343b 0a20 2020  ecrease&#34;.   
-00013b30: 2065 6c69 6620 7374 6174 6973 7469 6373   elif statistics
-00013b40: 2e6d 6564 6961 6e28 7661 6c75 6573 3261  .median(values2a
-00013b50: 6674 6572 2920 2d20 7374 6174 6973 7469  fter) - statisti
-00013b60: 6373 2e6d 6564 6961 6e28 7661 6c75 6573  cs.median(values
-00013b70: 3262 6566 6f72 6529 2026 6774 3b20 3220  2before) &gt; 2 
-00013b80: 2a20 7374 6476 3a0a 2020 2020 2020 2020  * stdv:.        
-00013b90: 6368 6172 203d 2026 2333 343b 696e 6372  char = &#34;incr
-00013ba0: 6561 7365 2623 3334 3b0a 2020 2020 656c  ease&#34;.    el
-00013bb0: 7365 3a0a 2020 2020 2020 2020 6368 6172  se:.        char
-00013bc0: 203d 2026 2333 343b 756e 6b6e 6f77 6e26   = &#34;unknown&
-00013bd0: 2333 343b 0a20 2020 2072 6574 7572 6e20  #34;.    return 
-00013be0: 6368 6172 3c2f 636f 6465 3e3c 2f70 7265  char</code></pre
-00013bf0: 3e0a 3c2f 6465 7461 696c 733e 0a3c 2f64  >.</details>.</d
-00013c00: 643e 0a3c 6474 2069 643d 2250 646d 436f  d>.<dt id="PdmCo
-00013c10: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
-00013c20: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
-00013c30: 656e 6572 6174 6f72 2e63 6f6c 6c65 6374  enerator.collect
-00013c40: 5f64 6174 6122 3e3c 636f 6465 2063 6c61  _data"><code cla
-00013c50: 7373 3d22 6e61 6d65 2066 6c65 7822 3e0a  ss="name flex">.
-00013c60: 3c73 7061 6e3e 6465 6620 3c73 7061 6e20  <span>def <span 
-00013c70: 636c 6173 733d 2269 6465 6e74 223e 636f  class="ident">co
-00013c80: 6c6c 6563 745f 6461 7461 3c2f 7370 616e  llect_data</span
-00013c90: 3e3c 2f73 7061 6e3e 283c 7370 616e 3e73  ></span>(<span>s
-00013ca0: 656c 662c 2074 696d 6573 7461 6d70 2c20  elf, timestamp, 
-00013cb0: 736f 7572 6365 2c20 6e61 6d65 2c20 7661  source, name, va
-00013cc0: 6c75 653d 4e6f 6e65 2c20 7479 7065 3d27  lue=None, type='
-00013cd0: 556e 6976 6172 6961 7465 2729 3c2f 7370  Univariate')</sp
-00013ce0: 616e 3e0a 3c2f 636f 6465 3e3c 2f64 743e  an>.</code></dt>
-00013cf0: 0a3c 6464 3e0a 3c64 6976 2063 6c61 7373  .<dd>.<div class
-00013d00: 3d22 6465 7363 223e 3c70 3e54 6869 7320  ="desc"><p>This 
-00013d10: 6d65 7468 6f64 2069 7320 7573 6564 2077  method is used w
-00013d20: 6865 6e20 6461 7461 2061 7265 2070 6173  hen data are pas
-00013d30: 7365 6420 6974 6572 6174 6976 656c 792c  sed iteratively,
-00013d40: 2061 6e64 2073 746f 7265 6420 696e 2062   and stored in b
-00013d50: 7566 6665 720a 5768 656e 2064 6174 6120  uffer.When data 
-00013d60: 6f66 2074 6172 6765 7420 736f 7572 6365  of target source
-00013d70: 2061 7272 6976 652c 2061 2063 6f72 7265   arrive, a corre
-00013d80: 7370 6f6e 6469 6e67 2063 6f6e 7465 7874  sponding context
-00013d90: 2069 7320 7072 6f64 7563 6564 2e0a 536f   is produced..So
-00013da0: 7572 6365 7320 6361 6e20 6265 206f 6620  urces can be of 
-00013db0: 6469 6666 6572 656e 7420 7361 6d70 6c65  different sample
-00013dc0: 2072 6174 6520 2861 6c6c 2073 6f75 7263   rate (all sourc
-00013dd0: 6573 2061 7265 206d 6170 7065 6420 746f  es are mapped to
-00013de0: 2074 6865 2074 6172 6765 7473 2073 616d   the targets sam
-00013df0: 706c 6520 7261 7465 2077 6865 6e20 636f  ple rate when co
-00013e00: 6e74 6578 7420 6973 2070 726f 6475 6365  ntext is produce
-00013e10: 6429 3c2f 703e 0a3c 703e 536f 7572 6365  d)</p>.<p>Source
-00013e20: 7320 6361 6e20 6265 206f 6620 6569 7468  s can be of eith
-00013e30: 6572 3a3c 2f70 3e0a 3c70 3e31 2920 436f  er:</p>.<p>1) Co
-00013e40: 6e74 696e 756f 7573 2074 7970 6520 2874  ntinuous type (t
-00013e50: 686f 7365 2074 6861 7420 6861 7665 2073  hose that have s
-00013e60: 6f6d 6520 6b69 6e64 206f 6620 6172 6974  ome kind of arit
-00013e70: 686d 6574 6963 2076 616c 7565 293c 2f70  hmetic value)</p
-00013e80: 3e0a 3c70 3e32 2920 4469 7363 7265 7465  >.<p>2) Discrete
-00013e90: 2065 7665 6e74 7320 2877 6974 686f 7574   events (without
-00013ea0: 2076 616c 7565 2920 2c20 7768 6572 6520   value) , where 
-00013eb0: 6f6e 6520 6f66 2074 6865 2074 7970 6520  one of the type 
-00013ec0: 6973 6f6c 6174 6564 206f 7220 636f 6e66  isolated or conf
-00013ed0: 6967 7572 6174 696f 6e20 6d75 7374 2062  iguration must b
-00013ee0: 6520 6173 7369 676e 6564 0a41 2067 7569  e assigned.A gui
-00013ef0: 6465 206f 6e20 686f 7720 746f 2073 7065  de on how to spe
-00013f00: 6369 6679 2074 6865 2074 7970 6520 6973  cify the type is
-00013f10: 2c20 7468 6174 2065 7665 6e74 7320 7768  , that events wh
-00013f20: 6963 6820 6173 7375 6d65 6420 746f 2068  ich assumed to h
-00013f30: 6176 6520 696d 7061 6374 206f 6e6c 7920  ave impact only 
-00013f40: 6f6e 2074 6865 6972 206f 6363 7572 7265  on their occurre
-00013f50: 6e63 652c 2061 7265 2063 616c 6c65 640a  nce, are called.
-00013f60: 6973 6f6c 6174 6564 2c20 7768 696c 6520  isolated, while 
-00013f70: 6f74 6865 7273 2074 6861 7420 6172 6520  others that are 
-00013f80: 7265 6c61 7465 6420 746f 2073 6f6d 6520  related to some 
-00013f90: 6b69 6e64 206f 6620 636f 6e66 6967 7572  kind of configur
-00013fa0: 6174 696f 6e20 7769 7468 206d 6f72 6520  ation with more 
-00013fb0: 7065 726d 616e 656e 7420 696d 7061 6374  permanent impact
-00013fc0: 2c20 6172 6520 6361 6c6c 6564 2063 6f6e  , are called con
-00013fd0: 6669 6775 7261 7469 6f6e 2e0a 4573 7365  figuration..Esse
-00013fe0: 6e74 6961 6c6c 7920 7468 6520 7479 7065  ntially the type
-00013ff0: 206f 6620 7468 6520 6576 656e 7473 2064   of the events d
-00014000: 6566 696e 6520 7468 6520 7761 7920 7468  efine the way th
-00014010: 6174 2077 696c 6c20 6265 2074 7261 6e73  at will be trans
-00014020: 666f 726d 6564 2074 6f20 7265 616c 2076  formed to real v
-00014030: 616c 7565 7320 7469 6d65 2d73 6572 6965  alues time-serie
-00014040: 732e 3c2f 703e 0a3c 703e 3c73 7472 6f6e  s.</p>.<p><stron
-00014050: 673e 5061 7261 6d65 7465 7273 3c2f 7374  g>Parameters</st
-00014060: 726f 6e67 3e3a 3c2f 703e 0a3c 703e 3c73  rong>:</p>.<p><s
-00014070: 7472 6f6e 673e 7469 6d65 7374 616d 703c  trong>timestamp<
-00014080: 2f73 7472 6f6e 673e 3a0a 5468 6520 7469  /strong>:.The ti
-00014090: 6d65 7374 616d 7020 6f66 2074 6865 2061  mestamp of the a
-000140a0: 7272 6976 6564 2076 616c 7565 3c2f 703e  rrived value</p>
-000140b0: 0a3c 703e 3c73 7472 6f6e 673e 736f 7572  .<p><strong>sour
-000140c0: 6365 3c2f 7374 726f 6e67 3e3a 2054 6865  ce</strong>: The
-000140d0: 2073 6f75 7263 6520 6f66 2074 6865 2061   source of the a
-000140e0: 7272 6976 6564 2076 616c 7565 3c2f 703e  rrived value</p>
-000140f0: 0a3c 703e 3c73 7472 6f6e 673e 6e61 6d65  .<p><strong>name
-00014100: 3c2f 7374 726f 6e67 3e3a 2054 6865 206e  </strong>: The n
-00014110: 616d 6520 286f 7220 6964 656e 7469 6669  ame (or identifi
-00014120: 6572 2920 6f66 2074 6865 2061 7272 6976  er) of the arriv
-00014130: 6564 2076 616c 7565 3c2f 703e 0a3c 703e  ed value</p>.<p>
-00014140: 3c73 7472 6f6e 673e 7661 6c75 653c 2f73  <strong>value</s
-00014150: 7472 6f6e 673e 3a20 5468 6520 7661 6c75  trong>: The valu
-00014160: 6520 2866 6c6f 6174 292c 2069 6e20 6361  e (float), in ca
-00014170: 7365 2074 6869 7320 6973 204e 6f6e 6520  se this is None 
-00014180: 7468 6520 6172 7269 7665 6420 6461 7461  the arrived data
-00014190: 2069 7320 636f 6e73 6964 6572 6564 2061   is considered a
-000141a0: 7320 6576 656e 743c 2f70 3e0a 3c70 3e3c  s event</p>.<p><
-000141b0: 7374 726f 6e67 3e74 7970 653c 2f73 7472  strong>type</str
-000141c0: 6f6e 673e 3a20 7468 6520 7479 7065 206f  ong>: the type o
-000141d0: 6620 7468 6520 6461 7461 2063 616e 2062  f the data can b
-000141e0: 6520 6f6e 6520 6f66 2022 6973 6f6c 6174  e one of "isolat
-000141f0: 6564 222c 2263 6f6e 6669 6775 7261 7469  ed","configurati
-00014200: 6f6e 2220 7768 656e 206e 6f20 7661 6c75  on" when no valu
-00014210: 6520 6973 2070 6173 7365 643c 2f70 3e0a  e is passed</p>.
-00014220: 3c70 3e3c 7374 726f 6e67 3e72 6574 7572  <p><strong>retur
-00014230: 6e3c 2f73 7472 6f6e 673e 3a0a 7374 7275  n</strong>:.stru
-00014240: 6374 7572 652e 436f 6e74 6578 7420 6f62  cture.Context ob
-00014250: 6a65 6374 2077 6865 6e20 7468 6520 6461  ject when the da
-00014260: 7461 206e 616d 6520 6d61 7463 6820 746f  ta name match to
-00014270: 2074 6865 2074 6172 6765 7420 6e61 6d65   the target name
-00014280: 206f 7220 4e6f 6e65 2e3c 2f70 3e3c 2f64   or None.</p></d
-00014290: 6976 3e0a 3c64 6574 6169 6c73 2063 6c61  iv>.<details cla
-000142a0: 7373 3d22 736f 7572 6365 223e 0a3c 7375  ss="source">.<su
-000142b0: 6d6d 6172 793e 0a3c 7370 616e 3e45 7870  mmary>.<span>Exp
-000142c0: 616e 6420 736f 7572 6365 2063 6f64 653c  and source code<
-000142d0: 2f73 7061 6e3e 0a3c 2f73 756d 6d61 7279  /span>.</summary
-000142e0: 3e0a 3c70 7265 3e3c 636f 6465 2063 6c61  >.<pre><code cla
-000142f0: 7373 3d22 7079 7468 6f6e 223e 6465 6620  ss="python">def 
-00014300: 636f 6c6c 6563 745f 6461 7461 2873 656c  collect_data(sel
-00014310: 662c 2074 696d 6573 7461 6d70 2c20 736f  f, timestamp, so
-00014320: 7572 6365 2c20 6e61 6d65 2c20 7661 6c75  urce, name, valu
-00014330: 653d 4e6f 6e65 2c20 7479 7065 3d26 2333  e=None, type=&#3
-00014340: 343b 556e 6976 6172 6961 7465 2623 3334  4;Univariate&#34
-00014350: 3b29 3a0a 2020 2020 2623 3339 3b26 2333  ;):.    &#39;&#3
-00014360: 393b 2623 3339 3b0a 2020 2020 5468 6973  9;&#39;.    This
-00014370: 206d 6574 686f 6420 6973 2075 7365 6420   method is used 
-00014380: 7768 656e 2064 6174 6120 6172 6520 7061  when data are pa
-00014390: 7373 6564 2069 7465 7261 7469 7665 6c79  ssed iteratively
-000143a0: 2c20 616e 6420 7374 6f72 6564 2069 6e20  , and stored in 
-000143b0: 6275 6666 6572 0a20 2020 2057 6865 6e20  buffer.    When 
-000143c0: 6461 7461 206f 6620 7461 7267 6574 2073  data of target s
-000143d0: 6f75 7263 6520 6172 7269 7665 2c20 6120  ource arrive, a 
-000143e0: 636f 7272 6573 706f 6e64 696e 6720 636f  corresponding co
-000143f0: 6e74 6578 7420 6973 2070 726f 6475 6365  ntext is produce
-00014400: 642e 0a20 2020 2053 6f75 7263 6573 2063  d..    Sources c
-00014410: 616e 2062 6520 6f66 2064 6966 6665 7265  an be of differe
-00014420: 6e74 2073 616d 706c 6520 7261 7465 2028  nt sample rate (
-00014430: 616c 6c20 736f 7572 6365 7320 6172 6520  all sources are 
-00014440: 6d61 7070 6564 2074 6f20 7468 6520 7461  mapped to the ta
-00014450: 7267 6574 7320 7361 6d70 6c65 2072 6174  rgets sample rat
-00014460: 6520 7768 656e 2063 6f6e 7465 7874 2069  e when context i
-00014470: 7320 7072 6f64 7563 6564 290a 0a20 2020  s produced)..   
-00014480: 2053 6f75 7263 6573 2063 616e 2062 6520   Sources can be 
-00014490: 6f66 2065 6974 6865 723a 0a0a 2020 2020  of either:..    
-000144a0: 3129 2043 6f6e 7469 6e75 6f75 7320 7479  1) Continuous ty
-000144b0: 7065 2028 7468 6f73 6520 7468 6174 2068  pe (those that h
-000144c0: 6176 6520 736f 6d65 206b 696e 6420 6f66  ave some kind of
-000144d0: 2061 7269 7468 6d65 7469 6320 7661 6c75   arithmetic valu
-000144e0: 6529 0a0a 2020 2020 3229 2044 6973 6372  e)..    2) Discr
-000144f0: 6574 6520 6576 656e 7473 2028 7769 7468  ete events (with
-00014500: 6f75 7420 7661 6c75 6529 202c 2077 6865  out value) , whe
-00014510: 7265 206f 6e65 206f 6620 7468 6520 7479  re one of the ty
-00014520: 7065 2069 736f 6c61 7465 6420 6f72 2063  pe isolated or c
-00014530: 6f6e 6669 6775 7261 7469 6f6e 206d 7573  onfiguration mus
-00014540: 7420 6265 2061 7373 6967 6e65 640a 2020  t be assigned.  
-00014550: 2020 2020 2020 4120 6775 6964 6520 6f6e        A guide on
-00014560: 2068 6f77 2074 6f20 7370 6563 6966 7920   how to specify 
-00014570: 7468 6520 7479 7065 2069 732c 2074 6861  the type is, tha
-00014580: 7420 6576 656e 7473 2077 6869 6368 2061  t events which a
-00014590: 7373 756d 6564 2074 6f20 6861 7665 2069  ssumed to have i
-000145a0: 6d70 6163 7420 6f6e 6c79 206f 6e20 7468  mpact only on th
-000145b0: 6569 7220 6f63 6375 7272 656e 6365 2c20  eir occurrence, 
-000145c0: 6172 6520 6361 6c6c 6564 0a20 2020 2020  are called.     
-000145d0: 2020 2069 736f 6c61 7465 642c 2077 6869     isolated, whi
-000145e0: 6c65 206f 7468 6572 7320 7468 6174 2061  le others that a
-000145f0: 7265 2072 656c 6174 6564 2074 6f20 736f  re related to so
-00014600: 6d65 206b 696e 6420 6f66 2063 6f6e 6669  me kind of confi
-00014610: 6775 7261 7469 6f6e 2077 6974 6820 6d6f  guration with mo
-00014620: 7265 2070 6572 6d61 6e65 6e74 2069 6d70  re permanent imp
-00014630: 6163 742c 2061 7265 2063 616c 6c65 6420  act, are called 
-00014640: 636f 6e66 6967 7572 6174 696f 6e2e 0a20  configuration.. 
-00014650: 2020 2020 2020 2045 7373 656e 7469 616c         Essential
-00014660: 6c79 2074 6865 2074 7970 6520 6f66 2074  ly the type of t
-00014670: 6865 2065 7665 6e74 7320 6465 6669 6e65  he events define
-00014680: 2074 6865 2077 6179 2074 6861 7420 7769   the way that wi
-00014690: 6c6c 2062 6520 7472 616e 7366 6f72 6d65  ll be transforme
-000146a0: 6420 746f 2072 6561 6c20 7661 6c75 6573  d to real values
-000146b0: 2074 696d 652d 7365 7269 6573 2e0a 0a20   time-series... 
-000146c0: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
-000146d0: 2a3a 0a0a 2020 2020 2a2a 7469 6d65 7374  *:..    **timest
-000146e0: 616d 702a 2a3a 2020 5468 6520 7469 6d65  amp**:  The time
-000146f0: 7374 616d 7020 6f66 2074 6865 2061 7272  stamp of the arr
-00014700: 6976 6564 2076 616c 7565 0a0a 2020 2020  ived value..    
-00014710: 2a2a 736f 7572 6365 2a2a 3a20 5468 6520  **source**: The 
-00014720: 736f 7572 6365 206f 6620 7468 6520 6172  source of the ar
-00014730: 7269 7665 6420 7661 6c75 650a 0a20 2020  rived value..   
-00014740: 202a 2a6e 616d 652a 2a3a 2054 6865 206e   **name**: The n
-00014750: 616d 6520 286f 7220 6964 656e 7469 6669  ame (or identifi
-00014760: 6572 2920 6f66 2074 6865 2061 7272 6976  er) of the arriv
-00014770: 6564 2076 616c 7565 0a0a 2020 2020 2a2a  ed value..    **
-00014780: 7661 6c75 652a 2a3a 2054 6865 2076 616c  value**: The val
-00014790: 7565 2028 666c 6f61 7429 2c20 696e 2063  ue (float), in c
-000147a0: 6173 6520 7468 6973 2069 7320 4e6f 6e65  ase this is None
-000147b0: 2074 6865 2061 7272 6976 6564 2064 6174   the arrived dat
-000147c0: 6120 6973 2063 6f6e 7369 6465 7265 6420  a is considered 
-000147d0: 6173 2065 7665 6e74 0a0a 2020 2020 2a2a  as event..    **
-000147e0: 7479 7065 2a2a 3a20 7468 6520 7479 7065  type**: the type
-000147f0: 206f 6620 7468 6520 6461 7461 2063 616e   of the data can
-00014800: 2062 6520 6f6e 6520 6f66 2026 2333 343b   be one of &#34;
-00014810: 6973 6f6c 6174 6564 2623 3334 3b2c 2623  isolated&#34;,&#
-00014820: 3334 3b63 6f6e 6669 6775 7261 7469 6f6e  34;configuration
-00014830: 2623 3334 3b20 7768 656e 206e 6f20 7661  &#34; when no va
-00014840: 6c75 6520 6973 2070 6173 7365 640a 0a20  lue is passed.. 
-00014850: 2020 202a 2a72 6574 7572 6e2a 2a3a 2020     **return**:  
-00014860: 7374 7275 6374 7572 652e 436f 6e74 6578  structure.Contex
-00014870: 7420 6f62 6a65 6374 2077 6865 6e20 7468  t object when th
-00014880: 6520 6461 7461 206e 616d 6520 6d61 7463  e data name matc
-00014890: 6820 746f 2074 6865 2074 6172 6765 7420  h to the target 
-000148a0: 6e61 6d65 206f 7220 4e6f 6e65 2e0a 2020  name or None..  
-000148b0: 2020 2623 3339 3b26 2333 393b 2623 3339    &#39;&#39;&#39
-000148c0: 3b0a 0a20 2020 2069 6620 7661 6c75 6520  ;..    if value 
-000148d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-000148e0: 2069 6620 7479 7065 206e 6f74 2069 6e20   if type not in 
-000148f0: 5b26 2333 343b 6973 6f6c 6174 6564 2623  [&#34;isolated&#
-00014900: 3334 3b2c 2026 2333 343b 636f 6e66 6967  34;, &#34;config
-00014910: 7572 6174 696f 6e26 2333 343b 5d3a 0a20  uration&#34;]:. 
-00014920: 2020 2020 2020 2020 2020 2061 7373 6572             asser
-00014930: 7420 4661 6c73 652c 2026 2333 343b 5468  t False, &#34;Th
-00014940: 6520 7479 7065 206d 7573 7420 6265 2064  e type must be d
-00014950: 6566 696e 6564 2061 7320 6f6e 6520 6f66  efined as one of
-00014960: 205c 2623 3334 3b69 736f 6c61 7465 645c   \&#34;isolated\
-00014970: 2623 3334 3b20 616e 6420 5c26 2333 343b  &#34; and \&#34;
-00014980: 636f 6e66 6967 7572 6174 696f 6e5c 2623  configuration\&#
-00014990: 3334 3b20 7768 656e 206e 6f20 7661 6c75  34; when no valu
-000149a0: 6520 6973 2070 6173 7365 6426 2333 343b  e is passed&#34;
-000149b0: 0a20 2020 2065 7665 6e74 706f 696e 7420  .    eventpoint 
-000149c0: 3d20 4576 656e 7470 6f69 6e74 2863 6f64  = Eventpoint(cod
-000149d0: 653d 6e61 6d65 2c20 736f 7572 6365 3d73  e=name, source=s
-000149e0: 6f75 7263 652c 2074 696d 6573 7461 6d70  ource, timestamp
-000149f0: 3d74 696d 6573 7461 6d70 2c20 6465 7461  =timestamp, deta
-00014a00: 696c 733d 7661 6c75 652c 2074 7970 653d  ils=value, type=
-00014a10: 7479 7065 290a 2020 2020 7365 6c66 2e61  type).    self.a
-00014a20: 6464 5f74 6f5f 6275 6666 6572 2865 7665  dd_to_buffer(eve
-00014a30: 6e74 706f 696e 7429 0a20 2020 2069 6620  ntpoint).    if 
-00014a40: 7365 6c66 2e74 6172 6765 7420 3d3d 206e  self.target == n
-00014a50: 616d 6520 6f72 2073 656c 662e 7461 7267  ame or self.targ
-00014a60: 6574 203d 3d20 6626 2333 343b 7b6e 616d  et == f&#34;{nam
-00014a70: 657d 407b 736f 7572 6365 7d26 2333 343b  e}@{source}&#34;
-00014a80: 3a0a 2020 2020 2020 2020 636f 6e74 6578  :.        contex
-00014a90: 746f 626a 6563 7420 3d20 7365 6c66 2e67  tobject = self.g
-00014aa0: 656e 6572 6174 655f 636f 6e74 6578 7428  enerate_context(
-00014ab0: 653d 6576 656e 7470 6f69 6e74 2c20 6275  e=eventpoint, bu
-00014ac0: 6666 6572 3d73 656c 662e 6275 6666 6572  ffer=self.buffer
-00014ad0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00014ae0: 2063 6f6e 7465 7874 6f62 6a65 6374 0a20   contextobject. 
-00014af0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00014b00: 2072 6574 7572 6e20 4e6f 6e65 3c2f 636f   return None</co
-00014b10: 6465 3e3c 2f70 7265 3e0a 3c2f 6465 7461  de></pre>.</deta
-00014b20: 696c 733e 0a3c 2f64 643e 0a3c 6474 2069  ils>.</dd>.<dt i
-00014b30: 643d 2250 646d 436f 6e74 6578 742e 436f  d="PdmContext.Co
-00014b40: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
-00014b50: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
-00014b60: 2e63 7265 6174 655f 636f 6e74 6578 7422  .create_context"
-00014b70: 3e3c 636f 6465 2063 6c61 7373 3d22 6e61  ><code class="na
-00014b80: 6d65 2066 6c65 7822 3e0a 3c73 7061 6e3e  me flex">.<span>
-00014b90: 6465 6620 3c73 7061 6e20 636c 6173 733d  def <span class=
-00014ba0: 2269 6465 6e74 223e 6372 6561 7465 5f63  "ident">create_c
-00014bb0: 6f6e 7465 7874 3c2f 7370 616e 3e3c 2f73  ontext</span></s
-00014bc0: 7061 6e3e 283c 7370 616e 3e73 656c 662c  pan>(<span>self,
-00014bd0: 2063 7572 7265 6e74 3ac2 a03c 6120 7469   current:..<a ti
-00014be0: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
-00014bf0: 7574 696c 732e 7374 7275 6374 7572 652e  utils.structure.
-00014c00: 4576 656e 7470 6f69 6e74 2220 6872 6566  Eventpoint" href
-00014c10: 3d22 7574 696c 732f 7374 7275 6374 7572  ="utils/structur
-00014c20: 652e 6874 6d6c 2350 646d 436f 6e74 6578  e.html#PdmContex
-00014c30: 742e 7574 696c 732e 7374 7275 6374 7572  t.utils.structur
-00014c40: 652e 4576 656e 7470 6f69 6e74 223e 4576  e.Eventpoint">Ev
-00014c50: 656e 7470 6f69 6e74 3c2f 613e 2c20 6275  entpoint</a>, bu
-00014c60: 6666 6572 293c 2f73 7061 6e3e 0a3c 2f63  ffer)</span>.</c
-00014c70: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
-00014c80: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
-00014c90: 3e3c 703e 5472 616e 7366 6f72 6d20 7468  ><p>Transform th
-00014ca0: 6520 6461 7461 2063 6f6c 6c65 6374 6564  e data collected
-00014cb0: 2074 6f20 7468 6520 6275 6666 6572 2069   to the buffer i
-00014cc0: 6e20 746f 2073 7569 7461 626c 6520 666f  n to suitable fo
-00014cd0: 726d 2061 6e64 2067 656e 6572 6174 6573  rm and generates
-00014ce0: 2074 6865 2043 4420 7061 7274 206f 6620   the CD part of 
-00014cf0: 7468 6520 636f 6e74 6578 7420 616c 6f6e  the context alon
-00014d00: 6720 7769 7468 0a74 6865 2065 6467 6573  g with.the edges
-00014d10: 2061 6e64 2063 6861 7261 6374 6572 697a   and characteriz
-00014d20: 6174 696f 6e73 3a3c 2f70 3e0a 3c70 3e3c  ations:</p>.<p><
-00014d30: 7374 726f 6e67 3e53 7465 7073 3a3c 2f73  strong>Steps:</s
-00014d40: 7472 6f6e 673e 3c2f 703e 0a3c 703e 3c73  trong></p>.<p><s
-00014d50: 7472 6f6e 673e 4372 6561 7465 2043 443c  trong>Create CD<
-00014d60: 2f73 7472 6f6e 673e 3a20 5061 7261 6c6c  /strong>: Parall
-00014d70: 656c 2063 6f6e 7469 6e75 6f75 7320 7265  el continuous re
-00014d80: 7072 6573 656e 7461 7469 6f6e 7320 6f66  presentations of
-00014d90: 2061 6c6c 2064 6966 6665 7265 6e74 2073   all different s
-00014da0: 6f75 7263 6573 2069 6e20 7468 6520 6275  ources in the bu
-00014db0: 6666 6572 2e0a 5468 6973 2073 7465 7020  ffer..This step 
-00014dc0: 696e 766f 6c76 6573 2c20 6d61 7463 6869  involves, matchi
-00014dd0: 6e67 2074 6865 2064 6966 6665 7265 6e74  ng the different
-00014de0: 2073 616d 706c 6520 7261 7465 7320 6f66   sample rates of
-00014df0: 2064 6966 6665 7265 6e74 2073 6f75 7263   different sourc
-00014e00: 6573 2074 6f20 7468 6174 206f 6620 7468  es to that of th
-00014e10: 6520 7461 7267 6574 2e0a 5472 616e 7366  e target..Transf
-00014e20: 6f72 6d20 7468 6520 4576 656e 7420 736f  orm the Event so
-00014e30: 7572 6365 7320 746f 2063 6f6e 7469 6e75  urces to continu
-00014e40: 6f75 7320 7265 7072 6573 656e 7461 7469  ous representati
-00014e50: 6f6e 2e3c 2f70 3e0a 3c70 3e3c 7374 726f  on.</p>.<p><stro
-00014e60: 6e67 3e43 616c 6375 6c61 7465 2043 6175  ng>Calculate Cau
-00014e70: 7361 6c69 7479 2065 6467 6573 3c2f 7374  sality edges</st
-00014e80: 726f 6e67 3e3a 2050 6572 666f 726d 2043  rong>: Perform C
-00014e90: 6175 7361 6c20 4469 7363 6f76 6572 7920  ausal Discovery 
-00014ea0: 7573 696e 6720 7468 6520 6361 7573 616c  using the causal
-00014eb0: 6974 7920 6675 6e63 7469 6f6e 2c20 746f  ity function, to
-00014ec0: 2063 7265 6174 6520 6564 6765 730a 2870   create edges.(p
-00014ed0: 6172 7420 6f66 2043 5220 6f66 2074 6865  art of CR of the
-00014ee0: 2043 6f6e 7465 7874 293c 2f70 3e0a 3c70   Context)</p>.<p
-00014ef0: 3e3c 7374 726f 6e67 3e54 6167 2065 6163  ><strong>Tag eac
-00014f00: 6820 6564 6765 2077 6974 6820 6368 6172  h edge with char
-00014f10: 6163 7465 7269 7a61 7469 6f6e 3c2f 7374  acterization</st
-00014f20: 726f 6e67 3e3a 2066 6f72 2065 6163 6820  rong>: for each 
-00014f30: 2861 2c62 2920 696e 2074 6865 2065 6467  (a,b) in the edg
-00014f40: 6573 2c20 6120 6368 6172 6163 7465 7269  es, a characteri
-00014f50: 7a61 7469 6f6e 206f 6620 2875 6e6b 6e6f  zation of (unkno
-00014f60: 776e 2c20 6465 6372 6561 7365 2c0a 696e  wn, decrease,.in
-00014f70: 6372 6561 7365 292c 2062 6173 6564 206f  crease), based o
-00014f80: 6e20 7468 6520 7479 7065 206f 6620 7468  n the type of th
-00014f90: 6520 612e 3c2f 703e 0a3c 703e 3c73 7472  e a.</p>.<p><str
-00014fa0: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
-00014fb0: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
-00014fc0: 3c73 7472 6f6e 673e 6375 7272 656e 743c  <strong>current<
-00014fd0: 2f73 7472 6f6e 673e 3a20 5468 6520 6375  /strong>: The cu
-00014fe0: 7272 656e 7420 4576 656e 7420 6f66 2074  rrent Event of t
-00014ff0: 6172 6765 7427 7320 6461 7461 2077 6869  arget's data whi
-00015000: 6368 2074 7269 6765 7220 7468 6520 636f  ch triger the co
-00015010: 6e74 6578 7420 6372 6561 7469 6f6e 3c2f  ntext creation</
-00015020: 703e 0a3c 703e 3c73 7472 6f6e 673e 6275  p>.<p><strong>bu
-00015030: 6666 6572 3c2f 7374 726f 6e67 3e3a 206f  ffer</strong>: o
-00015040: 7264 6572 6564 206c 6973 7420 7769 7468  rdered list with
-00015050: 2045 7665 6e74 706f 696e 7420 6f66 2061   Eventpoint of a
-00015060: 6c6c 2073 6f75 7263 6573 2e3c 2f70 3e0a  ll sources.</p>.
-00015070: 3c70 3e3c 7374 726f 6e67 3e72 6574 7572  <p><strong>retur
-00015080: 6e3c 2f73 7472 6f6e 673e 3a20 436f 6e74  n</strong>: Cont
-00015090: 6578 7420 6f62 6a65 6374 2e3c 2f70 3e3c  ext object.</p><
-000150a0: 2f64 6976 3e0a 3c64 6574 6169 6c73 2063  /div>.<details c
-000150b0: 6c61 7373 3d22 736f 7572 6365 223e 0a3c  lass="source">.<
-000150c0: 7375 6d6d 6172 793e 0a3c 7370 616e 3e45  summary>.<span>E
-000150d0: 7870 616e 6420 736f 7572 6365 2063 6f64  xpand source cod
-000150e0: 653c 2f73 7061 6e3e 0a3c 2f73 756d 6d61  e</span>.</summa
-000150f0: 7279 3e0a 3c70 7265 3e3c 636f 6465 2063  ry>.<pre><code c
-00015100: 6c61 7373 3d22 7079 7468 6f6e 223e 6465  lass="python">de
-00015110: 6620 6372 6561 7465 5f63 6f6e 7465 7874  f create_context
-00015120: 2873 656c 662c 2063 7572 7265 6e74 3a20  (self, current: 
-00015130: 4576 656e 7470 6f69 6e74 2c20 6275 6666  Eventpoint, buff
-00015140: 6572 293a 0a20 2020 2026 2333 343b 2623  er):.    &#34;&#
-00015150: 3334 3b26 2333 343b 0a20 2020 2054 7261  34;&#34;.    Tra
-00015160: 6e73 666f 726d 2074 6865 2064 6174 6120  nsform the data 
-00015170: 636f 6c6c 6563 7465 6420 746f 2074 6865  collected to the
-00015180: 2062 7566 6665 7220 696e 2074 6f20 7375   buffer in to su
-00015190: 6974 6162 6c65 2066 6f72 6d20 616e 6420  itable form and 
-000151a0: 6765 6e65 7261 7465 7320 7468 6520 4344  generates the CD
-000151b0: 2070 6172 7420 6f66 2074 6865 2063 6f6e   part of the con
-000151c0: 7465 7874 2061 6c6f 6e67 2077 6974 680a  text along with.
-000151d0: 2020 2020 7468 6520 6564 6765 7320 616e      the edges an
-000151e0: 6420 6368 6172 6163 7465 7269 7a61 7469  d characterizati
-000151f0: 6f6e 733a 0a0a 2020 2020 2a2a 5374 6570  ons:..    **Step
-00015200: 733a 2a2a 0a0a 2020 2020 2a2a 4372 6561  s:**..    **Crea
-00015210: 7465 2043 442a 2a3a 2050 6172 616c 6c65  te CD**: Paralle
-00015220: 6c20 636f 6e74 696e 756f 7573 2072 6570  l continuous rep
-00015230: 7265 7365 6e74 6174 696f 6e73 206f 6620  resentations of 
-00015240: 616c 6c20 6469 6666 6572 656e 7420 736f  all different so
-00015250: 7572 6365 7320 696e 2074 6865 2062 7566  urces in the buf
-00015260: 6665 722e 0a20 2020 2054 6869 7320 7374  fer..    This st
-00015270: 6570 2069 6e76 6f6c 7665 732c 206d 6174  ep involves, mat
-00015280: 6368 696e 6720 7468 6520 6469 6666 6572  ching the differ
-00015290: 656e 7420 7361 6d70 6c65 2072 6174 6573  ent sample rates
-000152a0: 206f 6620 6469 6666 6572 656e 7420 736f   of different so
-000152b0: 7572 6365 7320 746f 2074 6861 7420 6f66  urces to that of
-000152c0: 2074 6865 2074 6172 6765 742e 0a20 2020   the target..   
-000152d0: 2054 7261 6e73 666f 726d 2074 6865 2045   Transform the E
-000152e0: 7665 6e74 2073 6f75 7263 6573 2074 6f20  vent sources to 
-000152f0: 636f 6e74 696e 756f 7573 2072 6570 7265  continuous repre
-00015300: 7365 6e74 6174 696f 6e2e 0a20 2020 200a  sentation..    .
-00015310: 2020 2020 2a2a 4361 6c63 756c 6174 6520      **Calculate 
-00015320: 4361 7573 616c 6974 7920 6564 6765 732a  Causality edges*
-00015330: 2a3a 2050 6572 666f 726d 2043 6175 7361  *: Perform Causa
-00015340: 6c20 4469 7363 6f76 6572 7920 7573 696e  l Discovery usin
-00015350: 6720 7468 6520 6361 7573 616c 6974 7920  g the causality 
-00015360: 6675 6e63 7469 6f6e 2c20 746f 2063 7265  function, to cre
-00015370: 6174 6520 6564 6765 7320 0a20 2020 2028  ate edges .    (
-00015380: 7061 7274 206f 6620 4352 206f 6620 7468  part of CR of th
-00015390: 6520 436f 6e74 6578 7429 0a20 2020 200a  e Context).    .
-000153a0: 2020 2020 2a2a 5461 6720 6561 6368 2065      **Tag each e
-000153b0: 6467 6520 7769 7468 2063 6861 7261 6374  dge with charact
-000153c0: 6572 697a 6174 696f 6e2a 2a3a 2066 6f72  erization**: for
-000153d0: 2065 6163 6820 2861 2c62 2920 696e 2074   each (a,b) in t
-000153e0: 6865 2065 6467 6573 2c20 6120 6368 6172  he edges, a char
-000153f0: 6163 7465 7269 7a61 7469 6f6e 206f 6620  acterization of 
-00015400: 2875 6e6b 6e6f 776e 2c20 6465 6372 6561  (unknown, decrea
-00015410: 7365 2c0a 2020 2020 2069 6e63 7265 6173  se,.     increas
-00015420: 6529 2c20 6261 7365 6420 6f6e 2074 6865  e), based on the
-00015430: 2074 7970 6520 6f66 2074 6865 2061 2e0a   type of the a..
-00015440: 0a20 2020 2020 2a2a 5061 7261 6d65 7465  .     **Paramete
-00015450: 7273 2a2a 3a0a 0a20 2020 2020 2a2a 6375  rs**:..     **cu
-00015460: 7272 656e 742a 2a3a 2054 6865 2063 7572  rrent**: The cur
-00015470: 7265 6e74 2045 7665 6e74 206f 6620 7461  rent Event of ta
-00015480: 7267 6574 2623 3339 3b73 2064 6174 6120  rget&#39;s data 
-00015490: 7768 6963 6820 7472 6967 6572 2074 6865  which triger the
-000154a0: 2063 6f6e 7465 7874 2063 7265 6174 696f   context creatio
-000154b0: 6e0a 0a20 2020 2020 2a2a 6275 6666 6572  n..     **buffer
-000154c0: 2a2a 3a20 6f72 6465 7265 6420 6c69 7374  **: ordered list
-000154d0: 2077 6974 6820 4576 656e 7470 6f69 6e74   with Eventpoint
-000154e0: 206f 6620 616c 6c20 736f 7572 6365 732e   of all sources.
-000154f0: 0a0a 2020 2020 202a 2a72 6574 7572 6e2a  ..     **return*
-00015500: 2a3a 2043 6f6e 7465 7874 206f 626a 6563  *: Context objec
-00015510: 742e 0a20 2020 2026 2333 343b 2623 3334  t..    &#34;&#34
-00015520: 3b26 2333 343b 0a20 2020 2023 2073 7461  ;&#34;.    # sta
-00015530: 7274 203d 2074 696d 652e 7469 6d65 2829  rt = time.time()
-00015540: 0a20 2020 2023 2064 6620 7769 7468 202c  .    # df with ,
-00015550: 6474 2c63 6f64 652c 736f 7572 6365 2c76  dt,code,source,v
-00015560: 616c 7565 0a20 2020 2070 6f73 203d 2073  alue.    pos = s
-00015570: 656c 662e 636f 6e74 6578 745f 706f 730a  elf.context_pos.
-00015580: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-00015590: 6765 2870 6f73 2c20 6c65 6e28 6275 6666  ge(pos, len(buff
-000155a0: 6572 2929 3a0a 2020 2020 2020 2020 6966  er)):.        if
-000155b0: 2062 7566 6665 725b 695d 2e74 696d 6573   buffer[i].times
-000155c0: 7461 6d70 2026 6c74 3b3d 2028 6375 7272  tamp &lt;= (curr
-000155d0: 656e 742e 7469 6d65 7374 616d 7020 2d20  ent.timestamp - 
-000155e0: 7064 2e54 696d 6564 656c 7461 2873 656c  pd.Timedelta(sel
-000155f0: 662e 686f 7269 7a6f 6e2c 2073 656c 662e  f.horizon, self.
-00015600: 686f 7269 7a6f 6e5f 7469 6d65 2929 3a0a  horizon_time)):.
-00015610: 2020 2020 2020 2020 2020 2020 706f 7320              pos 
-00015620: 3d20 690a 2020 2020 2020 2020 656c 7365  = i.        else
-00015630: 3a0a 2020 2020 2020 2020 2020 2020 6272  :.            br
-00015640: 6561 6b0a 0a20 2020 2073 656c 662e 636f  eak..    self.co
-00015650: 6e74 6578 745f 706f 7320 3d20 706f 730a  ntext_pos = pos.
-00015660: 2020 2020 2320 656e 643d 7469 6d65 2e74      # end=time.t
-00015670: 696d 6528 290a 2020 2020 2320 7072 696e  ime().    # prin
-00015680: 7428 6626 2333 343b 6669 6e64 2070 6f73  t(f&#34;find pos
-00015690: 6974 696f 6e20 6f6e 2062 7566 6665 723a  ition on buffer:
-000156a0: 207b 656e 642d 7374 6172 747d 2623 3334   {end-start}&#34
-000156b0: 3b29 0a0a 2020 2020 2320 7374 6172 7420  ;)..    # start 
-000156c0: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
-000156d0: 2020 6461 7461 666f 7263 6f6e 7465 7874    dataforcontext
-000156e0: 203d 2062 7566 6665 725b 706f 733a 5d0a   = buffer[pos:].
-000156f0: 2020 2020 6461 7461 746f 6466 203d 205b      datatodf = [
-00015700: 5b70 642e 746f 5f64 6174 6574 696d 6528  [pd.to_datetime(
-00015710: 652e 7469 6d65 7374 616d 7029 2066 6f72  e.timestamp) for
-00015720: 2065 2069 6e20 6461 7461 666f 7263 6f6e   e in dataforcon
-00015730: 7465 7874 5d2c 0a20 2020 2020 2020 2020  text],.         
-00015740: 2020 2020 2020 205b 7374 7228 652e 636f         [str(e.co
-00015750: 6465 2920 666f 7220 6520 696e 2064 6174  de) for e in dat
-00015760: 6166 6f72 636f 6e74 6578 745d 2c0a 2020  aforcontext],.  
-00015770: 2020 2020 2020 2020 2020 2020 2020 5b73                [s
-00015780: 7472 2865 2e73 6f75 7263 6529 2066 6f72  tr(e.source) for
-00015790: 2065 2069 6e20 6461 7461 666f 7263 6f6e   e in dataforcon
-000157a0: 7465 7874 5d2c 0a20 2020 2020 2020 2020  text],.         
-000157b0: 2020 2020 2020 205b 652e 6465 7461 696c         [e.detail
-000157c0: 7320 666f 7220 6520 696e 2064 6174 6166  s for e in dataf
-000157d0: 6f72 636f 6e74 6578 745d 2c0a 2020 2020  orcontext],.    
-000157e0: 2020 2020 2020 2020 2020 2020 5b65 2e74              [e.t
-000157f0: 7970 6520 666f 7220 6520 696e 2064 6174  ype for e in dat
-00015800: 6166 6f72 636f 6e74 6578 745d 5d0a 0a20  aforcontext]].. 
-00015810: 2020 206e 7063 6f6e 7465 7874 203d 206e     npcontext = n
-00015820: 702e 6172 7261 7928 6461 7461 746f 6466  p.array(datatodf
-00015830: 290a 2020 2020 6e70 636f 6e74 6578 7420  ).    npcontext 
-00015840: 3d20 6e70 636f 6e74 6578 742e 540a 0a20  = npcontext.T.. 
-00015850: 2020 206e 7063 6f6e 7465 7874 203d 2073     npcontext = s
-00015860: 656c 662e 4e75 6d70 795f 7072 6570 726f  elf.Numpy_prepro
-00015870: 6363 6573 7328 6e70 636f 6e74 6578 7429  ccess(npcontext)
-00015880: 0a0a 2020 2020 2320 656e 6420 3d20 7469  ..    # end = ti
-00015890: 6d65 2e74 696d 6528 290a 2020 2020 2320  me.time().    # 
-000158a0: 7072 696e 7428 6626 2333 343b 7072 6570  print(f&#34;prep
-000158b0: 726f 6365 7373 2064 663a 207b 656e 6420  rocess df: {end 
-000158c0: 2d20 7374 6172 747d 2623 3334 3b29 0a20  - start}&#34;). 
-000158d0: 2020 2023 2323 2323 2323 2323 2323 2323     #############
-000158e0: 2063 7265 6174 6520 636f 6e74 6578 7420   create context 
-000158f0: 2323 2323 2323 2323 2323 2323 2323 2323  ################
-00015900: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
-00015910: 2023 2073 7461 7274 203d 2074 696d 652e   # start = time.
-00015920: 7469 6d65 2829 0a20 2020 2023 2320 636f  time().    ## co
-00015930: 6c6c 6563 7420 756e 6971 6575 2064 6174  llect uniqeu dat
-00015940: 6120 7365 7269 6573 0a20 2020 2023 2061  a series.    # a
-00015950: 6c6c 636f 6465 7320 3d20 6466 5b26 2333  llcodes = df[&#3
-00015960: 393b 636f 6465 2623 3339 3b5d 2e75 6e69  9;code&#39;].uni
-00015970: 7175 6528 290a 2020 2020 616c 6c63 6f64  que().    allcod
-00015980: 6573 203d 206e 702e 756e 6971 7565 286e  es = np.unique(n
-00015990: 7063 6f6e 7465 7874 5b3a 2c20 315d 290a  pcontext[:, 1]).
-000159a0: 2020 2020 616c 6c63 6f64 6573 203d 205b      allcodes = [
-000159b0: 636f 6465 2066 6f72 2063 6f64 6520 696e  code for code in
-000159c0: 2061 6c6c 636f 6465 735d 0a20 2020 2061   allcodes].    a
-000159d0: 6c6c 636f 6465 7320 3d20 7365 7428 616c  llcodes = set(al
-000159e0: 6c63 6f64 6573 290a 0a20 2020 2066 6f72  lcodes)..    for
-000159f0: 2075 6e63 6f64 6520 696e 2061 6c6c 636f   uncode in allco
-00015a00: 6465 733a 0a20 2020 2020 2020 2066 6f72  des:.        for
-00015a10: 2071 7120 696e 2072 616e 6765 286c 656e   qq in range(len
-00015a20: 286e 7063 6f6e 7465 7874 2929 3a0a 2020  (npcontext)):.  
-00015a30: 2020 2020 2020 2020 2020 6966 2075 6e63            if unc
-00015a40: 6f64 6520 696e 206e 7063 6f6e 7465 7874  ode in npcontext
-00015a50: 5b71 715d 5b31 5d3a 0a20 2020 2020 2020  [qq][1]:.       
-00015a60: 2020 2020 2020 2020 2073 656c 662e 7479           self.ty
-00015a70: 7065 5f6f 665f 7365 7269 6573 5b75 6e63  pe_of_series[unc
-00015a80: 6f64 655d 203d 206e 7063 6f6e 7465 7874  ode] = npcontext
-00015a90: 5b71 715d 5b34 5d0a 2020 2020 2020 2020  [qq][4].        
-00015aa0: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
-00015ab0: 2020 2023 2320 6275 696c 6420 7461 7267     ## build targ
-00015ac0: 6574 2073 6572 6965 730a 2020 2020 7461  et series.    ta
-00015ad0: 7267 6574 5f73 6572 6965 735f 6e61 6d65  rget_series_name
-00015ae0: 2c20 7461 7267 6574 5f73 6572 6965 7320  , target_series 
-00015af0: 3d20 7365 6c66 2e62 7569 6c64 5f74 6172  = self.build_tar
-00015b00: 6765 745f 7365 7269 6573 5f66 6f72 5f63  get_series_for_c
-00015b10: 6f6e 7465 7874 2863 7572 7265 6e74 2c20  ontext(current, 
-00015b20: 6e70 636f 6e74 6578 7429 0a0a 2020 2020  npcontext)..    
-00015b30: 2323 2063 7265 6174 6520 7365 7269 6573  ## create series
-00015b40: 2066 6f72 2065 6163 6820 736f 7572 6365   for each source
-00015b50: 2028 616c 6c64 6174 6129 0a20 2020 2061   (alldata).    a
-00015b60: 6c6c 6461 7461 203d 2073 656c 662e 6372  lldata = self.cr
-00015b70: 6561 7465 5f63 6f6e 7469 6e75 6f75 735f  eate_continuous_
-00015b80: 7265 7072 6573 656e 7461 7469 6f6e 2874  representation(t
-00015b90: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
-00015ba0: 652c 2074 6172 6765 745f 7365 7269 6573  e, target_series
-00015bb0: 2c20 6e70 636f 6e74 6578 742c 0a20 2020  , npcontext,.   
-00015bc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015bf0: 2073 656c 662e 7479 7065 5f6f 665f 7365   self.type_of_se
-00015c00: 7269 6573 2c20 616c 6c63 6f64 6573 290a  ries, allcodes).
-00015c10: 2020 2020 2320 656e 6420 3d20 7469 6d65      # end = time
-00015c20: 2e74 696d 6528 290a 2020 2020 2320 7072  .time().    # pr
-00015c30: 696e 7428 6626 2333 343b 4372 6561 7465  int(f&#34;Create
-00015c40: 2073 6572 6965 733a 207b 656e 642d 7374   series: {end-st
-00015c50: 6172 747d 2623 3334 3b29 0a0a 2020 2020  art}&#34;)..    
-00015c60: 7374 6f72 696e 6720 3d20 7365 6c66 2e63  storing = self.c
-00015c70: 616c 6375 6c61 7465 5f65 6467 6573 2861  alculate_edges(a
-00015c80: 6c6c 6461 7461 2c20 6375 7272 656e 742e  lldata, current.
-00015c90: 7469 6d65 7374 616d 7029 0a20 2020 2073  timestamp).    s
-00015ca0: 746f 7269 6e67 5b26 2333 343b 6368 6172  toring[&#34;char
-00015cb0: 6163 7465 7269 7a61 7469 6f6e 2623 3334  acterization&#34
-00015cc0: 3b5d 203d 2073 656c 662e 6765 745f 6368  ;] = self.get_ch
-00015cd0: 6172 6163 7465 7269 7a61 7469 6f6e 2873  aracterization(s
-00015ce0: 746f 7269 6e67 290a 0a20 2020 2023 2070  toring)..    # p
-00015cf0: 7269 6e74 2866 2623 3334 3b43 616c 6375  rint(f&#34;Calcu
-00015d00: 6c61 7465 2065 6467 6573 3a20 7b65 6e64  late edges: {end
-00015d10: 202d 2073 7461 7274 7d26 2333 343b 290a   - start}&#34;).
-00015d20: 2020 2020 2320 7072 696e 7428 2623 3334      # print(&#34
-00015d30: 3b3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ;===============
-00015d40: 3d3d 3d3d 3d3d 3d3d 3d26 2333 343b 290a  =========&#34;).
-00015d50: 0a20 2020 2063 6f6e 7465 7874 7062 6a65  .    contextpbje
-00015d60: 6374 203d 2043 6f6e 7465 7874 2e63 6f6e  ct = Context.con
-00015d70: 7465 7874 5f66 726f 6d5f 6469 6374 2873  text_from_dict(s
-00015d80: 746f 7269 6e67 290a 2020 2020 7265 7475  toring).    retu
-00015d90: 726e 2063 6f6e 7465 7874 7062 6a65 6374  rn contextpbject
-00015da0: 2c20 7461 7267 6574 5f73 6572 6965 735f  , target_series_
-00015db0: 6e61 6d65 3c2f 636f 6465 3e3c 2f70 7265  name</code></pre
-00015dc0: 3e0a 3c2f 6465 7461 696c 733e 0a3c 2f64  >.</details>.</d
-00015dd0: 643e 0a3c 6474 2069 643d 2250 646d 436f  d>.<dt id="PdmCo
-00015de0: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
-00015df0: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
-00015e00: 656e 6572 6174 6f72 2e63 7265 6174 655f  enerator.create_
-00015e10: 636f 6e74 696e 756f 7573 5f72 6570 7265  continuous_repre
-00015e20: 7365 6e74 6174 696f 6e22 3e3c 636f 6465  sentation"><code
-00015e30: 2063 6c61 7373 3d22 6e61 6d65 2066 6c65   class="name fle
-00015e40: 7822 3e0a 3c73 7061 6e3e 6465 6620 3c73  x">.<span>def <s
-00015e50: 7061 6e20 636c 6173 733d 2269 6465 6e74  pan class="ident
-00015e60: 223e 6372 6561 7465 5f63 6f6e 7469 6e75  ">create_continu
-00015e70: 6f75 735f 7265 7072 6573 656e 7461 7469  ous_representati
-00015e80: 6f6e 3c2f 7370 616e 3e3c 2f73 7061 6e3e  on</span></span>
-00015e90: 283c 7370 616e 3e73 656c 662c 2074 6172  (<span>self, tar
-00015ea0: 6765 745f 7365 7269 6573 5f6e 616d 652c  get_series_name,
-00015eb0: 2074 6172 6765 745f 7365 7269 6573 2c20   target_series, 
-00015ec0: 6466 2c20 7479 7065 5f6f 665f 7365 7269  df, type_of_seri
-00015ed0: 6573 2c20 616c 6c63 6f64 6573 293c 2f73  es, allcodes)</s
-00015ee0: 7061 6e3e 0a3c 2f63 6f64 653e 3c2f 6474  pan>.</code></dt
-00015ef0: 3e0a 3c64 643e 0a3c 6469 7620 636c 6173  >.<dd>.<div clas
-00015f00: 733d 2264 6573 6322 3e3c 2f64 6976 3e0a  s="desc"></div>.
-00015f10: 3c64 6574 6169 6c73 2063 6c61 7373 3d22  <details class="
-00015f20: 736f 7572 6365 223e 0a3c 7375 6d6d 6172  source">.<summar
-00015f30: 793e 0a3c 7370 616e 3e45 7870 616e 6420  y>.<span>Expand 
-00015f40: 736f 7572 6365 2063 6f64 653c 2f73 7061  source code</spa
-00015f50: 6e3e 0a3c 2f73 756d 6d61 7279 3e0a 3c70  n>.</summary>.<p
-00015f60: 7265 3e3c 636f 6465 2063 6c61 7373 3d22  re><code class="
-00015f70: 7079 7468 6f6e 223e 6465 6620 6372 6561  python">def crea
-00015f80: 7465 5f63 6f6e 7469 6e75 6f75 735f 7265  te_continuous_re
-00015f90: 7072 6573 656e 7461 7469 6f6e 2873 656c  presentation(sel
-00015fa0: 662c 2074 6172 6765 745f 7365 7269 6573  f, target_series
-00015fb0: 5f6e 616d 652c 2074 6172 6765 745f 7365  _name, target_se
-00015fc0: 7269 6573 2c20 6466 2c20 7479 7065 5f6f  ries, df, type_o
-00015fd0: 665f 7365 7269 6573 2c20 616c 6c63 6f64  f_series, allcod
-00015fe0: 6573 293a 0a20 2020 2023 2069 6620 6c65  es):.    # if le
-00015ff0: 6e28 7461 7267 6574 5f73 6572 6965 7329  n(target_series)
-00016000: 2026 6c74 3b20 353a 0a20 2020 2023 2020   &lt; 5:.    #  
-00016010: 2020 2061 6c6c 6461 7461 203d 205b 5d0a     alldata = [].
-00016020: 2020 2020 2320 2020 2020 7061 6464 696e      #     paddin
-00016030: 673d 5b30 2066 6f72 2071 2069 6e20 7261  g=[0 for q in ra
-00016040: 6e67 6528 352d 6c65 6e28 7461 7267 6574  nge(5-len(target
-00016050: 5f73 6572 6965 7329 295d 0a20 2020 2023  _series))].    #
-00016060: 2020 2020 2070 6164 6469 6e67 2e65 7874       padding.ext
-00016070: 656e 6428 5b74 6167 735b 305d 2066 6f72  end([tags[0] for
-00016080: 2074 6167 7320 696e 2074 6172 6765 745f   tags in target_
-00016090: 7365 7269 6573 5d29 0a20 2020 2023 2020  series]).    #  
-000160a0: 2020 2061 6c6c 6461 7461 2e61 7070 656e     alldata.appen
-000160b0: 6428 2874 6172 6765 745f 7365 7269 6573  d((target_series
-000160c0: 5f6e 616d 652c 2070 6164 6469 6e67 2929  _name, padding))
-000160d0: 0a20 2020 2023 2020 2020 2072 6574 7572  .    #     retur
-000160e0: 6e20 616c 6c64 6174 610a 2020 2020 7769  n alldata.    wi
-000160f0: 6e64 6f77 7661 6c75 6573 203d 2064 6620  ndowvalues = df 
-00016100: 2023 202e 7661 6c75 6573 0a20 2020 2061   # .values.    a
-00016110: 6c6c 6461 7461 203d 205b 5d0a 2020 2020  lldata = [].    
-00016120: 616c 6c64 6174 612e 6170 7065 6e64 2828  alldata.append((
-00016130: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
-00016140: 6d65 2c20 5b74 6167 5b30 5d20 666f 7220  me, [tag[0] for 
-00016150: 7461 6720 696e 2074 6172 6765 745f 7365  tag in target_se
-00016160: 7269 6573 5d29 290a 2020 2020 666f 7220  ries])).    for 
-00016170: 6e61 6d65 2069 6e20 616c 6c63 6f64 6573  name in allcodes
-00016180: 3a0a 2020 2020 2020 2020 2320 616c 7265  :.        # alre
-00016190: 6164 7920 6361 6c63 756c 6174 6564 2069  ady calculated i
-000161a0: 6e20 7461 7267 6574 7365 7269 6573 2e0a  n targetseries..
-000161b0: 2020 2020 2020 2020 6966 2074 6172 6765          if targe
-000161c0: 745f 7365 7269 6573 5f6e 616d 6520 696e  t_series_name in
-000161d0: 206e 616d 653a 0a20 2020 2020 2020 2020   name:.         
-000161e0: 2020 2063 6f6e 7469 6e75 650a 0a20 2020     continue..   
-000161f0: 2020 2020 2023 2064 6574 6563 7420 7468       # detect th
-00016200: 6520 6f63 6375 7261 6e63 6965 730a 2020  e occurancies.  
-00016210: 2020 2020 2020 6f63 6375 7265 6e63 6965        occurencie
-00016220: 7320 3d20 5b28 7661 6c75 652c 2074 696d  s = [(value, tim
-00016230: 6529 2066 6f72 2063 6f64 652c 2076 616c  e) for code, val
-00016240: 7565 2c20 7469 6d65 2069 6e0a 2020 2020  ue, time in.    
-00016250: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016260: 2020 207a 6970 2877 696e 646f 7776 616c     zip(windowval
-00016270: 7565 735b 3a2c 2031 5d2c 2077 696e 646f  ues[:, 1], windo
-00016280: 7776 616c 7565 735b 3a2c 2033 5d2c 2077  wvalues[:, 3], w
-00016290: 696e 646f 7776 616c 7565 735b 3a2c 2030  indowvalues[:, 0
-000162a0: 5d29 2069 6620 6e61 6d65 2069 6e20 636f  ]) if name in co
-000162b0: 6465 5d0a 0a20 2020 2020 2020 2076 6563  de]..        vec
-000162c0: 746f 7220 3d20 5b30 2066 6f72 2069 2069  tor = [0 for i i
-000162d0: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
-000162e0: 6574 5f73 6572 6965 7329 295d 0a20 2020  et_series))].   
-000162f0: 2020 2020 2069 6620 6c65 6e28 6f63 6375       if len(occu
-00016300: 7265 6e63 6965 7329 203d 3d20 303a 0a20  rencies) == 0:. 
-00016310: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
-00016320: 7220 3d20 5b30 2066 6f72 2069 2069 6e20  r = [0 for i in 
-00016330: 7261 6e67 6528 6c65 6e28 7461 7267 6574  range(len(target
-00016340: 5f73 6572 6965 7329 295d 0a20 2020 2020  _series))].     
-00016350: 2020 2065 6c69 6620 6f63 6375 7265 6e63     elif occurenc
-00016360: 6965 735b 305d 5b30 5d20 6973 206e 6f74  ies[0][0] is not
-00016370: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00016380: 2020 2076 6563 746f 7220 3d20 7365 6c66     vector = self
-00016390: 2e62 7569 6c64 5f63 6f6e 7465 7874 5f66  .build_context_f
-000163a0: 6f72 5f75 6e69 7661 7269 6174 6528 7461  or_univariate(ta
-000163b0: 7267 6574 5f73 6572 6965 732c 206f 6363  rget_series, occ
-000163c0: 7572 656e 6369 6573 290a 2020 2020 2020  urencies).      
-000163d0: 2020 656c 6966 2074 7970 655f 6f66 5f73    elif type_of_s
-000163e0: 6572 6965 735b 6e61 6d65 5d20 3d3d 2026  eries[name] == &
-000163f0: 2333 343b 6973 6f6c 6174 6564 2623 3334  #34;isolated&#34
-00016400: 3b3a 0a20 2020 2020 2020 2020 2020 2076  ;:.            v
-00016410: 6563 746f 7220 3d20 7365 6c66 2e62 7569  ector = self.bui
-00016420: 6c64 5f63 6f6e 7465 7874 5f66 6f72 5f69  ld_context_for_i
-00016430: 736f 6c61 7465 6428 7461 7267 6574 5f73  solated(target_s
-00016440: 6572 6965 732c 206f 6363 7572 656e 6369  eries, occurenci
-00016450: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
-00016460: 2074 7970 655f 6f66 5f73 6572 6965 735b   type_of_series[
-00016470: 6e61 6d65 5d20 3d3d 2026 2333 343b 636f  name] == &#34;co
-00016480: 6e66 6967 7572 6174 696f 6e26 2333 343b  nfiguration&#34;
-00016490: 3a0a 2020 2020 2020 2020 2020 2020 7665  :.            ve
-000164a0: 6374 6f72 203d 2073 656c 662e 6275 696c  ctor = self.buil
-000164b0: 645f 636f 6e74 6578 745f 666f 725f 636f  d_context_for_co
-000164c0: 6e66 6975 6775 7261 7469 6f6e 2874 6172  nfiuguration(tar
-000164d0: 6765 745f 7365 7269 6573 2c20 6f63 6375  get_series, occu
-000164e0: 7265 6e63 6965 7329 0a0a 2020 2020 2020  rencies)..      
-000164f0: 2020 6f6b 203d 2026 2333 343b 6f6b 2623    ok = &#34;ok&#
-00016500: 3334 3b0a 2020 2020 2020 2020 2320 6966  34;.        # if
-00016510: 2076 6563 746f 7220 6973 2073 7461 7469   vector is stati
-00016520: 6f6e 6172 7920 7468 656e 206e 6f20 636f  onary then no co
-00016530: 6e74 6578 742e 0a20 2020 2020 2020 2069  ntext..        i
-00016540: 6620 6d61 7828 7665 6374 6f72 2920 3d3d  f max(vector) ==
-00016550: 2030 2061 6e64 206d 696e 2876 6563 746f   0 and min(vecto
-00016560: 7229 203d 3d20 303a 0a20 2020 2020 2020  r) == 0:.       
-00016570: 2020 2020 2076 6563 746f 7220 3d20 4e6f       vector = No
-00016580: 6e65 0a20 2020 2020 2020 2061 6c6c 6461  ne.        allda
-00016590: 7461 2e61 7070 656e 6428 286e 616d 652c  ta.append((name,
-000165a0: 2076 6563 746f 7229 290a 2020 2020 7265   vector)).    re
-000165b0: 7475 726e 2061 6c6c 6461 7461 3c2f 636f  turn alldata</co
-000165c0: 6465 3e3c 2f70 7265 3e0a 3c2f 6465 7461  de></pre>.</deta
-000165d0: 696c 733e 0a3c 2f64 643e 0a3c 6474 2069  ils>.</dd>.<dt i
-000165e0: 643d 2250 646d 436f 6e74 6578 742e 436f  d="PdmContext.Co
-000165f0: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
-00016600: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
-00016610: 2e63 7265 6174 655f 696e 7465 7270 7265  .create_interpre
-00016620: 7461 7469 6f6e 223e 3c63 6f64 6520 636c  tation"><code cl
-00016630: 6173 733d 226e 616d 6520 666c 6578 223e  ass="name flex">
-00016640: 0a3c 7370 616e 3e64 6566 203c 7370 616e  .<span>def <span
-00016650: 2063 6c61 7373 3d22 6964 656e 7422 3e63   class="ident">c
-00016660: 7265 6174 655f 696e 7465 7270 7265 7461  reate_interpreta
-00016670: 7469 6f6e 3c2f 7370 616e 3e3c 2f73 7061  tion</span></spa
-00016680: 6e3e 283c 7370 616e 3e73 656c 662c 2063  n>(<span>self, c
-00016690: 6f6e 7465 7874 6375 7272 656e 743a c2a0  ontextcurrent:..
-000166a0: 3c61 2074 6974 6c65 3d22 5064 6d43 6f6e  <a title="PdmCon
-000166b0: 7465 7874 2e75 7469 6c73 2e73 7472 7563  text.utils.struc
-000166c0: 7475 7265 2e43 6f6e 7465 7874 2220 6872  ture.Context" hr
-000166d0: 6566 3d22 7574 696c 732f 7374 7275 6374  ef="utils/struct
-000166e0: 7572 652e 6874 6d6c 2350 646d 436f 6e74  ure.html#PdmCont
-000166f0: 6578 742e 7574 696c 732e 7374 7275 6374  ext.utils.struct
-00016700: 7572 652e 436f 6e74 6578 7422 3e43 6f6e  ure.Context">Con
-00016710: 7465 7874 3c2f 613e 2c20 7461 7267 6574  text</a>, target
-00016720: 5f73 6572 6965 735f 6e61 6d65 293c 2f73  _series_name)</s
-00016730: 7061 6e3e 0a3c 2f63 6f64 653e 3c2f 6474  pan>.</code></dt
-00016740: 3e0a 3c64 643e 0a3c 6469 7620 636c 6173  >.<dd>.<div clas
-00016750: 733d 2264 6573 6322 3e3c 703e 5468 6973  s="desc"><p>This
-00016760: 206d 6574 686f 6420 636f 6c6c 6563 7420   method collect 
-00016770: 616c 6c20 7468 6520 636f 6e74 6578 7473  all the contexts
-00016780: 2069 6e20 7468 6520 686f 7269 7a6f 6e20   in the horizon 
-00016790: 616e 6420 6361 6c6c 7320 7468 6520 696e  and calls the in
-000167a0: 7465 7270 7265 7461 7469 6f6e 206d 6574  terpretation met
-000167b0: 686f 642e 3c2f 703e 0a3c 703e 3c73 7472  hod.</p>.<p><str
-000167c0: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
-000167d0: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
-000167e0: 3c73 7472 6f6e 673e 636f 6e74 6578 7463  <strong>contextc
-000167f0: 7572 7265 6e74 3c2f 7374 726f 6e67 3e3a  urrent</strong>:
-00016800: 2054 6865 2043 6f6e 7465 7874 2066 6f72   The Context for
-00016810: 2077 6869 6368 2074 6865 2069 6e74 6572   which the inter
-00016820: 7072 6574 6174 696f 6e20 6973 2063 616c  pretation is cal
-00016830: 6375 6c61 7465 643c 2f70 3e0a 3c70 3e3c  culated</p>.<p><
-00016840: 7374 726f 6e67 3e74 6172 6765 745f 7365  strong>target_se
-00016850: 7269 6573 5f6e 616d 653c 2f73 7472 6f6e  ries_name</stron
-00016860: 673e 3a20 5468 656e 206e 616d 6520 6f66  g>: Then name of
-00016870: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
-00016880: 6162 6c65 3c2f 703e 3c2f 6469 763e 0a3c  able</p></div>.<
-00016890: 6465 7461 696c 7320 636c 6173 733d 2273  details class="s
-000168a0: 6f75 7263 6522 3e0a 3c73 756d 6d61 7279  ource">.<summary
-000168b0: 3e0a 3c73 7061 6e3e 4578 7061 6e64 2073  >.<span>Expand s
-000168c0: 6f75 7263 6520 636f 6465 3c2f 7370 616e  ource code</span
-000168d0: 3e0a 3c2f 7375 6d6d 6172 793e 0a3c 7072  >.</summary>.<pr
-000168e0: 653e 3c63 6f64 6520 636c 6173 733d 2270  e><code class="p
-000168f0: 7974 686f 6e22 3e64 6566 2063 7265 6174  ython">def creat
-00016900: 655f 696e 7465 7270 7265 7461 7469 6f6e  e_interpretation
-00016910: 2873 656c 662c 2063 6f6e 7465 7874 6375  (self, contextcu
-00016920: 7272 656e 743a 2043 6f6e 7465 7874 2c20  rrent: Context, 
-00016930: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
-00016940: 6d65 293a 0a20 2020 2026 2333 343b 2623  me):.    &#34;&#
-00016950: 3334 3b26 2333 343b 0a20 2020 2054 6869  34;&#34;.    Thi
-00016960: 7320 6d65 7468 6f64 2063 6f6c 6c65 6374  s method collect
-00016970: 2061 6c6c 2074 6865 2063 6f6e 7465 7874   all the context
-00016980: 7320 696e 2074 6865 2068 6f72 697a 6f6e  s in the horizon
-00016990: 2061 6e64 2063 616c 6c73 2074 6865 2069   and calls the i
-000169a0: 6e74 6572 7072 6574 6174 696f 6e20 6d65  nterpretation me
-000169b0: 7468 6f64 2e0a 0a20 2020 202a 2a50 6172  thod...    **Par
-000169c0: 616d 6574 6572 732a 2a3a 0a0a 2020 2020  ameters**:..    
-000169d0: 2a2a 636f 6e74 6578 7463 7572 7265 6e74  **contextcurrent
-000169e0: 2a2a 3a20 5468 6520 436f 6e74 6578 7420  **: The Context 
-000169f0: 666f 7220 7768 6963 6820 7468 6520 696e  for which the in
-00016a00: 7465 7270 7265 7461 7469 6f6e 2069 7320  terpretation is 
-00016a10: 6361 6c63 756c 6174 6564 0a0a 2020 2020  calculated..    
-00016a20: 2a2a 7461 7267 6574 5f73 6572 6965 735f  **target_series_
-00016a30: 6e61 6d65 2a2a 3a20 5468 656e 206e 616d  name**: Then nam
-00016a40: 6520 6f66 2074 6865 2074 6172 6765 7420  e of the target 
-00016a50: 7661 7269 6162 6c65 0a20 2020 2026 2333  variable.    &#3
-00016a60: 343b 2623 3334 3b26 2333 343b 0a0a 2020  4;&#34;&#34;..  
-00016a70: 2020 7269 6b69 636f 6e74 6578 7420 3d20    rikicontext = 
-00016a80: 7365 6c66 2e63 6f6e 7465 7874 730a 2020  self.contexts.  
-00016a90: 2020 706f 7320 3d20 7365 6c66 2e69 6e74    pos = self.int
-00016aa0: 6572 7072 6574 5f68 6973 746f 7279 5f70  erpret_history_p
-00016ab0: 6f73 0a20 2020 2074 656d 7070 6f73 203d  os.    temppos =
-00016ac0: 2070 6f73 0a20 2020 2066 6f72 2071 2069   pos.    for q i
-00016ad0: 6e20 7261 6e67 6528 706f 732c 206c 656e  n range(pos, len
-00016ae0: 2872 696b 6963 6f6e 7465 7874 2929 3a0a  (rikicontext)):.
-00016af0: 2020 2020 2020 2020 7465 6d70 706f 7320          temppos 
-00016b00: 3d20 710a 2020 2020 2020 2020 6966 2070  = q.        if p
-00016b10: 642e 746f 5f64 6174 6574 696d 6528 7269  d.to_datetime(ri
-00016b20: 6b69 636f 6e74 6578 745b 715d 2e74 696d  kicontext[q].tim
-00016b30: 6573 7461 6d70 2920 2667 743b 3d20 280a  estamp) &gt;= (.
-00016b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016b50: 7064 2e74 6f5f 6461 7465 7469 6d65 2863  pd.to_datetime(c
-00016b60: 6f6e 7465 7874 6375 7272 656e 742e 7469  ontextcurrent.ti
-00016b70: 6d65 7374 616d 7029 202d 2070 642e 5469  mestamp) - pd.Ti
-00016b80: 6d65 6465 6c74 6128 7365 6c66 2e68 6f72  medelta(self.hor
-00016b90: 697a 6f6e 2c20 7365 6c66 2e68 6f72 697a  izon, self.horiz
-00016ba0: 6f6e 5f74 696d 6529 293a 0a20 2020 2020  on_time)):.     
-00016bb0: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
-00016bc0: 2063 6175 7365 7377 696e 646f 7720 3d20   causeswindow = 
-00016bd0: 7269 6b69 636f 6e74 6578 745b 7465 6d70  rikicontext[temp
-00016be0: 706f 733a 5d0a 2020 2020 7365 6c66 2e69  pos:].    self.i
-00016bf0: 6e74 6572 7072 6574 5f68 6973 746f 7279  nterpret_history
-00016c00: 5f70 6f73 203d 2074 656d 7070 6f73 0a20  _pos = temppos. 
-00016c10: 2020 2069 6e74 6572 7072 203d 2073 656c     interpr = sel
-00016c20: 662e 696e 7465 7270 7265 7428 636f 6e74  f.interpret(cont
-00016c30: 6578 7463 7572 7265 6e74 2c20 6361 7573  extcurrent, caus
-00016c40: 6573 7769 6e64 6f77 2c20 7461 7267 6574  eswindow, target
-00016c50: 5f73 6572 6965 735f 6e61 6d65 2c20 7365  _series_name, se
-00016c60: 6c66 2e74 7970 655f 6f66 5f73 6572 6965  lf.type_of_serie
-00016c70: 7329 0a20 2020 2073 656c 662e 636f 6e74  s).    self.cont
-00016c80: 6578 7473 5b2d 315d 2e43 525b 2623 3334  exts[-1].CR[&#34
-00016c90: 3b69 6e74 6572 7072 6574 6174 696f 6e26  ;interpretation&
-00016ca0: 2333 343b 5d20 3d20 696e 7465 7270 723c  #34;] = interpr<
-00016cb0: 2f63 6f64 653e 3c2f 7072 653e 0a3c 2f64  /code></pre>.</d
-00016cc0: 6574 6169 6c73 3e0a 3c2f 6464 3e0a 3c64  etails>.</dd>.<d
-00016cd0: 7420 6964 3d22 5064 6d43 6f6e 7465 7874  t id="PdmContext
-00016ce0: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
-00016cf0: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
-00016d00: 746f 722e 6765 6e65 7261 7465 5f63 6f6e  tor.generate_con
-00016d10: 7465 7874 223e 3c63 6f64 6520 636c 6173  text"><code clas
-00016d20: 733d 226e 616d 6520 666c 6578 223e 0a3c  s="name flex">.<
-00016d30: 7370 616e 3e64 6566 203c 7370 616e 2063  span>def <span c
-00016d40: 6c61 7373 3d22 6964 656e 7422 3e67 656e  lass="ident">gen
-00016d50: 6572 6174 655f 636f 6e74 6578 743c 2f73  erate_context</s
-00016d60: 7061 6e3e 3c2f 7370 616e 3e28 3c73 7061  pan></span>(<spa
-00016d70: 6e3e 7365 6c66 2c20 653a c2a0 3c61 2074  n>self, e:..<a t
-00016d80: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
-00016d90: 2e75 7469 6c73 2e73 7472 7563 7475 7265  .utils.structure
-00016da0: 2e45 7665 6e74 706f 696e 7422 2068 7265  .Eventpoint" hre
-00016db0: 663d 2275 7469 6c73 2f73 7472 7563 7475  f="utils/structu
-00016dc0: 7265 2e68 746d 6c23 5064 6d43 6f6e 7465  re.html#PdmConte
-00016dd0: 7874 2e75 7469 6c73 2e73 7472 7563 7475  xt.utils.structu
-00016de0: 7265 2e45 7665 6e74 706f 696e 7422 3e45  re.Eventpoint">E
-00016df0: 7665 6e74 706f 696e 743c 2f61 3e2c 2062  ventpoint</a>, b
-00016e00: 7566 6665 7229 3c2f 7370 616e 3e0a 3c2f  uffer)</span>.</
-00016e10: 636f 6465 3e3c 2f64 743e 0a3c 6464 3e0a  code></dt>.<dd>.
-00016e20: 3c64 6976 2063 6c61 7373 3d22 6465 7363  <div class="desc
-00016e30: 223e 3c70 3e47 656e 6572 6174 6520 636f  "><p>Generate co
-00016e40: 6e74 6578 7420 616e 6420 696e 7465 7270  ntext and interp
-00016e50: 7265 7461 7469 6f6e 2e3c 2f70 3e0a 3c70  retation.</p>.<p
-00016e60: 3e3c 7374 726f 6e67 3e50 6172 616d 6574  ><strong>Paramet
-00016e70: 6572 733c 2f73 7472 6f6e 673e 3a3c 2f70  ers</strong>:</p
-00016e80: 3e0a 3c70 3e3c 7374 726f 6e67 3e65 3c2f  >.<p><strong>e</
-00016e90: 7374 726f 6e67 3e3a 2045 7665 6e74 706f  strong>: Eventpo
-00016ea0: 696e 7420 7265 6c61 7465 6420 746f 2074  int related to t
-00016eb0: 6865 206c 6173 7420 7461 7267 6574 2773  he last target's
-00016ec0: 2064 6174 612e 3c2f 703e 0a3c 703e 3c73   data.</p>.<p><s
-00016ed0: 7472 6f6e 673e 6275 6666 6572 3c2f 7374  trong>buffer</st
-00016ee0: 726f 6e67 3e3a 2041 206c 6973 7420 7769  rong>: A list wi
-00016ef0: 7468 2061 6c6c 2045 7665 6e74 706f 696e  th all Eventpoin
-00016f00: 7473 2069 6e20 7468 6520 7469 6d65 2068  ts in the time h
-00016f10: 6f72 697a 6f6e 3c2f 703e 3c2f 6469 763e  orizon</p></div>
-00016f20: 0a3c 6465 7461 696c 7320 636c 6173 733d  .<details class=
-00016f30: 2273 6f75 7263 6522 3e0a 3c73 756d 6d61  "source">.<summa
-00016f40: 7279 3e0a 3c73 7061 6e3e 4578 7061 6e64  ry>.<span>Expand
-00016f50: 2073 6f75 7263 6520 636f 6465 3c2f 7370   source code</sp
-00016f60: 616e 3e0a 3c2f 7375 6d6d 6172 793e 0a3c  an>.</summary>.<
-00016f70: 7072 653e 3c63 6f64 6520 636c 6173 733d  pre><code class=
-00016f80: 2270 7974 686f 6e22 3e64 6566 2067 656e  "python">def gen
-00016f90: 6572 6174 655f 636f 6e74 6578 7428 7365  erate_context(se
-00016fa0: 6c66 2c20 653a 2045 7665 6e74 706f 696e  lf, e: Eventpoin
-00016fb0: 742c 2062 7566 6665 7229 3a0a 2020 2020  t, buffer):.    
-00016fc0: 2623 3334 3b26 2333 343b 2623 3334 3b0a  &#34;&#34;&#34;.
-00016fd0: 2020 2020 4765 6e65 7261 7465 2063 6f6e      Generate con
-00016fe0: 7465 7874 2061 6e64 2069 6e74 6572 7072  text and interpr
-00016ff0: 6574 6174 696f 6e2e 0a0a 2020 2020 2a2a  etation...    **
-00017000: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
-00017010: 2020 202a 2a65 2a2a 3a20 4576 656e 7470     **e**: Eventp
-00017020: 6f69 6e74 2072 656c 6174 6564 2074 6f20  oint related to 
-00017030: 7468 6520 6c61 7374 2074 6172 6765 7426  the last target&
-00017040: 2333 393b 7320 6461 7461 2e0a 0a20 2020  #39;s data...   
-00017050: 202a 2a62 7566 6665 722a 2a3a 2041 206c   **buffer**: A l
-00017060: 6973 7420 7769 7468 2061 6c6c 2045 7665  ist with all Eve
-00017070: 6e74 706f 696e 7473 2069 6e20 7468 6520  ntpoints in the 
-00017080: 7469 6d65 2068 6f72 697a 6f6e 0a20 2020  time horizon.   
-00017090: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
-000170a0: 0a0a 2020 2020 636f 6e74 6578 7463 7572  ..    contextcur
-000170b0: 7265 6e74 2c20 7461 7267 6574 5f73 6572  rent, target_ser
-000170c0: 6965 735f 6e61 6d65 203d 2073 656c 662e  ies_name = self.
-000170d0: 6372 6561 7465 5f63 6f6e 7465 7874 2865  create_context(e
-000170e0: 2c20 6275 6666 6572 290a 0a20 2020 2073  , buffer)..    s
-000170f0: 656c 662e 636f 6e74 6578 7473 2e61 7070  elf.contexts.app
-00017100: 656e 6428 636f 6e74 6578 7463 7572 7265  end(contextcurre
-00017110: 6e74 290a 2020 2020 7365 6c66 2e63 7265  nt).    self.cre
-00017120: 6174 655f 696e 7465 7270 7265 7461 7469  ate_interpretati
-00017130: 6f6e 2863 6f6e 7465 7874 6375 7272 656e  on(contextcurren
-00017140: 742c 2074 6172 6765 745f 7365 7269 6573  t, target_series
-00017150: 5f6e 616d 6529 0a0a 2020 2020 696e 7465  _name)..    inte
-00017160: 7274 7570 7320 3d20 5b74 7474 7570 2066  rtups = [tttup f
-00017170: 6f72 2074 7474 7570 2069 6e0a 2020 2020  or tttup in.    
-00017180: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00017190: 662e 636f 6e74 6578 7473 5b2d 315d 2e43  f.contexts[-1].C
-000171a0: 525b 2623 3334 3b69 6e74 6572 7072 6574  R[&#34;interpret
-000171b0: 6174 696f 6e26 2333 343b 5d5d 0a20 2020  ation&#34;]].   
-000171c0: 2023 2074 6869 7320 6973 2075 7365 6675   # this is usefu
-000171d0: 6c6c 2066 6f72 2070 6c6f 7469 6e67 0a20  ll for ploting. 
-000171e0: 2020 2073 656c 662e 636f 6e74 6578 7473     self.contexts
-000171f0: 5b2d 315d 2e43 525b 2623 3334 3b69 6e74  [-1].CR[&#34;int
-00017200: 6572 7072 6574 6174 696f 6e26 2333 343b  erpretation&#34;
-00017210: 5d20 3d20 696e 7465 7274 7570 730a 0a20  ] = intertups.. 
-00017220: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
-00017230: 6f6e 7465 7874 735b 2d31 5d3c 2f63 6f64  ontexts[-1]</cod
-00017240: 653e 3c2f 7072 653e 0a3c 2f64 6574 6169  e></pre>.</detai
-00017250: 6c73 3e0a 3c2f 6464 3e0a 3c64 7420 6964  ls>.</dd>.<dt id
-00017260: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
-00017270: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
-00017280: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
-00017290: 6765 745f 6368 6172 6163 7465 7269 7a61  get_characteriza
-000172a0: 7469 6f6e 223e 3c63 6f64 6520 636c 6173  tion"><code clas
-000172b0: 733d 226e 616d 6520 666c 6578 223e 0a3c  s="name flex">.<
-000172c0: 7370 616e 3e64 6566 203c 7370 616e 2063  span>def <span c
-000172d0: 6c61 7373 3d22 6964 656e 7422 3e67 6574  lass="ident">get
-000172e0: 5f63 6861 7261 6374 6572 697a 6174 696f  _characterizatio
-000172f0: 6e3c 2f73 7061 6e3e 3c2f 7370 616e 3e28  n</span></span>(
-00017300: 3c73 7061 6e3e 7365 6c66 2c20 636f 6e74  <span>self, cont
-00017310: 6578 7429 3c2f 7370 616e 3e0a 3c2f 636f  ext)</span>.</co
-00017320: 6465 3e3c 2f64 743e 0a3c 6464 3e0a 3c64  de></dt>.<dd>.<d
-00017330: 6976 2063 6c61 7373 3d22 6465 7363 223e  iv class="desc">
-00017340: 3c70 3e54 6869 7320 6d65 7468 6f64 2063  <p>This method c
-00017350: 616c 6375 6c61 7465 2074 6865 2063 6861  alculate the cha
-00017360: 7261 6374 6572 697a 6174 696f 6e73 206f  racterizations o
-00017370: 6620 2861 2c62 2920 6564 6765 7320 746f  f (a,b) edges to
-00017380: 2063 6861 7261 6374 6572 697a 6520 7468   characterize th
-00017390: 6520 696e 666c 7565 6e63 6520 6f66 2061  e influence of a
-000173a0: 2069 6e20 6220 6279 206f 6e65 206f 6620   in b by one of 
-000173b0: 7468 650a 7468 7265 6520 6368 6172 6163  the.three charac
-000173c0: 7465 7269 7a61 7469 6f6e 733a 2075 6e6b  terizations: unk
-000173d0: 6e6f 776e 2c20 6465 6372 6561 7365 2c20  nown, decrease, 
-000173e0: 696e 6372 6561 7365 2e3c 2f70 3e0a 3c70  increase.</p>.<p
-000173f0: 3e54 6865 2063 6861 7261 6374 6572 697a  >The characteriz
-00017400: 6174 696f 6e20 6973 2063 616c 6375 6c61  ation is calcula
-00017410: 7465 6420 6469 6666 6572 656e 746c 7920  ted differently 
-00017420: 666f 7220 6576 656e 7420 616e 6420 636f  for event and co
-00017430: 6e74 696e 756f 7573 2064 6174 612e 0a3c  ntinuous data..<
-00017440: 7374 726f 6e67 3e50 6172 616d 6574 6572  strong>Parameter
-00017450: 733c 2f73 7472 6f6e 673e 3a3c 2f70 3e0a  s</strong>:</p>.
-00017460: 3c70 3e3c 7374 726f 6e67 3e63 6f6e 7465  <p><strong>conte
-00017470: 7874 3c2f 7374 726f 6e67 3e3a 2064 6963  xt</strong>: dic
-00017480: 7469 6f6e 6172 7920 7769 7468 2061 206b  tionary with a k
-00017490: 7965 2027 6564 6765 7327 2066 6f72 2077  ye 'edges' for w
-000174a0: 6869 6368 2061 2070 6172 616c 6c65 6c20  hich a parallel 
-000174b0: 6c69 7374 206f 6620 6368 6172 6163 7465  list of characte
-000174c0: 7269 7a61 7469 6f6e 7320 7769 6c6c 2062  rizations will b
-000174d0: 6520 6372 6561 7465 642e 3c2f 703e 3c2f  e created.</p></
-000174e0: 6469 763e 0a3c 6465 7461 696c 7320 636c  div>.<details cl
-000174f0: 6173 733d 2273 6f75 7263 6522 3e0a 3c73  ass="source">.<s
-00017500: 756d 6d61 7279 3e0a 3c73 7061 6e3e 4578  ummary>.<span>Ex
-00017510: 7061 6e64 2073 6f75 7263 6520 636f 6465  pand source code
-00017520: 3c2f 7370 616e 3e0a 3c2f 7375 6d6d 6172  </span>.</summar
-00017530: 793e 0a3c 7072 653e 3c63 6f64 6520 636c  y>.<pre><code cl
-00017540: 6173 733d 2270 7974 686f 6e22 3e64 6566  ass="python">def
-00017550: 2067 6574 5f63 6861 7261 6374 6572 697a   get_characteriz
-00017560: 6174 696f 6e28 7365 6c66 2c20 636f 6e74  ation(self, cont
-00017570: 6578 7429 3a0a 2020 2020 2623 3334 3b26  ext):.    &#34;&
-00017580: 2333 343b 2623 3334 3b0a 2020 2020 5468  #34;&#34;.    Th
-00017590: 6973 206d 6574 686f 6420 6361 6c63 756c  is method calcul
-000175a0: 6174 6520 7468 6520 6368 6172 6163 7465  ate the characte
-000175b0: 7269 7a61 7469 6f6e 7320 6f66 2028 612c  rizations of (a,
-000175c0: 6229 2065 6467 6573 2074 6f20 6368 6172  b) edges to char
-000175d0: 6163 7465 7269 7a65 2074 6865 2069 6e66  acterize the inf
-000175e0: 6c75 656e 6365 206f 6620 6120 696e 2062  luence of a in b
-000175f0: 2062 7920 6f6e 6520 6f66 2074 6865 0a20   by one of the. 
-00017600: 2020 2074 6872 6565 2063 6861 7261 6374     three charact
-00017610: 6572 697a 6174 696f 6e73 3a20 756e 6b6e  erizations: unkn
-00017620: 6f77 6e2c 2064 6563 7265 6173 652c 2069  own, decrease, i
-00017630: 6e63 7265 6173 652e 0a0a 2020 2020 5468  ncrease...    Th
-00017640: 6520 6368 6172 6163 7465 7269 7a61 7469  e characterizati
-00017650: 6f6e 2069 7320 6361 6c63 756c 6174 6564  on is calculated
-00017660: 2064 6966 6665 7265 6e74 6c79 2066 6f72   differently for
-00017670: 2065 7665 6e74 2061 6e64 2063 6f6e 7469   event and conti
-00017680: 6e75 6f75 7320 6461 7461 2e0a 2020 2020  nuous data..    
-00017690: 2a2a 5061 7261 6d65 7465 7273 2a2a 3a0a  **Parameters**:.
-000176a0: 0a20 2020 202a 2a63 6f6e 7465 7874 2a2a  .    **context**
-000176b0: 3a20 6469 6374 696f 6e61 7279 2077 6974  : dictionary wit
-000176c0: 6820 6120 6b79 6520 2623 3339 3b65 6467  h a kye &#39;edg
-000176d0: 6573 2623 3339 3b20 666f 7220 7768 6963  es&#39; for whic
-000176e0: 6820 6120 7061 7261 6c6c 656c 206c 6973  h a parallel lis
-000176f0: 7420 6f66 2063 6861 7261 6374 6572 697a  t of characteriz
-00017700: 6174 696f 6e73 2077 696c 6c20 6265 2063  ations will be c
-00017710: 7265 6174 6564 2e0a 2020 2020 2623 3334  reated..    &#34
-00017720: 3b26 2333 343b 2623 3334 3b0a 2020 2020  ;&#34;&#34;.    
-00017730: 6564 6765 7320 3d20 636f 6e74 6578 745b  edges = context[
-00017740: 2623 3334 3b65 6467 6573 2623 3334 3b5d  &#34;edges&#34;]
-00017750: 0a20 2020 2063 6861 7261 6374 6572 697a  .    characteriz
-00017760: 6174 696f 6e73 203d 205b 5d0a 2020 2020  ations = [].    
-00017770: 666f 7220 6564 6765 2069 6e20 6564 6765  for edge in edge
-00017780: 733a 0a20 2020 2020 2020 2069 6620 7365  s:.        if se
-00017790: 6c66 2e74 6172 6765 7420 696e 2065 6467  lf.target in edg
-000177a0: 655b 305d 3a0a 2020 2020 2020 2020 2020  e[0]:.          
-000177b0: 2020 6368 6172 203d 2073 656c 662e 6368    char = self.ch
-000177c0: 6172 6163 7465 7269 7a65 5f65 7665 6e74  aracterize_event
-000177d0: 5f63 6f6e 7469 6e75 6f75 7328 636f 6e74  _continuous(cont
-000177e0: 6578 742c 2065 6467 6529 0a20 2020 2020  ext, edge).     
-000177f0: 2020 2065 6c69 6620 7365 6c66 2e74 7970     elif self.typ
-00017800: 655f 6f66 5f73 6572 6965 735b 6564 6765  e_of_series[edge
-00017810: 5b30 5d5d 203d 3d20 2623 3334 3b69 736f  [0]] == &#34;iso
-00017820: 6c61 7469 6f6e 2623 3334 3b20 6f72 2073  lation&#34; or s
-00017830: 656c 662e 7479 7065 5f6f 665f 7365 7269  elf.type_of_seri
-00017840: 6573 5b65 6467 655b 305d 5d20 3d3d 2026  es[edge[0]] == &
-00017850: 2333 343b 636f 6e66 6967 7572 6174 696f  #34;configuratio
-00017860: 6e26 2333 343b 3a0a 2020 2020 2020 2020  n&#34;:.        
-00017870: 2020 2020 6368 6172 203d 2073 656c 662e      char = self.
-00017880: 6368 6172 6163 7465 7269 7a65 5f65 7665  characterize_eve
-00017890: 6e74 5f65 6467 6528 636f 6e74 6578 742c  nt_edge(context,
-000178a0: 2065 6467 6529 0a20 2020 2020 2020 2065   edge).        e
-000178b0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000178c0: 2063 6861 7220 3d20 7365 6c66 2e63 6861   char = self.cha
-000178d0: 7261 6374 6572 697a 655f 6576 656e 745f  racterize_event_
-000178e0: 636f 6e74 696e 756f 7573 2863 6f6e 7465  continuous(conte
-000178f0: 7874 2c20 6564 6765 290a 2020 2020 2020  xt, edge).      
-00017900: 2020 6368 6172 6163 7465 7269 7a61 7469    characterizati
-00017910: 6f6e 732e 6170 7065 6e64 2863 6861 7229  ons.append(char)
-00017920: 0a20 2020 2072 6574 7572 6e20 6368 6172  .    return char
-00017930: 6163 7465 7269 7a61 7469 6f6e 733c 2f63  acterizations</c
-00017940: 6f64 653e 3c2f 7072 653e 0a3c 2f64 6574  ode></pre>.</det
-00017950: 6169 6c73 3e0a 3c2f 6464 3e0a 3c64 7420  ails>.</dd>.<dt 
-00017960: 6964 3d22 5064 6d43 6f6e 7465 7874 2e43  id="PdmContext.C
-00017970: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-00017980: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-00017990: 722e 696e 7465 7270 7265 7422 3e3c 636f  r.interpret"><co
-000179a0: 6465 2063 6c61 7373 3d22 6e61 6d65 2066  de class="name f
-000179b0: 6c65 7822 3e0a 3c73 7061 6e3e 6465 6620  lex">.<span>def 
-000179c0: 3c73 7061 6e20 636c 6173 733d 2269 6465  <span class="ide
-000179d0: 6e74 223e 696e 7465 7270 7265 743c 2f73  nt">interpret</s
-000179e0: 7061 6e3e 3c2f 7370 616e 3e28 3c73 7061  pan></span>(<spa
-000179f0: 6e3e 7365 6c66 2c20 636f 6e74 6578 743a  n>self, context:
-00017a00: c2a0 3c61 2074 6974 6c65 3d22 5064 6d43  ..<a title="PdmC
-00017a10: 6f6e 7465 7874 2e75 7469 6c73 2e73 7472  ontext.utils.str
-00017a20: 7563 7475 7265 2e43 6f6e 7465 7874 2220  ucture.Context" 
-00017a30: 6872 6566 3d22 7574 696c 732f 7374 7275  href="utils/stru
-00017a40: 6374 7572 652e 6874 6d6c 2350 646d 436f  cture.html#PdmCo
-00017a50: 6e74 6578 742e 7574 696c 732e 7374 7275  ntext.utils.stru
-00017a60: 6374 7572 652e 436f 6e74 6578 7422 3e43  cture.Context">C
-00017a70: 6f6e 7465 7874 3c2f 613e 2c20 6361 7573  ontext</a>, caus
-00017a80: 6573 7769 6e64 6f77 2c20 7461 7267 6574  eswindow, target
-00017a90: 2c20 7479 7065 5f6f 665f 7365 7269 6573  , type_of_series
-00017aa0: 293c 2f73 7061 6e3e 0a3c 2f63 6f64 653e  )</span>.</code>
-00017ab0: 3c2f 6474 3e0a 3c64 643e 0a3c 6469 7620  </dt>.<dd>.<div 
-00017ac0: 636c 6173 733d 2264 6573 6322 3e3c 703e  class="desc"><p>
-00017ad0: 5468 6973 206d 6574 686f 6420 656e 6861  This method enha
-00017ae0: 6e63 6520 7468 6520 4352 2070 6172 7420  nce the CR part 
-00017af0: 6f66 2074 6865 2043 6f6e 7465 7874 2077  of the Context w
-00017b00: 6974 6820 696e 7465 7270 7265 7461 7469  ith interpretati
-00017b10: 6f6e 2072 656c 6174 696e 6720 746f 2074  on relating to t
-00017b20: 6865 2074 6172 6765 7420 7661 7269 6162  he target variab
-00017b30: 6c65 2e0a 5468 6520 696e 7465 7270 7265  le..The interpre
-00017b40: 7461 7469 6f6e 2061 7265 2062 6173 6564  tation are based
-00017b50: 206f 6e20 7468 6520 6564 6765 7320 6578   on the edges ex
-00017b60: 7472 6163 7465 6420 6672 6f6d 2074 6865  tracted from the
-00017b70: 2043 6173 7561 6c74 7920 6469 7363 6f76   Casualty discov
-00017b80: 6572 792e 0a46 6f72 2065 6163 6820 6564  ery..For each ed
-00017b90: 6765 206f 6620 7479 7065 2028 7365 7269  ge of type (seri
-00017ba0: 6573 4120 2d26 6774 3b20 7461 7267 6574  esA -&gt; target
-00017bb0: 2920 696e 2074 6865 2065 6467 6573 2077  ) in the edges w
-00017bc0: 6520 7465 7374 2069 6620 7468 6520 7365  e test if the se
-00017bd0: 7269 6573 4120 696e 7465 7270 7265 7473  riesA interprets
-00017be0: 0a74 6865 2074 6172 6765 7420 7573 696e  .the target usin
-00017bf0: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
-00017c00: 7275 6c65 733a 3c2f 703e 0a3c 703e 3c73  rules:</p>.<p><s
-00017c10: 7472 6f6e 673e 6966 2073 6572 6965 7341  trong>if seriesA
-00017c20: 2069 7320 6973 6f6c 6174 6564 3c2f 7374   is isolated</st
-00017c30: 726f 6e67 3e3a 2057 6520 6368 6563 6b20  rong>: We check 
-00017c40: 6966 2069 7473 206c 6173 7420 6f63 6375  if its last occu
-00017c50: 7272 656e 6365 2069 7320 7468 6520 6375  rrence is the cu
-00017c60: 7272 656e 7420 7469 6d65 7374 616d 7020  rrent timestamp 
-00017c70: 6f72 2074 6865 2070 7265 7669 6f75 7320  or the previous 
-00017c80: 6f6e 652e 3c2f 703e 0a3c 703e 3c73 7472  one.</p>.<p><str
-00017c90: 6f6e 673e 6966 2073 6572 6965 7341 2069  ong>if seriesA i
-00017ca0: 7320 636f 6e66 6967 7572 6174 696f 6e3c  s configuration<
-00017cb0: 2f73 7472 6f6e 673e 3a20 5765 2063 6865  /strong>: We che
-00017cc0: 636b 2069 6620 7468 6520 6564 6765 7320  ck if the edges 
-00017cd0: 2873 6572 6965 7341 202d 2667 743b 2074  (seriesA -&gt; t
-00017ce0: 6172 6765 7429 2061 7070 6561 7273 0a69  arget) appears.i
-00017cf0: 6e20 6174 206c 6561 7374 2038 3025 2063  n at least 80% c
-00017d00: 6f6e 7465 7874 7320 696e 2074 6865 2068  ontexts in the h
-00017d10: 6f72 697a 6f6e 2028 692e 652e 2069 6e20  orizon (i.e. in 
-00017d20: 6361 7573 6573 7769 6e64 6f77 206c 6973  causeswindow lis
-00017d30: 7429 2e3c 2f70 3e0a 3c70 3e3c 7374 726f  t).</p>.<p><stro
-00017d40: 6e67 3e69 6620 7365 7269 6573 4120 6973  ng>if seriesA is
-00017d50: 2063 6f6e 7469 6e75 6f75 733c 2f73 7472   continuous</str
-00017d60: 6f6e 673e 3a20 5468 656e 2074 6861 7420  ong>: Then that 
-00017d70: 6d65 616e 7320 7468 6520 7461 7267 6574  means the target
-00017d80: 2069 7320 7265 6c61 7465 6420 7769 7468   is related with
-00017d90: 2073 6572 6965 7341 0a61 6e64 2077 6520   seriesA.and we 
-00017da0: 6164 6420 6974 2074 6f20 7468 6520 696e  add it to the in
-00017db0: 7465 7270 7265 7461 7469 6f6e 2e3c 2f70  terpretation.</p
-00017dc0: 3e0a 3c70 3e41 6c6c 2074 6865 2069 6e74  >.<p>All the int
-00017dd0: 6572 7072 6574 6174 696f 6e73 2061 7265  erpretations are
-00017de0: 2074 6167 6765 6420 7769 7468 2061 2074   tagged with a t
-00017df0: 696d 6573 7461 6d70 2077 6869 6368 2072  imestamp which r
-00017e00: 6566 6572 7320 746f 2074 6865 2066 6972  efers to the fir
-00017e10: 7374 2074 696d 650a 6f66 2061 7070 6561  st time.of appea
-00017e20: 7265 6e73 6520 6f66 2063 6f6e 7365 6375  rense of consecu
-00017e30: 7469 7665 2069 6e74 6572 7072 6574 6174  tive interpretat
-00017e40: 696f 6e73 2e20 5468 656e 2074 6865 2069  ions. Then the i
-00017e50: 6e74 6572 7072 6574 6174 696f 6e20 6172  nterpretation ar
-00017e60: 6520 736f 7274 6564 2075 7369 6e67 0a74  e sorted using.t
-00017e70: 6869 7320 7469 6d65 7374 616d 702e 2054  his timestamp. T
-00017e80: 6869 7320 6973 2064 6f6e 6520 746f 2070  his is done to p
-00017e90: 726f 7669 6465 2061 2068 6965 7261 7263  rovide a hierarc
-00017ea0: 6879 2074 6f20 7468 6520 696e 7465 7270  hy to the interp
-00017eb0: 7265 7461 7469 6f6e 2073 696e 6365 2069  retation since i
-00017ec0: 7420 6d61 7920 6265 2074 6865 2063 6173  t may be the cas
-00017ed0: 652c 0a74 6861 7420 7768 656e 2073 6572  e,.that when ser
-00017ee0: 6965 7341 2063 6175 7365 2074 6172 6765  iesA cause targe
-00017ef0: 7420 2c20 616e 6420 5365 7269 6573 4220  t , and SeriesB 
-00017f00: 6361 7573 6520 7461 7267 6574 2c20 7468  cause target, th
-00017f10: 6520 6f6c 6465 7374 206f 6e65 2069 7320  e oldest one is 
-00017f20: 7374 726f 6e67 6572 2073 696e 6365 2074  stronger since t
-00017f30: 6865 2053 6572 6965 7342 206d 6179 2062  he SeriesB may b
-00017f40: 650a 6566 6665 6374 206f 6620 7365 7269  e.effect of seri
-00017f50: 6573 412e 3c2f 703e 0a3c 703e 3c73 7472  esA.</p>.<p><str
-00017f60: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
-00017f70: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
-00017f80: 3c73 7472 6f6e 673e 636f 6e74 6578 743c  <strong>context<
-00017f90: 2f73 7472 6f6e 673e 3a20 436f 6e74 6578  /strong>: Contex
-00017fa0: 7420 4f62 6a65 6374 2074 6f20 6265 2069  t Object to be i
-00017fb0: 6e74 6572 7072 6574 6564 3c2f 703e 0a3c  nterpreted</p>.<
-00017fc0: 703e 3c73 7472 6f6e 673e 6361 7573 6573  p><strong>causes
-00017fd0: 7769 6e64 6f77 3c2f 7374 726f 6e67 3e3a  window</strong>:
-00017fe0: 206c 6973 7420 7769 7468 2074 6865 206c   list with the l
-00017ff0: 6173 7420 686f 7269 7a6f 6e20 636f 6e74  ast horizon cont
-00018000: 6578 7473 3c2f 703e 0a3c 703e 3c73 7472  exts</p>.<p><str
-00018010: 6f6e 673e 7461 7267 6574 3c2f 7374 726f  ong>target</stro
-00018020: 6e67 3e3a 2074 6865 206e 616d 6520 6f66  ng>: the name of
-00018030: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
-00018040: 6162 6c65 2074 6f20 696e 7465 7270 7265  able to interpre
-00018050: 743c 2f70 3e0a 3c70 3e3c 7374 726f 6e67  t</p>.<p><strong
-00018060: 3e74 7970 655f 6f66 5f73 6572 6965 733c  >type_of_series<
-00018070: 2f73 7472 6f6e 673e 3a20 6469 6374 696f  /strong>: dictio
-00018080: 6e61 7279 2077 6869 6368 2064 6566 696e  nary which defin
-00018090: 6520 7468 6520 7479 7065 206f 6620 6561  e the type of ea
-000180a0: 6368 2073 6572 6965 7320 2869 736f 6c61  ch series (isola
-000180b0: 7465 642c 636f 6e66 6967 7572 6174 696f  ted,configuratio
-000180c0: 6e20 6f72 2063 6f6e 7469 6e75 6f75 7329  n or continuous)
-000180d0: 3c2f 703e 3c2f 6469 763e 0a3c 6465 7461  </p></div>.<deta
-000180e0: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
-000180f0: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
-00018100: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
-00018110: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
-00018120: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
-00018130: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
-00018140: 6e22 3e64 6566 2069 6e74 6572 7072 6574  n">def interpret
-00018150: 2873 656c 662c 2063 6f6e 7465 7874 3a20  (self, context: 
-00018160: 436f 6e74 6578 742c 2063 6175 7365 7377  Context, causesw
-00018170: 696e 646f 772c 2074 6172 6765 742c 2074  indow, target, t
-00018180: 7970 655f 6f66 5f73 6572 6965 7329 3a0a  ype_of_series):.
-00018190: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
-000181a0: 3334 3b0a 2020 2020 5468 6973 206d 6574  34;.    This met
-000181b0: 686f 6420 656e 6861 6e63 6520 7468 6520  hod enhance the 
-000181c0: 4352 2070 6172 7420 6f66 2074 6865 2043  CR part of the C
-000181d0: 6f6e 7465 7874 2077 6974 6820 696e 7465  ontext with inte
-000181e0: 7270 7265 7461 7469 6f6e 2072 656c 6174  rpretation relat
-000181f0: 696e 6720 746f 2074 6865 2074 6172 6765  ing to the targe
-00018200: 7420 7661 7269 6162 6c65 2e0a 2020 2020  t variable..    
-00018210: 5468 6520 696e 7465 7270 7265 7461 7469  The interpretati
-00018220: 6f6e 2061 7265 2062 6173 6564 206f 6e20  on are based on 
-00018230: 7468 6520 6564 6765 7320 6578 7472 6163  the edges extrac
-00018240: 7465 6420 6672 6f6d 2074 6865 2043 6173  ted from the Cas
-00018250: 7561 6c74 7920 6469 7363 6f76 6572 792e  ualty discovery.
-00018260: 0a20 2020 2046 6f72 2065 6163 6820 6564  .    For each ed
-00018270: 6765 206f 6620 7479 7065 2028 7365 7269  ge of type (seri
-00018280: 6573 4120 2d26 6774 3b20 7461 7267 6574  esA -&gt; target
-00018290: 2920 696e 2074 6865 2065 6467 6573 2077  ) in the edges w
-000182a0: 6520 7465 7374 2069 6620 7468 6520 7365  e test if the se
-000182b0: 7269 6573 4120 696e 7465 7270 7265 7473  riesA interprets
-000182c0: 0a20 2020 2074 6865 2074 6172 6765 7420  .    the target 
-000182d0: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
-000182e0: 696e 6720 7275 6c65 733a 0a0a 2020 2020  ing rules:..    
-000182f0: 2a2a 6966 2073 6572 6965 7341 2069 7320  **if seriesA is 
-00018300: 6973 6f6c 6174 6564 2a2a 3a20 5765 2063  isolated**: We c
-00018310: 6865 636b 2069 6620 6974 7320 6c61 7374  heck if its last
-00018320: 206f 6363 7572 7265 6e63 6520 6973 2074   occurrence is t
-00018330: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
-00018340: 7461 6d70 206f 7220 7468 6520 7072 6576  tamp or the prev
-00018350: 696f 7573 206f 6e65 2e0a 0a20 2020 202a  ious one...    *
-00018360: 2a69 6620 7365 7269 6573 4120 6973 2063  *if seriesA is c
-00018370: 6f6e 6669 6775 7261 7469 6f6e 2a2a 3a20  onfiguration**: 
-00018380: 5765 2063 6865 636b 2069 6620 7468 6520  We check if the 
-00018390: 6564 6765 7320 2873 6572 6965 7341 202d  edges (seriesA -
-000183a0: 2667 743b 2074 6172 6765 7429 2061 7070  &gt; target) app
-000183b0: 6561 7273 0a20 2020 2069 6e20 6174 206c  ears.    in at l
-000183c0: 6561 7374 2038 3025 2063 6f6e 7465 7874  east 80% context
-000183d0: 7320 696e 2074 6865 2068 6f72 697a 6f6e  s in the horizon
-000183e0: 2028 692e 652e 2069 6e20 6361 7573 6573   (i.e. in causes
-000183f0: 7769 6e64 6f77 206c 6973 7429 2e0a 0a20  window list)... 
-00018400: 2020 202a 2a69 6620 7365 7269 6573 4120     **if seriesA 
-00018410: 6973 2063 6f6e 7469 6e75 6f75 732a 2a3a  is continuous**:
-00018420: 2054 6865 6e20 7468 6174 206d 6561 6e73   Then that means
-00018430: 2074 6865 2074 6172 6765 7420 6973 2072   the target is r
-00018440: 656c 6174 6564 2077 6974 6820 7365 7269  elated with seri
-00018450: 6573 410a 2020 2020 616e 6420 7765 2061  esA.    and we a
-00018460: 6464 2069 7420 746f 2074 6865 2069 6e74  dd it to the int
-00018470: 6572 7072 6574 6174 696f 6e2e 0a0a 2020  erpretation...  
-00018480: 2020 416c 6c20 7468 6520 696e 7465 7270    All the interp
-00018490: 7265 7461 7469 6f6e 7320 6172 6520 7461  retations are ta
-000184a0: 6767 6564 2077 6974 6820 6120 7469 6d65  gged with a time
-000184b0: 7374 616d 7020 7768 6963 6820 7265 6665  stamp which refe
-000184c0: 7273 2074 6f20 7468 6520 6669 7273 7420  rs to the first 
-000184d0: 7469 6d65 0a20 2020 206f 6620 6170 7065  time.    of appe
-000184e0: 6172 656e 7365 206f 6620 636f 6e73 6563  arense of consec
-000184f0: 7574 6976 6520 696e 7465 7270 7265 7461  utive interpreta
-00018500: 7469 6f6e 732e 2054 6865 6e20 7468 6520  tions. Then the 
-00018510: 696e 7465 7270 7265 7461 7469 6f6e 2061  interpretation a
-00018520: 7265 2073 6f72 7465 6420 7573 696e 670a  re sorted using.
-00018530: 2020 2020 7468 6973 2074 696d 6573 7461      this timesta
-00018540: 6d70 2e20 5468 6973 2069 7320 646f 6e65  mp. This is done
-00018550: 2074 6f20 7072 6f76 6964 6520 6120 6869   to provide a hi
-00018560: 6572 6172 6368 7920 746f 2074 6865 2069  erarchy to the i
-00018570: 6e74 6572 7072 6574 6174 696f 6e20 7369  nterpretation si
-00018580: 6e63 6520 6974 206d 6179 2062 6520 7468  nce it may be th
-00018590: 6520 6361 7365 2c0a 2020 2020 7468 6174  e case,.    that
-000185a0: 2077 6865 6e20 7365 7269 6573 4120 6361   when seriesA ca
-000185b0: 7573 6520 7461 7267 6574 202c 2061 6e64  use target , and
-000185c0: 2053 6572 6965 7342 2063 6175 7365 2074   SeriesB cause t
-000185d0: 6172 6765 742c 2074 6865 206f 6c64 6573  arget, the oldes
-000185e0: 7420 6f6e 6520 6973 2073 7472 6f6e 6765  t one is stronge
-000185f0: 7220 7369 6e63 6520 7468 6520 5365 7269  r since the Seri
-00018600: 6573 4220 6d61 7920 6265 0a20 2020 2065  esB may be.    e
-00018610: 6666 6563 7420 6f66 2073 6572 6965 7341  ffect of seriesA
-00018620: 2e0a 0a20 2020 202a 2a50 6172 616d 6574  ...    **Paramet
-00018630: 6572 732a 2a3a 0a0a 2020 2020 2a2a 636f  ers**:..    **co
-00018640: 6e74 6578 742a 2a3a 2043 6f6e 7465 7874  ntext**: Context
-00018650: 204f 626a 6563 7420 746f 2062 6520 696e   Object to be in
-00018660: 7465 7270 7265 7465 640a 0a20 2020 202a  terpreted..    *
-00018670: 2a63 6175 7365 7377 696e 646f 772a 2a3a  *causeswindow**:
-00018680: 206c 6973 7420 7769 7468 2074 6865 206c   list with the l
-00018690: 6173 7420 686f 7269 7a6f 6e20 636f 6e74  ast horizon cont
-000186a0: 6578 7473 0a0a 2020 2020 2a2a 7461 7267  exts..    **targ
-000186b0: 6574 2a2a 3a20 7468 6520 6e61 6d65 206f  et**: the name o
-000186c0: 6620 7468 6520 7461 7267 6574 2076 6172  f the target var
-000186d0: 6961 626c 6520 746f 2069 6e74 6572 7072  iable to interpr
-000186e0: 6574 0a0a 2020 2020 2a2a 7479 7065 5f6f  et..    **type_o
-000186f0: 665f 7365 7269 6573 2a2a 3a20 6469 6374  f_series**: dict
-00018700: 696f 6e61 7279 2077 6869 6368 2064 6566  ionary which def
-00018710: 696e 6520 7468 6520 7479 7065 206f 6620  ine the type of 
-00018720: 6561 6368 2073 6572 6965 7320 2869 736f  each series (iso
-00018730: 6c61 7465 642c 636f 6e66 6967 7572 6174  lated,configurat
-00018740: 696f 6e20 6f72 2063 6f6e 7469 6e75 6f75  ion or continuou
-00018750: 7329 0a20 2020 2026 2333 343b 2623 3334  s).    &#34;&#34
-00018760: 3b26 2333 343b 0a0a 2020 2020 7061 6972  ;&#34;..    pair
-00018770: 7320 3d20 5b28 7061 6972 5b30 5d2c 2070  s = [(pair[0], p
-00018780: 6169 725b 315d 2c20 6361 7229 2066 6f72  air[1], car) for
-00018790: 2070 6169 722c 2063 6172 2069 6e20 7a69   pair, car in zi
-000187a0: 7028 636f 6e74 6578 742e 4352 5b26 2333  p(context.CR[&#3
-000187b0: 393b 6564 6765 7326 2333 393b 5d2c 2063  9;edges&#39;], c
-000187c0: 6f6e 7465 7874 2e43 525b 2623 3339 3b63  ontext.CR[&#39;c
-000187d0: 6861 7261 6374 6572 697a 6174 696f 6e26  haracterization&
-000187e0: 2333 393b 5d29 2069 660a 2020 2020 2020  #39;]) if.      
-000187f0: 2020 2020 2020 2074 6172 6765 7420 696e         target in
-00018800: 2070 6169 725b 315d 5d0a 0a20 2020 2023   pair[1]]..    #
-00018810: 2070 6169 7273 686f 7032 203d 205b 5d0a   pairshop2 = [].
-00018820: 2020 2020 2320 696e 7465 726d 6564 6961      # intermedia
-00018830: 7465 733d 5b70 6169 725b 305d 2066 6f72  tes=[pair[0] for
-00018840: 2070 6169 7220 696e 2070 6169 7273 5d0a   pair in pairs].
-00018850: 2020 2020 2320 616c 6c6f 7468 6573 3d5b      # allothes=[
-00018860: 7061 6972 2066 6f72 2070 6169 7220 696e  pair for pair in
-00018870: 2063 6f6e 7465 7874 2e43 442e 6b65 7973   context.CD.keys
-00018880: 2829 2069 6620 7061 6972 206e 6f74 2069  () if pair not i
-00018890: 6e20 696e 7465 726d 6564 6961 7465 735d  n intermediates]
-000188a0: 0a20 2020 2023 0a20 2020 2023 2066 6f72  .    #.    # for
-000188b0: 2069 6e74 6572 5f70 6169 7220 696e 2069   inter_pair in i
-000188c0: 6e74 6572 6d65 6469 6174 6573 3a0a 2020  ntermediates:.  
-000188d0: 2020 2320 2020 2020 666f 7220 6e61 6d65    #     for name
-000188e0: 2069 6e20 616c 6c6f 7468 6573 3a0a 2020   in allothes:.  
-000188f0: 2020 2320 2020 2020 2020 2020 6966 2028    #         if (
-00018900: 6e61 6d65 2c69 6e74 6572 5f70 6169 7229  name,inter_pair)
-00018910: 2069 6e20 636f 6e74 6578 742e 4352 5b26   in context.CR[&
-00018920: 2333 343b 6564 6765 7326 2333 343b 5d3a  #34;edges&#34;]:
-00018930: 0a20 2020 2023 2020 2020 2020 2020 2020  .    #          
-00018940: 2020 2070 6169 7273 686f 7032 2e61 7070     pairshop2.app
-00018950: 656e 6428 286e 616d 652c 696e 7465 725f  end((name,inter_
-00018960: 7061 6972 2929 0a0a 2020 2020 696e 7465  pair))..    inte
-00018970: 7270 7265 7461 7469 6f6e 203d 205b 5d0a  rpretation = [].
-00018980: 2020 2020 7479 7065 636f 6e65 6374 696f      typeconectio
-00018990: 6e20 3d20 5b5d 0a20 2020 2069 6620 6c65  n = [].    if le
-000189a0: 6e28 7061 6972 7329 203d 3d20 303a 0a20  n(pairs) == 0:. 
-000189b0: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
-000189c0: 0a20 2020 2066 6f72 2070 6169 7220 696e  .    for pair in
-000189d0: 2070 6169 7273 3a0a 2020 2020 2020 2020   pairs:.        
-000189e0: 6966 2074 7970 655f 6f66 5f73 6572 6965  if type_of_serie
-000189f0: 735b 7061 6972 5b30 5d5d 203d 3d20 2623  s[pair[0]] == &#
-00018a00: 3334 3b69 736f 6c61 7465 6426 2333 343b  34;isolated&#34;
-00018a10: 3a0a 2020 2020 2020 2020 2020 2020 7661  :.            va
-00018a20: 6c75 6573 3120 3d20 636f 6e74 6578 742e  lues1 = context.
-00018a30: 4344 5b70 6169 725b 305d 5d0a 2020 2020  CD[pair[0]].    
-00018a40: 2020 2020 2020 2020 6966 2076 616c 7565          if value
-00018a50: 7331 5b2d 315d 203d 3d20 313a 0a20 2020  s1[-1] == 1:.   
-00018a60: 2020 2020 2020 2020 2020 2020 2069 6e74               int
-00018a70: 6572 7072 6574 6174 696f 6e2e 6170 7065  erpretation.appe
-00018a80: 6e64 2828 7061 6972 5b30 5d2c 2070 6169  nd((pair[0], pai
-00018a90: 725b 315d 2c20 7061 6972 5b32 5d2c 2063  r[1], pair[2], c
-00018aa0: 6f6e 7465 7874 2e74 696d 6573 7461 6d70  ontext.timestamp
-00018ab0: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
-00018ac0: 6c69 6620 7661 6c75 6573 315b 2d32 5d20  lif values1[-2] 
-00018ad0: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
-00018ae0: 2020 2020 2020 7465 6d70 7469 6d65 7374        temptimest
-00018af0: 616d 7020 3d20 636f 6e74 6578 742e 7469  amp = context.ti
-00018b00: 6d65 7374 616d 700a 2020 2020 2020 2020  mestamp.        
-00018b10: 2020 2020 2020 2020 6c61 7374 636f 6e74          lastcont
-00018b20: 6578 7420 3d20 7365 6c66 2e63 6f6e 7465  ext = self.conte
-00018b30: 7874 735b 6d61 7828 6c65 6e28 7365 6c66  xts[max(len(self
-00018b40: 2e63 6f6e 7465 7874 7329 202d 2032 2c20  .contexts) - 2, 
-00018b50: 3029 5d0a 2020 2020 2020 2020 2020 2020  0)].            
-00018b60: 2020 2020 666f 7220 696e 7465 7270 6169      for interpai
-00018b70: 7220 696e 206c 6173 7463 6f6e 7465 7874  r in lastcontext
-00018b80: 2e43 525b 2623 3334 3b69 6e74 6572 7072  .CR[&#34;interpr
-00018b90: 6574 6174 696f 6e26 2333 343b 5d3a 0a20  etation&#34;]:. 
-00018ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018bb0: 2020 2069 6620 696e 7465 7270 6169 725b     if interpair[
-00018bc0: 305d 203d 3d20 7061 6972 5b30 5d20 616e  0] == pair[0] an
-00018bd0: 6420 696e 7465 7270 6169 725b 315d 203d  d interpair[1] =
-00018be0: 3d20 7061 6972 5b31 5d3a 0a20 2020 2020  = pair[1]:.     
-00018bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c00: 2020 2074 656d 7074 696d 6573 7461 6d70     temptimestamp
-00018c10: 203d 2069 6e74 6572 7061 6972 5b33 5d0a   = interpair[3].
-00018c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018c30: 696e 7465 7270 7265 7461 7469 6f6e 2e61  interpretation.a
-00018c40: 7070 656e 6428 2870 6169 725b 305d 2c20  ppend((pair[0], 
-00018c50: 7061 6972 5b31 5d2c 2070 6169 725b 325d  pair[1], pair[2]
-00018c60: 2c20 7465 6d70 7469 6d65 7374 616d 7029  , temptimestamp)
-00018c70: 290a 2020 2020 2020 2020 656c 6966 2074  ).        elif t
-00018c80: 7970 655f 6f66 5f73 6572 6965 735b 7061  ype_of_series[pa
-00018c90: 6972 5b30 5d5d 203d 3d20 2623 3334 3b63  ir[0]] == &#34;c
-00018ca0: 6f6e 6669 6775 7261 7469 6f6e 2623 3334  onfiguration&#34
-00018cb0: 3b3a 0a20 2020 2020 2020 2020 2020 2076  ;:.            v
-00018cc0: 616c 7565 7331 203d 2063 6f6e 7465 7874  alues1 = context
-00018cd0: 2e43 445b 7061 6972 5b30 5d5d 0a20 2020  .CD[pair[0]].   
-00018ce0: 2020 2020 2020 2020 206f 6363 7572 656e           occuren
-00018cf0: 6365 203d 2030 0a20 2020 2020 2020 2020  ce = 0.         
-00018d00: 2020 2066 6f72 2071 2069 6e20 7261 6e67     for q in rang
-00018d10: 6528 6c65 6e28 7661 6c75 6573 3129 293a  e(len(values1)):
-00018d20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018d30: 2069 6620 7661 6c75 6573 315b 715d 203d   if values1[q] =
-00018d40: 3d20 7661 6c75 6573 315b 2d31 5d20 616e  = values1[-1] an
-00018d50: 6420 7661 6c75 6573 315b 715d 2026 6774  d values1[q] &gt
-00018d60: 3b20 303a 0a20 2020 2020 2020 2020 2020  ; 0:.           
-00018d70: 2020 2020 2020 2020 206f 6363 7572 656e           occuren
-00018d80: 6365 203d 2071 0a20 2020 2020 2020 2020  ce = q.         
-00018d90: 2020 2020 2020 2020 2020 2062 7265 616b             break
-00018da0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00018db0: 6f63 6375 7265 6e63 6520 3d3d 206c 656e  occurence == len
-00018dc0: 2876 616c 7565 7331 2920 2d20 313a 0a20  (values1) - 1:. 
-00018dd0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018de0: 6e74 6572 7072 6574 6174 696f 6e2e 6170  nterpretation.ap
-00018df0: 7065 6e64 2828 7061 6972 5b30 5d2c 2070  pend((pair[0], p
-00018e00: 6169 725b 315d 2c20 7061 6972 5b32 5d2c  air[1], pair[2],
-00018e10: 2063 6f6e 7465 7874 2e74 696d 6573 7461   context.timesta
-00018e20: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
-00018e30: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00018e40: 2020 2020 2020 206c 6561 6420 3d20 6c65         lead = le
-00018e50: 6e28 7661 6c75 6573 3129 202d 206f 6363  n(values1) - occ
-00018e60: 7572 656e 6365 0a20 2020 2020 2020 2020  urence.         
-00018e70: 2020 2020 2020 2063 6f75 6e74 6572 203d         counter =
-00018e80: 2030 0a20 2020 2020 2020 2020 2020 2020   0.             
-00018e90: 2020 206c 6561 6463 6f6e 7465 7874 203d     leadcontext =
-00018ea0: 2063 6175 7365 7377 696e 646f 775b 2d6c   causeswindow[-l
-00018eb0: 6561 643a 5d0a 2020 2020 2020 2020 2020  ead:].          
-00018ec0: 2020 2020 2020 666f 7220 636f 6e74 6520        for conte 
-00018ed0: 696e 206c 6561 6463 6f6e 7465 7874 3a0a  in leadcontext:.
-00018ee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018ef0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00018f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f10: 2070 6f73 203d 206c 6973 7428 636f 6e74   pos = list(cont
-00018f20: 652e 4352 5b26 2333 343b 6564 6765 7326  e.CR[&#34;edges&
-00018f30: 2333 343b 5d29 2e69 6e64 6578 2828 7061  #34;]).index((pa
-00018f40: 6972 5b30 5d2c 2070 6169 725b 315d 2929  ir[0], pair[1]))
-00018f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018f60: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
-00018f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018f80: 2020 2020 2070 6f73 203d 202d 310a 2020       pos = -1.  
-00018f90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fa0: 2020 6966 2070 6f73 2021 3d20 2d31 3a0a    if pos != -1:.
-00018fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018fc0: 2020 2020 2020 2020 6966 2063 6f6e 7465          if conte
-00018fd0: 2e43 525b 2623 3334 3b63 6861 7261 6374  .CR[&#34;charact
-00018fe0: 6572 697a 6174 696f 6e26 2333 343b 5d5b  erization&#34;][
-00018ff0: 706f 735d 203d 3d20 7061 6972 5b32 5d3a  pos] == pair[2]:
-00019000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019010: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-00019020: 6e74 6572 202b 3d20 310a 2020 2020 2020  nter += 1.      
-00019030: 2020 2020 2020 2020 2020 6966 2063 6f75            if cou
-00019040: 6e74 6572 2026 6774 3b3d 2030 2e38 202a  nter &gt;= 0.8 *
-00019050: 206c 6561 643a 0a20 2020 2020 2020 2020   lead:.         
-00019060: 2020 2020 2020 2020 2020 2074 656d 7074             tempt
-00019070: 696d 6573 7461 6d70 203d 2063 6f6e 7465  imestamp = conte
-00019080: 7874 2e74 696d 6573 7461 6d70 0a20 2020  xt.timestamp.   
-00019090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190a0: 206c 6173 7463 6f6e 7465 7874 203d 2073   lastcontext = s
-000190b0: 656c 662e 636f 6e74 6578 7473 5b6d 6178  elf.contexts[max
-000190c0: 286c 656e 2873 656c 662e 636f 6e74 6578  (len(self.contex
-000190d0: 7473 2920 2d20 322c 2030 295d 0a20 2020  ts) - 2, 0)].   
-000190e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000190f0: 2066 6f72 2069 6e74 6572 7061 6972 2069   for interpair i
-00019100: 6e20 6c61 7374 636f 6e74 6578 742e 4352  n lastcontext.CR
-00019110: 5b26 2333 343b 696e 7465 7270 7265 7461  [&#34;interpreta
-00019120: 7469 6f6e 2623 3334 3b5d 3a0a 2020 2020  tion&#34;]:.    
-00019130: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019140: 2020 2020 6966 2069 6e74 6572 7061 6972      if interpair
-00019150: 5b30 5d20 3d3d 2070 6169 725b 305d 2061  [0] == pair[0] a
-00019160: 6e64 2069 6e74 6572 7061 6972 5b31 5d20  nd interpair[1] 
-00019170: 3d3d 2070 6169 725b 315d 3a0a 2020 2020  == pair[1]:.    
-00019180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019190: 2020 2020 2020 2020 7465 6d70 7469 6d65          temptime
-000191a0: 7374 616d 7020 3d20 696e 7465 7270 6169  stamp = interpai
-000191b0: 725b 335d 0a20 2020 2020 2020 2020 2020  r[3].           
-000191c0: 2020 2020 2020 2020 2069 6e74 6572 7072           interpr
-000191d0: 6574 6174 696f 6e2e 6170 7065 6e64 2828  etation.append((
-000191e0: 7061 6972 5b30 5d2c 2070 6169 725b 315d  pair[0], pair[1]
-000191f0: 2c20 7061 6972 5b32 5d2c 2074 656d 7074  , pair[2], tempt
-00019200: 696d 6573 7461 6d70 2929 0a20 2020 2020  imestamp)).     
-00019210: 2020 2023 2066 6f72 2072 6561 6c20 7661     # for real va
-00019220: 6c75 6520 7365 7269 6573 0a20 2020 2020  lue series.     
-00019230: 2020 2065 6c69 6620 6c65 6e28 7365 7428     elif len(set(
-00019240: 636f 6e74 6578 742e 4344 5b70 6169 725b  context.CD[pair[
-00019250: 305d 5d29 2920 2667 743b 2032 3a0a 2020  0]])) &gt; 2:.  
-00019260: 2020 2020 2020 2020 2020 7465 6d70 7469            tempti
-00019270: 6d65 7374 616d 7020 3d20 636f 6e74 6578  mestamp = contex
-00019280: 742e 7469 6d65 7374 616d 700a 2020 2020  t.timestamp.    
-00019290: 2020 2020 2020 2020 6c61 7374 636f 6e74          lastcont
-000192a0: 6578 7420 3d20 7365 6c66 2e63 6f6e 7465  ext = self.conte
-000192b0: 7874 735b 6d61 7828 6c65 6e28 7365 6c66  xts[max(len(self
-000192c0: 2e63 6f6e 7465 7874 7329 202d 2032 2c20  .contexts) - 2, 
-000192d0: 3029 5d0a 2020 2020 2020 2020 2020 2020  0)].            
-000192e0: 666f 7220 696e 7465 7270 6169 7220 696e  for interpair in
-000192f0: 206c 6173 7463 6f6e 7465 7874 2e43 525b   lastcontext.CR[
-00019300: 2623 3334 3b69 6e74 6572 7072 6574 6174  &#34;interpretat
-00019310: 696f 6e26 2333 343b 5d3a 0a20 2020 2020  ion&#34;]:.     
-00019320: 2020 2020 2020 2020 2020 2069 6620 696e             if in
-00019330: 7465 7270 6169 725b 305d 203d 3d20 7061  terpair[0] == pa
-00019340: 6972 5b30 5d20 616e 6420 696e 7465 7270  ir[0] and interp
-00019350: 6169 725b 315d 203d 3d20 7061 6972 5b31  air[1] == pair[1
-00019360: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
-00019370: 2020 2020 2020 2074 656d 7074 696d 6573         temptimes
-00019380: 7461 6d70 203d 2069 6e74 6572 7061 6972  tamp = interpair
-00019390: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
-000193a0: 696e 7465 7270 7265 7461 7469 6f6e 2e61  interpretation.a
-000193b0: 7070 656e 6428 2870 6169 725b 305d 2c20  ppend((pair[0], 
-000193c0: 7061 6972 5b31 5d2c 2070 6169 725b 325d  pair[1], pair[2]
-000193d0: 2c20 7465 6d70 7469 6d65 7374 616d 7029  , temptimestamp)
-000193e0: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
-000193f0: 6e74 696e 7565 0a20 2020 2023 2073 6f72  ntinue.    # sor
-00019400: 7420 7769 7468 2074 696d 650a 2020 2020  t with time.    
-00019410: 6669 6e74 6572 7072 6574 203d 205b 5d0a  finterpret = [].
-00019420: 2020 2020 666f 7220 7061 6972 2069 6e20      for pair in 
-00019430: 696e 7465 7270 7265 7461 7469 6f6e 3a0a  interpretation:.
-00019440: 2020 2020 2020 2020 6669 6e74 6572 7072          finterpr
-00019450: 6574 2e61 7070 656e 6428 2870 6169 725b  et.append((pair[
-00019460: 305d 2c20 7061 6972 5b31 5d2c 2070 6169  0], pair[1], pai
-00019470: 725b 325d 2c20 7061 6972 5b33 5d29 290a  r[2], pair[3])).
-00019480: 2020 2020 6669 6e74 6572 7072 6574 2e73      finterpret.s
-00019490: 6f72 7428 6b65 793d 6c61 6d62 6461 2074  ort(key=lambda t
-000194a0: 7570 3a20 7475 705b 335d 2920 2023 2073  up: tup[3])  # s
-000194b0: 6f72 7473 2069 6e20 706c 6163 650a 2020  orts in place.  
-000194c0: 2020 7265 7475 726e 2066 696e 7465 7270    return finterp
-000194d0: 7265 743c 2f63 6f64 653e 3c2f 7072 653e  ret</code></pre>
-000194e0: 0a3c 2f64 6574 6169 6c73 3e0a 3c2f 6464  .</details>.</dd
-000194f0: 3e0a 3c64 7420 6964 3d22 5064 6d43 6f6e  >.<dt id="PdmCon
-00019500: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
-00019510: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
-00019520: 6e65 7261 746f 722e 706c 6f74 223e 3c63  nerator.plot"><c
-00019530: 6f64 6520 636c 6173 733d 226e 616d 6520  ode class="name 
-00019540: 666c 6578 223e 0a3c 7370 616e 3e64 6566  flex">.<span>def
-00019550: 203c 7370 616e 2063 6c61 7373 3d22 6964   <span class="id
-00019560: 656e 7422 3e70 6c6f 743c 2f73 7061 6e3e  ent">plot</span>
-00019570: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
-00019580: 6c66 2c20 6669 6c74 6572 6564 6765 733d  lf, filteredges=
-00019590: 4e6f 6e65 293c 2f73 7061 6e3e 0a3c 2f63  None)</span>.</c
-000195a0: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
-000195b0: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
-000195c0: 3e3c 2f64 6976 3e0a 3c64 6574 6169 6c73  ></div>.<details
-000195d0: 2063 6c61 7373 3d22 736f 7572 6365 223e   class="source">
-000195e0: 0a3c 7375 6d6d 6172 793e 0a3c 7370 616e  .<summary>.<span
-000195f0: 3e45 7870 616e 6420 736f 7572 6365 2063  >Expand source c
-00019600: 6f64 653c 2f73 7061 6e3e 0a3c 2f73 756d  ode</span>.</sum
-00019610: 6d61 7279 3e0a 3c70 7265 3e3c 636f 6465  mary>.<pre><code
-00019620: 2063 6c61 7373 3d22 7079 7468 6f6e 223e   class="python">
-00019630: 6465 6620 706c 6f74 2873 656c 662c 2066  def plot(self, f
-00019640: 696c 7465 7265 6467 6573 3d4e 6f6e 6529  ilteredges=None)
-00019650: 3a0a 2020 2020 6966 2066 696c 7465 7265  :.    if filtere
-00019660: 6467 6573 2069 7320 4e6f 6e65 3a0a 2020  dges is None:.  
-00019670: 2020 2020 2020 6669 6c74 6572 6564 6765        filteredge
-00019680: 7320 3d20 5b5b 2623 3334 3b26 2333 343b  s = [[&#34;&#34;
-00019690: 2c20 2623 3334 3b26 2333 343b 2c20 2623  , &#34;&#34;, &#
-000196a0: 3334 3b26 2333 343b 5d5d 0a20 2020 2073  34;&#34;]].    s
-000196b0: 686f 775f 636f 6e74 6578 745f 6c69 7374  how_context_list
-000196c0: 2873 656c 662e 636f 6e74 6578 7473 2c20  (self.contexts, 
-000196d0: 7365 6c66 2e74 6172 6765 742c 2066 696c  self.target, fil
-000196e0: 7465 7265 6467 6573 3d66 696c 7465 7265  teredges=filtere
-000196f0: 6467 6573 293c 2f63 6f64 653e 3c2f 7072  dges)</code></pr
-00019700: 653e 0a3c 2f64 6574 6169 6c73 3e0a 3c2f  e>.</details>.</
-00019710: 6464 3e0a 3c64 7420 6964 3d22 5064 6d43  dd>.<dt id="PdmC
-00019720: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
-00019730: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
-00019740: 4765 6e65 7261 746f 722e 706c 6f74 5f69  Generator.plot_i
-00019750: 6e74 6572 7072 6574 6174 696f 6e22 3e3c  nterpretation"><
-00019760: 636f 6465 2063 6c61 7373 3d22 6e61 6d65  code class="name
-00019770: 2066 6c65 7822 3e0a 3c73 7061 6e3e 6465   flex">.<span>de
-00019780: 6620 3c73 7061 6e20 636c 6173 733d 2269  f <span class="i
-00019790: 6465 6e74 223e 706c 6f74 5f69 6e74 6572  dent">plot_inter
-000197a0: 7072 6574 6174 696f 6e3c 2f73 7061 6e3e  pretation</span>
-000197b0: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
-000197c0: 6c66 2c20 6669 6c74 6572 6564 6765 733d  lf, filteredges=
-000197d0: 4e6f 6e65 293c 2f73 7061 6e3e 0a3c 2f63  None)</span>.</c
-000197e0: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
-000197f0: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
-00019800: 3e3c 2f64 6976 3e0a 3c64 6574 6169 6c73  ></div>.<details
-00019810: 2063 6c61 7373 3d22 736f 7572 6365 223e   class="source">
-00019820: 0a3c 7375 6d6d 6172 793e 0a3c 7370 616e  .<summary>.<span
-00019830: 3e45 7870 616e 6420 736f 7572 6365 2063  >Expand source c
-00019840: 6f64 653c 2f73 7061 6e3e 0a3c 2f73 756d  ode</span>.</sum
-00019850: 6d61 7279 3e0a 3c70 7265 3e3c 636f 6465  mary>.<pre><code
-00019860: 2063 6c61 7373 3d22 7079 7468 6f6e 223e   class="python">
-00019870: 6465 6620 706c 6f74 5f69 6e74 6572 7072  def plot_interpr
-00019880: 6574 6174 696f 6e28 7365 6c66 2c20 6669  etation(self, fi
-00019890: 6c74 6572 6564 6765 733d 4e6f 6e65 293a  lteredges=None):
-000198a0: 0a20 2020 2069 6620 6669 6c74 6572 6564  .    if filtered
-000198b0: 6765 7320 6973 204e 6f6e 653a 0a20 2020  ges is None:.   
-000198c0: 2020 2020 2066 696c 7465 7265 6467 6573       filteredges
-000198d0: 203d 205b 5b26 2333 343b 2623 3334 3b2c   = [[&#34;&#34;,
-000198e0: 2026 2333 343b 2623 3334 3b2c 2026 2333   &#34;&#34;, &#3
-000198f0: 343b 2623 3334 3b5d 5d0a 2020 2020 7368  4;&#34;]].    sh
-00019900: 6f77 5f63 6f6e 7465 7874 5f69 6e74 6572  ow_context_inter
-00019910: 7072 6574 6174 696f 6e73 2873 656c 662e  pretations(self.
-00019920: 636f 6e74 6578 7473 2c20 7365 6c66 2e74  contexts, self.t
-00019930: 6172 6765 742c 2066 696c 7465 7265 6467  arget, filteredg
-00019940: 6573 3d66 696c 7465 7265 6467 6573 293c  es=filteredges)<
-00019950: 2f63 6f64 653e 3c2f 7072 653e 0a3c 2f64  /code></pre>.</d
-00019960: 6574 6169 6c73 3e0a 3c2f 6464 3e0a 3c2f  etails>.</dd>.</
-00019970: 646c 3e0a 3c2f 6464 3e0a 3c2f 646c 3e0a  dl>.</dd>.</dl>.
-00019980: 3c2f 7365 6374 696f 6e3e 0a3c 2f61 7274  </section>.</art
-00019990: 6963 6c65 3e0a 3c6e 6176 2069 643d 2273  icle>.<nav id="s
-000199a0: 6964 6562 6172 223e 0a3c 6831 3e49 6e64  idebar">.<h1>Ind
-000199b0: 6578 3c2f 6831 3e0a 3c64 6976 2063 6c61  ex</h1>.<div cla
-000199c0: 7373 3d22 746f 6322 3e0a 3c75 6c3e 3c2f  ss="toc">.<ul></
-000199d0: 756c 3e0a 3c2f 6469 763e 0a3c 756c 2069  ul>.</div>.<ul i
-000199e0: 643d 2269 6e64 6578 223e 0a3c 6c69 3e3c  d="index">.<li><
-000199f0: 6833 3e53 7570 6572 2d6d 6f64 756c 653c  h3>Super-module<
-00019a00: 2f68 333e 0a3c 756c 3e0a 3c6c 693e 3c63  /h3>.<ul>.<li><c
-00019a10: 6f64 653e 3c61 2074 6974 6c65 3d22 5064  ode><a title="Pd
-00019a20: 6d43 6f6e 7465 7874 2220 6872 6566 3d22  mContext" href="
-00019a30: 696e 6465 782e 6874 6d6c 223e 5064 6d43  index.html">PdmC
-00019a40: 6f6e 7465 7874 3c2f 613e 3c2f 636f 6465  ontext</a></code
-00019a50: 3e3c 2f6c 693e 0a3c 2f75 6c3e 0a3c 2f6c  ></li>.</ul>.</l
-00019a60: 693e 0a3c 6c69 3e3c 6833 3e3c 6120 6872  i>.<li><h3><a hr
-00019a70: 6566 3d22 2368 6561 6465 722d 636c 6173  ef="#header-clas
-00019a80: 7365 7322 3e43 6c61 7373 6573 3c2f 613e  ses">Classes</a>
-00019a90: 3c2f 6833 3e0a 3c75 6c3e 0a3c 6c69 3e0a  </h3>.<ul>.<li>.
-00019aa0: 3c68 343e 3c63 6f64 653e 3c61 2074 6974  <h4><code><a tit
-00019ab0: 6c65 3d22 5064 6d43 6f6e 7465 7874 2e43  le="PdmContext.C
-00019ac0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-00019ad0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-00019ae0: 7222 2068 7265 663d 2223 5064 6d43 6f6e  r" href="#PdmCon
-00019af0: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
-00019b00: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
-00019b10: 6e65 7261 746f 7222 3e43 6f6e 7465 7874  nerator">Context
-00019b20: 4765 6e65 7261 746f 723c 2f61 3e3c 2f63  Generator</a></c
-00019b30: 6f64 653e 3c2f 6834 3e0a 3c75 6c20 636c  ode></h4>.<ul cl
-00019b40: 6173 733d 2222 3e0a 3c6c 693e 3c63 6f64  ass="">.<li><cod
-00019b50: 653e 3c61 2074 6974 6c65 3d22 5064 6d43  e><a title="PdmC
-00019b60: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
-00019b70: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
-00019b80: 4765 6e65 7261 746f 722e 4e75 6d70 795f  Generator.Numpy_
-00019b90: 7072 6570 726f 6363 6573 7322 2068 7265  preproccess" hre
-00019ba0: 663d 2223 5064 6d43 6f6e 7465 7874 2e43  f="#PdmContext.C
-00019bb0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-00019bc0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-00019bd0: 722e 4e75 6d70 795f 7072 6570 726f 6363  r.Numpy_preprocc
-00019be0: 6573 7322 3e4e 756d 7079 5f70 7265 7072  ess">Numpy_prepr
-00019bf0: 6f63 6365 7373 3c2f 613e 3c2f 636f 6465  occess</a></code
-00019c00: 3e3c 2f6c 693e 0a3c 6c69 3e3c 636f 6465  ></li>.<li><code
-00019c10: 3e3c 6120 7469 746c 653d 2250 646d 436f  ><a title="PdmCo
-00019c20: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
-00019c30: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
-00019c40: 656e 6572 6174 6f72 2e61 6464 5f74 6f5f  enerator.add_to_
-00019c50: 6275 6666 6572 2220 6872 6566 3d22 2350  buffer" href="#P
-00019c60: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
-00019c70: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
-00019c80: 6578 7447 656e 6572 6174 6f72 2e61 6464  extGenerator.add
-00019c90: 5f74 6f5f 6275 6666 6572 223e 6164 645f  _to_buffer">add_
-00019ca0: 746f 5f62 7566 6665 723c 2f61 3e3c 2f63  to_buffer</a></c
-00019cb0: 6f64 653e 3c2f 6c69 3e0a 3c6c 693e 3c63  ode></li>.<li><c
-00019cc0: 6f64 653e 3c61 2074 6974 6c65 3d22 5064  ode><a title="Pd
-00019cd0: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
-00019ce0: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
-00019cf0: 7874 4765 6e65 7261 746f 722e 6275 696c  xtGenerator.buil
-00019d00: 645f 636f 6e74 6578 745f 666f 725f 636f  d_context_for_co
-00019d10: 6e66 6975 6775 7261 7469 6f6e 2220 6872  nfiuguration" hr
-00019d20: 6566 3d22 2350 646d 436f 6e74 6578 742e  ef="#PdmContext.
-00019d30: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
-00019d40: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
-00019d50: 6f72 2e62 7569 6c64 5f63 6f6e 7465 7874  or.build_context
-00019d60: 5f66 6f72 5f63 6f6e 6669 7567 7572 6174  _for_confiugurat
-00019d70: 696f 6e22 3e62 7569 6c64 5f63 6f6e 7465  ion">build_conte
-00019d80: 7874 5f66 6f72 5f63 6f6e 6669 7567 7572  xt_for_confiugur
-00019d90: 6174 696f 6e3c 2f61 3e3c 2f63 6f64 653e  ation</a></code>
-00019da0: 3c2f 6c69 3e0a 3c6c 693e 3c63 6f64 653e  </li>.<li><code>
-00019db0: 3c61 2074 6974 6c65 3d22 5064 6d43 6f6e  <a title="PdmCon
-00019dc0: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
-00019dd0: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
-00019de0: 6e65 7261 746f 722e 6275 696c 645f 636f  nerator.build_co
-00019df0: 6e74 6578 745f 666f 725f 6973 6f6c 6174  ntext_for_isolat
-00019e00: 6564 2220 6872 6566 3d22 2350 646d 436f  ed" href="#PdmCo
-00019e10: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
-00019e20: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
-00019e30: 656e 6572 6174 6f72 2e62 7569 6c64 5f63  enerator.build_c
-00019e40: 6f6e 7465 7874 5f66 6f72 5f69 736f 6c61  ontext_for_isola
-00019e50: 7465 6422 3e62 7569 6c64 5f63 6f6e 7465  ted">build_conte
-00019e60: 7874 5f66 6f72 5f69 736f 6c61 7465 643c  xt_for_isolated<
-00019e70: 2f61 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a  /a></code></li>.
-00019e80: 3c6c 693e 3c63 6f64 653e 3c61 2074 6974  <li><code><a tit
-00019e90: 6c65 3d22 5064 6d43 6f6e 7465 7874 2e43  le="PdmContext.C
-00019ea0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-00019eb0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-00019ec0: 722e 6275 696c 645f 636f 6e74 6578 745f  r.build_context_
-00019ed0: 666f 725f 756e 6976 6172 6961 7465 2220  for_univariate" 
-00019ee0: 6872 6566 3d22 2350 646d 436f 6e74 6578  href="#PdmContex
-00019ef0: 742e 436f 6e74 6578 7447 656e 6572 6174  t.ContextGenerat
-00019f00: 696f 6e2e 436f 6e74 6578 7447 656e 6572  ion.ContextGener
-00019f10: 6174 6f72 2e62 7569 6c64 5f63 6f6e 7465  ator.build_conte
-00019f20: 7874 5f66 6f72 5f75 6e69 7661 7269 6174  xt_for_univariat
-00019f30: 6522 3e62 7569 6c64 5f63 6f6e 7465 7874  e">build_context
-00019f40: 5f66 6f72 5f75 6e69 7661 7269 6174 653c  _for_univariate<
-00019f50: 2f61 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a  /a></code></li>.
-00019f60: 3c6c 693e 3c63 6f64 653e 3c61 2074 6974  <li><code><a tit
-00019f70: 6c65 3d22 5064 6d43 6f6e 7465 7874 2e43  le="PdmContext.C
-00019f80: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-00019f90: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-00019fa0: 722e 6275 696c 645f 7461 7267 6574 5f73  r.build_target_s
-00019fb0: 6572 6965 735f 666f 725f 636f 6e74 6578  eries_for_contex
-00019fc0: 7422 2068 7265 663d 2223 5064 6d43 6f6e  t" href="#PdmCon
-00019fd0: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
-00019fe0: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
-00019ff0: 6e65 7261 746f 722e 6275 696c 645f 7461  nerator.build_ta
-0001a000: 7267 6574 5f73 6572 6965 735f 666f 725f  rget_series_for_
-0001a010: 636f 6e74 6578 7422 3e62 7569 6c64 5f74  context">build_t
-0001a020: 6172 6765 745f 7365 7269 6573 5f66 6f72  arget_series_for
-0001a030: 5f63 6f6e 7465 7874 3c2f 613e 3c2f 636f  _context</a></co
-0001a040: 6465 3e3c 2f6c 693e 0a3c 6c69 3e3c 636f  de></li>.<li><co
-0001a050: 6465 3e3c 6120 7469 746c 653d 2250 646d  de><a title="Pdm
-0001a060: 436f 6e74 6578 742e 436f 6e74 6578 7447  Context.ContextG
-0001a070: 656e 6572 6174 696f 6e2e 436f 6e74 6578  eneration.Contex
-0001a080: 7447 656e 6572 6174 6f72 2e63 616c 6375  tGenerator.calcu
-0001a090: 6c61 7465 5f63 6175 7361 6c69 7479 2220  late_causality" 
-0001a0a0: 6872 6566 3d22 2350 646d 436f 6e74 6578  href="#PdmContex
-0001a0b0: 742e 436f 6e74 6578 7447 656e 6572 6174  t.ContextGenerat
-0001a0c0: 696f 6e2e 436f 6e74 6578 7447 656e 6572  ion.ContextGener
-0001a0d0: 6174 6f72 2e63 616c 6375 6c61 7465 5f63  ator.calculate_c
-0001a0e0: 6175 7361 6c69 7479 223e 6361 6c63 756c  ausality">calcul
-0001a0f0: 6174 655f 6361 7573 616c 6974 793c 2f61  ate_causality</a
-0001a100: 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a 3c6c  ></code></li>.<l
-0001a110: 693e 3c63 6f64 653e 3c61 2074 6974 6c65  i><code><a title
-0001a120: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
-0001a130: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
-0001a140: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
-0001a150: 6361 6c63 756c 6174 655f 6564 6765 7322  calculate_edges"
-0001a160: 2068 7265 663d 2223 5064 6d43 6f6e 7465   href="#PdmConte
-0001a170: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
-0001a180: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
-0001a190: 7261 746f 722e 6361 6c63 756c 6174 655f  rator.calculate_
-0001a1a0: 6564 6765 7322 3e63 616c 6375 6c61 7465  edges">calculate
-0001a1b0: 5f65 6467 6573 3c2f 613e 3c2f 636f 6465  _edges</a></code
-0001a1c0: 3e3c 2f6c 693e 0a3c 6c69 3e3c 636f 6465  ></li>.<li><code
-0001a1d0: 3e3c 6120 7469 746c 653d 2250 646d 436f  ><a title="PdmCo
-0001a1e0: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
-0001a1f0: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
-0001a200: 656e 6572 6174 6f72 2e63 6861 7261 6374  enerator.charact
-0001a210: 6572 697a 655f 6576 656e 745f 636f 6e74  erize_event_cont
-0001a220: 696e 756f 7573 2220 6872 6566 3d22 2350  inuous" href="#P
-0001a230: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
-0001a240: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
-0001a250: 6578 7447 656e 6572 6174 6f72 2e63 6861  extGenerator.cha
-0001a260: 7261 6374 6572 697a 655f 6576 656e 745f  racterize_event_
-0001a270: 636f 6e74 696e 756f 7573 223e 6368 6172  continuous">char
-0001a280: 6163 7465 7269 7a65 5f65 7665 6e74 5f63  acterize_event_c
-0001a290: 6f6e 7469 6e75 6f75 733c 2f61 3e3c 2f63  ontinuous</a></c
-0001a2a0: 6f64 653e 3c2f 6c69 3e0a 3c6c 693e 3c63  ode></li>.<li><c
-0001a2b0: 6f64 653e 3c61 2074 6974 6c65 3d22 5064  ode><a title="Pd
-0001a2c0: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
-0001a2d0: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
-0001a2e0: 7874 4765 6e65 7261 746f 722e 6368 6172  xtGenerator.char
-0001a2f0: 6163 7465 7269 7a65 5f65 7665 6e74 5f65  acterize_event_e
-0001a300: 6467 6522 2068 7265 663d 2223 5064 6d43  dge" href="#PdmC
-0001a310: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
-0001a320: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
-0001a330: 4765 6e65 7261 746f 722e 6368 6172 6163  Generator.charac
-0001a340: 7465 7269 7a65 5f65 7665 6e74 5f65 6467  terize_event_edg
-0001a350: 6522 3e63 6861 7261 6374 6572 697a 655f  e">characterize_
-0001a360: 6576 656e 745f 6564 6765 3c2f 613e 3c2f  event_edge</a></
-0001a370: 636f 6465 3e3c 2f6c 693e 0a3c 6c69 3e3c  code></li>.<li><
-0001a380: 636f 6465 3e3c 6120 7469 746c 653d 2250  code><a title="P
-0001a390: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
-0001a3a0: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
-0001a3b0: 6578 7447 656e 6572 6174 6f72 2e63 6f6c  extGenerator.col
-0001a3c0: 6c65 6374 5f64 6174 6122 2068 7265 663d  lect_data" href=
-0001a3d0: 2223 5064 6d43 6f6e 7465 7874 2e43 6f6e  "#PdmContext.Con
-0001a3e0: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
-0001a3f0: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
-0001a400: 636f 6c6c 6563 745f 6461 7461 223e 636f  collect_data">co
-0001a410: 6c6c 6563 745f 6461 7461 3c2f 613e 3c2f  llect_data</a></
-0001a420: 636f 6465 3e3c 2f6c 693e 0a3c 6c69 3e3c  code></li>.<li><
-0001a430: 636f 6465 3e3c 6120 7469 746c 653d 2250  code><a title="P
-0001a440: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
-0001a450: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
-0001a460: 6578 7447 656e 6572 6174 6f72 2e63 7265  extGenerator.cre
-0001a470: 6174 655f 636f 6e74 6578 7422 2068 7265  ate_context" hre
-0001a480: 663d 2223 5064 6d43 6f6e 7465 7874 2e43  f="#PdmContext.C
-0001a490: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
-0001a4a0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
-0001a4b0: 722e 6372 6561 7465 5f63 6f6e 7465 7874  r.create_context
-0001a4c0: 223e 6372 6561 7465 5f63 6f6e 7465 7874  ">create_context
-0001a4d0: 3c2f 613e 3c2f 636f 6465 3e3c 2f6c 693e  </a></code></li>
-0001a4e0: 0a3c 6c69 3e3c 636f 6465 3e3c 6120 7469  .<li><code><a ti
-0001a4f0: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
-0001a500: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
-0001a510: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
-0001a520: 6f72 2e63 7265 6174 655f 636f 6e74 696e  or.create_contin
-0001a530: 756f 7573 5f72 6570 7265 7365 6e74 6174  uous_representat
-0001a540: 696f 6e22 2068 7265 663d 2223 5064 6d43  ion" href="#PdmC
-0001a550: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
-0001a560: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
-0001a570: 4765 6e65 7261 746f 722e 6372 6561 7465  Generator.create
-0001a580: 5f63 6f6e 7469 6e75 6f75 735f 7265 7072  _continuous_repr
-0001a590: 6573 656e 7461 7469 6f6e 223e 6372 6561  esentation">crea
-0001a5a0: 7465 5f63 6f6e 7469 6e75 6f75 735f 7265  te_continuous_re
-0001a5b0: 7072 6573 656e 7461 7469 6f6e 3c2f 613e  presentation</a>
-0001a5c0: 3c2f 636f 6465 3e3c 2f6c 693e 0a3c 6c69  </code></li>.<li
-0001a5d0: 3e3c 636f 6465 3e3c 6120 7469 746c 653d  ><code><a title=
-0001a5e0: 2250 646d 436f 6e74 6578 742e 436f 6e74  "PdmContext.Cont
-0001a5f0: 6578 7447 656e 6572 6174 696f 6e2e 436f  extGeneration.Co
-0001a600: 6e74 6578 7447 656e 6572 6174 6f72 2e63  ntextGenerator.c
-0001a610: 7265 6174 655f 696e 7465 7270 7265 7461  reate_interpreta
-0001a620: 7469 6f6e 2220 6872 6566 3d22 2350 646d  tion" href="#Pdm
-0001a630: 436f 6e74 6578 742e 436f 6e74 6578 7447  Context.ContextG
-0001a640: 656e 6572 6174 696f 6e2e 436f 6e74 6578  eneration.Contex
-0001a650: 7447 656e 6572 6174 6f72 2e63 7265 6174  tGenerator.creat
-0001a660: 655f 696e 7465 7270 7265 7461 7469 6f6e  e_interpretation
-0001a670: 223e 6372 6561 7465 5f69 6e74 6572 7072  ">create_interpr
-0001a680: 6574 6174 696f 6e3c 2f61 3e3c 2f63 6f64  etation</a></cod
-0001a690: 653e 3c2f 6c69 3e0a 3c6c 693e 3c63 6f64  e></li>.<li><cod
-0001a6a0: 653e 3c61 2074 6974 6c65 3d22 5064 6d43  e><a title="PdmC
-0001a6b0: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
-0001a6c0: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
-0001a6d0: 4765 6e65 7261 746f 722e 6765 6e65 7261  Generator.genera
-0001a6e0: 7465 5f63 6f6e 7465 7874 2220 6872 6566  te_context" href
-0001a6f0: 3d22 2350 646d 436f 6e74 6578 742e 436f  ="#PdmContext.Co
-0001a700: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
-0001a710: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
-0001a720: 2e67 656e 6572 6174 655f 636f 6e74 6578  .generate_contex
-0001a730: 7422 3e67 656e 6572 6174 655f 636f 6e74  t">generate_cont
-0001a740: 6578 743c 2f61 3e3c 2f63 6f64 653e 3c2f  ext</a></code></
-0001a750: 6c69 3e0a 3c6c 693e 3c63 6f64 653e 3c61  li>.<li><code><a
-0001a760: 2074 6974 6c65 3d22 5064 6d43 6f6e 7465   title="PdmConte
-0001a770: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
-0001a780: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
-0001a790: 7261 746f 722e 6765 745f 6368 6172 6163  rator.get_charac
-0001a7a0: 7465 7269 7a61 7469 6f6e 2220 6872 6566  terization" href
-0001a7b0: 3d22 2350 646d 436f 6e74 6578 742e 436f  ="#PdmContext.Co
-0001a7c0: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
-0001a7d0: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
-0001a7e0: 2e67 6574 5f63 6861 7261 6374 6572 697a  .get_characteriz
-0001a7f0: 6174 696f 6e22 3e67 6574 5f63 6861 7261  ation">get_chara
-0001a800: 6374 6572 697a 6174 696f 6e3c 2f61 3e3c  cterization</a><
-0001a810: 2f63 6f64 653e 3c2f 6c69 3e0a 3c6c 693e  /code></li>.<li>
-0001a820: 3c63 6f64 653e 3c61 2074 6974 6c65 3d22  <code><a title="
-0001a830: 5064 6d43 6f6e 7465 7874 2e43 6f6e 7465  PdmContext.Conte
-0001a840: 7874 4765 6e65 7261 7469 6f6e 2e43 6f6e  xtGeneration.Con
-0001a850: 7465 7874 4765 6e65 7261 746f 722e 696e  textGenerator.in
-0001a860: 7465 7270 7265 7422 2068 7265 663d 2223  terpret" href="#
-0001a870: 5064 6d43 6f6e 7465 7874 2e43 6f6e 7465  PdmContext.Conte
-0001a880: 7874 4765 6e65 7261 7469 6f6e 2e43 6f6e  xtGeneration.Con
-0001a890: 7465 7874 4765 6e65 7261 746f 722e 696e  textGenerator.in
-0001a8a0: 7465 7270 7265 7422 3e69 6e74 6572 7072  terpret">interpr
-0001a8b0: 6574 3c2f 613e 3c2f 636f 6465 3e3c 2f6c  et</a></code></l
-0001a8c0: 693e 0a3c 6c69 3e3c 636f 6465 3e3c 6120  i>.<li><code><a 
-0001a8d0: 7469 746c 653d 2250 646d 436f 6e74 6578  title="PdmContex
-0001a8e0: 742e 436f 6e74 6578 7447 656e 6572 6174  t.ContextGenerat
-0001a8f0: 696f 6e2e 436f 6e74 6578 7447 656e 6572  ion.ContextGener
-0001a900: 6174 6f72 2e70 6c6f 7422 2068 7265 663d  ator.plot" href=
-0001a910: 2223 5064 6d43 6f6e 7465 7874 2e43 6f6e  "#PdmContext.Con
-0001a920: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
-0001a930: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
-0001a940: 706c 6f74 223e 706c 6f74 3c2f 613e 3c2f  plot">plot</a></
-0001a950: 636f 6465 3e3c 2f6c 693e 0a3c 6c69 3e3c  code></li>.<li><
-0001a960: 636f 6465 3e3c 6120 7469 746c 653d 2250  code><a title="P
-0001a970: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
-0001a980: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
-0001a990: 6578 7447 656e 6572 6174 6f72 2e70 6c6f  extGenerator.plo
-0001a9a0: 745f 696e 7465 7270 7265 7461 7469 6f6e  t_interpretation
-0001a9b0: 2220 6872 6566 3d22 2350 646d 436f 6e74  " href="#PdmCont
-0001a9c0: 6578 742e 436f 6e74 6578 7447 656e 6572  ext.ContextGener
-0001a9d0: 6174 696f 6e2e 436f 6e74 6578 7447 656e  ation.ContextGen
-0001a9e0: 6572 6174 6f72 2e70 6c6f 745f 696e 7465  erator.plot_inte
-0001a9f0: 7270 7265 7461 7469 6f6e 223e 706c 6f74  rpretation">plot
-0001aa00: 5f69 6e74 6572 7072 6574 6174 696f 6e3c  _interpretation<
-0001aa10: 2f61 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a  /a></code></li>.
-0001aa20: 3c2f 756c 3e0a 3c2f 6c69 3e0a 3c2f 756c  </ul>.</li>.</ul
-0001aa30: 3e0a 3c2f 6c69 3e0a 3c2f 756c 3e0a 3c2f  >.</li>.</ul>.</
-0001aa40: 6e61 763e 0a3c 2f6d 6169 6e3e 0a3c 666f  nav>.</main>.<fo
-0001aa50: 6f74 6572 2069 643d 2266 6f6f 7465 7222  oter id="footer"
-0001aa60: 3e0a 3c70 3e47 656e 6572 6174 6564 2062  >.<p>Generated b
-0001aa70: 7920 3c61 2068 7265 663d 2268 7474 7073  y <a href="https
-0001aa80: 3a2f 2f70 646f 6333 2e67 6974 6875 622e  ://pdoc3.github.
-0001aa90: 696f 2f70 646f 6322 2074 6974 6c65 3d22  io/pdoc" title="
-0001aaa0: 7064 6f63 3a20 5079 7468 6f6e 2041 5049  pdoc: Python API
-0001aab0: 2064 6f63 756d 656e 7461 7469 6f6e 2067   documentation g
-0001aac0: 656e 6572 6174 6f72 223e 3c63 6974 653e  enerator"><cite>
-0001aad0: 7064 6f63 3c2f 6369 7465 3e20 302e 3130  pdoc</cite> 0.10
-0001aae0: 2e30 3c2f 613e 2e3c 2f70 3e0a 3c2f 666f  .0</a>.</p>.</fo
-0001aaf0: 6f74 6572 3e0a 3c2f 626f 6479 3e0a 3c2f  oter>.</body>.</
-0001ab00: 6874 6d6c 3e                             html>
+0000b500: 7365 6c66 2e68 6f72 697a 6f6e 5f74 696d  self.horizon_tim
+0000b510: 6520 3d20 636f 6e74 6578 745f 686f 7269  e = context_hori
+0000b520: 7a6f 6e2e 7370 6c69 7428 2623 3334 3b20  zon.split(&#34; 
+0000b530: 2623 3334 3b29 5b31 5d0a 2020 2020 2020  &#34;)[1].      
+0000b540: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0000b550: 2020 2020 2020 2020 2020 2020 6173 7365              asse
+0000b560: 7274 2046 616c 7365 2c20 2623 3334 3b54  rt False, &#34;T
+0000b570: 696d 6520 686f 7269 7a6f 6e20 6d75 7374  ime horizon must
+0000b580: 2062 6520 6569 7468 6572 2061 2073 696e   be either a sin
+0000b590: 676c 6520 6e75 6d62 6572 206f 7220 696e  gle number or in
+0000b5a0: 2066 6f72 6d20 6f66 205c 2623 3334 3b38   form of \&#34;8
+0000b5b0: 2068 6f75 7273 5c26 2333 343b 2077 6865   hours\&#34; whe
+0000b5c0: 7265 2061 6363 6570 7461 626c 6520 7469  re acceptable ti
+0000b5d0: 6d65 2066 7261 6d65 7320 6172 6520 686f  me frames are ho
+0000b5e0: 7572 732c 6461 7973 2c6d 696e 7574 6573  urs,days,minutes
+0000b5f0: 2c73 6563 6f6e 6473 2623 3334 3b0a 0a20  ,seconds&#34;.. 
+0000b600: 2020 2020 2020 2073 656c 662e 686f 7269         self.hori
+0000b610: 7a6f 6e20 3d20 696e 7428 7365 6c66 2e68  zon = int(self.h
+0000b620: 6f72 697a 6f6e 290a 2020 2020 2020 2020  orizon).        
+0000b630: 7365 6c66 2e69 6e74 6572 7072 6574 5f68  self.interpret_h
+0000b640: 6973 746f 7279 5f70 6f73 203d 2030 0a20  istory_pos = 0. 
+0000b650: 2020 2020 2020 2073 656c 662e 636f 6e74         self.cont
+0000b660: 6578 745f 706f 7320 3d20 300a 0a20 2020  ext_pos = 0..   
+0000b670: 2064 6566 2063 6f6c 6c65 6374 5f64 6174   def collect_dat
+0000b680: 6128 7365 6c66 2c20 7469 6d65 7374 616d  a(self, timestam
+0000b690: 702c 2073 6f75 7263 652c 206e 616d 652c  p, source, name,
+0000b6a0: 2076 616c 7565 3d4e 6f6e 652c 2074 7970   value=None, typ
+0000b6b0: 653d 2623 3334 3b55 6e69 7661 7269 6174  e=&#34;Univariat
+0000b6c0: 6526 2333 343b 2c72 6570 6c61 6365 3d5b  e&#34;,replace=[
+0000b6d0: 5d29 3a0a 2020 2020 2020 2020 2623 3339  ]):.        &#39
+0000b6e0: 3b26 2333 393b 2623 3339 3b0a 2020 2020  ;&#39;&#39;.    
+0000b6f0: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+0000b700: 6973 2075 7365 6420 7768 656e 2064 6174  is used when dat
+0000b710: 6120 6172 6520 7061 7373 6564 2069 7465  a are passed ite
+0000b720: 7261 7469 7665 6c79 2c20 616e 6420 7374  ratively, and st
+0000b730: 6f72 6564 2069 6e20 6275 6666 6572 0a20  ored in buffer. 
+0000b740: 2020 2020 2020 2057 6865 6e20 6461 7461         When data
+0000b750: 206f 6620 7461 7267 6574 2073 6f75 7263   of target sourc
+0000b760: 6520 6172 7269 7665 2c20 6120 636f 7272  e arrive, a corr
+0000b770: 6573 706f 6e64 696e 6720 636f 6e74 6578  esponding contex
+0000b780: 7420 6973 2070 726f 6475 6365 642e 0a20  t is produced.. 
+0000b790: 2020 2020 2020 2053 6f75 7263 6573 2063         Sources c
+0000b7a0: 616e 2062 6520 6f66 2064 6966 6665 7265  an be of differe
+0000b7b0: 6e74 2073 616d 706c 6520 7261 7465 2028  nt sample rate (
+0000b7c0: 616c 6c20 736f 7572 6365 7320 6172 6520  all sources are 
+0000b7d0: 6d61 7070 6564 2074 6f20 7468 6520 7461  mapped to the ta
+0000b7e0: 7267 6574 7320 7361 6d70 6c65 2072 6174  rgets sample rat
+0000b7f0: 6520 7768 656e 2063 6f6e 7465 7874 2069  e when context i
+0000b800: 7320 7072 6f64 7563 6564 290a 0a20 2020  s produced)..   
+0000b810: 2020 2020 2053 6f75 7263 6573 2063 616e       Sources can
+0000b820: 2062 6520 6f66 2065 6974 6865 723a 0a0a   be of either:..
+0000b830: 2020 2020 2020 2020 3129 2043 6f6e 7469          1) Conti
+0000b840: 6e75 6f75 7320 7479 7065 2028 7468 6f73  nuous type (thos
+0000b850: 6520 7468 6174 2068 6176 6520 736f 6d65  e that have some
+0000b860: 206b 696e 6420 6f66 2061 7269 7468 6d65   kind of arithme
+0000b870: 7469 6320 7661 6c75 6529 0a0a 2020 2020  tic value)..    
+0000b880: 2020 2020 3229 2044 6973 6372 6574 6520      2) Discrete 
+0000b890: 6576 656e 7473 2028 7769 7468 6f75 7420  events (without 
+0000b8a0: 7661 6c75 6529 202c 2077 6865 7265 206f  value) , where o
+0000b8b0: 6e65 206f 6620 7468 6520 7479 7065 2069  ne of the type i
+0000b8c0: 736f 6c61 7465 6420 6f72 2063 6f6e 6669  solated or confi
+0000b8d0: 6775 7261 7469 6f6e 206d 7573 7420 6265  guration must be
+0000b8e0: 2061 7373 6967 6e65 640a 2020 2020 2020   assigned.      
+0000b8f0: 2020 2020 2020 4120 6775 6964 6520 6f6e        A guide on
+0000b900: 2068 6f77 2074 6f20 7370 6563 6966 7920   how to specify 
+0000b910: 7468 6520 7479 7065 2069 732c 2074 6861  the type is, tha
+0000b920: 7420 6576 656e 7473 2077 6869 6368 2061  t events which a
+0000b930: 7373 756d 6564 2074 6f20 6861 7665 2069  ssumed to have i
+0000b940: 6d70 6163 7420 6f6e 6c79 206f 6e20 7468  mpact only on th
+0000b950: 6569 7220 6f63 6375 7272 656e 6365 2c20  eir occurrence, 
+0000b960: 6172 6520 6361 6c6c 6564 0a20 2020 2020  are called.     
+0000b970: 2020 2020 2020 2069 736f 6c61 7465 642c         isolated,
+0000b980: 2077 6869 6c65 206f 7468 6572 7320 7468   while others th
+0000b990: 6174 2061 7265 2072 656c 6174 6564 2074  at are related t
+0000b9a0: 6f20 736f 6d65 206b 696e 6420 6f66 2063  o some kind of c
+0000b9b0: 6f6e 6669 6775 7261 7469 6f6e 2077 6974  onfiguration wit
+0000b9c0: 6820 6d6f 7265 2070 6572 6d61 6e65 6e74  h more permanent
+0000b9d0: 2069 6d70 6163 742c 2061 7265 2063 616c   impact, are cal
+0000b9e0: 6c65 6420 636f 6e66 6967 7572 6174 696f  led configuratio
+0000b9f0: 6e2e 0a20 2020 2020 2020 2020 2020 2045  n..            E
+0000ba00: 7373 656e 7469 616c 6c79 2074 6865 2074  ssentially the t
+0000ba10: 7970 6520 6f66 2074 6865 2065 7665 6e74  ype of the event
+0000ba20: 7320 6465 6669 6e65 2074 6865 2077 6179  s define the way
+0000ba30: 2074 6861 7420 7769 6c6c 2062 6520 7472   that will be tr
+0000ba40: 616e 7366 6f72 6d65 6420 746f 2072 6561  ansformed to rea
+0000ba50: 6c20 7661 6c75 6573 2074 696d 652d 7365  l values time-se
+0000ba60: 7269 6573 2e0a 0a20 2020 2020 2020 202a  ries...        *
+0000ba70: 2a50 6172 616d 6574 6572 732a 2a3a 0a0a  *Parameters**:..
+0000ba80: 2020 2020 2020 2020 2a2a 7469 6d65 7374          **timest
+0000ba90: 616d 702a 2a3a 2020 5468 6520 7469 6d65  amp**:  The time
+0000baa0: 7374 616d 7020 6f66 2074 6865 2061 7272  stamp of the arr
+0000bab0: 6976 6564 2076 616c 7565 0a0a 2020 2020  ived value..    
+0000bac0: 2020 2020 2a2a 736f 7572 6365 2a2a 3a20      **source**: 
+0000bad0: 5468 6520 736f 7572 6365 206f 6620 7468  The source of th
+0000bae0: 6520 6172 7269 7665 6420 7661 6c75 650a  e arrived value.
+0000baf0: 0a20 2020 2020 2020 202a 2a6e 616d 652a  .        **name*
+0000bb00: 2a3a 2054 6865 206e 616d 6520 286f 7220  *: The name (or 
+0000bb10: 6964 656e 7469 6669 6572 2920 6f66 2074  identifier) of t
+0000bb20: 6865 2061 7272 6976 6564 2076 616c 7565  he arrived value
+0000bb30: 0a0a 2020 2020 2020 2020 2a2a 7661 6c75  ..        **valu
+0000bb40: 652a 2a3a 2054 6865 2076 616c 7565 2028  e**: The value (
+0000bb50: 666c 6f61 7429 2c20 696e 2063 6173 6520  float), in case 
+0000bb60: 7468 6973 2069 7320 4e6f 6e65 2074 6865  this is None the
+0000bb70: 2061 7272 6976 6564 2064 6174 6120 6973   arrived data is
+0000bb80: 2063 6f6e 7369 6465 7265 6420 6173 2065   considered as e
+0000bb90: 7665 6e74 0a0a 2020 2020 2020 2020 2a2a  vent..        **
+0000bba0: 7479 7065 2a2a 3a20 7468 6520 7479 7065  type**: the type
+0000bbb0: 206f 6620 7468 6520 6461 7461 2063 616e   of the data can
+0000bbc0: 2062 6520 6f6e 6520 6f66 2026 2333 343b   be one of &#34;
+0000bbd0: 6973 6f6c 6174 6564 2623 3334 3b2c 2623  isolated&#34;,&#
+0000bbe0: 3334 3b63 6f6e 6669 6775 7261 7469 6f6e  34;configuration
+0000bbf0: 2623 3334 3b20 7768 656e 206e 6f20 7661  &#34; when no va
+0000bc00: 6c75 6520 6973 2070 6173 7365 640a 0a20  lue is passed.. 
+0000bc10: 2020 2020 2020 202a 2a72 6570 6c61 6365         **replace
+0000bc20: 2a2a 3a20 6120 6c69 7374 206f 6620 7475  **: a list of tu
+0000bc30: 706c 6573 2c20 7768 6963 6820 6465 6669  ples, which defi
+0000bc40: 6e65 2061 2072 6570 6c61 6365 6d65 6e74  ne a replacement
+0000bc50: 2070 6f6c 6963 792e 2049 6620 6120 7475   policy. If a tu
+0000bc60: 706c 6520 2865 2c62 2920 6578 6973 7420  ple (e,b) exist 
+0000bc70: 696e 2072 6570 6c61 6365 206c 6973 742c  in replace list,
+0000bc80: 2074 6865 6e0a 2020 2020 2020 2020 7768   then.        wh
+0000bc90: 656e 2061 2062 2065 7665 6e74 2069 7320  en a b event is 
+0000bca0: 696e 7365 7274 6564 2c20 6974 2077 696c  inserted, it wil
+0000bcb0: 6c20 7265 706c 6163 6520 616e 2065 2065  l replace an e e
+0000bcc0: 7665 6e74 2077 6974 6820 7468 6520 7361  vent with the sa
+0000bcd0: 6d65 2074 696d 6573 7461 6d70 2028 6966  me timestamp (if
+0000bce0: 2065 7869 7374 7329 2e0a 0a20 2020 2020   exists)...     
+0000bcf0: 2020 202a 2a72 6574 7572 6e2a 2a3a 2020     **return**:  
+0000bd00: 7374 7275 6374 7572 652e 436f 6e74 6578  structure.Contex
+0000bd10: 7420 6f62 6a65 6374 2077 6865 6e20 7468  t object when th
+0000bd20: 6520 6461 7461 206e 616d 6520 6d61 7463  e data name matc
+0000bd30: 6820 746f 2074 6865 2074 6172 6765 7420  h to the target 
+0000bd40: 6e61 6d65 206f 7220 4e6f 6e65 2e0a 2020  name or None..  
+0000bd50: 2020 2020 2020 2623 3339 3b26 2333 393b        &#39;&#39;
+0000bd60: 2623 3339 3b0a 0a20 2020 2020 2020 2069  &#39;..        i
+0000bd70: 6620 7661 6c75 6520 6973 204e 6f6e 653a  f value is None:
+0000bd80: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000bd90: 7479 7065 206e 6f74 2069 6e20 5b26 2333  type not in [&#3
+0000bda0: 343b 6973 6f6c 6174 6564 2623 3334 3b2c  4;isolated&#34;,
+0000bdb0: 2026 2333 343b 636f 6e66 6967 7572 6174   &#34;configurat
+0000bdc0: 696f 6e26 2333 343b 5d3a 0a20 2020 2020  ion&#34;]:.     
+0000bdd0: 2020 2020 2020 2020 2020 2061 7373 6572             asser
+0000bde0: 7420 4661 6c73 652c 2026 2333 343b 5468  t False, &#34;Th
+0000bdf0: 6520 7479 7065 206d 7573 7420 6265 2064  e type must be d
+0000be00: 6566 696e 6564 2061 7320 6f6e 6520 6f66  efined as one of
+0000be10: 205c 2623 3334 3b69 736f 6c61 7465 645c   \&#34;isolated\
+0000be20: 2623 3334 3b20 616e 6420 5c26 2333 343b  &#34; and \&#34;
+0000be30: 636f 6e66 6967 7572 6174 696f 6e5c 2623  configuration\&#
+0000be40: 3334 3b20 7768 656e 206e 6f20 7661 6c75  34; when no valu
+0000be50: 6520 6973 2070 6173 7365 6426 2333 343b  e is passed&#34;
+0000be60: 0a20 2020 2020 2020 2065 7665 6e74 706f  .        eventpo
+0000be70: 696e 7420 3d20 4576 656e 7470 6f69 6e74  int = Eventpoint
+0000be80: 2863 6f64 653d 6e61 6d65 2c20 736f 7572  (code=name, sour
+0000be90: 6365 3d73 6f75 7263 652c 2074 696d 6573  ce=source, times
+0000bea0: 7461 6d70 3d74 696d 6573 7461 6d70 2c20  tamp=timestamp, 
+0000beb0: 6465 7461 696c 733d 7661 6c75 652c 2074  details=value, t
+0000bec0: 7970 653d 7479 7065 290a 2020 2020 2020  ype=type).      
+0000bed0: 2020 7365 6c66 2e61 6464 5f74 6f5f 6275    self.add_to_bu
+0000bee0: 6666 6572 2865 7665 6e74 706f 696e 742c  ffer(eventpoint,
+0000bef0: 7265 706c 6163 6529 0a20 2020 2020 2020  replace).       
+0000bf00: 2069 6620 7365 6c66 2e74 6172 6765 7420   if self.target 
+0000bf10: 3d3d 206e 616d 6520 6f72 2073 656c 662e  == name or self.
+0000bf20: 7461 7267 6574 203d 3d20 6626 2333 343b  target == f&#34;
+0000bf30: 7b6e 616d 657d 407b 736f 7572 6365 7d26  {name}@{source}&
+0000bf40: 2333 343b 3a0a 2020 2020 2020 2020 2020  #34;:.          
+0000bf50: 2020 636f 6e74 6578 746f 626a 6563 7420    contextobject 
+0000bf60: 3d20 7365 6c66 2e67 656e 6572 6174 655f  = self.generate_
+0000bf70: 636f 6e74 6578 7428 653d 6576 656e 7470  context(e=eventp
+0000bf80: 6f69 6e74 2c20 6275 6666 6572 3d73 656c  oint, buffer=sel
+0000bf90: 662e 6275 6666 6572 290a 2020 2020 2020  f.buffer).      
+0000bfa0: 2020 2020 2020 7265 7475 726e 2063 6f6e        return con
+0000bfb0: 7465 7874 6f62 6a65 6374 0a20 2020 2020  textobject.     
+0000bfc0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+0000bfd0: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
+0000bfe0: 0a0a 2020 2020 6465 6620 6164 645f 746f  ..    def add_to
+0000bff0: 5f62 7566 6665 7228 7365 6c66 2c20 653a  _buffer(self, e:
+0000c000: 2045 7665 6e74 706f 696e 742c 2072 6570   Eventpoint, rep
+0000c010: 6c61 6365 3a20 6c69 7374 293a 0a20 2020  lace: list):.   
+0000c020: 2020 2020 2026 2333 343b 2623 3334 3b26       &#34;&#34;&
+0000c030: 2333 343b 0a20 2020 2020 2020 2041 6464  #34;.        Add
+0000c040: 7320 616e 2045 7665 6e74 2070 6f69 6e74  s an Event point
+0000c050: 2074 6f20 7468 6520 6275 6666 6572 2028   to the buffer (
+0000c060: 6b65 6570 696e 6720 7468 6520 6275 6666  keeping the buff
+0000c070: 6572 2074 696d 6520 6f72 6465 7265 6429  er time ordered)
+0000c080: 0a20 2020 2020 2020 2026 2333 343b 2623  .        &#34;&#
+0000c090: 3334 3b26 2333 343b 0a20 2020 2020 2020  34;&#34;.       
+0000c0a0: 2069 6e64 6578 203d 206c 656e 2873 656c   index = len(sel
+0000c0b0: 662e 6275 6666 6572 290a 2020 2020 2020  f.buffer).      
+0000c0c0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
+0000c0d0: 286c 656e 2873 656c 662e 6275 6666 6572  (len(self.buffer
+0000c0e0: 2920 2d20 312c 2030 2c20 2d31 293a 0a20  ) - 1, 0, -1):. 
+0000c0f0: 2020 2020 2020 2020 2020 2023 2063 6865             # che
+0000c100: 636b 2066 6f72 2072 6570 6c61 6365 6d65  ck for replaceme
+0000c110: 6e74 0a20 2020 2020 2020 2020 2020 2069  nt.            i
+0000c120: 6620 7365 6c66 2e62 7566 6665 725b 695d  f self.buffer[i]
+0000c130: 2e74 696d 6573 7461 6d70 203d 3d20 652e  .timestamp == e.
+0000c140: 7469 6d65 7374 616d 703a 0a20 2020 2020  timestamp:.     
+0000c150: 2020 2020 2020 2020 2020 2066 6f72 2072             for r
+0000c160: 6570 2069 6e20 7265 706c 6163 653a 0a20  ep in replace:. 
+0000c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c180: 2020 2069 6620 7365 6c66 2e62 7566 6665     if self.buffe
+0000c190: 725b 695d 2e63 6f64 653d 3d72 6570 5b30  r[i].code==rep[0
+0000c1a0: 5d20 616e 6420 652e 636f 6465 3d3d 7265  ] and e.code==re
+0000c1b0: 705b 315d 3a0a 2020 2020 2020 2020 2020  p[1]:.          
+0000c1c0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0000c1d0: 6c66 2e62 7566 6665 725b 695d 3d65 0a20  lf.buffer[i]=e. 
+0000c1e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c1f0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+0000c200: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0000c210: 6465 7820 3d20 6920 2b20 310a 2020 2020  dex = i + 1.    
+0000c220: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0000c230: 6275 6666 6572 5b69 5d2e 7469 6d65 7374  buffer[i].timest
+0000c240: 616d 7020 266c 743b 2065 2e74 696d 6573  amp &lt; e.times
+0000c250: 7461 6d70 3a0a 2020 2020 2020 2020 2020  tamp:.          
+0000c260: 2020 2020 2020 696e 6465 7820 3d20 6920        index = i 
+0000c270: 2b20 310a 2020 2020 2020 2020 2020 2020  + 1.            
+0000c280: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
+0000c290: 2020 6966 2069 6e64 6578 203d 3d20 6c65    if index == le
+0000c2a0: 6e28 7365 6c66 2e62 7566 6665 7229 3a0a  n(self.buffer):.
+0000c2b0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000c2c0: 2e62 7566 6665 722e 6170 7065 6e64 2865  .buffer.append(e
+0000c2d0: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0000c2e0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000c2f0: 2e62 7566 6665 7220 3d20 7365 6c66 2e62  .buffer = self.b
+0000c300: 7566 6665 725b 3a20 696e 6465 785d 202b  uffer[: index] +
+0000c310: 205b 655d 202b 2073 656c 662e 6275 6666   [e] + self.buff
+0000c320: 6572 5b69 6e64 6578 3a5d 0a0a 2020 2020  er[index:]..    
+0000c330: 2020 2020 6c61 7374 203d 2073 656c 662e      last = self.
+0000c340: 6275 6666 6572 5b2d 315d 0a20 2020 2020  buffer[-1].     
+0000c350: 2020 2070 6f73 203d 206c 656e 2873 656c     pos = len(sel
+0000c360: 662e 6275 6666 6572 2920 2d20 310a 2020  f.buffer) - 1.  
+0000c370: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0000c380: 616e 6765 286c 656e 2873 656c 662e 6275  ange(len(self.bu
+0000c390: 6666 6572 2929 3a0a 2020 2020 2020 2020  ffer)):.        
+0000c3a0: 2020 2020 6966 2073 656c 662e 6275 6666      if self.buff
+0000c3b0: 6572 5b69 5d2e 7469 6d65 7374 616d 7020  er[i].timestamp 
+0000c3c0: 2667 743b 3d20 286c 6173 742e 7469 6d65  &gt;= (last.time
+0000c3d0: 7374 616d 7020 2d20 7064 2e54 696d 6564  stamp - pd.Timed
+0000c3e0: 656c 7461 2873 656c 662e 686f 7269 7a6f  elta(self.horizo
+0000c3f0: 6e2c 2073 656c 662e 686f 7269 7a6f 6e5f  n, self.horizon_
+0000c400: 7469 6d65 2929 3a0a 2020 2020 2020 2020  time)):.        
+0000c410: 2020 2020 2020 2020 706f 7320 3d20 690a          pos = i.
+0000c420: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c430: 6272 6561 6b0a 2020 2020 2020 2020 7365  break.        se
+0000c440: 6c66 2e62 7566 6665 7220 3d20 7365 6c66  lf.buffer = self
+0000c450: 2e62 7566 6665 725b 706f 733a 5d0a 0a20  .buffer[pos:].. 
+0000c460: 2020 2064 6566 2067 656e 6572 6174 655f     def generate_
+0000c470: 636f 6e74 6578 7428 7365 6c66 2c20 653a  context(self, e:
+0000c480: 2045 7665 6e74 706f 696e 742c 2062 7566   Eventpoint, buf
+0000c490: 6665 7229 3a0a 2020 2020 2020 2020 2623  fer):.        &#
+0000c4a0: 3334 3b26 2333 343b 2623 3334 3b0a 2020  34;&#34;&#34;.  
+0000c4b0: 2020 2020 2020 4765 6e65 7261 7465 2063        Generate c
+0000c4c0: 6f6e 7465 7874 2061 6e64 2069 6e74 6572  ontext and inter
+0000c4d0: 7072 6574 6174 696f 6e2e 0a0a 2020 2020  pretation...    
+0000c4e0: 2020 2020 2a2a 5061 7261 6d65 7465 7273      **Parameters
+0000c4f0: 2a2a 3a0a 0a20 2020 2020 2020 202a 2a65  **:..        **e
+0000c500: 2a2a 3a20 4576 656e 7470 6f69 6e74 2072  **: Eventpoint r
+0000c510: 656c 6174 6564 2074 6f20 7468 6520 6c61  elated to the la
+0000c520: 7374 2074 6172 6765 7426 2333 393b 7320  st target&#39;s 
+0000c530: 6461 7461 2e0a 0a20 2020 2020 2020 202a  data...        *
+0000c540: 2a62 7566 6665 722a 2a3a 2041 206c 6973  *buffer**: A lis
+0000c550: 7420 7769 7468 2061 6c6c 2045 7665 6e74  t with all Event
+0000c560: 706f 696e 7473 2069 6e20 7468 6520 7469  points in the ti
+0000c570: 6d65 2068 6f72 697a 6f6e 0a20 2020 2020  me horizon.     
+0000c580: 2020 2026 2333 343b 2623 3334 3b26 2333     &#34;&#34;&#3
+0000c590: 343b 0a0a 2020 2020 2020 2020 636f 6e74  4;..        cont
+0000c5a0: 6578 7463 7572 7265 6e74 2c20 7461 7267  extcurrent, targ
+0000c5b0: 6574 5f73 6572 6965 735f 6e61 6d65 203d  et_series_name =
+0000c5c0: 2073 656c 662e 6372 6561 7465 5f63 6f6e   self.create_con
+0000c5d0: 7465 7874 2865 2c20 6275 6666 6572 290a  text(e, buffer).
+0000c5e0: 0a20 2020 2020 2020 2073 656c 662e 636f  .        self.co
+0000c5f0: 6e74 6578 7473 2e61 7070 656e 6428 636f  ntexts.append(co
+0000c600: 6e74 6578 7463 7572 7265 6e74 290a 2020  ntextcurrent).  
+0000c610: 2020 2020 2020 7365 6c66 2e63 7265 6174        self.creat
+0000c620: 655f 696e 7465 7270 7265 7461 7469 6f6e  e_interpretation
+0000c630: 2863 6f6e 7465 7874 6375 7272 656e 742c  (contextcurrent,
+0000c640: 2074 6172 6765 745f 7365 7269 6573 5f6e   target_series_n
+0000c650: 616d 6529 0a0a 2020 2020 2020 2020 696e  ame)..        in
+0000c660: 7465 7274 7570 7320 3d20 5b74 7474 7570  tertups = [tttup
+0000c670: 2066 6f72 2074 7474 7570 2069 6e0a 2020   for tttup in.  
+0000c680: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c690: 2020 2073 656c 662e 636f 6e74 6578 7473     self.contexts
+0000c6a0: 5b2d 315d 2e43 525b 2623 3334 3b69 6e74  [-1].CR[&#34;int
+0000c6b0: 6572 7072 6574 6174 696f 6e26 2333 343b  erpretation&#34;
+0000c6c0: 5d5d 0a20 2020 2020 2020 2023 2074 6869  ]].        # thi
+0000c6d0: 7320 6973 2075 7365 6675 6c6c 2066 6f72  s is usefull for
+0000c6e0: 2070 6c6f 7469 6e67 0a20 2020 2020 2020   ploting.       
+0000c6f0: 2073 656c 662e 636f 6e74 6578 7473 5b2d   self.contexts[-
+0000c700: 315d 2e43 525b 2623 3334 3b69 6e74 6572  1].CR[&#34;inter
+0000c710: 7072 6574 6174 696f 6e26 2333 343b 5d20  pretation&#34;] 
+0000c720: 3d20 696e 7465 7274 7570 730a 0a20 2020  = intertups..   
+0000c730: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000c740: 2e63 6f6e 7465 7874 735b 2d31 5d0a 0a20  .contexts[-1].. 
+0000c750: 2020 2064 6566 2063 7265 6174 655f 696e     def create_in
+0000c760: 7465 7270 7265 7461 7469 6f6e 2873 656c  terpretation(sel
+0000c770: 662c 2063 6f6e 7465 7874 6375 7272 656e  f, contextcurren
+0000c780: 743a 2043 6f6e 7465 7874 2c20 7461 7267  t: Context, targ
+0000c790: 6574 5f73 6572 6965 735f 6e61 6d65 293a  et_series_name):
+0000c7a0: 0a20 2020 2020 2020 2026 2333 343b 2623  .        &#34;&#
+0000c7b0: 3334 3b26 2333 343b 0a20 2020 2020 2020  34;&#34;.       
+0000c7c0: 2054 6869 7320 6d65 7468 6f64 2063 6f6c   This method col
+0000c7d0: 6c65 6374 2061 6c6c 2074 6865 2063 6f6e  lect all the con
+0000c7e0: 7465 7874 7320 696e 2074 6865 2068 6f72  texts in the hor
+0000c7f0: 697a 6f6e 2061 6e64 2063 616c 6c73 2074  izon and calls t
+0000c800: 6865 2069 6e74 6572 7072 6574 6174 696f  he interpretatio
+0000c810: 6e20 6d65 7468 6f64 2e0a 0a20 2020 2020  n method...     
+0000c820: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
+0000c830: 2a3a 0a0a 2020 2020 2020 2020 2a2a 636f  *:..        **co
+0000c840: 6e74 6578 7463 7572 7265 6e74 2a2a 3a20  ntextcurrent**: 
+0000c850: 5468 6520 436f 6e74 6578 7420 666f 7220  The Context for 
+0000c860: 7768 6963 6820 7468 6520 696e 7465 7270  which the interp
+0000c870: 7265 7461 7469 6f6e 2069 7320 6361 6c63  retation is calc
+0000c880: 756c 6174 6564 0a0a 2020 2020 2020 2020  ulated..        
+0000c890: 2a2a 7461 7267 6574 5f73 6572 6965 735f  **target_series_
+0000c8a0: 6e61 6d65 2a2a 3a20 5468 656e 206e 616d  name**: Then nam
+0000c8b0: 6520 6f66 2074 6865 2074 6172 6765 7420  e of the target 
+0000c8c0: 7661 7269 6162 6c65 0a20 2020 2020 2020  variable.       
+0000c8d0: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
+0000c8e0: 0a0a 2020 2020 2020 2020 7269 6b69 636f  ..        rikico
+0000c8f0: 6e74 6578 7420 3d20 7365 6c66 2e63 6f6e  ntext = self.con
+0000c900: 7465 7874 730a 2020 2020 2020 2020 706f  texts.        po
+0000c910: 7320 3d20 7365 6c66 2e69 6e74 6572 7072  s = self.interpr
+0000c920: 6574 5f68 6973 746f 7279 5f70 6f73 0a20  et_history_pos. 
+0000c930: 2020 2020 2020 2074 656d 7070 6f73 203d         temppos =
+0000c940: 2070 6f73 0a20 2020 2020 2020 2066 6f72   pos.        for
+0000c950: 2071 2069 6e20 7261 6e67 6528 706f 732c   q in range(pos,
+0000c960: 206c 656e 2872 696b 6963 6f6e 7465 7874   len(rikicontext
+0000c970: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+0000c980: 7465 6d70 706f 7320 3d20 710a 2020 2020  temppos = q.    
+0000c990: 2020 2020 2020 2020 6966 2070 642e 746f          if pd.to
+0000c9a0: 5f64 6174 6574 696d 6528 7269 6b69 636f  _datetime(rikico
+0000c9b0: 6e74 6578 745b 715d 2e74 696d 6573 7461  ntext[q].timesta
+0000c9c0: 6d70 2920 2667 743b 3d20 280a 2020 2020  mp) &gt;= (.    
+0000c9d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c9e0: 7064 2e74 6f5f 6461 7465 7469 6d65 2863  pd.to_datetime(c
+0000c9f0: 6f6e 7465 7874 6375 7272 656e 742e 7469  ontextcurrent.ti
+0000ca00: 6d65 7374 616d 7029 202d 2070 642e 5469  mestamp) - pd.Ti
+0000ca10: 6d65 6465 6c74 6128 7365 6c66 2e68 6f72  medelta(self.hor
+0000ca20: 697a 6f6e 2c20 7365 6c66 2e68 6f72 697a  izon, self.horiz
+0000ca30: 6f6e 5f74 696d 6529 293a 0a20 2020 2020  on_time)):.     
+0000ca40: 2020 2020 2020 2020 2020 2062 7265 616b             break
+0000ca50: 0a20 2020 2020 2020 2063 6175 7365 7377  .        causesw
+0000ca60: 696e 646f 7720 3d20 7269 6b69 636f 6e74  indow = rikicont
+0000ca70: 6578 745b 7465 6d70 706f 733a 5d0a 2020  ext[temppos:].  
+0000ca80: 2020 2020 2020 7365 6c66 2e69 6e74 6572        self.inter
+0000ca90: 7072 6574 5f68 6973 746f 7279 5f70 6f73  pret_history_pos
+0000caa0: 203d 2074 656d 7070 6f73 0a20 2020 2020   = temppos.     
+0000cab0: 2020 2069 6e74 6572 7072 203d 2073 656c     interpr = sel
+0000cac0: 662e 696e 7465 7270 7265 7428 636f 6e74  f.interpret(cont
+0000cad0: 6578 7463 7572 7265 6e74 2c20 6361 7573  extcurrent, caus
+0000cae0: 6573 7769 6e64 6f77 2c20 7461 7267 6574  eswindow, target
+0000caf0: 5f73 6572 6965 735f 6e61 6d65 2c20 7365  _series_name, se
+0000cb00: 6c66 2e74 7970 655f 6f66 5f73 6572 6965  lf.type_of_serie
+0000cb10: 7329 0a20 2020 2020 2020 2073 656c 662e  s).        self.
+0000cb20: 636f 6e74 6578 7473 5b2d 315d 2e43 525b  contexts[-1].CR[
+0000cb30: 2623 3334 3b69 6e74 6572 7072 6574 6174  &#34;interpretat
+0000cb40: 696f 6e26 2333 343b 5d20 3d20 696e 7465  ion&#34;] = inte
+0000cb50: 7270 720a 0a20 2020 2064 6566 2069 6e74  rpr..    def int
+0000cb60: 6572 7072 6574 2873 656c 662c 2063 6f6e  erpret(self, con
+0000cb70: 7465 7874 3a20 436f 6e74 6578 742c 2063  text: Context, c
+0000cb80: 6175 7365 7377 696e 646f 772c 2074 6172  auseswindow, tar
+0000cb90: 6765 742c 2074 7970 655f 6f66 5f73 6572  get, type_of_ser
+0000cba0: 6965 7329 3a0a 2020 2020 2020 2020 2623  ies):.        &#
+0000cbb0: 3334 3b26 2333 343b 2623 3334 3b0a 2020  34;&#34;&#34;.  
+0000cbc0: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
+0000cbd0: 6420 656e 6861 6e63 6520 7468 6520 4352  d enhance the CR
+0000cbe0: 2070 6172 7420 6f66 2074 6865 2043 6f6e   part of the Con
+0000cbf0: 7465 7874 2077 6974 6820 696e 7465 7270  text with interp
+0000cc00: 7265 7461 7469 6f6e 2072 656c 6174 696e  retation relatin
+0000cc10: 6720 746f 2074 6865 2074 6172 6765 7420  g to the target 
+0000cc20: 7661 7269 6162 6c65 2e0a 2020 2020 2020  variable..      
+0000cc30: 2020 5468 6520 696e 7465 7270 7265 7461    The interpreta
+0000cc40: 7469 6f6e 2061 7265 2062 6173 6564 206f  tion are based o
+0000cc50: 6e20 7468 6520 6564 6765 7320 6578 7472  n the edges extr
+0000cc60: 6163 7465 6420 6672 6f6d 2074 6865 2043  acted from the C
+0000cc70: 6173 7561 6c74 7920 6469 7363 6f76 6572  asualty discover
+0000cc80: 792e 0a20 2020 2020 2020 2046 6f72 2065  y..        For e
+0000cc90: 6163 6820 6564 6765 206f 6620 7479 7065  ach edge of type
+0000cca0: 2028 7365 7269 6573 4120 2d26 6774 3b20   (seriesA -&gt; 
+0000ccb0: 7461 7267 6574 2920 696e 2074 6865 2065  target) in the e
+0000ccc0: 6467 6573 2077 6520 7465 7374 2069 6620  dges we test if 
+0000ccd0: 7468 6520 7365 7269 6573 4120 696e 7465  the seriesA inte
+0000cce0: 7270 7265 7473 0a20 2020 2020 2020 2074  rprets.        t
+0000ccf0: 6865 2074 6172 6765 7420 7573 696e 6720  he target using 
+0000cd00: 7468 6520 666f 6c6c 6f77 696e 6720 7275  the following ru
+0000cd10: 6c65 733a 0a0a 2020 2020 2020 2020 2a2a  les:..        **
+0000cd20: 6966 2073 6572 6965 7341 2069 7320 6973  if seriesA is is
+0000cd30: 6f6c 6174 6564 2a2a 3a20 5765 2063 6865  olated**: We che
+0000cd40: 636b 2069 6620 6974 7320 6c61 7374 206f  ck if its last o
+0000cd50: 6363 7572 7265 6e63 6520 6973 2074 6865  ccurrence is the
+0000cd60: 2063 7572 7265 6e74 2074 696d 6573 7461   current timesta
+0000cd70: 6d70 206f 7220 7468 6520 7072 6576 696f  mp or the previo
+0000cd80: 7573 206f 6e65 2e0a 0a20 2020 2020 2020  us one...       
+0000cd90: 202a 2a69 6620 7365 7269 6573 4120 6973   **if seriesA is
+0000cda0: 2063 6f6e 6669 6775 7261 7469 6f6e 2a2a   configuration**
+0000cdb0: 3a20 5765 2063 6865 636b 2069 6620 7468  : We check if th
+0000cdc0: 6520 6564 6765 7320 2873 6572 6965 7341  e edges (seriesA
+0000cdd0: 202d 2667 743b 2074 6172 6765 7429 2061   -&gt; target) a
+0000cde0: 7070 6561 7273 0a20 2020 2020 2020 2069  ppears.        i
+0000cdf0: 6e20 6174 206c 6561 7374 2038 3025 2063  n at least 80% c
+0000ce00: 6f6e 7465 7874 7320 696e 2074 6865 2068  ontexts in the h
+0000ce10: 6f72 697a 6f6e 2028 692e 652e 2069 6e20  orizon (i.e. in 
+0000ce20: 6361 7573 6573 7769 6e64 6f77 206c 6973  causeswindow lis
+0000ce30: 7429 2e0a 0a20 2020 2020 2020 202a 2a69  t)...        **i
+0000ce40: 6620 7365 7269 6573 4120 6973 2063 6f6e  f seriesA is con
+0000ce50: 7469 6e75 6f75 732a 2a3a 2054 6865 6e20  tinuous**: Then 
+0000ce60: 7468 6174 206d 6561 6e73 2074 6865 2074  that means the t
+0000ce70: 6172 6765 7420 6973 2072 656c 6174 6564  arget is related
+0000ce80: 2077 6974 6820 7365 7269 6573 410a 2020   with seriesA.  
+0000ce90: 2020 2020 2020 616e 6420 7765 2061 6464        and we add
+0000cea0: 2069 7420 746f 2074 6865 2069 6e74 6572   it to the inter
+0000ceb0: 7072 6574 6174 696f 6e2e 0a0a 2020 2020  pretation...    
+0000cec0: 2020 2020 416c 6c20 7468 6520 696e 7465      All the inte
+0000ced0: 7270 7265 7461 7469 6f6e 7320 6172 6520  rpretations are 
+0000cee0: 7461 6767 6564 2077 6974 6820 6120 7469  tagged with a ti
+0000cef0: 6d65 7374 616d 7020 7768 6963 6820 7265  mestamp which re
+0000cf00: 6665 7273 2074 6f20 7468 6520 6669 7273  fers to the firs
+0000cf10: 7420 7469 6d65 0a20 2020 2020 2020 206f  t time.        o
+0000cf20: 6620 6170 7065 6172 656e 7365 206f 6620  f appearense of 
+0000cf30: 636f 6e73 6563 7574 6976 6520 696e 7465  consecutive inte
+0000cf40: 7270 7265 7461 7469 6f6e 732e 2054 6865  rpretations. The
+0000cf50: 6e20 7468 6520 696e 7465 7270 7265 7461  n the interpreta
+0000cf60: 7469 6f6e 2061 7265 2073 6f72 7465 6420  tion are sorted 
+0000cf70: 7573 696e 670a 2020 2020 2020 2020 7468  using.        th
+0000cf80: 6973 2074 696d 6573 7461 6d70 2e20 5468  is timestamp. Th
+0000cf90: 6973 2069 7320 646f 6e65 2074 6f20 7072  is is done to pr
+0000cfa0: 6f76 6964 6520 6120 6869 6572 6172 6368  ovide a hierarch
+0000cfb0: 7920 746f 2074 6865 2069 6e74 6572 7072  y to the interpr
+0000cfc0: 6574 6174 696f 6e20 7369 6e63 6520 6974  etation since it
+0000cfd0: 206d 6179 2062 6520 7468 6520 6361 7365   may be the case
+0000cfe0: 2c0a 2020 2020 2020 2020 7468 6174 2077  ,.        that w
+0000cff0: 6865 6e20 7365 7269 6573 4120 6361 7573  hen seriesA caus
+0000d000: 6520 7461 7267 6574 202c 2061 6e64 2053  e target , and S
+0000d010: 6572 6965 7342 2063 6175 7365 2074 6172  eriesB cause tar
+0000d020: 6765 742c 2074 6865 206f 6c64 6573 7420  get, the oldest 
+0000d030: 6f6e 6520 6973 2073 7472 6f6e 6765 7220  one is stronger 
+0000d040: 7369 6e63 6520 7468 6520 5365 7269 6573  since the Series
+0000d050: 4220 6d61 7920 6265 0a20 2020 2020 2020  B may be.       
+0000d060: 2065 6666 6563 7420 6f66 2073 6572 6965   effect of serie
+0000d070: 7341 2e0a 0a20 2020 2020 2020 202a 2a50  sA...        **P
+0000d080: 6172 616d 6574 6572 732a 2a3a 0a0a 2020  arameters**:..  
+0000d090: 2020 2020 2020 2a2a 636f 6e74 6578 742a        **context*
+0000d0a0: 2a3a 2043 6f6e 7465 7874 204f 626a 6563  *: Context Objec
+0000d0b0: 7420 746f 2062 6520 696e 7465 7270 7265  t to be interpre
+0000d0c0: 7465 640a 0a20 2020 2020 2020 202a 2a63  ted..        **c
+0000d0d0: 6175 7365 7377 696e 646f 772a 2a3a 206c  auseswindow**: l
+0000d0e0: 6973 7420 7769 7468 2074 6865 206c 6173  ist with the las
+0000d0f0: 7420 686f 7269 7a6f 6e20 636f 6e74 6578  t horizon contex
+0000d100: 7473 0a0a 2020 2020 2020 2020 2a2a 7461  ts..        **ta
+0000d110: 7267 6574 2a2a 3a20 7468 6520 6e61 6d65  rget**: the name
+0000d120: 206f 6620 7468 6520 7461 7267 6574 2076   of the target v
+0000d130: 6172 6961 626c 6520 746f 2069 6e74 6572  ariable to inter
+0000d140: 7072 6574 0a0a 2020 2020 2020 2020 2a2a  pret..        **
+0000d150: 7479 7065 5f6f 665f 7365 7269 6573 2a2a  type_of_series**
+0000d160: 3a20 6469 6374 696f 6e61 7279 2077 6869  : dictionary whi
+0000d170: 6368 2064 6566 696e 6520 7468 6520 7479  ch define the ty
+0000d180: 7065 206f 6620 6561 6368 2073 6572 6965  pe of each serie
+0000d190: 7320 2869 736f 6c61 7465 642c 636f 6e66  s (isolated,conf
+0000d1a0: 6967 7572 6174 696f 6e20 6f72 2063 6f6e  iguration or con
+0000d1b0: 7469 6e75 6f75 7329 0a20 2020 2020 2020  tinuous).       
+0000d1c0: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
+0000d1d0: 0a0a 2020 2020 2020 2020 7061 6972 7320  ..        pairs 
+0000d1e0: 3d20 5b28 7061 6972 5b30 5d2c 2070 6169  = [(pair[0], pai
+0000d1f0: 725b 315d 2c20 6361 7229 2066 6f72 2070  r[1], car) for p
+0000d200: 6169 722c 2063 6172 2069 6e20 7a69 7028  air, car in zip(
+0000d210: 636f 6e74 6578 742e 4352 5b26 2333 393b  context.CR[&#39;
+0000d220: 6564 6765 7326 2333 393b 5d2c 2063 6f6e  edges&#39;], con
+0000d230: 7465 7874 2e43 525b 2623 3339 3b63 6861  text.CR[&#39;cha
+0000d240: 7261 6374 6572 697a 6174 696f 6e26 2333  racterization&#3
+0000d250: 393b 5d29 2069 660a 2020 2020 2020 2020  9;]) if.        
+0000d260: 2020 2020 2020 2020 2074 6172 6765 7420           target 
+0000d270: 696e 2070 6169 725b 315d 5d0a 0a20 2020  in pair[1]]..   
+0000d280: 2020 2020 2023 2070 6169 7273 686f 7032       # pairshop2
+0000d290: 203d 205b 5d0a 2020 2020 2020 2020 2320   = [].        # 
+0000d2a0: 696e 7465 726d 6564 6961 7465 733d 5b70  intermediates=[p
+0000d2b0: 6169 725b 305d 2066 6f72 2070 6169 7220  air[0] for pair 
+0000d2c0: 696e 2070 6169 7273 5d0a 2020 2020 2020  in pairs].      
+0000d2d0: 2020 2320 616c 6c6f 7468 6573 3d5b 7061    # allothes=[pa
+0000d2e0: 6972 2066 6f72 2070 6169 7220 696e 2063  ir for pair in c
+0000d2f0: 6f6e 7465 7874 2e43 442e 6b65 7973 2829  ontext.CD.keys()
+0000d300: 2069 6620 7061 6972 206e 6f74 2069 6e20   if pair not in 
+0000d310: 696e 7465 726d 6564 6961 7465 735d 0a20  intermediates]. 
+0000d320: 2020 2020 2020 2023 0a20 2020 2020 2020         #.       
+0000d330: 2023 2066 6f72 2069 6e74 6572 5f70 6169   # for inter_pai
+0000d340: 7220 696e 2069 6e74 6572 6d65 6469 6174  r in intermediat
+0000d350: 6573 3a0a 2020 2020 2020 2020 2320 2020  es:.        #   
+0000d360: 2020 666f 7220 6e61 6d65 2069 6e20 616c    for name in al
+0000d370: 6c6f 7468 6573 3a0a 2020 2020 2020 2020  lothes:.        
+0000d380: 2320 2020 2020 2020 2020 6966 2028 6e61  #         if (na
+0000d390: 6d65 2c69 6e74 6572 5f70 6169 7229 2069  me,inter_pair) i
+0000d3a0: 6e20 636f 6e74 6578 742e 4352 5b26 2333  n context.CR[&#3
+0000d3b0: 343b 6564 6765 7326 2333 343b 5d3a 0a20  4;edges&#34;]:. 
+0000d3c0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
+0000d3d0: 2020 2020 2070 6169 7273 686f 7032 2e61       pairshop2.a
+0000d3e0: 7070 656e 6428 286e 616d 652c 696e 7465  ppend((name,inte
+0000d3f0: 725f 7061 6972 2929 0a0a 2020 2020 2020  r_pair))..      
+0000d400: 2020 696e 7465 7270 7265 7461 7469 6f6e    interpretation
+0000d410: 203d 205b 5d0a 2020 2020 2020 2020 7479   = [].        ty
+0000d420: 7065 636f 6e65 6374 696f 6e20 3d20 5b5d  peconection = []
+0000d430: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000d440: 7061 6972 7329 203d 3d20 303a 0a20 2020  pairs) == 0:.   
+0000d450: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0000d460: 5b5d 0a20 2020 2020 2020 2066 6f72 2070  [].        for p
+0000d470: 6169 7220 696e 2070 6169 7273 3a0a 2020  air in pairs:.  
+0000d480: 2020 2020 2020 2020 2020 6966 2074 7970            if typ
+0000d490: 655f 6f66 5f73 6572 6965 735b 7061 6972  e_of_series[pair
+0000d4a0: 5b30 5d5d 203d 3d20 2623 3334 3b69 736f  [0]] == &#34;iso
+0000d4b0: 6c61 7465 6426 2333 343b 3a0a 2020 2020  lated&#34;:.    
+0000d4c0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0000d4d0: 6573 3120 3d20 636f 6e74 6578 742e 4344  es1 = context.CD
+0000d4e0: 5b70 6169 725b 305d 5d0a 2020 2020 2020  [pair[0]].      
+0000d4f0: 2020 2020 2020 2020 2020 6966 2076 616c            if val
+0000d500: 7565 7331 5b2d 315d 203d 3d20 313a 0a20  ues1[-1] == 1:. 
+0000d510: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d520: 2020 2069 6e74 6572 7072 6574 6174 696f     interpretatio
+0000d530: 6e2e 6170 7065 6e64 2828 7061 6972 5b30  n.append((pair[0
+0000d540: 5d2c 2070 6169 725b 315d 2c20 7061 6972  ], pair[1], pair
+0000d550: 5b32 5d2c 2063 6f6e 7465 7874 2e74 696d  [2], context.tim
+0000d560: 6573 7461 6d70 2929 0a20 2020 2020 2020  estamp)).       
+0000d570: 2020 2020 2020 2020 2065 6c69 6620 7661           elif va
+0000d580: 6c75 6573 315b 2d32 5d20 3d3d 2031 3a0a  lues1[-2] == 1:.
+0000d590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d5a0: 2020 2020 7465 6d70 7469 6d65 7374 616d      temptimestam
+0000d5b0: 7020 3d20 636f 6e74 6578 742e 7469 6d65  p = context.time
+0000d5c0: 7374 616d 700a 2020 2020 2020 2020 2020  stamp.          
+0000d5d0: 2020 2020 2020 2020 2020 6c61 7374 636f            lastco
+0000d5e0: 6e74 6578 7420 3d20 7365 6c66 2e63 6f6e  ntext = self.con
+0000d5f0: 7465 7874 735b 6d61 7828 6c65 6e28 7365  texts[max(len(se
+0000d600: 6c66 2e63 6f6e 7465 7874 7329 202d 2032  lf.contexts) - 2
+0000d610: 2c20 3029 5d0a 2020 2020 2020 2020 2020  , 0)].          
+0000d620: 2020 2020 2020 2020 2020 666f 7220 696e            for in
+0000d630: 7465 7270 6169 7220 696e 206c 6173 7463  terpair in lastc
+0000d640: 6f6e 7465 7874 2e43 525b 2623 3334 3b69  ontext.CR[&#34;i
+0000d650: 6e74 6572 7072 6574 6174 696f 6e26 2333  nterpretation&#3
+0000d660: 343b 5d3a 0a20 2020 2020 2020 2020 2020  4;]:.           
+0000d670: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+0000d680: 696e 7465 7270 6169 725b 305d 203d 3d20  interpair[0] == 
+0000d690: 7061 6972 5b30 5d20 616e 6420 696e 7465  pair[0] and inte
+0000d6a0: 7270 6169 725b 315d 203d 3d20 7061 6972  rpair[1] == pair
+0000d6b0: 5b31 5d3a 0a20 2020 2020 2020 2020 2020  [1]:.           
+0000d6c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d6d0: 2074 656d 7074 696d 6573 7461 6d70 203d   temptimestamp =
+0000d6e0: 2069 6e74 6572 7061 6972 5b33 5d0a 2020   interpair[3].  
+0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d700: 2020 696e 7465 7270 7265 7461 7469 6f6e    interpretation
+0000d710: 2e61 7070 656e 6428 2870 6169 725b 305d  .append((pair[0]
+0000d720: 2c20 7061 6972 5b31 5d2c 2070 6169 725b  , pair[1], pair[
+0000d730: 325d 2c20 7465 6d70 7469 6d65 7374 616d  2], temptimestam
+0000d740: 7029 290a 2020 2020 2020 2020 2020 2020  p)).            
+0000d750: 656c 6966 2074 7970 655f 6f66 5f73 6572  elif type_of_ser
+0000d760: 6965 735b 7061 6972 5b30 5d5d 203d 3d20  ies[pair[0]] == 
+0000d770: 2623 3334 3b63 6f6e 6669 6775 7261 7469  &#34;configurati
+0000d780: 6f6e 2623 3334 3b3a 0a20 2020 2020 2020  on&#34;:.       
+0000d790: 2020 2020 2020 2020 2076 616c 7565 7331           values1
+0000d7a0: 203d 2063 6f6e 7465 7874 2e43 445b 7061   = context.CD[pa
+0000d7b0: 6972 5b30 5d5d 0a20 2020 2020 2020 2020  ir[0]].         
+0000d7c0: 2020 2020 2020 206f 6363 7572 656e 6365         occurence
+0000d7d0: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+0000d7e0: 2020 2020 2066 6f72 2071 2069 6e20 7261       for q in ra
+0000d7f0: 6e67 6528 6c65 6e28 7661 6c75 6573 3129  nge(len(values1)
+0000d800: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
+0000d810: 2020 2020 2020 2069 6620 7661 6c75 6573         if values
+0000d820: 315b 715d 203d 3d20 7661 6c75 6573 315b  1[q] == values1[
+0000d830: 2d31 5d20 616e 6420 7661 6c75 6573 315b  -1] and values1[
+0000d840: 715d 2026 6774 3b20 303a 0a20 2020 2020  q] &gt; 0:.     
+0000d850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d860: 2020 206f 6363 7572 656e 6365 203d 2071     occurence = q
+0000d870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d880: 2020 2020 2020 2020 2062 7265 616b 0a20           break. 
+0000d890: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000d8a0: 6620 6f63 6375 7265 6e63 6520 3d3d 206c  f occurence == l
+0000d8b0: 656e 2876 616c 7565 7331 2920 2d20 313a  en(values1) - 1:
+0000d8c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d8d0: 2020 2020 2069 6e74 6572 7072 6574 6174       interpretat
+0000d8e0: 696f 6e2e 6170 7065 6e64 2828 7061 6972  ion.append((pair
+0000d8f0: 5b30 5d2c 2070 6169 725b 315d 2c20 7061  [0], pair[1], pa
+0000d900: 6972 5b32 5d2c 2063 6f6e 7465 7874 2e74  ir[2], context.t
+0000d910: 696d 6573 7461 6d70 2929 0a20 2020 2020  imestamp)).     
+0000d920: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+0000d930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d940: 2020 2020 206c 6561 6420 3d20 6c65 6e28       lead = len(
+0000d950: 7661 6c75 6573 3129 202d 206f 6363 7572  values1) - occur
+0000d960: 656e 6365 0a20 2020 2020 2020 2020 2020  ence.           
+0000d970: 2020 2020 2020 2020 2063 6f75 6e74 6572           counter
+0000d980: 203d 2030 0a20 2020 2020 2020 2020 2020   = 0.           
+0000d990: 2020 2020 2020 2020 206c 6561 6463 6f6e           leadcon
+0000d9a0: 7465 7874 203d 2063 6175 7365 7377 696e  text = causeswin
+0000d9b0: 646f 775b 2d6c 6561 643a 5d0a 2020 2020  dow[-lead:].    
+0000d9c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d9d0: 666f 7220 636f 6e74 6520 696e 206c 6561  for conte in lea
+0000d9e0: 6463 6f6e 7465 7874 3a0a 2020 2020 2020  dcontext:.      
+0000d9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da00: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+0000da10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da20: 2020 2070 6f73 203d 206c 6973 7428 636f     pos = list(co
+0000da30: 6e74 652e 4352 5b26 2333 343b 6564 6765  nte.CR[&#34;edge
+0000da40: 7326 2333 343b 5d29 2e69 6e64 6578 2828  s&#34;]).index((
+0000da50: 7061 6972 5b30 5d2c 2070 6169 725b 315d  pair[0], pair[1]
+0000da60: 2929 0a20 2020 2020 2020 2020 2020 2020  )).             
+0000da70: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0000da80: 743a 0a20 2020 2020 2020 2020 2020 2020  t:.             
+0000da90: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+0000daa0: 6f73 203d 202d 310a 2020 2020 2020 2020  os = -1.        
+0000dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dac0: 6966 2070 6f73 2021 3d20 2d31 3a0a 2020  if pos != -1:.  
+0000dad0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dae0: 2020 2020 2020 2020 2020 6966 2063 6f6e            if con
+0000daf0: 7465 2e43 525b 2623 3334 3b63 6861 7261  te.CR[&#34;chara
+0000db00: 6374 6572 697a 6174 696f 6e26 2333 343b  cterization&#34;
+0000db10: 5d5b 706f 735d 203d 3d20 7061 6972 5b32  ][pos] == pair[2
+0000db20: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0000db30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db40: 2020 2063 6f75 6e74 6572 202b 3d20 310a     counter += 1.
+0000db50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000db60: 2020 2020 6966 2063 6f75 6e74 6572 2026      if counter &
+0000db70: 6774 3b3d 2030 2e38 202a 206c 6561 643a  gt;= 0.8 * lead:
+0000db80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000db90: 2020 2020 2020 2020 2074 656d 7074 696d           temptim
+0000dba0: 6573 7461 6d70 203d 2063 6f6e 7465 7874  estamp = context
+0000dbb0: 2e74 696d 6573 7461 6d70 0a20 2020 2020  .timestamp.     
+0000dbc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dbd0: 2020 206c 6173 7463 6f6e 7465 7874 203d     lastcontext =
+0000dbe0: 2073 656c 662e 636f 6e74 6578 7473 5b6d   self.contexts[m
+0000dbf0: 6178 286c 656e 2873 656c 662e 636f 6e74  ax(len(self.cont
+0000dc00: 6578 7473 2920 2d20 322c 2030 295d 0a20  exts) - 2, 0)]. 
+0000dc10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc20: 2020 2020 2020 2066 6f72 2069 6e74 6572         for inter
+0000dc30: 7061 6972 2069 6e20 6c61 7374 636f 6e74  pair in lastcont
+0000dc40: 6578 742e 4352 5b26 2333 343b 696e 7465  ext.CR[&#34;inte
+0000dc50: 7270 7265 7461 7469 6f6e 2623 3334 3b5d  rpretation&#34;]
+0000dc60: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000dc70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0000dc80: 2069 6e74 6572 7061 6972 5b30 5d20 3d3d   interpair[0] ==
+0000dc90: 2070 6169 725b 305d 2061 6e64 2069 6e74   pair[0] and int
+0000dca0: 6572 7061 6972 5b31 5d20 3d3d 2070 6169  erpair[1] == pai
+0000dcb0: 725b 315d 3a0a 2020 2020 2020 2020 2020  r[1]:.          
+0000dcc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dcd0: 2020 2020 2020 7465 6d70 7469 6d65 7374        temptimest
+0000dce0: 616d 7020 3d20 696e 7465 7270 6169 725b  amp = interpair[
+0000dcf0: 335d 0a20 2020 2020 2020 2020 2020 2020  3].             
+0000dd00: 2020 2020 2020 2020 2020 2069 6e74 6572             inter
+0000dd10: 7072 6574 6174 696f 6e2e 6170 7065 6e64  pretation.append
+0000dd20: 2828 7061 6972 5b30 5d2c 2070 6169 725b  ((pair[0], pair[
+0000dd30: 315d 2c20 7061 6972 5b32 5d2c 2074 656d  1], pair[2], tem
+0000dd40: 7074 696d 6573 7461 6d70 2929 0a20 2020  ptimestamp)).   
+0000dd50: 2020 2020 2020 2020 2023 2066 6f72 2072           # for r
+0000dd60: 6561 6c20 7661 6c75 6520 7365 7269 6573  eal value series
+0000dd70: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
+0000dd80: 6620 6c65 6e28 7365 7428 636f 6e74 6578  f len(set(contex
+0000dd90: 742e 4344 5b70 6169 725b 305d 5d29 2920  t.CD[pair[0]])) 
+0000dda0: 2667 743b 2032 3a0a 2020 2020 2020 2020  &gt; 2:.        
+0000ddb0: 2020 2020 2020 2020 7465 6d70 7469 6d65          temptime
+0000ddc0: 7374 616d 7020 3d20 636f 6e74 6578 742e  stamp = context.
+0000ddd0: 7469 6d65 7374 616d 700a 2020 2020 2020  timestamp.      
+0000dde0: 2020 2020 2020 2020 2020 6c61 7374 636f            lastco
+0000ddf0: 6e74 6578 7420 3d20 7365 6c66 2e63 6f6e  ntext = self.con
+0000de00: 7465 7874 735b 6d61 7828 6c65 6e28 7365  texts[max(len(se
+0000de10: 6c66 2e63 6f6e 7465 7874 7329 202d 2032  lf.contexts) - 2
+0000de20: 2c20 3029 5d0a 2020 2020 2020 2020 2020  , 0)].          
+0000de30: 2020 2020 2020 666f 7220 696e 7465 7270        for interp
+0000de40: 6169 7220 696e 206c 6173 7463 6f6e 7465  air in lastconte
+0000de50: 7874 2e43 525b 2623 3334 3b69 6e74 6572  xt.CR[&#34;inter
+0000de60: 7072 6574 6174 696f 6e26 2333 343b 5d3a  pretation&#34;]:
+0000de70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000de80: 2020 2020 2069 6620 696e 7465 7270 6169       if interpai
+0000de90: 725b 305d 203d 3d20 7061 6972 5b30 5d20  r[0] == pair[0] 
+0000dea0: 616e 6420 696e 7465 7270 6169 725b 315d  and interpair[1]
+0000deb0: 203d 3d20 7061 6972 5b31 5d3a 0a20 2020   == pair[1]:.   
+0000dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ded0: 2020 2020 2074 656d 7074 696d 6573 7461       temptimesta
+0000dee0: 6d70 203d 2069 6e74 6572 7061 6972 5b33  mp = interpair[3
+0000def0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
+0000df00: 2020 696e 7465 7270 7265 7461 7469 6f6e    interpretation
+0000df10: 2e61 7070 656e 6428 2870 6169 725b 305d  .append((pair[0]
+0000df20: 2c20 7061 6972 5b31 5d2c 2070 6169 725b  , pair[1], pair[
+0000df30: 325d 2c20 7465 6d70 7469 6d65 7374 616d  2], temptimestam
+0000df40: 7029 290a 2020 2020 2020 2020 2020 2020  p)).            
+0000df50: 2020 2020 636f 6e74 696e 7565 0a20 2020      continue.   
+0000df60: 2020 2020 2023 2073 6f72 7420 7769 7468       # sort with
+0000df70: 2074 696d 650a 2020 2020 2020 2020 6669   time.        fi
+0000df80: 6e74 6572 7072 6574 203d 205b 5d0a 2020  nterpret = [].  
+0000df90: 2020 2020 2020 666f 7220 7061 6972 2069        for pair i
+0000dfa0: 6e20 696e 7465 7270 7265 7461 7469 6f6e  n interpretation
+0000dfb0: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+0000dfc0: 6e74 6572 7072 6574 2e61 7070 656e 6428  nterpret.append(
+0000dfd0: 2870 6169 725b 305d 2c20 7061 6972 5b31  (pair[0], pair[1
+0000dfe0: 5d2c 2070 6169 725b 325d 2c20 7061 6972  ], pair[2], pair
+0000dff0: 5b33 5d29 290a 2020 2020 2020 2020 6669  [3])).        fi
+0000e000: 6e74 6572 7072 6574 2e73 6f72 7428 6b65  nterpret.sort(ke
+0000e010: 793d 6c61 6d62 6461 2074 7570 3a20 7475  y=lambda tup: tu
+0000e020: 705b 335d 2920 2023 2073 6f72 7473 2069  p[3])  # sorts i
+0000e030: 6e20 706c 6163 650a 2020 2020 2020 2020  n place.        
+0000e040: 7265 7475 726e 2066 696e 7465 7270 7265  return finterpre
+0000e050: 740a 0a20 2020 2064 6566 2063 7265 6174  t..    def creat
+0000e060: 655f 636f 6e74 6578 7428 7365 6c66 2c20  e_context(self, 
+0000e070: 6375 7272 656e 743a 2045 7665 6e74 706f  current: Eventpo
+0000e080: 696e 742c 2062 7566 6665 7229 3a0a 2020  int, buffer):.  
+0000e090: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
+0000e0a0: 2623 3334 3b0a 2020 2020 2020 2020 5472  &#34;.        Tr
+0000e0b0: 616e 7366 6f72 6d20 7468 6520 6461 7461  ansform the data
+0000e0c0: 2063 6f6c 6c65 6374 6564 2074 6f20 7468   collected to th
+0000e0d0: 6520 6275 6666 6572 2069 6e20 746f 2073  e buffer in to s
+0000e0e0: 7569 7461 626c 6520 666f 726d 2061 6e64  uitable form and
+0000e0f0: 2067 656e 6572 6174 6573 2074 6865 2043   generates the C
+0000e100: 4420 7061 7274 206f 6620 7468 6520 636f  D part of the co
+0000e110: 6e74 6578 7420 616c 6f6e 6720 7769 7468  ntext along with
+0000e120: 0a20 2020 2020 2020 2074 6865 2065 6467  .        the edg
+0000e130: 6573 2061 6e64 2063 6861 7261 6374 6572  es and character
+0000e140: 697a 6174 696f 6e73 3a0a 0a20 2020 2020  izations:..     
+0000e150: 2020 202a 2a53 7465 7073 3a2a 2a0a 0a20     **Steps:**.. 
+0000e160: 2020 2020 2020 202a 2a43 7265 6174 6520         **Create 
+0000e170: 4344 2a2a 3a20 5061 7261 6c6c 656c 2063  CD**: Parallel c
+0000e180: 6f6e 7469 6e75 6f75 7320 7265 7072 6573  ontinuous repres
+0000e190: 656e 7461 7469 6f6e 7320 6f66 2061 6c6c  entations of all
+0000e1a0: 2064 6966 6665 7265 6e74 2073 6f75 7263   different sourc
+0000e1b0: 6573 2069 6e20 7468 6520 6275 6666 6572  es in the buffer
+0000e1c0: 2e0a 2020 2020 2020 2020 5468 6973 2073  ..        This s
+0000e1d0: 7465 7020 696e 766f 6c76 6573 2c20 6d61  tep involves, ma
+0000e1e0: 7463 6869 6e67 2074 6865 2064 6966 6665  tching the diffe
+0000e1f0: 7265 6e74 2073 616d 706c 6520 7261 7465  rent sample rate
+0000e200: 7320 6f66 2064 6966 6665 7265 6e74 2073  s of different s
+0000e210: 6f75 7263 6573 2074 6f20 7468 6174 206f  ources to that o
+0000e220: 6620 7468 6520 7461 7267 6574 2e0a 2020  f the target..  
+0000e230: 2020 2020 2020 5472 616e 7366 6f72 6d20        Transform 
+0000e240: 7468 6520 4576 656e 7420 736f 7572 6365  the Event source
+0000e250: 7320 746f 2063 6f6e 7469 6e75 6f75 7320  s to continuous 
+0000e260: 7265 7072 6573 656e 7461 7469 6f6e 2e0a  representation..
+0000e270: 2020 2020 2020 2020 0a20 2020 2020 2020          .       
+0000e280: 202a 2a43 616c 6375 6c61 7465 2043 6175   **Calculate Cau
+0000e290: 7361 6c69 7479 2065 6467 6573 2a2a 3a20  sality edges**: 
+0000e2a0: 5065 7266 6f72 6d20 4361 7573 616c 2044  Perform Causal D
+0000e2b0: 6973 636f 7665 7279 2075 7369 6e67 2074  iscovery using t
+0000e2c0: 6865 2063 6175 7361 6c69 7479 2066 756e  he causality fun
+0000e2d0: 6374 696f 6e2c 2074 6f20 6372 6561 7465  ction, to create
+0000e2e0: 2065 6467 6573 200a 2020 2020 2020 2020   edges .        
+0000e2f0: 2870 6172 7420 6f66 2043 5220 6f66 2074  (part of CR of t
+0000e300: 6865 2043 6f6e 7465 7874 290a 2020 2020  he Context).    
+0000e310: 2020 2020 0a20 2020 2020 2020 202a 2a54      .        **T
+0000e320: 6167 2065 6163 6820 6564 6765 2077 6974  ag each edge wit
+0000e330: 6820 6368 6172 6163 7465 7269 7a61 7469  h characterizati
+0000e340: 6f6e 2a2a 3a20 666f 7220 6561 6368 2028  on**: for each (
+0000e350: 612c 6229 2069 6e20 7468 6520 6564 6765  a,b) in the edge
+0000e360: 732c 2061 2063 6861 7261 6374 6572 697a  s, a characteriz
+0000e370: 6174 696f 6e20 6f66 2028 756e 6b6e 6f77  ation of (unknow
+0000e380: 6e2c 2064 6563 7265 6173 652c 0a20 2020  n, decrease,.   
+0000e390: 2020 2020 2020 696e 6372 6561 7365 292c        increase),
+0000e3a0: 2062 6173 6564 206f 6e20 7468 6520 7479   based on the ty
+0000e3b0: 7065 206f 6620 7468 6520 612e 0a0a 2020  pe of the a...  
+0000e3c0: 2020 2020 2020 202a 2a50 6172 616d 6574         **Paramet
+0000e3d0: 6572 732a 2a3a 0a0a 2020 2020 2020 2020  ers**:..        
+0000e3e0: 202a 2a63 7572 7265 6e74 2a2a 3a20 5468   **current**: Th
+0000e3f0: 6520 6375 7272 656e 7420 4576 656e 7420  e current Event 
+0000e400: 6f66 2074 6172 6765 7426 2333 393b 7320  of target&#39;s 
+0000e410: 6461 7461 2077 6869 6368 2074 7269 6765  data which trige
+0000e420: 7220 7468 6520 636f 6e74 6578 7420 6372  r the context cr
+0000e430: 6561 7469 6f6e 0a0a 2020 2020 2020 2020  eation..        
+0000e440: 202a 2a62 7566 6665 722a 2a3a 206f 7264   **buffer**: ord
+0000e450: 6572 6564 206c 6973 7420 7769 7468 2045  ered list with E
+0000e460: 7665 6e74 706f 696e 7420 6f66 2061 6c6c  ventpoint of all
+0000e470: 2073 6f75 7263 6573 2e0a 0a20 2020 2020   sources...     
+0000e480: 2020 2020 2a2a 7265 7475 726e 2a2a 3a20      **return**: 
+0000e490: 436f 6e74 6578 7420 6f62 6a65 6374 2e0a  Context object..
+0000e4a0: 2020 2020 2020 2020 2623 3334 3b26 2333          &#34;&#3
+0000e4b0: 343b 2623 3334 3b0a 2020 2020 2020 2020  4;&#34;.        
+0000e4c0: 2320 7374 6172 7420 3d20 7469 6d65 2e74  # start = time.t
+0000e4d0: 696d 6528 290a 2020 2020 2020 2020 2320  ime().        # 
+0000e4e0: 6466 2077 6974 6820 2c64 742c 636f 6465  df with ,dt,code
+0000e4f0: 2c73 6f75 7263 652c 7661 6c75 650a 2020  ,source,value.  
+0000e500: 2020 2020 2020 706f 7320 3d20 7365 6c66        pos = self
+0000e510: 2e63 6f6e 7465 7874 5f70 6f73 0a20 2020  .context_pos.   
+0000e520: 2020 2020 2066 6f72 2069 2069 6e20 7261       for i in ra
+0000e530: 6e67 6528 706f 732c 206c 656e 2862 7566  nge(pos, len(buf
+0000e540: 6665 7229 293a 0a20 2020 2020 2020 2020  fer)):.         
+0000e550: 2020 2069 6620 6275 6666 6572 5b69 5d2e     if buffer[i].
+0000e560: 7469 6d65 7374 616d 7020 266c 743b 3d20  timestamp &lt;= 
+0000e570: 2863 7572 7265 6e74 2e74 696d 6573 7461  (current.timesta
+0000e580: 6d70 202d 2070 642e 5469 6d65 6465 6c74  mp - pd.Timedelt
+0000e590: 6128 7365 6c66 2e68 6f72 697a 6f6e 2c20  a(self.horizon, 
+0000e5a0: 7365 6c66 2e68 6f72 697a 6f6e 5f74 696d  self.horizon_tim
+0000e5b0: 6529 293a 0a20 2020 2020 2020 2020 2020  e)):.           
+0000e5c0: 2020 2020 2070 6f73 203d 2069 0a20 2020       pos = i.   
+0000e5d0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000e5e0: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0000e5f0: 7265 616b 0a0a 2020 2020 2020 2020 7365  reak..        se
+0000e600: 6c66 2e63 6f6e 7465 7874 5f70 6f73 203d  lf.context_pos =
+0000e610: 2070 6f73 0a20 2020 2020 2020 2023 2065   pos.        # e
+0000e620: 6e64 3d74 696d 652e 7469 6d65 2829 0a20  nd=time.time(). 
+0000e630: 2020 2020 2020 2023 2070 7269 6e74 2866         # print(f
+0000e640: 2623 3334 3b66 696e 6420 706f 7369 7469  &#34;find positi
+0000e650: 6f6e 206f 6e20 6275 6666 6572 3a20 7b65  on on buffer: {e
+0000e660: 6e64 2d73 7461 7274 7d26 2333 343b 290a  nd-start}&#34;).
+0000e670: 0a20 2020 2020 2020 2023 2073 7461 7274  .        # start
+0000e680: 203d 2074 696d 652e 7469 6d65 2829 0a20   = time.time(). 
+0000e690: 2020 2020 2020 2064 6174 6166 6f72 636f         dataforco
+0000e6a0: 6e74 6578 7420 3d20 6275 6666 6572 5b70  ntext = buffer[p
+0000e6b0: 6f73 3a5d 0a20 2020 2020 2020 2064 6174  os:].        dat
+0000e6c0: 6174 6f64 6620 3d20 5b5b 7064 2e74 6f5f  atodf = [[pd.to_
+0000e6d0: 6461 7465 7469 6d65 2865 2e74 696d 6573  datetime(e.times
+0000e6e0: 7461 6d70 2920 666f 7220 6520 696e 2064  tamp) for e in d
+0000e6f0: 6174 6166 6f72 636f 6e74 6578 745d 2c0a  ataforcontext],.
+0000e700: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e710: 2020 2020 5b73 7472 2865 2e63 6f64 6529      [str(e.code)
+0000e720: 2066 6f72 2065 2069 6e20 6461 7461 666f   for e in datafo
+0000e730: 7263 6f6e 7465 7874 5d2c 0a20 2020 2020  rcontext],.     
+0000e740: 2020 2020 2020 2020 2020 2020 2020 205b                 [
+0000e750: 7374 7228 652e 736f 7572 6365 2920 666f  str(e.source) fo
+0000e760: 7220 6520 696e 2064 6174 6166 6f72 636f  r e in dataforco
+0000e770: 6e74 6578 745d 2c0a 2020 2020 2020 2020  ntext],.        
+0000e780: 2020 2020 2020 2020 2020 2020 5b65 2e64              [e.d
+0000e790: 6574 6169 6c73 2066 6f72 2065 2069 6e20  etails for e in 
+0000e7a0: 6461 7461 666f 7263 6f6e 7465 7874 5d2c  dataforcontext],
+0000e7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e7c0: 2020 2020 205b 652e 7479 7065 2066 6f72       [e.type for
+0000e7d0: 2065 2069 6e20 6461 7461 666f 7263 6f6e   e in dataforcon
+0000e7e0: 7465 7874 5d5d 0a0a 2020 2020 2020 2020  text]]..        
+0000e7f0: 6e70 636f 6e74 6578 7420 3d20 6e70 2e61  npcontext = np.a
+0000e800: 7272 6179 2864 6174 6174 6f64 6629 0a20  rray(datatodf). 
+0000e810: 2020 2020 2020 206e 7063 6f6e 7465 7874         npcontext
+0000e820: 203d 206e 7063 6f6e 7465 7874 2e54 0a0a   = npcontext.T..
+0000e830: 2020 2020 2020 2020 6e70 636f 6e74 6578          npcontex
+0000e840: 7420 3d20 7365 6c66 2e4e 756d 7079 5f70  t = self.Numpy_p
+0000e850: 7265 7072 6f63 6365 7373 286e 7063 6f6e  reproccess(npcon
+0000e860: 7465 7874 290a 0a20 2020 2020 2020 2023  text)..        #
+0000e870: 2065 6e64 203d 2074 696d 652e 7469 6d65   end = time.time
+0000e880: 2829 0a20 2020 2020 2020 2023 2070 7269  ().        # pri
+0000e890: 6e74 2866 2623 3334 3b70 7265 7072 6f63  nt(f&#34;preproc
+0000e8a0: 6573 7320 6466 3a20 7b65 6e64 202d 2073  ess df: {end - s
+0000e8b0: 7461 7274 7d26 2333 343b 290a 2020 2020  tart}&#34;).    
+0000e8c0: 2020 2020 2323 2323 2323 2323 2323 2323      ############
+0000e8d0: 2320 6372 6561 7465 2063 6f6e 7465 7874  # create context
+0000e8e0: 2023 2323 2323 2323 2323 2323 2323 2323   ###############
+0000e8f0: 2323 2323 2323 2323 2323 2323 230a 2020  #############.  
+0000e900: 2020 2020 2020 2320 7374 6172 7420 3d20        # start = 
+0000e910: 7469 6d65 2e74 696d 6528 290a 2020 2020  time.time().    
+0000e920: 2020 2020 2323 2063 6f6c 6c65 6374 2075      ## collect u
+0000e930: 6e69 7165 7520 6461 7461 2073 6572 6965  niqeu data serie
+0000e940: 730a 2020 2020 2020 2020 2320 616c 6c63  s.        # allc
+0000e950: 6f64 6573 203d 2064 665b 2623 3339 3b63  odes = df[&#39;c
+0000e960: 6f64 6526 2333 393b 5d2e 756e 6971 7565  ode&#39;].unique
+0000e970: 2829 0a20 2020 2020 2020 2061 6c6c 636f  ().        allco
+0000e980: 6465 7320 3d20 6e70 2e75 6e69 7175 6528  des = np.unique(
+0000e990: 6e70 636f 6e74 6578 745b 3a2c 2031 5d29  npcontext[:, 1])
+0000e9a0: 0a20 2020 2020 2020 2061 6c6c 636f 6465  .        allcode
+0000e9b0: 7320 3d20 5b63 6f64 6520 666f 7220 636f  s = [code for co
+0000e9c0: 6465 2069 6e20 616c 6c63 6f64 6573 5d0a  de in allcodes].
+0000e9d0: 2020 2020 2020 2020 616c 6c63 6f64 6573          allcodes
+0000e9e0: 203d 2073 6574 2861 6c6c 636f 6465 7329   = set(allcodes)
+0000e9f0: 0a0a 2020 2020 2020 2020 666f 7220 756e  ..        for un
+0000ea00: 636f 6465 2069 6e20 616c 6c63 6f64 6573  code in allcodes
+0000ea10: 3a0a 2020 2020 2020 2020 2020 2020 666f  :.            fo
+0000ea20: 7220 7171 2069 6e20 7261 6e67 6528 6c65  r qq in range(le
+0000ea30: 6e28 6e70 636f 6e74 6578 7429 293a 0a20  n(npcontext)):. 
+0000ea40: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000ea50: 6620 756e 636f 6465 2069 6e20 6e70 636f  f uncode in npco
+0000ea60: 6e74 6578 745b 7171 5d5b 315d 3a0a 2020  ntext[qq][1]:.  
+0000ea70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ea80: 2020 7365 6c66 2e74 7970 655f 6f66 5f73    self.type_of_s
+0000ea90: 6572 6965 735b 756e 636f 6465 5d20 3d20  eries[uncode] = 
+0000eaa0: 6e70 636f 6e74 6578 745b 7171 5d5b 345d  npcontext[qq][4]
+0000eab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000eac0: 2020 2020 2062 7265 616b 0a0a 2020 2020       break..    
+0000ead0: 2020 2020 2323 2062 7569 6c64 2074 6172      ## build tar
+0000eae0: 6765 7420 7365 7269 6573 0a20 2020 2020  get series.     
+0000eaf0: 2020 2074 6172 6765 745f 7365 7269 6573     target_series
+0000eb00: 5f6e 616d 652c 2074 6172 6765 745f 7365  _name, target_se
+0000eb10: 7269 6573 203d 2073 656c 662e 6275 696c  ries = self.buil
+0000eb20: 645f 7461 7267 6574 5f73 6572 6965 735f  d_target_series_
+0000eb30: 666f 725f 636f 6e74 6578 7428 6375 7272  for_context(curr
+0000eb40: 656e 742c 206e 7063 6f6e 7465 7874 290a  ent, npcontext).
+0000eb50: 0a20 2020 2020 2020 2023 2320 6372 6561  .        ## crea
+0000eb60: 7465 2073 6572 6965 7320 666f 7220 6561  te series for ea
+0000eb70: 6368 2073 6f75 7263 6520 2861 6c6c 6461  ch source (allda
+0000eb80: 7461 290a 2020 2020 2020 2020 616c 6c64  ta).        alld
+0000eb90: 6174 6120 3d20 7365 6c66 2e63 7265 6174  ata = self.creat
+0000eba0: 655f 636f 6e74 696e 756f 7573 5f72 6570  e_continuous_rep
+0000ebb0: 7265 7365 6e74 6174 696f 6e28 7461 7267  resentation(targ
+0000ebc0: 6574 5f73 6572 6965 735f 6e61 6d65 2c20  et_series_name, 
+0000ebd0: 7461 7267 6574 5f73 6572 6965 732c 206e  target_series, n
+0000ebe0: 7063 6f6e 7465 7874 2c0a 2020 2020 2020  pcontext,.      
+0000ebf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ec20: 2020 7365 6c66 2e74 7970 655f 6f66 5f73    self.type_of_s
+0000ec30: 6572 6965 732c 2061 6c6c 636f 6465 7329  eries, allcodes)
+0000ec40: 0a20 2020 2020 2020 2023 2065 6e64 203d  .        # end =
+0000ec50: 2074 696d 652e 7469 6d65 2829 0a20 2020   time.time().   
+0000ec60: 2020 2020 2023 2070 7269 6e74 2866 2623       # print(f&#
+0000ec70: 3334 3b43 7265 6174 6520 7365 7269 6573  34;Create series
+0000ec80: 3a20 7b65 6e64 2d73 7461 7274 7d26 2333  : {end-start}&#3
+0000ec90: 343b 290a 0a20 2020 2020 2020 2073 746f  4;)..        sto
+0000eca0: 7269 6e67 203d 2073 656c 662e 6361 6c63  ring = self.calc
+0000ecb0: 756c 6174 655f 6564 6765 7328 616c 6c64  ulate_edges(alld
+0000ecc0: 6174 612c 2063 7572 7265 6e74 2e74 696d  ata, current.tim
+0000ecd0: 6573 7461 6d70 290a 2020 2020 2020 2020  estamp).        
+0000ece0: 7374 6f72 696e 675b 2623 3334 3b63 6861  storing[&#34;cha
+0000ecf0: 7261 6374 6572 697a 6174 696f 6e26 2333  racterization&#3
+0000ed00: 343b 5d20 3d20 7365 6c66 2e67 6574 5f63  4;] = self.get_c
+0000ed10: 6861 7261 6374 6572 697a 6174 696f 6e28  haracterization(
+0000ed20: 7374 6f72 696e 6729 0a0a 2020 2020 2020  storing)..      
+0000ed30: 2020 2320 7072 696e 7428 6626 2333 343b    # print(f&#34;
+0000ed40: 4361 6c63 756c 6174 6520 6564 6765 733a  Calculate edges:
+0000ed50: 207b 656e 6420 2d20 7374 6172 747d 2623   {end - start}&#
+0000ed60: 3334 3b29 0a20 2020 2020 2020 2023 2070  34;).        # p
+0000ed70: 7269 6e74 2826 2333 343b 3d3d 3d3d 3d3d  rint(&#34;======
+0000ed80: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0000ed90: 3d3d 2623 3334 3b29 0a0a 2020 2020 2020  ==&#34;)..      
+0000eda0: 2020 636f 6e74 6578 7470 626a 6563 7420    contextpbject 
+0000edb0: 3d20 436f 6e74 6578 742e 636f 6e74 6578  = Context.contex
+0000edc0: 745f 6672 6f6d 5f64 6963 7428 7374 6f72  t_from_dict(stor
+0000edd0: 696e 6729 0a20 2020 2020 2020 2072 6574  ing).        ret
+0000ede0: 7572 6e20 636f 6e74 6578 7470 626a 6563  urn contextpbjec
+0000edf0: 742c 2074 6172 6765 745f 7365 7269 6573  t, target_series
+0000ee00: 5f6e 616d 650a 0a20 2020 2064 6566 2067  _name..    def g
+0000ee10: 6574 5f63 6861 7261 6374 6572 697a 6174  et_characterizat
+0000ee20: 696f 6e28 7365 6c66 2c20 636f 6e74 6578  ion(self, contex
+0000ee30: 7429 3a0a 2020 2020 2020 2020 2623 3334  t):.        &#34
+0000ee40: 3b26 2333 343b 2623 3334 3b0a 2020 2020  ;&#34;&#34;.    
+0000ee50: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
+0000ee60: 6361 6c63 756c 6174 6520 7468 6520 6368  calculate the ch
+0000ee70: 6172 6163 7465 7269 7a61 7469 6f6e 7320  aracterizations 
+0000ee80: 6f66 2028 612c 6229 2065 6467 6573 2074  of (a,b) edges t
+0000ee90: 6f20 6368 6172 6163 7465 7269 7a65 2074  o characterize t
+0000eea0: 6865 2069 6e66 6c75 656e 6365 206f 6620  he influence of 
+0000eeb0: 6120 696e 2062 2062 7920 6f6e 6520 6f66  a in b by one of
+0000eec0: 2074 6865 0a20 2020 2020 2020 2074 6872   the.        thr
+0000eed0: 6565 2063 6861 7261 6374 6572 697a 6174  ee characterizat
+0000eee0: 696f 6e73 3a20 756e 6b6e 6f77 6e2c 2064  ions: unknown, d
+0000eef0: 6563 7265 6173 652c 2069 6e63 7265 6173  ecrease, increas
+0000ef00: 652e 0a0a 2020 2020 2020 2020 5468 6520  e...        The 
+0000ef10: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+0000ef20: 2069 7320 6361 6c63 756c 6174 6564 2064   is calculated d
+0000ef30: 6966 6665 7265 6e74 6c79 2066 6f72 2065  ifferently for e
+0000ef40: 7665 6e74 2061 6e64 2063 6f6e 7469 6e75  vent and continu
+0000ef50: 6f75 7320 6461 7461 2e0a 2020 2020 2020  ous data..      
+0000ef60: 2020 2a2a 5061 7261 6d65 7465 7273 2a2a    **Parameters**
+0000ef70: 3a0a 0a20 2020 2020 2020 202a 2a63 6f6e  :..        **con
+0000ef80: 7465 7874 2a2a 3a20 6469 6374 696f 6e61  text**: dictiona
+0000ef90: 7279 2077 6974 6820 6120 6b79 6520 2623  ry with a kye &#
+0000efa0: 3339 3b65 6467 6573 2623 3339 3b20 666f  39;edges&#39; fo
+0000efb0: 7220 7768 6963 6820 6120 7061 7261 6c6c  r which a parall
+0000efc0: 656c 206c 6973 7420 6f66 2063 6861 7261  el list of chara
+0000efd0: 6374 6572 697a 6174 696f 6e73 2077 696c  cterizations wil
+0000efe0: 6c20 6265 2063 7265 6174 6564 2e0a 2020  l be created..  
+0000eff0: 2020 2020 2020 2623 3334 3b26 2333 343b        &#34;&#34;
+0000f000: 2623 3334 3b0a 2020 2020 2020 2020 6564  &#34;.        ed
+0000f010: 6765 7320 3d20 636f 6e74 6578 745b 2623  ges = context[&#
+0000f020: 3334 3b65 6467 6573 2623 3334 3b5d 0a20  34;edges&#34;]. 
+0000f030: 2020 2020 2020 2063 6861 7261 6374 6572         character
+0000f040: 697a 6174 696f 6e73 203d 205b 5d0a 2020  izations = [].  
+0000f050: 2020 2020 2020 666f 7220 6564 6765 2069        for edge i
+0000f060: 6e20 6564 6765 733a 0a20 2020 2020 2020  n edges:.       
+0000f070: 2020 2020 2069 6620 7365 6c66 2e74 6172       if self.tar
+0000f080: 6765 7420 696e 2065 6467 655b 305d 3a0a  get in edge[0]:.
+0000f090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000f0a0: 6368 6172 203d 2073 656c 662e 6368 6172  char = self.char
+0000f0b0: 6163 7465 7269 7a65 5f65 7665 6e74 5f63  acterize_event_c
+0000f0c0: 6f6e 7469 6e75 6f75 7328 636f 6e74 6578  ontinuous(contex
+0000f0d0: 742c 2065 6467 6529 0a20 2020 2020 2020  t, edge).       
+0000f0e0: 2020 2020 2065 6c69 6620 7365 6c66 2e74       elif self.t
+0000f0f0: 7970 655f 6f66 5f73 6572 6965 735b 6564  ype_of_series[ed
+0000f100: 6765 5b30 5d5d 203d 3d20 2623 3334 3b69  ge[0]] == &#34;i
+0000f110: 736f 6c61 7469 6f6e 2623 3334 3b20 6f72  solation&#34; or
+0000f120: 2073 656c 662e 7479 7065 5f6f 665f 7365   self.type_of_se
+0000f130: 7269 6573 5b65 6467 655b 305d 5d20 3d3d  ries[edge[0]] ==
+0000f140: 2026 2333 343b 636f 6e66 6967 7572 6174   &#34;configurat
+0000f150: 696f 6e26 2333 343b 3a0a 2020 2020 2020  ion&#34;:.      
+0000f160: 2020 2020 2020 2020 2020 6368 6172 203d            char =
+0000f170: 2073 656c 662e 6368 6172 6163 7465 7269   self.characteri
+0000f180: 7a65 5f65 7665 6e74 5f65 6467 6528 636f  ze_event_edge(co
+0000f190: 6e74 6578 742c 2065 6467 6529 0a20 2020  ntext, edge).   
+0000f1a0: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0000f1b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000f1c0: 6861 7220 3d20 7365 6c66 2e63 6861 7261  har = self.chara
+0000f1d0: 6374 6572 697a 655f 6576 656e 745f 636f  cterize_event_co
+0000f1e0: 6e74 696e 756f 7573 2863 6f6e 7465 7874  ntinuous(context
+0000f1f0: 2c20 6564 6765 290a 2020 2020 2020 2020  , edge).        
+0000f200: 2020 2020 6368 6172 6163 7465 7269 7a61      characteriza
+0000f210: 7469 6f6e 732e 6170 7065 6e64 2863 6861  tions.append(cha
+0000f220: 7229 0a20 2020 2020 2020 2072 6574 7572  r).        retur
+0000f230: 6e20 6368 6172 6163 7465 7269 7a61 7469  n characterizati
+0000f240: 6f6e 730a 0a20 2020 2064 6566 2063 6861  ons..    def cha
+0000f250: 7261 6374 6572 697a 655f 6576 656e 745f  racterize_event_
+0000f260: 6564 6765 2873 656c 662c 2063 6f6e 7465  edge(self, conte
+0000f270: 7874 2c20 6564 6765 293a 0a20 2020 2020  xt, edge):.     
+0000f280: 2020 2026 2333 343b 2623 3334 3b26 2333     &#34;&#34;&#3
+0000f290: 343b 0a20 2020 2020 2020 2054 6869 7320  4;.        This 
+0000f2a0: 6d65 7468 6f64 2063 6861 7261 6374 6572  method character
+0000f2b0: 697a 6573 2074 6865 2065 6467 6520 2861  izes the edge (a
+0000f2c0: 2c62 2920 7768 656e 2061 2069 7320 6973  ,b) when a is is
+0000f2d0: 6f6c 6174 6564 206f 7220 636f 6e66 6967  olated or config
+0000f2e0: 7572 6174 696f 6e20 6576 656e 742e 0a20  uration event.. 
+0000f2f0: 2020 2020 2020 2054 6f20 646f 2074 6869         To do thi
+0000f300: 732c 2069 7420 6465 7465 6374 7320 7468  s, it detects th
+0000f310: 6520 6c61 7374 206f 6363 7572 7265 6e63  e last occurrenc
+0000f320: 6520 6f66 2061 2061 6e64 2073 706c 6974  e of a and split
+0000f330: 2074 6865 2064 6174 6120 6f66 2073 6572   the data of ser
+0000f340: 6965 7320 6120 616e 6420 7365 7269 6573  ies a and series
+0000f350: 2062 2062 6173 6564 206f 6e20 7468 6174   b based on that
+0000f360: 2e0a 2020 2020 2020 2020 5468 656e 2063  ..        Then c
+0000f370: 6865 636b 7320 6966 2074 6865 206d 6564  hecks if the med
+0000f380: 6961 6e20 6f66 2062 2061 6674 6572 2074  ian of b after t
+0000f390: 6865 206f 6363 7572 7265 6e63 6520 6973  he occurrence is
+0000f3a0: 2061 7420 6c61 7267 6572 2074 6861 6e20   at larger than 
+0000f3b0: 7468 6520 6d65 6469 616e 2062 2062 6566  the median b bef
+0000f3c0: 6f72 650a 2020 2020 2020 2020 706c 7573  ore.        plus
+0000f3d0: 2074 776f 2074 696d 6573 2074 6865 2073   two times the s
+0000f3e0: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+0000f3f0: 6e20 6f66 2062 2073 6572 6965 7320 6265  n of b series be
+0000f400: 666f 7265 2074 6865 206f 6363 7572 7265  fore the occurre
+0000f410: 6e63 652e 0a20 2020 2020 2020 2049 6620  nce..        If 
+0000f420: 7468 6174 2069 7320 7472 7565 2074 6865  that is true the
+0000f430: 6e20 6973 2063 6861 7261 6374 6572 697a  n is characteriz
+0000f440: 6564 2061 7320 696e 6372 6561 7365 2e20  ed as increase. 
+0000f450: 456c 7365 2069 7420 6973 2063 6865 636b  Else it is check
+0000f460: 6564 2066 6f72 2074 6865 206f 7070 6f73  ed for the oppos
+0000f470: 6974 652c 2028 6966 2069 7420 6973 2073  ite, (if it is s
+0000f480: 6d61 6c6c 6572 0a20 2020 2020 2020 2066  maller.        f
+0000f490: 6f72 2061 7420 6c65 6173 7420 3220 7469  or at least 2 ti
+0000f4a0: 6d65 7320 7468 6520 7374 616e 6461 7264  mes the standard
+0000f4b0: 2064 6576 6961 7469 6f6e 206f 6620 6229   deviation of b)
+0000f4c0: 2061 6e64 2063 6861 7261 6374 6572 697a   and characteriz
+0000f4d0: 6564 2061 7320 6465 6372 6561 7365 2e20  ed as decrease. 
+0000f4e0: 4f74 6865 7277 6973 652c 2069 7320 6368  Otherwise, is ch
+0000f4f0: 6172 6163 7465 7269 7a65 6420 6173 0a20  aracterized as. 
+0000f500: 2020 2020 2020 2020 756e 6b6e 6f77 6e2e          unknown.
+0000f510: 0a0a 2020 2020 2020 2020 2a2a 5061 7261  ..        **Para
+0000f520: 6d65 7465 7273 2a2a 3a0a 0a20 2020 2020  meters**:..     
+0000f530: 2020 202a 2a63 6f6e 7465 7874 2a2a 3a20     **context**: 
+0000f540: 7468 6174 2074 6865 2065 6467 6520 746f  that the edge to
+0000f550: 2062 6520 6368 6172 6163 7465 7269 7a65   be characterize
+0000f560: 6420 6265 6c6f 6e67 732e 0a0a 2020 2020  d belongs...    
+0000f570: 2020 2020 2a2a 6564 6765 2a2a 3a20 4120      **edge**: A 
+0000f580: 7475 706c 6520 2861 2c62 2920 7768 6572  tuple (a,b) wher
+0000f590: 6520 6120 6973 2069 736f 6c61 7465 6420  e a is isolated 
+0000f5a0: 6f72 2063 6f6e 6669 6775 7261 7469 6f6e  or configuration
+0000f5b0: 2065 7665 6e74 2e0a 0a20 2020 2020 2020   event...       
+0000f5c0: 202a 2a72 6574 7572 6e2a 2a3a 2041 2063   **return**: A c
+0000f5d0: 6861 7261 6374 6572 697a 6174 696f 6e20  haracterization 
+0000f5e0: 666f 7220 7468 6520 6564 6765 2028 756e  for the edge (un
+0000f5f0: 6b6e 6f77 6e2c 2064 6563 7265 6173 6520  known, decrease 
+0000f600: 6f72 2069 6e63 7265 6173 6529 0a20 2020  or increase).   
+0000f610: 2020 2020 2026 2333 343b 2623 3334 3b26       &#34;&#34;&
+0000f620: 2333 343b 0a20 2020 2020 2020 206e 616d  #34;.        nam
+0000f630: 6531 203d 2065 6467 655b 305d 0a20 2020  e1 = edge[0].   
+0000f640: 2020 2020 206e 616d 6532 203d 2065 6467       name2 = edg
+0000f650: 655b 315d 0a20 2020 2020 2020 2076 616c  e[1].        val
+0000f660: 7565 7331 203d 2063 6f6e 7465 7874 5b6e  ues1 = context[n
+0000f670: 616d 6531 5d0a 2020 2020 2020 2020 7661  ame1].        va
+0000f680: 6c75 6573 3220 3d20 5b66 6c6f 6174 286b  lues2 = [float(k
+0000f690: 6174 6929 2066 6f72 206b 6174 6920 696e  ati) for kati in
+0000f6a0: 2063 6f6e 7465 7874 5b6e 616d 6532 5d5d   context[name2]]
+0000f6b0: 0a0a 2020 2020 2020 2020 6f63 6375 7265  ..        occure
+0000f6c0: 6e63 6520 3d20 6c65 6e28 7661 6c75 6573  nce = len(values
+0000f6d0: 3129 202d 2031 0a20 2020 2020 2020 2066  1) - 1.        f
+0000f6e0: 6f72 2069 2069 6e20 7261 6e67 6528 6c65  or i in range(le
+0000f6f0: 6e28 7661 6c75 6573 3129 202d 2032 2c20  n(values1) - 2, 
+0000f700: 302c 202d 3129 3a0a 2020 2020 2020 2020  0, -1):.        
+0000f710: 2020 2020 6966 2076 616c 7565 7331 5b69      if values1[i
+0000f720: 5d20 213d 2076 616c 7565 7331 5b2d 315d  ] != values1[-1]
+0000f730: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0000f740: 2020 6f63 6375 7265 6e63 6520 3d20 6920    occurence = i 
+0000f750: 2b20 310a 2020 2020 2020 2020 2020 2020  + 1.            
+0000f760: 2020 2020 6272 6561 6b0a 2020 2020 2020      break.      
+0000f770: 2020 7072 6576 6975 736f 6363 7572 656e    previusoccuren
+0000f780: 6365 203d 2030 0a20 2020 2020 2020 2066  ce = 0.        f
+0000f790: 6f72 2069 2069 6e20 7261 6e67 6528 6f63  or i in range(oc
+0000f7a0: 6375 7265 6e63 6520 2d20 322c 2030 2c20  curence - 2, 0, 
+0000f7b0: 2d31 293a 0a20 2020 2020 2020 2020 2020  -1):.           
+0000f7c0: 2069 6620 7661 6c75 6573 315b 695d 2021   if values1[i] !
+0000f7d0: 3d20 7661 6c75 6573 315b 6f63 6375 7265  = values1[occure
+0000f7e0: 6e63 6520 2d20 315d 3a0a 2020 2020 2020  nce - 1]:.      
+0000f7f0: 2020 2020 2020 2020 2020 7072 6576 6975            previu
+0000f800: 736f 6363 7572 656e 6365 203d 2069 0a0a  soccurence = i..
+0000f810: 2020 2020 2020 2020 6966 206f 6363 7572          if occur
+0000f820: 656e 6365 202d 2070 7265 7669 7573 6f63  ence - previusoc
+0000f830: 6375 7265 6e63 6520 266c 743b 2032 3a20  curence &lt; 2: 
+0000f840: 2023 206f 7220 6c65 6e28 7661 6c75 6573   # or len(values
+0000f850: 3229 2d6f 6363 7572 656e 6365 266c 743b  2)-occurence&lt;
+0000f860: 323a 0a20 2020 2020 2020 2020 2020 2072  2:.            r
+0000f870: 6574 7572 6e20 2623 3334 3b75 6e6b 6e6f  eturn &#34;unkno
+0000f880: 776e 2623 3334 3b0a 2020 2020 2020 2020  wn&#34;.        
+0000f890: 7661 6c75 6573 3262 6566 6f72 6520 3d20  values2before = 
+0000f8a0: 7661 6c75 6573 325b 7072 6576 6975 736f  values2[previuso
+0000f8b0: 6363 7572 656e 6365 3a6f 6363 7572 656e  ccurence:occuren
+0000f8c0: 6365 5d0a 2020 2020 2020 2020 2320 7374  ce].        # st
+0000f8d0: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
+0000f8e0: 7374 6465 7628 7661 6c75 6573 3262 6566  stdev(values2bef
+0000f8f0: 6f72 6529 0a20 2020 2020 2020 2023 206d  ore).        # m
+0000f900: 6561 6e20 3d20 7374 6174 6973 7469 6373  ean = statistics
+0000f910: 2e73 7464 6576 2876 616c 7565 7332 6265  .stdev(values2be
+0000f920: 666f 7265 290a 2020 2020 2020 2020 2320  fore).        # 
+0000f930: 7661 6c75 6573 3262 6566 6f72 653d 5b76  values2before=[v
+0000f940: 2069 6620 7626 6c74 3b6d 6561 6e2b 352a   if v&lt;mean+5*
+0000f950: 7374 6476 2065 6c73 6520 6d65 616e 2066  stdv else mean f
+0000f960: 6f72 2076 2069 6e20 7661 6c75 6573 3262  or v in values2b
+0000f970: 6566 6f72 655d 0a0a 2020 2020 2020 2020  efore]..        
+0000f980: 2320 7661 6c75 6573 3261 6674 6572 3d76  # values2after=v
+0000f990: 616c 7565 7332 5b6f 6363 7572 656e 6365  alues2[occurence
+0000f9a0: 3a5d 0a20 2020 2020 2020 2076 616c 7565  :].        value
+0000f9b0: 7332 6166 7465 7220 3d20 5b76 616c 7565  s2after = [value
+0000f9c0: 7332 5b2d 315d 5d0a 2020 2020 2020 2020  s2[-1]].        
+0000f9d0: 2320 7374 6476 203d 2073 7461 7469 7374  # stdv = statist
+0000f9e0: 6963 732e 7374 6465 7628 7661 6c75 6573  ics.stdev(values
+0000f9f0: 3261 6674 6572 290a 2020 2020 2020 2020  2after).        
+0000fa00: 2320 6d65 616e 203d 2073 7461 7469 7374  # mean = statist
+0000fa10: 6963 732e 7374 6465 7628 7661 6c75 6573  ics.stdev(values
+0000fa20: 3261 6674 6572 290a 2020 2020 2020 2020  2after).        
+0000fa30: 2320 7661 6c75 6573 3261 6674 6572 203d  # values2after =
+0000fa40: 205b 7620 6966 2076 2026 6c74 3b20 6d65   [v if v &lt; me
+0000fa50: 616e 202b 2033 202a 2073 7464 7620 656c  an + 3 * stdv el
+0000fa60: 7365 206d 6561 6e20 666f 7220 7620 696e  se mean for v in
+0000fa70: 2076 616c 7565 7332 6166 7465 725d 0a0a   values2after]..
+0000fa80: 2020 2020 2020 2020 7374 6476 203d 2073          stdv = s
+0000fa90: 7461 7469 7374 6963 732e 7374 6465 7628  tatistics.stdev(
+0000faa0: 7661 6c75 6573 3262 6566 6f72 6529 0a20  values2before). 
+0000fab0: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
+0000fac0: 6c75 6573 3262 6566 6f72 6529 203d 3d20  lues2before) == 
+0000fad0: 303a 0a20 2020 2020 2020 2020 2020 2063  0:.            c
+0000fae0: 6861 7220 3d20 2623 3334 3b75 6e6b 6e6f  har = &#34;unkno
+0000faf0: 776e 2623 3334 3b0a 2020 2020 2020 2020  wn&#34;.        
+0000fb00: 656c 6966 2073 7461 7469 7374 6963 732e  elif statistics.
+0000fb10: 6d65 6469 616e 2876 616c 7565 7332 6265  median(values2be
+0000fb20: 666f 7265 2920 2d20 7374 6174 6973 7469  fore) - statisti
+0000fb30: 6373 2e6d 6564 6961 6e28 7661 6c75 6573  cs.median(values
+0000fb40: 3261 6674 6572 2920 2667 743b 2032 202a  2after) &gt; 2 *
+0000fb50: 2073 7464 763a 0a20 2020 2020 2020 2020   stdv:.         
+0000fb60: 2020 2063 6861 7220 3d20 2623 3334 3b64     char = &#34;d
+0000fb70: 6563 7265 6173 6526 2333 343b 0a20 2020  ecrease&#34;.   
+0000fb80: 2020 2020 2065 6c69 6620 7374 6174 6973       elif statis
+0000fb90: 7469 6373 2e6d 6564 6961 6e28 7661 6c75  tics.median(valu
+0000fba0: 6573 3261 6674 6572 2920 2d20 7374 6174  es2after) - stat
+0000fbb0: 6973 7469 6373 2e6d 6564 6961 6e28 7661  istics.median(va
+0000fbc0: 6c75 6573 3262 6566 6f72 6529 2026 6774  lues2before) &gt
+0000fbd0: 3b20 3220 2a20 7374 6476 3a0a 2020 2020  ; 2 * stdv:.    
+0000fbe0: 2020 2020 2020 2020 6368 6172 203d 2026          char = &
+0000fbf0: 2333 343b 696e 6372 6561 7365 2623 3334  #34;increase&#34
+0000fc00: 3b0a 2020 2020 2020 2020 656c 7365 3a0a  ;.        else:.
+0000fc10: 2020 2020 2020 2020 2020 2020 6368 6172              char
+0000fc20: 203d 2026 2333 343b 756e 6b6e 6f77 6e26   = &#34;unknown&
+0000fc30: 2333 343b 0a20 2020 2020 2020 2072 6574  #34;.        ret
+0000fc40: 7572 6e20 6368 6172 0a0a 2020 2020 6465  urn char..    de
+0000fc50: 6620 6368 6172 6163 7465 7269 7a65 5f65  f characterize_e
+0000fc60: 7665 6e74 5f63 6f6e 7469 6e75 6f75 7328  vent_continuous(
+0000fc70: 7365 6c66 2c20 636f 6e74 6578 742c 2065  self, context, e
+0000fc80: 6467 6529 3a0a 2020 2020 2020 2020 2623  dge):.        &#
+0000fc90: 3334 3b26 2333 343b 2623 3334 3b0a 2020  34;&#34;&#34;.  
+0000fca0: 2020 2020 2020 2020 2020 5468 6973 206d            This m
+0000fcb0: 6574 686f 6420 6368 6172 6163 7465 7269  ethod characteri
+0000fcc0: 7a65 7320 7468 6520 6564 6765 2028 612c  zes the edge (a,
+0000fcd0: 6229 2077 6865 6e20 6120 6973 2063 6f6e  b) when a is con
+0000fce0: 7469 6e75 6f75 732e 0a20 2020 2020 2020  tinuous..       
+0000fcf0: 2020 2020 2054 6f20 646f 2074 6869 732c       To do this,
+0000fd00: 2074 6865 2064 656c 7461 2062 6574 7765   the delta betwe
+0000fd10: 656e 2074 6865 2074 696d 6573 7461 6d70  en the timestamp
+0000fd20: 7320 6f66 2074 6865 2073 6572 6965 7320  s of the series 
+0000fd30: 6220 6973 2063 616c 6375 6c61 7465 640a  b is calculated.
+0000fd40: 2020 2020 2020 2020 2020 2020 2869 2e65              (i.e
+0000fd50: 2e20 7468 6520 6469 6666 6572 656e 6365  . the difference
+0000fd60: 2062 6574 7765 656e 2063 7572 7265 6e74   between current
+0000fd70: 2061 6e64 206e 6578 7420 7469 6d65 7374   and next timest
+0000fd80: 616d 7073 292e 2049 6620 7468 6520 7375  amps). If the su
+0000fd90: 6d6d 206f 6620 7468 6520 6465 6c74 6173  mm of the deltas
+0000fda0: 2062 6574 7765 656e 2062 2073 6572 6965   between b serie
+0000fdb0: 7320 6461 7461 2c20 6973 0a20 2020 2020  s data, is.     
+0000fdc0: 2020 2020 2020 2067 7265 6174 6572 2074         greater t
+0000fdd0: 6861 6e20 3220 7469 6d65 7320 7468 6520  han 2 times the 
+0000fde0: 7374 616e 6461 7264 2064 6576 6961 7469  standard deviati
+0000fdf0: 6f6e 206f 6620 7468 6520 622c 2074 6865  on of the b, the
+0000fe00: 6e20 7468 6520 696e 6372 6561 7365 2063  n the increase c
+0000fe10: 6861 7261 6374 6572 697a 6174 696f 6e20  haracterization 
+0000fe20: 6973 2072 6574 7572 6e65 642e 2049 6620  is returned. If 
+0000fe30: 7468 6520 7375 6d0a 2020 2020 2020 2020  the sum.        
+0000fe40: 2020 2020 6973 206c 6f77 6572 2074 6861      is lower tha
+0000fe50: 6e20 3220 7469 6d65 7320 7468 6520 7374  n 2 times the st
+0000fe60: 616e 6461 7264 2064 6576 6961 7469 6f6e  andard deviation
+0000fe70: 2074 6865 2064 6563 7265 6173 6564 2063   the decreased c
+0000fe80: 6861 7261 6374 6572 697a 6174 696f 6e20  haracterization 
+0000fe90: 6973 2072 6574 7572 6e65 642e 204f 7468  is returned. Oth
+0000fea0: 6572 7769 7365 2c20 7468 6520 756e 6b6e  erwise, the unkn
+0000feb0: 6f77 6e0a 2020 2020 2020 2020 2020 2020  own.            
+0000fec0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+0000fed0: 2069 7320 7265 7475 726e 6564 2e0a 0a20   is returned... 
+0000fee0: 2020 2020 2020 2020 2020 202a 2a50 6172             **Par
+0000fef0: 616d 6574 6572 732a 2a3a 0a0a 2020 2020  ameters**:..    
+0000ff00: 2020 2020 2020 2020 2a2a 636f 6e74 6578          **contex
+0000ff10: 742a 2a3a 2074 6861 7420 7468 6520 6564  t**: that the ed
+0000ff20: 6765 2074 6f20 6265 2063 6861 7261 6374  ge to be charact
+0000ff30: 6572 697a 6564 2062 656c 6f6e 6773 2e0a  erized belongs..
+0000ff40: 0a20 2020 2020 2020 2020 2020 202a 2a65  .            **e
+0000ff50: 6467 652a 2a3a 2041 2074 7570 6c65 2028  dge**: A tuple (
+0000ff60: 612c 6229 2077 6865 7265 2061 2069 7320  a,b) where a is 
+0000ff70: 6973 6f6c 6174 6564 206f 7220 636f 6e66  isolated or conf
+0000ff80: 6967 7572 6174 696f 6e20 6576 656e 742e  iguration event.
+0000ff90: 0a0a 2020 2020 2020 2020 2020 2020 2a2a  ..            **
+0000ffa0: 7265 7475 726e 2a2a 3a20 4120 6368 6172  return**: A char
+0000ffb0: 6163 7465 7269 7a61 7469 6f6e 2066 6f72  acterization for
+0000ffc0: 2074 6865 2065 6467 6520 2875 6e6b 6e6f   the edge (unkno
+0000ffd0: 776e 2c20 6465 6372 6561 7365 206f 7220  wn, decrease or 
+0000ffe0: 696e 6372 6561 7365 290a 2020 2020 2020  increase).      
+0000fff0: 2020 2623 3334 3b26 2333 343b 2623 3334    &#34;&#34;&#34
+00010000: 3b0a 2020 2020 2020 2020 6e61 6d65 3120  ;.        name1 
+00010010: 3d20 6564 6765 5b30 5d0a 2020 2020 2020  = edge[0].      
+00010020: 2020 6e61 6d65 3220 3d20 6564 6765 5b31    name2 = edge[1
+00010030: 5d0a 2020 2020 2020 2020 7661 6c75 6573  ].        values
+00010040: 3120 3d20 5b66 6c6f 6174 286b 6174 6929  1 = [float(kati)
+00010050: 2066 6f72 206b 6174 6920 696e 2063 6f6e   for kati in con
+00010060: 7465 7874 5b6e 616d 6531 5d5d 0a20 2020  text[name1]].   
+00010070: 2020 2020 2076 616c 7565 7332 203d 205b       values2 = [
+00010080: 666c 6f61 7428 6b61 7469 2920 666f 7220  float(kati) for 
+00010090: 6b61 7469 2069 6e20 636f 6e74 6578 745b  kati in context[
+000100a0: 6e61 6d65 325d 5d0a 0a20 2020 2020 2020  name2]]..       
+000100b0: 2070 7265 7620 3d20 7661 6c75 6573 325b   prev = values2[
+000100c0: 305d 0a20 2020 2020 2020 2064 6966 6620  0].        diff 
+000100d0: 3d20 300a 2020 2020 2020 2020 666f 7220  = 0.        for 
+000100e0: 7620 696e 2076 616c 7565 7332 5b31 3a5d  v in values2[1:]
+000100f0: 3a0a 2020 2020 2020 2020 2020 2020 6469  :.            di
+00010100: 6666 202b 3d20 2876 202d 2070 7265 7629  ff += (v - prev)
+00010110: 0a0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
+00010120: 2876 616c 7565 7332 2920 3d3d 2030 3a0a  (values2) == 0:.
+00010130: 2020 2020 2020 2020 2020 2020 6368 6172              char
+00010140: 203d 2026 2333 343b 756e 6b6e 6f77 6e26   = &#34;unknown&
+00010150: 2333 343b 0a20 2020 2020 2020 2073 7464  #34;.        std
+00010160: 7620 3d20 7374 6174 6973 7469 6373 2e73  v = statistics.s
+00010170: 7464 6576 2876 616c 7565 7332 290a 2020  tdev(values2).  
+00010180: 2020 2020 2020 6966 2064 6966 6620 2667        if diff &g
+00010190: 743b 2032 202a 2073 7464 763a 0a20 2020  t; 2 * stdv:.   
+000101a0: 2020 2020 2020 2020 2063 6861 7220 3d20           char = 
+000101b0: 2623 3334 3b69 6e63 7265 6173 6526 2333  &#34;increase&#3
+000101c0: 343b 0a20 2020 2020 2020 2065 6c69 6620  4;.        elif 
+000101d0: 6469 6666 2026 6c74 3b20 2d32 202a 2073  diff &lt; -2 * s
+000101e0: 7464 763a 0a20 2020 2020 2020 2020 2020  tdv:.           
+000101f0: 2063 6861 7220 3d20 2623 3334 3b64 6563   char = &#34;dec
+00010200: 7265 6173 6526 2333 343b 0a20 2020 2020  rease&#34;.     
+00010210: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00010220: 2020 2020 2063 6861 7220 3d20 2623 3334       char = &#34
+00010230: 3b75 6e6b 6e6f 776e 2623 3334 3b0a 2020  ;unknown&#34;.  
+00010240: 2020 2020 2020 7265 7475 726e 2063 6861        return cha
+00010250: 720a 0a20 2020 2064 6566 2063 616c 6375  r..    def calcu
+00010260: 6c61 7465 5f65 6467 6573 2873 656c 662c  late_edges(self,
+00010270: 2061 6c6c 6461 7461 2c20 7469 6d65 7374   alldata, timest
+00010280: 616d 7029 3a0a 2020 2020 2020 2020 2623  amp):.        &#
+00010290: 3334 3b26 2333 343b 2623 3334 3b0a 2020  34;&#34;&#34;.  
+000102a0: 2020 2020 2020 466f 726d 756c 6174 6520        Formulate 
+000102b0: 7468 6520 6461 7461 2069 6e20 6170 7072  the data in appr
+000102c0: 6f70 7269 6174 6520 666f 726d 2074 6f20  opriate form to 
+000102d0: 6361 6c6c 2073 656c 662e 6361 6c63 756c  call self.calcul
+000102e0: 6174 655f 6361 7573 616c 6974 790a 2020  ate_causality.  
+000102f0: 2020 2020 2020 7768 6963 6820 7265 7475        which retu
+00010300: 726e 2074 6865 2065 6467 6573 2066 6f72  rn the edges for
+00010310: 2074 6865 2063 6f6e 7465 7874 2e0a 0a20   the context... 
+00010320: 2020 2020 2020 202a 2a50 6172 616d 6574         **Paramet
+00010330: 6572 732a 2a3a 0a0a 2020 2020 2020 2020  ers**:..        
+00010340: 2a2a 616c 6c64 6174 612a 2a3a 2061 2032  **alldata**: a 2
+00010350: 4420 6e75 6d70 7920 6172 7261 7920 7769  D numpy array wi
+00010360: 7468 2061 6c6c 2073 6572 6965 7320 6461  th all series da
+00010370: 7461 2028 6571 7569 7661 6c65 6e74 2074  ta (equivalent t
+00010380: 6f20 7468 6520 4344 206f 6620 7468 6520  o the CD of the 
+00010390: 436f 6e74 6578 7429 0a0a 2020 2020 2020  Context)..      
+000103a0: 2020 2a2a 7469 6d65 7374 616d 702a 2a3a    **timestamp**:
+000103b0: 2074 696d 6573 7461 6d70 206f 6620 7468   timestamp of th
+000103c0: 6520 636f 6e74 6578 7420 6672 6f6d 2077  e context from w
+000103d0: 6869 6368 2074 6865 2065 6467 6573 2061  hich the edges a
+000103e0: 7265 2063 616c 6375 6c61 7465 642e 0a0a  re calculated...
+000103f0: 2020 2020 2020 2020 2a2a 7265 7475 726e          **return
+00010400: 2a2a 3a20 6120 6469 6374 696f 6e61 7279  **: a dictionary
+00010410: 2077 6974 6820 2623 3339 3b65 6467 6573   with &#39;edges
+00010420: 2623 3339 3b20 6b65 7920 2863 6f6e 7461  &#39; key (conta
+00010430: 696e 696e 6720 7468 6520 6361 6c63 756c  ining the calcul
+00010440: 6174 6564 2065 6467 6573 2061 6674 6572  ated edges after
+00010450: 2043 6175 7361 6c69 7479 2064 6973 636f   Causality disco
+00010460: 7665 7279 292e 0a20 2020 2020 2020 2026  very)..        &
+00010470: 2333 343b 2623 3334 3b26 2333 343b 0a20  #34;&#34;&#34;. 
+00010480: 2020 2020 2020 2023 2073 7461 7274 203d         # start =
+00010490: 2074 696d 652e 7469 6d65 2829 0a20 2020   time.time().   
+000104a0: 2020 2020 2073 746f 7269 6e67 203d 207b       storing = {
+000104b0: 7d0a 2020 2020 2020 2020 7374 6f72 696e  }.        storin
+000104c0: 675b 2623 3334 3b74 696d 6573 7461 6d70  g[&#34;timestamp
+000104d0: 2623 3334 3b5d 203d 2074 696d 6573 7461  &#34;] = timesta
+000104e0: 6d70 0a0a 2020 2020 2020 2020 616c 6c64  mp..        alld
+000104f0: 6174 615f 6e61 6d65 7320 3d20 5b6e 6e5b  ata_names = [nn[
+00010500: 305d 2066 6f72 206e 6e20 696e 2061 6c6c  0] for nn in all
+00010510: 6461 7461 5d0a 2020 2020 2020 2020 616c  data].        al
+00010520: 6c64 6174 615f 6461 7461 203d 205b 6e6e  ldata_data = [nn
+00010530: 5b31 5d20 666f 7220 6e6e 2069 6e20 616c  [1] for nn in al
+00010540: 6c64 6174 615d 0a0a 2020 2020 2020 2020  ldata]..        
+00010550: 666f 7220 6e61 6d65 6464 2c20 6461 7461  for namedd, data
+00010560: 6464 2069 6e20 7a69 7028 616c 6c64 6174  dd in zip(alldat
+00010570: 615f 6e61 6d65 732c 2061 6c6c 6461 7461  a_names, alldata
+00010580: 5f64 6174 6129 3a0a 2020 2020 2020 2020  _data):.        
+00010590: 2020 2020 7374 6f72 696e 675b 6e61 6d65      storing[name
+000105a0: 6464 5d20 3d20 6461 7461 6464 0a0a 2020  dd] = datadd..  
+000105b0: 2020 2020 2020 2320 466f 7220 636f 6e74        # For cont
+000105c0: 6578 7420 7769 7468 206d 6f72 6520 7468  ext with more th
+000105d0: 616e 2074 776f 2073 6572 6965 7320 6361  an two series ca
+000105e0: 6c63 756c 6174 6520 5043 2063 6173 7561  lculate PC casua
+000105f0: 6c69 7469 6573 0a20 2020 2020 2020 2063  lities.        c
+00010600: 6f75 6e74 203d 206c 656e 285b 3120 666f  ount = len([1 fo
+00010610: 7220 6c69 7374 6120 696e 2061 6c6c 6461  r lista in allda
+00010620: 7461 5f64 6174 6120 6966 206c 6973 7461  ta_data if lista
+00010630: 2069 7320 6e6f 7420 4e6f 6e65 5d29 0a20   is not None]). 
+00010640: 2020 2020 2020 2069 6620 636f 756e 7420         if count 
+00010650: 2667 743b 2031 2061 6e64 206c 656e 2861  &gt; 1 and len(a
+00010660: 6c6c 6461 7461 5b30 5d5b 315d 2920 2667  lldata[0][1]) &g
+00010670: 743b 2035 3a0a 2020 2020 2020 2020 2020  t; 5:.          
+00010680: 2020 616c 6c64 6174 615f 6e61 6d65 7320    alldata_names 
+00010690: 3d20 5b6e 6e5b 305d 2066 6f72 206e 6e20  = [nn[0] for nn 
+000106a0: 696e 2061 6c6c 6461 7461 2069 6620 6e6e  in alldata if nn
+000106b0: 5b31 5d20 6973 206e 6f74 204e 6f6e 6520  [1] is not None 
+000106c0: 616e 6420 6c65 6e28 7365 7428 6e6e 5b31  and len(set(nn[1
+000106d0: 5d29 2920 2667 743b 2031 5d0a 2020 2020  ])) &gt; 1].    
+000106e0: 2020 2020 2020 2020 616c 6c64 6174 615f          alldata_
+000106f0: 6461 7461 203d 205b 6e6e 5b31 5d20 666f  data = [nn[1] fo
+00010700: 7220 6e6e 2069 6e20 616c 6c64 6174 6120  r nn in alldata 
+00010710: 6966 206e 6e5b 315d 2069 7320 6e6f 7420  if nn[1] is not 
+00010720: 4e6f 6e65 2061 6e64 206c 656e 2873 6574  None and len(set
+00010730: 286e 6e5b 315d 2929 2026 6774 3b20 315d  (nn[1])) &gt; 1]
+00010740: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00010750: 656e 6420 3d20 7469 6d65 2e74 696d 6528  end = time.time(
+00010760: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
+00010770: 7072 696e 7428 6626 2333 343b 6265 666f  print(f&#34;befo
+00010780: 7265 207b 656e 6420 2d20 7374 6172 747d  re {end - start}
+00010790: 2623 3334 3b29 0a20 2020 2020 2020 2020  &#34;).         
+000107a0: 2020 2023 2073 7461 7274 3d74 696d 652e     # start=time.
+000107b0: 7469 6d65 2829 0a0a 2020 2020 2020 2020  time()..        
+000107c0: 2020 2020 6564 6765 7320 3d20 7365 6c66      edges = self
+000107d0: 2e63 616c 6375 6c61 7465 5f63 6175 7361  .calculate_causa
+000107e0: 6c69 7479 286e 702e 636f 6c75 6d6e 5f73  lity(np.column_s
+000107f0: 7461 636b 2861 6c6c 6461 7461 5f64 6174  tack(alldata_dat
+00010800: 6129 2c20 616c 6c64 6174 615f 6e61 6d65  a), alldata_name
+00010810: 7329 0a20 2020 2020 2020 2020 2020 2023  s).            #
+00010820: 2065 6e64 3d74 696d 652e 7469 6d65 2829   end=time.time()
+00010830: 0a20 2020 2020 2020 2020 2020 2023 2070  .            # p
+00010840: 7269 6e74 2866 2623 3334 3b61 6374 7561  rint(f&#34;actua
+00010850: 6c20 6564 6765 2063 616c 6375 6c61 7469  l edge calculati
+00010860: 6f6e 207b 656e 642d 7374 6172 747d 2623  on {end-start}&#
+00010870: 3334 3b29 0a20 2020 2020 2020 2020 2020  34;).           
+00010880: 2069 6620 6564 6765 7320 6973 204e 6f6e   if edges is Non
+00010890: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000108a0: 2020 2073 696e 676c 6565 6467 6573 203d     singleedges =
+000108b0: 205b 5d0a 2020 2020 2020 2020 2020 2020   [].            
+000108c0: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+000108d0: 2020 2020 2020 7369 6e67 6c65 6564 6765        singleedge
+000108e0: 7320 3d20 6564 6765 730a 2020 2020 2020  s = edges.      
+000108f0: 2020 2020 2020 2320 7072 696e 7428 6564        # print(ed
+00010900: 6765 7329 0a20 2020 2020 2020 2020 2020  ges).           
+00010910: 2073 746f 7269 6e67 5b26 2333 343b 6564   storing[&#34;ed
+00010920: 6765 7326 2333 343b 5d20 3d20 7369 6e67  ges&#34;] = sing
+00010930: 6c65 6564 6765 730a 2020 2020 2020 2020  leedges.        
+00010940: 2020 2020 7265 7475 726e 2073 746f 7269      return stori
+00010950: 6e67 0a20 2020 2020 2020 2073 746f 7269  ng.        stori
+00010960: 6e67 5b26 2333 343b 6564 6765 7326 2333  ng[&#34;edges&#3
+00010970: 343b 5d20 3d20 5b5d 0a20 2020 2020 2020  4;] = [].       
+00010980: 2072 6574 7572 6e20 7374 6f72 696e 670a   return storing.
+00010990: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
+000109a0: 636f 6e74 696e 756f 7573 5f72 6570 7265  continuous_repre
+000109b0: 7365 6e74 6174 696f 6e28 7365 6c66 2c20  sentation(self, 
+000109c0: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
+000109d0: 6d65 2c20 7461 7267 6574 5f73 6572 6965  me, target_serie
+000109e0: 732c 2064 662c 2074 7970 655f 6f66 5f73  s, df, type_of_s
+000109f0: 6572 6965 732c 2061 6c6c 636f 6465 7329  eries, allcodes)
+00010a00: 3a0a 2020 2020 2020 2020 2320 6966 206c  :.        # if l
+00010a10: 656e 2874 6172 6765 745f 7365 7269 6573  en(target_series
+00010a20: 2920 266c 743b 2035 3a0a 2020 2020 2020  ) &lt; 5:.      
+00010a30: 2020 2320 2020 2020 616c 6c64 6174 6120    #     alldata 
+00010a40: 3d20 5b5d 0a20 2020 2020 2020 2023 2020  = [].        #  
+00010a50: 2020 2070 6164 6469 6e67 3d5b 3020 666f     padding=[0 fo
+00010a60: 7220 7120 696e 2072 616e 6765 2835 2d6c  r q in range(5-l
+00010a70: 656e 2874 6172 6765 745f 7365 7269 6573  en(target_series
+00010a80: 2929 5d0a 2020 2020 2020 2020 2320 2020  ))].        #   
+00010a90: 2020 7061 6464 696e 672e 6578 7465 6e64    padding.extend
+00010aa0: 285b 7461 6773 5b30 5d20 666f 7220 7461  ([tags[0] for ta
+00010ab0: 6773 2069 6e20 7461 7267 6574 5f73 6572  gs in target_ser
+00010ac0: 6965 735d 290a 2020 2020 2020 2020 2320  ies]).        # 
+00010ad0: 2020 2020 616c 6c64 6174 612e 6170 7065      alldata.appe
+00010ae0: 6e64 2828 7461 7267 6574 5f73 6572 6965  nd((target_serie
+00010af0: 735f 6e61 6d65 2c20 7061 6464 696e 6729  s_name, padding)
+00010b00: 290a 2020 2020 2020 2020 2320 2020 2020  ).        #     
+00010b10: 7265 7475 726e 2061 6c6c 6461 7461 0a20  return alldata. 
+00010b20: 2020 2020 2020 2077 696e 646f 7776 616c         windowval
+00010b30: 7565 7320 3d20 6466 2020 2320 2e76 616c  ues = df  # .val
+00010b40: 7565 730a 2020 2020 2020 2020 616c 6c64  ues.        alld
+00010b50: 6174 6120 3d20 5b5d 0a20 2020 2020 2020  ata = [].       
+00010b60: 2061 6c6c 6461 7461 2e61 7070 656e 6428   alldata.append(
+00010b70: 2874 6172 6765 745f 7365 7269 6573 5f6e  (target_series_n
+00010b80: 616d 652c 205b 7461 675b 305d 2066 6f72  ame, [tag[0] for
+00010b90: 2074 6167 2069 6e20 7461 7267 6574 5f73   tag in target_s
+00010ba0: 6572 6965 735d 2929 0a20 2020 2020 2020  eries])).       
+00010bb0: 2066 6f72 206e 616d 6520 696e 2061 6c6c   for name in all
+00010bc0: 636f 6465 733a 0a20 2020 2020 2020 2020  codes:.         
+00010bd0: 2020 2023 2061 6c72 6561 6479 2063 616c     # already cal
+00010be0: 6375 6c61 7465 6420 696e 2074 6172 6765  culated in targe
+00010bf0: 7473 6572 6965 732e 0a20 2020 2020 2020  tseries..       
+00010c00: 2020 2020 2069 6620 7461 7267 6574 5f73       if target_s
+00010c10: 6572 6965 735f 6e61 6d65 2069 6e20 6e61  eries_name in na
+00010c20: 6d65 3a0a 2020 2020 2020 2020 2020 2020  me:.            
+00010c30: 2020 2020 636f 6e74 696e 7565 0a0a 2020      continue..  
+00010c40: 2020 2020 2020 2020 2020 2320 6465 7465            # dete
+00010c50: 6374 2074 6865 206f 6363 7572 616e 6369  ct the occuranci
+00010c60: 6573 0a20 2020 2020 2020 2020 2020 206f  es.            o
+00010c70: 6363 7572 656e 6369 6573 203d 205b 2876  ccurencies = [(v
+00010c80: 616c 7565 2c20 7469 6d65 2920 666f 7220  alue, time) for 
+00010c90: 636f 6465 2c20 7661 6c75 652c 2074 696d  code, value, tim
+00010ca0: 6520 696e 0a20 2020 2020 2020 2020 2020  e in.           
+00010cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010cc0: 7a69 7028 7769 6e64 6f77 7661 6c75 6573  zip(windowvalues
+00010cd0: 5b3a 2c20 315d 2c20 7769 6e64 6f77 7661  [:, 1], windowva
+00010ce0: 6c75 6573 5b3a 2c20 335d 2c20 7769 6e64  lues[:, 3], wind
+00010cf0: 6f77 7661 6c75 6573 5b3a 2c20 305d 2920  owvalues[:, 0]) 
+00010d00: 6966 206e 616d 6520 696e 2063 6f64 655d  if name in code]
+00010d10: 0a0a 2020 2020 2020 2020 2020 2020 7665  ..            ve
+00010d20: 6374 6f72 203d 205b 3020 666f 7220 6920  ctor = [0 for i 
+00010d30: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
+00010d40: 6765 745f 7365 7269 6573 2929 5d0a 2020  get_series))].  
+00010d50: 2020 2020 2020 2020 2020 6966 206c 656e            if len
+00010d60: 286f 6363 7572 656e 6369 6573 2920 3d3d  (occurencies) ==
+00010d70: 2030 3a0a 2020 2020 2020 2020 2020 2020   0:.            
+00010d80: 2020 2020 7665 6374 6f72 203d 205b 3020      vector = [0 
+00010d90: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
+00010da0: 656e 2874 6172 6765 745f 7365 7269 6573  en(target_series
+00010db0: 2929 5d0a 2020 2020 2020 2020 2020 2020  ))].            
+00010dc0: 656c 6966 206f 6363 7572 656e 6369 6573  elif occurencies
+00010dd0: 5b30 5d5b 305d 2069 7320 6e6f 7420 4e6f  [0][0] is not No
+00010de0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+00010df0: 2020 2020 7665 6374 6f72 203d 2073 656c      vector = sel
+00010e00: 662e 6275 696c 645f 636f 6e74 6578 745f  f.build_context_
+00010e10: 666f 725f 756e 6976 6172 6961 7465 2874  for_univariate(t
+00010e20: 6172 6765 745f 7365 7269 6573 2c20 6f63  arget_series, oc
+00010e30: 6375 7265 6e63 6965 7329 0a20 2020 2020  curencies).     
+00010e40: 2020 2020 2020 2065 6c69 6620 7479 7065         elif type
+00010e50: 5f6f 665f 7365 7269 6573 5b6e 616d 655d  _of_series[name]
+00010e60: 203d 3d20 2623 3334 3b69 736f 6c61 7465   == &#34;isolate
+00010e70: 6426 2333 343b 3a0a 2020 2020 2020 2020  d&#34;:.        
+00010e80: 2020 2020 2020 2020 7665 6374 6f72 203d          vector =
+00010e90: 2073 656c 662e 6275 696c 645f 636f 6e74   self.build_cont
+00010ea0: 6578 745f 666f 725f 6973 6f6c 6174 6564  ext_for_isolated
+00010eb0: 2874 6172 6765 745f 7365 7269 6573 2c20  (target_series, 
+00010ec0: 6f63 6375 7265 6e63 6965 7329 0a20 2020  occurencies).   
+00010ed0: 2020 2020 2020 2020 2065 6c69 6620 7479           elif ty
+00010ee0: 7065 5f6f 665f 7365 7269 6573 5b6e 616d  pe_of_series[nam
+00010ef0: 655d 203d 3d20 2623 3334 3b63 6f6e 6669  e] == &#34;confi
+00010f00: 6775 7261 7469 6f6e 2623 3334 3b3a 0a20  guration&#34;:. 
+00010f10: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00010f20: 6563 746f 7220 3d20 7365 6c66 2e62 7569  ector = self.bui
+00010f30: 6c64 5f63 6f6e 7465 7874 5f66 6f72 5f63  ld_context_for_c
+00010f40: 6f6e 6669 7567 7572 6174 696f 6e28 7461  onfiuguration(ta
+00010f50: 7267 6574 5f73 6572 6965 732c 206f 6363  rget_series, occ
+00010f60: 7572 656e 6369 6573 290a 0a20 2020 2020  urencies)..     
+00010f70: 2020 2020 2020 206f 6b20 3d20 2623 3334         ok = &#34
+00010f80: 3b6f 6b26 2333 343b 0a20 2020 2020 2020  ;ok&#34;.       
+00010f90: 2020 2020 2023 2069 6620 7665 6374 6f72       # if vector
+00010fa0: 2069 7320 7374 6174 696f 6e61 7279 2074   is stationary t
+00010fb0: 6865 6e20 6e6f 2063 6f6e 7465 7874 2e0a  hen no context..
+00010fc0: 2020 2020 2020 2020 2020 2020 6966 206d              if m
+00010fd0: 6178 2876 6563 746f 7229 203d 3d20 3020  ax(vector) == 0 
+00010fe0: 616e 6420 6d69 6e28 7665 6374 6f72 2920  and min(vector) 
+00010ff0: 3d3d 2030 3a0a 2020 2020 2020 2020 2020  == 0:.          
+00011000: 2020 2020 2020 7665 6374 6f72 203d 204e        vector = N
+00011010: 6f6e 650a 2020 2020 2020 2020 2020 2020  one.            
+00011020: 616c 6c64 6174 612e 6170 7065 6e64 2828  alldata.append((
+00011030: 6e61 6d65 2c20 7665 6374 6f72 2929 0a20  name, vector)). 
+00011040: 2020 2020 2020 2072 6574 7572 6e20 616c         return al
+00011050: 6c64 6174 610a 0a20 2020 2064 6566 2062  ldata..    def b
+00011060: 7569 6c64 5f74 6172 6765 745f 7365 7269  uild_target_seri
+00011070: 6573 5f66 6f72 5f63 6f6e 7465 7874 2873  es_for_context(s
+00011080: 656c 662c 2063 7572 7265 6e74 3a20 4576  elf, current: Ev
+00011090: 656e 7470 6f69 6e74 2c20 6466 3a20 6e70  entpoint, df: np
+000110a0: 2e6e 6461 7272 6179 293a 0a20 2020 2020  .ndarray):.     
+000110b0: 2020 2074 6172 6765 745f 7365 7269 6573     target_series
+000110c0: 5f6e 616d 6520 3d20 6375 7272 656e 742e  _name = current.
+000110d0: 636f 6465 0a20 2020 2020 2020 2077 696e  code.        win
+000110e0: 646f 7776 616c 7565 7320 3d20 6466 2020  dowvalues = df  
+000110f0: 2320 2e76 616c 7565 730a 2020 2020 2020  # .values.      
+00011100: 2020 7461 7267 6574 5f73 6572 6965 7320    target_series 
+00011110: 3d20 5b28 7661 6c75 652c 2074 696d 6529  = [(value, time)
+00011120: 2066 6f72 2063 6f64 652c 2076 616c 7565   for code, value
+00011130: 2c20 7469 6d65 2069 6e0a 2020 2020 2020  , time in.      
+00011140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011150: 2020 207a 6970 2877 696e 646f 7776 616c     zip(windowval
+00011160: 7565 735b 3a2c 2031 5d2c 2077 696e 646f  ues[:, 1], windo
+00011170: 7776 616c 7565 735b 3a2c 2033 5d2c 2077  wvalues[:, 3], w
+00011180: 696e 646f 7776 616c 7565 735b 3a2c 2030  indowvalues[:, 0
+00011190: 5d29 2069 6620 7461 7267 6574 5f73 6572  ]) if target_ser
+000111a0: 6965 735f 6e61 6d65 2069 6e20 636f 6465  ies_name in code
+000111b0: 5d0a 0a20 2020 2020 2020 2072 6574 7572  ]..        retur
+000111c0: 6e20 7461 7267 6574 5f73 6572 6965 735f  n target_series_
+000111d0: 6e61 6d65 2c20 7461 7267 6574 5f73 6572  name, target_ser
+000111e0: 6965 730a 0a20 2020 2064 6566 204e 756d  ies..    def Num
+000111f0: 7079 5f70 7265 7072 6f63 6365 7373 2873  py_preproccess(s
+00011200: 656c 662c 206e 7063 6f6e 7465 7874 293a  elf, npcontext):
+00011210: 0a20 2020 2020 2020 206e 7063 6f6e 7465  .        npconte
+00011220: 7874 203d 206e 702e 7768 6572 6528 6e70  xt = np.where(np
+00011230: 636f 6e74 6578 7420 3d3d 2026 2333 343b  context == &#34;
+00011240: 6e61 6e26 2333 343b 2c20 4e6f 6e65 2c20  nan&#34;, None, 
+00011250: 6e70 636f 6e74 6578 7429 0a0a 2020 2020  npcontext)..    
+00011260: 2020 2020 6d61 736b 203d 205b 2826 2333      mask = [(&#3
+00011270: 393b 305f 2623 3339 3b20 696e 2063 6f64  9;0_&#39; in cod
+00011280: 6520 616e 6420 7661 6c75 6520 6973 204e  e and value is N
+00011290: 6f6e 6529 2066 6f72 2063 6f64 652c 2076  one) for code, v
+000112a0: 616c 7565 2069 6e20 7a69 7028 6e70 636f  alue in zip(npco
+000112b0: 6e74 6578 745b 3a2c 2031 5d2c 206e 7063  ntext[:, 1], npc
+000112c0: 6f6e 7465 7874 5b3a 2c20 335d 295d 0a0a  ontext[:, 3])]..
+000112d0: 2020 2020 2020 2020 2320 6966 2069 7369          # if isi
+000112e0: 6e73 7461 6e63 6528 6d61 736b 2c63 6f6c  nstance(mask,col
+000112f0: 6c65 6374 696f 6e73 2e61 6263 2e53 6571  lections.abc.Seq
+00011300: 7565 6e63 6529 3d3d 4661 6c73 653a 0a20  uence)==False:. 
+00011310: 2020 2020 2020 2023 2020 2020 206d 6173         #     mas
+00011320: 6b3d 5b6d 6173 6b5d 0a20 2020 2020 2020  k=[mask].       
+00011330: 206e 7063 6f6e 7465 7874 5b6d 6173 6b2c   npcontext[mask,
+00011340: 2033 5d20 3d20 300a 2020 2020 2020 2020   3] = 0.        
+00011350: 6d61 736b 203d 205b 2826 2333 393b 315f  mask = [(&#39;1_
+00011360: 2623 3339 3b20 696e 2063 6f64 6520 616e  &#39; in code an
+00011370: 6420 7661 6c75 6520 6973 204e 6f6e 6529  d value is None)
+00011380: 2066 6f72 2063 6f64 652c 2076 616c 7565   for code, value
+00011390: 2069 6e20 7a69 7028 6e70 636f 6e74 6578   in zip(npcontex
+000113a0: 745b 3a2c 2031 5d2c 206e 7063 6f6e 7465  t[:, 1], npconte
+000113b0: 7874 5b3a 2c20 335d 295d 0a20 2020 2020  xt[:, 3])].     
+000113c0: 2020 206e 7063 6f6e 7465 7874 5b6d 6173     npcontext[mas
+000113d0: 6b2c 2033 5d20 3d20 310a 2020 2020 2020  k, 3] = 1.      
+000113e0: 2020 636f 6465 5f77 6974 685f 736f 7572    code_with_sour
+000113f0: 6365 203d 205b 6626 2333 343b 7b63 6f64  ce = [f&#34;{cod
+00011400: 657d 7b73 6f75 7263 657d 2623 3334 3b20  e}{source}&#34; 
+00011410: 6966 2073 6f75 7263 655b 305d 203d 3d20  if source[0] == 
+00011420: 2623 3334 3b40 2623 3334 3b20 656c 7365  &#34;@&#34; else
+00011430: 2066 2623 3334 3b7b 636f 6465 7d40 7b73   f&#34;{code}@{s
+00011440: 6f75 7263 657d 2623 3334 3b20 666f 7220  ource}&#34; for 
+00011450: 636f 6465 2c20 736f 7572 6365 2069 6e0a  code, source in.
+00011460: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011470: 2020 2020 2020 2020 2020 2020 7a69 7028              zip(
+00011480: 6e70 636f 6e74 6578 745b 3a2c 2031 5d2c  npcontext[:, 1],
+00011490: 206e 7063 6f6e 7465 7874 5b3a 2c20 325d   npcontext[:, 2]
+000114a0: 295d 0a20 2020 2020 2020 206e 7063 6f6e  )].        npcon
+000114b0: 7465 7874 5b3a 2c20 315d 203d 2063 6f64  text[:, 1] = cod
+000114c0: 655f 7769 7468 5f73 6f75 7263 650a 0a20  e_with_source.. 
+000114d0: 2020 2020 2020 2072 6574 7572 6e20 6e70         return np
+000114e0: 636f 6e74 6578 740a 0a20 2020 2064 6566  context..    def
+000114f0: 2062 7569 6c64 5f63 6f6e 7465 7874 5f66   build_context_f
+00011500: 6f72 5f63 6f6e 6669 7567 7572 6174 696f  or_confiuguratio
+00011510: 6e28 7365 6c66 2c20 7461 7267 6574 5f73  n(self, target_s
+00011520: 6572 6965 732c 206f 6363 7572 656e 6369  eries, occurenci
+00011530: 6573 293a 0a20 2020 2020 2020 2076 6563  es):.        vec
+00011540: 746f 7220 3d20 5b30 2066 6f72 2069 2069  tor = [0 for i i
+00011550: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
+00011560: 6574 5f73 6572 6965 7329 295d 0a20 2020  et_series))].   
+00011570: 2020 2020 2066 6f72 206f 6363 2069 6e20       for occ in 
+00011580: 6f63 6375 7265 6e63 6965 733a 0a20 2020  occurencies:.   
+00011590: 2020 2020 2020 2020 2066 6f72 2071 2069           for q i
+000115a0: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
+000115b0: 6574 5f73 6572 6965 7329 293a 0a20 2020  et_series)):.   
+000115c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+000115d0: 7461 7267 6574 5f73 6572 6965 735b 715d  target_series[q]
+000115e0: 5b31 5d20 2667 743b 3d20 6f63 635b 315d  [1] &gt;= occ[1]
+000115f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011600: 2020 2020 2020 666f 7220 6b20 696e 2072        for k in r
+00011610: 616e 6765 2871 2c20 6c65 6e28 7665 6374  ange(q, len(vect
+00011620: 6f72 2929 3a0a 2020 2020 2020 2020 2020  or)):.          
+00011630: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+00011640: 6374 6f72 5b6b 5d20 2b3d 2031 0a20 2020  ctor[k] += 1.   
+00011650: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011660: 2062 7265 616b 0a20 2020 2020 2020 2023   break.        #
+00011670: 2320 6e6f 7420 7374 6162 6c65 0a20 2020  # not stable.   
+00011680: 2020 2020 2069 6620 6c65 6e28 7365 7428       if len(set(
+00011690: 7665 6374 6f72 2929 203d 3d20 313a 0a20  vector)) == 1:. 
+000116a0: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+000116b0: 725b 305d 203d 2030 0a20 2020 2020 2020  r[0] = 0.       
+000116c0: 2072 6574 7572 6e20 7665 6374 6f72 0a0a   return vector..
+000116d0: 2020 2020 6465 6620 6275 696c 645f 636f      def build_co
+000116e0: 6e74 6578 745f 666f 725f 6973 6f6c 6174  ntext_for_isolat
+000116f0: 6564 2873 656c 662c 2074 6172 6765 745f  ed(self, target_
+00011700: 7365 7269 6573 2c20 6f63 6375 7265 6e63  series, occurenc
+00011710: 6965 7329 3a0a 2020 2020 2020 2020 7665  ies):.        ve
+00011720: 6374 6f72 203d 205b 3020 666f 7220 6920  ctor = [0 for i 
+00011730: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
+00011740: 6765 745f 7365 7269 6573 2929 5d0a 2020  get_series))].  
+00011750: 2020 2020 2020 666f 7220 6f63 6320 696e        for occ in
+00011760: 206f 6363 7572 656e 6369 6573 3a0a 2020   occurencies:.  
+00011770: 2020 2020 2020 2020 2020 666f 7220 7120            for q 
+00011780: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
+00011790: 6765 745f 7365 7269 6573 2929 3a0a 2020  get_series)):.  
+000117a0: 2020 2020 2020 2020 2020 2020 2020 6966                if
+000117b0: 2074 6172 6765 745f 7365 7269 6573 5b71   target_series[q
+000117c0: 5d5b 315d 2026 6774 3b20 6f63 635b 315d  ][1] &gt; occ[1]
+000117d0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000117e0: 2020 2020 2020 7665 6374 6f72 5b71 5d20        vector[q] 
+000117f0: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00011800: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00011810: 2020 2020 2020 7265 7475 726e 2076 6563        return vec
+00011820: 746f 720a 0a20 2020 2064 6566 2062 7569  tor..    def bui
+00011830: 6c64 5f63 6f6e 7465 7874 5f66 6f72 5f75  ld_context_for_u
+00011840: 6e69 7661 7269 6174 6528 7365 6c66 2c20  nivariate(self, 
+00011850: 7461 7267 6574 5f73 6572 6965 732c 206f  target_series, o
+00011860: 6363 7572 656e 6369 6573 293a 0a20 2020  ccurencies):.   
+00011870: 2020 2020 2061 6c6c 7661 6c75 6573 203d       allvalues =
+00011880: 205b 5d0a 2020 2020 2020 2020 7665 6374   [].        vect
+00011890: 6f72 203d 205b 3020 666f 7220 6920 696e  or = [0 for i in
+000118a0: 2072 616e 6765 286c 656e 2874 6172 6765   range(len(targe
+000118b0: 745f 7365 7269 6573 2929 5d0a 2020 2020  t_series))].    
+000118c0: 2020 2020 706f 7320 3d20 300a 2020 2020      pos = 0.    
+000118d0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+000118e0: 6765 286c 656e 2874 6172 6765 745f 7365  ge(len(target_se
+000118f0: 7269 6573 2929 3a0a 2020 2020 2020 2020  ries)):.        
+00011900: 2020 2020 7469 6d65 7374 616d 7020 3d20      timestamp = 
+00011910: 7461 7267 6574 5f73 6572 6965 735b 695d  target_series[i]
+00011920: 5b31 5d0a 2020 2020 2020 2020 2020 2020  [1].            
+00011930: 6375 7272 656e 745f 706f 7320 3d20 706f  current_pos = po
+00011940: 730a 2020 2020 2020 2020 2020 2020 666f  s.            fo
+00011950: 7220 7120 696e 2072 616e 6765 2870 6f73  r q in range(pos
+00011960: 2c20 6c65 6e28 6f63 6375 7265 6e63 6965  , len(occurencie
+00011970: 7329 293a 0a20 2020 2020 2020 2020 2020  s)):.           
+00011980: 2020 2020 2069 6620 6f63 6375 7265 6e63       if occurenc
+00011990: 6965 735b 715d 5b31 5d20 2667 743b 2074  ies[q][1] &gt; t
+000119a0: 696d 6573 7461 6d70 3a0a 2020 2020 2020  imestamp:.      
+000119b0: 2020 2020 2020 2020 2020 2020 2020 6375                cu
+000119c0: 7272 656e 745f 706f 7320 3d20 710a 2020  rrent_pos = q.  
+000119d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119e0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+000119f0: 2020 2020 2320 6e6f 2064 6174 6120 666f      # no data fo
+00011a00: 756e 640a 0a20 2020 2020 2020 2020 2020  und..           
+00011a10: 2069 6620 6375 7272 656e 745f 706f 7320   if current_pos 
+00011a20: 3d3d 2070 6f73 3a0a 2020 2020 2020 2020  == pos:.        
+00011a30: 2020 2020 2020 2020 2320 6966 206e 6f20          # if no 
+00011a40: 6461 7461 2069 6e20 6265 7477 7765 6e20  data in betwwen 
+00011a50: 7661 6c75 6573 2075 7365 2074 6865 2070  values use the p
+00011a60: 7265 7669 7573 2076 616c 7565 0a20 2020  revius value.   
+00011a70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00011a80: 6920 2667 743b 2030 3a0a 2020 2020 2020  i &gt; 0:.      
+00011a90: 2020 2020 2020 2020 2020 2020 2020 7665                ve
+00011aa0: 6374 6f72 5b69 5d20 3d20 7665 6374 6f72  ctor[i] = vector
+00011ab0: 5b69 202d 2031 5d0a 2020 2020 2020 2020  [i - 1].        
+00011ac0: 2020 2020 2020 2020 2320 6966 206e 6f20          # if no 
+00011ad0: 6461 7461 2075 6e74 696c 2069 2074 696d  data until i tim
+00011ae0: 6573 7461 6d70 2075 7365 2074 6865 2066  estamp use the f
+00011af0: 6972 7374 206f 6363 7572 656e 6365 2061  irst occurence a
+00011b00: 7320 7661 6c75 650a 2020 2020 2020 2020  s value.        
+00011b10: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00011b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b30: 2020 7665 6374 6f72 5b69 5d20 3d20 6f63    vector[i] = oc
+00011b40: 6375 7265 6e63 6965 735b 305d 5b30 5d0a  curencies[0][0].
+00011b50: 2020 2020 2020 2020 2020 2020 2320 6966              # if
+00011b60: 206d 756c 7469 706c 6520 7661 6c75 6573   multiple values
+00011b70: 2069 6e20 6265 7477 6565 6e20 7477 6f20   in between two 
+00011b80: 7469 6d65 7374 616d 7073 2075 7365 2074  timestamps use t
+00011b90: 6865 206d 6561 6e20 6f66 2074 6865 6d20  he mean of them 
+00011ba0: 6173 2076 616c 7565 0a20 2020 2020 2020  as value.       
+00011bb0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00011bc0: 2020 2020 2020 2020 2020 2064 6174 6149             dataI
+00011bd0: 6e42 6574 7765 656e 203d 205b 7661 6c75  nBetween = [valu
+00011be0: 6520 666f 7220 7661 6c75 652c 2074 696d  e for value, tim
+00011bf0: 6520 696e 206f 6363 7572 656e 6369 6573  e in occurencies
+00011c00: 5b70 6f73 3a63 7572 7265 6e74 5f70 6f73  [pos:current_pos
+00011c10: 5d5d 0a20 2020 2020 2020 2020 2020 2020  ]].             
+00011c20: 2020 2076 6563 746f 725b 695d 203d 2073     vector[i] = s
+00011c30: 756d 2864 6174 6149 6e42 6574 7765 656e  um(dataInBetween
+00011c40: 2920 2f20 6c65 6e28 6461 7461 496e 4265  ) / len(dataInBe
+00011c50: 7477 6565 6e29 0a20 2020 2020 2020 2020  tween).         
+00011c60: 2020 2023 2069 6620 6e6f 206f 7468 6572     # if no other
+00011c70: 206f 6363 7572 656e 6369 6573 206a 7573   occurencies jus
+00011c80: 7420 7265 7065 6174 2074 6865 206c 6173  t repeat the las
+00011c90: 7420 7661 6c75 650a 2020 2020 2020 2020  t value.        
+00011ca0: 2020 2020 6966 2063 7572 7265 6e74 5f70      if current_p
+00011cb0: 6f73 203d 3d20 6c65 6e28 6f63 6375 7265  os == len(occure
+00011cc0: 6e63 6965 7329 3a0a 2020 2020 2020 2020  ncies):.        
+00011cd0: 2020 2020 2020 2020 666f 7220 6b20 696e          for k in
+00011ce0: 2072 616e 6765 2869 202b 2031 2c20 6c65   range(i + 1, le
+00011cf0: 6e28 7665 6374 6f72 2929 3a0a 2020 2020  n(vector)):.    
+00011d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011d10: 7665 6374 6f72 5b6b 5d20 3d20 7665 6374  vector[k] = vect
+00011d20: 6f72 5b6b 202d 2031 5d0a 2020 2020 2020  or[k - 1].      
+00011d30: 2020 2020 2020 2020 2020 6272 6561 6b0a            break.
+00011d40: 2020 2020 2020 2020 2020 2020 706f 7320              pos 
+00011d50: 3d20 6375 7272 656e 745f 706f 730a 0a20  = current_pos.. 
+00011d60: 2020 2020 2020 2072 6574 7572 6e20 7665         return ve
+00011d70: 6374 6f72 0a0a 2020 2020 6465 6620 6361  ctor..    def ca
+00011d80: 6c63 756c 6174 655f 6361 7573 616c 6974  lculate_causalit
+00011d90: 7928 7365 6c66 2c20 6461 7461 6f72 2c20  y(self, dataor, 
+00011da0: 6e61 6d65 7329 3a0a 2020 2020 2020 2020  names):.        
+00011db0: 6e75 6d5f 7469 6d65 5f73 6572 6965 7320  num_time_series 
+00011dc0: 3d20 6c65 6e28 6461 7461 6f72 290a 2020  = len(dataor).  
+00011dd0: 2020 2020 2020 6461 7461 203d 206e 702e        data = np.
+00011de0: 6172 7261 7928 6461 7461 6f72 290a 2020  array(dataor).  
+00011df0: 2020 2020 2020 6564 6765 7320 3d20 7365        edges = se
+00011e00: 6c66 2e63 6175 7361 6c69 7479 5f64 6973  lf.causality_dis
+00011e10: 636f 7665 7279 286e 616d 6573 2c20 6461  covery(names, da
+00011e20: 7461 290a 2020 2020 2020 2020 2320 6564  ta).        # ed
+00011e30: 6765 733d 7365 6c66 2e63 616c 6375 6c61  ges=self.calcula
+00011e40: 7465 7769 7468 5063 286e 616d 6573 2c64  tewithPc(names,d
+00011e50: 6174 6129 0a20 2020 2020 2020 2023 2065  ata).        # e
+00011e60: 6467 6573 3d73 656c 662e 6361 6c63 756c  dges=self.calcul
+00011e70: 6174 6577 6974 685f 6663 6928 6e61 6d65  atewith_fci(name
+00011e80: 732c 6461 7461 290a 2020 2020 2020 2020  s,data).        
+00011e90: 2320 6564 6765 733d 7365 6c66 2e73 616c  # edges=self.sal
+00011ea0: 6573 666f 7263 6550 4328 6e61 6d65 732c  esforcePC(names,
+00011eb0: 6461 7461 290a 2020 2020 2020 2020 7265  data).        re
+00011ec0: 7475 726e 2065 6467 6573 0a0a 2020 2020  turn edges..    
+00011ed0: 6465 6620 706c 6f74 2873 656c 662c 2066  def plot(self, f
+00011ee0: 696c 7465 7265 6467 6573 3d4e 6f6e 6529  ilteredges=None)
+00011ef0: 3a0a 2020 2020 2020 2020 6966 2066 696c  :.        if fil
+00011f00: 7465 7265 6467 6573 2069 7320 4e6f 6e65  teredges is None
+00011f10: 3a0a 2020 2020 2020 2020 2020 2020 6669  :.            fi
+00011f20: 6c74 6572 6564 6765 7320 3d20 5b5b 2623  lteredges = [[&#
+00011f30: 3334 3b26 2333 343b 2c20 2623 3334 3b26  34;&#34;, &#34;&
+00011f40: 2333 343b 2c20 2623 3334 3b26 2333 343b  #34;, &#34;&#34;
+00011f50: 5d5d 0a20 2020 2020 2020 2073 686f 775f  ]].        show_
+00011f60: 636f 6e74 6578 745f 6c69 7374 2873 656c  context_list(sel
+00011f70: 662e 636f 6e74 6578 7473 2c20 7365 6c66  f.contexts, self
+00011f80: 2e74 6172 6765 742c 2066 696c 7465 7265  .target, filtere
+00011f90: 6467 6573 3d66 696c 7465 7265 6467 6573  dges=filteredges
+00011fa0: 290a 0a20 2020 2064 6566 2070 6c6f 745f  )..    def plot_
+00011fb0: 696e 7465 7270 7265 7461 7469 6f6e 2873  interpretation(s
+00011fc0: 656c 662c 2066 696c 7465 7265 6467 6573  elf, filteredges
+00011fd0: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+00011fe0: 6966 2066 696c 7465 7265 6467 6573 2069  if filteredges i
+00011ff0: 7320 4e6f 6e65 3a0a 2020 2020 2020 2020  s None:.        
+00012000: 2020 2020 6669 6c74 6572 6564 6765 7320      filteredges 
+00012010: 3d20 5b5b 2623 3334 3b26 2333 343b 2c20  = [[&#34;&#34;, 
+00012020: 2623 3334 3b26 2333 343b 2c20 2623 3334  &#34;&#34;, &#34
+00012030: 3b26 2333 343b 5d5d 0a20 2020 2020 2020  ;&#34;]].       
+00012040: 2073 686f 775f 636f 6e74 6578 745f 696e   show_context_in
+00012050: 7465 7270 7265 7461 7469 6f6e 7328 7365  terpretations(se
+00012060: 6c66 2e63 6f6e 7465 7874 732c 2073 656c  lf.contexts, sel
+00012070: 662e 7461 7267 6574 2c20 6669 6c74 6572  f.target, filter
+00012080: 6564 6765 733d 6669 6c74 6572 6564 6765  edges=filteredge
+00012090: 7329 3c2f 636f 6465 3e3c 2f70 7265 3e0a  s)</code></pre>.
+000120a0: 3c2f 6465 7461 696c 733e 0a3c 6833 3e4d  </details>.<h3>M
+000120b0: 6574 686f 6473 3c2f 6833 3e0a 3c64 6c3e  ethods</h3>.<dl>
+000120c0: 0a3c 6474 2069 643d 2250 646d 436f 6e74  .<dt id="PdmCont
+000120d0: 6578 742e 436f 6e74 6578 7447 656e 6572  ext.ContextGener
+000120e0: 6174 696f 6e2e 436f 6e74 6578 7447 656e  ation.ContextGen
+000120f0: 6572 6174 6f72 2e4e 756d 7079 5f70 7265  erator.Numpy_pre
+00012100: 7072 6f63 6365 7373 223e 3c63 6f64 6520  proccess"><code 
+00012110: 636c 6173 733d 226e 616d 6520 666c 6578  class="name flex
+00012120: 223e 0a3c 7370 616e 3e64 6566 203c 7370  ">.<span>def <sp
+00012130: 616e 2063 6c61 7373 3d22 6964 656e 7422  an class="ident"
+00012140: 3e4e 756d 7079 5f70 7265 7072 6f63 6365  >Numpy_preprocce
+00012150: 7373 3c2f 7370 616e 3e3c 2f73 7061 6e3e  ss</span></span>
+00012160: 283c 7370 616e 3e73 656c 662c 206e 7063  (<span>self, npc
+00012170: 6f6e 7465 7874 293c 2f73 7061 6e3e 0a3c  ontext)</span>.<
+00012180: 2f63 6f64 653e 3c2f 6474 3e0a 3c64 643e  /code></dt>.<dd>
+00012190: 0a3c 6469 7620 636c 6173 733d 2264 6573  .<div class="des
+000121a0: 6322 3e3c 2f64 6976 3e0a 3c64 6574 6169  c"></div>.<detai
+000121b0: 6c73 2063 6c61 7373 3d22 736f 7572 6365  ls class="source
+000121c0: 223e 0a3c 7375 6d6d 6172 793e 0a3c 7370  ">.<summary>.<sp
+000121d0: 616e 3e45 7870 616e 6420 736f 7572 6365  an>Expand source
+000121e0: 2063 6f64 653c 2f73 7061 6e3e 0a3c 2f73   code</span>.</s
+000121f0: 756d 6d61 7279 3e0a 3c70 7265 3e3c 636f  ummary>.<pre><co
+00012200: 6465 2063 6c61 7373 3d22 7079 7468 6f6e  de class="python
+00012210: 223e 6465 6620 4e75 6d70 795f 7072 6570  ">def Numpy_prep
+00012220: 726f 6363 6573 7328 7365 6c66 2c20 6e70  roccess(self, np
+00012230: 636f 6e74 6578 7429 3a0a 2020 2020 6e70  context):.    np
+00012240: 636f 6e74 6578 7420 3d20 6e70 2e77 6865  context = np.whe
+00012250: 7265 286e 7063 6f6e 7465 7874 203d 3d20  re(npcontext == 
+00012260: 2623 3334 3b6e 616e 2623 3334 3b2c 204e  &#34;nan&#34;, N
+00012270: 6f6e 652c 206e 7063 6f6e 7465 7874 290a  one, npcontext).
+00012280: 0a20 2020 206d 6173 6b20 3d20 5b28 2623  .    mask = [(&#
+00012290: 3339 3b30 5f26 2333 393b 2069 6e20 636f  39;0_&#39; in co
+000122a0: 6465 2061 6e64 2076 616c 7565 2069 7320  de and value is 
+000122b0: 4e6f 6e65 2920 666f 7220 636f 6465 2c20  None) for code, 
+000122c0: 7661 6c75 6520 696e 207a 6970 286e 7063  value in zip(npc
+000122d0: 6f6e 7465 7874 5b3a 2c20 315d 2c20 6e70  ontext[:, 1], np
+000122e0: 636f 6e74 6578 745b 3a2c 2033 5d29 5d0a  context[:, 3])].
+000122f0: 0a20 2020 2023 2069 6620 6973 696e 7374  .    # if isinst
+00012300: 616e 6365 286d 6173 6b2c 636f 6c6c 6563  ance(mask,collec
+00012310: 7469 6f6e 732e 6162 632e 5365 7175 656e  tions.abc.Sequen
+00012320: 6365 293d 3d46 616c 7365 3a0a 2020 2020  ce)==False:.    
+00012330: 2320 2020 2020 6d61 736b 3d5b 6d61 736b  #     mask=[mask
+00012340: 5d0a 2020 2020 6e70 636f 6e74 6578 745b  ].    npcontext[
+00012350: 6d61 736b 2c20 335d 203d 2030 0a20 2020  mask, 3] = 0.   
+00012360: 206d 6173 6b20 3d20 5b28 2623 3339 3b31   mask = [(&#39;1
+00012370: 5f26 2333 393b 2069 6e20 636f 6465 2061  _&#39; in code a
+00012380: 6e64 2076 616c 7565 2069 7320 4e6f 6e65  nd value is None
+00012390: 2920 666f 7220 636f 6465 2c20 7661 6c75  ) for code, valu
+000123a0: 6520 696e 207a 6970 286e 7063 6f6e 7465  e in zip(npconte
+000123b0: 7874 5b3a 2c20 315d 2c20 6e70 636f 6e74  xt[:, 1], npcont
+000123c0: 6578 745b 3a2c 2033 5d29 5d0a 2020 2020  ext[:, 3])].    
+000123d0: 6e70 636f 6e74 6578 745b 6d61 736b 2c20  npcontext[mask, 
+000123e0: 335d 203d 2031 0a20 2020 2063 6f64 655f  3] = 1.    code_
+000123f0: 7769 7468 5f73 6f75 7263 6520 3d20 5b66  with_source = [f
+00012400: 2623 3334 3b7b 636f 6465 7d7b 736f 7572  &#34;{code}{sour
+00012410: 6365 7d26 2333 343b 2069 6620 736f 7572  ce}&#34; if sour
+00012420: 6365 5b30 5d20 3d3d 2026 2333 343b 4026  ce[0] == &#34;@&
+00012430: 2333 343b 2065 6c73 6520 6626 2333 343b  #34; else f&#34;
+00012440: 7b63 6f64 657d 407b 736f 7572 6365 7d26  {code}@{source}&
+00012450: 2333 343b 2066 6f72 2063 6f64 652c 2073  #34; for code, s
+00012460: 6f75 7263 6520 696e 0a20 2020 2020 2020  ource in.       
+00012470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012480: 207a 6970 286e 7063 6f6e 7465 7874 5b3a   zip(npcontext[:
+00012490: 2c20 315d 2c20 6e70 636f 6e74 6578 745b  , 1], npcontext[
+000124a0: 3a2c 2032 5d29 5d0a 2020 2020 6e70 636f  :, 2])].    npco
+000124b0: 6e74 6578 745b 3a2c 2031 5d20 3d20 636f  ntext[:, 1] = co
+000124c0: 6465 5f77 6974 685f 736f 7572 6365 0a0a  de_with_source..
+000124d0: 2020 2020 7265 7475 726e 206e 7063 6f6e      return npcon
+000124e0: 7465 7874 3c2f 636f 6465 3e3c 2f70 7265  text</code></pre
+000124f0: 3e0a 3c2f 6465 7461 696c 733e 0a3c 2f64  >.</details>.</d
+00012500: 643e 0a3c 6474 2069 643d 2250 646d 436f  d>.<dt id="PdmCo
+00012510: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+00012520: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+00012530: 656e 6572 6174 6f72 2e61 6464 5f74 6f5f  enerator.add_to_
+00012540: 6275 6666 6572 223e 3c63 6f64 6520 636c  buffer"><code cl
+00012550: 6173 733d 226e 616d 6520 666c 6578 223e  ass="name flex">
+00012560: 0a3c 7370 616e 3e64 6566 203c 7370 616e  .<span>def <span
+00012570: 2063 6c61 7373 3d22 6964 656e 7422 3e61   class="ident">a
+00012580: 6464 5f74 6f5f 6275 6666 6572 3c2f 7370  dd_to_buffer</sp
+00012590: 616e 3e3c 2f73 7061 6e3e 283c 7370 616e  an></span>(<span
+000125a0: 3e73 656c 662c 2065 3ac2 a03c 6120 7469  >self, e:..<a ti
+000125b0: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
+000125c0: 7574 696c 732e 7374 7275 6374 7572 652e  utils.structure.
+000125d0: 4576 656e 7470 6f69 6e74 2220 6872 6566  Eventpoint" href
+000125e0: 3d22 7574 696c 732f 7374 7275 6374 7572  ="utils/structur
+000125f0: 652e 6874 6d6c 2350 646d 436f 6e74 6578  e.html#PdmContex
+00012600: 742e 7574 696c 732e 7374 7275 6374 7572  t.utils.structur
+00012610: 652e 4576 656e 7470 6f69 6e74 223e 4576  e.Eventpoint">Ev
+00012620: 656e 7470 6f69 6e74 3c2f 613e 2c20 7265  entpoint</a>, re
+00012630: 706c 6163 653a c2a0 6c69 7374 293c 2f73  place:..list)</s
+00012640: 7061 6e3e 0a3c 2f63 6f64 653e 3c2f 6474  pan>.</code></dt
+00012650: 3e0a 3c64 643e 0a3c 6469 7620 636c 6173  >.<dd>.<div clas
+00012660: 733d 2264 6573 6322 3e3c 703e 4164 6473  s="desc"><p>Adds
+00012670: 2061 6e20 4576 656e 7420 706f 696e 7420   an Event point 
+00012680: 746f 2074 6865 2062 7566 6665 7220 286b  to the buffer (k
+00012690: 6565 7069 6e67 2074 6865 2062 7566 6665  eeping the buffe
+000126a0: 7220 7469 6d65 206f 7264 6572 6564 293c  r time ordered)<
+000126b0: 2f70 3e3c 2f64 6976 3e0a 3c64 6574 6169  /p></div>.<detai
+000126c0: 6c73 2063 6c61 7373 3d22 736f 7572 6365  ls class="source
+000126d0: 223e 0a3c 7375 6d6d 6172 793e 0a3c 7370  ">.<summary>.<sp
+000126e0: 616e 3e45 7870 616e 6420 736f 7572 6365  an>Expand source
+000126f0: 2063 6f64 653c 2f73 7061 6e3e 0a3c 2f73   code</span>.</s
+00012700: 756d 6d61 7279 3e0a 3c70 7265 3e3c 636f  ummary>.<pre><co
+00012710: 6465 2063 6c61 7373 3d22 7079 7468 6f6e  de class="python
+00012720: 223e 6465 6620 6164 645f 746f 5f62 7566  ">def add_to_buf
+00012730: 6665 7228 7365 6c66 2c20 653a 2045 7665  fer(self, e: Eve
+00012740: 6e74 706f 696e 742c 2072 6570 6c61 6365  ntpoint, replace
+00012750: 3a20 6c69 7374 293a 0a20 2020 2026 2333  : list):.    &#3
+00012760: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
+00012770: 2041 6464 7320 616e 2045 7665 6e74 2070   Adds an Event p
+00012780: 6f69 6e74 2074 6f20 7468 6520 6275 6666  oint to the buff
+00012790: 6572 2028 6b65 6570 696e 6720 7468 6520  er (keeping the 
+000127a0: 6275 6666 6572 2074 696d 6520 6f72 6465  buffer time orde
+000127b0: 7265 6429 0a20 2020 2026 2333 343b 2623  red).    &#34;&#
+000127c0: 3334 3b26 2333 343b 0a20 2020 2069 6e64  34;&#34;.    ind
+000127d0: 6578 203d 206c 656e 2873 656c 662e 6275  ex = len(self.bu
+000127e0: 6666 6572 290a 2020 2020 666f 7220 6920  ffer).    for i 
+000127f0: 696e 2072 616e 6765 286c 656e 2873 656c  in range(len(sel
+00012800: 662e 6275 6666 6572 2920 2d20 312c 2030  f.buffer) - 1, 0
+00012810: 2c20 2d31 293a 0a20 2020 2020 2020 2023  , -1):.        #
+00012820: 2063 6865 636b 2066 6f72 2072 6570 6c61   check for repla
+00012830: 6365 6d65 6e74 0a20 2020 2020 2020 2069  cement.        i
+00012840: 6620 7365 6c66 2e62 7566 6665 725b 695d  f self.buffer[i]
+00012850: 2e74 696d 6573 7461 6d70 203d 3d20 652e  .timestamp == e.
+00012860: 7469 6d65 7374 616d 703a 0a20 2020 2020  timestamp:.     
+00012870: 2020 2020 2020 2066 6f72 2072 6570 2069         for rep i
+00012880: 6e20 7265 706c 6163 653a 0a20 2020 2020  n replace:.     
+00012890: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+000128a0: 6c66 2e62 7566 6665 725b 695d 2e63 6f64  lf.buffer[i].cod
+000128b0: 653d 3d72 6570 5b30 5d20 616e 6420 652e  e==rep[0] and e.
+000128c0: 636f 6465 3d3d 7265 705b 315d 3a0a 2020  code==rep[1]:.  
+000128d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000128e0: 2020 7365 6c66 2e62 7566 6665 725b 695d    self.buffer[i]
+000128f0: 3d65 0a20 2020 2020 2020 2020 2020 2020  =e.             
+00012900: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+00012910: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+00012920: 3d20 6920 2b20 310a 2020 2020 2020 2020  = i + 1.        
+00012930: 6966 2073 656c 662e 6275 6666 6572 5b69  if self.buffer[i
+00012940: 5d2e 7469 6d65 7374 616d 7020 266c 743b  ].timestamp &lt;
+00012950: 2065 2e74 696d 6573 7461 6d70 3a0a 2020   e.timestamp:.  
+00012960: 2020 2020 2020 2020 2020 696e 6465 7820            index 
+00012970: 3d20 6920 2b20 310a 2020 2020 2020 2020  = i + 1.        
+00012980: 2020 2020 6272 6561 6b0a 2020 2020 6966      break.    if
+00012990: 2069 6e64 6578 203d 3d20 6c65 6e28 7365   index == len(se
+000129a0: 6c66 2e62 7566 6665 7229 3a0a 2020 2020  lf.buffer):.    
+000129b0: 2020 2020 7365 6c66 2e62 7566 6665 722e      self.buffer.
+000129c0: 6170 7065 6e64 2865 290a 2020 2020 656c  append(e).    el
+000129d0: 7365 3a0a 2020 2020 2020 2020 7365 6c66  se:.        self
+000129e0: 2e62 7566 6665 7220 3d20 7365 6c66 2e62  .buffer = self.b
+000129f0: 7566 6665 725b 3a20 696e 6465 785d 202b  uffer[: index] +
+00012a00: 205b 655d 202b 2073 656c 662e 6275 6666   [e] + self.buff
+00012a10: 6572 5b69 6e64 6578 3a5d 0a0a 2020 2020  er[index:]..    
+00012a20: 6c61 7374 203d 2073 656c 662e 6275 6666  last = self.buff
+00012a30: 6572 5b2d 315d 0a20 2020 2070 6f73 203d  er[-1].    pos =
+00012a40: 206c 656e 2873 656c 662e 6275 6666 6572   len(self.buffer
+00012a50: 2920 2d20 310a 2020 2020 666f 7220 6920  ) - 1.    for i 
+00012a60: 696e 2072 616e 6765 286c 656e 2873 656c  in range(len(sel
+00012a70: 662e 6275 6666 6572 2929 3a0a 2020 2020  f.buffer)):.    
+00012a80: 2020 2020 6966 2073 656c 662e 6275 6666      if self.buff
+00012a90: 6572 5b69 5d2e 7469 6d65 7374 616d 7020  er[i].timestamp 
+00012aa0: 2667 743b 3d20 286c 6173 742e 7469 6d65  &gt;= (last.time
+00012ab0: 7374 616d 7020 2d20 7064 2e54 696d 6564  stamp - pd.Timed
+00012ac0: 656c 7461 2873 656c 662e 686f 7269 7a6f  elta(self.horizo
+00012ad0: 6e2c 2073 656c 662e 686f 7269 7a6f 6e5f  n, self.horizon_
+00012ae0: 7469 6d65 2929 3a0a 2020 2020 2020 2020  time)):.        
+00012af0: 2020 2020 706f 7320 3d20 690a 2020 2020      pos = i.    
+00012b00: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00012b10: 2020 7365 6c66 2e62 7566 6665 7220 3d20    self.buffer = 
+00012b20: 7365 6c66 2e62 7566 6665 725b 706f 733a  self.buffer[pos:
+00012b30: 5d3c 2f63 6f64 653e 3c2f 7072 653e 0a3c  ]</code></pre>.<
+00012b40: 2f64 6574 6169 6c73 3e0a 3c2f 6464 3e0a  /details>.</dd>.
+00012b50: 3c64 7420 6964 3d22 5064 6d43 6f6e 7465  <dt id="PdmConte
+00012b60: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
+00012b70: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
+00012b80: 7261 746f 722e 6275 696c 645f 636f 6e74  rator.build_cont
+00012b90: 6578 745f 666f 725f 636f 6e66 6975 6775  ext_for_confiugu
+00012ba0: 7261 7469 6f6e 223e 3c63 6f64 6520 636c  ration"><code cl
+00012bb0: 6173 733d 226e 616d 6520 666c 6578 223e  ass="name flex">
+00012bc0: 0a3c 7370 616e 3e64 6566 203c 7370 616e  .<span>def <span
+00012bd0: 2063 6c61 7373 3d22 6964 656e 7422 3e62   class="ident">b
+00012be0: 7569 6c64 5f63 6f6e 7465 7874 5f66 6f72  uild_context_for
+00012bf0: 5f63 6f6e 6669 7567 7572 6174 696f 6e3c  _confiuguration<
+00012c00: 2f73 7061 6e3e 3c2f 7370 616e 3e28 3c73  /span></span>(<s
+00012c10: 7061 6e3e 7365 6c66 2c20 7461 7267 6574  pan>self, target
+00012c20: 5f73 6572 6965 732c 206f 6363 7572 656e  _series, occuren
+00012c30: 6369 6573 293c 2f73 7061 6e3e 0a3c 2f63  cies)</span>.</c
+00012c40: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
+00012c50: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
+00012c60: 3e3c 2f64 6976 3e0a 3c64 6574 6169 6c73  ></div>.<details
+00012c70: 2063 6c61 7373 3d22 736f 7572 6365 223e   class="source">
+00012c80: 0a3c 7375 6d6d 6172 793e 0a3c 7370 616e  .<summary>.<span
+00012c90: 3e45 7870 616e 6420 736f 7572 6365 2063  >Expand source c
+00012ca0: 6f64 653c 2f73 7061 6e3e 0a3c 2f73 756d  ode</span>.</sum
+00012cb0: 6d61 7279 3e0a 3c70 7265 3e3c 636f 6465  mary>.<pre><code
+00012cc0: 2063 6c61 7373 3d22 7079 7468 6f6e 223e   class="python">
+00012cd0: 6465 6620 6275 696c 645f 636f 6e74 6578  def build_contex
+00012ce0: 745f 666f 725f 636f 6e66 6975 6775 7261  t_for_confiugura
+00012cf0: 7469 6f6e 2873 656c 662c 2074 6172 6765  tion(self, targe
+00012d00: 745f 7365 7269 6573 2c20 6f63 6375 7265  t_series, occure
+00012d10: 6e63 6965 7329 3a0a 2020 2020 7665 6374  ncies):.    vect
+00012d20: 6f72 203d 205b 3020 666f 7220 6920 696e  or = [0 for i in
+00012d30: 2072 616e 6765 286c 656e 2874 6172 6765   range(len(targe
+00012d40: 745f 7365 7269 6573 2929 5d0a 2020 2020  t_series))].    
+00012d50: 666f 7220 6f63 6320 696e 206f 6363 7572  for occ in occur
+00012d60: 656e 6369 6573 3a0a 2020 2020 2020 2020  encies:.        
+00012d70: 666f 7220 7120 696e 2072 616e 6765 286c  for q in range(l
+00012d80: 656e 2874 6172 6765 745f 7365 7269 6573  en(target_series
+00012d90: 2929 3a0a 2020 2020 2020 2020 2020 2020  )):.            
+00012da0: 6966 2074 6172 6765 745f 7365 7269 6573  if target_series
+00012db0: 5b71 5d5b 315d 2026 6774 3b3d 206f 6363  [q][1] &gt;= occ
+00012dc0: 5b31 5d3a 0a20 2020 2020 2020 2020 2020  [1]:.           
+00012dd0: 2020 2020 2066 6f72 206b 2069 6e20 7261       for k in ra
+00012de0: 6e67 6528 712c 206c 656e 2876 6563 746f  nge(q, len(vecto
+00012df0: 7229 293a 0a20 2020 2020 2020 2020 2020  r)):.           
+00012e00: 2020 2020 2020 2020 2076 6563 746f 725b           vector[
+00012e10: 6b5d 202b 3d20 310a 2020 2020 2020 2020  k] += 1.        
+00012e20: 2020 2020 2020 2020 6272 6561 6b0a 2020          break.  
+00012e30: 2020 2323 206e 6f74 2073 7461 626c 650a    ## not stable.
+00012e40: 2020 2020 6966 206c 656e 2873 6574 2876      if len(set(v
+00012e50: 6563 746f 7229 2920 3d3d 2031 3a0a 2020  ector)) == 1:.  
+00012e60: 2020 2020 2020 7665 6374 6f72 5b30 5d20        vector[0] 
+00012e70: 3d20 300a 2020 2020 7265 7475 726e 2076  = 0.    return v
+00012e80: 6563 746f 723c 2f63 6f64 653e 3c2f 7072  ector</code></pr
+00012e90: 653e 0a3c 2f64 6574 6169 6c73 3e0a 3c2f  e>.</details>.</
+00012ea0: 6464 3e0a 3c64 7420 6964 3d22 5064 6d43  dd>.<dt id="PdmC
+00012eb0: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
+00012ec0: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
+00012ed0: 4765 6e65 7261 746f 722e 6275 696c 645f  Generator.build_
+00012ee0: 636f 6e74 6578 745f 666f 725f 6973 6f6c  context_for_isol
+00012ef0: 6174 6564 223e 3c63 6f64 6520 636c 6173  ated"><code clas
+00012f00: 733d 226e 616d 6520 666c 6578 223e 0a3c  s="name flex">.<
+00012f10: 7370 616e 3e64 6566 203c 7370 616e 2063  span>def <span c
+00012f20: 6c61 7373 3d22 6964 656e 7422 3e62 7569  lass="ident">bui
+00012f30: 6c64 5f63 6f6e 7465 7874 5f66 6f72 5f69  ld_context_for_i
+00012f40: 736f 6c61 7465 643c 2f73 7061 6e3e 3c2f  solated</span></
+00012f50: 7370 616e 3e28 3c73 7061 6e3e 7365 6c66  span>(<span>self
+00012f60: 2c20 7461 7267 6574 5f73 6572 6965 732c  , target_series,
+00012f70: 206f 6363 7572 656e 6369 6573 293c 2f73   occurencies)</s
+00012f80: 7061 6e3e 0a3c 2f63 6f64 653e 3c2f 6474  pan>.</code></dt
+00012f90: 3e0a 3c64 643e 0a3c 6469 7620 636c 6173  >.<dd>.<div clas
+00012fa0: 733d 2264 6573 6322 3e3c 2f64 6976 3e0a  s="desc"></div>.
+00012fb0: 3c64 6574 6169 6c73 2063 6c61 7373 3d22  <details class="
+00012fc0: 736f 7572 6365 223e 0a3c 7375 6d6d 6172  source">.<summar
+00012fd0: 793e 0a3c 7370 616e 3e45 7870 616e 6420  y>.<span>Expand 
+00012fe0: 736f 7572 6365 2063 6f64 653c 2f73 7061  source code</spa
+00012ff0: 6e3e 0a3c 2f73 756d 6d61 7279 3e0a 3c70  n>.</summary>.<p
+00013000: 7265 3e3c 636f 6465 2063 6c61 7373 3d22  re><code class="
+00013010: 7079 7468 6f6e 223e 6465 6620 6275 696c  python">def buil
+00013020: 645f 636f 6e74 6578 745f 666f 725f 6973  d_context_for_is
+00013030: 6f6c 6174 6564 2873 656c 662c 2074 6172  olated(self, tar
+00013040: 6765 745f 7365 7269 6573 2c20 6f63 6375  get_series, occu
+00013050: 7265 6e63 6965 7329 3a0a 2020 2020 7665  rencies):.    ve
+00013060: 6374 6f72 203d 205b 3020 666f 7220 6920  ctor = [0 for i 
+00013070: 696e 2072 616e 6765 286c 656e 2874 6172  in range(len(tar
+00013080: 6765 745f 7365 7269 6573 2929 5d0a 2020  get_series))].  
+00013090: 2020 666f 7220 6f63 6320 696e 206f 6363    for occ in occ
+000130a0: 7572 656e 6369 6573 3a0a 2020 2020 2020  urencies:.      
+000130b0: 2020 666f 7220 7120 696e 2072 616e 6765    for q in range
+000130c0: 286c 656e 2874 6172 6765 745f 7365 7269  (len(target_seri
+000130d0: 6573 2929 3a0a 2020 2020 2020 2020 2020  es)):.          
+000130e0: 2020 6966 2074 6172 6765 745f 7365 7269    if target_seri
+000130f0: 6573 5b71 5d5b 315d 2026 6774 3b20 6f63  es[q][1] &gt; oc
+00013100: 635b 315d 3a0a 2020 2020 2020 2020 2020  c[1]:.          
+00013110: 2020 2020 2020 7665 6374 6f72 5b71 5d20        vector[q] 
+00013120: 3d20 310a 2020 2020 2020 2020 2020 2020  = 1.            
+00013130: 2020 2020 6272 6561 6b0a 2020 2020 7265      break.    re
+00013140: 7475 726e 2076 6563 746f 723c 2f63 6f64  turn vector</cod
+00013150: 653e 3c2f 7072 653e 0a3c 2f64 6574 6169  e></pre>.</detai
+00013160: 6c73 3e0a 3c2f 6464 3e0a 3c64 7420 6964  ls>.</dd>.<dt id
+00013170: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+00013180: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+00013190: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
+000131a0: 6275 696c 645f 636f 6e74 6578 745f 666f  build_context_fo
+000131b0: 725f 756e 6976 6172 6961 7465 223e 3c63  r_univariate"><c
+000131c0: 6f64 6520 636c 6173 733d 226e 616d 6520  ode class="name 
+000131d0: 666c 6578 223e 0a3c 7370 616e 3e64 6566  flex">.<span>def
+000131e0: 203c 7370 616e 2063 6c61 7373 3d22 6964   <span class="id
+000131f0: 656e 7422 3e62 7569 6c64 5f63 6f6e 7465  ent">build_conte
+00013200: 7874 5f66 6f72 5f75 6e69 7661 7269 6174  xt_for_univariat
+00013210: 653c 2f73 7061 6e3e 3c2f 7370 616e 3e28  e</span></span>(
+00013220: 3c73 7061 6e3e 7365 6c66 2c20 7461 7267  <span>self, targ
+00013230: 6574 5f73 6572 6965 732c 206f 6363 7572  et_series, occur
+00013240: 656e 6369 6573 293c 2f73 7061 6e3e 0a3c  encies)</span>.<
+00013250: 2f63 6f64 653e 3c2f 6474 3e0a 3c64 643e  /code></dt>.<dd>
+00013260: 0a3c 6469 7620 636c 6173 733d 2264 6573  .<div class="des
+00013270: 6322 3e3c 2f64 6976 3e0a 3c64 6574 6169  c"></div>.<detai
+00013280: 6c73 2063 6c61 7373 3d22 736f 7572 6365  ls class="source
+00013290: 223e 0a3c 7375 6d6d 6172 793e 0a3c 7370  ">.<summary>.<sp
+000132a0: 616e 3e45 7870 616e 6420 736f 7572 6365  an>Expand source
+000132b0: 2063 6f64 653c 2f73 7061 6e3e 0a3c 2f73   code</span>.</s
+000132c0: 756d 6d61 7279 3e0a 3c70 7265 3e3c 636f  ummary>.<pre><co
+000132d0: 6465 2063 6c61 7373 3d22 7079 7468 6f6e  de class="python
+000132e0: 223e 6465 6620 6275 696c 645f 636f 6e74  ">def build_cont
+000132f0: 6578 745f 666f 725f 756e 6976 6172 6961  ext_for_univaria
+00013300: 7465 2873 656c 662c 2074 6172 6765 745f  te(self, target_
+00013310: 7365 7269 6573 2c20 6f63 6375 7265 6e63  series, occurenc
+00013320: 6965 7329 3a0a 2020 2020 616c 6c76 616c  ies):.    allval
+00013330: 7565 7320 3d20 5b5d 0a20 2020 2076 6563  ues = [].    vec
+00013340: 746f 7220 3d20 5b30 2066 6f72 2069 2069  tor = [0 for i i
+00013350: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
+00013360: 6574 5f73 6572 6965 7329 295d 0a20 2020  et_series))].   
+00013370: 2070 6f73 203d 2030 0a20 2020 2066 6f72   pos = 0.    for
+00013380: 2069 2069 6e20 7261 6e67 6528 6c65 6e28   i in range(len(
+00013390: 7461 7267 6574 5f73 6572 6965 7329 293a  target_series)):
+000133a0: 0a20 2020 2020 2020 2074 696d 6573 7461  .        timesta
+000133b0: 6d70 203d 2074 6172 6765 745f 7365 7269  mp = target_seri
+000133c0: 6573 5b69 5d5b 315d 0a20 2020 2020 2020  es[i][1].       
+000133d0: 2063 7572 7265 6e74 5f70 6f73 203d 2070   current_pos = p
+000133e0: 6f73 0a20 2020 2020 2020 2066 6f72 2071  os.        for q
+000133f0: 2069 6e20 7261 6e67 6528 706f 732c 206c   in range(pos, l
+00013400: 656e 286f 6363 7572 656e 6369 6573 2929  en(occurencies))
+00013410: 3a0a 2020 2020 2020 2020 2020 2020 6966  :.            if
+00013420: 206f 6363 7572 656e 6369 6573 5b71 5d5b   occurencies[q][
+00013430: 315d 2026 6774 3b20 7469 6d65 7374 616d  1] &gt; timestam
+00013440: 703a 0a20 2020 2020 2020 2020 2020 2020  p:.             
+00013450: 2020 2063 7572 7265 6e74 5f70 6f73 203d     current_pos =
+00013460: 2071 0a20 2020 2020 2020 2020 2020 2020   q.             
+00013470: 2020 2062 7265 616b 0a20 2020 2020 2020     break.       
+00013480: 2023 206e 6f20 6461 7461 2066 6f75 6e64   # no data found
+00013490: 0a0a 2020 2020 2020 2020 6966 2063 7572  ..        if cur
+000134a0: 7265 6e74 5f70 6f73 203d 3d20 706f 733a  rent_pos == pos:
+000134b0: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+000134c0: 6620 6e6f 2064 6174 6120 696e 2062 6574  f no data in bet
+000134d0: 7777 656e 2076 616c 7565 7320 7573 6520  wwen values use 
+000134e0: 7468 6520 7072 6576 6975 7320 7661 6c75  the previus valu
+000134f0: 650a 2020 2020 2020 2020 2020 2020 6966  e.            if
+00013500: 2069 2026 6774 3b20 303a 0a20 2020 2020   i &gt; 0:.     
+00013510: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+00013520: 725b 695d 203d 2076 6563 746f 725b 6920  r[i] = vector[i 
+00013530: 2d20 315d 0a20 2020 2020 2020 2020 2020  - 1].           
+00013540: 2023 2069 6620 6e6f 2064 6174 6120 756e   # if no data un
+00013550: 7469 6c20 6920 7469 6d65 7374 616d 7020  til i timestamp 
+00013560: 7573 6520 7468 6520 6669 7273 7420 6f63  use the first oc
+00013570: 6375 7265 6e63 6520 6173 2076 616c 7565  curence as value
+00013580: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00013590: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000135a0: 2020 2076 6563 746f 725b 695d 203d 206f     vector[i] = o
+000135b0: 6363 7572 656e 6369 6573 5b30 5d5b 305d  ccurencies[0][0]
+000135c0: 0a20 2020 2020 2020 2023 2069 6620 6d75  .        # if mu
+000135d0: 6c74 6970 6c65 2076 616c 7565 7320 696e  ltiple values in
+000135e0: 2062 6574 7765 656e 2074 776f 2074 696d   between two tim
+000135f0: 6573 7461 6d70 7320 7573 6520 7468 6520  estamps use the 
+00013600: 6d65 616e 206f 6620 7468 656d 2061 7320  mean of them as 
+00013610: 7661 6c75 650a 2020 2020 2020 2020 656c  value.        el
+00013620: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+00013630: 6461 7461 496e 4265 7477 6565 6e20 3d20  dataInBetween = 
+00013640: 5b76 616c 7565 2066 6f72 2076 616c 7565  [value for value
+00013650: 2c20 7469 6d65 2069 6e20 6f63 6375 7265  , time in occure
+00013660: 6e63 6965 735b 706f 733a 6375 7272 656e  ncies[pos:curren
+00013670: 745f 706f 735d 5d0a 2020 2020 2020 2020  t_pos]].        
+00013680: 2020 2020 7665 6374 6f72 5b69 5d20 3d20      vector[i] = 
+00013690: 7375 6d28 6461 7461 496e 4265 7477 6565  sum(dataInBetwee
+000136a0: 6e29 202f 206c 656e 2864 6174 6149 6e42  n) / len(dataInB
+000136b0: 6574 7765 656e 290a 2020 2020 2020 2020  etween).        
+000136c0: 2320 6966 206e 6f20 6f74 6865 7220 6f63  # if no other oc
+000136d0: 6375 7265 6e63 6965 7320 6a75 7374 2072  curencies just r
+000136e0: 6570 6561 7420 7468 6520 6c61 7374 2076  epeat the last v
+000136f0: 616c 7565 0a20 2020 2020 2020 2069 6620  alue.        if 
+00013700: 6375 7272 656e 745f 706f 7320 3d3d 206c  current_pos == l
+00013710: 656e 286f 6363 7572 656e 6369 6573 293a  en(occurencies):
+00013720: 0a20 2020 2020 2020 2020 2020 2066 6f72  .            for
+00013730: 206b 2069 6e20 7261 6e67 6528 6920 2b20   k in range(i + 
+00013740: 312c 206c 656e 2876 6563 746f 7229 293a  1, len(vector)):
+00013750: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013760: 2076 6563 746f 725b 6b5d 203d 2076 6563   vector[k] = vec
+00013770: 746f 725b 6b20 2d20 315d 0a20 2020 2020  tor[k - 1].     
+00013780: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+00013790: 2020 2020 2070 6f73 203d 2063 7572 7265       pos = curre
+000137a0: 6e74 5f70 6f73 0a0a 2020 2020 7265 7475  nt_pos..    retu
+000137b0: 726e 2076 6563 746f 723c 2f63 6f64 653e  rn vector</code>
+000137c0: 3c2f 7072 653e 0a3c 2f64 6574 6169 6c73  </pre>.</details
+000137d0: 3e0a 3c2f 6464 3e0a 3c64 7420 6964 3d22  >.</dd>.<dt id="
+000137e0: 5064 6d43 6f6e 7465 7874 2e43 6f6e 7465  PdmContext.Conte
+000137f0: 7874 4765 6e65 7261 7469 6f6e 2e43 6f6e  xtGeneration.Con
+00013800: 7465 7874 4765 6e65 7261 746f 722e 6275  textGenerator.bu
+00013810: 696c 645f 7461 7267 6574 5f73 6572 6965  ild_target_serie
+00013820: 735f 666f 725f 636f 6e74 6578 7422 3e3c  s_for_context"><
+00013830: 636f 6465 2063 6c61 7373 3d22 6e61 6d65  code class="name
+00013840: 2066 6c65 7822 3e0a 3c73 7061 6e3e 6465   flex">.<span>de
+00013850: 6620 3c73 7061 6e20 636c 6173 733d 2269  f <span class="i
+00013860: 6465 6e74 223e 6275 696c 645f 7461 7267  dent">build_targ
+00013870: 6574 5f73 6572 6965 735f 666f 725f 636f  et_series_for_co
+00013880: 6e74 6578 743c 2f73 7061 6e3e 3c2f 7370  ntext</span></sp
+00013890: 616e 3e28 3c73 7061 6e3e 7365 6c66 2c20  an>(<span>self, 
+000138a0: 6375 7272 656e 743a c2a0 3c61 2074 6974  current:..<a tit
+000138b0: 6c65 3d22 5064 6d43 6f6e 7465 7874 2e75  le="PdmContext.u
+000138c0: 7469 6c73 2e73 7472 7563 7475 7265 2e45  tils.structure.E
+000138d0: 7665 6e74 706f 696e 7422 2068 7265 663d  ventpoint" href=
+000138e0: 2275 7469 6c73 2f73 7472 7563 7475 7265  "utils/structure
+000138f0: 2e68 746d 6c23 5064 6d43 6f6e 7465 7874  .html#PdmContext
+00013900: 2e75 7469 6c73 2e73 7472 7563 7475 7265  .utils.structure
+00013910: 2e45 7665 6e74 706f 696e 7422 3e45 7665  .Eventpoint">Eve
+00013920: 6e74 706f 696e 743c 2f61 3e2c 2064 663a  ntpoint</a>, df:
+00013930: c2a0 6e75 6d70 792e 6e64 6172 7261 7929  ..numpy.ndarray)
+00013940: 3c2f 7370 616e 3e0a 3c2f 636f 6465 3e3c  </span>.</code><
+00013950: 2f64 743e 0a3c 6464 3e0a 3c64 6976 2063  /dt>.<dd>.<div c
+00013960: 6c61 7373 3d22 6465 7363 223e 3c2f 6469  lass="desc"></di
+00013970: 763e 0a3c 6465 7461 696c 7320 636c 6173  v>.<details clas
+00013980: 733d 2273 6f75 7263 6522 3e0a 3c73 756d  s="source">.<sum
+00013990: 6d61 7279 3e0a 3c73 7061 6e3e 4578 7061  mary>.<span>Expa
+000139a0: 6e64 2073 6f75 7263 6520 636f 6465 3c2f  nd source code</
+000139b0: 7370 616e 3e0a 3c2f 7375 6d6d 6172 793e  span>.</summary>
+000139c0: 0a3c 7072 653e 3c63 6f64 6520 636c 6173  .<pre><code clas
+000139d0: 733d 2270 7974 686f 6e22 3e64 6566 2062  s="python">def b
+000139e0: 7569 6c64 5f74 6172 6765 745f 7365 7269  uild_target_seri
+000139f0: 6573 5f66 6f72 5f63 6f6e 7465 7874 2873  es_for_context(s
+00013a00: 656c 662c 2063 7572 7265 6e74 3a20 4576  elf, current: Ev
+00013a10: 656e 7470 6f69 6e74 2c20 6466 3a20 6e70  entpoint, df: np
+00013a20: 2e6e 6461 7272 6179 293a 0a20 2020 2074  .ndarray):.    t
+00013a30: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
+00013a40: 6520 3d20 6375 7272 656e 742e 636f 6465  e = current.code
+00013a50: 0a20 2020 2077 696e 646f 7776 616c 7565  .    windowvalue
+00013a60: 7320 3d20 6466 2020 2320 2e76 616c 7565  s = df  # .value
+00013a70: 730a 2020 2020 7461 7267 6574 5f73 6572  s.    target_ser
+00013a80: 6965 7320 3d20 5b28 7661 6c75 652c 2074  ies = [(value, t
+00013a90: 696d 6529 2066 6f72 2063 6f64 652c 2076  ime) for code, v
+00013aa0: 616c 7565 2c20 7469 6d65 2069 6e0a 2020  alue, time in.  
+00013ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013ac0: 2020 207a 6970 2877 696e 646f 7776 616c     zip(windowval
+00013ad0: 7565 735b 3a2c 2031 5d2c 2077 696e 646f  ues[:, 1], windo
+00013ae0: 7776 616c 7565 735b 3a2c 2033 5d2c 2077  wvalues[:, 3], w
+00013af0: 696e 646f 7776 616c 7565 735b 3a2c 2030  indowvalues[:, 0
+00013b00: 5d29 2069 6620 7461 7267 6574 5f73 6572  ]) if target_ser
+00013b10: 6965 735f 6e61 6d65 2069 6e20 636f 6465  ies_name in code
+00013b20: 5d0a 0a20 2020 2072 6574 7572 6e20 7461  ]..    return ta
+00013b30: 7267 6574 5f73 6572 6965 735f 6e61 6d65  rget_series_name
+00013b40: 2c20 7461 7267 6574 5f73 6572 6965 733c  , target_series<
+00013b50: 2f63 6f64 653e 3c2f 7072 653e 0a3c 2f64  /code></pre>.</d
+00013b60: 6574 6169 6c73 3e0a 3c2f 6464 3e0a 3c64  etails>.</dd>.<d
+00013b70: 7420 6964 3d22 5064 6d43 6f6e 7465 7874  t id="PdmContext
+00013b80: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+00013b90: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+00013ba0: 746f 722e 6361 6c63 756c 6174 655f 6361  tor.calculate_ca
+00013bb0: 7573 616c 6974 7922 3e3c 636f 6465 2063  usality"><code c
+00013bc0: 6c61 7373 3d22 6e61 6d65 2066 6c65 7822  lass="name flex"
+00013bd0: 3e0a 3c73 7061 6e3e 6465 6620 3c73 7061  >.<span>def <spa
+00013be0: 6e20 636c 6173 733d 2269 6465 6e74 223e  n class="ident">
+00013bf0: 6361 6c63 756c 6174 655f 6361 7573 616c  calculate_causal
+00013c00: 6974 793c 2f73 7061 6e3e 3c2f 7370 616e  ity</span></span
+00013c10: 3e28 3c73 7061 6e3e 7365 6c66 2c20 6461  >(<span>self, da
+00013c20: 7461 6f72 2c20 6e61 6d65 7329 3c2f 7370  taor, names)</sp
+00013c30: 616e 3e0a 3c2f 636f 6465 3e3c 2f64 743e  an>.</code></dt>
+00013c40: 0a3c 6464 3e0a 3c64 6976 2063 6c61 7373  .<dd>.<div class
+00013c50: 3d22 6465 7363 223e 3c2f 6469 763e 0a3c  ="desc"></div>.<
+00013c60: 6465 7461 696c 7320 636c 6173 733d 2273  details class="s
+00013c70: 6f75 7263 6522 3e0a 3c73 756d 6d61 7279  ource">.<summary
+00013c80: 3e0a 3c73 7061 6e3e 4578 7061 6e64 2073  >.<span>Expand s
+00013c90: 6f75 7263 6520 636f 6465 3c2f 7370 616e  ource code</span
+00013ca0: 3e0a 3c2f 7375 6d6d 6172 793e 0a3c 7072  >.</summary>.<pr
+00013cb0: 653e 3c63 6f64 6520 636c 6173 733d 2270  e><code class="p
+00013cc0: 7974 686f 6e22 3e64 6566 2063 616c 6375  ython">def calcu
+00013cd0: 6c61 7465 5f63 6175 7361 6c69 7479 2873  late_causality(s
+00013ce0: 656c 662c 2064 6174 616f 722c 206e 616d  elf, dataor, nam
+00013cf0: 6573 293a 0a20 2020 206e 756d 5f74 696d  es):.    num_tim
+00013d00: 655f 7365 7269 6573 203d 206c 656e 2864  e_series = len(d
+00013d10: 6174 616f 7229 0a20 2020 2064 6174 6120  ataor).    data 
+00013d20: 3d20 6e70 2e61 7272 6179 2864 6174 616f  = np.array(datao
+00013d30: 7229 0a20 2020 2065 6467 6573 203d 2073  r).    edges = s
+00013d40: 656c 662e 6361 7573 616c 6974 795f 6469  elf.causality_di
+00013d50: 7363 6f76 6572 7928 6e61 6d65 732c 2064  scovery(names, d
+00013d60: 6174 6129 0a20 2020 2023 2065 6467 6573  ata).    # edges
+00013d70: 3d73 656c 662e 6361 6c63 756c 6174 6577  =self.calculatew
+00013d80: 6974 6850 6328 6e61 6d65 732c 6461 7461  ithPc(names,data
+00013d90: 290a 2020 2020 2320 6564 6765 733d 7365  ).    # edges=se
+00013da0: 6c66 2e63 616c 6375 6c61 7465 7769 7468  lf.calculatewith
+00013db0: 5f66 6369 286e 616d 6573 2c64 6174 6129  _fci(names,data)
+00013dc0: 0a20 2020 2023 2065 6467 6573 3d73 656c  .    # edges=sel
+00013dd0: 662e 7361 6c65 7366 6f72 6365 5043 286e  f.salesforcePC(n
+00013de0: 616d 6573 2c64 6174 6129 0a20 2020 2072  ames,data).    r
+00013df0: 6574 7572 6e20 6564 6765 733c 2f63 6f64  eturn edges</cod
+00013e00: 653e 3c2f 7072 653e 0a3c 2f64 6574 6169  e></pre>.</detai
+00013e10: 6c73 3e0a 3c2f 6464 3e0a 3c64 7420 6964  ls>.</dd>.<dt id
+00013e20: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+00013e30: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+00013e40: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
+00013e50: 6361 6c63 756c 6174 655f 6564 6765 7322  calculate_edges"
+00013e60: 3e3c 636f 6465 2063 6c61 7373 3d22 6e61  ><code class="na
+00013e70: 6d65 2066 6c65 7822 3e0a 3c73 7061 6e3e  me flex">.<span>
+00013e80: 6465 6620 3c73 7061 6e20 636c 6173 733d  def <span class=
+00013e90: 2269 6465 6e74 223e 6361 6c63 756c 6174  "ident">calculat
+00013ea0: 655f 6564 6765 733c 2f73 7061 6e3e 3c2f  e_edges</span></
+00013eb0: 7370 616e 3e28 3c73 7061 6e3e 7365 6c66  span>(<span>self
+00013ec0: 2c20 616c 6c64 6174 612c 2074 696d 6573  , alldata, times
+00013ed0: 7461 6d70 293c 2f73 7061 6e3e 0a3c 2f63  tamp)</span>.</c
+00013ee0: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
+00013ef0: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
+00013f00: 3e3c 703e 466f 726d 756c 6174 6520 7468  ><p>Formulate th
+00013f10: 6520 6461 7461 2069 6e20 6170 7072 6f70  e data in approp
+00013f20: 7269 6174 6520 666f 726d 2074 6f20 6361  riate form to ca
+00013f30: 6c6c 2073 656c 662e 6361 6c63 756c 6174  ll self.calculat
+00013f40: 655f 6361 7573 616c 6974 790a 7768 6963  e_causality.whic
+00013f50: 6820 7265 7475 726e 2074 6865 2065 6467  h return the edg
+00013f60: 6573 2066 6f72 2074 6865 2063 6f6e 7465  es for the conte
+00013f70: 7874 2e3c 2f70 3e0a 3c70 3e3c 7374 726f  xt.</p>.<p><stro
+00013f80: 6e67 3e50 6172 616d 6574 6572 733c 2f73  ng>Parameters</s
+00013f90: 7472 6f6e 673e 3a3c 2f70 3e0a 3c70 3e3c  trong>:</p>.<p><
+00013fa0: 7374 726f 6e67 3e61 6c6c 6461 7461 3c2f  strong>alldata</
+00013fb0: 7374 726f 6e67 3e3a 2061 2032 4420 6e75  strong>: a 2D nu
+00013fc0: 6d70 7920 6172 7261 7920 7769 7468 2061  mpy array with a
+00013fd0: 6c6c 2073 6572 6965 7320 6461 7461 2028  ll series data (
+00013fe0: 6571 7569 7661 6c65 6e74 2074 6f20 7468  equivalent to th
+00013ff0: 6520 4344 206f 6620 7468 6520 436f 6e74  e CD of the Cont
+00014000: 6578 7429 3c2f 703e 0a3c 703e 3c73 7472  ext)</p>.<p><str
+00014010: 6f6e 673e 7469 6d65 7374 616d 703c 2f73  ong>timestamp</s
+00014020: 7472 6f6e 673e 3a20 7469 6d65 7374 616d  trong>: timestam
+00014030: 7020 6f66 2074 6865 2063 6f6e 7465 7874  p of the context
+00014040: 2066 726f 6d20 7768 6963 6820 7468 6520   from which the 
+00014050: 6564 6765 7320 6172 6520 6361 6c63 756c  edges are calcul
+00014060: 6174 6564 2e3c 2f70 3e0a 3c70 3e3c 7374  ated.</p>.<p><st
+00014070: 726f 6e67 3e72 6574 7572 6e3c 2f73 7472  rong>return</str
+00014080: 6f6e 673e 3a20 6120 6469 6374 696f 6e61  ong>: a dictiona
+00014090: 7279 2077 6974 6820 2765 6467 6573 2720  ry with 'edges' 
+000140a0: 6b65 7920 2863 6f6e 7461 696e 696e 6720  key (containing 
+000140b0: 7468 6520 6361 6c63 756c 6174 6564 2065  the calculated e
+000140c0: 6467 6573 2061 6674 6572 2043 6175 7361  dges after Causa
+000140d0: 6c69 7479 2064 6973 636f 7665 7279 292e  lity discovery).
+000140e0: 3c2f 703e 3c2f 6469 763e 0a3c 6465 7461  </p></div>.<deta
+000140f0: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
+00014100: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
+00014110: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
+00014120: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
+00014130: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
+00014140: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
+00014150: 6e22 3e64 6566 2063 616c 6375 6c61 7465  n">def calculate
+00014160: 5f65 6467 6573 2873 656c 662c 2061 6c6c  _edges(self, all
+00014170: 6461 7461 2c20 7469 6d65 7374 616d 7029  data, timestamp)
+00014180: 3a0a 2020 2020 2623 3334 3b26 2333 343b  :.    &#34;&#34;
+00014190: 2623 3334 3b0a 2020 2020 466f 726d 756c  &#34;.    Formul
+000141a0: 6174 6520 7468 6520 6461 7461 2069 6e20  ate the data in 
+000141b0: 6170 7072 6f70 7269 6174 6520 666f 726d  appropriate form
+000141c0: 2074 6f20 6361 6c6c 2073 656c 662e 6361   to call self.ca
+000141d0: 6c63 756c 6174 655f 6361 7573 616c 6974  lculate_causalit
+000141e0: 790a 2020 2020 7768 6963 6820 7265 7475  y.    which retu
+000141f0: 726e 2074 6865 2065 6467 6573 2066 6f72  rn the edges for
+00014200: 2074 6865 2063 6f6e 7465 7874 2e0a 0a20   the context... 
+00014210: 2020 202a 2a50 6172 616d 6574 6572 732a     **Parameters*
+00014220: 2a3a 0a0a 2020 2020 2a2a 616c 6c64 6174  *:..    **alldat
+00014230: 612a 2a3a 2061 2032 4420 6e75 6d70 7920  a**: a 2D numpy 
+00014240: 6172 7261 7920 7769 7468 2061 6c6c 2073  array with all s
+00014250: 6572 6965 7320 6461 7461 2028 6571 7569  eries data (equi
+00014260: 7661 6c65 6e74 2074 6f20 7468 6520 4344  valent to the CD
+00014270: 206f 6620 7468 6520 436f 6e74 6578 7429   of the Context)
+00014280: 0a0a 2020 2020 2a2a 7469 6d65 7374 616d  ..    **timestam
+00014290: 702a 2a3a 2074 696d 6573 7461 6d70 206f  p**: timestamp o
+000142a0: 6620 7468 6520 636f 6e74 6578 7420 6672  f the context fr
+000142b0: 6f6d 2077 6869 6368 2074 6865 2065 6467  om which the edg
+000142c0: 6573 2061 7265 2063 616c 6375 6c61 7465  es are calculate
+000142d0: 642e 0a0a 2020 2020 2a2a 7265 7475 726e  d...    **return
+000142e0: 2a2a 3a20 6120 6469 6374 696f 6e61 7279  **: a dictionary
+000142f0: 2077 6974 6820 2623 3339 3b65 6467 6573   with &#39;edges
+00014300: 2623 3339 3b20 6b65 7920 2863 6f6e 7461  &#39; key (conta
+00014310: 696e 696e 6720 7468 6520 6361 6c63 756c  ining the calcul
+00014320: 6174 6564 2065 6467 6573 2061 6674 6572  ated edges after
+00014330: 2043 6175 7361 6c69 7479 2064 6973 636f   Causality disco
+00014340: 7665 7279 292e 0a20 2020 2026 2333 343b  very)..    &#34;
+00014350: 2623 3334 3b26 2333 343b 0a20 2020 2023  &#34;&#34;.    #
+00014360: 2073 7461 7274 203d 2074 696d 652e 7469   start = time.ti
+00014370: 6d65 2829 0a20 2020 2073 746f 7269 6e67  me().    storing
+00014380: 203d 207b 7d0a 2020 2020 7374 6f72 696e   = {}.    storin
+00014390: 675b 2623 3334 3b74 696d 6573 7461 6d70  g[&#34;timestamp
+000143a0: 2623 3334 3b5d 203d 2074 696d 6573 7461  &#34;] = timesta
+000143b0: 6d70 0a0a 2020 2020 616c 6c64 6174 615f  mp..    alldata_
+000143c0: 6e61 6d65 7320 3d20 5b6e 6e5b 305d 2066  names = [nn[0] f
+000143d0: 6f72 206e 6e20 696e 2061 6c6c 6461 7461  or nn in alldata
+000143e0: 5d0a 2020 2020 616c 6c64 6174 615f 6461  ].    alldata_da
+000143f0: 7461 203d 205b 6e6e 5b31 5d20 666f 7220  ta = [nn[1] for 
+00014400: 6e6e 2069 6e20 616c 6c64 6174 615d 0a0a  nn in alldata]..
+00014410: 2020 2020 666f 7220 6e61 6d65 6464 2c20      for namedd, 
+00014420: 6461 7461 6464 2069 6e20 7a69 7028 616c  datadd in zip(al
+00014430: 6c64 6174 615f 6e61 6d65 732c 2061 6c6c  ldata_names, all
+00014440: 6461 7461 5f64 6174 6129 3a0a 2020 2020  data_data):.    
+00014450: 2020 2020 7374 6f72 696e 675b 6e61 6d65      storing[name
+00014460: 6464 5d20 3d20 6461 7461 6464 0a0a 2020  dd] = datadd..  
+00014470: 2020 2320 466f 7220 636f 6e74 6578 7420    # For context 
+00014480: 7769 7468 206d 6f72 6520 7468 616e 2074  with more than t
+00014490: 776f 2073 6572 6965 7320 6361 6c63 756c  wo series calcul
+000144a0: 6174 6520 5043 2063 6173 7561 6c69 7469  ate PC casualiti
+000144b0: 6573 0a20 2020 2063 6f75 6e74 203d 206c  es.    count = l
+000144c0: 656e 285b 3120 666f 7220 6c69 7374 6120  en([1 for lista 
+000144d0: 696e 2061 6c6c 6461 7461 5f64 6174 6120  in alldata_data 
+000144e0: 6966 206c 6973 7461 2069 7320 6e6f 7420  if lista is not 
+000144f0: 4e6f 6e65 5d29 0a20 2020 2069 6620 636f  None]).    if co
+00014500: 756e 7420 2667 743b 2031 2061 6e64 206c  unt &gt; 1 and l
+00014510: 656e 2861 6c6c 6461 7461 5b30 5d5b 315d  en(alldata[0][1]
+00014520: 2920 2667 743b 2035 3a0a 2020 2020 2020  ) &gt; 5:.      
+00014530: 2020 616c 6c64 6174 615f 6e61 6d65 7320    alldata_names 
+00014540: 3d20 5b6e 6e5b 305d 2066 6f72 206e 6e20  = [nn[0] for nn 
+00014550: 696e 2061 6c6c 6461 7461 2069 6620 6e6e  in alldata if nn
+00014560: 5b31 5d20 6973 206e 6f74 204e 6f6e 6520  [1] is not None 
+00014570: 616e 6420 6c65 6e28 7365 7428 6e6e 5b31  and len(set(nn[1
+00014580: 5d29 2920 2667 743b 2031 5d0a 2020 2020  ])) &gt; 1].    
+00014590: 2020 2020 616c 6c64 6174 615f 6461 7461      alldata_data
+000145a0: 203d 205b 6e6e 5b31 5d20 666f 7220 6e6e   = [nn[1] for nn
+000145b0: 2069 6e20 616c 6c64 6174 6120 6966 206e   in alldata if n
+000145c0: 6e5b 315d 2069 7320 6e6f 7420 4e6f 6e65  n[1] is not None
+000145d0: 2061 6e64 206c 656e 2873 6574 286e 6e5b   and len(set(nn[
+000145e0: 315d 2929 2026 6774 3b20 315d 0a0a 2020  1])) &gt; 1]..  
+000145f0: 2020 2020 2020 2320 656e 6420 3d20 7469        # end = ti
+00014600: 6d65 2e74 696d 6528 290a 2020 2020 2020  me.time().      
+00014610: 2020 2320 7072 696e 7428 6626 2333 343b    # print(f&#34;
+00014620: 6265 666f 7265 207b 656e 6420 2d20 7374  before {end - st
+00014630: 6172 747d 2623 3334 3b29 0a20 2020 2020  art}&#34;).     
+00014640: 2020 2023 2073 7461 7274 3d74 696d 652e     # start=time.
+00014650: 7469 6d65 2829 0a0a 2020 2020 2020 2020  time()..        
+00014660: 6564 6765 7320 3d20 7365 6c66 2e63 616c  edges = self.cal
+00014670: 6375 6c61 7465 5f63 6175 7361 6c69 7479  culate_causality
+00014680: 286e 702e 636f 6c75 6d6e 5f73 7461 636b  (np.column_stack
+00014690: 2861 6c6c 6461 7461 5f64 6174 6129 2c20  (alldata_data), 
+000146a0: 616c 6c64 6174 615f 6e61 6d65 7329 0a20  alldata_names). 
+000146b0: 2020 2020 2020 2023 2065 6e64 3d74 696d         # end=tim
+000146c0: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
+000146d0: 2023 2070 7269 6e74 2866 2623 3334 3b61   # print(f&#34;a
+000146e0: 6374 7561 6c20 6564 6765 2063 616c 6375  ctual edge calcu
+000146f0: 6c61 7469 6f6e 207b 656e 642d 7374 6172  lation {end-star
+00014700: 747d 2623 3334 3b29 0a20 2020 2020 2020  t}&#34;).       
+00014710: 2069 6620 6564 6765 7320 6973 204e 6f6e   if edges is Non
+00014720: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00014730: 696e 676c 6565 6467 6573 203d 205b 5d0a  ingleedges = [].
+00014740: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00014750: 2020 2020 2020 2020 2020 7369 6e67 6c65            single
+00014760: 6564 6765 7320 3d20 6564 6765 730a 2020  edges = edges.  
+00014770: 2020 2020 2020 2320 7072 696e 7428 6564        # print(ed
+00014780: 6765 7329 0a20 2020 2020 2020 2073 746f  ges).        sto
+00014790: 7269 6e67 5b26 2333 343b 6564 6765 7326  ring[&#34;edges&
+000147a0: 2333 343b 5d20 3d20 7369 6e67 6c65 6564  #34;] = singleed
+000147b0: 6765 730a 2020 2020 2020 2020 7265 7475  ges.        retu
+000147c0: 726e 2073 746f 7269 6e67 0a20 2020 2073  rn storing.    s
+000147d0: 746f 7269 6e67 5b26 2333 343b 6564 6765  toring[&#34;edge
+000147e0: 7326 2333 343b 5d20 3d20 5b5d 0a20 2020  s&#34;] = [].   
+000147f0: 2072 6574 7572 6e20 7374 6f72 696e 673c   return storing<
+00014800: 2f63 6f64 653e 3c2f 7072 653e 0a3c 2f64  /code></pre>.</d
+00014810: 6574 6169 6c73 3e0a 3c2f 6464 3e0a 3c64  etails>.</dd>.<d
+00014820: 7420 6964 3d22 5064 6d43 6f6e 7465 7874  t id="PdmContext
+00014830: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+00014840: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+00014850: 746f 722e 6368 6172 6163 7465 7269 7a65  tor.characterize
+00014860: 5f65 7665 6e74 5f63 6f6e 7469 6e75 6f75  _event_continuou
+00014870: 7322 3e3c 636f 6465 2063 6c61 7373 3d22  s"><code class="
+00014880: 6e61 6d65 2066 6c65 7822 3e0a 3c73 7061  name flex">.<spa
+00014890: 6e3e 6465 6620 3c73 7061 6e20 636c 6173  n>def <span clas
+000148a0: 733d 2269 6465 6e74 223e 6368 6172 6163  s="ident">charac
+000148b0: 7465 7269 7a65 5f65 7665 6e74 5f63 6f6e  terize_event_con
+000148c0: 7469 6e75 6f75 733c 2f73 7061 6e3e 3c2f  tinuous</span></
+000148d0: 7370 616e 3e28 3c73 7061 6e3e 7365 6c66  span>(<span>self
+000148e0: 2c20 636f 6e74 6578 742c 2065 6467 6529  , context, edge)
+000148f0: 3c2f 7370 616e 3e0a 3c2f 636f 6465 3e3c  </span>.</code><
+00014900: 2f64 743e 0a3c 6464 3e0a 3c64 6976 2063  /dt>.<dd>.<div c
+00014910: 6c61 7373 3d22 6465 7363 223e 3c70 3e54  lass="desc"><p>T
+00014920: 6869 7320 6d65 7468 6f64 2063 6861 7261  his method chara
+00014930: 6374 6572 697a 6573 2074 6865 2065 6467  cterizes the edg
+00014940: 6520 2861 2c62 2920 7768 656e 2061 2069  e (a,b) when a i
+00014950: 7320 636f 6e74 696e 756f 7573 2e0a 546f  s continuous..To
+00014960: 2064 6f20 7468 6973 2c20 7468 6520 6465   do this, the de
+00014970: 6c74 6120 6265 7477 6565 6e20 7468 6520  lta between the 
+00014980: 7469 6d65 7374 616d 7073 206f 6620 7468  timestamps of th
+00014990: 6520 7365 7269 6573 2062 2069 7320 6361  e series b is ca
+000149a0: 6c63 756c 6174 6564 0a28 692e 652e 2074  lculated.(i.e. t
+000149b0: 6865 2064 6966 6665 7265 6e63 6520 6265  he difference be
+000149c0: 7477 6565 6e20 6375 7272 656e 7420 616e  tween current an
+000149d0: 6420 6e65 7874 2074 696d 6573 7461 6d70  d next timestamp
+000149e0: 7329 2e20 4966 2074 6865 2073 756d 6d20  s). If the summ 
+000149f0: 6f66 2074 6865 2064 656c 7461 7320 6265  of the deltas be
+00014a00: 7477 6565 6e20 6220 7365 7269 6573 2064  tween b series d
+00014a10: 6174 612c 2069 730a 6772 6561 7465 7220  ata, is.greater 
+00014a20: 7468 616e 2032 2074 696d 6573 2074 6865  than 2 times the
+00014a30: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+00014a40: 696f 6e20 6f66 2074 6865 2062 2c20 7468  ion of the b, th
+00014a50: 656e 2074 6865 2069 6e63 7265 6173 6520  en the increase 
+00014a60: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+00014a70: 2069 7320 7265 7475 726e 6564 2e20 4966   is returned. If
+00014a80: 2074 6865 2073 756d 0a69 7320 6c6f 7765   the sum.is lowe
+00014a90: 7220 7468 616e 2032 2074 696d 6573 2074  r than 2 times t
+00014aa0: 6865 2073 7461 6e64 6172 6420 6465 7669  he standard devi
+00014ab0: 6174 696f 6e20 7468 6520 6465 6372 6561  ation the decrea
+00014ac0: 7365 6420 6368 6172 6163 7465 7269 7a61  sed characteriza
+00014ad0: 7469 6f6e 2069 7320 7265 7475 726e 6564  tion is returned
+00014ae0: 2e20 4f74 6865 7277 6973 652c 2074 6865  . Otherwise, the
+00014af0: 2075 6e6b 6e6f 776e 0a63 6861 7261 6374   unknown.charact
+00014b00: 6572 697a 6174 696f 6e20 6973 2072 6574  erization is ret
+00014b10: 7572 6e65 642e 3c2f 703e 0a3c 703e 3c73  urned.</p>.<p><s
+00014b20: 7472 6f6e 673e 5061 7261 6d65 7465 7273  trong>Parameters
+00014b30: 3c2f 7374 726f 6e67 3e3a 3c2f 703e 0a3c  </strong>:</p>.<
+00014b40: 703e 3c73 7472 6f6e 673e 636f 6e74 6578  p><strong>contex
+00014b50: 743c 2f73 7472 6f6e 673e 3a20 7468 6174  t</strong>: that
+00014b60: 2074 6865 2065 6467 6520 746f 2062 6520   the edge to be 
+00014b70: 6368 6172 6163 7465 7269 7a65 6420 6265  characterized be
+00014b80: 6c6f 6e67 732e 3c2f 703e 0a3c 703e 3c73  longs.</p>.<p><s
+00014b90: 7472 6f6e 673e 6564 6765 3c2f 7374 726f  trong>edge</stro
+00014ba0: 6e67 3e3a 2041 2074 7570 6c65 2028 612c  ng>: A tuple (a,
+00014bb0: 6229 2077 6865 7265 2061 2069 7320 6973  b) where a is is
+00014bc0: 6f6c 6174 6564 206f 7220 636f 6e66 6967  olated or config
+00014bd0: 7572 6174 696f 6e20 6576 656e 742e 3c2f  uration event.</
+00014be0: 703e 0a3c 703e 3c73 7472 6f6e 673e 7265  p>.<p><strong>re
+00014bf0: 7475 726e 3c2f 7374 726f 6e67 3e3a 2041  turn</strong>: A
+00014c00: 2063 6861 7261 6374 6572 697a 6174 696f   characterizatio
+00014c10: 6e20 666f 7220 7468 6520 6564 6765 2028  n for the edge (
+00014c20: 756e 6b6e 6f77 6e2c 2064 6563 7265 6173  unknown, decreas
+00014c30: 6520 6f72 2069 6e63 7265 6173 6529 3c2f  e or increase)</
+00014c40: 703e 3c2f 6469 763e 0a3c 6465 7461 696c  p></div>.<detail
+00014c50: 7320 636c 6173 733d 2273 6f75 7263 6522  s class="source"
+00014c60: 3e0a 3c73 756d 6d61 7279 3e0a 3c73 7061  >.<summary>.<spa
+00014c70: 6e3e 4578 7061 6e64 2073 6f75 7263 6520  n>Expand source 
+00014c80: 636f 6465 3c2f 7370 616e 3e0a 3c2f 7375  code</span>.</su
+00014c90: 6d6d 6172 793e 0a3c 7072 653e 3c63 6f64  mmary>.<pre><cod
+00014ca0: 6520 636c 6173 733d 2270 7974 686f 6e22  e class="python"
+00014cb0: 3e64 6566 2063 6861 7261 6374 6572 697a  >def characteriz
+00014cc0: 655f 6576 656e 745f 636f 6e74 696e 756f  e_event_continuo
+00014cd0: 7573 2873 656c 662c 2063 6f6e 7465 7874  us(self, context
+00014ce0: 2c20 6564 6765 293a 0a20 2020 2026 2333  , edge):.    &#3
+00014cf0: 343b 2623 3334 3b26 2333 343b 0a20 2020  4;&#34;&#34;.   
+00014d00: 2020 2020 2054 6869 7320 6d65 7468 6f64       This method
+00014d10: 2063 6861 7261 6374 6572 697a 6573 2074   characterizes t
+00014d20: 6865 2065 6467 6520 2861 2c62 2920 7768  he edge (a,b) wh
+00014d30: 656e 2061 2069 7320 636f 6e74 696e 756f  en a is continuo
+00014d40: 7573 2e0a 2020 2020 2020 2020 546f 2064  us..        To d
+00014d50: 6f20 7468 6973 2c20 7468 6520 6465 6c74  o this, the delt
+00014d60: 6120 6265 7477 6565 6e20 7468 6520 7469  a between the ti
+00014d70: 6d65 7374 616d 7073 206f 6620 7468 6520  mestamps of the 
+00014d80: 7365 7269 6573 2062 2069 7320 6361 6c63  series b is calc
+00014d90: 756c 6174 6564 0a20 2020 2020 2020 2028  ulated.        (
+00014da0: 692e 652e 2074 6865 2064 6966 6665 7265  i.e. the differe
+00014db0: 6e63 6520 6265 7477 6565 6e20 6375 7272  nce between curr
+00014dc0: 656e 7420 616e 6420 6e65 7874 2074 696d  ent and next tim
+00014dd0: 6573 7461 6d70 7329 2e20 4966 2074 6865  estamps). If the
+00014de0: 2073 756d 6d20 6f66 2074 6865 2064 656c   summ of the del
+00014df0: 7461 7320 6265 7477 6565 6e20 6220 7365  tas between b se
+00014e00: 7269 6573 2064 6174 612c 2069 730a 2020  ries data, is.  
+00014e10: 2020 2020 2020 6772 6561 7465 7220 7468        greater th
+00014e20: 616e 2032 2074 696d 6573 2074 6865 2073  an 2 times the s
+00014e30: 7461 6e64 6172 6420 6465 7669 6174 696f  tandard deviatio
+00014e40: 6e20 6f66 2074 6865 2062 2c20 7468 656e  n of the b, then
+00014e50: 2074 6865 2069 6e63 7265 6173 6520 6368   the increase ch
+00014e60: 6172 6163 7465 7269 7a61 7469 6f6e 2069  aracterization i
+00014e70: 7320 7265 7475 726e 6564 2e20 4966 2074  s returned. If t
+00014e80: 6865 2073 756d 0a20 2020 2020 2020 2069  he sum.        i
+00014e90: 7320 6c6f 7765 7220 7468 616e 2032 2074  s lower than 2 t
+00014ea0: 696d 6573 2074 6865 2073 7461 6e64 6172  imes the standar
+00014eb0: 6420 6465 7669 6174 696f 6e20 7468 6520  d deviation the 
+00014ec0: 6465 6372 6561 7365 6420 6368 6172 6163  decreased charac
+00014ed0: 7465 7269 7a61 7469 6f6e 2069 7320 7265  terization is re
+00014ee0: 7475 726e 6564 2e20 4f74 6865 7277 6973  turned. Otherwis
+00014ef0: 652c 2074 6865 2075 6e6b 6e6f 776e 0a20  e, the unknown. 
+00014f00: 2020 2020 2020 2063 6861 7261 6374 6572         character
+00014f10: 697a 6174 696f 6e20 6973 2072 6574 7572  ization is retur
+00014f20: 6e65 642e 0a0a 2020 2020 2020 2020 2a2a  ned...        **
+00014f30: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
+00014f40: 2020 2020 2020 202a 2a63 6f6e 7465 7874         **context
+00014f50: 2a2a 3a20 7468 6174 2074 6865 2065 6467  **: that the edg
+00014f60: 6520 746f 2062 6520 6368 6172 6163 7465  e to be characte
+00014f70: 7269 7a65 6420 6265 6c6f 6e67 732e 0a0a  rized belongs...
+00014f80: 2020 2020 2020 2020 2a2a 6564 6765 2a2a          **edge**
+00014f90: 3a20 4120 7475 706c 6520 2861 2c62 2920  : A tuple (a,b) 
+00014fa0: 7768 6572 6520 6120 6973 2069 736f 6c61  where a is isola
+00014fb0: 7465 6420 6f72 2063 6f6e 6669 6775 7261  ted or configura
+00014fc0: 7469 6f6e 2065 7665 6e74 2e0a 0a20 2020  tion event...   
+00014fd0: 2020 2020 202a 2a72 6574 7572 6e2a 2a3a       **return**:
+00014fe0: 2041 2063 6861 7261 6374 6572 697a 6174   A characterizat
+00014ff0: 696f 6e20 666f 7220 7468 6520 6564 6765  ion for the edge
+00015000: 2028 756e 6b6e 6f77 6e2c 2064 6563 7265   (unknown, decre
+00015010: 6173 6520 6f72 2069 6e63 7265 6173 6529  ase or increase)
+00015020: 0a20 2020 2026 2333 343b 2623 3334 3b26  .    &#34;&#34;&
+00015030: 2333 343b 0a20 2020 206e 616d 6531 203d  #34;.    name1 =
+00015040: 2065 6467 655b 305d 0a20 2020 206e 616d   edge[0].    nam
+00015050: 6532 203d 2065 6467 655b 315d 0a20 2020  e2 = edge[1].   
+00015060: 2076 616c 7565 7331 203d 205b 666c 6f61   values1 = [floa
+00015070: 7428 6b61 7469 2920 666f 7220 6b61 7469  t(kati) for kati
+00015080: 2069 6e20 636f 6e74 6578 745b 6e61 6d65   in context[name
+00015090: 315d 5d0a 2020 2020 7661 6c75 6573 3220  1]].    values2 
+000150a0: 3d20 5b66 6c6f 6174 286b 6174 6929 2066  = [float(kati) f
+000150b0: 6f72 206b 6174 6920 696e 2063 6f6e 7465  or kati in conte
+000150c0: 7874 5b6e 616d 6532 5d5d 0a0a 2020 2020  xt[name2]]..    
+000150d0: 7072 6576 203d 2076 616c 7565 7332 5b30  prev = values2[0
+000150e0: 5d0a 2020 2020 6469 6666 203d 2030 0a20  ].    diff = 0. 
+000150f0: 2020 2066 6f72 2076 2069 6e20 7661 6c75     for v in valu
+00015100: 6573 325b 313a 5d3a 0a20 2020 2020 2020  es2[1:]:.       
+00015110: 2064 6966 6620 2b3d 2028 7620 2d20 7072   diff += (v - pr
+00015120: 6576 290a 0a20 2020 2069 6620 6c65 6e28  ev)..    if len(
+00015130: 7661 6c75 6573 3229 203d 3d20 303a 0a20  values2) == 0:. 
+00015140: 2020 2020 2020 2063 6861 7220 3d20 2623         char = &#
+00015150: 3334 3b75 6e6b 6e6f 776e 2623 3334 3b0a  34;unknown&#34;.
+00015160: 2020 2020 7374 6476 203d 2073 7461 7469      stdv = stati
+00015170: 7374 6963 732e 7374 6465 7628 7661 6c75  stics.stdev(valu
+00015180: 6573 3229 0a20 2020 2069 6620 6469 6666  es2).    if diff
+00015190: 2026 6774 3b20 3220 2a20 7374 6476 3a0a   &gt; 2 * stdv:.
+000151a0: 2020 2020 2020 2020 6368 6172 203d 2026          char = &
+000151b0: 2333 343b 696e 6372 6561 7365 2623 3334  #34;increase&#34
+000151c0: 3b0a 2020 2020 656c 6966 2064 6966 6620  ;.    elif diff 
+000151d0: 266c 743b 202d 3220 2a20 7374 6476 3a0a  &lt; -2 * stdv:.
+000151e0: 2020 2020 2020 2020 6368 6172 203d 2026          char = &
+000151f0: 2333 343b 6465 6372 6561 7365 2623 3334  #34;decrease&#34
+00015200: 3b0a 2020 2020 656c 7365 3a0a 2020 2020  ;.    else:.    
+00015210: 2020 2020 6368 6172 203d 2026 2333 343b      char = &#34;
+00015220: 756e 6b6e 6f77 6e26 2333 343b 0a20 2020  unknown&#34;.   
+00015230: 2072 6574 7572 6e20 6368 6172 3c2f 636f   return char</co
+00015240: 6465 3e3c 2f70 7265 3e0a 3c2f 6465 7461  de></pre>.</deta
+00015250: 696c 733e 0a3c 2f64 643e 0a3c 6474 2069  ils>.</dd>.<dt i
+00015260: 643d 2250 646d 436f 6e74 6578 742e 436f  d="PdmContext.Co
+00015270: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+00015280: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+00015290: 2e63 6861 7261 6374 6572 697a 655f 6576  .characterize_ev
+000152a0: 656e 745f 6564 6765 223e 3c63 6f64 6520  ent_edge"><code 
+000152b0: 636c 6173 733d 226e 616d 6520 666c 6578  class="name flex
+000152c0: 223e 0a3c 7370 616e 3e64 6566 203c 7370  ">.<span>def <sp
+000152d0: 616e 2063 6c61 7373 3d22 6964 656e 7422  an class="ident"
+000152e0: 3e63 6861 7261 6374 6572 697a 655f 6576  >characterize_ev
+000152f0: 656e 745f 6564 6765 3c2f 7370 616e 3e3c  ent_edge</span><
+00015300: 2f73 7061 6e3e 283c 7370 616e 3e73 656c  /span>(<span>sel
+00015310: 662c 2063 6f6e 7465 7874 2c20 6564 6765  f, context, edge
+00015320: 293c 2f73 7061 6e3e 0a3c 2f63 6f64 653e  )</span>.</code>
+00015330: 3c2f 6474 3e0a 3c64 643e 0a3c 6469 7620  </dt>.<dd>.<div 
+00015340: 636c 6173 733d 2264 6573 6322 3e3c 703e  class="desc"><p>
+00015350: 5468 6973 206d 6574 686f 6420 6368 6172  This method char
+00015360: 6163 7465 7269 7a65 7320 7468 6520 6564  acterizes the ed
+00015370: 6765 2028 612c 6229 2077 6865 6e20 6120  ge (a,b) when a 
+00015380: 6973 2069 736f 6c61 7465 6420 6f72 2063  is isolated or c
+00015390: 6f6e 6669 6775 7261 7469 6f6e 2065 7665  onfiguration eve
+000153a0: 6e74 2e0a 546f 2064 6f20 7468 6973 2c20  nt..To do this, 
+000153b0: 6974 2064 6574 6563 7473 2074 6865 206c  it detects the l
+000153c0: 6173 7420 6f63 6375 7272 656e 6365 206f  ast occurrence o
+000153d0: 6620 6120 616e 6420 7370 6c69 7420 7468  f a and split th
+000153e0: 6520 6461 7461 206f 6620 7365 7269 6573  e data of series
+000153f0: 2061 2061 6e64 2073 6572 6965 7320 6220   a and series b 
+00015400: 6261 7365 6420 6f6e 2074 6861 742e 0a54  based on that..T
+00015410: 6865 6e20 6368 6563 6b73 2069 6620 7468  hen checks if th
+00015420: 6520 6d65 6469 616e 206f 6620 6220 6166  e median of b af
+00015430: 7465 7220 7468 6520 6f63 6375 7272 656e  ter the occurren
+00015440: 6365 2069 7320 6174 206c 6172 6765 7220  ce is at larger 
+00015450: 7468 616e 2074 6865 206d 6564 6961 6e20  than the median 
+00015460: 6220 6265 666f 7265 0a70 6c75 7320 7477  b before.plus tw
+00015470: 6f20 7469 6d65 7320 7468 6520 7374 616e  o times the stan
+00015480: 6461 7264 2064 6576 6961 7469 6f6e 206f  dard deviation o
+00015490: 6620 6220 7365 7269 6573 2062 6566 6f72  f b series befor
+000154a0: 6520 7468 6520 6f63 6375 7272 656e 6365  e the occurrence
+000154b0: 2e0a 4966 2074 6861 7420 6973 2074 7275  ..If that is tru
+000154c0: 6520 7468 656e 2069 7320 6368 6172 6163  e then is charac
+000154d0: 7465 7269 7a65 6420 6173 2069 6e63 7265  terized as incre
+000154e0: 6173 652e 2045 6c73 6520 6974 2069 7320  ase. Else it is 
+000154f0: 6368 6563 6b65 6420 666f 7220 7468 6520  checked for the 
+00015500: 6f70 706f 7369 7465 2c20 2869 6620 6974  opposite, (if it
+00015510: 2069 7320 736d 616c 6c65 720a 666f 7220   is smaller.for 
+00015520: 6174 206c 6561 7374 2032 2074 696d 6573  at least 2 times
+00015530: 2074 6865 2073 7461 6e64 6172 6420 6465   the standard de
+00015540: 7669 6174 696f 6e20 6f66 2062 2920 616e  viation of b) an
+00015550: 6420 6368 6172 6163 7465 7269 7a65 6420  d characterized 
+00015560: 6173 2064 6563 7265 6173 652e 204f 7468  as decrease. Oth
+00015570: 6572 7769 7365 2c20 6973 2063 6861 7261  erwise, is chara
+00015580: 6374 6572 697a 6564 2061 730a 756e 6b6e  cterized as.unkn
+00015590: 6f77 6e2e 3c2f 703e 0a3c 703e 3c73 7472  own.</p>.<p><str
+000155a0: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
+000155b0: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
+000155c0: 3c73 7472 6f6e 673e 636f 6e74 6578 743c  <strong>context<
+000155d0: 2f73 7472 6f6e 673e 3a20 7468 6174 2074  /strong>: that t
+000155e0: 6865 2065 6467 6520 746f 2062 6520 6368  he edge to be ch
+000155f0: 6172 6163 7465 7269 7a65 6420 6265 6c6f  aracterized belo
+00015600: 6e67 732e 3c2f 703e 0a3c 703e 3c73 7472  ngs.</p>.<p><str
+00015610: 6f6e 673e 6564 6765 3c2f 7374 726f 6e67  ong>edge</strong
+00015620: 3e3a 2041 2074 7570 6c65 2028 612c 6229  >: A tuple (a,b)
+00015630: 2077 6865 7265 2061 2069 7320 6973 6f6c   where a is isol
+00015640: 6174 6564 206f 7220 636f 6e66 6967 7572  ated or configur
+00015650: 6174 696f 6e20 6576 656e 742e 3c2f 703e  ation event.</p>
+00015660: 0a3c 703e 3c73 7472 6f6e 673e 7265 7475  .<p><strong>retu
+00015670: 726e 3c2f 7374 726f 6e67 3e3a 2041 2063  rn</strong>: A c
+00015680: 6861 7261 6374 6572 697a 6174 696f 6e20  haracterization 
+00015690: 666f 7220 7468 6520 6564 6765 2028 756e  for the edge (un
+000156a0: 6b6e 6f77 6e2c 2064 6563 7265 6173 6520  known, decrease 
+000156b0: 6f72 2069 6e63 7265 6173 6529 3c2f 703e  or increase)</p>
+000156c0: 3c2f 6469 763e 0a3c 6465 7461 696c 7320  </div>.<details 
+000156d0: 636c 6173 733d 2273 6f75 7263 6522 3e0a  class="source">.
+000156e0: 3c73 756d 6d61 7279 3e0a 3c73 7061 6e3e  <summary>.<span>
+000156f0: 4578 7061 6e64 2073 6f75 7263 6520 636f  Expand source co
+00015700: 6465 3c2f 7370 616e 3e0a 3c2f 7375 6d6d  de</span>.</summ
+00015710: 6172 793e 0a3c 7072 653e 3c63 6f64 6520  ary>.<pre><code 
+00015720: 636c 6173 733d 2270 7974 686f 6e22 3e64  class="python">d
+00015730: 6566 2063 6861 7261 6374 6572 697a 655f  ef characterize_
+00015740: 6576 656e 745f 6564 6765 2873 656c 662c  event_edge(self,
+00015750: 2063 6f6e 7465 7874 2c20 6564 6765 293a   context, edge):
+00015760: 0a20 2020 2026 2333 343b 2623 3334 3b26  .    &#34;&#34;&
+00015770: 2333 343b 0a20 2020 2054 6869 7320 6d65  #34;.    This me
+00015780: 7468 6f64 2063 6861 7261 6374 6572 697a  thod characteriz
+00015790: 6573 2074 6865 2065 6467 6520 2861 2c62  es the edge (a,b
+000157a0: 2920 7768 656e 2061 2069 7320 6973 6f6c  ) when a is isol
+000157b0: 6174 6564 206f 7220 636f 6e66 6967 7572  ated or configur
+000157c0: 6174 696f 6e20 6576 656e 742e 0a20 2020  ation event..   
+000157d0: 2054 6f20 646f 2074 6869 732c 2069 7420   To do this, it 
+000157e0: 6465 7465 6374 7320 7468 6520 6c61 7374  detects the last
+000157f0: 206f 6363 7572 7265 6e63 6520 6f66 2061   occurrence of a
+00015800: 2061 6e64 2073 706c 6974 2074 6865 2064   and split the d
+00015810: 6174 6120 6f66 2073 6572 6965 7320 6120  ata of series a 
+00015820: 616e 6420 7365 7269 6573 2062 2062 6173  and series b bas
+00015830: 6564 206f 6e20 7468 6174 2e0a 2020 2020  ed on that..    
+00015840: 5468 656e 2063 6865 636b 7320 6966 2074  Then checks if t
+00015850: 6865 206d 6564 6961 6e20 6f66 2062 2061  he median of b a
+00015860: 6674 6572 2074 6865 206f 6363 7572 7265  fter the occurre
+00015870: 6e63 6520 6973 2061 7420 6c61 7267 6572  nce is at larger
+00015880: 2074 6861 6e20 7468 6520 6d65 6469 616e   than the median
+00015890: 2062 2062 6566 6f72 650a 2020 2020 706c   b before.    pl
+000158a0: 7573 2074 776f 2074 696d 6573 2074 6865  us two times the
+000158b0: 2073 7461 6e64 6172 6420 6465 7669 6174   standard deviat
+000158c0: 696f 6e20 6f66 2062 2073 6572 6965 7320  ion of b series 
+000158d0: 6265 666f 7265 2074 6865 206f 6363 7572  before the occur
+000158e0: 7265 6e63 652e 0a20 2020 2049 6620 7468  rence..    If th
+000158f0: 6174 2069 7320 7472 7565 2074 6865 6e20  at is true then 
+00015900: 6973 2063 6861 7261 6374 6572 697a 6564  is characterized
+00015910: 2061 7320 696e 6372 6561 7365 2e20 456c   as increase. El
+00015920: 7365 2069 7420 6973 2063 6865 636b 6564  se it is checked
+00015930: 2066 6f72 2074 6865 206f 7070 6f73 6974   for the opposit
+00015940: 652c 2028 6966 2069 7420 6973 2073 6d61  e, (if it is sma
+00015950: 6c6c 6572 0a20 2020 2066 6f72 2061 7420  ller.    for at 
+00015960: 6c65 6173 7420 3220 7469 6d65 7320 7468  least 2 times th
+00015970: 6520 7374 616e 6461 7264 2064 6576 6961  e standard devia
+00015980: 7469 6f6e 206f 6620 6229 2061 6e64 2063  tion of b) and c
+00015990: 6861 7261 6374 6572 697a 6564 2061 7320  haracterized as 
+000159a0: 6465 6372 6561 7365 2e20 4f74 6865 7277  decrease. Otherw
+000159b0: 6973 652c 2069 7320 6368 6172 6163 7465  ise, is characte
+000159c0: 7269 7a65 6420 6173 0a20 2020 2020 756e  rized as.     un
+000159d0: 6b6e 6f77 6e2e 0a0a 2020 2020 2a2a 5061  known...    **Pa
+000159e0: 7261 6d65 7465 7273 2a2a 3a0a 0a20 2020  rameters**:..   
+000159f0: 202a 2a63 6f6e 7465 7874 2a2a 3a20 7468   **context**: th
+00015a00: 6174 2074 6865 2065 6467 6520 746f 2062  at the edge to b
+00015a10: 6520 6368 6172 6163 7465 7269 7a65 6420  e characterized 
+00015a20: 6265 6c6f 6e67 732e 0a0a 2020 2020 2a2a  belongs...    **
+00015a30: 6564 6765 2a2a 3a20 4120 7475 706c 6520  edge**: A tuple 
+00015a40: 2861 2c62 2920 7768 6572 6520 6120 6973  (a,b) where a is
+00015a50: 2069 736f 6c61 7465 6420 6f72 2063 6f6e   isolated or con
+00015a60: 6669 6775 7261 7469 6f6e 2065 7665 6e74  figuration event
+00015a70: 2e0a 0a20 2020 202a 2a72 6574 7572 6e2a  ...    **return*
+00015a80: 2a3a 2041 2063 6861 7261 6374 6572 697a  *: A characteriz
+00015a90: 6174 696f 6e20 666f 7220 7468 6520 6564  ation for the ed
+00015aa0: 6765 2028 756e 6b6e 6f77 6e2c 2064 6563  ge (unknown, dec
+00015ab0: 7265 6173 6520 6f72 2069 6e63 7265 6173  rease or increas
+00015ac0: 6529 0a20 2020 2026 2333 343b 2623 3334  e).    &#34;&#34
+00015ad0: 3b26 2333 343b 0a20 2020 206e 616d 6531  ;&#34;.    name1
+00015ae0: 203d 2065 6467 655b 305d 0a20 2020 206e   = edge[0].    n
+00015af0: 616d 6532 203d 2065 6467 655b 315d 0a20  ame2 = edge[1]. 
+00015b00: 2020 2076 616c 7565 7331 203d 2063 6f6e     values1 = con
+00015b10: 7465 7874 5b6e 616d 6531 5d0a 2020 2020  text[name1].    
+00015b20: 7661 6c75 6573 3220 3d20 5b66 6c6f 6174  values2 = [float
+00015b30: 286b 6174 6929 2066 6f72 206b 6174 6920  (kati) for kati 
+00015b40: 696e 2063 6f6e 7465 7874 5b6e 616d 6532  in context[name2
+00015b50: 5d5d 0a0a 2020 2020 6f63 6375 7265 6e63  ]]..    occurenc
+00015b60: 6520 3d20 6c65 6e28 7661 6c75 6573 3129  e = len(values1)
+00015b70: 202d 2031 0a20 2020 2066 6f72 2069 2069   - 1.    for i i
+00015b80: 6e20 7261 6e67 6528 6c65 6e28 7661 6c75  n range(len(valu
+00015b90: 6573 3129 202d 2032 2c20 302c 202d 3129  es1) - 2, 0, -1)
+00015ba0: 3a0a 2020 2020 2020 2020 6966 2076 616c  :.        if val
+00015bb0: 7565 7331 5b69 5d20 213d 2076 616c 7565  ues1[i] != value
+00015bc0: 7331 5b2d 315d 3a0a 2020 2020 2020 2020  s1[-1]:.        
+00015bd0: 2020 2020 6f63 6375 7265 6e63 6520 3d20      occurence = 
+00015be0: 6920 2b20 310a 2020 2020 2020 2020 2020  i + 1.          
+00015bf0: 2020 6272 6561 6b0a 2020 2020 7072 6576    break.    prev
+00015c00: 6975 736f 6363 7572 656e 6365 203d 2030  iusoccurence = 0
+00015c10: 0a20 2020 2066 6f72 2069 2069 6e20 7261  .    for i in ra
+00015c20: 6e67 6528 6f63 6375 7265 6e63 6520 2d20  nge(occurence - 
+00015c30: 322c 2030 2c20 2d31 293a 0a20 2020 2020  2, 0, -1):.     
+00015c40: 2020 2069 6620 7661 6c75 6573 315b 695d     if values1[i]
+00015c50: 2021 3d20 7661 6c75 6573 315b 6f63 6375   != values1[occu
+00015c60: 7265 6e63 6520 2d20 315d 3a0a 2020 2020  rence - 1]:.    
+00015c70: 2020 2020 2020 2020 7072 6576 6975 736f          previuso
+00015c80: 6363 7572 656e 6365 203d 2069 0a0a 2020  ccurence = i..  
+00015c90: 2020 6966 206f 6363 7572 656e 6365 202d    if occurence -
+00015ca0: 2070 7265 7669 7573 6f63 6375 7265 6e63   previusoccurenc
+00015cb0: 6520 266c 743b 2032 3a20 2023 206f 7220  e &lt; 2:  # or 
+00015cc0: 6c65 6e28 7661 6c75 6573 3229 2d6f 6363  len(values2)-occ
+00015cd0: 7572 656e 6365 266c 743b 323a 0a20 2020  urence&lt;2:.   
+00015ce0: 2020 2020 2072 6574 7572 6e20 2623 3334       return &#34
+00015cf0: 3b75 6e6b 6e6f 776e 2623 3334 3b0a 2020  ;unknown&#34;.  
+00015d00: 2020 7661 6c75 6573 3262 6566 6f72 6520    values2before 
+00015d10: 3d20 7661 6c75 6573 325b 7072 6576 6975  = values2[previu
+00015d20: 736f 6363 7572 656e 6365 3a6f 6363 7572  soccurence:occur
+00015d30: 656e 6365 5d0a 2020 2020 2320 7374 6476  ence].    # stdv
+00015d40: 203d 2073 7461 7469 7374 6963 732e 7374   = statistics.st
+00015d50: 6465 7628 7661 6c75 6573 3262 6566 6f72  dev(values2befor
+00015d60: 6529 0a20 2020 2023 206d 6561 6e20 3d20  e).    # mean = 
+00015d70: 7374 6174 6973 7469 6373 2e73 7464 6576  statistics.stdev
+00015d80: 2876 616c 7565 7332 6265 666f 7265 290a  (values2before).
+00015d90: 2020 2020 2320 7661 6c75 6573 3262 6566      # values2bef
+00015da0: 6f72 653d 5b76 2069 6620 7626 6c74 3b6d  ore=[v if v&lt;m
+00015db0: 6561 6e2b 352a 7374 6476 2065 6c73 6520  ean+5*stdv else 
+00015dc0: 6d65 616e 2066 6f72 2076 2069 6e20 7661  mean for v in va
+00015dd0: 6c75 6573 3262 6566 6f72 655d 0a0a 2020  lues2before]..  
+00015de0: 2020 2320 7661 6c75 6573 3261 6674 6572    # values2after
+00015df0: 3d76 616c 7565 7332 5b6f 6363 7572 656e  =values2[occuren
+00015e00: 6365 3a5d 0a20 2020 2076 616c 7565 7332  ce:].    values2
+00015e10: 6166 7465 7220 3d20 5b76 616c 7565 7332  after = [values2
+00015e20: 5b2d 315d 5d0a 2020 2020 2320 7374 6476  [-1]].    # stdv
+00015e30: 203d 2073 7461 7469 7374 6963 732e 7374   = statistics.st
+00015e40: 6465 7628 7661 6c75 6573 3261 6674 6572  dev(values2after
+00015e50: 290a 2020 2020 2320 6d65 616e 203d 2073  ).    # mean = s
+00015e60: 7461 7469 7374 6963 732e 7374 6465 7628  tatistics.stdev(
+00015e70: 7661 6c75 6573 3261 6674 6572 290a 2020  values2after).  
+00015e80: 2020 2320 7661 6c75 6573 3261 6674 6572    # values2after
+00015e90: 203d 205b 7620 6966 2076 2026 6c74 3b20   = [v if v &lt; 
+00015ea0: 6d65 616e 202b 2033 202a 2073 7464 7620  mean + 3 * stdv 
+00015eb0: 656c 7365 206d 6561 6e20 666f 7220 7620  else mean for v 
+00015ec0: 696e 2076 616c 7565 7332 6166 7465 725d  in values2after]
+00015ed0: 0a0a 2020 2020 7374 6476 203d 2073 7461  ..    stdv = sta
+00015ee0: 7469 7374 6963 732e 7374 6465 7628 7661  tistics.stdev(va
+00015ef0: 6c75 6573 3262 6566 6f72 6529 0a20 2020  lues2before).   
+00015f00: 2069 6620 6c65 6e28 7661 6c75 6573 3262   if len(values2b
+00015f10: 6566 6f72 6529 203d 3d20 303a 0a20 2020  efore) == 0:.   
+00015f20: 2020 2020 2063 6861 7220 3d20 2623 3334       char = &#34
+00015f30: 3b75 6e6b 6e6f 776e 2623 3334 3b0a 2020  ;unknown&#34;.  
+00015f40: 2020 656c 6966 2073 7461 7469 7374 6963    elif statistic
+00015f50: 732e 6d65 6469 616e 2876 616c 7565 7332  s.median(values2
+00015f60: 6265 666f 7265 2920 2d20 7374 6174 6973  before) - statis
+00015f70: 7469 6373 2e6d 6564 6961 6e28 7661 6c75  tics.median(valu
+00015f80: 6573 3261 6674 6572 2920 2667 743b 2032  es2after) &gt; 2
+00015f90: 202a 2073 7464 763a 0a20 2020 2020 2020   * stdv:.       
+00015fa0: 2063 6861 7220 3d20 2623 3334 3b64 6563   char = &#34;dec
+00015fb0: 7265 6173 6526 2333 343b 0a20 2020 2065  rease&#34;.    e
+00015fc0: 6c69 6620 7374 6174 6973 7469 6373 2e6d  lif statistics.m
+00015fd0: 6564 6961 6e28 7661 6c75 6573 3261 6674  edian(values2aft
+00015fe0: 6572 2920 2d20 7374 6174 6973 7469 6373  er) - statistics
+00015ff0: 2e6d 6564 6961 6e28 7661 6c75 6573 3262  .median(values2b
+00016000: 6566 6f72 6529 2026 6774 3b20 3220 2a20  efore) &gt; 2 * 
+00016010: 7374 6476 3a0a 2020 2020 2020 2020 6368  stdv:.        ch
+00016020: 6172 203d 2026 2333 343b 696e 6372 6561  ar = &#34;increa
+00016030: 7365 2623 3334 3b0a 2020 2020 656c 7365  se&#34;.    else
+00016040: 3a0a 2020 2020 2020 2020 6368 6172 203d  :.        char =
+00016050: 2026 2333 343b 756e 6b6e 6f77 6e26 2333   &#34;unknown&#3
+00016060: 343b 0a20 2020 2072 6574 7572 6e20 6368  4;.    return ch
+00016070: 6172 3c2f 636f 6465 3e3c 2f70 7265 3e0a  ar</code></pre>.
+00016080: 3c2f 6465 7461 696c 733e 0a3c 2f64 643e  </details>.</dd>
+00016090: 0a3c 6474 2069 643d 2250 646d 436f 6e74  .<dt id="PdmCont
+000160a0: 6578 742e 436f 6e74 6578 7447 656e 6572  ext.ContextGener
+000160b0: 6174 696f 6e2e 436f 6e74 6578 7447 656e  ation.ContextGen
+000160c0: 6572 6174 6f72 2e63 6f6c 6c65 6374 5f64  erator.collect_d
+000160d0: 6174 6122 3e3c 636f 6465 2063 6c61 7373  ata"><code class
+000160e0: 3d22 6e61 6d65 2066 6c65 7822 3e0a 3c73  ="name flex">.<s
+000160f0: 7061 6e3e 6465 6620 3c73 7061 6e20 636c  pan>def <span cl
+00016100: 6173 733d 2269 6465 6e74 223e 636f 6c6c  ass="ident">coll
+00016110: 6563 745f 6461 7461 3c2f 7370 616e 3e3c  ect_data</span><
+00016120: 2f73 7061 6e3e 283c 7370 616e 3e73 656c  /span>(<span>sel
+00016130: 662c 2074 696d 6573 7461 6d70 2c20 736f  f, timestamp, so
+00016140: 7572 6365 2c20 6e61 6d65 2c20 7661 6c75  urce, name, valu
+00016150: 653d 4e6f 6e65 2c20 7479 7065 3d27 556e  e=None, type='Un
+00016160: 6976 6172 6961 7465 272c 2072 6570 6c61  ivariate', repla
+00016170: 6365 3d5b 5d29 3c2f 7370 616e 3e0a 3c2f  ce=[])</span>.</
+00016180: 636f 6465 3e3c 2f64 743e 0a3c 6464 3e0a  code></dt>.<dd>.
+00016190: 3c64 6976 2063 6c61 7373 3d22 6465 7363  <div class="desc
+000161a0: 223e 3c70 3e54 6869 7320 6d65 7468 6f64  "><p>This method
+000161b0: 2069 7320 7573 6564 2077 6865 6e20 6461   is used when da
+000161c0: 7461 2061 7265 2070 6173 7365 6420 6974  ta are passed it
+000161d0: 6572 6174 6976 656c 792c 2061 6e64 2073  eratively, and s
+000161e0: 746f 7265 6420 696e 2062 7566 6665 720a  tored in buffer.
+000161f0: 5768 656e 2064 6174 6120 6f66 2074 6172  When data of tar
+00016200: 6765 7420 736f 7572 6365 2061 7272 6976  get source arriv
+00016210: 652c 2061 2063 6f72 7265 7370 6f6e 6469  e, a correspondi
+00016220: 6e67 2063 6f6e 7465 7874 2069 7320 7072  ng context is pr
+00016230: 6f64 7563 6564 2e0a 536f 7572 6365 7320  oduced..Sources 
+00016240: 6361 6e20 6265 206f 6620 6469 6666 6572  can be of differ
+00016250: 656e 7420 7361 6d70 6c65 2072 6174 6520  ent sample rate 
+00016260: 2861 6c6c 2073 6f75 7263 6573 2061 7265  (all sources are
+00016270: 206d 6170 7065 6420 746f 2074 6865 2074   mapped to the t
+00016280: 6172 6765 7473 2073 616d 706c 6520 7261  argets sample ra
+00016290: 7465 2077 6865 6e20 636f 6e74 6578 7420  te when context 
+000162a0: 6973 2070 726f 6475 6365 6429 3c2f 703e  is produced)</p>
+000162b0: 0a3c 703e 536f 7572 6365 7320 6361 6e20  .<p>Sources can 
+000162c0: 6265 206f 6620 6569 7468 6572 3a3c 2f70  be of either:</p
+000162d0: 3e0a 3c70 3e31 2920 436f 6e74 696e 756f  >.<p>1) Continuo
+000162e0: 7573 2074 7970 6520 2874 686f 7365 2074  us type (those t
+000162f0: 6861 7420 6861 7665 2073 6f6d 6520 6b69  hat have some ki
+00016300: 6e64 206f 6620 6172 6974 686d 6574 6963  nd of arithmetic
+00016310: 2076 616c 7565 293c 2f70 3e0a 3c70 3e32   value)</p>.<p>2
+00016320: 2920 4469 7363 7265 7465 2065 7665 6e74  ) Discrete event
+00016330: 7320 2877 6974 686f 7574 2076 616c 7565  s (without value
+00016340: 2920 2c20 7768 6572 6520 6f6e 6520 6f66  ) , where one of
+00016350: 2074 6865 2074 7970 6520 6973 6f6c 6174   the type isolat
+00016360: 6564 206f 7220 636f 6e66 6967 7572 6174  ed or configurat
+00016370: 696f 6e20 6d75 7374 2062 6520 6173 7369  ion must be assi
+00016380: 676e 6564 0a41 2067 7569 6465 206f 6e20  gned.A guide on 
+00016390: 686f 7720 746f 2073 7065 6369 6679 2074  how to specify t
+000163a0: 6865 2074 7970 6520 6973 2c20 7468 6174  he type is, that
+000163b0: 2065 7665 6e74 7320 7768 6963 6820 6173   events which as
+000163c0: 7375 6d65 6420 746f 2068 6176 6520 696d  sumed to have im
+000163d0: 7061 6374 206f 6e6c 7920 6f6e 2074 6865  pact only on the
+000163e0: 6972 206f 6363 7572 7265 6e63 652c 2061  ir occurrence, a
+000163f0: 7265 2063 616c 6c65 640a 6973 6f6c 6174  re called.isolat
+00016400: 6564 2c20 7768 696c 6520 6f74 6865 7273  ed, while others
+00016410: 2074 6861 7420 6172 6520 7265 6c61 7465   that are relate
+00016420: 6420 746f 2073 6f6d 6520 6b69 6e64 206f  d to some kind o
+00016430: 6620 636f 6e66 6967 7572 6174 696f 6e20  f configuration 
+00016440: 7769 7468 206d 6f72 6520 7065 726d 616e  with more perman
+00016450: 656e 7420 696d 7061 6374 2c20 6172 6520  ent impact, are 
+00016460: 6361 6c6c 6564 2063 6f6e 6669 6775 7261  called configura
+00016470: 7469 6f6e 2e0a 4573 7365 6e74 6961 6c6c  tion..Essentiall
+00016480: 7920 7468 6520 7479 7065 206f 6620 7468  y the type of th
+00016490: 6520 6576 656e 7473 2064 6566 696e 6520  e events define 
+000164a0: 7468 6520 7761 7920 7468 6174 2077 696c  the way that wil
+000164b0: 6c20 6265 2074 7261 6e73 666f 726d 6564  l be transformed
+000164c0: 2074 6f20 7265 616c 2076 616c 7565 7320   to real values 
+000164d0: 7469 6d65 2d73 6572 6965 732e 3c2f 703e  time-series.</p>
+000164e0: 0a3c 703e 3c73 7472 6f6e 673e 5061 7261  .<p><strong>Para
+000164f0: 6d65 7465 7273 3c2f 7374 726f 6e67 3e3a  meters</strong>:
+00016500: 3c2f 703e 0a3c 703e 3c73 7472 6f6e 673e  </p>.<p><strong>
+00016510: 7469 6d65 7374 616d 703c 2f73 7472 6f6e  timestamp</stron
+00016520: 673e 3a0a 5468 6520 7469 6d65 7374 616d  g>:.The timestam
+00016530: 7020 6f66 2074 6865 2061 7272 6976 6564  p of the arrived
+00016540: 2076 616c 7565 3c2f 703e 0a3c 703e 3c73   value</p>.<p><s
+00016550: 7472 6f6e 673e 736f 7572 6365 3c2f 7374  trong>source</st
+00016560: 726f 6e67 3e3a 2054 6865 2073 6f75 7263  rong>: The sourc
+00016570: 6520 6f66 2074 6865 2061 7272 6976 6564  e of the arrived
+00016580: 2076 616c 7565 3c2f 703e 0a3c 703e 3c73   value</p>.<p><s
+00016590: 7472 6f6e 673e 6e61 6d65 3c2f 7374 726f  trong>name</stro
+000165a0: 6e67 3e3a 2054 6865 206e 616d 6520 286f  ng>: The name (o
+000165b0: 7220 6964 656e 7469 6669 6572 2920 6f66  r identifier) of
+000165c0: 2074 6865 2061 7272 6976 6564 2076 616c   the arrived val
+000165d0: 7565 3c2f 703e 0a3c 703e 3c73 7472 6f6e  ue</p>.<p><stron
+000165e0: 673e 7661 6c75 653c 2f73 7472 6f6e 673e  g>value</strong>
+000165f0: 3a20 5468 6520 7661 6c75 6520 2866 6c6f  : The value (flo
+00016600: 6174 292c 2069 6e20 6361 7365 2074 6869  at), in case thi
+00016610: 7320 6973 204e 6f6e 6520 7468 6520 6172  s is None the ar
+00016620: 7269 7665 6420 6461 7461 2069 7320 636f  rived data is co
+00016630: 6e73 6964 6572 6564 2061 7320 6576 656e  nsidered as even
+00016640: 743c 2f70 3e0a 3c70 3e3c 7374 726f 6e67  t</p>.<p><strong
+00016650: 3e74 7970 653c 2f73 7472 6f6e 673e 3a20  >type</strong>: 
+00016660: 7468 6520 7479 7065 206f 6620 7468 6520  the type of the 
+00016670: 6461 7461 2063 616e 2062 6520 6f6e 6520  data can be one 
+00016680: 6f66 2022 6973 6f6c 6174 6564 222c 2263  of "isolated","c
+00016690: 6f6e 6669 6775 7261 7469 6f6e 2220 7768  onfiguration" wh
+000166a0: 656e 206e 6f20 7661 6c75 6520 6973 2070  en no value is p
+000166b0: 6173 7365 643c 2f70 3e0a 3c70 3e3c 7374  assed</p>.<p><st
+000166c0: 726f 6e67 3e72 6570 6c61 6365 3c2f 7374  rong>replace</st
+000166d0: 726f 6e67 3e3a 2061 206c 6973 7420 6f66  rong>: a list of
+000166e0: 2074 7570 6c65 732c 2077 6869 6368 2064   tuples, which d
+000166f0: 6566 696e 6520 6120 7265 706c 6163 656d  efine a replacem
+00016700: 656e 7420 706f 6c69 6379 2e20 4966 2061  ent policy. If a
+00016710: 2074 7570 6c65 2028 652c 6229 2065 7869   tuple (e,b) exi
+00016720: 7374 2069 6e20 7265 706c 6163 6520 6c69  st in replace li
+00016730: 7374 2c20 7468 656e 0a77 6865 6e20 6120  st, then.when a 
+00016740: 6220 6576 656e 7420 6973 2069 6e73 6572  b event is inser
+00016750: 7465 642c 2069 7420 7769 6c6c 2072 6570  ted, it will rep
+00016760: 6c61 6365 2061 6e20 6520 6576 656e 7420  lace an e event 
+00016770: 7769 7468 2074 6865 2073 616d 6520 7469  with the same ti
+00016780: 6d65 7374 616d 7020 2869 6620 6578 6973  mestamp (if exis
+00016790: 7473 292e 3c2f 703e 0a3c 703e 3c73 7472  ts).</p>.<p><str
+000167a0: 6f6e 673e 7265 7475 726e 3c2f 7374 726f  ong>return</stro
+000167b0: 6e67 3e3a 0a73 7472 7563 7475 7265 2e43  ng>:.structure.C
+000167c0: 6f6e 7465 7874 206f 626a 6563 7420 7768  ontext object wh
+000167d0: 656e 2074 6865 2064 6174 6120 6e61 6d65  en the data name
+000167e0: 206d 6174 6368 2074 6f20 7468 6520 7461   match to the ta
+000167f0: 7267 6574 206e 616d 6520 6f72 204e 6f6e  rget name or Non
+00016800: 652e 3c2f 703e 3c2f 6469 763e 0a3c 6465  e.</p></div>.<de
+00016810: 7461 696c 7320 636c 6173 733d 2273 6f75  tails class="sou
+00016820: 7263 6522 3e0a 3c73 756d 6d61 7279 3e0a  rce">.<summary>.
+00016830: 3c73 7061 6e3e 4578 7061 6e64 2073 6f75  <span>Expand sou
+00016840: 7263 6520 636f 6465 3c2f 7370 616e 3e0a  rce code</span>.
+00016850: 3c2f 7375 6d6d 6172 793e 0a3c 7072 653e  </summary>.<pre>
+00016860: 3c63 6f64 6520 636c 6173 733d 2270 7974  <code class="pyt
+00016870: 686f 6e22 3e64 6566 2063 6f6c 6c65 6374  hon">def collect
+00016880: 5f64 6174 6128 7365 6c66 2c20 7469 6d65  _data(self, time
+00016890: 7374 616d 702c 2073 6f75 7263 652c 206e  stamp, source, n
+000168a0: 616d 652c 2076 616c 7565 3d4e 6f6e 652c  ame, value=None,
+000168b0: 2074 7970 653d 2623 3334 3b55 6e69 7661   type=&#34;Univa
+000168c0: 7269 6174 6526 2333 343b 2c72 6570 6c61  riate&#34;,repla
+000168d0: 6365 3d5b 5d29 3a0a 2020 2020 2623 3339  ce=[]):.    &#39
+000168e0: 3b26 2333 393b 2623 3339 3b0a 2020 2020  ;&#39;&#39;.    
+000168f0: 5468 6973 206d 6574 686f 6420 6973 2075  This method is u
+00016900: 7365 6420 7768 656e 2064 6174 6120 6172  sed when data ar
+00016910: 6520 7061 7373 6564 2069 7465 7261 7469  e passed iterati
+00016920: 7665 6c79 2c20 616e 6420 7374 6f72 6564  vely, and stored
+00016930: 2069 6e20 6275 6666 6572 0a20 2020 2057   in buffer.    W
+00016940: 6865 6e20 6461 7461 206f 6620 7461 7267  hen data of targ
+00016950: 6574 2073 6f75 7263 6520 6172 7269 7665  et source arrive
+00016960: 2c20 6120 636f 7272 6573 706f 6e64 696e  , a correspondin
+00016970: 6720 636f 6e74 6578 7420 6973 2070 726f  g context is pro
+00016980: 6475 6365 642e 0a20 2020 2053 6f75 7263  duced..    Sourc
+00016990: 6573 2063 616e 2062 6520 6f66 2064 6966  es can be of dif
+000169a0: 6665 7265 6e74 2073 616d 706c 6520 7261  ferent sample ra
+000169b0: 7465 2028 616c 6c20 736f 7572 6365 7320  te (all sources 
+000169c0: 6172 6520 6d61 7070 6564 2074 6f20 7468  are mapped to th
+000169d0: 6520 7461 7267 6574 7320 7361 6d70 6c65  e targets sample
+000169e0: 2072 6174 6520 7768 656e 2063 6f6e 7465   rate when conte
+000169f0: 7874 2069 7320 7072 6f64 7563 6564 290a  xt is produced).
+00016a00: 0a20 2020 2053 6f75 7263 6573 2063 616e  .    Sources can
+00016a10: 2062 6520 6f66 2065 6974 6865 723a 0a0a   be of either:..
+00016a20: 2020 2020 3129 2043 6f6e 7469 6e75 6f75      1) Continuou
+00016a30: 7320 7479 7065 2028 7468 6f73 6520 7468  s type (those th
+00016a40: 6174 2068 6176 6520 736f 6d65 206b 696e  at have some kin
+00016a50: 6420 6f66 2061 7269 7468 6d65 7469 6320  d of arithmetic 
+00016a60: 7661 6c75 6529 0a0a 2020 2020 3229 2044  value)..    2) D
+00016a70: 6973 6372 6574 6520 6576 656e 7473 2028  iscrete events (
+00016a80: 7769 7468 6f75 7420 7661 6c75 6529 202c  without value) ,
+00016a90: 2077 6865 7265 206f 6e65 206f 6620 7468   where one of th
+00016aa0: 6520 7479 7065 2069 736f 6c61 7465 6420  e type isolated 
+00016ab0: 6f72 2063 6f6e 6669 6775 7261 7469 6f6e  or configuration
+00016ac0: 206d 7573 7420 6265 2061 7373 6967 6e65   must be assigne
+00016ad0: 640a 2020 2020 2020 2020 4120 6775 6964  d.        A guid
+00016ae0: 6520 6f6e 2068 6f77 2074 6f20 7370 6563  e on how to spec
+00016af0: 6966 7920 7468 6520 7479 7065 2069 732c  ify the type is,
+00016b00: 2074 6861 7420 6576 656e 7473 2077 6869   that events whi
+00016b10: 6368 2061 7373 756d 6564 2074 6f20 6861  ch assumed to ha
+00016b20: 7665 2069 6d70 6163 7420 6f6e 6c79 206f  ve impact only o
+00016b30: 6e20 7468 6569 7220 6f63 6375 7272 656e  n their occurren
+00016b40: 6365 2c20 6172 6520 6361 6c6c 6564 0a20  ce, are called. 
+00016b50: 2020 2020 2020 2069 736f 6c61 7465 642c         isolated,
+00016b60: 2077 6869 6c65 206f 7468 6572 7320 7468   while others th
+00016b70: 6174 2061 7265 2072 656c 6174 6564 2074  at are related t
+00016b80: 6f20 736f 6d65 206b 696e 6420 6f66 2063  o some kind of c
+00016b90: 6f6e 6669 6775 7261 7469 6f6e 2077 6974  onfiguration wit
+00016ba0: 6820 6d6f 7265 2070 6572 6d61 6e65 6e74  h more permanent
+00016bb0: 2069 6d70 6163 742c 2061 7265 2063 616c   impact, are cal
+00016bc0: 6c65 6420 636f 6e66 6967 7572 6174 696f  led configuratio
+00016bd0: 6e2e 0a20 2020 2020 2020 2045 7373 656e  n..        Essen
+00016be0: 7469 616c 6c79 2074 6865 2074 7970 6520  tially the type 
+00016bf0: 6f66 2074 6865 2065 7665 6e74 7320 6465  of the events de
+00016c00: 6669 6e65 2074 6865 2077 6179 2074 6861  fine the way tha
+00016c10: 7420 7769 6c6c 2062 6520 7472 616e 7366  t will be transf
+00016c20: 6f72 6d65 6420 746f 2072 6561 6c20 7661  ormed to real va
+00016c30: 6c75 6573 2074 696d 652d 7365 7269 6573  lues time-series
+00016c40: 2e0a 0a20 2020 202a 2a50 6172 616d 6574  ...    **Paramet
+00016c50: 6572 732a 2a3a 0a0a 2020 2020 2a2a 7469  ers**:..    **ti
+00016c60: 6d65 7374 616d 702a 2a3a 2020 5468 6520  mestamp**:  The 
+00016c70: 7469 6d65 7374 616d 7020 6f66 2074 6865  timestamp of the
+00016c80: 2061 7272 6976 6564 2076 616c 7565 0a0a   arrived value..
+00016c90: 2020 2020 2a2a 736f 7572 6365 2a2a 3a20      **source**: 
+00016ca0: 5468 6520 736f 7572 6365 206f 6620 7468  The source of th
+00016cb0: 6520 6172 7269 7665 6420 7661 6c75 650a  e arrived value.
+00016cc0: 0a20 2020 202a 2a6e 616d 652a 2a3a 2054  .    **name**: T
+00016cd0: 6865 206e 616d 6520 286f 7220 6964 656e  he name (or iden
+00016ce0: 7469 6669 6572 2920 6f66 2074 6865 2061  tifier) of the a
+00016cf0: 7272 6976 6564 2076 616c 7565 0a0a 2020  rrived value..  
+00016d00: 2020 2a2a 7661 6c75 652a 2a3a 2054 6865    **value**: The
+00016d10: 2076 616c 7565 2028 666c 6f61 7429 2c20   value (float), 
+00016d20: 696e 2063 6173 6520 7468 6973 2069 7320  in case this is 
+00016d30: 4e6f 6e65 2074 6865 2061 7272 6976 6564  None the arrived
+00016d40: 2064 6174 6120 6973 2063 6f6e 7369 6465   data is conside
+00016d50: 7265 6420 6173 2065 7665 6e74 0a0a 2020  red as event..  
+00016d60: 2020 2a2a 7479 7065 2a2a 3a20 7468 6520    **type**: the 
+00016d70: 7479 7065 206f 6620 7468 6520 6461 7461  type of the data
+00016d80: 2063 616e 2062 6520 6f6e 6520 6f66 2026   can be one of &
+00016d90: 2333 343b 6973 6f6c 6174 6564 2623 3334  #34;isolated&#34
+00016da0: 3b2c 2623 3334 3b63 6f6e 6669 6775 7261  ;,&#34;configura
+00016db0: 7469 6f6e 2623 3334 3b20 7768 656e 206e  tion&#34; when n
+00016dc0: 6f20 7661 6c75 6520 6973 2070 6173 7365  o value is passe
+00016dd0: 640a 0a20 2020 202a 2a72 6570 6c61 6365  d..    **replace
+00016de0: 2a2a 3a20 6120 6c69 7374 206f 6620 7475  **: a list of tu
+00016df0: 706c 6573 2c20 7768 6963 6820 6465 6669  ples, which defi
+00016e00: 6e65 2061 2072 6570 6c61 6365 6d65 6e74  ne a replacement
+00016e10: 2070 6f6c 6963 792e 2049 6620 6120 7475   policy. If a tu
+00016e20: 706c 6520 2865 2c62 2920 6578 6973 7420  ple (e,b) exist 
+00016e30: 696e 2072 6570 6c61 6365 206c 6973 742c  in replace list,
+00016e40: 2074 6865 6e0a 2020 2020 7768 656e 2061   then.    when a
+00016e50: 2062 2065 7665 6e74 2069 7320 696e 7365   b event is inse
+00016e60: 7274 6564 2c20 6974 2077 696c 6c20 7265  rted, it will re
+00016e70: 706c 6163 6520 616e 2065 2065 7665 6e74  place an e event
+00016e80: 2077 6974 6820 7468 6520 7361 6d65 2074   with the same t
+00016e90: 696d 6573 7461 6d70 2028 6966 2065 7869  imestamp (if exi
+00016ea0: 7374 7329 2e0a 0a20 2020 202a 2a72 6574  sts)...    **ret
+00016eb0: 7572 6e2a 2a3a 2020 7374 7275 6374 7572  urn**:  structur
+00016ec0: 652e 436f 6e74 6578 7420 6f62 6a65 6374  e.Context object
+00016ed0: 2077 6865 6e20 7468 6520 6461 7461 206e   when the data n
+00016ee0: 616d 6520 6d61 7463 6820 746f 2074 6865  ame match to the
+00016ef0: 2074 6172 6765 7420 6e61 6d65 206f 7220   target name or 
+00016f00: 4e6f 6e65 2e0a 2020 2020 2623 3339 3b26  None..    &#39;&
+00016f10: 2333 393b 2623 3339 3b0a 0a20 2020 2069  #39;&#39;..    i
+00016f20: 6620 7661 6c75 6520 6973 204e 6f6e 653a  f value is None:
+00016f30: 0a20 2020 2020 2020 2069 6620 7479 7065  .        if type
+00016f40: 206e 6f74 2069 6e20 5b26 2333 343b 6973   not in [&#34;is
+00016f50: 6f6c 6174 6564 2623 3334 3b2c 2026 2333  olated&#34;, &#3
+00016f60: 343b 636f 6e66 6967 7572 6174 696f 6e26  4;configuration&
+00016f70: 2333 343b 5d3a 0a20 2020 2020 2020 2020  #34;]:.         
+00016f80: 2020 2061 7373 6572 7420 4661 6c73 652c     assert False,
+00016f90: 2026 2333 343b 5468 6520 7479 7065 206d   &#34;The type m
+00016fa0: 7573 7420 6265 2064 6566 696e 6564 2061  ust be defined a
+00016fb0: 7320 6f6e 6520 6f66 205c 2623 3334 3b69  s one of \&#34;i
+00016fc0: 736f 6c61 7465 645c 2623 3334 3b20 616e  solated\&#34; an
+00016fd0: 6420 5c26 2333 343b 636f 6e66 6967 7572  d \&#34;configur
+00016fe0: 6174 696f 6e5c 2623 3334 3b20 7768 656e  ation\&#34; when
+00016ff0: 206e 6f20 7661 6c75 6520 6973 2070 6173   no value is pas
+00017000: 7365 6426 2333 343b 0a20 2020 2065 7665  sed&#34;.    eve
+00017010: 6e74 706f 696e 7420 3d20 4576 656e 7470  ntpoint = Eventp
+00017020: 6f69 6e74 2863 6f64 653d 6e61 6d65 2c20  oint(code=name, 
+00017030: 736f 7572 6365 3d73 6f75 7263 652c 2074  source=source, t
+00017040: 696d 6573 7461 6d70 3d74 696d 6573 7461  imestamp=timesta
+00017050: 6d70 2c20 6465 7461 696c 733d 7661 6c75  mp, details=valu
+00017060: 652c 2074 7970 653d 7479 7065 290a 2020  e, type=type).  
+00017070: 2020 7365 6c66 2e61 6464 5f74 6f5f 6275    self.add_to_bu
+00017080: 6666 6572 2865 7665 6e74 706f 696e 742c  ffer(eventpoint,
+00017090: 7265 706c 6163 6529 0a20 2020 2069 6620  replace).    if 
+000170a0: 7365 6c66 2e74 6172 6765 7420 3d3d 206e  self.target == n
+000170b0: 616d 6520 6f72 2073 656c 662e 7461 7267  ame or self.targ
+000170c0: 6574 203d 3d20 6626 2333 343b 7b6e 616d  et == f&#34;{nam
+000170d0: 657d 407b 736f 7572 6365 7d26 2333 343b  e}@{source}&#34;
+000170e0: 3a0a 2020 2020 2020 2020 636f 6e74 6578  :.        contex
+000170f0: 746f 626a 6563 7420 3d20 7365 6c66 2e67  tobject = self.g
+00017100: 656e 6572 6174 655f 636f 6e74 6578 7428  enerate_context(
+00017110: 653d 6576 656e 7470 6f69 6e74 2c20 6275  e=eventpoint, bu
+00017120: 6666 6572 3d73 656c 662e 6275 6666 6572  ffer=self.buffer
+00017130: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00017140: 2063 6f6e 7465 7874 6f62 6a65 6374 0a20   contextobject. 
+00017150: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00017160: 2072 6574 7572 6e20 4e6f 6e65 3c2f 636f   return None</co
+00017170: 6465 3e3c 2f70 7265 3e0a 3c2f 6465 7461  de></pre>.</deta
+00017180: 696c 733e 0a3c 2f64 643e 0a3c 6474 2069  ils>.</dd>.<dt i
+00017190: 643d 2250 646d 436f 6e74 6578 742e 436f  d="PdmContext.Co
+000171a0: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+000171b0: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+000171c0: 2e63 7265 6174 655f 636f 6e74 6578 7422  .create_context"
+000171d0: 3e3c 636f 6465 2063 6c61 7373 3d22 6e61  ><code class="na
+000171e0: 6d65 2066 6c65 7822 3e0a 3c73 7061 6e3e  me flex">.<span>
+000171f0: 6465 6620 3c73 7061 6e20 636c 6173 733d  def <span class=
+00017200: 2269 6465 6e74 223e 6372 6561 7465 5f63  "ident">create_c
+00017210: 6f6e 7465 7874 3c2f 7370 616e 3e3c 2f73  ontext</span></s
+00017220: 7061 6e3e 283c 7370 616e 3e73 656c 662c  pan>(<span>self,
+00017230: 2063 7572 7265 6e74 3ac2 a03c 6120 7469   current:..<a ti
+00017240: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
+00017250: 7574 696c 732e 7374 7275 6374 7572 652e  utils.structure.
+00017260: 4576 656e 7470 6f69 6e74 2220 6872 6566  Eventpoint" href
+00017270: 3d22 7574 696c 732f 7374 7275 6374 7572  ="utils/structur
+00017280: 652e 6874 6d6c 2350 646d 436f 6e74 6578  e.html#PdmContex
+00017290: 742e 7574 696c 732e 7374 7275 6374 7572  t.utils.structur
+000172a0: 652e 4576 656e 7470 6f69 6e74 223e 4576  e.Eventpoint">Ev
+000172b0: 656e 7470 6f69 6e74 3c2f 613e 2c20 6275  entpoint</a>, bu
+000172c0: 6666 6572 293c 2f73 7061 6e3e 0a3c 2f63  ffer)</span>.</c
+000172d0: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
+000172e0: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
+000172f0: 3e3c 703e 5472 616e 7366 6f72 6d20 7468  ><p>Transform th
+00017300: 6520 6461 7461 2063 6f6c 6c65 6374 6564  e data collected
+00017310: 2074 6f20 7468 6520 6275 6666 6572 2069   to the buffer i
+00017320: 6e20 746f 2073 7569 7461 626c 6520 666f  n to suitable fo
+00017330: 726d 2061 6e64 2067 656e 6572 6174 6573  rm and generates
+00017340: 2074 6865 2043 4420 7061 7274 206f 6620   the CD part of 
+00017350: 7468 6520 636f 6e74 6578 7420 616c 6f6e  the context alon
+00017360: 6720 7769 7468 0a74 6865 2065 6467 6573  g with.the edges
+00017370: 2061 6e64 2063 6861 7261 6374 6572 697a   and characteriz
+00017380: 6174 696f 6e73 3a3c 2f70 3e0a 3c70 3e3c  ations:</p>.<p><
+00017390: 7374 726f 6e67 3e53 7465 7073 3a3c 2f73  strong>Steps:</s
+000173a0: 7472 6f6e 673e 3c2f 703e 0a3c 703e 3c73  trong></p>.<p><s
+000173b0: 7472 6f6e 673e 4372 6561 7465 2043 443c  trong>Create CD<
+000173c0: 2f73 7472 6f6e 673e 3a20 5061 7261 6c6c  /strong>: Parall
+000173d0: 656c 2063 6f6e 7469 6e75 6f75 7320 7265  el continuous re
+000173e0: 7072 6573 656e 7461 7469 6f6e 7320 6f66  presentations of
+000173f0: 2061 6c6c 2064 6966 6665 7265 6e74 2073   all different s
+00017400: 6f75 7263 6573 2069 6e20 7468 6520 6275  ources in the bu
+00017410: 6666 6572 2e0a 5468 6973 2073 7465 7020  ffer..This step 
+00017420: 696e 766f 6c76 6573 2c20 6d61 7463 6869  involves, matchi
+00017430: 6e67 2074 6865 2064 6966 6665 7265 6e74  ng the different
+00017440: 2073 616d 706c 6520 7261 7465 7320 6f66   sample rates of
+00017450: 2064 6966 6665 7265 6e74 2073 6f75 7263   different sourc
+00017460: 6573 2074 6f20 7468 6174 206f 6620 7468  es to that of th
+00017470: 6520 7461 7267 6574 2e0a 5472 616e 7366  e target..Transf
+00017480: 6f72 6d20 7468 6520 4576 656e 7420 736f  orm the Event so
+00017490: 7572 6365 7320 746f 2063 6f6e 7469 6e75  urces to continu
+000174a0: 6f75 7320 7265 7072 6573 656e 7461 7469  ous representati
+000174b0: 6f6e 2e3c 2f70 3e0a 3c70 3e3c 7374 726f  on.</p>.<p><stro
+000174c0: 6e67 3e43 616c 6375 6c61 7465 2043 6175  ng>Calculate Cau
+000174d0: 7361 6c69 7479 2065 6467 6573 3c2f 7374  sality edges</st
+000174e0: 726f 6e67 3e3a 2050 6572 666f 726d 2043  rong>: Perform C
+000174f0: 6175 7361 6c20 4469 7363 6f76 6572 7920  ausal Discovery 
+00017500: 7573 696e 6720 7468 6520 6361 7573 616c  using the causal
+00017510: 6974 7920 6675 6e63 7469 6f6e 2c20 746f  ity function, to
+00017520: 2063 7265 6174 6520 6564 6765 730a 2870   create edges.(p
+00017530: 6172 7420 6f66 2043 5220 6f66 2074 6865  art of CR of the
+00017540: 2043 6f6e 7465 7874 293c 2f70 3e0a 3c70   Context)</p>.<p
+00017550: 3e3c 7374 726f 6e67 3e54 6167 2065 6163  ><strong>Tag eac
+00017560: 6820 6564 6765 2077 6974 6820 6368 6172  h edge with char
+00017570: 6163 7465 7269 7a61 7469 6f6e 3c2f 7374  acterization</st
+00017580: 726f 6e67 3e3a 2066 6f72 2065 6163 6820  rong>: for each 
+00017590: 2861 2c62 2920 696e 2074 6865 2065 6467  (a,b) in the edg
+000175a0: 6573 2c20 6120 6368 6172 6163 7465 7269  es, a characteri
+000175b0: 7a61 7469 6f6e 206f 6620 2875 6e6b 6e6f  zation of (unkno
+000175c0: 776e 2c20 6465 6372 6561 7365 2c0a 696e  wn, decrease,.in
+000175d0: 6372 6561 7365 292c 2062 6173 6564 206f  crease), based o
+000175e0: 6e20 7468 6520 7479 7065 206f 6620 7468  n the type of th
+000175f0: 6520 612e 3c2f 703e 0a3c 703e 3c73 7472  e a.</p>.<p><str
+00017600: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
+00017610: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
+00017620: 3c73 7472 6f6e 673e 6375 7272 656e 743c  <strong>current<
+00017630: 2f73 7472 6f6e 673e 3a20 5468 6520 6375  /strong>: The cu
+00017640: 7272 656e 7420 4576 656e 7420 6f66 2074  rrent Event of t
+00017650: 6172 6765 7427 7320 6461 7461 2077 6869  arget's data whi
+00017660: 6368 2074 7269 6765 7220 7468 6520 636f  ch triger the co
+00017670: 6e74 6578 7420 6372 6561 7469 6f6e 3c2f  ntext creation</
+00017680: 703e 0a3c 703e 3c73 7472 6f6e 673e 6275  p>.<p><strong>bu
+00017690: 6666 6572 3c2f 7374 726f 6e67 3e3a 206f  ffer</strong>: o
+000176a0: 7264 6572 6564 206c 6973 7420 7769 7468  rdered list with
+000176b0: 2045 7665 6e74 706f 696e 7420 6f66 2061   Eventpoint of a
+000176c0: 6c6c 2073 6f75 7263 6573 2e3c 2f70 3e0a  ll sources.</p>.
+000176d0: 3c70 3e3c 7374 726f 6e67 3e72 6574 7572  <p><strong>retur
+000176e0: 6e3c 2f73 7472 6f6e 673e 3a20 436f 6e74  n</strong>: Cont
+000176f0: 6578 7420 6f62 6a65 6374 2e3c 2f70 3e3c  ext object.</p><
+00017700: 2f64 6976 3e0a 3c64 6574 6169 6c73 2063  /div>.<details c
+00017710: 6c61 7373 3d22 736f 7572 6365 223e 0a3c  lass="source">.<
+00017720: 7375 6d6d 6172 793e 0a3c 7370 616e 3e45  summary>.<span>E
+00017730: 7870 616e 6420 736f 7572 6365 2063 6f64  xpand source cod
+00017740: 653c 2f73 7061 6e3e 0a3c 2f73 756d 6d61  e</span>.</summa
+00017750: 7279 3e0a 3c70 7265 3e3c 636f 6465 2063  ry>.<pre><code c
+00017760: 6c61 7373 3d22 7079 7468 6f6e 223e 6465  lass="python">de
+00017770: 6620 6372 6561 7465 5f63 6f6e 7465 7874  f create_context
+00017780: 2873 656c 662c 2063 7572 7265 6e74 3a20  (self, current: 
+00017790: 4576 656e 7470 6f69 6e74 2c20 6275 6666  Eventpoint, buff
+000177a0: 6572 293a 0a20 2020 2026 2333 343b 2623  er):.    &#34;&#
+000177b0: 3334 3b26 2333 343b 0a20 2020 2054 7261  34;&#34;.    Tra
+000177c0: 6e73 666f 726d 2074 6865 2064 6174 6120  nsform the data 
+000177d0: 636f 6c6c 6563 7465 6420 746f 2074 6865  collected to the
+000177e0: 2062 7566 6665 7220 696e 2074 6f20 7375   buffer in to su
+000177f0: 6974 6162 6c65 2066 6f72 6d20 616e 6420  itable form and 
+00017800: 6765 6e65 7261 7465 7320 7468 6520 4344  generates the CD
+00017810: 2070 6172 7420 6f66 2074 6865 2063 6f6e   part of the con
+00017820: 7465 7874 2061 6c6f 6e67 2077 6974 680a  text along with.
+00017830: 2020 2020 7468 6520 6564 6765 7320 616e      the edges an
+00017840: 6420 6368 6172 6163 7465 7269 7a61 7469  d characterizati
+00017850: 6f6e 733a 0a0a 2020 2020 2a2a 5374 6570  ons:..    **Step
+00017860: 733a 2a2a 0a0a 2020 2020 2a2a 4372 6561  s:**..    **Crea
+00017870: 7465 2043 442a 2a3a 2050 6172 616c 6c65  te CD**: Paralle
+00017880: 6c20 636f 6e74 696e 756f 7573 2072 6570  l continuous rep
+00017890: 7265 7365 6e74 6174 696f 6e73 206f 6620  resentations of 
+000178a0: 616c 6c20 6469 6666 6572 656e 7420 736f  all different so
+000178b0: 7572 6365 7320 696e 2074 6865 2062 7566  urces in the buf
+000178c0: 6665 722e 0a20 2020 2054 6869 7320 7374  fer..    This st
+000178d0: 6570 2069 6e76 6f6c 7665 732c 206d 6174  ep involves, mat
+000178e0: 6368 696e 6720 7468 6520 6469 6666 6572  ching the differ
+000178f0: 656e 7420 7361 6d70 6c65 2072 6174 6573  ent sample rates
+00017900: 206f 6620 6469 6666 6572 656e 7420 736f   of different so
+00017910: 7572 6365 7320 746f 2074 6861 7420 6f66  urces to that of
+00017920: 2074 6865 2074 6172 6765 742e 0a20 2020   the target..   
+00017930: 2054 7261 6e73 666f 726d 2074 6865 2045   Transform the E
+00017940: 7665 6e74 2073 6f75 7263 6573 2074 6f20  vent sources to 
+00017950: 636f 6e74 696e 756f 7573 2072 6570 7265  continuous repre
+00017960: 7365 6e74 6174 696f 6e2e 0a20 2020 200a  sentation..    .
+00017970: 2020 2020 2a2a 4361 6c63 756c 6174 6520      **Calculate 
+00017980: 4361 7573 616c 6974 7920 6564 6765 732a  Causality edges*
+00017990: 2a3a 2050 6572 666f 726d 2043 6175 7361  *: Perform Causa
+000179a0: 6c20 4469 7363 6f76 6572 7920 7573 696e  l Discovery usin
+000179b0: 6720 7468 6520 6361 7573 616c 6974 7920  g the causality 
+000179c0: 6675 6e63 7469 6f6e 2c20 746f 2063 7265  function, to cre
+000179d0: 6174 6520 6564 6765 7320 0a20 2020 2028  ate edges .    (
+000179e0: 7061 7274 206f 6620 4352 206f 6620 7468  part of CR of th
+000179f0: 6520 436f 6e74 6578 7429 0a20 2020 200a  e Context).    .
+00017a00: 2020 2020 2a2a 5461 6720 6561 6368 2065      **Tag each e
+00017a10: 6467 6520 7769 7468 2063 6861 7261 6374  dge with charact
+00017a20: 6572 697a 6174 696f 6e2a 2a3a 2066 6f72  erization**: for
+00017a30: 2065 6163 6820 2861 2c62 2920 696e 2074   each (a,b) in t
+00017a40: 6865 2065 6467 6573 2c20 6120 6368 6172  he edges, a char
+00017a50: 6163 7465 7269 7a61 7469 6f6e 206f 6620  acterization of 
+00017a60: 2875 6e6b 6e6f 776e 2c20 6465 6372 6561  (unknown, decrea
+00017a70: 7365 2c0a 2020 2020 2069 6e63 7265 6173  se,.     increas
+00017a80: 6529 2c20 6261 7365 6420 6f6e 2074 6865  e), based on the
+00017a90: 2074 7970 6520 6f66 2074 6865 2061 2e0a   type of the a..
+00017aa0: 0a20 2020 2020 2a2a 5061 7261 6d65 7465  .     **Paramete
+00017ab0: 7273 2a2a 3a0a 0a20 2020 2020 2a2a 6375  rs**:..     **cu
+00017ac0: 7272 656e 742a 2a3a 2054 6865 2063 7572  rrent**: The cur
+00017ad0: 7265 6e74 2045 7665 6e74 206f 6620 7461  rent Event of ta
+00017ae0: 7267 6574 2623 3339 3b73 2064 6174 6120  rget&#39;s data 
+00017af0: 7768 6963 6820 7472 6967 6572 2074 6865  which triger the
+00017b00: 2063 6f6e 7465 7874 2063 7265 6174 696f   context creatio
+00017b10: 6e0a 0a20 2020 2020 2a2a 6275 6666 6572  n..     **buffer
+00017b20: 2a2a 3a20 6f72 6465 7265 6420 6c69 7374  **: ordered list
+00017b30: 2077 6974 6820 4576 656e 7470 6f69 6e74   with Eventpoint
+00017b40: 206f 6620 616c 6c20 736f 7572 6365 732e   of all sources.
+00017b50: 0a0a 2020 2020 202a 2a72 6574 7572 6e2a  ..     **return*
+00017b60: 2a3a 2043 6f6e 7465 7874 206f 626a 6563  *: Context objec
+00017b70: 742e 0a20 2020 2026 2333 343b 2623 3334  t..    &#34;&#34
+00017b80: 3b26 2333 343b 0a20 2020 2023 2073 7461  ;&#34;.    # sta
+00017b90: 7274 203d 2074 696d 652e 7469 6d65 2829  rt = time.time()
+00017ba0: 0a20 2020 2023 2064 6620 7769 7468 202c  .    # df with ,
+00017bb0: 6474 2c63 6f64 652c 736f 7572 6365 2c76  dt,code,source,v
+00017bc0: 616c 7565 0a20 2020 2070 6f73 203d 2073  alue.    pos = s
+00017bd0: 656c 662e 636f 6e74 6578 745f 706f 730a  elf.context_pos.
+00017be0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00017bf0: 6765 2870 6f73 2c20 6c65 6e28 6275 6666  ge(pos, len(buff
+00017c00: 6572 2929 3a0a 2020 2020 2020 2020 6966  er)):.        if
+00017c10: 2062 7566 6665 725b 695d 2e74 696d 6573   buffer[i].times
+00017c20: 7461 6d70 2026 6c74 3b3d 2028 6375 7272  tamp &lt;= (curr
+00017c30: 656e 742e 7469 6d65 7374 616d 7020 2d20  ent.timestamp - 
+00017c40: 7064 2e54 696d 6564 656c 7461 2873 656c  pd.Timedelta(sel
+00017c50: 662e 686f 7269 7a6f 6e2c 2073 656c 662e  f.horizon, self.
+00017c60: 686f 7269 7a6f 6e5f 7469 6d65 2929 3a0a  horizon_time)):.
+00017c70: 2020 2020 2020 2020 2020 2020 706f 7320              pos 
+00017c80: 3d20 690a 2020 2020 2020 2020 656c 7365  = i.        else
+00017c90: 3a0a 2020 2020 2020 2020 2020 2020 6272  :.            br
+00017ca0: 6561 6b0a 0a20 2020 2073 656c 662e 636f  eak..    self.co
+00017cb0: 6e74 6578 745f 706f 7320 3d20 706f 730a  ntext_pos = pos.
+00017cc0: 2020 2020 2320 656e 643d 7469 6d65 2e74      # end=time.t
+00017cd0: 696d 6528 290a 2020 2020 2320 7072 696e  ime().    # prin
+00017ce0: 7428 6626 2333 343b 6669 6e64 2070 6f73  t(f&#34;find pos
+00017cf0: 6974 696f 6e20 6f6e 2062 7566 6665 723a  ition on buffer:
+00017d00: 207b 656e 642d 7374 6172 747d 2623 3334   {end-start}&#34
+00017d10: 3b29 0a0a 2020 2020 2320 7374 6172 7420  ;)..    # start 
+00017d20: 3d20 7469 6d65 2e74 696d 6528 290a 2020  = time.time().  
+00017d30: 2020 6461 7461 666f 7263 6f6e 7465 7874    dataforcontext
+00017d40: 203d 2062 7566 6665 725b 706f 733a 5d0a   = buffer[pos:].
+00017d50: 2020 2020 6461 7461 746f 6466 203d 205b      datatodf = [
+00017d60: 5b70 642e 746f 5f64 6174 6574 696d 6528  [pd.to_datetime(
+00017d70: 652e 7469 6d65 7374 616d 7029 2066 6f72  e.timestamp) for
+00017d80: 2065 2069 6e20 6461 7461 666f 7263 6f6e   e in dataforcon
+00017d90: 7465 7874 5d2c 0a20 2020 2020 2020 2020  text],.         
+00017da0: 2020 2020 2020 205b 7374 7228 652e 636f         [str(e.co
+00017db0: 6465 2920 666f 7220 6520 696e 2064 6174  de) for e in dat
+00017dc0: 6166 6f72 636f 6e74 6578 745d 2c0a 2020  aforcontext],.  
+00017dd0: 2020 2020 2020 2020 2020 2020 2020 5b73                [s
+00017de0: 7472 2865 2e73 6f75 7263 6529 2066 6f72  tr(e.source) for
+00017df0: 2065 2069 6e20 6461 7461 666f 7263 6f6e   e in dataforcon
+00017e00: 7465 7874 5d2c 0a20 2020 2020 2020 2020  text],.         
+00017e10: 2020 2020 2020 205b 652e 6465 7461 696c         [e.detail
+00017e20: 7320 666f 7220 6520 696e 2064 6174 6166  s for e in dataf
+00017e30: 6f72 636f 6e74 6578 745d 2c0a 2020 2020  orcontext],.    
+00017e40: 2020 2020 2020 2020 2020 2020 5b65 2e74              [e.t
+00017e50: 7970 6520 666f 7220 6520 696e 2064 6174  ype for e in dat
+00017e60: 6166 6f72 636f 6e74 6578 745d 5d0a 0a20  aforcontext]].. 
+00017e70: 2020 206e 7063 6f6e 7465 7874 203d 206e     npcontext = n
+00017e80: 702e 6172 7261 7928 6461 7461 746f 6466  p.array(datatodf
+00017e90: 290a 2020 2020 6e70 636f 6e74 6578 7420  ).    npcontext 
+00017ea0: 3d20 6e70 636f 6e74 6578 742e 540a 0a20  = npcontext.T.. 
+00017eb0: 2020 206e 7063 6f6e 7465 7874 203d 2073     npcontext = s
+00017ec0: 656c 662e 4e75 6d70 795f 7072 6570 726f  elf.Numpy_prepro
+00017ed0: 6363 6573 7328 6e70 636f 6e74 6578 7429  ccess(npcontext)
+00017ee0: 0a0a 2020 2020 2320 656e 6420 3d20 7469  ..    # end = ti
+00017ef0: 6d65 2e74 696d 6528 290a 2020 2020 2320  me.time().    # 
+00017f00: 7072 696e 7428 6626 2333 343b 7072 6570  print(f&#34;prep
+00017f10: 726f 6365 7373 2064 663a 207b 656e 6420  rocess df: {end 
+00017f20: 2d20 7374 6172 747d 2623 3334 3b29 0a20  - start}&#34;). 
+00017f30: 2020 2023 2323 2323 2323 2323 2323 2323     #############
+00017f40: 2063 7265 6174 6520 636f 6e74 6578 7420   create context 
+00017f50: 2323 2323 2323 2323 2323 2323 2323 2323  ################
+00017f60: 2323 2323 2323 2323 2323 2323 0a20 2020  ############.   
+00017f70: 2023 2073 7461 7274 203d 2074 696d 652e   # start = time.
+00017f80: 7469 6d65 2829 0a20 2020 2023 2320 636f  time().    ## co
+00017f90: 6c6c 6563 7420 756e 6971 6575 2064 6174  llect uniqeu dat
+00017fa0: 6120 7365 7269 6573 0a20 2020 2023 2061  a series.    # a
+00017fb0: 6c6c 636f 6465 7320 3d20 6466 5b26 2333  llcodes = df[&#3
+00017fc0: 393b 636f 6465 2623 3339 3b5d 2e75 6e69  9;code&#39;].uni
+00017fd0: 7175 6528 290a 2020 2020 616c 6c63 6f64  que().    allcod
+00017fe0: 6573 203d 206e 702e 756e 6971 7565 286e  es = np.unique(n
+00017ff0: 7063 6f6e 7465 7874 5b3a 2c20 315d 290a  pcontext[:, 1]).
+00018000: 2020 2020 616c 6c63 6f64 6573 203d 205b      allcodes = [
+00018010: 636f 6465 2066 6f72 2063 6f64 6520 696e  code for code in
+00018020: 2061 6c6c 636f 6465 735d 0a20 2020 2061   allcodes].    a
+00018030: 6c6c 636f 6465 7320 3d20 7365 7428 616c  llcodes = set(al
+00018040: 6c63 6f64 6573 290a 0a20 2020 2066 6f72  lcodes)..    for
+00018050: 2075 6e63 6f64 6520 696e 2061 6c6c 636f   uncode in allco
+00018060: 6465 733a 0a20 2020 2020 2020 2066 6f72  des:.        for
+00018070: 2071 7120 696e 2072 616e 6765 286c 656e   qq in range(len
+00018080: 286e 7063 6f6e 7465 7874 2929 3a0a 2020  (npcontext)):.  
+00018090: 2020 2020 2020 2020 2020 6966 2075 6e63            if unc
+000180a0: 6f64 6520 696e 206e 7063 6f6e 7465 7874  ode in npcontext
+000180b0: 5b71 715d 5b31 5d3a 0a20 2020 2020 2020  [qq][1]:.       
+000180c0: 2020 2020 2020 2020 2073 656c 662e 7479           self.ty
+000180d0: 7065 5f6f 665f 7365 7269 6573 5b75 6e63  pe_of_series[unc
+000180e0: 6f64 655d 203d 206e 7063 6f6e 7465 7874  ode] = npcontext
+000180f0: 5b71 715d 5b34 5d0a 2020 2020 2020 2020  [qq][4].        
+00018100: 2020 2020 2020 2020 6272 6561 6b0a 0a20          break.. 
+00018110: 2020 2023 2320 6275 696c 6420 7461 7267     ## build targ
+00018120: 6574 2073 6572 6965 730a 2020 2020 7461  et series.    ta
+00018130: 7267 6574 5f73 6572 6965 735f 6e61 6d65  rget_series_name
+00018140: 2c20 7461 7267 6574 5f73 6572 6965 7320  , target_series 
+00018150: 3d20 7365 6c66 2e62 7569 6c64 5f74 6172  = self.build_tar
+00018160: 6765 745f 7365 7269 6573 5f66 6f72 5f63  get_series_for_c
+00018170: 6f6e 7465 7874 2863 7572 7265 6e74 2c20  ontext(current, 
+00018180: 6e70 636f 6e74 6578 7429 0a0a 2020 2020  npcontext)..    
+00018190: 2323 2063 7265 6174 6520 7365 7269 6573  ## create series
+000181a0: 2066 6f72 2065 6163 6820 736f 7572 6365   for each source
+000181b0: 2028 616c 6c64 6174 6129 0a20 2020 2061   (alldata).    a
+000181c0: 6c6c 6461 7461 203d 2073 656c 662e 6372  lldata = self.cr
+000181d0: 6561 7465 5f63 6f6e 7469 6e75 6f75 735f  eate_continuous_
+000181e0: 7265 7072 6573 656e 7461 7469 6f6e 2874  representation(t
+000181f0: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
+00018200: 652c 2074 6172 6765 745f 7365 7269 6573  e, target_series
+00018210: 2c20 6e70 636f 6e74 6578 742c 0a20 2020  , npcontext,.   
+00018220: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018230: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018240: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018250: 2073 656c 662e 7479 7065 5f6f 665f 7365   self.type_of_se
+00018260: 7269 6573 2c20 616c 6c63 6f64 6573 290a  ries, allcodes).
+00018270: 2020 2020 2320 656e 6420 3d20 7469 6d65      # end = time
+00018280: 2e74 696d 6528 290a 2020 2020 2320 7072  .time().    # pr
+00018290: 696e 7428 6626 2333 343b 4372 6561 7465  int(f&#34;Create
+000182a0: 2073 6572 6965 733a 207b 656e 642d 7374   series: {end-st
+000182b0: 6172 747d 2623 3334 3b29 0a0a 2020 2020  art}&#34;)..    
+000182c0: 7374 6f72 696e 6720 3d20 7365 6c66 2e63  storing = self.c
+000182d0: 616c 6375 6c61 7465 5f65 6467 6573 2861  alculate_edges(a
+000182e0: 6c6c 6461 7461 2c20 6375 7272 656e 742e  lldata, current.
+000182f0: 7469 6d65 7374 616d 7029 0a20 2020 2073  timestamp).    s
+00018300: 746f 7269 6e67 5b26 2333 343b 6368 6172  toring[&#34;char
+00018310: 6163 7465 7269 7a61 7469 6f6e 2623 3334  acterization&#34
+00018320: 3b5d 203d 2073 656c 662e 6765 745f 6368  ;] = self.get_ch
+00018330: 6172 6163 7465 7269 7a61 7469 6f6e 2873  aracterization(s
+00018340: 746f 7269 6e67 290a 0a20 2020 2023 2070  toring)..    # p
+00018350: 7269 6e74 2866 2623 3334 3b43 616c 6375  rint(f&#34;Calcu
+00018360: 6c61 7465 2065 6467 6573 3a20 7b65 6e64  late edges: {end
+00018370: 202d 2073 7461 7274 7d26 2333 343b 290a   - start}&#34;).
+00018380: 2020 2020 2320 7072 696e 7428 2623 3334      # print(&#34
+00018390: 3b3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ;===============
+000183a0: 3d3d 3d3d 3d3d 3d3d 3d26 2333 343b 290a  =========&#34;).
+000183b0: 0a20 2020 2063 6f6e 7465 7874 7062 6a65  .    contextpbje
+000183c0: 6374 203d 2043 6f6e 7465 7874 2e63 6f6e  ct = Context.con
+000183d0: 7465 7874 5f66 726f 6d5f 6469 6374 2873  text_from_dict(s
+000183e0: 746f 7269 6e67 290a 2020 2020 7265 7475  toring).    retu
+000183f0: 726e 2063 6f6e 7465 7874 7062 6a65 6374  rn contextpbject
+00018400: 2c20 7461 7267 6574 5f73 6572 6965 735f  , target_series_
+00018410: 6e61 6d65 3c2f 636f 6465 3e3c 2f70 7265  name</code></pre
+00018420: 3e0a 3c2f 6465 7461 696c 733e 0a3c 2f64  >.</details>.</d
+00018430: 643e 0a3c 6474 2069 643d 2250 646d 436f  d>.<dt id="PdmCo
+00018440: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+00018450: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+00018460: 656e 6572 6174 6f72 2e63 7265 6174 655f  enerator.create_
+00018470: 636f 6e74 696e 756f 7573 5f72 6570 7265  continuous_repre
+00018480: 7365 6e74 6174 696f 6e22 3e3c 636f 6465  sentation"><code
+00018490: 2063 6c61 7373 3d22 6e61 6d65 2066 6c65   class="name fle
+000184a0: 7822 3e0a 3c73 7061 6e3e 6465 6620 3c73  x">.<span>def <s
+000184b0: 7061 6e20 636c 6173 733d 2269 6465 6e74  pan class="ident
+000184c0: 223e 6372 6561 7465 5f63 6f6e 7469 6e75  ">create_continu
+000184d0: 6f75 735f 7265 7072 6573 656e 7461 7469  ous_representati
+000184e0: 6f6e 3c2f 7370 616e 3e3c 2f73 7061 6e3e  on</span></span>
+000184f0: 283c 7370 616e 3e73 656c 662c 2074 6172  (<span>self, tar
+00018500: 6765 745f 7365 7269 6573 5f6e 616d 652c  get_series_name,
+00018510: 2074 6172 6765 745f 7365 7269 6573 2c20   target_series, 
+00018520: 6466 2c20 7479 7065 5f6f 665f 7365 7269  df, type_of_seri
+00018530: 6573 2c20 616c 6c63 6f64 6573 293c 2f73  es, allcodes)</s
+00018540: 7061 6e3e 0a3c 2f63 6f64 653e 3c2f 6474  pan>.</code></dt
+00018550: 3e0a 3c64 643e 0a3c 6469 7620 636c 6173  >.<dd>.<div clas
+00018560: 733d 2264 6573 6322 3e3c 2f64 6976 3e0a  s="desc"></div>.
+00018570: 3c64 6574 6169 6c73 2063 6c61 7373 3d22  <details class="
+00018580: 736f 7572 6365 223e 0a3c 7375 6d6d 6172  source">.<summar
+00018590: 793e 0a3c 7370 616e 3e45 7870 616e 6420  y>.<span>Expand 
+000185a0: 736f 7572 6365 2063 6f64 653c 2f73 7061  source code</spa
+000185b0: 6e3e 0a3c 2f73 756d 6d61 7279 3e0a 3c70  n>.</summary>.<p
+000185c0: 7265 3e3c 636f 6465 2063 6c61 7373 3d22  re><code class="
+000185d0: 7079 7468 6f6e 223e 6465 6620 6372 6561  python">def crea
+000185e0: 7465 5f63 6f6e 7469 6e75 6f75 735f 7265  te_continuous_re
+000185f0: 7072 6573 656e 7461 7469 6f6e 2873 656c  presentation(sel
+00018600: 662c 2074 6172 6765 745f 7365 7269 6573  f, target_series
+00018610: 5f6e 616d 652c 2074 6172 6765 745f 7365  _name, target_se
+00018620: 7269 6573 2c20 6466 2c20 7479 7065 5f6f  ries, df, type_o
+00018630: 665f 7365 7269 6573 2c20 616c 6c63 6f64  f_series, allcod
+00018640: 6573 293a 0a20 2020 2023 2069 6620 6c65  es):.    # if le
+00018650: 6e28 7461 7267 6574 5f73 6572 6965 7329  n(target_series)
+00018660: 2026 6c74 3b20 353a 0a20 2020 2023 2020   &lt; 5:.    #  
+00018670: 2020 2061 6c6c 6461 7461 203d 205b 5d0a     alldata = [].
+00018680: 2020 2020 2320 2020 2020 7061 6464 696e      #     paddin
+00018690: 673d 5b30 2066 6f72 2071 2069 6e20 7261  g=[0 for q in ra
+000186a0: 6e67 6528 352d 6c65 6e28 7461 7267 6574  nge(5-len(target
+000186b0: 5f73 6572 6965 7329 295d 0a20 2020 2023  _series))].    #
+000186c0: 2020 2020 2070 6164 6469 6e67 2e65 7874       padding.ext
+000186d0: 656e 6428 5b74 6167 735b 305d 2066 6f72  end([tags[0] for
+000186e0: 2074 6167 7320 696e 2074 6172 6765 745f   tags in target_
+000186f0: 7365 7269 6573 5d29 0a20 2020 2023 2020  series]).    #  
+00018700: 2020 2061 6c6c 6461 7461 2e61 7070 656e     alldata.appen
+00018710: 6428 2874 6172 6765 745f 7365 7269 6573  d((target_series
+00018720: 5f6e 616d 652c 2070 6164 6469 6e67 2929  _name, padding))
+00018730: 0a20 2020 2023 2020 2020 2072 6574 7572  .    #     retur
+00018740: 6e20 616c 6c64 6174 610a 2020 2020 7769  n alldata.    wi
+00018750: 6e64 6f77 7661 6c75 6573 203d 2064 6620  ndowvalues = df 
+00018760: 2023 202e 7661 6c75 6573 0a20 2020 2061   # .values.    a
+00018770: 6c6c 6461 7461 203d 205b 5d0a 2020 2020  lldata = [].    
+00018780: 616c 6c64 6174 612e 6170 7065 6e64 2828  alldata.append((
+00018790: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
+000187a0: 6d65 2c20 5b74 6167 5b30 5d20 666f 7220  me, [tag[0] for 
+000187b0: 7461 6720 696e 2074 6172 6765 745f 7365  tag in target_se
+000187c0: 7269 6573 5d29 290a 2020 2020 666f 7220  ries])).    for 
+000187d0: 6e61 6d65 2069 6e20 616c 6c63 6f64 6573  name in allcodes
+000187e0: 3a0a 2020 2020 2020 2020 2320 616c 7265  :.        # alre
+000187f0: 6164 7920 6361 6c63 756c 6174 6564 2069  ady calculated i
+00018800: 6e20 7461 7267 6574 7365 7269 6573 2e0a  n targetseries..
+00018810: 2020 2020 2020 2020 6966 2074 6172 6765          if targe
+00018820: 745f 7365 7269 6573 5f6e 616d 6520 696e  t_series_name in
+00018830: 206e 616d 653a 0a20 2020 2020 2020 2020   name:.         
+00018840: 2020 2063 6f6e 7469 6e75 650a 0a20 2020     continue..   
+00018850: 2020 2020 2023 2064 6574 6563 7420 7468       # detect th
+00018860: 6520 6f63 6375 7261 6e63 6965 730a 2020  e occurancies.  
+00018870: 2020 2020 2020 6f63 6375 7265 6e63 6965        occurencie
+00018880: 7320 3d20 5b28 7661 6c75 652c 2074 696d  s = [(value, tim
+00018890: 6529 2066 6f72 2063 6f64 652c 2076 616c  e) for code, val
+000188a0: 7565 2c20 7469 6d65 2069 6e0a 2020 2020  ue, time in.    
+000188b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000188c0: 2020 207a 6970 2877 696e 646f 7776 616c     zip(windowval
+000188d0: 7565 735b 3a2c 2031 5d2c 2077 696e 646f  ues[:, 1], windo
+000188e0: 7776 616c 7565 735b 3a2c 2033 5d2c 2077  wvalues[:, 3], w
+000188f0: 696e 646f 7776 616c 7565 735b 3a2c 2030  indowvalues[:, 0
+00018900: 5d29 2069 6620 6e61 6d65 2069 6e20 636f  ]) if name in co
+00018910: 6465 5d0a 0a20 2020 2020 2020 2076 6563  de]..        vec
+00018920: 746f 7220 3d20 5b30 2066 6f72 2069 2069  tor = [0 for i i
+00018930: 6e20 7261 6e67 6528 6c65 6e28 7461 7267  n range(len(targ
+00018940: 6574 5f73 6572 6965 7329 295d 0a20 2020  et_series))].   
+00018950: 2020 2020 2069 6620 6c65 6e28 6f63 6375       if len(occu
+00018960: 7265 6e63 6965 7329 203d 3d20 303a 0a20  rencies) == 0:. 
+00018970: 2020 2020 2020 2020 2020 2076 6563 746f             vecto
+00018980: 7220 3d20 5b30 2066 6f72 2069 2069 6e20  r = [0 for i in 
+00018990: 7261 6e67 6528 6c65 6e28 7461 7267 6574  range(len(target
+000189a0: 5f73 6572 6965 7329 295d 0a20 2020 2020  _series))].     
+000189b0: 2020 2065 6c69 6620 6f63 6375 7265 6e63     elif occurenc
+000189c0: 6965 735b 305d 5b30 5d20 6973 206e 6f74  ies[0][0] is not
+000189d0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+000189e0: 2020 2076 6563 746f 7220 3d20 7365 6c66     vector = self
+000189f0: 2e62 7569 6c64 5f63 6f6e 7465 7874 5f66  .build_context_f
+00018a00: 6f72 5f75 6e69 7661 7269 6174 6528 7461  or_univariate(ta
+00018a10: 7267 6574 5f73 6572 6965 732c 206f 6363  rget_series, occ
+00018a20: 7572 656e 6369 6573 290a 2020 2020 2020  urencies).      
+00018a30: 2020 656c 6966 2074 7970 655f 6f66 5f73    elif type_of_s
+00018a40: 6572 6965 735b 6e61 6d65 5d20 3d3d 2026  eries[name] == &
+00018a50: 2333 343b 6973 6f6c 6174 6564 2623 3334  #34;isolated&#34
+00018a60: 3b3a 0a20 2020 2020 2020 2020 2020 2076  ;:.            v
+00018a70: 6563 746f 7220 3d20 7365 6c66 2e62 7569  ector = self.bui
+00018a80: 6c64 5f63 6f6e 7465 7874 5f66 6f72 5f69  ld_context_for_i
+00018a90: 736f 6c61 7465 6428 7461 7267 6574 5f73  solated(target_s
+00018aa0: 6572 6965 732c 206f 6363 7572 656e 6369  eries, occurenci
+00018ab0: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
+00018ac0: 2074 7970 655f 6f66 5f73 6572 6965 735b   type_of_series[
+00018ad0: 6e61 6d65 5d20 3d3d 2026 2333 343b 636f  name] == &#34;co
+00018ae0: 6e66 6967 7572 6174 696f 6e26 2333 343b  nfiguration&#34;
+00018af0: 3a0a 2020 2020 2020 2020 2020 2020 7665  :.            ve
+00018b00: 6374 6f72 203d 2073 656c 662e 6275 696c  ctor = self.buil
+00018b10: 645f 636f 6e74 6578 745f 666f 725f 636f  d_context_for_co
+00018b20: 6e66 6975 6775 7261 7469 6f6e 2874 6172  nfiuguration(tar
+00018b30: 6765 745f 7365 7269 6573 2c20 6f63 6375  get_series, occu
+00018b40: 7265 6e63 6965 7329 0a0a 2020 2020 2020  rencies)..      
+00018b50: 2020 6f6b 203d 2026 2333 343b 6f6b 2623    ok = &#34;ok&#
+00018b60: 3334 3b0a 2020 2020 2020 2020 2320 6966  34;.        # if
+00018b70: 2076 6563 746f 7220 6973 2073 7461 7469   vector is stati
+00018b80: 6f6e 6172 7920 7468 656e 206e 6f20 636f  onary then no co
+00018b90: 6e74 6578 742e 0a20 2020 2020 2020 2069  ntext..        i
+00018ba0: 6620 6d61 7828 7665 6374 6f72 2920 3d3d  f max(vector) ==
+00018bb0: 2030 2061 6e64 206d 696e 2876 6563 746f   0 and min(vecto
+00018bc0: 7229 203d 3d20 303a 0a20 2020 2020 2020  r) == 0:.       
+00018bd0: 2020 2020 2076 6563 746f 7220 3d20 4e6f       vector = No
+00018be0: 6e65 0a20 2020 2020 2020 2061 6c6c 6461  ne.        allda
+00018bf0: 7461 2e61 7070 656e 6428 286e 616d 652c  ta.append((name,
+00018c00: 2076 6563 746f 7229 290a 2020 2020 7265   vector)).    re
+00018c10: 7475 726e 2061 6c6c 6461 7461 3c2f 636f  turn alldata</co
+00018c20: 6465 3e3c 2f70 7265 3e0a 3c2f 6465 7461  de></pre>.</deta
+00018c30: 696c 733e 0a3c 2f64 643e 0a3c 6474 2069  ils>.</dd>.<dt i
+00018c40: 643d 2250 646d 436f 6e74 6578 742e 436f  d="PdmContext.Co
+00018c50: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+00018c60: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+00018c70: 2e63 7265 6174 655f 696e 7465 7270 7265  .create_interpre
+00018c80: 7461 7469 6f6e 223e 3c63 6f64 6520 636c  tation"><code cl
+00018c90: 6173 733d 226e 616d 6520 666c 6578 223e  ass="name flex">
+00018ca0: 0a3c 7370 616e 3e64 6566 203c 7370 616e  .<span>def <span
+00018cb0: 2063 6c61 7373 3d22 6964 656e 7422 3e63   class="ident">c
+00018cc0: 7265 6174 655f 696e 7465 7270 7265 7461  reate_interpreta
+00018cd0: 7469 6f6e 3c2f 7370 616e 3e3c 2f73 7061  tion</span></spa
+00018ce0: 6e3e 283c 7370 616e 3e73 656c 662c 2063  n>(<span>self, c
+00018cf0: 6f6e 7465 7874 6375 7272 656e 743a c2a0  ontextcurrent:..
+00018d00: 3c61 2074 6974 6c65 3d22 5064 6d43 6f6e  <a title="PdmCon
+00018d10: 7465 7874 2e75 7469 6c73 2e73 7472 7563  text.utils.struc
+00018d20: 7475 7265 2e43 6f6e 7465 7874 2220 6872  ture.Context" hr
+00018d30: 6566 3d22 7574 696c 732f 7374 7275 6374  ef="utils/struct
+00018d40: 7572 652e 6874 6d6c 2350 646d 436f 6e74  ure.html#PdmCont
+00018d50: 6578 742e 7574 696c 732e 7374 7275 6374  ext.utils.struct
+00018d60: 7572 652e 436f 6e74 6578 7422 3e43 6f6e  ure.Context">Con
+00018d70: 7465 7874 3c2f 613e 2c20 7461 7267 6574  text</a>, target
+00018d80: 5f73 6572 6965 735f 6e61 6d65 293c 2f73  _series_name)</s
+00018d90: 7061 6e3e 0a3c 2f63 6f64 653e 3c2f 6474  pan>.</code></dt
+00018da0: 3e0a 3c64 643e 0a3c 6469 7620 636c 6173  >.<dd>.<div clas
+00018db0: 733d 2264 6573 6322 3e3c 703e 5468 6973  s="desc"><p>This
+00018dc0: 206d 6574 686f 6420 636f 6c6c 6563 7420   method collect 
+00018dd0: 616c 6c20 7468 6520 636f 6e74 6578 7473  all the contexts
+00018de0: 2069 6e20 7468 6520 686f 7269 7a6f 6e20   in the horizon 
+00018df0: 616e 6420 6361 6c6c 7320 7468 6520 696e  and calls the in
+00018e00: 7465 7270 7265 7461 7469 6f6e 206d 6574  terpretation met
+00018e10: 686f 642e 3c2f 703e 0a3c 703e 3c73 7472  hod.</p>.<p><str
+00018e20: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
+00018e30: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
+00018e40: 3c73 7472 6f6e 673e 636f 6e74 6578 7463  <strong>contextc
+00018e50: 7572 7265 6e74 3c2f 7374 726f 6e67 3e3a  urrent</strong>:
+00018e60: 2054 6865 2043 6f6e 7465 7874 2066 6f72   The Context for
+00018e70: 2077 6869 6368 2074 6865 2069 6e74 6572   which the inter
+00018e80: 7072 6574 6174 696f 6e20 6973 2063 616c  pretation is cal
+00018e90: 6375 6c61 7465 643c 2f70 3e0a 3c70 3e3c  culated</p>.<p><
+00018ea0: 7374 726f 6e67 3e74 6172 6765 745f 7365  strong>target_se
+00018eb0: 7269 6573 5f6e 616d 653c 2f73 7472 6f6e  ries_name</stron
+00018ec0: 673e 3a20 5468 656e 206e 616d 6520 6f66  g>: Then name of
+00018ed0: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
+00018ee0: 6162 6c65 3c2f 703e 3c2f 6469 763e 0a3c  able</p></div>.<
+00018ef0: 6465 7461 696c 7320 636c 6173 733d 2273  details class="s
+00018f00: 6f75 7263 6522 3e0a 3c73 756d 6d61 7279  ource">.<summary
+00018f10: 3e0a 3c73 7061 6e3e 4578 7061 6e64 2073  >.<span>Expand s
+00018f20: 6f75 7263 6520 636f 6465 3c2f 7370 616e  ource code</span
+00018f30: 3e0a 3c2f 7375 6d6d 6172 793e 0a3c 7072  >.</summary>.<pr
+00018f40: 653e 3c63 6f64 6520 636c 6173 733d 2270  e><code class="p
+00018f50: 7974 686f 6e22 3e64 6566 2063 7265 6174  ython">def creat
+00018f60: 655f 696e 7465 7270 7265 7461 7469 6f6e  e_interpretation
+00018f70: 2873 656c 662c 2063 6f6e 7465 7874 6375  (self, contextcu
+00018f80: 7272 656e 743a 2043 6f6e 7465 7874 2c20  rrent: Context, 
+00018f90: 7461 7267 6574 5f73 6572 6965 735f 6e61  target_series_na
+00018fa0: 6d65 293a 0a20 2020 2026 2333 343b 2623  me):.    &#34;&#
+00018fb0: 3334 3b26 2333 343b 0a20 2020 2054 6869  34;&#34;.    Thi
+00018fc0: 7320 6d65 7468 6f64 2063 6f6c 6c65 6374  s method collect
+00018fd0: 2061 6c6c 2074 6865 2063 6f6e 7465 7874   all the context
+00018fe0: 7320 696e 2074 6865 2068 6f72 697a 6f6e  s in the horizon
+00018ff0: 2061 6e64 2063 616c 6c73 2074 6865 2069   and calls the i
+00019000: 6e74 6572 7072 6574 6174 696f 6e20 6d65  nterpretation me
+00019010: 7468 6f64 2e0a 0a20 2020 202a 2a50 6172  thod...    **Par
+00019020: 616d 6574 6572 732a 2a3a 0a0a 2020 2020  ameters**:..    
+00019030: 2a2a 636f 6e74 6578 7463 7572 7265 6e74  **contextcurrent
+00019040: 2a2a 3a20 5468 6520 436f 6e74 6578 7420  **: The Context 
+00019050: 666f 7220 7768 6963 6820 7468 6520 696e  for which the in
+00019060: 7465 7270 7265 7461 7469 6f6e 2069 7320  terpretation is 
+00019070: 6361 6c63 756c 6174 6564 0a0a 2020 2020  calculated..    
+00019080: 2a2a 7461 7267 6574 5f73 6572 6965 735f  **target_series_
+00019090: 6e61 6d65 2a2a 3a20 5468 656e 206e 616d  name**: Then nam
+000190a0: 6520 6f66 2074 6865 2074 6172 6765 7420  e of the target 
+000190b0: 7661 7269 6162 6c65 0a20 2020 2026 2333  variable.    &#3
+000190c0: 343b 2623 3334 3b26 2333 343b 0a0a 2020  4;&#34;&#34;..  
+000190d0: 2020 7269 6b69 636f 6e74 6578 7420 3d20    rikicontext = 
+000190e0: 7365 6c66 2e63 6f6e 7465 7874 730a 2020  self.contexts.  
+000190f0: 2020 706f 7320 3d20 7365 6c66 2e69 6e74    pos = self.int
+00019100: 6572 7072 6574 5f68 6973 746f 7279 5f70  erpret_history_p
+00019110: 6f73 0a20 2020 2074 656d 7070 6f73 203d  os.    temppos =
+00019120: 2070 6f73 0a20 2020 2066 6f72 2071 2069   pos.    for q i
+00019130: 6e20 7261 6e67 6528 706f 732c 206c 656e  n range(pos, len
+00019140: 2872 696b 6963 6f6e 7465 7874 2929 3a0a  (rikicontext)):.
+00019150: 2020 2020 2020 2020 7465 6d70 706f 7320          temppos 
+00019160: 3d20 710a 2020 2020 2020 2020 6966 2070  = q.        if p
+00019170: 642e 746f 5f64 6174 6574 696d 6528 7269  d.to_datetime(ri
+00019180: 6b69 636f 6e74 6578 745b 715d 2e74 696d  kicontext[q].tim
+00019190: 6573 7461 6d70 2920 2667 743b 3d20 280a  estamp) &gt;= (.
+000191a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000191b0: 7064 2e74 6f5f 6461 7465 7469 6d65 2863  pd.to_datetime(c
+000191c0: 6f6e 7465 7874 6375 7272 656e 742e 7469  ontextcurrent.ti
+000191d0: 6d65 7374 616d 7029 202d 2070 642e 5469  mestamp) - pd.Ti
+000191e0: 6d65 6465 6c74 6128 7365 6c66 2e68 6f72  medelta(self.hor
+000191f0: 697a 6f6e 2c20 7365 6c66 2e68 6f72 697a  izon, self.horiz
+00019200: 6f6e 5f74 696d 6529 293a 0a20 2020 2020  on_time)):.     
+00019210: 2020 2020 2020 2062 7265 616b 0a20 2020         break.   
+00019220: 2063 6175 7365 7377 696e 646f 7720 3d20   causeswindow = 
+00019230: 7269 6b69 636f 6e74 6578 745b 7465 6d70  rikicontext[temp
+00019240: 706f 733a 5d0a 2020 2020 7365 6c66 2e69  pos:].    self.i
+00019250: 6e74 6572 7072 6574 5f68 6973 746f 7279  nterpret_history
+00019260: 5f70 6f73 203d 2074 656d 7070 6f73 0a20  _pos = temppos. 
+00019270: 2020 2069 6e74 6572 7072 203d 2073 656c     interpr = sel
+00019280: 662e 696e 7465 7270 7265 7428 636f 6e74  f.interpret(cont
+00019290: 6578 7463 7572 7265 6e74 2c20 6361 7573  extcurrent, caus
+000192a0: 6573 7769 6e64 6f77 2c20 7461 7267 6574  eswindow, target
+000192b0: 5f73 6572 6965 735f 6e61 6d65 2c20 7365  _series_name, se
+000192c0: 6c66 2e74 7970 655f 6f66 5f73 6572 6965  lf.type_of_serie
+000192d0: 7329 0a20 2020 2073 656c 662e 636f 6e74  s).    self.cont
+000192e0: 6578 7473 5b2d 315d 2e43 525b 2623 3334  exts[-1].CR[&#34
+000192f0: 3b69 6e74 6572 7072 6574 6174 696f 6e26  ;interpretation&
+00019300: 2333 343b 5d20 3d20 696e 7465 7270 723c  #34;] = interpr<
+00019310: 2f63 6f64 653e 3c2f 7072 653e 0a3c 2f64  /code></pre>.</d
+00019320: 6574 6169 6c73 3e0a 3c2f 6464 3e0a 3c64  etails>.</dd>.<d
+00019330: 7420 6964 3d22 5064 6d43 6f6e 7465 7874  t id="PdmContext
+00019340: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+00019350: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+00019360: 746f 722e 6765 6e65 7261 7465 5f63 6f6e  tor.generate_con
+00019370: 7465 7874 223e 3c63 6f64 6520 636c 6173  text"><code clas
+00019380: 733d 226e 616d 6520 666c 6578 223e 0a3c  s="name flex">.<
+00019390: 7370 616e 3e64 6566 203c 7370 616e 2063  span>def <span c
+000193a0: 6c61 7373 3d22 6964 656e 7422 3e67 656e  lass="ident">gen
+000193b0: 6572 6174 655f 636f 6e74 6578 743c 2f73  erate_context</s
+000193c0: 7061 6e3e 3c2f 7370 616e 3e28 3c73 7061  pan></span>(<spa
+000193d0: 6e3e 7365 6c66 2c20 653a c2a0 3c61 2074  n>self, e:..<a t
+000193e0: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
+000193f0: 2e75 7469 6c73 2e73 7472 7563 7475 7265  .utils.structure
+00019400: 2e45 7665 6e74 706f 696e 7422 2068 7265  .Eventpoint" hre
+00019410: 663d 2275 7469 6c73 2f73 7472 7563 7475  f="utils/structu
+00019420: 7265 2e68 746d 6c23 5064 6d43 6f6e 7465  re.html#PdmConte
+00019430: 7874 2e75 7469 6c73 2e73 7472 7563 7475  xt.utils.structu
+00019440: 7265 2e45 7665 6e74 706f 696e 7422 3e45  re.Eventpoint">E
+00019450: 7665 6e74 706f 696e 743c 2f61 3e2c 2062  ventpoint</a>, b
+00019460: 7566 6665 7229 3c2f 7370 616e 3e0a 3c2f  uffer)</span>.</
+00019470: 636f 6465 3e3c 2f64 743e 0a3c 6464 3e0a  code></dt>.<dd>.
+00019480: 3c64 6976 2063 6c61 7373 3d22 6465 7363  <div class="desc
+00019490: 223e 3c70 3e47 656e 6572 6174 6520 636f  "><p>Generate co
+000194a0: 6e74 6578 7420 616e 6420 696e 7465 7270  ntext and interp
+000194b0: 7265 7461 7469 6f6e 2e3c 2f70 3e0a 3c70  retation.</p>.<p
+000194c0: 3e3c 7374 726f 6e67 3e50 6172 616d 6574  ><strong>Paramet
+000194d0: 6572 733c 2f73 7472 6f6e 673e 3a3c 2f70  ers</strong>:</p
+000194e0: 3e0a 3c70 3e3c 7374 726f 6e67 3e65 3c2f  >.<p><strong>e</
+000194f0: 7374 726f 6e67 3e3a 2045 7665 6e74 706f  strong>: Eventpo
+00019500: 696e 7420 7265 6c61 7465 6420 746f 2074  int related to t
+00019510: 6865 206c 6173 7420 7461 7267 6574 2773  he last target's
+00019520: 2064 6174 612e 3c2f 703e 0a3c 703e 3c73   data.</p>.<p><s
+00019530: 7472 6f6e 673e 6275 6666 6572 3c2f 7374  trong>buffer</st
+00019540: 726f 6e67 3e3a 2041 206c 6973 7420 7769  rong>: A list wi
+00019550: 7468 2061 6c6c 2045 7665 6e74 706f 696e  th all Eventpoin
+00019560: 7473 2069 6e20 7468 6520 7469 6d65 2068  ts in the time h
+00019570: 6f72 697a 6f6e 3c2f 703e 3c2f 6469 763e  orizon</p></div>
+00019580: 0a3c 6465 7461 696c 7320 636c 6173 733d  .<details class=
+00019590: 2273 6f75 7263 6522 3e0a 3c73 756d 6d61  "source">.<summa
+000195a0: 7279 3e0a 3c73 7061 6e3e 4578 7061 6e64  ry>.<span>Expand
+000195b0: 2073 6f75 7263 6520 636f 6465 3c2f 7370   source code</sp
+000195c0: 616e 3e0a 3c2f 7375 6d6d 6172 793e 0a3c  an>.</summary>.<
+000195d0: 7072 653e 3c63 6f64 6520 636c 6173 733d  pre><code class=
+000195e0: 2270 7974 686f 6e22 3e64 6566 2067 656e  "python">def gen
+000195f0: 6572 6174 655f 636f 6e74 6578 7428 7365  erate_context(se
+00019600: 6c66 2c20 653a 2045 7665 6e74 706f 696e  lf, e: Eventpoin
+00019610: 742c 2062 7566 6665 7229 3a0a 2020 2020  t, buffer):.    
+00019620: 2623 3334 3b26 2333 343b 2623 3334 3b0a  &#34;&#34;&#34;.
+00019630: 2020 2020 4765 6e65 7261 7465 2063 6f6e      Generate con
+00019640: 7465 7874 2061 6e64 2069 6e74 6572 7072  text and interpr
+00019650: 6574 6174 696f 6e2e 0a0a 2020 2020 2a2a  etation...    **
+00019660: 5061 7261 6d65 7465 7273 2a2a 3a0a 0a20  Parameters**:.. 
+00019670: 2020 202a 2a65 2a2a 3a20 4576 656e 7470     **e**: Eventp
+00019680: 6f69 6e74 2072 656c 6174 6564 2074 6f20  oint related to 
+00019690: 7468 6520 6c61 7374 2074 6172 6765 7426  the last target&
+000196a0: 2333 393b 7320 6461 7461 2e0a 0a20 2020  #39;s data...   
+000196b0: 202a 2a62 7566 6665 722a 2a3a 2041 206c   **buffer**: A l
+000196c0: 6973 7420 7769 7468 2061 6c6c 2045 7665  ist with all Eve
+000196d0: 6e74 706f 696e 7473 2069 6e20 7468 6520  ntpoints in the 
+000196e0: 7469 6d65 2068 6f72 697a 6f6e 0a20 2020  time horizon.   
+000196f0: 2026 2333 343b 2623 3334 3b26 2333 343b   &#34;&#34;&#34;
+00019700: 0a0a 2020 2020 636f 6e74 6578 7463 7572  ..    contextcur
+00019710: 7265 6e74 2c20 7461 7267 6574 5f73 6572  rent, target_ser
+00019720: 6965 735f 6e61 6d65 203d 2073 656c 662e  ies_name = self.
+00019730: 6372 6561 7465 5f63 6f6e 7465 7874 2865  create_context(e
+00019740: 2c20 6275 6666 6572 290a 0a20 2020 2073  , buffer)..    s
+00019750: 656c 662e 636f 6e74 6578 7473 2e61 7070  elf.contexts.app
+00019760: 656e 6428 636f 6e74 6578 7463 7572 7265  end(contextcurre
+00019770: 6e74 290a 2020 2020 7365 6c66 2e63 7265  nt).    self.cre
+00019780: 6174 655f 696e 7465 7270 7265 7461 7469  ate_interpretati
+00019790: 6f6e 2863 6f6e 7465 7874 6375 7272 656e  on(contextcurren
+000197a0: 742c 2074 6172 6765 745f 7365 7269 6573  t, target_series
+000197b0: 5f6e 616d 6529 0a0a 2020 2020 696e 7465  _name)..    inte
+000197c0: 7274 7570 7320 3d20 5b74 7474 7570 2066  rtups = [tttup f
+000197d0: 6f72 2074 7474 7570 2069 6e0a 2020 2020  or tttup in.    
+000197e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000197f0: 662e 636f 6e74 6578 7473 5b2d 315d 2e43  f.contexts[-1].C
+00019800: 525b 2623 3334 3b69 6e74 6572 7072 6574  R[&#34;interpret
+00019810: 6174 696f 6e26 2333 343b 5d5d 0a20 2020  ation&#34;]].   
+00019820: 2023 2074 6869 7320 6973 2075 7365 6675   # this is usefu
+00019830: 6c6c 2066 6f72 2070 6c6f 7469 6e67 0a20  ll for ploting. 
+00019840: 2020 2073 656c 662e 636f 6e74 6578 7473     self.contexts
+00019850: 5b2d 315d 2e43 525b 2623 3334 3b69 6e74  [-1].CR[&#34;int
+00019860: 6572 7072 6574 6174 696f 6e26 2333 343b  erpretation&#34;
+00019870: 5d20 3d20 696e 7465 7274 7570 730a 0a20  ] = intertups.. 
+00019880: 2020 2072 6574 7572 6e20 7365 6c66 2e63     return self.c
+00019890: 6f6e 7465 7874 735b 2d31 5d3c 2f63 6f64  ontexts[-1]</cod
+000198a0: 653e 3c2f 7072 653e 0a3c 2f64 6574 6169  e></pre>.</detai
+000198b0: 6c73 3e0a 3c2f 6464 3e0a 3c64 7420 6964  ls>.</dd>.<dt id
+000198c0: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+000198d0: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+000198e0: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
+000198f0: 6765 745f 6368 6172 6163 7465 7269 7a61  get_characteriza
+00019900: 7469 6f6e 223e 3c63 6f64 6520 636c 6173  tion"><code clas
+00019910: 733d 226e 616d 6520 666c 6578 223e 0a3c  s="name flex">.<
+00019920: 7370 616e 3e64 6566 203c 7370 616e 2063  span>def <span c
+00019930: 6c61 7373 3d22 6964 656e 7422 3e67 6574  lass="ident">get
+00019940: 5f63 6861 7261 6374 6572 697a 6174 696f  _characterizatio
+00019950: 6e3c 2f73 7061 6e3e 3c2f 7370 616e 3e28  n</span></span>(
+00019960: 3c73 7061 6e3e 7365 6c66 2c20 636f 6e74  <span>self, cont
+00019970: 6578 7429 3c2f 7370 616e 3e0a 3c2f 636f  ext)</span>.</co
+00019980: 6465 3e3c 2f64 743e 0a3c 6464 3e0a 3c64  de></dt>.<dd>.<d
+00019990: 6976 2063 6c61 7373 3d22 6465 7363 223e  iv class="desc">
+000199a0: 3c70 3e54 6869 7320 6d65 7468 6f64 2063  <p>This method c
+000199b0: 616c 6375 6c61 7465 2074 6865 2063 6861  alculate the cha
+000199c0: 7261 6374 6572 697a 6174 696f 6e73 206f  racterizations o
+000199d0: 6620 2861 2c62 2920 6564 6765 7320 746f  f (a,b) edges to
+000199e0: 2063 6861 7261 6374 6572 697a 6520 7468   characterize th
+000199f0: 6520 696e 666c 7565 6e63 6520 6f66 2061  e influence of a
+00019a00: 2069 6e20 6220 6279 206f 6e65 206f 6620   in b by one of 
+00019a10: 7468 650a 7468 7265 6520 6368 6172 6163  the.three charac
+00019a20: 7465 7269 7a61 7469 6f6e 733a 2075 6e6b  terizations: unk
+00019a30: 6e6f 776e 2c20 6465 6372 6561 7365 2c20  nown, decrease, 
+00019a40: 696e 6372 6561 7365 2e3c 2f70 3e0a 3c70  increase.</p>.<p
+00019a50: 3e54 6865 2063 6861 7261 6374 6572 697a  >The characteriz
+00019a60: 6174 696f 6e20 6973 2063 616c 6375 6c61  ation is calcula
+00019a70: 7465 6420 6469 6666 6572 656e 746c 7920  ted differently 
+00019a80: 666f 7220 6576 656e 7420 616e 6420 636f  for event and co
+00019a90: 6e74 696e 756f 7573 2064 6174 612e 0a3c  ntinuous data..<
+00019aa0: 7374 726f 6e67 3e50 6172 616d 6574 6572  strong>Parameter
+00019ab0: 733c 2f73 7472 6f6e 673e 3a3c 2f70 3e0a  s</strong>:</p>.
+00019ac0: 3c70 3e3c 7374 726f 6e67 3e63 6f6e 7465  <p><strong>conte
+00019ad0: 7874 3c2f 7374 726f 6e67 3e3a 2064 6963  xt</strong>: dic
+00019ae0: 7469 6f6e 6172 7920 7769 7468 2061 206b  tionary with a k
+00019af0: 7965 2027 6564 6765 7327 2066 6f72 2077  ye 'edges' for w
+00019b00: 6869 6368 2061 2070 6172 616c 6c65 6c20  hich a parallel 
+00019b10: 6c69 7374 206f 6620 6368 6172 6163 7465  list of characte
+00019b20: 7269 7a61 7469 6f6e 7320 7769 6c6c 2062  rizations will b
+00019b30: 6520 6372 6561 7465 642e 3c2f 703e 3c2f  e created.</p></
+00019b40: 6469 763e 0a3c 6465 7461 696c 7320 636c  div>.<details cl
+00019b50: 6173 733d 2273 6f75 7263 6522 3e0a 3c73  ass="source">.<s
+00019b60: 756d 6d61 7279 3e0a 3c73 7061 6e3e 4578  ummary>.<span>Ex
+00019b70: 7061 6e64 2073 6f75 7263 6520 636f 6465  pand source code
+00019b80: 3c2f 7370 616e 3e0a 3c2f 7375 6d6d 6172  </span>.</summar
+00019b90: 793e 0a3c 7072 653e 3c63 6f64 6520 636c  y>.<pre><code cl
+00019ba0: 6173 733d 2270 7974 686f 6e22 3e64 6566  ass="python">def
+00019bb0: 2067 6574 5f63 6861 7261 6374 6572 697a   get_characteriz
+00019bc0: 6174 696f 6e28 7365 6c66 2c20 636f 6e74  ation(self, cont
+00019bd0: 6578 7429 3a0a 2020 2020 2623 3334 3b26  ext):.    &#34;&
+00019be0: 2333 343b 2623 3334 3b0a 2020 2020 5468  #34;&#34;.    Th
+00019bf0: 6973 206d 6574 686f 6420 6361 6c63 756c  is method calcul
+00019c00: 6174 6520 7468 6520 6368 6172 6163 7465  ate the characte
+00019c10: 7269 7a61 7469 6f6e 7320 6f66 2028 612c  rizations of (a,
+00019c20: 6229 2065 6467 6573 2074 6f20 6368 6172  b) edges to char
+00019c30: 6163 7465 7269 7a65 2074 6865 2069 6e66  acterize the inf
+00019c40: 6c75 656e 6365 206f 6620 6120 696e 2062  luence of a in b
+00019c50: 2062 7920 6f6e 6520 6f66 2074 6865 0a20   by one of the. 
+00019c60: 2020 2074 6872 6565 2063 6861 7261 6374     three charact
+00019c70: 6572 697a 6174 696f 6e73 3a20 756e 6b6e  erizations: unkn
+00019c80: 6f77 6e2c 2064 6563 7265 6173 652c 2069  own, decrease, i
+00019c90: 6e63 7265 6173 652e 0a0a 2020 2020 5468  ncrease...    Th
+00019ca0: 6520 6368 6172 6163 7465 7269 7a61 7469  e characterizati
+00019cb0: 6f6e 2069 7320 6361 6c63 756c 6174 6564  on is calculated
+00019cc0: 2064 6966 6665 7265 6e74 6c79 2066 6f72   differently for
+00019cd0: 2065 7665 6e74 2061 6e64 2063 6f6e 7469   event and conti
+00019ce0: 6e75 6f75 7320 6461 7461 2e0a 2020 2020  nuous data..    
+00019cf0: 2a2a 5061 7261 6d65 7465 7273 2a2a 3a0a  **Parameters**:.
+00019d00: 0a20 2020 202a 2a63 6f6e 7465 7874 2a2a  .    **context**
+00019d10: 3a20 6469 6374 696f 6e61 7279 2077 6974  : dictionary wit
+00019d20: 6820 6120 6b79 6520 2623 3339 3b65 6467  h a kye &#39;edg
+00019d30: 6573 2623 3339 3b20 666f 7220 7768 6963  es&#39; for whic
+00019d40: 6820 6120 7061 7261 6c6c 656c 206c 6973  h a parallel lis
+00019d50: 7420 6f66 2063 6861 7261 6374 6572 697a  t of characteriz
+00019d60: 6174 696f 6e73 2077 696c 6c20 6265 2063  ations will be c
+00019d70: 7265 6174 6564 2e0a 2020 2020 2623 3334  reated..    &#34
+00019d80: 3b26 2333 343b 2623 3334 3b0a 2020 2020  ;&#34;&#34;.    
+00019d90: 6564 6765 7320 3d20 636f 6e74 6578 745b  edges = context[
+00019da0: 2623 3334 3b65 6467 6573 2623 3334 3b5d  &#34;edges&#34;]
+00019db0: 0a20 2020 2063 6861 7261 6374 6572 697a  .    characteriz
+00019dc0: 6174 696f 6e73 203d 205b 5d0a 2020 2020  ations = [].    
+00019dd0: 666f 7220 6564 6765 2069 6e20 6564 6765  for edge in edge
+00019de0: 733a 0a20 2020 2020 2020 2069 6620 7365  s:.        if se
+00019df0: 6c66 2e74 6172 6765 7420 696e 2065 6467  lf.target in edg
+00019e00: 655b 305d 3a0a 2020 2020 2020 2020 2020  e[0]:.          
+00019e10: 2020 6368 6172 203d 2073 656c 662e 6368    char = self.ch
+00019e20: 6172 6163 7465 7269 7a65 5f65 7665 6e74  aracterize_event
+00019e30: 5f63 6f6e 7469 6e75 6f75 7328 636f 6e74  _continuous(cont
+00019e40: 6578 742c 2065 6467 6529 0a20 2020 2020  ext, edge).     
+00019e50: 2020 2065 6c69 6620 7365 6c66 2e74 7970     elif self.typ
+00019e60: 655f 6f66 5f73 6572 6965 735b 6564 6765  e_of_series[edge
+00019e70: 5b30 5d5d 203d 3d20 2623 3334 3b69 736f  [0]] == &#34;iso
+00019e80: 6c61 7469 6f6e 2623 3334 3b20 6f72 2073  lation&#34; or s
+00019e90: 656c 662e 7479 7065 5f6f 665f 7365 7269  elf.type_of_seri
+00019ea0: 6573 5b65 6467 655b 305d 5d20 3d3d 2026  es[edge[0]] == &
+00019eb0: 2333 343b 636f 6e66 6967 7572 6174 696f  #34;configuratio
+00019ec0: 6e26 2333 343b 3a0a 2020 2020 2020 2020  n&#34;:.        
+00019ed0: 2020 2020 6368 6172 203d 2073 656c 662e      char = self.
+00019ee0: 6368 6172 6163 7465 7269 7a65 5f65 7665  characterize_eve
+00019ef0: 6e74 5f65 6467 6528 636f 6e74 6578 742c  nt_edge(context,
+00019f00: 2065 6467 6529 0a20 2020 2020 2020 2065   edge).        e
+00019f10: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00019f20: 2063 6861 7220 3d20 7365 6c66 2e63 6861   char = self.cha
+00019f30: 7261 6374 6572 697a 655f 6576 656e 745f  racterize_event_
+00019f40: 636f 6e74 696e 756f 7573 2863 6f6e 7465  continuous(conte
+00019f50: 7874 2c20 6564 6765 290a 2020 2020 2020  xt, edge).      
+00019f60: 2020 6368 6172 6163 7465 7269 7a61 7469    characterizati
+00019f70: 6f6e 732e 6170 7065 6e64 2863 6861 7229  ons.append(char)
+00019f80: 0a20 2020 2072 6574 7572 6e20 6368 6172  .    return char
+00019f90: 6163 7465 7269 7a61 7469 6f6e 733c 2f63  acterizations</c
+00019fa0: 6f64 653e 3c2f 7072 653e 0a3c 2f64 6574  ode></pre>.</det
+00019fb0: 6169 6c73 3e0a 3c2f 6464 3e0a 3c64 7420  ails>.</dd>.<dt 
+00019fc0: 6964 3d22 5064 6d43 6f6e 7465 7874 2e43  id="PdmContext.C
+00019fd0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
+00019fe0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
+00019ff0: 722e 696e 7465 7270 7265 7422 3e3c 636f  r.interpret"><co
+0001a000: 6465 2063 6c61 7373 3d22 6e61 6d65 2066  de class="name f
+0001a010: 6c65 7822 3e0a 3c73 7061 6e3e 6465 6620  lex">.<span>def 
+0001a020: 3c73 7061 6e20 636c 6173 733d 2269 6465  <span class="ide
+0001a030: 6e74 223e 696e 7465 7270 7265 743c 2f73  nt">interpret</s
+0001a040: 7061 6e3e 3c2f 7370 616e 3e28 3c73 7061  pan></span>(<spa
+0001a050: 6e3e 7365 6c66 2c20 636f 6e74 6578 743a  n>self, context:
+0001a060: c2a0 3c61 2074 6974 6c65 3d22 5064 6d43  ..<a title="PdmC
+0001a070: 6f6e 7465 7874 2e75 7469 6c73 2e73 7472  ontext.utils.str
+0001a080: 7563 7475 7265 2e43 6f6e 7465 7874 2220  ucture.Context" 
+0001a090: 6872 6566 3d22 7574 696c 732f 7374 7275  href="utils/stru
+0001a0a0: 6374 7572 652e 6874 6d6c 2350 646d 436f  cture.html#PdmCo
+0001a0b0: 6e74 6578 742e 7574 696c 732e 7374 7275  ntext.utils.stru
+0001a0c0: 6374 7572 652e 436f 6e74 6578 7422 3e43  cture.Context">C
+0001a0d0: 6f6e 7465 7874 3c2f 613e 2c20 6361 7573  ontext</a>, caus
+0001a0e0: 6573 7769 6e64 6f77 2c20 7461 7267 6574  eswindow, target
+0001a0f0: 2c20 7479 7065 5f6f 665f 7365 7269 6573  , type_of_series
+0001a100: 293c 2f73 7061 6e3e 0a3c 2f63 6f64 653e  )</span>.</code>
+0001a110: 3c2f 6474 3e0a 3c64 643e 0a3c 6469 7620  </dt>.<dd>.<div 
+0001a120: 636c 6173 733d 2264 6573 6322 3e3c 703e  class="desc"><p>
+0001a130: 5468 6973 206d 6574 686f 6420 656e 6861  This method enha
+0001a140: 6e63 6520 7468 6520 4352 2070 6172 7420  nce the CR part 
+0001a150: 6f66 2074 6865 2043 6f6e 7465 7874 2077  of the Context w
+0001a160: 6974 6820 696e 7465 7270 7265 7461 7469  ith interpretati
+0001a170: 6f6e 2072 656c 6174 696e 6720 746f 2074  on relating to t
+0001a180: 6865 2074 6172 6765 7420 7661 7269 6162  he target variab
+0001a190: 6c65 2e0a 5468 6520 696e 7465 7270 7265  le..The interpre
+0001a1a0: 7461 7469 6f6e 2061 7265 2062 6173 6564  tation are based
+0001a1b0: 206f 6e20 7468 6520 6564 6765 7320 6578   on the edges ex
+0001a1c0: 7472 6163 7465 6420 6672 6f6d 2074 6865  tracted from the
+0001a1d0: 2043 6173 7561 6c74 7920 6469 7363 6f76   Casualty discov
+0001a1e0: 6572 792e 0a46 6f72 2065 6163 6820 6564  ery..For each ed
+0001a1f0: 6765 206f 6620 7479 7065 2028 7365 7269  ge of type (seri
+0001a200: 6573 4120 2d26 6774 3b20 7461 7267 6574  esA -&gt; target
+0001a210: 2920 696e 2074 6865 2065 6467 6573 2077  ) in the edges w
+0001a220: 6520 7465 7374 2069 6620 7468 6520 7365  e test if the se
+0001a230: 7269 6573 4120 696e 7465 7270 7265 7473  riesA interprets
+0001a240: 0a74 6865 2074 6172 6765 7420 7573 696e  .the target usin
+0001a250: 6720 7468 6520 666f 6c6c 6f77 696e 6720  g the following 
+0001a260: 7275 6c65 733a 3c2f 703e 0a3c 703e 3c73  rules:</p>.<p><s
+0001a270: 7472 6f6e 673e 6966 2073 6572 6965 7341  trong>if seriesA
+0001a280: 2069 7320 6973 6f6c 6174 6564 3c2f 7374   is isolated</st
+0001a290: 726f 6e67 3e3a 2057 6520 6368 6563 6b20  rong>: We check 
+0001a2a0: 6966 2069 7473 206c 6173 7420 6f63 6375  if its last occu
+0001a2b0: 7272 656e 6365 2069 7320 7468 6520 6375  rrence is the cu
+0001a2c0: 7272 656e 7420 7469 6d65 7374 616d 7020  rrent timestamp 
+0001a2d0: 6f72 2074 6865 2070 7265 7669 6f75 7320  or the previous 
+0001a2e0: 6f6e 652e 3c2f 703e 0a3c 703e 3c73 7472  one.</p>.<p><str
+0001a2f0: 6f6e 673e 6966 2073 6572 6965 7341 2069  ong>if seriesA i
+0001a300: 7320 636f 6e66 6967 7572 6174 696f 6e3c  s configuration<
+0001a310: 2f73 7472 6f6e 673e 3a20 5765 2063 6865  /strong>: We che
+0001a320: 636b 2069 6620 7468 6520 6564 6765 7320  ck if the edges 
+0001a330: 2873 6572 6965 7341 202d 2667 743b 2074  (seriesA -&gt; t
+0001a340: 6172 6765 7429 2061 7070 6561 7273 0a69  arget) appears.i
+0001a350: 6e20 6174 206c 6561 7374 2038 3025 2063  n at least 80% c
+0001a360: 6f6e 7465 7874 7320 696e 2074 6865 2068  ontexts in the h
+0001a370: 6f72 697a 6f6e 2028 692e 652e 2069 6e20  orizon (i.e. in 
+0001a380: 6361 7573 6573 7769 6e64 6f77 206c 6973  causeswindow lis
+0001a390: 7429 2e3c 2f70 3e0a 3c70 3e3c 7374 726f  t).</p>.<p><stro
+0001a3a0: 6e67 3e69 6620 7365 7269 6573 4120 6973  ng>if seriesA is
+0001a3b0: 2063 6f6e 7469 6e75 6f75 733c 2f73 7472   continuous</str
+0001a3c0: 6f6e 673e 3a20 5468 656e 2074 6861 7420  ong>: Then that 
+0001a3d0: 6d65 616e 7320 7468 6520 7461 7267 6574  means the target
+0001a3e0: 2069 7320 7265 6c61 7465 6420 7769 7468   is related with
+0001a3f0: 2073 6572 6965 7341 0a61 6e64 2077 6520   seriesA.and we 
+0001a400: 6164 6420 6974 2074 6f20 7468 6520 696e  add it to the in
+0001a410: 7465 7270 7265 7461 7469 6f6e 2e3c 2f70  terpretation.</p
+0001a420: 3e0a 3c70 3e41 6c6c 2074 6865 2069 6e74  >.<p>All the int
+0001a430: 6572 7072 6574 6174 696f 6e73 2061 7265  erpretations are
+0001a440: 2074 6167 6765 6420 7769 7468 2061 2074   tagged with a t
+0001a450: 696d 6573 7461 6d70 2077 6869 6368 2072  imestamp which r
+0001a460: 6566 6572 7320 746f 2074 6865 2066 6972  efers to the fir
+0001a470: 7374 2074 696d 650a 6f66 2061 7070 6561  st time.of appea
+0001a480: 7265 6e73 6520 6f66 2063 6f6e 7365 6375  rense of consecu
+0001a490: 7469 7665 2069 6e74 6572 7072 6574 6174  tive interpretat
+0001a4a0: 696f 6e73 2e20 5468 656e 2074 6865 2069  ions. Then the i
+0001a4b0: 6e74 6572 7072 6574 6174 696f 6e20 6172  nterpretation ar
+0001a4c0: 6520 736f 7274 6564 2075 7369 6e67 0a74  e sorted using.t
+0001a4d0: 6869 7320 7469 6d65 7374 616d 702e 2054  his timestamp. T
+0001a4e0: 6869 7320 6973 2064 6f6e 6520 746f 2070  his is done to p
+0001a4f0: 726f 7669 6465 2061 2068 6965 7261 7263  rovide a hierarc
+0001a500: 6879 2074 6f20 7468 6520 696e 7465 7270  hy to the interp
+0001a510: 7265 7461 7469 6f6e 2073 696e 6365 2069  retation since i
+0001a520: 7420 6d61 7920 6265 2074 6865 2063 6173  t may be the cas
+0001a530: 652c 0a74 6861 7420 7768 656e 2073 6572  e,.that when ser
+0001a540: 6965 7341 2063 6175 7365 2074 6172 6765  iesA cause targe
+0001a550: 7420 2c20 616e 6420 5365 7269 6573 4220  t , and SeriesB 
+0001a560: 6361 7573 6520 7461 7267 6574 2c20 7468  cause target, th
+0001a570: 6520 6f6c 6465 7374 206f 6e65 2069 7320  e oldest one is 
+0001a580: 7374 726f 6e67 6572 2073 696e 6365 2074  stronger since t
+0001a590: 6865 2053 6572 6965 7342 206d 6179 2062  he SeriesB may b
+0001a5a0: 650a 6566 6665 6374 206f 6620 7365 7269  e.effect of seri
+0001a5b0: 6573 412e 3c2f 703e 0a3c 703e 3c73 7472  esA.</p>.<p><str
+0001a5c0: 6f6e 673e 5061 7261 6d65 7465 7273 3c2f  ong>Parameters</
+0001a5d0: 7374 726f 6e67 3e3a 3c2f 703e 0a3c 703e  strong>:</p>.<p>
+0001a5e0: 3c73 7472 6f6e 673e 636f 6e74 6578 743c  <strong>context<
+0001a5f0: 2f73 7472 6f6e 673e 3a20 436f 6e74 6578  /strong>: Contex
+0001a600: 7420 4f62 6a65 6374 2074 6f20 6265 2069  t Object to be i
+0001a610: 6e74 6572 7072 6574 6564 3c2f 703e 0a3c  nterpreted</p>.<
+0001a620: 703e 3c73 7472 6f6e 673e 6361 7573 6573  p><strong>causes
+0001a630: 7769 6e64 6f77 3c2f 7374 726f 6e67 3e3a  window</strong>:
+0001a640: 206c 6973 7420 7769 7468 2074 6865 206c   list with the l
+0001a650: 6173 7420 686f 7269 7a6f 6e20 636f 6e74  ast horizon cont
+0001a660: 6578 7473 3c2f 703e 0a3c 703e 3c73 7472  exts</p>.<p><str
+0001a670: 6f6e 673e 7461 7267 6574 3c2f 7374 726f  ong>target</stro
+0001a680: 6e67 3e3a 2074 6865 206e 616d 6520 6f66  ng>: the name of
+0001a690: 2074 6865 2074 6172 6765 7420 7661 7269   the target vari
+0001a6a0: 6162 6c65 2074 6f20 696e 7465 7270 7265  able to interpre
+0001a6b0: 743c 2f70 3e0a 3c70 3e3c 7374 726f 6e67  t</p>.<p><strong
+0001a6c0: 3e74 7970 655f 6f66 5f73 6572 6965 733c  >type_of_series<
+0001a6d0: 2f73 7472 6f6e 673e 3a20 6469 6374 696f  /strong>: dictio
+0001a6e0: 6e61 7279 2077 6869 6368 2064 6566 696e  nary which defin
+0001a6f0: 6520 7468 6520 7479 7065 206f 6620 6561  e the type of ea
+0001a700: 6368 2073 6572 6965 7320 2869 736f 6c61  ch series (isola
+0001a710: 7465 642c 636f 6e66 6967 7572 6174 696f  ted,configuratio
+0001a720: 6e20 6f72 2063 6f6e 7469 6e75 6f75 7329  n or continuous)
+0001a730: 3c2f 703e 3c2f 6469 763e 0a3c 6465 7461  </p></div>.<deta
+0001a740: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
+0001a750: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
+0001a760: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
+0001a770: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
+0001a780: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
+0001a790: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
+0001a7a0: 6e22 3e64 6566 2069 6e74 6572 7072 6574  n">def interpret
+0001a7b0: 2873 656c 662c 2063 6f6e 7465 7874 3a20  (self, context: 
+0001a7c0: 436f 6e74 6578 742c 2063 6175 7365 7377  Context, causesw
+0001a7d0: 696e 646f 772c 2074 6172 6765 742c 2074  indow, target, t
+0001a7e0: 7970 655f 6f66 5f73 6572 6965 7329 3a0a  ype_of_series):.
+0001a7f0: 2020 2020 2623 3334 3b26 2333 343b 2623      &#34;&#34;&#
+0001a800: 3334 3b0a 2020 2020 5468 6973 206d 6574  34;.    This met
+0001a810: 686f 6420 656e 6861 6e63 6520 7468 6520  hod enhance the 
+0001a820: 4352 2070 6172 7420 6f66 2074 6865 2043  CR part of the C
+0001a830: 6f6e 7465 7874 2077 6974 6820 696e 7465  ontext with inte
+0001a840: 7270 7265 7461 7469 6f6e 2072 656c 6174  rpretation relat
+0001a850: 696e 6720 746f 2074 6865 2074 6172 6765  ing to the targe
+0001a860: 7420 7661 7269 6162 6c65 2e0a 2020 2020  t variable..    
+0001a870: 5468 6520 696e 7465 7270 7265 7461 7469  The interpretati
+0001a880: 6f6e 2061 7265 2062 6173 6564 206f 6e20  on are based on 
+0001a890: 7468 6520 6564 6765 7320 6578 7472 6163  the edges extrac
+0001a8a0: 7465 6420 6672 6f6d 2074 6865 2043 6173  ted from the Cas
+0001a8b0: 7561 6c74 7920 6469 7363 6f76 6572 792e  ualty discovery.
+0001a8c0: 0a20 2020 2046 6f72 2065 6163 6820 6564  .    For each ed
+0001a8d0: 6765 206f 6620 7479 7065 2028 7365 7269  ge of type (seri
+0001a8e0: 6573 4120 2d26 6774 3b20 7461 7267 6574  esA -&gt; target
+0001a8f0: 2920 696e 2074 6865 2065 6467 6573 2077  ) in the edges w
+0001a900: 6520 7465 7374 2069 6620 7468 6520 7365  e test if the se
+0001a910: 7269 6573 4120 696e 7465 7270 7265 7473  riesA interprets
+0001a920: 0a20 2020 2074 6865 2074 6172 6765 7420  .    the target 
+0001a930: 7573 696e 6720 7468 6520 666f 6c6c 6f77  using the follow
+0001a940: 696e 6720 7275 6c65 733a 0a0a 2020 2020  ing rules:..    
+0001a950: 2a2a 6966 2073 6572 6965 7341 2069 7320  **if seriesA is 
+0001a960: 6973 6f6c 6174 6564 2a2a 3a20 5765 2063  isolated**: We c
+0001a970: 6865 636b 2069 6620 6974 7320 6c61 7374  heck if its last
+0001a980: 206f 6363 7572 7265 6e63 6520 6973 2074   occurrence is t
+0001a990: 6865 2063 7572 7265 6e74 2074 696d 6573  he current times
+0001a9a0: 7461 6d70 206f 7220 7468 6520 7072 6576  tamp or the prev
+0001a9b0: 696f 7573 206f 6e65 2e0a 0a20 2020 202a  ious one...    *
+0001a9c0: 2a69 6620 7365 7269 6573 4120 6973 2063  *if seriesA is c
+0001a9d0: 6f6e 6669 6775 7261 7469 6f6e 2a2a 3a20  onfiguration**: 
+0001a9e0: 5765 2063 6865 636b 2069 6620 7468 6520  We check if the 
+0001a9f0: 6564 6765 7320 2873 6572 6965 7341 202d  edges (seriesA -
+0001aa00: 2667 743b 2074 6172 6765 7429 2061 7070  &gt; target) app
+0001aa10: 6561 7273 0a20 2020 2069 6e20 6174 206c  ears.    in at l
+0001aa20: 6561 7374 2038 3025 2063 6f6e 7465 7874  east 80% context
+0001aa30: 7320 696e 2074 6865 2068 6f72 697a 6f6e  s in the horizon
+0001aa40: 2028 692e 652e 2069 6e20 6361 7573 6573   (i.e. in causes
+0001aa50: 7769 6e64 6f77 206c 6973 7429 2e0a 0a20  window list)... 
+0001aa60: 2020 202a 2a69 6620 7365 7269 6573 4120     **if seriesA 
+0001aa70: 6973 2063 6f6e 7469 6e75 6f75 732a 2a3a  is continuous**:
+0001aa80: 2054 6865 6e20 7468 6174 206d 6561 6e73   Then that means
+0001aa90: 2074 6865 2074 6172 6765 7420 6973 2072   the target is r
+0001aaa0: 656c 6174 6564 2077 6974 6820 7365 7269  elated with seri
+0001aab0: 6573 410a 2020 2020 616e 6420 7765 2061  esA.    and we a
+0001aac0: 6464 2069 7420 746f 2074 6865 2069 6e74  dd it to the int
+0001aad0: 6572 7072 6574 6174 696f 6e2e 0a0a 2020  erpretation...  
+0001aae0: 2020 416c 6c20 7468 6520 696e 7465 7270    All the interp
+0001aaf0: 7265 7461 7469 6f6e 7320 6172 6520 7461  retations are ta
+0001ab00: 6767 6564 2077 6974 6820 6120 7469 6d65  gged with a time
+0001ab10: 7374 616d 7020 7768 6963 6820 7265 6665  stamp which refe
+0001ab20: 7273 2074 6f20 7468 6520 6669 7273 7420  rs to the first 
+0001ab30: 7469 6d65 0a20 2020 206f 6620 6170 7065  time.    of appe
+0001ab40: 6172 656e 7365 206f 6620 636f 6e73 6563  arense of consec
+0001ab50: 7574 6976 6520 696e 7465 7270 7265 7461  utive interpreta
+0001ab60: 7469 6f6e 732e 2054 6865 6e20 7468 6520  tions. Then the 
+0001ab70: 696e 7465 7270 7265 7461 7469 6f6e 2061  interpretation a
+0001ab80: 7265 2073 6f72 7465 6420 7573 696e 670a  re sorted using.
+0001ab90: 2020 2020 7468 6973 2074 696d 6573 7461      this timesta
+0001aba0: 6d70 2e20 5468 6973 2069 7320 646f 6e65  mp. This is done
+0001abb0: 2074 6f20 7072 6f76 6964 6520 6120 6869   to provide a hi
+0001abc0: 6572 6172 6368 7920 746f 2074 6865 2069  erarchy to the i
+0001abd0: 6e74 6572 7072 6574 6174 696f 6e20 7369  nterpretation si
+0001abe0: 6e63 6520 6974 206d 6179 2062 6520 7468  nce it may be th
+0001abf0: 6520 6361 7365 2c0a 2020 2020 7468 6174  e case,.    that
+0001ac00: 2077 6865 6e20 7365 7269 6573 4120 6361   when seriesA ca
+0001ac10: 7573 6520 7461 7267 6574 202c 2061 6e64  use target , and
+0001ac20: 2053 6572 6965 7342 2063 6175 7365 2074   SeriesB cause t
+0001ac30: 6172 6765 742c 2074 6865 206f 6c64 6573  arget, the oldes
+0001ac40: 7420 6f6e 6520 6973 2073 7472 6f6e 6765  t one is stronge
+0001ac50: 7220 7369 6e63 6520 7468 6520 5365 7269  r since the Seri
+0001ac60: 6573 4220 6d61 7920 6265 0a20 2020 2065  esB may be.    e
+0001ac70: 6666 6563 7420 6f66 2073 6572 6965 7341  ffect of seriesA
+0001ac80: 2e0a 0a20 2020 202a 2a50 6172 616d 6574  ...    **Paramet
+0001ac90: 6572 732a 2a3a 0a0a 2020 2020 2a2a 636f  ers**:..    **co
+0001aca0: 6e74 6578 742a 2a3a 2043 6f6e 7465 7874  ntext**: Context
+0001acb0: 204f 626a 6563 7420 746f 2062 6520 696e   Object to be in
+0001acc0: 7465 7270 7265 7465 640a 0a20 2020 202a  terpreted..    *
+0001acd0: 2a63 6175 7365 7377 696e 646f 772a 2a3a  *causeswindow**:
+0001ace0: 206c 6973 7420 7769 7468 2074 6865 206c   list with the l
+0001acf0: 6173 7420 686f 7269 7a6f 6e20 636f 6e74  ast horizon cont
+0001ad00: 6578 7473 0a0a 2020 2020 2a2a 7461 7267  exts..    **targ
+0001ad10: 6574 2a2a 3a20 7468 6520 6e61 6d65 206f  et**: the name o
+0001ad20: 6620 7468 6520 7461 7267 6574 2076 6172  f the target var
+0001ad30: 6961 626c 6520 746f 2069 6e74 6572 7072  iable to interpr
+0001ad40: 6574 0a0a 2020 2020 2a2a 7479 7065 5f6f  et..    **type_o
+0001ad50: 665f 7365 7269 6573 2a2a 3a20 6469 6374  f_series**: dict
+0001ad60: 696f 6e61 7279 2077 6869 6368 2064 6566  ionary which def
+0001ad70: 696e 6520 7468 6520 7479 7065 206f 6620  ine the type of 
+0001ad80: 6561 6368 2073 6572 6965 7320 2869 736f  each series (iso
+0001ad90: 6c61 7465 642c 636f 6e66 6967 7572 6174  lated,configurat
+0001ada0: 696f 6e20 6f72 2063 6f6e 7469 6e75 6f75  ion or continuou
+0001adb0: 7329 0a20 2020 2026 2333 343b 2623 3334  s).    &#34;&#34
+0001adc0: 3b26 2333 343b 0a0a 2020 2020 7061 6972  ;&#34;..    pair
+0001add0: 7320 3d20 5b28 7061 6972 5b30 5d2c 2070  s = [(pair[0], p
+0001ade0: 6169 725b 315d 2c20 6361 7229 2066 6f72  air[1], car) for
+0001adf0: 2070 6169 722c 2063 6172 2069 6e20 7a69   pair, car in zi
+0001ae00: 7028 636f 6e74 6578 742e 4352 5b26 2333  p(context.CR[&#3
+0001ae10: 393b 6564 6765 7326 2333 393b 5d2c 2063  9;edges&#39;], c
+0001ae20: 6f6e 7465 7874 2e43 525b 2623 3339 3b63  ontext.CR[&#39;c
+0001ae30: 6861 7261 6374 6572 697a 6174 696f 6e26  haracterization&
+0001ae40: 2333 393b 5d29 2069 660a 2020 2020 2020  #39;]) if.      
+0001ae50: 2020 2020 2020 2074 6172 6765 7420 696e         target in
+0001ae60: 2070 6169 725b 315d 5d0a 0a20 2020 2023   pair[1]]..    #
+0001ae70: 2070 6169 7273 686f 7032 203d 205b 5d0a   pairshop2 = [].
+0001ae80: 2020 2020 2320 696e 7465 726d 6564 6961      # intermedia
+0001ae90: 7465 733d 5b70 6169 725b 305d 2066 6f72  tes=[pair[0] for
+0001aea0: 2070 6169 7220 696e 2070 6169 7273 5d0a   pair in pairs].
+0001aeb0: 2020 2020 2320 616c 6c6f 7468 6573 3d5b      # allothes=[
+0001aec0: 7061 6972 2066 6f72 2070 6169 7220 696e  pair for pair in
+0001aed0: 2063 6f6e 7465 7874 2e43 442e 6b65 7973   context.CD.keys
+0001aee0: 2829 2069 6620 7061 6972 206e 6f74 2069  () if pair not i
+0001aef0: 6e20 696e 7465 726d 6564 6961 7465 735d  n intermediates]
+0001af00: 0a20 2020 2023 0a20 2020 2023 2066 6f72  .    #.    # for
+0001af10: 2069 6e74 6572 5f70 6169 7220 696e 2069   inter_pair in i
+0001af20: 6e74 6572 6d65 6469 6174 6573 3a0a 2020  ntermediates:.  
+0001af30: 2020 2320 2020 2020 666f 7220 6e61 6d65    #     for name
+0001af40: 2069 6e20 616c 6c6f 7468 6573 3a0a 2020   in allothes:.  
+0001af50: 2020 2320 2020 2020 2020 2020 6966 2028    #         if (
+0001af60: 6e61 6d65 2c69 6e74 6572 5f70 6169 7229  name,inter_pair)
+0001af70: 2069 6e20 636f 6e74 6578 742e 4352 5b26   in context.CR[&
+0001af80: 2333 343b 6564 6765 7326 2333 343b 5d3a  #34;edges&#34;]:
+0001af90: 0a20 2020 2023 2020 2020 2020 2020 2020  .    #          
+0001afa0: 2020 2070 6169 7273 686f 7032 2e61 7070     pairshop2.app
+0001afb0: 656e 6428 286e 616d 652c 696e 7465 725f  end((name,inter_
+0001afc0: 7061 6972 2929 0a0a 2020 2020 696e 7465  pair))..    inte
+0001afd0: 7270 7265 7461 7469 6f6e 203d 205b 5d0a  rpretation = [].
+0001afe0: 2020 2020 7479 7065 636f 6e65 6374 696f      typeconectio
+0001aff0: 6e20 3d20 5b5d 0a20 2020 2069 6620 6c65  n = [].    if le
+0001b000: 6e28 7061 6972 7329 203d 3d20 303a 0a20  n(pairs) == 0:. 
+0001b010: 2020 2020 2020 2072 6574 7572 6e20 5b5d         return []
+0001b020: 0a20 2020 2066 6f72 2070 6169 7220 696e  .    for pair in
+0001b030: 2070 6169 7273 3a0a 2020 2020 2020 2020   pairs:.        
+0001b040: 6966 2074 7970 655f 6f66 5f73 6572 6965  if type_of_serie
+0001b050: 735b 7061 6972 5b30 5d5d 203d 3d20 2623  s[pair[0]] == &#
+0001b060: 3334 3b69 736f 6c61 7465 6426 2333 343b  34;isolated&#34;
+0001b070: 3a0a 2020 2020 2020 2020 2020 2020 7661  :.            va
+0001b080: 6c75 6573 3120 3d20 636f 6e74 6578 742e  lues1 = context.
+0001b090: 4344 5b70 6169 725b 305d 5d0a 2020 2020  CD[pair[0]].    
+0001b0a0: 2020 2020 2020 2020 6966 2076 616c 7565          if value
+0001b0b0: 7331 5b2d 315d 203d 3d20 313a 0a20 2020  s1[-1] == 1:.   
+0001b0c0: 2020 2020 2020 2020 2020 2020 2069 6e74               int
+0001b0d0: 6572 7072 6574 6174 696f 6e2e 6170 7065  erpretation.appe
+0001b0e0: 6e64 2828 7061 6972 5b30 5d2c 2070 6169  nd((pair[0], pai
+0001b0f0: 725b 315d 2c20 7061 6972 5b32 5d2c 2063  r[1], pair[2], c
+0001b100: 6f6e 7465 7874 2e74 696d 6573 7461 6d70  ontext.timestamp
+0001b110: 2929 0a20 2020 2020 2020 2020 2020 2065  )).            e
+0001b120: 6c69 6620 7661 6c75 6573 315b 2d32 5d20  lif values1[-2] 
+0001b130: 3d3d 2031 3a0a 2020 2020 2020 2020 2020  == 1:.          
+0001b140: 2020 2020 2020 7465 6d70 7469 6d65 7374        temptimest
+0001b150: 616d 7020 3d20 636f 6e74 6578 742e 7469  amp = context.ti
+0001b160: 6d65 7374 616d 700a 2020 2020 2020 2020  mestamp.        
+0001b170: 2020 2020 2020 2020 6c61 7374 636f 6e74          lastcont
+0001b180: 6578 7420 3d20 7365 6c66 2e63 6f6e 7465  ext = self.conte
+0001b190: 7874 735b 6d61 7828 6c65 6e28 7365 6c66  xts[max(len(self
+0001b1a0: 2e63 6f6e 7465 7874 7329 202d 2032 2c20  .contexts) - 2, 
+0001b1b0: 3029 5d0a 2020 2020 2020 2020 2020 2020  0)].            
+0001b1c0: 2020 2020 666f 7220 696e 7465 7270 6169      for interpai
+0001b1d0: 7220 696e 206c 6173 7463 6f6e 7465 7874  r in lastcontext
+0001b1e0: 2e43 525b 2623 3334 3b69 6e74 6572 7072  .CR[&#34;interpr
+0001b1f0: 6574 6174 696f 6e26 2333 343b 5d3a 0a20  etation&#34;]:. 
+0001b200: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b210: 2020 2069 6620 696e 7465 7270 6169 725b     if interpair[
+0001b220: 305d 203d 3d20 7061 6972 5b30 5d20 616e  0] == pair[0] an
+0001b230: 6420 696e 7465 7270 6169 725b 315d 203d  d interpair[1] =
+0001b240: 3d20 7061 6972 5b31 5d3a 0a20 2020 2020  = pair[1]:.     
+0001b250: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b260: 2020 2074 656d 7074 696d 6573 7461 6d70     temptimestamp
+0001b270: 203d 2069 6e74 6572 7061 6972 5b33 5d0a   = interpair[3].
+0001b280: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b290: 696e 7465 7270 7265 7461 7469 6f6e 2e61  interpretation.a
+0001b2a0: 7070 656e 6428 2870 6169 725b 305d 2c20  ppend((pair[0], 
+0001b2b0: 7061 6972 5b31 5d2c 2070 6169 725b 325d  pair[1], pair[2]
+0001b2c0: 2c20 7465 6d70 7469 6d65 7374 616d 7029  , temptimestamp)
+0001b2d0: 290a 2020 2020 2020 2020 656c 6966 2074  ).        elif t
+0001b2e0: 7970 655f 6f66 5f73 6572 6965 735b 7061  ype_of_series[pa
+0001b2f0: 6972 5b30 5d5d 203d 3d20 2623 3334 3b63  ir[0]] == &#34;c
+0001b300: 6f6e 6669 6775 7261 7469 6f6e 2623 3334  onfiguration&#34
+0001b310: 3b3a 0a20 2020 2020 2020 2020 2020 2076  ;:.            v
+0001b320: 616c 7565 7331 203d 2063 6f6e 7465 7874  alues1 = context
+0001b330: 2e43 445b 7061 6972 5b30 5d5d 0a20 2020  .CD[pair[0]].   
+0001b340: 2020 2020 2020 2020 206f 6363 7572 656e           occuren
+0001b350: 6365 203d 2030 0a20 2020 2020 2020 2020  ce = 0.         
+0001b360: 2020 2066 6f72 2071 2069 6e20 7261 6e67     for q in rang
+0001b370: 6528 6c65 6e28 7661 6c75 6573 3129 293a  e(len(values1)):
+0001b380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b390: 2069 6620 7661 6c75 6573 315b 715d 203d   if values1[q] =
+0001b3a0: 3d20 7661 6c75 6573 315b 2d31 5d20 616e  = values1[-1] an
+0001b3b0: 6420 7661 6c75 6573 315b 715d 2026 6774  d values1[q] &gt
+0001b3c0: 3b20 303a 0a20 2020 2020 2020 2020 2020  ; 0:.           
+0001b3d0: 2020 2020 2020 2020 206f 6363 7572 656e           occuren
+0001b3e0: 6365 203d 2071 0a20 2020 2020 2020 2020  ce = q.         
+0001b3f0: 2020 2020 2020 2020 2020 2062 7265 616b             break
+0001b400: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0001b410: 6f63 6375 7265 6e63 6520 3d3d 206c 656e  occurence == len
+0001b420: 2876 616c 7565 7331 2920 2d20 313a 0a20  (values1) - 1:. 
+0001b430: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0001b440: 6e74 6572 7072 6574 6174 696f 6e2e 6170  nterpretation.ap
+0001b450: 7065 6e64 2828 7061 6972 5b30 5d2c 2070  pend((pair[0], p
+0001b460: 6169 725b 315d 2c20 7061 6972 5b32 5d2c  air[1], pair[2],
+0001b470: 2063 6f6e 7465 7874 2e74 696d 6573 7461   context.timesta
+0001b480: 6d70 2929 0a20 2020 2020 2020 2020 2020  mp)).           
+0001b490: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001b4a0: 2020 2020 2020 206c 6561 6420 3d20 6c65         lead = le
+0001b4b0: 6e28 7661 6c75 6573 3129 202d 206f 6363  n(values1) - occ
+0001b4c0: 7572 656e 6365 0a20 2020 2020 2020 2020  urence.         
+0001b4d0: 2020 2020 2020 2063 6f75 6e74 6572 203d         counter =
+0001b4e0: 2030 0a20 2020 2020 2020 2020 2020 2020   0.             
+0001b4f0: 2020 206c 6561 6463 6f6e 7465 7874 203d     leadcontext =
+0001b500: 2063 6175 7365 7377 696e 646f 775b 2d6c   causeswindow[-l
+0001b510: 6561 643a 5d0a 2020 2020 2020 2020 2020  ead:].          
+0001b520: 2020 2020 2020 666f 7220 636f 6e74 6520        for conte 
+0001b530: 696e 206c 6561 6463 6f6e 7465 7874 3a0a  in leadcontext:.
+0001b540: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b550: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0001b560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b570: 2070 6f73 203d 206c 6973 7428 636f 6e74   pos = list(cont
+0001b580: 652e 4352 5b26 2333 343b 6564 6765 7326  e.CR[&#34;edges&
+0001b590: 2333 343b 5d29 2e69 6e64 6578 2828 7061  #34;]).index((pa
+0001b5a0: 6972 5b30 5d2c 2070 6169 725b 315d 2929  ir[0], pair[1]))
+0001b5b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b5c0: 2020 2020 2065 7863 6570 743a 0a20 2020       except:.   
+0001b5d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b5e0: 2020 2020 2070 6f73 203d 202d 310a 2020       pos = -1.  
+0001b5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b600: 2020 6966 2070 6f73 2021 3d20 2d31 3a0a    if pos != -1:.
+0001b610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b620: 2020 2020 2020 2020 6966 2063 6f6e 7465          if conte
+0001b630: 2e43 525b 2623 3334 3b63 6861 7261 6374  .CR[&#34;charact
+0001b640: 6572 697a 6174 696f 6e26 2333 343b 5d5b  erization&#34;][
+0001b650: 706f 735d 203d 3d20 7061 6972 5b32 5d3a  pos] == pair[2]:
+0001b660: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001b670: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
+0001b680: 6e74 6572 202b 3d20 310a 2020 2020 2020  nter += 1.      
+0001b690: 2020 2020 2020 2020 2020 6966 2063 6f75            if cou
+0001b6a0: 6e74 6572 2026 6774 3b3d 2030 2e38 202a  nter &gt;= 0.8 *
+0001b6b0: 206c 6561 643a 0a20 2020 2020 2020 2020   lead:.         
+0001b6c0: 2020 2020 2020 2020 2020 2074 656d 7074             tempt
+0001b6d0: 696d 6573 7461 6d70 203d 2063 6f6e 7465  imestamp = conte
+0001b6e0: 7874 2e74 696d 6573 7461 6d70 0a20 2020  xt.timestamp.   
+0001b6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b700: 206c 6173 7463 6f6e 7465 7874 203d 2073   lastcontext = s
+0001b710: 656c 662e 636f 6e74 6578 7473 5b6d 6178  elf.contexts[max
+0001b720: 286c 656e 2873 656c 662e 636f 6e74 6578  (len(self.contex
+0001b730: 7473 2920 2d20 322c 2030 295d 0a20 2020  ts) - 2, 0)].   
+0001b740: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b750: 2066 6f72 2069 6e74 6572 7061 6972 2069   for interpair i
+0001b760: 6e20 6c61 7374 636f 6e74 6578 742e 4352  n lastcontext.CR
+0001b770: 5b26 2333 343b 696e 7465 7270 7265 7461  [&#34;interpreta
+0001b780: 7469 6f6e 2623 3334 3b5d 3a0a 2020 2020  tion&#34;]:.    
+0001b790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7a0: 2020 2020 6966 2069 6e74 6572 7061 6972      if interpair
+0001b7b0: 5b30 5d20 3d3d 2070 6169 725b 305d 2061  [0] == pair[0] a
+0001b7c0: 6e64 2069 6e74 6572 7061 6972 5b31 5d20  nd interpair[1] 
+0001b7d0: 3d3d 2070 6169 725b 315d 3a0a 2020 2020  == pair[1]:.    
+0001b7e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b7f0: 2020 2020 2020 2020 7465 6d70 7469 6d65          temptime
+0001b800: 7374 616d 7020 3d20 696e 7465 7270 6169  stamp = interpai
+0001b810: 725b 335d 0a20 2020 2020 2020 2020 2020  r[3].           
+0001b820: 2020 2020 2020 2020 2069 6e74 6572 7072           interpr
+0001b830: 6574 6174 696f 6e2e 6170 7065 6e64 2828  etation.append((
+0001b840: 7061 6972 5b30 5d2c 2070 6169 725b 315d  pair[0], pair[1]
+0001b850: 2c20 7061 6972 5b32 5d2c 2074 656d 7074  , pair[2], tempt
+0001b860: 696d 6573 7461 6d70 2929 0a20 2020 2020  imestamp)).     
+0001b870: 2020 2023 2066 6f72 2072 6561 6c20 7661     # for real va
+0001b880: 6c75 6520 7365 7269 6573 0a20 2020 2020  lue series.     
+0001b890: 2020 2065 6c69 6620 6c65 6e28 7365 7428     elif len(set(
+0001b8a0: 636f 6e74 6578 742e 4344 5b70 6169 725b  context.CD[pair[
+0001b8b0: 305d 5d29 2920 2667 743b 2032 3a0a 2020  0]])) &gt; 2:.  
+0001b8c0: 2020 2020 2020 2020 2020 7465 6d70 7469            tempti
+0001b8d0: 6d65 7374 616d 7020 3d20 636f 6e74 6578  mestamp = contex
+0001b8e0: 742e 7469 6d65 7374 616d 700a 2020 2020  t.timestamp.    
+0001b8f0: 2020 2020 2020 2020 6c61 7374 636f 6e74          lastcont
+0001b900: 6578 7420 3d20 7365 6c66 2e63 6f6e 7465  ext = self.conte
+0001b910: 7874 735b 6d61 7828 6c65 6e28 7365 6c66  xts[max(len(self
+0001b920: 2e63 6f6e 7465 7874 7329 202d 2032 2c20  .contexts) - 2, 
+0001b930: 3029 5d0a 2020 2020 2020 2020 2020 2020  0)].            
+0001b940: 666f 7220 696e 7465 7270 6169 7220 696e  for interpair in
+0001b950: 206c 6173 7463 6f6e 7465 7874 2e43 525b   lastcontext.CR[
+0001b960: 2623 3334 3b69 6e74 6572 7072 6574 6174  &#34;interpretat
+0001b970: 696f 6e26 2333 343b 5d3a 0a20 2020 2020  ion&#34;]:.     
+0001b980: 2020 2020 2020 2020 2020 2069 6620 696e             if in
+0001b990: 7465 7270 6169 725b 305d 203d 3d20 7061  terpair[0] == pa
+0001b9a0: 6972 5b30 5d20 616e 6420 696e 7465 7270  ir[0] and interp
+0001b9b0: 6169 725b 315d 203d 3d20 7061 6972 5b31  air[1] == pair[1
+0001b9c0: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0001b9d0: 2020 2020 2020 2074 656d 7074 696d 6573         temptimes
+0001b9e0: 7461 6d70 203d 2069 6e74 6572 7061 6972  tamp = interpair
+0001b9f0: 5b33 5d0a 2020 2020 2020 2020 2020 2020  [3].            
+0001ba00: 696e 7465 7270 7265 7461 7469 6f6e 2e61  interpretation.a
+0001ba10: 7070 656e 6428 2870 6169 725b 305d 2c20  ppend((pair[0], 
+0001ba20: 7061 6972 5b31 5d2c 2070 6169 725b 325d  pair[1], pair[2]
+0001ba30: 2c20 7465 6d70 7469 6d65 7374 616d 7029  , temptimestamp)
+0001ba40: 290a 2020 2020 2020 2020 2020 2020 636f  ).            co
+0001ba50: 6e74 696e 7565 0a20 2020 2023 2073 6f72  ntinue.    # sor
+0001ba60: 7420 7769 7468 2074 696d 650a 2020 2020  t with time.    
+0001ba70: 6669 6e74 6572 7072 6574 203d 205b 5d0a  finterpret = [].
+0001ba80: 2020 2020 666f 7220 7061 6972 2069 6e20      for pair in 
+0001ba90: 696e 7465 7270 7265 7461 7469 6f6e 3a0a  interpretation:.
+0001baa0: 2020 2020 2020 2020 6669 6e74 6572 7072          finterpr
+0001bab0: 6574 2e61 7070 656e 6428 2870 6169 725b  et.append((pair[
+0001bac0: 305d 2c20 7061 6972 5b31 5d2c 2070 6169  0], pair[1], pai
+0001bad0: 725b 325d 2c20 7061 6972 5b33 5d29 290a  r[2], pair[3])).
+0001bae0: 2020 2020 6669 6e74 6572 7072 6574 2e73      finterpret.s
+0001baf0: 6f72 7428 6b65 793d 6c61 6d62 6461 2074  ort(key=lambda t
+0001bb00: 7570 3a20 7475 705b 335d 2920 2023 2073  up: tup[3])  # s
+0001bb10: 6f72 7473 2069 6e20 706c 6163 650a 2020  orts in place.  
+0001bb20: 2020 7265 7475 726e 2066 696e 7465 7270    return finterp
+0001bb30: 7265 743c 2f63 6f64 653e 3c2f 7072 653e  ret</code></pre>
+0001bb40: 0a3c 2f64 6574 6169 6c73 3e0a 3c2f 6464  .</details>.</dd
+0001bb50: 3e0a 3c64 7420 6964 3d22 5064 6d43 6f6e  >.<dt id="PdmCon
+0001bb60: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
+0001bb70: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
+0001bb80: 6e65 7261 746f 722e 706c 6f74 223e 3c63  nerator.plot"><c
+0001bb90: 6f64 6520 636c 6173 733d 226e 616d 6520  ode class="name 
+0001bba0: 666c 6578 223e 0a3c 7370 616e 3e64 6566  flex">.<span>def
+0001bbb0: 203c 7370 616e 2063 6c61 7373 3d22 6964   <span class="id
+0001bbc0: 656e 7422 3e70 6c6f 743c 2f73 7061 6e3e  ent">plot</span>
+0001bbd0: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
+0001bbe0: 6c66 2c20 6669 6c74 6572 6564 6765 733d  lf, filteredges=
+0001bbf0: 4e6f 6e65 293c 2f73 7061 6e3e 0a3c 2f63  None)</span>.</c
+0001bc00: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
+0001bc10: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
+0001bc20: 3e3c 2f64 6976 3e0a 3c64 6574 6169 6c73  ></div>.<details
+0001bc30: 2063 6c61 7373 3d22 736f 7572 6365 223e   class="source">
+0001bc40: 0a3c 7375 6d6d 6172 793e 0a3c 7370 616e  .<summary>.<span
+0001bc50: 3e45 7870 616e 6420 736f 7572 6365 2063  >Expand source c
+0001bc60: 6f64 653c 2f73 7061 6e3e 0a3c 2f73 756d  ode</span>.</sum
+0001bc70: 6d61 7279 3e0a 3c70 7265 3e3c 636f 6465  mary>.<pre><code
+0001bc80: 2063 6c61 7373 3d22 7079 7468 6f6e 223e   class="python">
+0001bc90: 6465 6620 706c 6f74 2873 656c 662c 2066  def plot(self, f
+0001bca0: 696c 7465 7265 6467 6573 3d4e 6f6e 6529  ilteredges=None)
+0001bcb0: 3a0a 2020 2020 6966 2066 696c 7465 7265  :.    if filtere
+0001bcc0: 6467 6573 2069 7320 4e6f 6e65 3a0a 2020  dges is None:.  
+0001bcd0: 2020 2020 2020 6669 6c74 6572 6564 6765        filteredge
+0001bce0: 7320 3d20 5b5b 2623 3334 3b26 2333 343b  s = [[&#34;&#34;
+0001bcf0: 2c20 2623 3334 3b26 2333 343b 2c20 2623  , &#34;&#34;, &#
+0001bd00: 3334 3b26 2333 343b 5d5d 0a20 2020 2073  34;&#34;]].    s
+0001bd10: 686f 775f 636f 6e74 6578 745f 6c69 7374  how_context_list
+0001bd20: 2873 656c 662e 636f 6e74 6578 7473 2c20  (self.contexts, 
+0001bd30: 7365 6c66 2e74 6172 6765 742c 2066 696c  self.target, fil
+0001bd40: 7465 7265 6467 6573 3d66 696c 7465 7265  teredges=filtere
+0001bd50: 6467 6573 293c 2f63 6f64 653e 3c2f 7072  dges)</code></pr
+0001bd60: 653e 0a3c 2f64 6574 6169 6c73 3e0a 3c2f  e>.</details>.</
+0001bd70: 6464 3e0a 3c64 7420 6964 3d22 5064 6d43  dd>.<dt id="PdmC
+0001bd80: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
+0001bd90: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
+0001bda0: 4765 6e65 7261 746f 722e 706c 6f74 5f69  Generator.plot_i
+0001bdb0: 6e74 6572 7072 6574 6174 696f 6e22 3e3c  nterpretation"><
+0001bdc0: 636f 6465 2063 6c61 7373 3d22 6e61 6d65  code class="name
+0001bdd0: 2066 6c65 7822 3e0a 3c73 7061 6e3e 6465   flex">.<span>de
+0001bde0: 6620 3c73 7061 6e20 636c 6173 733d 2269  f <span class="i
+0001bdf0: 6465 6e74 223e 706c 6f74 5f69 6e74 6572  dent">plot_inter
+0001be00: 7072 6574 6174 696f 6e3c 2f73 7061 6e3e  pretation</span>
+0001be10: 3c2f 7370 616e 3e28 3c73 7061 6e3e 7365  </span>(<span>se
+0001be20: 6c66 2c20 6669 6c74 6572 6564 6765 733d  lf, filteredges=
+0001be30: 4e6f 6e65 293c 2f73 7061 6e3e 0a3c 2f63  None)</span>.</c
+0001be40: 6f64 653e 3c2f 6474 3e0a 3c64 643e 0a3c  ode></dt>.<dd>.<
+0001be50: 6469 7620 636c 6173 733d 2264 6573 6322  div class="desc"
+0001be60: 3e3c 2f64 6976 3e0a 3c64 6574 6169 6c73  ></div>.<details
+0001be70: 2063 6c61 7373 3d22 736f 7572 6365 223e   class="source">
+0001be80: 0a3c 7375 6d6d 6172 793e 0a3c 7370 616e  .<summary>.<span
+0001be90: 3e45 7870 616e 6420 736f 7572 6365 2063  >Expand source c
+0001bea0: 6f64 653c 2f73 7061 6e3e 0a3c 2f73 756d  ode</span>.</sum
+0001beb0: 6d61 7279 3e0a 3c70 7265 3e3c 636f 6465  mary>.<pre><code
+0001bec0: 2063 6c61 7373 3d22 7079 7468 6f6e 223e   class="python">
+0001bed0: 6465 6620 706c 6f74 5f69 6e74 6572 7072  def plot_interpr
+0001bee0: 6574 6174 696f 6e28 7365 6c66 2c20 6669  etation(self, fi
+0001bef0: 6c74 6572 6564 6765 733d 4e6f 6e65 293a  lteredges=None):
+0001bf00: 0a20 2020 2069 6620 6669 6c74 6572 6564  .    if filtered
+0001bf10: 6765 7320 6973 204e 6f6e 653a 0a20 2020  ges is None:.   
+0001bf20: 2020 2020 2066 696c 7465 7265 6467 6573       filteredges
+0001bf30: 203d 205b 5b26 2333 343b 2623 3334 3b2c   = [[&#34;&#34;,
+0001bf40: 2026 2333 343b 2623 3334 3b2c 2026 2333   &#34;&#34;, &#3
+0001bf50: 343b 2623 3334 3b5d 5d0a 2020 2020 7368  4;&#34;]].    sh
+0001bf60: 6f77 5f63 6f6e 7465 7874 5f69 6e74 6572  ow_context_inter
+0001bf70: 7072 6574 6174 696f 6e73 2873 656c 662e  pretations(self.
+0001bf80: 636f 6e74 6578 7473 2c20 7365 6c66 2e74  contexts, self.t
+0001bf90: 6172 6765 742c 2066 696c 7465 7265 6467  arget, filteredg
+0001bfa0: 6573 3d66 696c 7465 7265 6467 6573 293c  es=filteredges)<
+0001bfb0: 2f63 6f64 653e 3c2f 7072 653e 0a3c 2f64  /code></pre>.</d
+0001bfc0: 6574 6169 6c73 3e0a 3c2f 6464 3e0a 3c2f  etails>.</dd>.</
+0001bfd0: 646c 3e0a 3c2f 6464 3e0a 3c64 7420 6964  dl>.</dd>.<dt id
+0001bfe0: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+0001bff0: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+0001c000: 6f6e 7465 7874 4765 6e65 7261 746f 7242  ontextGeneratorB
+0001c010: 6174 6368 223e 3c63 6f64 6520 636c 6173  atch"><code clas
+0001c020: 733d 2266 6c65 7820 6e61 6d65 2063 6c61  s="flex name cla
+0001c030: 7373 223e 0a3c 7370 616e 3e63 6c61 7373  ss">.<span>class
+0001c040: 203c 7370 616e 2063 6c61 7373 3d22 6964   <span class="id
+0001c050: 656e 7422 3e43 6f6e 7465 7874 4765 6e65  ent">ContextGene
+0001c060: 7261 746f 7242 6174 6368 3c2f 7370 616e  ratorBatch</span
+0001c070: 3e3c 2f73 7061 6e3e 0a3c 7370 616e 3e28  ></span>.<span>(
+0001c080: 3c2f 7370 616e 3e3c 7370 616e 3e64 665f  </span><span>df_
+0001c090: 6461 7461 2c20 7461 7267 6574 2c20 7479  data, target, ty
+0001c0a0: 7065 5f6f 665f 7365 7269 6573 2c20 636f  pe_of_series, co
+0001c0b0: 6e74 6578 745f 686f 7269 7a6f 6e3d 2738  ntext_horizon='8
+0001c0c0: 2068 6f75 7273 272c 2043 6175 7361 6c69   hours', Causali
+0001c0d0: 7479 6675 6e63 743d 266c 743b 6675 6e63  tyfunct=&lt;func
+0001c0e0: 7469 6f6e 2063 616c 6375 6c61 7465 5f77  tion calculate_w
+0001c0f0: 6974 685f 7063 2667 743b 2c20 6465 6275  ith_pc&gt;, debu
+0001c100: 673d 4661 6c73 652c 2066 696c 655f 7061  g=False, file_pa
+0001c110: 7468 3d4e 6f6e 6529 3c2f 7370 616e 3e0a  th=None)</span>.
+0001c120: 3c2f 636f 6465 3e3c 2f64 743e 0a3c 6464  </code></dt>.<dd
+0001c130: 3e0a 3c64 6976 2063 6c61 7373 3d22 6465  >.<div class="de
+0001c140: 7363 223e 3c70 3e54 6869 7320 7665 7273  sc"><p>This vers
+0001c150: 696f 6e20 646f 6573 6e27 7420 7375 7070  ion doesn't supp
+0001c160: 6f72 7420 696e 7465 7270 7265 7461 7469  ort interpretati
+0001c170: 6f6e 2061 6e64 2069 7320 6372 6561 7465  on and is create
+0001c180: 6420 666f 7220 6661 7374 6572 2065 7870  d for faster exp
+0001c190: 6572 696d 656e 7473 2075 7369 6e67 2043  eriments using C
+0001c1a0: 6f6e 7465 7874 2e3c 2f70 3e0a 3c70 3e3c  ontext.</p>.<p><
+0001c1b0: 7374 726f 6e67 3e64 665f 6461 7461 3c2f  strong>df_data</
+0001c1c0: 7374 726f 6e67 3e20 5468 6520 6461 7461  strong> The data
+0001c1d0: 2074 6f20 636f 6e73 6964 6572 2069 6e20   to consider in 
+0001c1e0: 636f 6e74 6578 7420 696e 2066 6f72 6d20  context in form 
+0001c1f0: 6f66 2044 6174 6120 4672 616d 652e 3c2f  of Data Frame.</
+0001c200: 703e 0a3c 703e 2a2a 2074 6172 6765 742a  p>.<p>** target*
+0001c210: 2a20 5468 6520 6e61 6d65 206f 6620 7468  * The name of th
+0001c220: 6520 7461 7267 6574 2073 6f75 7263 652c  e target source,
+0001c230: 2077 6869 6368 2077 696c 6c20 6265 2075   which will be u
+0001c240: 7365 6420 6173 2074 6865 2062 6173 656c  sed as the basel
+0001c250: 696e 6520 696e 206f 7264 6572 2074 6f20  ine in order to 
+0001c260: 6d61 7020 6469 6666 6572 656e 7420 7361  map different sa
+0001c270: 6d70 6c65 733c 2f70 3e0a 3c70 3e3c 7374  mples</p>.<p><st
+0001c280: 726f 6e67 3e74 7970 655f 6f66 5f73 6572  rong>type_of_ser
+0001c290: 6965 733c 2f73 7472 6f6e 673e 3a20 6469  ies</strong>: di
+0001c2a0: 6374 696f 6e61 7279 2077 6869 6368 2064  ctionary which d
+0001c2b0: 6566 696e 6520 7468 6520 7479 7065 206f  efine the type o
+0001c2c0: 6620 6561 6368 2073 6572 6965 7320 2869  f each series (i
+0001c2d0: 736f 6c61 7465 642c 636f 6e66 6967 7572  solated,configur
+0001c2e0: 6174 696f 6e20 6f72 2063 6f6e 7469 6e75  ation or continu
+0001c2f0: 6f75 7329 0a72 6174 6520 746f 2074 6861  ous).rate to tha
+0001c300: 7420 6f66 2074 6865 2074 6172 6765 7420  t of the target 
+0001c310: 7361 6d70 6c65 2072 6174 652e 3c2f 703e  sample rate.</p>
+0001c320: 0a3c 703e 3c73 7472 6f6e 673e 636f 6e74  .<p><strong>cont
+0001c330: 6578 745f 686f 7269 7a6f 6e3c 2f73 7472  ext_horizon</str
+0001c340: 6f6e 673e 2054 6865 2074 696d 6520 7065  ong> The time pe
+0001c350: 7269 6f64 2074 6f20 6c6f 6f6b 2062 6163  riod to look bac
+0001c360: 6b20 666f 7220 636f 6e74 6578 7420 6461  k for context da
+0001c370: 7461 2c20 7468 6520 666f 726d 206f 6620  ta, the form of 
+0001c380: 7468 6174 2070 6172 616d 6574 6572 2069  that parameter i
+0001c390: 7320 2238 2068 6f75 7273 223c 2f70 3e0a  s "8 hours"</p>.
+0001c3a0: 3c70 3e3c 7374 726f 6e67 3e43 6175 7361  <p><strong>Causa
+0001c3b0: 6c69 7479 6675 6e63 743c 2f73 7472 6f6e  lityfunct</stron
+0001c3c0: 673e 2074 6865 2063 6175 7361 6c69 7479  g> the causality
+0001c3d0: 2064 6973 636f 7665 7279 206d 6574 686f   discovery metho
+0001c3e0: 6420 746f 2075 7365 2074 6f20 7072 6f64  d to use to prod
+0001c3f0: 7563 6520 6361 7573 616c 2072 656c 6174  uce causal relat
+0001c400: 696f 6e73 6869 7073 2062 6574 7765 656e  ionships between
+0001c410: 2063 6f6e 7465 7874 2064 6174 612c 0a54   context data,.T
+0001c420: 6869 7320 6d75 7374 2062 6520 6120 6675  his must be a fu
+0001c430: 6e63 7469 6f6e 2077 6974 6820 7061 7261  nction with para
+0001c440: 6d65 7465 7273 2074 776f 2065 7175 616c  meters two equal
+0001c450: 2073 697a 6520 6c69 7374 732c 206f 6e65   size lists, one
+0001c460: 2077 6974 6820 6e61 6d65 7320 616e 6420   with names and 
+0001c470: 7468 6520 6f74 6865 720a 7769 7468 2064  the other.with d
+0001c480: 6174 6120 2861 206c 6973 7420 6f66 206c  ata (a list of l
+0001c490: 6973 7420 6f72 2032 4420 6e75 6d70 7920  ist or 2D numpy 
+0001c4a0: 6172 7261 7929 2e3c 2f70 3e0a 3c70 3e3c  array).</p>.<p><
+0001c4b0: 7374 726f 6e67 3e64 6562 7567 3c2f 7374  strong>debug</st
+0001c4c0: 726f 6e67 3e20 4966 2069 7420 7275 6e73  rong> If it runs
+0001c4d0: 206f 6e20 6465 6275 6720 6d6f 6465 3c2f   on debug mode</
+0001c4e0: 703e 0a3c 703e 3c73 7472 6f6e 673e 6669  p>.<p><strong>fi
+0001c4f0: 6c65 5f70 6174 683c 2f73 7472 6f6e 673e  le_path</strong>
+0001c500: 2053 746f 7265 2074 6865 2072 6573 756c   Store the resul
+0001c510: 7473 206f 6620 636f 6e74 6578 7420 696e  ts of context in
+0001c520: 2070 6963 6b6c 6520 6669 6c65 2c20 636f   pickle file, co
+0001c530: 6e73 6964 6572 6564 206f 6e6c 7920 7768  nsidered only wh
+0001c540: 656e 2069 7420 6973 206e 6f74 204e 6f6e  en it is not Non
+0001c550: 652e 3c2f 703e 3c2f 6469 763e 0a3c 6465  e.</p></div>.<de
+0001c560: 7461 696c 7320 636c 6173 733d 2273 6f75  tails class="sou
+0001c570: 7263 6522 3e0a 3c73 756d 6d61 7279 3e0a  rce">.<summary>.
+0001c580: 3c73 7061 6e3e 4578 7061 6e64 2073 6f75  <span>Expand sou
+0001c590: 7263 6520 636f 6465 3c2f 7370 616e 3e0a  rce code</span>.
+0001c5a0: 3c2f 7375 6d6d 6172 793e 0a3c 7072 653e  </summary>.<pre>
+0001c5b0: 3c63 6f64 6520 636c 6173 733d 2270 7974  <code class="pyt
+0001c5c0: 686f 6e22 3e63 6c61 7373 2043 6f6e 7465  hon">class Conte
+0001c5d0: 7874 4765 6e65 7261 746f 7242 6174 6368  xtGeneratorBatch
+0001c5e0: 2829 3a0a 2020 2020 6465 6620 5f5f 696e  ():.    def __in
+0001c5f0: 6974 5f5f 2873 656c 662c 6466 5f64 6174  it__(self,df_dat
+0001c600: 612c 7461 7267 6574 2c74 7970 655f 6f66  a,target,type_of
+0001c610: 5f73 6572 6965 732c 636f 6e74 6578 745f  _series,context_
+0001c620: 686f 7269 7a6f 6e3d 2623 3334 3b38 2068  horizon=&#34;8 h
+0001c630: 6f75 7273 2623 3334 3b2c 4361 7573 616c  ours&#34;,Causal
+0001c640: 6974 7966 756e 6374 3d63 616c 6375 6c61  ityfunct=calcula
+0001c650: 7465 5f77 6974 685f 7063 2c64 6562 7567  te_with_pc,debug
+0001c660: 3d46 616c 7365 2c66 696c 655f 7061 7468  =False,file_path
+0001c670: 3d4e 6f6e 6529 3a0a 2020 2020 2020 2020  =None):.        
+0001c680: 2623 3334 3b26 2333 343b 2623 3334 3b0a  &#34;&#34;&#34;.
+0001c690: 2020 2020 2020 2020 5468 6973 2076 6572          This ver
+0001c6a0: 7369 6f6e 2064 6f65 736e 2623 3339 3b74  sion doesn&#39;t
+0001c6b0: 2073 7570 706f 7274 2069 6e74 6572 7072   support interpr
+0001c6c0: 6574 6174 696f 6e20 616e 6420 6973 2063  etation and is c
+0001c6d0: 7265 6174 6564 2066 6f72 2066 6173 7465  reated for faste
+0001c6e0: 7220 6578 7065 7269 6d65 6e74 7320 7573  r experiments us
+0001c6f0: 696e 6720 436f 6e74 6578 742e 0a0a 2020  ing Context...  
+0001c700: 2020 2020 2020 2a2a 6466 5f64 6174 612a        **df_data*
+0001c710: 2a20 5468 6520 6461 7461 2074 6f20 636f  * The data to co
+0001c720: 6e73 6964 6572 2069 6e20 636f 6e74 6578  nsider in contex
+0001c730: 7420 696e 2066 6f72 6d20 6f66 2044 6174  t in form of Dat
+0001c740: 6120 4672 616d 652e 0a0a 2020 2020 2020  a Frame...      
+0001c750: 2020 2a2a 2074 6172 6765 742a 2a20 5468    ** target** Th
+0001c760: 6520 6e61 6d65 206f 6620 7468 6520 7461  e name of the ta
+0001c770: 7267 6574 2073 6f75 7263 652c 2077 6869  rget source, whi
+0001c780: 6368 2077 696c 6c20 6265 2075 7365 6420  ch will be used 
+0001c790: 6173 2074 6865 2062 6173 656c 696e 6520  as the baseline 
+0001c7a0: 696e 206f 7264 6572 2074 6f20 6d61 7020  in order to map 
+0001c7b0: 6469 6666 6572 656e 7420 7361 6d70 6c65  different sample
+0001c7c0: 730a 0a20 2020 2020 2020 202a 2a74 7970  s..        **typ
+0001c7d0: 655f 6f66 5f73 6572 6965 732a 2a3a 2064  e_of_series**: d
+0001c7e0: 6963 7469 6f6e 6172 7920 7768 6963 6820  ictionary which 
+0001c7f0: 6465 6669 6e65 2074 6865 2074 7970 6520  define the type 
+0001c800: 6f66 2065 6163 6820 7365 7269 6573 2028  of each series (
+0001c810: 6973 6f6c 6174 6564 2c63 6f6e 6669 6775  isolated,configu
+0001c820: 7261 7469 6f6e 206f 7220 636f 6e74 696e  ration or contin
+0001c830: 756f 7573 290a 2020 2020 2020 2020 2072  uous).         r
+0001c840: 6174 6520 746f 2074 6861 7420 6f66 2074  ate to that of t
+0001c850: 6865 2074 6172 6765 7420 7361 6d70 6c65  he target sample
+0001c860: 2072 6174 652e 0a0a 2020 2020 2020 2020   rate...        
+0001c870: 2a2a 636f 6e74 6578 745f 686f 7269 7a6f  **context_horizo
+0001c880: 6e2a 2a20 5468 6520 7469 6d65 2070 6572  n** The time per
+0001c890: 696f 6420 746f 206c 6f6f 6b20 6261 636b  iod to look back
+0001c8a0: 2066 6f72 2063 6f6e 7465 7874 2064 6174   for context dat
+0001c8b0: 612c 2074 6865 2066 6f72 6d20 6f66 2074  a, the form of t
+0001c8c0: 6861 7420 7061 7261 6d65 7465 7220 6973  hat parameter is
+0001c8d0: 2026 2333 343b 3820 686f 7572 7326 2333   &#34;8 hours&#3
+0001c8e0: 343b 0a0a 2020 2020 2020 2020 2a2a 4361  4;..        **Ca
+0001c8f0: 7573 616c 6974 7966 756e 6374 2a2a 2074  usalityfunct** t
+0001c900: 6865 2063 6175 7361 6c69 7479 2064 6973  he causality dis
+0001c910: 636f 7665 7279 206d 6574 686f 6420 746f  covery method to
+0001c920: 2075 7365 2074 6f20 7072 6f64 7563 6520   use to produce 
+0001c930: 6361 7573 616c 2072 656c 6174 696f 6e73  causal relations
+0001c940: 6869 7073 2062 6574 7765 656e 2063 6f6e  hips between con
+0001c950: 7465 7874 2064 6174 612c 0a20 2020 2020  text data,.     
+0001c960: 2020 2020 2020 2054 6869 7320 6d75 7374         This must
+0001c970: 2062 6520 6120 6675 6e63 7469 6f6e 2077   be a function w
+0001c980: 6974 6820 7061 7261 6d65 7465 7273 2074  ith parameters t
+0001c990: 776f 2065 7175 616c 2073 697a 6520 6c69  wo equal size li
+0001c9a0: 7374 732c 206f 6e65 2077 6974 6820 6e61  sts, one with na
+0001c9b0: 6d65 7320 616e 6420 7468 6520 6f74 6865  mes and the othe
+0001c9c0: 720a 2020 2020 2020 2020 2020 2020 7769  r.            wi
+0001c9d0: 7468 2064 6174 6120 2861 206c 6973 7420  th data (a list 
+0001c9e0: 6f66 206c 6973 7420 6f72 2032 4420 6e75  of list or 2D nu
+0001c9f0: 6d70 7920 6172 7261 7929 2e0a 0a20 2020  mpy array)...   
+0001ca00: 2020 2020 202a 2a64 6562 7567 2a2a 2049       **debug** I
+0001ca10: 6620 6974 2072 756e 7320 6f6e 2064 6562  f it runs on deb
+0001ca20: 7567 206d 6f64 650a 0a20 2020 2020 2020  ug mode..       
+0001ca30: 202a 2a66 696c 655f 7061 7468 2a2a 2053   **file_path** S
+0001ca40: 746f 7265 2074 6865 2072 6573 756c 7473  tore the results
+0001ca50: 206f 6620 636f 6e74 6578 7420 696e 2070   of context in p
+0001ca60: 6963 6b6c 6520 6669 6c65 2c20 636f 6e73  ickle file, cons
+0001ca70: 6964 6572 6564 206f 6e6c 7920 7768 656e  idered only when
+0001ca80: 2069 7420 6973 206e 6f74 204e 6f6e 652e   it is not None.
+0001ca90: 0a20 2020 2020 2020 2026 2333 343b 2623  .        &#34;&#
+0001caa0: 3334 3b26 2333 343b 0a0a 2020 2020 2020  34;&#34;..      
+0001cab0: 2020 7365 6c66 2e66 696c 655f 7061 7468    self.file_path
+0001cac0: 3d66 696c 655f 7061 7468 0a20 2020 2020  =file_path.     
+0001cad0: 2020 2073 656c 662e 6465 6275 673d 6465     self.debug=de
+0001cae0: 6275 670a 2020 2020 2020 2020 7365 6c66  bug.        self
+0001caf0: 2e74 6172 6765 743d 7461 7267 6574 0a20  .target=target. 
+0001cb00: 2020 2020 2020 2073 656c 662e 6466 5f64         self.df_d
+0001cb10: 6174 613d 6466 5f64 6174 610a 0a0a 2020  ata=df_data...  
+0001cb20: 2020 2020 2020 7365 6c66 2e63 6f6e 7465        self.conte
+0001cb30: 7874 733d 7365 6c66 2e5f 6c6f 6164 5f63  xts=self._load_c
+0001cb40: 6f6e 7465 7874 7328 290a 0a20 2020 2020  ontexts()..     
+0001cb50: 2020 2073 656c 662e 6361 7573 616c 6974     self.causalit
+0001cb60: 795f 6469 7363 6f76 6572 793d 4361 7573  y_discovery=Caus
+0001cb70: 616c 6974 7966 756e 6374 0a20 2020 2020  alityfunct.     
+0001cb80: 2020 2073 656c 662e 6275 6666 6572 3d5b     self.buffer=[
+0001cb90: 5d0a 0a0a 2020 2020 2020 2020 2368 656c  ]...        #hel
+0001cba0: 7065 7273 0a20 2020 2020 2020 2073 656c  pers.        sel
+0001cbb0: 662e 7479 7065 5f6f 665f 7365 7269 6573  f.type_of_series
+0001cbc0: 203d 2074 7970 655f 6f66 5f73 6572 6965   = type_of_serie
+0001cbd0: 730a 2020 2020 2020 2020 7365 6c66 2e68  s.        self.h
+0001cbe0: 6f72 697a 6f6e 203d 2063 6f6e 7465 7874  orizon = context
+0001cbf0: 5f68 6f72 697a 6f6e 2e73 706c 6974 2826  _horizon.split(&
+0001cc00: 2333 343b 2026 2333 343b 295b 305d 0a20  #34; &#34;)[0]. 
+0001cc10: 2020 2020 2020 2069 6620 6c65 6e28 636f         if len(co
+0001cc20: 6e74 6578 745f 686f 7269 7a6f 6e2e 7370  ntext_horizon.sp
+0001cc30: 6c69 7428 2623 3334 3b20 2623 3334 3b29  lit(&#34; &#34;)
+0001cc40: 2920 3d3d 2031 3a0a 2020 2020 2020 2020  ) == 1:.        
+0001cc50: 2020 2020 7365 6c66 2e68 6f72 697a 6f6e      self.horizon
+0001cc60: 5f74 696d 6520 3d20 2623 3334 3b68 6f75  _time = &#34;hou
+0001cc70: 7273 2623 3334 3b0a 2020 2020 2020 2020  rs&#34;.        
+0001cc80: 656c 7365 3a0a 2020 2020 2020 2020 2020  else:.          
+0001cc90: 2020 6966 2063 6f6e 7465 7874 5f68 6f72    if context_hor
+0001cca0: 697a 6f6e 2e73 706c 6974 2826 2333 343b  izon.split(&#34;
+0001ccb0: 2026 2333 343b 295b 315d 2069 6e20 5b26   &#34;)[1] in [&
+0001ccc0: 2333 343b 6461 7973 2623 3334 3b2c 2026  #34;days&#34;, &
+0001ccd0: 2333 343b 686f 7572 7326 2333 343b 2c20  #34;hours&#34;, 
+0001cce0: 2623 3334 3b6d 696e 7574 6573 2623 3334  &#34;minutes&#34
+0001ccf0: 3b2c 2026 2333 343b 7365 636f 6e64 7326  ;, &#34;seconds&
+0001cd00: 2333 343b 5d3a 0a20 2020 2020 2020 2020  #34;]:.         
+0001cd10: 2020 2020 2020 2073 656c 662e 686f 7269         self.hori
+0001cd20: 7a6f 6e5f 7469 6d65 203d 2063 6f6e 7465  zon_time = conte
+0001cd30: 7874 5f68 6f72 697a 6f6e 2e73 706c 6974  xt_horizon.split
+0001cd40: 2826 2333 343b 2026 2333 343b 295b 315d  (&#34; &#34;)[1]
+0001cd50: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+0001cd60: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+0001cd70: 2020 2061 7373 6572 7420 4661 6c73 652c     assert False,
+0001cd80: 2026 2333 343b 5469 6d65 2068 6f72 697a   &#34;Time horiz
+0001cd90: 6f6e 206d 7573 7420 6265 2065 6974 6865  on must be eithe
+0001cda0: 7220 6120 7369 6e67 6c65 206e 756d 6265  r a single numbe
+0001cdb0: 7220 6f72 2069 6e20 666f 726d 206f 6620  r or in form of 
+0001cdc0: 5c26 2333 343b 3820 686f 7572 735c 2623  \&#34;8 hours\&#
+0001cdd0: 3334 3b20 7768 6572 6520 6163 6365 7074  34; where accept
+0001cde0: 6162 6c65 2074 696d 6520 6672 616d 6573  able time frames
+0001cdf0: 2061 7265 2068 6f75 7273 2c64 6179 732c   are hours,days,
+0001ce00: 6d69 6e75 7465 732c 7365 636f 6e64 7326  minutes,seconds&
+0001ce10: 2333 343b 0a0a 2020 2020 2020 2020 7365  #34;..        se
+0001ce20: 6c66 2e68 6f72 697a 6f6e 203d 2069 6e74  lf.horizon = int
+0001ce30: 2873 656c 662e 686f 7269 7a6f 6e29 0a20  (self.horizon). 
+0001ce40: 2020 2020 2020 2073 656c 662e 696e 7465         self.inte
+0001ce50: 7270 7265 745f 6869 7374 6f72 795f 706f  rpret_history_po
+0001ce60: 7320 3d20 300a 2020 2020 2020 2020 7365  s = 0.        se
+0001ce70: 6c66 2e63 6f6e 7465 7874 5f70 6f73 203d  lf.context_pos =
+0001ce80: 2030 0a0a 0a20 2020 2064 6566 2067 656e   0...    def gen
+0001ce90: 6572 6174 655f 636f 6e74 6578 7428 7365  erate_context(se
+0001cea0: 6c66 2c64 6174 6574 696d 655f 696e 6465  lf,datetime_inde
+0001ceb0: 7829 3a0a 2020 2020 2020 2020 636f 6e74  x):.        cont
+0001cec0: 6578 7470 626a 6563 742c 2074 6172 6765  extpbject, targe
+0001ced0: 745f 7365 7269 6573 5f6e 616d 652c 7469  t_series_name,ti
+0001cee0: 6d65 5f69 6e64 6578 3d73 656c 662e 6372  me_index=self.cr
+0001cef0: 6561 7465 5f63 6f6e 7465 7874 2864 6174  eate_context(dat
+0001cf00: 6574 696d 655f 696e 6465 7829 0a0a 2020  etime_index)..  
+0001cf10: 2020 2020 2020 7365 6c66 2e63 6f6e 7465        self.conte
+0001cf20: 7874 735b 7469 6d65 5f69 6e64 6578 5d3d  xts[time_index]=
+0001cf30: 636f 6e74 6578 7470 626a 6563 740a 0a20  contextpbject.. 
+0001cf40: 2020 2020 2020 2072 6574 7572 6e20 636f         return co
+0001cf50: 6e74 6578 7470 626a 6563 740a 0a20 2020  ntextpbject..   
+0001cf60: 2064 6566 205f 7361 7665 5f63 6f6e 7465   def _save_conte
+0001cf70: 7874 7328 7365 6c66 293a 0a20 2020 2020  xts(self):.     
+0001cf80: 2020 2069 6620 7365 6c66 2e66 696c 655f     if self.file_
+0001cf90: 7061 7468 2069 7320 4e6f 6e65 3a0a 2020  path is None:.  
+0001cfa0: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001cfb0: 0a20 2020 2020 2020 2077 6974 6820 6f70  .        with op
+0001cfc0: 656e 2873 656c 662e 6669 6c65 5f70 6174  en(self.file_pat
+0001cfd0: 682c 2026 2333 393b 7762 2623 3339 3b29  h, &#39;wb&#39;)
+0001cfe0: 2061 7320 663a 0a20 2020 2020 2020 2020   as f:.         
+0001cff0: 2020 2070 6963 6b6c 652e 6475 6d70 2873     pickle.dump(s
+0001d000: 656c 662e 636f 6e74 6578 7473 2c20 6629  elf.contexts, f)
+0001d010: 0a0a 2020 2020 6465 6620 5f6c 6f61 645f  ..    def _load_
+0001d020: 636f 6e74 6578 7473 2873 656c 6629 3a0a  contexts(self):.
+0001d030: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+0001d040: 6669 6c65 5f70 6174 6820 6973 204e 6f6e  file_path is Non
+0001d050: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+0001d060: 6574 7572 6e20 7b7d 0a0a 2020 2020 2020  eturn {}..      
+0001d070: 2020 6d79 5f66 696c 6520 3d20 5061 7468    my_file = Path
+0001d080: 2873 656c 662e 6669 6c65 5f70 6174 6829  (self.file_path)
+0001d090: 0a20 2020 2020 2020 2069 6620 6d79 5f66  .        if my_f
+0001d0a0: 696c 652e 6973 5f66 696c 6528 293a 0a20  ile.is_file():. 
+0001d0b0: 2020 2020 2020 2020 2020 2077 6974 6820             with 
+0001d0c0: 6f70 656e 2873 656c 662e 6669 6c65 5f70  open(self.file_p
+0001d0d0: 6174 682c 2026 2333 393b 7262 2623 3339  ath, &#39;rb&#39
+0001d0e0: 3b29 2061 7320 663a 0a20 2020 2020 2020  ;) as f:.       
+0001d0f0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001d100: 7069 636b 6c65 2e6c 6f61 6428 6629 0a20  pickle.load(f). 
+0001d110: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+0001d120: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001d130: 207b 7d0a 2020 2020 6465 6620 6372 6561   {}.    def crea
+0001d140: 7465 5f63 6f6e 7465 7874 2873 656c 662c  te_context(self,
+0001d150: 2064 6174 6574 696d 655f 696e 6465 7829   datetime_index)
+0001d160: 3a0a 0a20 2020 2020 2020 2073 7461 7274  :..        start
+0001d170: 5f69 6e64 6578 203d 2064 6174 6574 696d  _index = datetim
+0001d180: 655f 696e 6465 7820 2d20 7064 2e54 696d  e_index - pd.Tim
+0001d190: 6564 656c 7461 2873 656c 662e 686f 7269  edelta(self.hori
+0001d1a0: 7a6f 6e2c 2073 656c 662e 686f 7269 7a6f  zon, self.horizo
+0001d1b0: 6e5f 7469 6d65 290a 0a20 2020 2020 2020  n_time)..       
+0001d1c0: 2063 6f6e 7465 7874 3d73 656c 662e 6466   context=self.df
+0001d1d0: 5f64 6174 612e 6c6f 635b 7374 6172 745f  _data.loc[start_
+0001d1e0: 696e 6465 783a 6461 7465 7469 6d65 5f69  index:datetime_i
+0001d1f0: 6e64 6578 5d0a 0a20 2020 2020 2020 2061  ndex]..        a
+0001d200: 6c6c 636f 6465 7320 3d20 6e70 2e75 6e69  llcodes = np.uni
+0001d210: 7175 6528 7365 6c66 2e64 665f 6461 7461  que(self.df_data
+0001d220: 2e63 6f6c 756d 6e73 290a 2020 2020 2020  .columns).      
+0001d230: 2020 616c 6c63 6f64 6573 203d 205b 636f    allcodes = [co
+0001d240: 6465 2066 6f72 2063 6f64 6520 696e 2061  de for code in a
+0001d250: 6c6c 636f 6465 735d 0a20 2020 2020 2020  llcodes].       
+0001d260: 2061 6c6c 636f 6465 7320 3d20 7365 7428   allcodes = set(
+0001d270: 616c 6c63 6f64 6573 290a 0a20 2020 2020  allcodes)..     
+0001d280: 2020 2023 2320 6275 696c 6420 7461 7267     ## build targ
+0001d290: 6574 2073 6572 6965 730a 2020 2020 2020  et series.      
+0001d2a0: 2020 7461 7267 6574 5f73 6572 6965 735f    target_series_
+0001d2b0: 6e61 6d65 3d20 7365 6c66 2e74 6172 6765  name= self.targe
+0001d2c0: 740a 2020 2020 2020 2020 7461 7267 6574  t.        target
+0001d2d0: 5f73 6572 6965 733d 636f 6e74 6578 745b  _series=context[
+0001d2e0: 7365 6c66 2e74 6172 6765 745d 2e76 616c  self.target].val
+0001d2f0: 7565 730a 0a20 2020 2020 2020 2023 2320  ues..        ## 
+0001d300: 6372 6561 7465 2073 6572 6965 7320 666f  create series fo
+0001d310: 7220 6561 6368 2073 6f75 7263 6520 2861  r each source (a
+0001d320: 6c6c 6461 7461 290a 2020 2020 2020 2020  lldata).        
+0001d330: 616c 6c64 6174 6120 3d20 5b5d 0a20 2020  alldata = [].   
+0001d340: 2020 2020 2066 6f72 2063 6f6c 2069 6e20       for col in 
+0001d350: 636f 6e74 6578 742e 636f 6c75 6d6e 733a  context.columns:
+0001d360: 0a20 2020 2020 2020 2020 2020 2061 6c6c  .            all
+0001d370: 6461 7461 2e61 7070 656e 6428 2863 6f6c  data.append((col
+0001d380: 2c20 636f 6e74 6578 745b 636f 6c5d 2e76  , context[col].v
+0001d390: 616c 7565 7329 290a 2020 2020 2020 2020  alues)).        
+0001d3a0: 2320 656e 6420 3d20 7469 6d65 2e74 696d  # end = time.tim
+0001d3b0: 6528 290a 2020 2020 2020 2020 2320 7072  e().        # pr
+0001d3c0: 696e 7428 6626 2333 343b 4372 6561 7465  int(f&#34;Create
+0001d3d0: 2073 6572 6965 733a 207b 656e 642d 7374   series: {end-st
+0001d3e0: 6172 747d 2623 3334 3b29 0a0a 2020 2020  art}&#34;)..    
+0001d3f0: 2020 2020 7374 6f72 696e 6720 3d20 7365      storing = se
+0001d400: 6c66 2e63 616c 6375 6c61 7465 5f65 6467  lf.calculate_edg
+0001d410: 6573 2861 6c6c 6461 7461 2c20 636f 6e74  es(alldata, cont
+0001d420: 6578 742e 696e 6465 785b 2d31 5d29 0a20  ext.index[-1]). 
+0001d430: 2020 2020 2020 2073 746f 7269 6e67 5b26         storing[&
+0001d440: 2333 343b 6368 6172 6163 7465 7269 7a61  #34;characteriza
+0001d450: 7469 6f6e 2623 3334 3b5d 203d 2073 656c  tion&#34;] = sel
+0001d460: 662e 6765 7463 6172 6163 7465 7269 7a65  f.getcaracterize
+0001d470: 2873 746f 7269 6e67 290a 0a20 2020 2020  (storing)..     
+0001d480: 2020 2023 2070 7269 6e74 2866 2623 3334     # print(f&#34
+0001d490: 3b43 616c 6375 6c61 7465 2065 6467 6573  ;Calculate edges
+0001d4a0: 3a20 7b65 6e64 202d 2073 7461 7274 7d26  : {end - start}&
+0001d4b0: 2333 343b 290a 2020 2020 2020 2020 2320  #34;).        # 
+0001d4c0: 7072 696e 7428 2623 3334 3b3d 3d3d 3d3d  print(&#34;=====
+0001d4d0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  ================
+0001d4e0: 3d3d 3d26 2333 343b 290a 0a20 2020 2020  ===&#34;)..     
+0001d4f0: 2020 2063 6f6e 7465 7874 7062 6a65 6374     contextpbject
+0001d500: 203d 2043 6f6e 7465 7874 2e63 6f6e 7465   = Context.conte
+0001d510: 7874 5f66 726f 6d5f 6469 6374 2873 746f  xt_from_dict(sto
+0001d520: 7269 6e67 290a 2020 2020 2020 2020 7265  ring).        re
+0001d530: 7475 726e 2063 6f6e 7465 7874 7062 6a65  turn contextpbje
+0001d540: 6374 2c20 7461 7267 6574 5f73 6572 6965  ct, target_serie
+0001d550: 735f 6e61 6d65 2c63 6f6e 7465 7874 2e69  s_name,context.i
+0001d560: 6e64 6578 5b2d 315d 0a0a 2020 2020 6465  ndex[-1]..    de
+0001d570: 6620 6361 6c63 756c 6174 655f 6564 6765  f calculate_edge
+0001d580: 7328 7365 6c66 2c61 6c6c 6461 7461 2c20  s(self,alldata, 
+0001d590: 7469 6d65 7374 616d 7029 3a0a 2020 2020  timestamp):.    
+0001d5a0: 2020 2020 2373 7461 7274 203d 2074 696d      #start = tim
+0001d5b0: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
+0001d5c0: 2073 746f 7269 6e67 203d 207b 7d0a 2020   storing = {}.  
+0001d5d0: 2020 2020 2020 7374 6f72 696e 675b 2623        storing[&#
+0001d5e0: 3334 3b74 696d 6573 7461 6d70 2623 3334  34;timestamp&#34
+0001d5f0: 3b5d 203d 2074 696d 6573 7461 6d70 0a0a  ;] = timestamp..
+0001d600: 2020 2020 2020 2020 616c 6c64 6174 615f          alldata_
+0001d610: 6e61 6d65 7320 3d20 5b6e 6e5b 305d 2066  names = [nn[0] f
+0001d620: 6f72 206e 6e20 696e 2061 6c6c 6461 7461  or nn in alldata
+0001d630: 5d0a 2020 2020 2020 2020 616c 6c64 6174  ].        alldat
+0001d640: 615f 6461 7461 203d 205b 6e6e 5b31 5d20  a_data = [nn[1] 
+0001d650: 666f 7220 6e6e 2069 6e20 616c 6c64 6174  for nn in alldat
+0001d660: 615d 0a0a 2020 2020 2020 2020 666f 7220  a]..        for 
+0001d670: 6e61 6d65 6464 2c20 6461 7461 6464 2069  namedd, datadd i
+0001d680: 6e20 7a69 7028 616c 6c64 6174 615f 6e61  n zip(alldata_na
+0001d690: 6d65 732c 2061 6c6c 6461 7461 5f64 6174  mes, alldata_dat
+0001d6a0: 6129 3a0a 2020 2020 2020 2020 2020 2020  a):.            
+0001d6b0: 7374 6f72 696e 675b 6e61 6d65 6464 5d20  storing[namedd] 
+0001d6c0: 3d20 6461 7461 6464 0a0a 2020 2020 2020  = datadd..      
+0001d6d0: 2020 2320 466f 7220 636f 6e74 6578 7420    # For context 
+0001d6e0: 7769 7468 206d 6f72 6520 7468 616e 2074  with more than t
+0001d6f0: 776f 2073 6572 6965 7320 6361 6c63 756c  wo series calcul
+0001d700: 6174 6520 5043 2063 6173 7561 6c69 7469  ate PC casualiti
+0001d710: 6573 0a20 2020 2020 2020 2063 6f75 6e74  es.        count
+0001d720: 203d 206c 656e 285b 3120 666f 7220 6c69   = len([1 for li
+0001d730: 7374 6120 696e 2061 6c6c 6461 7461 5f64  sta in alldata_d
+0001d740: 6174 6120 6966 206c 6973 7461 2069 7320  ata if lista is 
+0001d750: 6e6f 7420 4e6f 6e65 5d29 0a20 2020 2020  not None]).     
+0001d760: 2020 2069 6620 636f 756e 7420 2667 743b     if count &gt;
+0001d770: 2031 2061 6e64 206c 656e 2861 6c6c 6461   1 and len(allda
+0001d780: 7461 5b30 5d5b 315d 2920 2667 743b 2035  ta[0][1]) &gt; 5
+0001d790: 3a0a 2020 2020 2020 2020 2020 2020 616c  :.            al
+0001d7a0: 6c64 6174 615f 6e61 6d65 7320 3d20 5b6e  ldata_names = [n
+0001d7b0: 6e5b 305d 2066 6f72 206e 6e20 696e 2061  n[0] for nn in a
+0001d7c0: 6c6c 6461 7461 2069 6620 6e6e 5b31 5d20  lldata if nn[1] 
+0001d7d0: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+0001d7e0: 6c65 6e28 7365 7428 6e6e 5b31 5d29 2926  len(set(nn[1]))&
+0001d7f0: 6774 3b31 5d0a 2020 2020 2020 2020 2020  gt;1].          
+0001d800: 2020 616c 6c64 6174 615f 6461 7461 203d    alldata_data =
+0001d810: 205b 6e6e 5b31 5d20 666f 7220 6e6e 2069   [nn[1] for nn i
+0001d820: 6e20 616c 6c64 6174 6120 6966 206e 6e5b  n alldata if nn[
+0001d830: 315d 2069 7320 6e6f 7420 4e6f 6e65 2061  1] is not None a
+0001d840: 6e64 206c 656e 2873 6574 286e 6e5b 315d  nd len(set(nn[1]
+0001d850: 2929 2667 743b 315d 0a0a 2020 2020 2020  ))&gt;1]..      
+0001d860: 2020 2020 2020 2365 6e64 203d 2074 696d        #end = tim
+0001d870: 652e 7469 6d65 2829 0a20 2020 2020 2020  e.time().       
+0001d880: 2020 2020 2023 7072 696e 7428 6626 2333       #print(f&#3
+0001d890: 343b 6265 666f 7265 207b 656e 6420 2d20  4;before {end - 
+0001d8a0: 7374 6172 747d 2623 3334 3b29 0a20 2020  start}&#34;).   
+0001d8b0: 2020 2020 2020 2020 2023 7374 6172 743d           #start=
+0001d8c0: 7469 6d65 2e74 696d 6528 290a 0a20 2020  time.time()..   
+0001d8d0: 2020 2020 2020 2020 2069 6620 6c65 6e28           if len(
+0001d8e0: 616c 6c64 6174 6129 2026 6c74 3b3d 2031  alldata) &lt;= 1
+0001d8f0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001d900: 2020 6564 6765 7320 3d20 5b5d 0a20 2020    edges = [].   
+0001d910: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001d920: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001d930: 6467 6573 203d 2073 656c 662e 6361 6c63  dges = self.calc
+0001d940: 756c 6174 655f 6361 7573 616c 6974 7928  ulate_causality(
+0001d950: 6e70 2e63 6f6c 756d 6e5f 7374 6163 6b28  np.column_stack(
+0001d960: 616c 6c64 6174 615f 6461 7461 292c 2061  alldata_data), a
+0001d970: 6c6c 6461 7461 5f6e 616d 6573 290a 2020  lldata_names).  
+0001d980: 2020 2020 2020 2020 2020 2365 6e64 3d74            #end=t
+0001d990: 696d 652e 7469 6d65 2829 0a20 2020 2020  ime.time().     
+0001d9a0: 2020 2020 2020 2023 7072 696e 7428 6626         #print(f&
+0001d9b0: 2333 343b 6163 7475 616c 2065 6467 6520  #34;actual edge 
+0001d9c0: 6361 6c63 756c 6174 696f 6e20 7b65 6e64  calculation {end
+0001d9d0: 2d73 7461 7274 7d26 2333 343b 290a 2020  -start}&#34;).  
+0001d9e0: 2020 2020 2020 2020 2020 6966 2065 6467            if edg
+0001d9f0: 6573 2069 7320 4e6f 6e65 3a0a 2020 2020  es is None:.    
+0001da00: 2020 2020 2020 2020 2020 2020 7369 6e67              sing
+0001da10: 6c65 6564 6765 7320 3d20 5b5d 0a20 2020  leedges = [].   
+0001da20: 2020 2020 2020 2020 2065 6c73 653a 0a20           else:. 
+0001da30: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001da40: 696e 676c 6565 6467 6573 203d 2065 6467  ingleedges = edg
+0001da50: 6573 0a20 2020 2020 2020 2020 2020 2023  es.            #
+0001da60: 2070 7269 6e74 2865 6467 6573 290a 2020   print(edges).  
+0001da70: 2020 2020 2020 2020 2020 7374 6f72 696e            storin
+0001da80: 675b 2623 3334 3b65 6467 6573 2623 3334  g[&#34;edges&#34
+0001da90: 3b5d 203d 2073 696e 676c 6565 6467 6573  ;] = singleedges
+0001daa0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0001dab0: 7572 6e20 7374 6f72 696e 670a 2020 2020  urn storing.    
+0001dac0: 2020 2020 7374 6f72 696e 675b 2623 3334      storing[&#34
+0001dad0: 3b65 6467 6573 2623 3334 3b5d 203d 205b  ;edges&#34;] = [
+0001dae0: 5d0a 2020 2020 2020 2020 7265 7475 726e  ].        return
+0001daf0: 2073 746f 7269 6e67 0a0a 2020 2020 6465   storing..    de
+0001db00: 6620 6361 6c63 756c 6174 655f 6361 7573  f calculate_caus
+0001db10: 616c 6974 7928 7365 6c66 2c20 6461 7461  ality(self, data
+0001db20: 6f72 2c20 6e61 6d65 7329 3a0a 2020 2020  or, names):.    
+0001db30: 2020 2020 6e75 6d5f 7469 6d65 5f73 6572      num_time_ser
+0001db40: 6965 7320 3d20 6c65 6e28 6461 7461 6f72  ies = len(dataor
+0001db50: 290a 2020 2020 2020 2020 6461 7461 203d  ).        data =
+0001db60: 206e 702e 6172 7261 7928 6461 7461 6f72   np.array(dataor
+0001db70: 290a 2020 2020 2020 2020 6564 6765 7320  ).        edges 
+0001db80: 3d20 7365 6c66 2e63 6175 7361 6c69 7479  = self.causality
+0001db90: 5f64 6973 636f 7665 7279 286e 616d 6573  _discovery(names
+0001dba0: 2c20 6461 7461 290a 2020 2020 2020 2020  , data).        
+0001dbb0: 2320 6564 6765 733d 7365 6c66 2e63 616c  # edges=self.cal
+0001dbc0: 6375 6c61 7465 7769 7468 5063 286e 616d  culatewithPc(nam
+0001dbd0: 6573 2c64 6174 6129 0a20 2020 2020 2020  es,data).       
+0001dbe0: 2023 2065 6467 6573 3d73 656c 662e 6361   # edges=self.ca
+0001dbf0: 6c63 756c 6174 6577 6974 685f 6663 6928  lculatewith_fci(
+0001dc00: 6e61 6d65 732c 6461 7461 290a 2020 2020  names,data).    
+0001dc10: 2020 2020 2320 6564 6765 733d 7365 6c66      # edges=self
+0001dc20: 2e73 616c 6573 666f 7263 6550 4328 6e61  .salesforcePC(na
+0001dc30: 6d65 732c 6461 7461 290a 2020 2020 2020  mes,data).      
+0001dc40: 2020 7265 7475 726e 2065 6467 6573 0a20    return edges. 
+0001dc50: 2020 2064 6566 2067 6574 6361 7261 6374     def getcaract
+0001dc60: 6572 697a 6528 7365 6c66 2c63 6f6e 7465  erize(self,conte
+0001dc70: 7874 293a 0a20 2020 2020 2020 2065 6467  xt):.        edg
+0001dc80: 6573 203d 2063 6f6e 7465 7874 5b26 2333  es = context[&#3
+0001dc90: 343b 6564 6765 7326 2333 343b 5d0a 2020  4;edges&#34;].  
+0001dca0: 2020 2020 2020 6368 6172 6163 7465 7269        characteri
+0001dcb0: 7a61 7469 6f6e 7320 3d20 5b5d 0a20 2020  zations = [].   
+0001dcc0: 2020 2020 2066 6f72 2065 6467 6520 696e       for edge in
+0001dcd0: 2065 6467 6573 3a0a 2020 2020 2020 2020   edges:.        
+0001dce0: 2020 2020 6e61 6d65 3120 3d20 6564 6765      name1 = edge
+0001dcf0: 5b30 5d0a 2020 2020 2020 2020 2020 2020  [0].            
+0001dd00: 6e61 6d65 3220 3d20 6564 6765 5b31 5d0a  name2 = edge[1].
+0001dd10: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0001dd20: 6573 3120 3d20 636f 6e74 6578 745b 6e61  es1 = context[na
+0001dd30: 6d65 315d 0a20 2020 2020 2020 2020 2020  me1].           
+0001dd40: 2076 616c 7565 7332 203d 205b 666c 6f61   values2 = [floa
+0001dd50: 7428 6b61 7469 2920 666f 7220 6b61 7469  t(kati) for kati
+0001dd60: 2069 6e20 636f 6e74 6578 745b 6e61 6d65   in context[name
+0001dd70: 325d 5d0a 0a20 2020 2020 2020 2020 2020  2]]..           
+0001dd80: 206f 6363 7572 656e 6365 3d6c 656e 2876   occurence=len(v
+0001dd90: 616c 7565 7331 292d 310a 2020 2020 2020  alues1)-1.      
+0001dda0: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0001ddb0: 616e 6765 286c 656e 2876 616c 7565 7331  ange(len(values1
+0001ddc0: 292d 322c 302c 2d31 293a 0a20 2020 2020  )-2,0,-1):.     
+0001ddd0: 2020 2020 2020 2020 2020 2069 6620 7661             if va
+0001dde0: 6c75 6573 315b 695d 2021 3d20 7661 6c75  lues1[i] != valu
+0001ddf0: 6573 315b 2d31 5d3a 0a20 2020 2020 2020  es1[-1]:.       
+0001de00: 2020 2020 2020 2020 2020 2020 206f 6363               occ
+0001de10: 7572 656e 6365 203d 2069 2b31 0a20 2020  urence = i+1.   
+0001de20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001de30: 2062 7265 616b 0a20 2020 2020 2020 2020   break.         
+0001de40: 2020 2070 7265 7669 7573 6f63 6375 7265     previusoccure
+0001de50: 6e63 6520 3d20 300a 2020 2020 2020 2020  nce = 0.        
+0001de60: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0001de70: 6765 286f 6363 7572 656e 6365 2d32 2c30  ge(occurence-2,0
+0001de80: 2c2d 3129 3a0a 2020 2020 2020 2020 2020  ,-1):.          
+0001de90: 2020 2020 2020 6966 2076 616c 7565 7331        if values1
+0001dea0: 5b69 5d20 213d 2020 7661 6c75 6573 315b  [i] !=  values1[
+0001deb0: 6f63 6375 7265 6e63 652d 315d 3a0a 2020  occurence-1]:.  
+0001dec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001ded0: 2020 7072 6576 6975 736f 6363 7572 656e    previusoccuren
+0001dee0: 6365 203d 2069 0a0a 2020 2020 2020 2020  ce = i..        
+0001def0: 2020 2020 6966 206f 6363 7572 656e 6365      if occurence
+0001df00: 202d 2070 7265 7669 7573 6f63 6375 7265   - previusoccure
+0001df10: 6e63 6520 266c 743b 2032 3a20 2023 206f  nce &lt; 2:  # o
+0001df20: 7220 6c65 6e28 7661 6c75 6573 3229 2d6f  r len(values2)-o
+0001df30: 6363 7572 656e 6365 266c 743b 323a 0a20  ccurence&lt;2:. 
+0001df40: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001df50: 6861 7261 6374 6572 697a 6174 696f 6e73  haracterizations
+0001df60: 2e61 7070 656e 6428 2623 3334 3b75 6b6e  .append(&#34;ukn
+0001df70: 6f77 6e26 2333 343b 290a 2020 2020 2020  own&#34;).      
+0001df80: 2020 2020 2020 2020 2020 636f 6e74 696e            contin
+0001df90: 7565 0a20 2020 2020 2020 2020 2020 2076  ue.            v
+0001dfa0: 616c 7565 7332 6265 666f 7265 203d 2076  alues2before = v
+0001dfb0: 616c 7565 7332 5b70 7265 7669 7573 6f63  alues2[previusoc
+0001dfc0: 6375 7265 6e63 653a 6f63 6375 7265 6e63  curence:occurenc
+0001dfd0: 655d 0a20 2020 2020 2020 2020 2020 2023  e].            #
+0001dfe0: 2073 7464 7620 3d20 7374 6174 6973 7469   stdv = statisti
+0001dff0: 6373 2e73 7464 6576 2876 616c 7565 7332  cs.stdev(values2
+0001e000: 6265 666f 7265 290a 2020 2020 2020 2020  before).        
+0001e010: 2020 2020 2320 6d65 616e 203d 2073 7461      # mean = sta
+0001e020: 7469 7374 6963 732e 7374 6465 7628 7661  tistics.stdev(va
+0001e030: 6c75 6573 3262 6566 6f72 6529 0a20 2020  lues2before).   
+0001e040: 2020 2020 2020 2020 2023 2076 616c 7565           # value
+0001e050: 7332 6265 666f 7265 3d5b 7620 6966 2076  s2before=[v if v
+0001e060: 266c 743b 6d65 616e 2b35 2a73 7464 7620  &lt;mean+5*stdv 
+0001e070: 656c 7365 206d 6561 6e20 666f 7220 7620  else mean for v 
+0001e080: 696e 2076 616c 7565 7332 6265 666f 7265  in values2before
+0001e090: 5d0a 0a20 2020 2020 2020 2020 2020 2023  ]..            #
+0001e0a0: 2076 616c 7565 7332 6166 7465 723d 7661   values2after=va
+0001e0b0: 6c75 6573 325b 6f63 6375 7265 6e63 653a  lues2[occurence:
+0001e0c0: 5d0a 2020 2020 2020 2020 2020 2020 7661  ].            va
+0001e0d0: 6c75 6573 3261 6674 6572 203d 205b 7661  lues2after = [va
+0001e0e0: 6c75 6573 325b 2d31 5d5d 0a20 2020 2020  lues2[-1]].     
+0001e0f0: 2020 2020 2020 2023 2073 7464 7620 3d20         # stdv = 
+0001e100: 7374 6174 6973 7469 6373 2e73 7464 6576  statistics.stdev
+0001e110: 2876 616c 7565 7332 6166 7465 7229 0a20  (values2after). 
+0001e120: 2020 2020 2020 2020 2020 2023 206d 6561             # mea
+0001e130: 6e20 3d20 7374 6174 6973 7469 6373 2e73  n = statistics.s
+0001e140: 7464 6576 2876 616c 7565 7332 6166 7465  tdev(values2afte
+0001e150: 7229 0a20 2020 2020 2020 2020 2020 2023  r).            #
+0001e160: 2076 616c 7565 7332 6166 7465 7220 3d20   values2after = 
+0001e170: 5b76 2069 6620 7620 266c 743b 206d 6561  [v if v &lt; mea
+0001e180: 6e20 2b20 3320 2a20 7374 6476 2065 6c73  n + 3 * stdv els
+0001e190: 6520 6d65 616e 2066 6f72 2076 2069 6e20  e mean for v in 
+0001e1a0: 7661 6c75 6573 3261 6674 6572 5d0a 0a20  values2after].. 
+0001e1b0: 2020 2020 2020 2020 2020 2073 7464 7620             stdv 
+0001e1c0: 3d20 7374 6174 6973 7469 6373 2e73 7464  = statistics.std
+0001e1d0: 6576 2876 616c 7565 7332 6265 666f 7265  ev(values2before
+0001e1e0: 290a 2020 2020 2020 2020 2020 2020 6966  ).            if
+0001e1f0: 206c 656e 2876 616c 7565 7332 6265 666f   len(values2befo
+0001e200: 7265 2920 3d3d 2030 3a0a 2020 2020 2020  re) == 0:.      
+0001e210: 2020 2020 2020 2020 2020 6368 6172 203d            char =
+0001e220: 2026 2333 343b 756b 6e6f 776e 2623 3334   &#34;uknown&#34
+0001e230: 3b0a 2020 2020 2020 2020 2020 2020 656c  ;.            el
+0001e240: 6966 2073 7461 7469 7374 6963 732e 6d65  if statistics.me
+0001e250: 6469 616e 2876 616c 7565 7332 6265 666f  dian(values2befo
+0001e260: 7265 2920 2d20 7374 6174 6973 7469 6373  re) - statistics
+0001e270: 2e6d 6564 6961 6e28 7661 6c75 6573 3261  .median(values2a
+0001e280: 6674 6572 2920 2667 743b 2032 202a 2073  fter) &gt; 2 * s
+0001e290: 7464 763a 0a20 2020 2020 2020 2020 2020  tdv:.           
+0001e2a0: 2020 2020 2063 6861 7220 3d20 2623 3334       char = &#34
+0001e2b0: 3b64 6563 7265 6173 6526 2333 343b 0a20  ;decrease&#34;. 
+0001e2c0: 2020 2020 2020 2020 2020 2065 6c69 6620             elif 
+0001e2d0: 7374 6174 6973 7469 6373 2e6d 6564 6961  statistics.media
+0001e2e0: 6e28 7661 6c75 6573 3261 6674 6572 2920  n(values2after) 
+0001e2f0: 2d20 7374 6174 6973 7469 6373 2e6d 6564  - statistics.med
+0001e300: 6961 6e28 7661 6c75 6573 3262 6566 6f72  ian(values2befor
+0001e310: 6529 2026 6774 3b20 3220 2a20 7374 6476  e) &gt; 2 * stdv
+0001e320: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001e330: 2020 6368 6172 203d 2026 2333 343b 696e    char = &#34;in
+0001e340: 6372 6561 7365 2623 3334 3b0a 2020 2020  crease&#34;.    
+0001e350: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+0001e360: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+0001e370: 6172 203d 2026 2333 343b 756b 6e6f 776e  ar = &#34;uknown
+0001e380: 2623 3334 3b0a 2020 2020 2020 2020 2020  &#34;.          
+0001e390: 2020 6368 6172 6163 7465 7269 7a61 7469    characterizati
+0001e3a0: 6f6e 732e 6170 7065 6e64 2863 6861 7229  ons.append(char)
+0001e3b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001e3c0: 6368 6172 6163 7465 7269 7a61 7469 6f6e  characterization
+0001e3d0: 730a 0a0a 2020 2020 6465 6620 5f5f 6465  s...    def __de
+0001e3e0: 6c5f 5f28 7365 6c66 293a 0a20 2020 2020  l__(self):.     
+0001e3f0: 2020 2069 6620 7365 6c66 2e66 696c 655f     if self.file_
+0001e400: 7061 7468 2069 7320 4e6f 6e65 3a0a 2020  path is None:.  
+0001e410: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001e420: 0a20 2020 2020 2020 206d 795f 6669 6c65  .        my_file
+0001e430: 203d 2050 6174 6828 7365 6c66 2e66 696c   = Path(self.fil
+0001e440: 655f 7061 7468 290a 2020 2020 2020 2020  e_path).        
+0001e450: 6966 206d 795f 6669 6c65 2e69 735f 6669  if my_file.is_fi
+0001e460: 6c65 2829 3a0a 2020 2020 2020 2020 2020  le():.          
+0001e470: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
+0001e480: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+0001e490: 2020 2073 656c 662e 5f73 6176 655f 636f     self._save_co
+0001e4a0: 6e74 6578 7473 2829 3c2f 636f 6465 3e3c  ntexts()</code><
+0001e4b0: 2f70 7265 3e0a 3c2f 6465 7461 696c 733e  /pre>.</details>
+0001e4c0: 0a3c 6833 3e4d 6574 686f 6473 3c2f 6833  .<h3>Methods</h3
+0001e4d0: 3e0a 3c64 6c3e 0a3c 6474 2069 643d 2250  >.<dl>.<dt id="P
+0001e4e0: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
+0001e4f0: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
+0001e500: 6578 7447 656e 6572 6174 6f72 4261 7463  extGeneratorBatc
+0001e510: 682e 6361 6c63 756c 6174 655f 6361 7573  h.calculate_caus
+0001e520: 616c 6974 7922 3e3c 636f 6465 2063 6c61  ality"><code cla
+0001e530: 7373 3d22 6e61 6d65 2066 6c65 7822 3e0a  ss="name flex">.
+0001e540: 3c73 7061 6e3e 6465 6620 3c73 7061 6e20  <span>def <span 
+0001e550: 636c 6173 733d 2269 6465 6e74 223e 6361  class="ident">ca
+0001e560: 6c63 756c 6174 655f 6361 7573 616c 6974  lculate_causalit
+0001e570: 793c 2f73 7061 6e3e 3c2f 7370 616e 3e28  y</span></span>(
+0001e580: 3c73 7061 6e3e 7365 6c66 2c20 6461 7461  <span>self, data
+0001e590: 6f72 2c20 6e61 6d65 7329 3c2f 7370 616e  or, names)</span
+0001e5a0: 3e0a 3c2f 636f 6465 3e3c 2f64 743e 0a3c  >.</code></dt>.<
+0001e5b0: 6464 3e0a 3c64 6976 2063 6c61 7373 3d22  dd>.<div class="
+0001e5c0: 6465 7363 223e 3c2f 6469 763e 0a3c 6465  desc"></div>.<de
+0001e5d0: 7461 696c 7320 636c 6173 733d 2273 6f75  tails class="sou
+0001e5e0: 7263 6522 3e0a 3c73 756d 6d61 7279 3e0a  rce">.<summary>.
+0001e5f0: 3c73 7061 6e3e 4578 7061 6e64 2073 6f75  <span>Expand sou
+0001e600: 7263 6520 636f 6465 3c2f 7370 616e 3e0a  rce code</span>.
+0001e610: 3c2f 7375 6d6d 6172 793e 0a3c 7072 653e  </summary>.<pre>
+0001e620: 3c63 6f64 6520 636c 6173 733d 2270 7974  <code class="pyt
+0001e630: 686f 6e22 3e64 6566 2063 616c 6375 6c61  hon">def calcula
+0001e640: 7465 5f63 6175 7361 6c69 7479 2873 656c  te_causality(sel
+0001e650: 662c 2064 6174 616f 722c 206e 616d 6573  f, dataor, names
+0001e660: 293a 0a20 2020 206e 756d 5f74 696d 655f  ):.    num_time_
+0001e670: 7365 7269 6573 203d 206c 656e 2864 6174  series = len(dat
+0001e680: 616f 7229 0a20 2020 2064 6174 6120 3d20  aor).    data = 
+0001e690: 6e70 2e61 7272 6179 2864 6174 616f 7229  np.array(dataor)
+0001e6a0: 0a20 2020 2065 6467 6573 203d 2073 656c  .    edges = sel
+0001e6b0: 662e 6361 7573 616c 6974 795f 6469 7363  f.causality_disc
+0001e6c0: 6f76 6572 7928 6e61 6d65 732c 2064 6174  overy(names, dat
+0001e6d0: 6129 0a20 2020 2023 2065 6467 6573 3d73  a).    # edges=s
+0001e6e0: 656c 662e 6361 6c63 756c 6174 6577 6974  elf.calculatewit
+0001e6f0: 6850 6328 6e61 6d65 732c 6461 7461 290a  hPc(names,data).
+0001e700: 2020 2020 2320 6564 6765 733d 7365 6c66      # edges=self
+0001e710: 2e63 616c 6375 6c61 7465 7769 7468 5f66  .calculatewith_f
+0001e720: 6369 286e 616d 6573 2c64 6174 6129 0a20  ci(names,data). 
+0001e730: 2020 2023 2065 6467 6573 3d73 656c 662e     # edges=self.
+0001e740: 7361 6c65 7366 6f72 6365 5043 286e 616d  salesforcePC(nam
+0001e750: 6573 2c64 6174 6129 0a20 2020 2072 6574  es,data).    ret
+0001e760: 7572 6e20 6564 6765 733c 2f63 6f64 653e  urn edges</code>
+0001e770: 3c2f 7072 653e 0a3c 2f64 6574 6169 6c73  </pre>.</details
+0001e780: 3e0a 3c2f 6464 3e0a 3c64 7420 6964 3d22  >.</dd>.<dt id="
+0001e790: 5064 6d43 6f6e 7465 7874 2e43 6f6e 7465  PdmContext.Conte
+0001e7a0: 7874 4765 6e65 7261 7469 6f6e 2e43 6f6e  xtGeneration.Con
+0001e7b0: 7465 7874 4765 6e65 7261 746f 7242 6174  textGeneratorBat
+0001e7c0: 6368 2e63 616c 6375 6c61 7465 5f65 6467  ch.calculate_edg
+0001e7d0: 6573 223e 3c63 6f64 6520 636c 6173 733d  es"><code class=
+0001e7e0: 226e 616d 6520 666c 6578 223e 0a3c 7370  "name flex">.<sp
+0001e7f0: 616e 3e64 6566 203c 7370 616e 2063 6c61  an>def <span cla
+0001e800: 7373 3d22 6964 656e 7422 3e63 616c 6375  ss="ident">calcu
+0001e810: 6c61 7465 5f65 6467 6573 3c2f 7370 616e  late_edges</span
+0001e820: 3e3c 2f73 7061 6e3e 283c 7370 616e 3e73  ></span>(<span>s
+0001e830: 656c 662c 2061 6c6c 6461 7461 2c20 7469  elf, alldata, ti
+0001e840: 6d65 7374 616d 7029 3c2f 7370 616e 3e0a  mestamp)</span>.
+0001e850: 3c2f 636f 6465 3e3c 2f64 743e 0a3c 6464  </code></dt>.<dd
+0001e860: 3e0a 3c64 6976 2063 6c61 7373 3d22 6465  >.<div class="de
+0001e870: 7363 223e 3c2f 6469 763e 0a3c 6465 7461  sc"></div>.<deta
+0001e880: 696c 7320 636c 6173 733d 2273 6f75 7263  ils class="sourc
+0001e890: 6522 3e0a 3c73 756d 6d61 7279 3e0a 3c73  e">.<summary>.<s
+0001e8a0: 7061 6e3e 4578 7061 6e64 2073 6f75 7263  pan>Expand sourc
+0001e8b0: 6520 636f 6465 3c2f 7370 616e 3e0a 3c2f  e code</span>.</
+0001e8c0: 7375 6d6d 6172 793e 0a3c 7072 653e 3c63  summary>.<pre><c
+0001e8d0: 6f64 6520 636c 6173 733d 2270 7974 686f  ode class="pytho
+0001e8e0: 6e22 3e64 6566 2063 616c 6375 6c61 7465  n">def calculate
+0001e8f0: 5f65 6467 6573 2873 656c 662c 616c 6c64  _edges(self,alld
+0001e900: 6174 612c 2074 696d 6573 7461 6d70 293a  ata, timestamp):
+0001e910: 0a20 2020 2023 7374 6172 7420 3d20 7469  .    #start = ti
+0001e920: 6d65 2e74 696d 6528 290a 2020 2020 7374  me.time().    st
+0001e930: 6f72 696e 6720 3d20 7b7d 0a20 2020 2073  oring = {}.    s
+0001e940: 746f 7269 6e67 5b26 2333 343b 7469 6d65  toring[&#34;time
+0001e950: 7374 616d 7026 2333 343b 5d20 3d20 7469  stamp&#34;] = ti
+0001e960: 6d65 7374 616d 700a 0a20 2020 2061 6c6c  mestamp..    all
+0001e970: 6461 7461 5f6e 616d 6573 203d 205b 6e6e  data_names = [nn
+0001e980: 5b30 5d20 666f 7220 6e6e 2069 6e20 616c  [0] for nn in al
+0001e990: 6c64 6174 615d 0a20 2020 2061 6c6c 6461  ldata].    allda
+0001e9a0: 7461 5f64 6174 6120 3d20 5b6e 6e5b 315d  ta_data = [nn[1]
+0001e9b0: 2066 6f72 206e 6e20 696e 2061 6c6c 6461   for nn in allda
+0001e9c0: 7461 5d0a 0a20 2020 2066 6f72 206e 616d  ta]..    for nam
+0001e9d0: 6564 642c 2064 6174 6164 6420 696e 207a  edd, datadd in z
+0001e9e0: 6970 2861 6c6c 6461 7461 5f6e 616d 6573  ip(alldata_names
+0001e9f0: 2c20 616c 6c64 6174 615f 6461 7461 293a  , alldata_data):
+0001ea00: 0a20 2020 2020 2020 2073 746f 7269 6e67  .        storing
+0001ea10: 5b6e 616d 6564 645d 203d 2064 6174 6164  [namedd] = datad
+0001ea20: 640a 0a20 2020 2023 2046 6f72 2063 6f6e  d..    # For con
+0001ea30: 7465 7874 2077 6974 6820 6d6f 7265 2074  text with more t
+0001ea40: 6861 6e20 7477 6f20 7365 7269 6573 2063  han two series c
+0001ea50: 616c 6375 6c61 7465 2050 4320 6361 7375  alculate PC casu
+0001ea60: 616c 6974 6965 730a 2020 2020 636f 756e  alities.    coun
+0001ea70: 7420 3d20 6c65 6e28 5b31 2066 6f72 206c  t = len([1 for l
+0001ea80: 6973 7461 2069 6e20 616c 6c64 6174 615f  ista in alldata_
+0001ea90: 6461 7461 2069 6620 6c69 7374 6120 6973  data if lista is
+0001eaa0: 206e 6f74 204e 6f6e 655d 290a 2020 2020   not None]).    
+0001eab0: 6966 2063 6f75 6e74 2026 6774 3b20 3120  if count &gt; 1 
+0001eac0: 616e 6420 6c65 6e28 616c 6c64 6174 615b  and len(alldata[
+0001ead0: 305d 5b31 5d29 2026 6774 3b20 353a 0a20  0][1]) &gt; 5:. 
+0001eae0: 2020 2020 2020 2061 6c6c 6461 7461 5f6e         alldata_n
+0001eaf0: 616d 6573 203d 205b 6e6e 5b30 5d20 666f  ames = [nn[0] fo
+0001eb00: 7220 6e6e 2069 6e20 616c 6c64 6174 6120  r nn in alldata 
+0001eb10: 6966 206e 6e5b 315d 2069 7320 6e6f 7420  if nn[1] is not 
+0001eb20: 4e6f 6e65 2061 6e64 206c 656e 2873 6574  None and len(set
+0001eb30: 286e 6e5b 315d 2929 2667 743b 315d 0a20  (nn[1]))&gt;1]. 
+0001eb40: 2020 2020 2020 2061 6c6c 6461 7461 5f64         alldata_d
+0001eb50: 6174 6120 3d20 5b6e 6e5b 315d 2066 6f72  ata = [nn[1] for
+0001eb60: 206e 6e20 696e 2061 6c6c 6461 7461 2069   nn in alldata i
+0001eb70: 6620 6e6e 5b31 5d20 6973 206e 6f74 204e  f nn[1] is not N
+0001eb80: 6f6e 6520 616e 6420 6c65 6e28 7365 7428  one and len(set(
+0001eb90: 6e6e 5b31 5d29 2926 6774 3b31 5d0a 0a20  nn[1]))&gt;1].. 
+0001eba0: 2020 2020 2020 2023 656e 6420 3d20 7469         #end = ti
+0001ebb0: 6d65 2e74 696d 6528 290a 2020 2020 2020  me.time().      
+0001ebc0: 2020 2370 7269 6e74 2866 2623 3334 3b62    #print(f&#34;b
+0001ebd0: 6566 6f72 6520 7b65 6e64 202d 2073 7461  efore {end - sta
+0001ebe0: 7274 7d26 2333 343b 290a 2020 2020 2020  rt}&#34;).      
+0001ebf0: 2020 2373 7461 7274 3d74 696d 652e 7469    #start=time.ti
+0001ec00: 6d65 2829 0a0a 2020 2020 2020 2020 6966  me()..        if
+0001ec10: 206c 656e 2861 6c6c 6461 7461 2920 266c   len(alldata) &l
+0001ec20: 743b 3d20 313a 0a20 2020 2020 2020 2020  t;= 1:.         
+0001ec30: 2020 2065 6467 6573 203d 205b 5d0a 2020     edges = [].  
+0001ec40: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+0001ec50: 2020 2020 2020 2020 6564 6765 7320 3d20          edges = 
+0001ec60: 7365 6c66 2e63 616c 6375 6c61 7465 5f63  self.calculate_c
+0001ec70: 6175 7361 6c69 7479 286e 702e 636f 6c75  ausality(np.colu
+0001ec80: 6d6e 5f73 7461 636b 2861 6c6c 6461 7461  mn_stack(alldata
+0001ec90: 5f64 6174 6129 2c20 616c 6c64 6174 615f  _data), alldata_
+0001eca0: 6e61 6d65 7329 0a20 2020 2020 2020 2023  names).        #
+0001ecb0: 656e 643d 7469 6d65 2e74 696d 6528 290a  end=time.time().
+0001ecc0: 2020 2020 2020 2020 2370 7269 6e74 2866          #print(f
+0001ecd0: 2623 3334 3b61 6374 7561 6c20 6564 6765  &#34;actual edge
+0001ece0: 2063 616c 6375 6c61 7469 6f6e 207b 656e   calculation {en
+0001ecf0: 642d 7374 6172 747d 2623 3334 3b29 0a20  d-start}&#34;). 
+0001ed00: 2020 2020 2020 2069 6620 6564 6765 7320         if edges 
+0001ed10: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+0001ed20: 2020 2020 2073 696e 676c 6565 6467 6573       singleedges
+0001ed30: 203d 205b 5d0a 2020 2020 2020 2020 656c   = [].        el
+0001ed40: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+0001ed50: 7369 6e67 6c65 6564 6765 7320 3d20 6564  singleedges = ed
+0001ed60: 6765 730a 2020 2020 2020 2020 2320 7072  ges.        # pr
+0001ed70: 696e 7428 6564 6765 7329 0a20 2020 2020  int(edges).     
+0001ed80: 2020 2073 746f 7269 6e67 5b26 2333 343b     storing[&#34;
+0001ed90: 6564 6765 7326 2333 343b 5d20 3d20 7369  edges&#34;] = si
+0001eda0: 6e67 6c65 6564 6765 730a 2020 2020 2020  ngleedges.      
+0001edb0: 2020 7265 7475 726e 2073 746f 7269 6e67    return storing
+0001edc0: 0a20 2020 2073 746f 7269 6e67 5b26 2333  .    storing[&#3
+0001edd0: 343b 6564 6765 7326 2333 343b 5d20 3d20  4;edges&#34;] = 
+0001ede0: 5b5d 0a20 2020 2072 6574 7572 6e20 7374  [].    return st
+0001edf0: 6f72 696e 673c 2f63 6f64 653e 3c2f 7072  oring</code></pr
+0001ee00: 653e 0a3c 2f64 6574 6169 6c73 3e0a 3c2f  e>.</details>.</
+0001ee10: 6464 3e0a 3c64 7420 6964 3d22 5064 6d43  dd>.<dt id="PdmC
+0001ee20: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
+0001ee30: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
+0001ee40: 4765 6e65 7261 746f 7242 6174 6368 2e63  GeneratorBatch.c
+0001ee50: 7265 6174 655f 636f 6e74 6578 7422 3e3c  reate_context"><
+0001ee60: 636f 6465 2063 6c61 7373 3d22 6e61 6d65  code class="name
+0001ee70: 2066 6c65 7822 3e0a 3c73 7061 6e3e 6465   flex">.<span>de
+0001ee80: 6620 3c73 7061 6e20 636c 6173 733d 2269  f <span class="i
+0001ee90: 6465 6e74 223e 6372 6561 7465 5f63 6f6e  dent">create_con
+0001eea0: 7465 7874 3c2f 7370 616e 3e3c 2f73 7061  text</span></spa
+0001eeb0: 6e3e 283c 7370 616e 3e73 656c 662c 2064  n>(<span>self, d
+0001eec0: 6174 6574 696d 655f 696e 6465 7829 3c2f  atetime_index)</
+0001eed0: 7370 616e 3e0a 3c2f 636f 6465 3e3c 2f64  span>.</code></d
+0001eee0: 743e 0a3c 6464 3e0a 3c64 6976 2063 6c61  t>.<dd>.<div cla
+0001eef0: 7373 3d22 6465 7363 223e 3c2f 6469 763e  ss="desc"></div>
+0001ef00: 0a3c 6465 7461 696c 7320 636c 6173 733d  .<details class=
+0001ef10: 2273 6f75 7263 6522 3e0a 3c73 756d 6d61  "source">.<summa
+0001ef20: 7279 3e0a 3c73 7061 6e3e 4578 7061 6e64  ry>.<span>Expand
+0001ef30: 2073 6f75 7263 6520 636f 6465 3c2f 7370   source code</sp
+0001ef40: 616e 3e0a 3c2f 7375 6d6d 6172 793e 0a3c  an>.</summary>.<
+0001ef50: 7072 653e 3c63 6f64 6520 636c 6173 733d  pre><code class=
+0001ef60: 2270 7974 686f 6e22 3e64 6566 2063 7265  "python">def cre
+0001ef70: 6174 655f 636f 6e74 6578 7428 7365 6c66  ate_context(self
+0001ef80: 2c20 6461 7465 7469 6d65 5f69 6e64 6578  , datetime_index
+0001ef90: 293a 0a0a 2020 2020 7374 6172 745f 696e  ):..    start_in
+0001efa0: 6465 7820 3d20 6461 7465 7469 6d65 5f69  dex = datetime_i
+0001efb0: 6e64 6578 202d 2070 642e 5469 6d65 6465  ndex - pd.Timede
+0001efc0: 6c74 6128 7365 6c66 2e68 6f72 697a 6f6e  lta(self.horizon
+0001efd0: 2c20 7365 6c66 2e68 6f72 697a 6f6e 5f74  , self.horizon_t
+0001efe0: 696d 6529 0a0a 2020 2020 636f 6e74 6578  ime)..    contex
+0001eff0: 743d 7365 6c66 2e64 665f 6461 7461 2e6c  t=self.df_data.l
+0001f000: 6f63 5b73 7461 7274 5f69 6e64 6578 3a64  oc[start_index:d
+0001f010: 6174 6574 696d 655f 696e 6465 785d 0a0a  atetime_index]..
+0001f020: 2020 2020 616c 6c63 6f64 6573 203d 206e      allcodes = n
+0001f030: 702e 756e 6971 7565 2873 656c 662e 6466  p.unique(self.df
+0001f040: 5f64 6174 612e 636f 6c75 6d6e 7329 0a20  _data.columns). 
+0001f050: 2020 2061 6c6c 636f 6465 7320 3d20 5b63     allcodes = [c
+0001f060: 6f64 6520 666f 7220 636f 6465 2069 6e20  ode for code in 
+0001f070: 616c 6c63 6f64 6573 5d0a 2020 2020 616c  allcodes].    al
+0001f080: 6c63 6f64 6573 203d 2073 6574 2861 6c6c  lcodes = set(all
+0001f090: 636f 6465 7329 0a0a 2020 2020 2323 2062  codes)..    ## b
+0001f0a0: 7569 6c64 2074 6172 6765 7420 7365 7269  uild target seri
+0001f0b0: 6573 0a20 2020 2074 6172 6765 745f 7365  es.    target_se
+0001f0c0: 7269 6573 5f6e 616d 653d 2073 656c 662e  ries_name= self.
+0001f0d0: 7461 7267 6574 0a20 2020 2074 6172 6765  target.    targe
+0001f0e0: 745f 7365 7269 6573 3d63 6f6e 7465 7874  t_series=context
+0001f0f0: 5b73 656c 662e 7461 7267 6574 5d2e 7661  [self.target].va
+0001f100: 6c75 6573 0a0a 2020 2020 2323 2063 7265  lues..    ## cre
+0001f110: 6174 6520 7365 7269 6573 2066 6f72 2065  ate series for e
+0001f120: 6163 6820 736f 7572 6365 2028 616c 6c64  ach source (alld
+0001f130: 6174 6129 0a20 2020 2061 6c6c 6461 7461  ata).    alldata
+0001f140: 203d 205b 5d0a 2020 2020 666f 7220 636f   = [].    for co
+0001f150: 6c20 696e 2063 6f6e 7465 7874 2e63 6f6c  l in context.col
+0001f160: 756d 6e73 3a0a 2020 2020 2020 2020 616c  umns:.        al
+0001f170: 6c64 6174 612e 6170 7065 6e64 2828 636f  ldata.append((co
+0001f180: 6c2c 2063 6f6e 7465 7874 5b63 6f6c 5d2e  l, context[col].
+0001f190: 7661 6c75 6573 2929 0a20 2020 2023 2065  values)).    # e
+0001f1a0: 6e64 203d 2074 696d 652e 7469 6d65 2829  nd = time.time()
+0001f1b0: 0a20 2020 2023 2070 7269 6e74 2866 2623  .    # print(f&#
+0001f1c0: 3334 3b43 7265 6174 6520 7365 7269 6573  34;Create series
+0001f1d0: 3a20 7b65 6e64 2d73 7461 7274 7d26 2333  : {end-start}&#3
+0001f1e0: 343b 290a 0a20 2020 2073 746f 7269 6e67  4;)..    storing
+0001f1f0: 203d 2073 656c 662e 6361 6c63 756c 6174   = self.calculat
+0001f200: 655f 6564 6765 7328 616c 6c64 6174 612c  e_edges(alldata,
+0001f210: 2063 6f6e 7465 7874 2e69 6e64 6578 5b2d   context.index[-
+0001f220: 315d 290a 2020 2020 7374 6f72 696e 675b  1]).    storing[
+0001f230: 2623 3334 3b63 6861 7261 6374 6572 697a  &#34;characteriz
+0001f240: 6174 696f 6e26 2333 343b 5d20 3d20 7365  ation&#34;] = se
+0001f250: 6c66 2e67 6574 6361 7261 6374 6572 697a  lf.getcaracteriz
+0001f260: 6528 7374 6f72 696e 6729 0a0a 2020 2020  e(storing)..    
+0001f270: 2320 7072 696e 7428 6626 2333 343b 4361  # print(f&#34;Ca
+0001f280: 6c63 756c 6174 6520 6564 6765 733a 207b  lculate edges: {
+0001f290: 656e 6420 2d20 7374 6172 747d 2623 3334  end - start}&#34
+0001f2a0: 3b29 0a20 2020 2023 2070 7269 6e74 2826  ;).    # print(&
+0001f2b0: 2333 343b 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d  #34;============
+0001f2c0: 3d3d 3d3d 3d3d 3d3d 3d3d 3d3d 2623 3334  ============&#34
+0001f2d0: 3b29 0a0a 2020 2020 636f 6e74 6578 7470  ;)..    contextp
+0001f2e0: 626a 6563 7420 3d20 436f 6e74 6578 742e  bject = Context.
+0001f2f0: 636f 6e74 6578 745f 6672 6f6d 5f64 6963  context_from_dic
+0001f300: 7428 7374 6f72 696e 6729 0a20 2020 2072  t(storing).    r
+0001f310: 6574 7572 6e20 636f 6e74 6578 7470 626a  eturn contextpbj
+0001f320: 6563 742c 2074 6172 6765 745f 7365 7269  ect, target_seri
+0001f330: 6573 5f6e 616d 652c 636f 6e74 6578 742e  es_name,context.
+0001f340: 696e 6465 785b 2d31 5d3c 2f63 6f64 653e  index[-1]</code>
+0001f350: 3c2f 7072 653e 0a3c 2f64 6574 6169 6c73  </pre>.</details
+0001f360: 3e0a 3c2f 6464 3e0a 3c64 7420 6964 3d22  >.</dd>.<dt id="
+0001f370: 5064 6d43 6f6e 7465 7874 2e43 6f6e 7465  PdmContext.Conte
+0001f380: 7874 4765 6e65 7261 7469 6f6e 2e43 6f6e  xtGeneration.Con
+0001f390: 7465 7874 4765 6e65 7261 746f 7242 6174  textGeneratorBat
+0001f3a0: 6368 2e67 656e 6572 6174 655f 636f 6e74  ch.generate_cont
+0001f3b0: 6578 7422 3e3c 636f 6465 2063 6c61 7373  ext"><code class
+0001f3c0: 3d22 6e61 6d65 2066 6c65 7822 3e0a 3c73  ="name flex">.<s
+0001f3d0: 7061 6e3e 6465 6620 3c73 7061 6e20 636c  pan>def <span cl
+0001f3e0: 6173 733d 2269 6465 6e74 223e 6765 6e65  ass="ident">gene
+0001f3f0: 7261 7465 5f63 6f6e 7465 7874 3c2f 7370  rate_context</sp
+0001f400: 616e 3e3c 2f73 7061 6e3e 283c 7370 616e  an></span>(<span
+0001f410: 3e73 656c 662c 2064 6174 6574 696d 655f  >self, datetime_
+0001f420: 696e 6465 7829 3c2f 7370 616e 3e0a 3c2f  index)</span>.</
+0001f430: 636f 6465 3e3c 2f64 743e 0a3c 6464 3e0a  code></dt>.<dd>.
+0001f440: 3c64 6976 2063 6c61 7373 3d22 6465 7363  <div class="desc
+0001f450: 223e 3c2f 6469 763e 0a3c 6465 7461 696c  "></div>.<detail
+0001f460: 7320 636c 6173 733d 2273 6f75 7263 6522  s class="source"
+0001f470: 3e0a 3c73 756d 6d61 7279 3e0a 3c73 7061  >.<summary>.<spa
+0001f480: 6e3e 4578 7061 6e64 2073 6f75 7263 6520  n>Expand source 
+0001f490: 636f 6465 3c2f 7370 616e 3e0a 3c2f 7375  code</span>.</su
+0001f4a0: 6d6d 6172 793e 0a3c 7072 653e 3c63 6f64  mmary>.<pre><cod
+0001f4b0: 6520 636c 6173 733d 2270 7974 686f 6e22  e class="python"
+0001f4c0: 3e64 6566 2067 656e 6572 6174 655f 636f  >def generate_co
+0001f4d0: 6e74 6578 7428 7365 6c66 2c64 6174 6574  ntext(self,datet
+0001f4e0: 696d 655f 696e 6465 7829 3a0a 2020 2020  ime_index):.    
+0001f4f0: 636f 6e74 6578 7470 626a 6563 742c 2074  contextpbject, t
+0001f500: 6172 6765 745f 7365 7269 6573 5f6e 616d  arget_series_nam
+0001f510: 652c 7469 6d65 5f69 6e64 6578 3d73 656c  e,time_index=sel
+0001f520: 662e 6372 6561 7465 5f63 6f6e 7465 7874  f.create_context
+0001f530: 2864 6174 6574 696d 655f 696e 6465 7829  (datetime_index)
+0001f540: 0a0a 2020 2020 7365 6c66 2e63 6f6e 7465  ..    self.conte
+0001f550: 7874 735b 7469 6d65 5f69 6e64 6578 5d3d  xts[time_index]=
+0001f560: 636f 6e74 6578 7470 626a 6563 740a 0a20  contextpbject.. 
+0001f570: 2020 2072 6574 7572 6e20 636f 6e74 6578     return contex
+0001f580: 7470 626a 6563 743c 2f63 6f64 653e 3c2f  tpbject</code></
+0001f590: 7072 653e 0a3c 2f64 6574 6169 6c73 3e0a  pre>.</details>.
+0001f5a0: 3c2f 6464 3e0a 3c64 7420 6964 3d22 5064  </dd>.<dt id="Pd
+0001f5b0: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
+0001f5c0: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
+0001f5d0: 7874 4765 6e65 7261 746f 7242 6174 6368  xtGeneratorBatch
+0001f5e0: 2e67 6574 6361 7261 6374 6572 697a 6522  .getcaracterize"
+0001f5f0: 3e3c 636f 6465 2063 6c61 7373 3d22 6e61  ><code class="na
+0001f600: 6d65 2066 6c65 7822 3e0a 3c73 7061 6e3e  me flex">.<span>
+0001f610: 6465 6620 3c73 7061 6e20 636c 6173 733d  def <span class=
+0001f620: 2269 6465 6e74 223e 6765 7463 6172 6163  "ident">getcarac
+0001f630: 7465 7269 7a65 3c2f 7370 616e 3e3c 2f73  terize</span></s
+0001f640: 7061 6e3e 283c 7370 616e 3e73 656c 662c  pan>(<span>self,
+0001f650: 2063 6f6e 7465 7874 293c 2f73 7061 6e3e   context)</span>
+0001f660: 0a3c 2f63 6f64 653e 3c2f 6474 3e0a 3c64  .</code></dt>.<d
+0001f670: 643e 0a3c 6469 7620 636c 6173 733d 2264  d>.<div class="d
+0001f680: 6573 6322 3e3c 2f64 6976 3e0a 3c64 6574  esc"></div>.<det
+0001f690: 6169 6c73 2063 6c61 7373 3d22 736f 7572  ails class="sour
+0001f6a0: 6365 223e 0a3c 7375 6d6d 6172 793e 0a3c  ce">.<summary>.<
+0001f6b0: 7370 616e 3e45 7870 616e 6420 736f 7572  span>Expand sour
+0001f6c0: 6365 2063 6f64 653c 2f73 7061 6e3e 0a3c  ce code</span>.<
+0001f6d0: 2f73 756d 6d61 7279 3e0a 3c70 7265 3e3c  /summary>.<pre><
+0001f6e0: 636f 6465 2063 6c61 7373 3d22 7079 7468  code class="pyth
+0001f6f0: 6f6e 223e 6465 6620 6765 7463 6172 6163  on">def getcarac
+0001f700: 7465 7269 7a65 2873 656c 662c 636f 6e74  terize(self,cont
+0001f710: 6578 7429 3a0a 2020 2020 6564 6765 7320  ext):.    edges 
+0001f720: 3d20 636f 6e74 6578 745b 2623 3334 3b65  = context[&#34;e
+0001f730: 6467 6573 2623 3334 3b5d 0a20 2020 2063  dges&#34;].    c
+0001f740: 6861 7261 6374 6572 697a 6174 696f 6e73  haracterizations
+0001f750: 203d 205b 5d0a 2020 2020 666f 7220 6564   = [].    for ed
+0001f760: 6765 2069 6e20 6564 6765 733a 0a20 2020  ge in edges:.   
+0001f770: 2020 2020 206e 616d 6531 203d 2065 6467       name1 = edg
+0001f780: 655b 305d 0a20 2020 2020 2020 206e 616d  e[0].        nam
+0001f790: 6532 203d 2065 6467 655b 315d 0a20 2020  e2 = edge[1].   
+0001f7a0: 2020 2020 2076 616c 7565 7331 203d 2063       values1 = c
+0001f7b0: 6f6e 7465 7874 5b6e 616d 6531 5d0a 2020  ontext[name1].  
+0001f7c0: 2020 2020 2020 7661 6c75 6573 3220 3d20        values2 = 
+0001f7d0: 5b66 6c6f 6174 286b 6174 6929 2066 6f72  [float(kati) for
+0001f7e0: 206b 6174 6920 696e 2063 6f6e 7465 7874   kati in context
+0001f7f0: 5b6e 616d 6532 5d5d 0a0a 2020 2020 2020  [name2]]..      
+0001f800: 2020 6f63 6375 7265 6e63 653d 6c65 6e28    occurence=len(
+0001f810: 7661 6c75 6573 3129 2d31 0a20 2020 2020  values1)-1.     
+0001f820: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
+0001f830: 6528 6c65 6e28 7661 6c75 6573 3129 2d32  e(len(values1)-2
+0001f840: 2c30 2c2d 3129 3a0a 2020 2020 2020 2020  ,0,-1):.        
+0001f850: 2020 2020 6966 2076 616c 7565 7331 5b69      if values1[i
+0001f860: 5d20 213d 2076 616c 7565 7331 5b2d 315d  ] != values1[-1]
+0001f870: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+0001f880: 2020 6f63 6375 7265 6e63 6520 3d20 692b    occurence = i+
+0001f890: 310a 2020 2020 2020 2020 2020 2020 2020  1.              
+0001f8a0: 2020 6272 6561 6b0a 2020 2020 2020 2020    break.        
+0001f8b0: 7072 6576 6975 736f 6363 7572 656e 6365  previusoccurence
+0001f8c0: 203d 2030 0a20 2020 2020 2020 2066 6f72   = 0.        for
+0001f8d0: 2069 2069 6e20 7261 6e67 6528 6f63 6375   i in range(occu
+0001f8e0: 7265 6e63 652d 322c 302c 2d31 293a 0a20  rence-2,0,-1):. 
+0001f8f0: 2020 2020 2020 2020 2020 2069 6620 7661             if va
+0001f900: 6c75 6573 315b 695d 2021 3d20 2076 616c  lues1[i] !=  val
+0001f910: 7565 7331 5b6f 6363 7572 656e 6365 2d31  ues1[occurence-1
+0001f920: 5d3a 0a20 2020 2020 2020 2020 2020 2020  ]:.             
+0001f930: 2020 2070 7265 7669 7573 6f63 6375 7265     previusoccure
+0001f940: 6e63 6520 3d20 690a 0a20 2020 2020 2020  nce = i..       
+0001f950: 2069 6620 6f63 6375 7265 6e63 6520 2d20   if occurence - 
+0001f960: 7072 6576 6975 736f 6363 7572 656e 6365  previusoccurence
+0001f970: 2026 6c74 3b20 323a 2020 2320 6f72 206c   &lt; 2:  # or l
+0001f980: 656e 2876 616c 7565 7332 292d 6f63 6375  en(values2)-occu
+0001f990: 7265 6e63 6526 6c74 3b32 3a0a 2020 2020  rence&lt;2:.    
+0001f9a0: 2020 2020 2020 2020 6368 6172 6163 7465          characte
+0001f9b0: 7269 7a61 7469 6f6e 732e 6170 7065 6e64  rizations.append
+0001f9c0: 2826 2333 343b 756b 6e6f 776e 2623 3334  (&#34;uknown&#34
+0001f9d0: 3b29 0a20 2020 2020 2020 2020 2020 2063  ;).            c
+0001f9e0: 6f6e 7469 6e75 650a 2020 2020 2020 2020  ontinue.        
+0001f9f0: 7661 6c75 6573 3262 6566 6f72 6520 3d20  values2before = 
+0001fa00: 7661 6c75 6573 325b 7072 6576 6975 736f  values2[previuso
+0001fa10: 6363 7572 656e 6365 3a6f 6363 7572 656e  ccurence:occuren
+0001fa20: 6365 5d0a 2020 2020 2020 2020 2320 7374  ce].        # st
+0001fa30: 6476 203d 2073 7461 7469 7374 6963 732e  dv = statistics.
+0001fa40: 7374 6465 7628 7661 6c75 6573 3262 6566  stdev(values2bef
+0001fa50: 6f72 6529 0a20 2020 2020 2020 2023 206d  ore).        # m
+0001fa60: 6561 6e20 3d20 7374 6174 6973 7469 6373  ean = statistics
+0001fa70: 2e73 7464 6576 2876 616c 7565 7332 6265  .stdev(values2be
+0001fa80: 666f 7265 290a 2020 2020 2020 2020 2320  fore).        # 
+0001fa90: 7661 6c75 6573 3262 6566 6f72 653d 5b76  values2before=[v
+0001faa0: 2069 6620 7626 6c74 3b6d 6561 6e2b 352a   if v&lt;mean+5*
+0001fab0: 7374 6476 2065 6c73 6520 6d65 616e 2066  stdv else mean f
+0001fac0: 6f72 2076 2069 6e20 7661 6c75 6573 3262  or v in values2b
+0001fad0: 6566 6f72 655d 0a0a 2020 2020 2020 2020  efore]..        
+0001fae0: 2320 7661 6c75 6573 3261 6674 6572 3d76  # values2after=v
+0001faf0: 616c 7565 7332 5b6f 6363 7572 656e 6365  alues2[occurence
+0001fb00: 3a5d 0a20 2020 2020 2020 2076 616c 7565  :].        value
+0001fb10: 7332 6166 7465 7220 3d20 5b76 616c 7565  s2after = [value
+0001fb20: 7332 5b2d 315d 5d0a 2020 2020 2020 2020  s2[-1]].        
+0001fb30: 2320 7374 6476 203d 2073 7461 7469 7374  # stdv = statist
+0001fb40: 6963 732e 7374 6465 7628 7661 6c75 6573  ics.stdev(values
+0001fb50: 3261 6674 6572 290a 2020 2020 2020 2020  2after).        
+0001fb60: 2320 6d65 616e 203d 2073 7461 7469 7374  # mean = statist
+0001fb70: 6963 732e 7374 6465 7628 7661 6c75 6573  ics.stdev(values
+0001fb80: 3261 6674 6572 290a 2020 2020 2020 2020  2after).        
+0001fb90: 2320 7661 6c75 6573 3261 6674 6572 203d  # values2after =
+0001fba0: 205b 7620 6966 2076 2026 6c74 3b20 6d65   [v if v &lt; me
+0001fbb0: 616e 202b 2033 202a 2073 7464 7620 656c  an + 3 * stdv el
+0001fbc0: 7365 206d 6561 6e20 666f 7220 7620 696e  se mean for v in
+0001fbd0: 2076 616c 7565 7332 6166 7465 725d 0a0a   values2after]..
+0001fbe0: 2020 2020 2020 2020 7374 6476 203d 2073          stdv = s
+0001fbf0: 7461 7469 7374 6963 732e 7374 6465 7628  tatistics.stdev(
+0001fc00: 7661 6c75 6573 3262 6566 6f72 6529 0a20  values2before). 
+0001fc10: 2020 2020 2020 2069 6620 6c65 6e28 7661         if len(va
+0001fc20: 6c75 6573 3262 6566 6f72 6529 203d 3d20  lues2before) == 
+0001fc30: 303a 0a20 2020 2020 2020 2020 2020 2063  0:.            c
+0001fc40: 6861 7220 3d20 2623 3334 3b75 6b6e 6f77  har = &#34;uknow
+0001fc50: 6e26 2333 343b 0a20 2020 2020 2020 2065  n&#34;.        e
+0001fc60: 6c69 6620 7374 6174 6973 7469 6373 2e6d  lif statistics.m
+0001fc70: 6564 6961 6e28 7661 6c75 6573 3262 6566  edian(values2bef
+0001fc80: 6f72 6529 202d 2073 7461 7469 7374 6963  ore) - statistic
+0001fc90: 732e 6d65 6469 616e 2876 616c 7565 7332  s.median(values2
+0001fca0: 6166 7465 7229 2026 6774 3b20 3220 2a20  after) &gt; 2 * 
+0001fcb0: 7374 6476 3a0a 2020 2020 2020 2020 2020  stdv:.          
+0001fcc0: 2020 6368 6172 203d 2026 2333 343b 6465    char = &#34;de
+0001fcd0: 6372 6561 7365 2623 3334 3b0a 2020 2020  crease&#34;.    
+0001fce0: 2020 2020 656c 6966 2073 7461 7469 7374      elif statist
+0001fcf0: 6963 732e 6d65 6469 616e 2876 616c 7565  ics.median(value
+0001fd00: 7332 6166 7465 7229 202d 2073 7461 7469  s2after) - stati
+0001fd10: 7374 6963 732e 6d65 6469 616e 2876 616c  stics.median(val
+0001fd20: 7565 7332 6265 666f 7265 2920 2667 743b  ues2before) &gt;
+0001fd30: 2032 202a 2073 7464 763a 0a20 2020 2020   2 * stdv:.     
+0001fd40: 2020 2020 2020 2063 6861 7220 3d20 2623         char = &#
+0001fd50: 3334 3b69 6e63 7265 6173 6526 2333 343b  34;increase&#34;
+0001fd60: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
+0001fd70: 2020 2020 2020 2020 2020 2063 6861 7220             char 
+0001fd80: 3d20 2623 3334 3b75 6b6e 6f77 6e26 2333  = &#34;uknown&#3
+0001fd90: 343b 0a20 2020 2020 2020 2063 6861 7261  4;.        chara
+0001fda0: 6374 6572 697a 6174 696f 6e73 2e61 7070  cterizations.app
+0001fdb0: 656e 6428 6368 6172 290a 2020 2020 7265  end(char).    re
+0001fdc0: 7475 726e 2063 6861 7261 6374 6572 697a  turn characteriz
+0001fdd0: 6174 696f 6e73 3c2f 636f 6465 3e3c 2f70  ations</code></p
+0001fde0: 7265 3e0a 3c2f 6465 7461 696c 733e 0a3c  re>.</details>.<
+0001fdf0: 2f64 643e 0a3c 2f64 6c3e 0a3c 2f64 643e  /dd>.</dl>.</dd>
+0001fe00: 0a3c 2f64 6c3e 0a3c 2f73 6563 7469 6f6e  .</dl>.</section
+0001fe10: 3e0a 3c2f 6172 7469 636c 653e 0a3c 6e61  >.</article>.<na
+0001fe20: 7620 6964 3d22 7369 6465 6261 7222 3e0a  v id="sidebar">.
+0001fe30: 3c68 313e 496e 6465 783c 2f68 313e 0a3c  <h1>Index</h1>.<
+0001fe40: 6469 7620 636c 6173 733d 2274 6f63 223e  div class="toc">
+0001fe50: 0a3c 756c 3e3c 2f75 6c3e 0a3c 2f64 6976  .<ul></ul>.</div
+0001fe60: 3e0a 3c75 6c20 6964 3d22 696e 6465 7822  >.<ul id="index"
+0001fe70: 3e0a 3c6c 693e 3c68 333e 5375 7065 722d  >.<li><h3>Super-
+0001fe80: 6d6f 6475 6c65 3c2f 6833 3e0a 3c75 6c3e  module</h3>.<ul>
+0001fe90: 0a3c 6c69 3e3c 636f 6465 3e3c 6120 7469  .<li><code><a ti
+0001fea0: 746c 653d 2250 646d 436f 6e74 6578 7422  tle="PdmContext"
+0001feb0: 2068 7265 663d 2269 6e64 6578 2e68 746d   href="index.htm
+0001fec0: 6c22 3e50 646d 436f 6e74 6578 743c 2f61  l">PdmContext</a
+0001fed0: 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a 3c2f  ></code></li>.</
+0001fee0: 756c 3e0a 3c2f 6c69 3e0a 3c6c 693e 3c68  ul>.</li>.<li><h
+0001fef0: 333e 3c61 2068 7265 663d 2223 6865 6164  3><a href="#head
+0001ff00: 6572 2d63 6c61 7373 6573 223e 436c 6173  er-classes">Clas
+0001ff10: 7365 733c 2f61 3e3c 2f68 333e 0a3c 756c  ses</a></h3>.<ul
+0001ff20: 3e0a 3c6c 693e 0a3c 6834 3e3c 636f 6465  >.<li>.<h4><code
+0001ff30: 3e3c 6120 7469 746c 653d 2250 646d 436f  ><a title="PdmCo
+0001ff40: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+0001ff50: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+0001ff60: 656e 6572 6174 6f72 2220 6872 6566 3d22  enerator" href="
+0001ff70: 2350 646d 436f 6e74 6578 742e 436f 6e74  #PdmContext.Cont
+0001ff80: 6578 7447 656e 6572 6174 696f 6e2e 436f  extGeneration.Co
+0001ff90: 6e74 6578 7447 656e 6572 6174 6f72 223e  ntextGenerator">
+0001ffa0: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+0001ffb0: 3c2f 613e 3c2f 636f 6465 3e3c 2f68 343e  </a></code></h4>
+0001ffc0: 0a3c 756c 2063 6c61 7373 3d22 223e 0a3c  .<ul class="">.<
+0001ffd0: 6c69 3e3c 636f 6465 3e3c 6120 7469 746c  li><code><a titl
+0001ffe0: 653d 2250 646d 436f 6e74 6578 742e 436f  e="PdmContext.Co
+0001fff0: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+00020000: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+00020010: 2e4e 756d 7079 5f70 7265 7072 6f63 6365  .Numpy_preprocce
+00020020: 7373 2220 6872 6566 3d22 2350 646d 436f  ss" href="#PdmCo
+00020030: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+00020040: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+00020050: 656e 6572 6174 6f72 2e4e 756d 7079 5f70  enerator.Numpy_p
+00020060: 7265 7072 6f63 6365 7373 223e 4e75 6d70  reproccess">Nump
+00020070: 795f 7072 6570 726f 6363 6573 733c 2f61  y_preproccess</a
+00020080: 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a 3c6c  ></code></li>.<l
+00020090: 693e 3c63 6f64 653e 3c61 2074 6974 6c65  i><code><a title
+000200a0: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+000200b0: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+000200c0: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
+000200d0: 6164 645f 746f 5f62 7566 6665 7222 2068  add_to_buffer" h
+000200e0: 7265 663d 2223 5064 6d43 6f6e 7465 7874  ref="#PdmContext
+000200f0: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+00020100: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+00020110: 746f 722e 6164 645f 746f 5f62 7566 6665  tor.add_to_buffe
+00020120: 7222 3e61 6464 5f74 6f5f 6275 6666 6572  r">add_to_buffer
+00020130: 3c2f 613e 3c2f 636f 6465 3e3c 2f6c 693e  </a></code></li>
+00020140: 0a3c 6c69 3e3c 636f 6465 3e3c 6120 7469  .<li><code><a ti
+00020150: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
+00020160: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
+00020170: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
+00020180: 6f72 2e62 7569 6c64 5f63 6f6e 7465 7874  or.build_context
+00020190: 5f66 6f72 5f63 6f6e 6669 7567 7572 6174  _for_confiugurat
+000201a0: 696f 6e22 2068 7265 663d 2223 5064 6d43  ion" href="#PdmC
+000201b0: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
+000201c0: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
+000201d0: 4765 6e65 7261 746f 722e 6275 696c 645f  Generator.build_
+000201e0: 636f 6e74 6578 745f 666f 725f 636f 6e66  context_for_conf
+000201f0: 6975 6775 7261 7469 6f6e 223e 6275 696c  iuguration">buil
+00020200: 645f 636f 6e74 6578 745f 666f 725f 636f  d_context_for_co
+00020210: 6e66 6975 6775 7261 7469 6f6e 3c2f 613e  nfiuguration</a>
+00020220: 3c2f 636f 6465 3e3c 2f6c 693e 0a3c 6c69  </code></li>.<li
+00020230: 3e3c 636f 6465 3e3c 6120 7469 746c 653d  ><code><a title=
+00020240: 2250 646d 436f 6e74 6578 742e 436f 6e74  "PdmContext.Cont
+00020250: 6578 7447 656e 6572 6174 696f 6e2e 436f  extGeneration.Co
+00020260: 6e74 6578 7447 656e 6572 6174 6f72 2e62  ntextGenerator.b
+00020270: 7569 6c64 5f63 6f6e 7465 7874 5f66 6f72  uild_context_for
+00020280: 5f69 736f 6c61 7465 6422 2068 7265 663d  _isolated" href=
+00020290: 2223 5064 6d43 6f6e 7465 7874 2e43 6f6e  "#PdmContext.Con
+000202a0: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+000202b0: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
+000202c0: 6275 696c 645f 636f 6e74 6578 745f 666f  build_context_fo
+000202d0: 725f 6973 6f6c 6174 6564 223e 6275 696c  r_isolated">buil
+000202e0: 645f 636f 6e74 6578 745f 666f 725f 6973  d_context_for_is
+000202f0: 6f6c 6174 6564 3c2f 613e 3c2f 636f 6465  olated</a></code
+00020300: 3e3c 2f6c 693e 0a3c 6c69 3e3c 636f 6465  ></li>.<li><code
+00020310: 3e3c 6120 7469 746c 653d 2250 646d 436f  ><a title="PdmCo
+00020320: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+00020330: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+00020340: 656e 6572 6174 6f72 2e62 7569 6c64 5f63  enerator.build_c
+00020350: 6f6e 7465 7874 5f66 6f72 5f75 6e69 7661  ontext_for_univa
+00020360: 7269 6174 6522 2068 7265 663d 2223 5064  riate" href="#Pd
+00020370: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
+00020380: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
+00020390: 7874 4765 6e65 7261 746f 722e 6275 696c  xtGenerator.buil
+000203a0: 645f 636f 6e74 6578 745f 666f 725f 756e  d_context_for_un
+000203b0: 6976 6172 6961 7465 223e 6275 696c 645f  ivariate">build_
+000203c0: 636f 6e74 6578 745f 666f 725f 756e 6976  context_for_univ
+000203d0: 6172 6961 7465 3c2f 613e 3c2f 636f 6465  ariate</a></code
+000203e0: 3e3c 2f6c 693e 0a3c 6c69 3e3c 636f 6465  ></li>.<li><code
+000203f0: 3e3c 6120 7469 746c 653d 2250 646d 436f  ><a title="PdmCo
+00020400: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+00020410: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+00020420: 656e 6572 6174 6f72 2e62 7569 6c64 5f74  enerator.build_t
+00020430: 6172 6765 745f 7365 7269 6573 5f66 6f72  arget_series_for
+00020440: 5f63 6f6e 7465 7874 2220 6872 6566 3d22  _context" href="
+00020450: 2350 646d 436f 6e74 6578 742e 436f 6e74  #PdmContext.Cont
+00020460: 6578 7447 656e 6572 6174 696f 6e2e 436f  extGeneration.Co
+00020470: 6e74 6578 7447 656e 6572 6174 6f72 2e62  ntextGenerator.b
+00020480: 7569 6c64 5f74 6172 6765 745f 7365 7269  uild_target_seri
+00020490: 6573 5f66 6f72 5f63 6f6e 7465 7874 223e  es_for_context">
+000204a0: 6275 696c 645f 7461 7267 6574 5f73 6572  build_target_ser
+000204b0: 6965 735f 666f 725f 636f 6e74 6578 743c  ies_for_context<
+000204c0: 2f61 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a  /a></code></li>.
+000204d0: 3c6c 693e 3c63 6f64 653e 3c61 2074 6974  <li><code><a tit
+000204e0: 6c65 3d22 5064 6d43 6f6e 7465 7874 2e43  le="PdmContext.C
+000204f0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
+00020500: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
+00020510: 722e 6361 6c63 756c 6174 655f 6361 7573  r.calculate_caus
+00020520: 616c 6974 7922 2068 7265 663d 2223 5064  ality" href="#Pd
+00020530: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
+00020540: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
+00020550: 7874 4765 6e65 7261 746f 722e 6361 6c63  xtGenerator.calc
+00020560: 756c 6174 655f 6361 7573 616c 6974 7922  ulate_causality"
+00020570: 3e63 616c 6375 6c61 7465 5f63 6175 7361  >calculate_causa
+00020580: 6c69 7479 3c2f 613e 3c2f 636f 6465 3e3c  lity</a></code><
+00020590: 2f6c 693e 0a3c 6c69 3e3c 636f 6465 3e3c  /li>.<li><code><
+000205a0: 6120 7469 746c 653d 2250 646d 436f 6e74  a title="PdmCont
+000205b0: 6578 742e 436f 6e74 6578 7447 656e 6572  ext.ContextGener
+000205c0: 6174 696f 6e2e 436f 6e74 6578 7447 656e  ation.ContextGen
+000205d0: 6572 6174 6f72 2e63 616c 6375 6c61 7465  erator.calculate
+000205e0: 5f65 6467 6573 2220 6872 6566 3d22 2350  _edges" href="#P
+000205f0: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
+00020600: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
+00020610: 6578 7447 656e 6572 6174 6f72 2e63 616c  extGenerator.cal
+00020620: 6375 6c61 7465 5f65 6467 6573 223e 6361  culate_edges">ca
+00020630: 6c63 756c 6174 655f 6564 6765 733c 2f61  lculate_edges</a
+00020640: 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a 3c6c  ></code></li>.<l
+00020650: 693e 3c63 6f64 653e 3c61 2074 6974 6c65  i><code><a title
+00020660: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+00020670: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+00020680: 6f6e 7465 7874 4765 6e65 7261 746f 722e  ontextGenerator.
+00020690: 6368 6172 6163 7465 7269 7a65 5f65 7665  characterize_eve
+000206a0: 6e74 5f63 6f6e 7469 6e75 6f75 7322 2068  nt_continuous" h
+000206b0: 7265 663d 2223 5064 6d43 6f6e 7465 7874  ref="#PdmContext
+000206c0: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+000206d0: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+000206e0: 746f 722e 6368 6172 6163 7465 7269 7a65  tor.characterize
+000206f0: 5f65 7665 6e74 5f63 6f6e 7469 6e75 6f75  _event_continuou
+00020700: 7322 3e63 6861 7261 6374 6572 697a 655f  s">characterize_
+00020710: 6576 656e 745f 636f 6e74 696e 756f 7573  event_continuous
+00020720: 3c2f 613e 3c2f 636f 6465 3e3c 2f6c 693e  </a></code></li>
+00020730: 0a3c 6c69 3e3c 636f 6465 3e3c 6120 7469  .<li><code><a ti
+00020740: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
+00020750: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
+00020760: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
+00020770: 6f72 2e63 6861 7261 6374 6572 697a 655f  or.characterize_
+00020780: 6576 656e 745f 6564 6765 2220 6872 6566  event_edge" href
+00020790: 3d22 2350 646d 436f 6e74 6578 742e 436f  ="#PdmContext.Co
+000207a0: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+000207b0: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+000207c0: 2e63 6861 7261 6374 6572 697a 655f 6576  .characterize_ev
+000207d0: 656e 745f 6564 6765 223e 6368 6172 6163  ent_edge">charac
+000207e0: 7465 7269 7a65 5f65 7665 6e74 5f65 6467  terize_event_edg
+000207f0: 653c 2f61 3e3c 2f63 6f64 653e 3c2f 6c69  e</a></code></li
+00020800: 3e0a 3c6c 693e 3c63 6f64 653e 3c61 2074  >.<li><code><a t
+00020810: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
+00020820: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+00020830: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+00020840: 746f 722e 636f 6c6c 6563 745f 6461 7461  tor.collect_data
+00020850: 2220 6872 6566 3d22 2350 646d 436f 6e74  " href="#PdmCont
+00020860: 6578 742e 436f 6e74 6578 7447 656e 6572  ext.ContextGener
+00020870: 6174 696f 6e2e 436f 6e74 6578 7447 656e  ation.ContextGen
+00020880: 6572 6174 6f72 2e63 6f6c 6c65 6374 5f64  erator.collect_d
+00020890: 6174 6122 3e63 6f6c 6c65 6374 5f64 6174  ata">collect_dat
+000208a0: 613c 2f61 3e3c 2f63 6f64 653e 3c2f 6c69  a</a></code></li
+000208b0: 3e0a 3c6c 693e 3c63 6f64 653e 3c61 2074  >.<li><code><a t
+000208c0: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
+000208d0: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+000208e0: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+000208f0: 746f 722e 6372 6561 7465 5f63 6f6e 7465  tor.create_conte
+00020900: 7874 2220 6872 6566 3d22 2350 646d 436f  xt" href="#PdmCo
+00020910: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+00020920: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+00020930: 656e 6572 6174 6f72 2e63 7265 6174 655f  enerator.create_
+00020940: 636f 6e74 6578 7422 3e63 7265 6174 655f  context">create_
+00020950: 636f 6e74 6578 743c 2f61 3e3c 2f63 6f64  context</a></cod
+00020960: 653e 3c2f 6c69 3e0a 3c6c 693e 3c63 6f64  e></li>.<li><cod
+00020970: 653e 3c61 2074 6974 6c65 3d22 5064 6d43  e><a title="PdmC
+00020980: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
+00020990: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
+000209a0: 4765 6e65 7261 746f 722e 6372 6561 7465  Generator.create
+000209b0: 5f63 6f6e 7469 6e75 6f75 735f 7265 7072  _continuous_repr
+000209c0: 6573 656e 7461 7469 6f6e 2220 6872 6566  esentation" href
+000209d0: 3d22 2350 646d 436f 6e74 6578 742e 436f  ="#PdmContext.Co
+000209e0: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+000209f0: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+00020a00: 2e63 7265 6174 655f 636f 6e74 696e 756f  .create_continuo
+00020a10: 7573 5f72 6570 7265 7365 6e74 6174 696f  us_representatio
+00020a20: 6e22 3e63 7265 6174 655f 636f 6e74 696e  n">create_contin
+00020a30: 756f 7573 5f72 6570 7265 7365 6e74 6174  uous_representat
+00020a40: 696f 6e3c 2f61 3e3c 2f63 6f64 653e 3c2f  ion</a></code></
+00020a50: 6c69 3e0a 3c6c 693e 3c63 6f64 653e 3c61  li>.<li><code><a
+00020a60: 2074 6974 6c65 3d22 5064 6d43 6f6e 7465   title="PdmConte
+00020a70: 7874 2e43 6f6e 7465 7874 4765 6e65 7261  xt.ContextGenera
+00020a80: 7469 6f6e 2e43 6f6e 7465 7874 4765 6e65  tion.ContextGene
+00020a90: 7261 746f 722e 6372 6561 7465 5f69 6e74  rator.create_int
+00020aa0: 6572 7072 6574 6174 696f 6e22 2068 7265  erpretation" hre
+00020ab0: 663d 2223 5064 6d43 6f6e 7465 7874 2e43  f="#PdmContext.C
+00020ac0: 6f6e 7465 7874 4765 6e65 7261 7469 6f6e  ontextGeneration
+00020ad0: 2e43 6f6e 7465 7874 4765 6e65 7261 746f  .ContextGenerato
+00020ae0: 722e 6372 6561 7465 5f69 6e74 6572 7072  r.create_interpr
+00020af0: 6574 6174 696f 6e22 3e63 7265 6174 655f  etation">create_
+00020b00: 696e 7465 7270 7265 7461 7469 6f6e 3c2f  interpretation</
+00020b10: 613e 3c2f 636f 6465 3e3c 2f6c 693e 0a3c  a></code></li>.<
+00020b20: 6c69 3e3c 636f 6465 3e3c 6120 7469 746c  li><code><a titl
+00020b30: 653d 2250 646d 436f 6e74 6578 742e 436f  e="PdmContext.Co
+00020b40: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+00020b50: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+00020b60: 2e67 656e 6572 6174 655f 636f 6e74 6578  .generate_contex
+00020b70: 7422 2068 7265 663d 2223 5064 6d43 6f6e  t" href="#PdmCon
+00020b80: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
+00020b90: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
+00020ba0: 6e65 7261 746f 722e 6765 6e65 7261 7465  nerator.generate
+00020bb0: 5f63 6f6e 7465 7874 223e 6765 6e65 7261  _context">genera
+00020bc0: 7465 5f63 6f6e 7465 7874 3c2f 613e 3c2f  te_context</a></
+00020bd0: 636f 6465 3e3c 2f6c 693e 0a3c 6c69 3e3c  code></li>.<li><
+00020be0: 636f 6465 3e3c 6120 7469 746c 653d 2250  code><a title="P
+00020bf0: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
+00020c00: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
+00020c10: 6578 7447 656e 6572 6174 6f72 2e67 6574  extGenerator.get
+00020c20: 5f63 6861 7261 6374 6572 697a 6174 696f  _characterizatio
+00020c30: 6e22 2068 7265 663d 2223 5064 6d43 6f6e  n" href="#PdmCon
+00020c40: 7465 7874 2e43 6f6e 7465 7874 4765 6e65  text.ContextGene
+00020c50: 7261 7469 6f6e 2e43 6f6e 7465 7874 4765  ration.ContextGe
+00020c60: 6e65 7261 746f 722e 6765 745f 6368 6172  nerator.get_char
+00020c70: 6163 7465 7269 7a61 7469 6f6e 223e 6765  acterization">ge
+00020c80: 745f 6368 6172 6163 7465 7269 7a61 7469  t_characterizati
+00020c90: 6f6e 3c2f 613e 3c2f 636f 6465 3e3c 2f6c  on</a></code></l
+00020ca0: 693e 0a3c 6c69 3e3c 636f 6465 3e3c 6120  i>.<li><code><a 
+00020cb0: 7469 746c 653d 2250 646d 436f 6e74 6578  title="PdmContex
+00020cc0: 742e 436f 6e74 6578 7447 656e 6572 6174  t.ContextGenerat
+00020cd0: 696f 6e2e 436f 6e74 6578 7447 656e 6572  ion.ContextGener
+00020ce0: 6174 6f72 2e69 6e74 6572 7072 6574 2220  ator.interpret" 
+00020cf0: 6872 6566 3d22 2350 646d 436f 6e74 6578  href="#PdmContex
+00020d00: 742e 436f 6e74 6578 7447 656e 6572 6174  t.ContextGenerat
+00020d10: 696f 6e2e 436f 6e74 6578 7447 656e 6572  ion.ContextGener
+00020d20: 6174 6f72 2e69 6e74 6572 7072 6574 223e  ator.interpret">
+00020d30: 696e 7465 7270 7265 743c 2f61 3e3c 2f63  interpret</a></c
+00020d40: 6f64 653e 3c2f 6c69 3e0a 3c6c 693e 3c63  ode></li>.<li><c
+00020d50: 6f64 653e 3c61 2074 6974 6c65 3d22 5064  ode><a title="Pd
+00020d60: 6d43 6f6e 7465 7874 2e43 6f6e 7465 7874  mContext.Context
+00020d70: 4765 6e65 7261 7469 6f6e 2e43 6f6e 7465  Generation.Conte
+00020d80: 7874 4765 6e65 7261 746f 722e 706c 6f74  xtGenerator.plot
+00020d90: 2220 6872 6566 3d22 2350 646d 436f 6e74  " href="#PdmCont
+00020da0: 6578 742e 436f 6e74 6578 7447 656e 6572  ext.ContextGener
+00020db0: 6174 696f 6e2e 436f 6e74 6578 7447 656e  ation.ContextGen
+00020dc0: 6572 6174 6f72 2e70 6c6f 7422 3e70 6c6f  erator.plot">plo
+00020dd0: 743c 2f61 3e3c 2f63 6f64 653e 3c2f 6c69  t</a></code></li
+00020de0: 3e0a 3c6c 693e 3c63 6f64 653e 3c61 2074  >.<li><code><a t
+00020df0: 6974 6c65 3d22 5064 6d43 6f6e 7465 7874  itle="PdmContext
+00020e00: 2e43 6f6e 7465 7874 4765 6e65 7261 7469  .ContextGenerati
+00020e10: 6f6e 2e43 6f6e 7465 7874 4765 6e65 7261  on.ContextGenera
+00020e20: 746f 722e 706c 6f74 5f69 6e74 6572 7072  tor.plot_interpr
+00020e30: 6574 6174 696f 6e22 2068 7265 663d 2223  etation" href="#
+00020e40: 5064 6d43 6f6e 7465 7874 2e43 6f6e 7465  PdmContext.Conte
+00020e50: 7874 4765 6e65 7261 7469 6f6e 2e43 6f6e  xtGeneration.Con
+00020e60: 7465 7874 4765 6e65 7261 746f 722e 706c  textGenerator.pl
+00020e70: 6f74 5f69 6e74 6572 7072 6574 6174 696f  ot_interpretatio
+00020e80: 6e22 3e70 6c6f 745f 696e 7465 7270 7265  n">plot_interpre
+00020e90: 7461 7469 6f6e 3c2f 613e 3c2f 636f 6465  tation</a></code
+00020ea0: 3e3c 2f6c 693e 0a3c 2f75 6c3e 0a3c 2f6c  ></li>.</ul>.</l
+00020eb0: 693e 0a3c 6c69 3e0a 3c68 343e 3c63 6f64  i>.<li>.<h4><cod
+00020ec0: 653e 3c61 2074 6974 6c65 3d22 5064 6d43  e><a title="PdmC
+00020ed0: 6f6e 7465 7874 2e43 6f6e 7465 7874 4765  ontext.ContextGe
+00020ee0: 6e65 7261 7469 6f6e 2e43 6f6e 7465 7874  neration.Context
+00020ef0: 4765 6e65 7261 746f 7242 6174 6368 2220  GeneratorBatch" 
+00020f00: 6872 6566 3d22 2350 646d 436f 6e74 6578  href="#PdmContex
+00020f10: 742e 436f 6e74 6578 7447 656e 6572 6174  t.ContextGenerat
+00020f20: 696f 6e2e 436f 6e74 6578 7447 656e 6572  ion.ContextGener
+00020f30: 6174 6f72 4261 7463 6822 3e43 6f6e 7465  atorBatch">Conte
+00020f40: 7874 4765 6e65 7261 746f 7242 6174 6368  xtGeneratorBatch
+00020f50: 3c2f 613e 3c2f 636f 6465 3e3c 2f68 343e  </a></code></h4>
+00020f60: 0a3c 756c 2063 6c61 7373 3d22 223e 0a3c  .<ul class="">.<
+00020f70: 6c69 3e3c 636f 6465 3e3c 6120 7469 746c  li><code><a titl
+00020f80: 653d 2250 646d 436f 6e74 6578 742e 436f  e="PdmContext.Co
+00020f90: 6e74 6578 7447 656e 6572 6174 696f 6e2e  ntextGeneration.
+00020fa0: 436f 6e74 6578 7447 656e 6572 6174 6f72  ContextGenerator
+00020fb0: 4261 7463 682e 6361 6c63 756c 6174 655f  Batch.calculate_
+00020fc0: 6361 7573 616c 6974 7922 2068 7265 663d  causality" href=
+00020fd0: 2223 5064 6d43 6f6e 7465 7874 2e43 6f6e  "#PdmContext.Con
+00020fe0: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+00020ff0: 6f6e 7465 7874 4765 6e65 7261 746f 7242  ontextGeneratorB
+00021000: 6174 6368 2e63 616c 6375 6c61 7465 5f63  atch.calculate_c
+00021010: 6175 7361 6c69 7479 223e 6361 6c63 756c  ausality">calcul
+00021020: 6174 655f 6361 7573 616c 6974 793c 2f61  ate_causality</a
+00021030: 3e3c 2f63 6f64 653e 3c2f 6c69 3e0a 3c6c  ></code></li>.<l
+00021040: 693e 3c63 6f64 653e 3c61 2074 6974 6c65  i><code><a title
+00021050: 3d22 5064 6d43 6f6e 7465 7874 2e43 6f6e  ="PdmContext.Con
+00021060: 7465 7874 4765 6e65 7261 7469 6f6e 2e43  textGeneration.C
+00021070: 6f6e 7465 7874 4765 6e65 7261 746f 7242  ontextGeneratorB
+00021080: 6174 6368 2e63 616c 6375 6c61 7465 5f65  atch.calculate_e
+00021090: 6467 6573 2220 6872 6566 3d22 2350 646d  dges" href="#Pdm
+000210a0: 436f 6e74 6578 742e 436f 6e74 6578 7447  Context.ContextG
+000210b0: 656e 6572 6174 696f 6e2e 436f 6e74 6578  eneration.Contex
+000210c0: 7447 656e 6572 6174 6f72 4261 7463 682e  tGeneratorBatch.
+000210d0: 6361 6c63 756c 6174 655f 6564 6765 7322  calculate_edges"
+000210e0: 3e63 616c 6375 6c61 7465 5f65 6467 6573  >calculate_edges
+000210f0: 3c2f 613e 3c2f 636f 6465 3e3c 2f6c 693e  </a></code></li>
+00021100: 0a3c 6c69 3e3c 636f 6465 3e3c 6120 7469  .<li><code><a ti
+00021110: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
+00021120: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
+00021130: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
+00021140: 6f72 4261 7463 682e 6372 6561 7465 5f63  orBatch.create_c
+00021150: 6f6e 7465 7874 2220 6872 6566 3d22 2350  ontext" href="#P
+00021160: 646d 436f 6e74 6578 742e 436f 6e74 6578  dmContext.Contex
+00021170: 7447 656e 6572 6174 696f 6e2e 436f 6e74  tGeneration.Cont
+00021180: 6578 7447 656e 6572 6174 6f72 4261 7463  extGeneratorBatc
+00021190: 682e 6372 6561 7465 5f63 6f6e 7465 7874  h.create_context
+000211a0: 223e 6372 6561 7465 5f63 6f6e 7465 7874  ">create_context
+000211b0: 3c2f 613e 3c2f 636f 6465 3e3c 2f6c 693e  </a></code></li>
+000211c0: 0a3c 6c69 3e3c 636f 6465 3e3c 6120 7469  .<li><code><a ti
+000211d0: 746c 653d 2250 646d 436f 6e74 6578 742e  tle="PdmContext.
+000211e0: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
+000211f0: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
+00021200: 6f72 4261 7463 682e 6765 6e65 7261 7465  orBatch.generate
+00021210: 5f63 6f6e 7465 7874 2220 6872 6566 3d22  _context" href="
+00021220: 2350 646d 436f 6e74 6578 742e 436f 6e74  #PdmContext.Cont
+00021230: 6578 7447 656e 6572 6174 696f 6e2e 436f  extGeneration.Co
+00021240: 6e74 6578 7447 656e 6572 6174 6f72 4261  ntextGeneratorBa
+00021250: 7463 682e 6765 6e65 7261 7465 5f63 6f6e  tch.generate_con
+00021260: 7465 7874 223e 6765 6e65 7261 7465 5f63  text">generate_c
+00021270: 6f6e 7465 7874 3c2f 613e 3c2f 636f 6465  ontext</a></code
+00021280: 3e3c 2f6c 693e 0a3c 6c69 3e3c 636f 6465  ></li>.<li><code
+00021290: 3e3c 6120 7469 746c 653d 2250 646d 436f  ><a title="PdmCo
+000212a0: 6e74 6578 742e 436f 6e74 6578 7447 656e  ntext.ContextGen
+000212b0: 6572 6174 696f 6e2e 436f 6e74 6578 7447  eration.ContextG
+000212c0: 656e 6572 6174 6f72 4261 7463 682e 6765  eneratorBatch.ge
+000212d0: 7463 6172 6163 7465 7269 7a65 2220 6872  tcaracterize" hr
+000212e0: 6566 3d22 2350 646d 436f 6e74 6578 742e  ef="#PdmContext.
+000212f0: 436f 6e74 6578 7447 656e 6572 6174 696f  ContextGeneratio
+00021300: 6e2e 436f 6e74 6578 7447 656e 6572 6174  n.ContextGenerat
+00021310: 6f72 4261 7463 682e 6765 7463 6172 6163  orBatch.getcarac
+00021320: 7465 7269 7a65 223e 6765 7463 6172 6163  terize">getcarac
+00021330: 7465 7269 7a65 3c2f 613e 3c2f 636f 6465  terize</a></code
+00021340: 3e3c 2f6c 693e 0a3c 2f75 6c3e 0a3c 2f6c  ></li>.</ul>.</l
+00021350: 693e 0a3c 2f75 6c3e 0a3c 2f6c 693e 0a3c  i>.</ul>.</li>.<
+00021360: 2f75 6c3e 0a3c 2f6e 6176 3e0a 3c2f 6d61  /ul>.</nav>.</ma
+00021370: 696e 3e0a 3c66 6f6f 7465 7220 6964 3d22  in>.<footer id="
+00021380: 666f 6f74 6572 223e 0a3c 703e 4765 6e65  footer">.<p>Gene
+00021390: 7261 7465 6420 6279 203c 6120 6872 6566  rated by <a href
+000213a0: 3d22 6874 7470 733a 2f2f 7064 6f63 332e  ="https://pdoc3.
+000213b0: 6769 7468 7562 2e69 6f2f 7064 6f63 2220  github.io/pdoc" 
+000213c0: 7469 746c 653d 2270 646f 633a 2050 7974  title="pdoc: Pyt
+000213d0: 686f 6e20 4150 4920 646f 6375 6d65 6e74  hon API document
+000213e0: 6174 696f 6e20 6765 6e65 7261 746f 7222  ation generator"
+000213f0: 3e3c 6369 7465 3e70 646f 633c 2f63 6974  ><cite>pdoc</cit
+00021400: 653e 2030 2e31 302e 303c 2f61 3e2e 3c2f  e> 0.10.0</a>.</
+00021410: 703e 0a3c 2f66 6f6f 7465 723e 0a3c 2f62  p>.</footer>.</b
+00021420: 6f64 793e 0a3c 2f68 746d 6c3e            ody>.</html>
```

#### html2text {}

```diff
@@ -4,15 +4,241 @@
 import statistics
 
 import pandas as pd
 from PdmContext.utils.structure import Eventpoint, Context
 from PdmContext.utils.causal_discovery_functions import calculate_with_pc
 from PdmContext.utils.showcontext import show_context_list,
 show_context_interpretations
+from pathlib import Path
+import pickle
 
+class ContextGeneratorBatch():
+    def __init__(self,df_data,target,type_of_series,context_horizon="8
+hours",Causalityfunct=calculate_with_pc,debug=False,file_path=None):
+        """
+        This version doesn't support interpretation and is created for faster
+experiments using Context.
+
+        **df_data** The data to consider in context in form of Data Frame.
+
+        ** target** The name of the target source, which will be used as the
+baseline in order to map different samples
+
+        **type_of_series**: dictionary which define the type of each series
+(isolated,configuration or continuous)
+         rate to that of the target sample rate.
+
+        **context_horizon** The time period to look back for context data, the
+form of that parameter is "8 hours"
+
+        **Causalityfunct** the causality discovery method to use to produce
+causal relationships between context data,
+            This must be a function with parameters two equal size lists, one
+with names and the other
+            with data (a list of list or 2D numpy array).
+
+        **debug** If it runs on debug mode
+
+        **file_path** Store the results of context in pickle file, considered
+only when it is not None.
+        """
+
+        self.file_path=file_path
+        self.debug=debug
+        self.target=target
+        self.df_data=df_data
+
+
+        self.contexts=self._load_contexts()
+
+        self.causality_discovery=Causalityfunct
+        self.buffer=[]
+
+
+        #helpers
+        self.type_of_series = type_of_series
+        self.horizon = context_horizon.split(" ")[0]
+        if len(context_horizon.split(" ")) == 1:
+            self.horizon_time = "hours"
+        else:
+            if context_horizon.split(" ")[1] in ["days", "hours", "minutes",
+"seconds"]:
+                self.horizon_time = context_horizon.split(" ")[1]
+            else:
+                assert False, "Time horizon must be either a single number or
+in form of \"8 hours\" where acceptable time frames are
+hours,days,minutes,seconds"
+
+        self.horizon = int(self.horizon)
+        self.interpret_history_pos = 0
+        self.context_pos = 0
+
+
+    def generate_context(self,datetime_index):
+        contextpbject, target_series_name,time_index=self.create_context
+(datetime_index)
+
+        self.contexts[time_index]=contextpbject
+
+        return contextpbject
+
+    def _save_contexts(self):
+        if self.file_path is None:
+            return
+        with open(self.file_path, 'wb') as f:
+            pickle.dump(self.contexts, f)
+
+    def _load_contexts(self):
+        if self.file_path is None:
+            return {}
+
+        my_file = Path(self.file_path)
+        if my_file.is_file():
+            with open(self.file_path, 'rb') as f:
+                return pickle.load(f)
+        else:
+            return  {}
+    def create_context(self, datetime_index):
+
+        start_index = datetime_index - pd.Timedelta(self.horizon,
+self.horizon_time)
+
+        context=self.df_data.loc[start_index:datetime_index]
+
+        allcodes = np.unique(self.df_data.columns)
+        allcodes = [code for code in allcodes]
+        allcodes = set(allcodes)
+
+        ## build target series
+        target_series_name= self.target
+        target_series=context[self.target].values
+
+        ## create series for each source (alldata)
+        alldata = []
+        for col in context.columns:
+            alldata.append((col, context[col].values))
+        # end = time.time()
+        # print(f"Create series: {end-start}")
+
+        storing = self.calculate_edges(alldata, context.index[-1])
+        storing["characterization"] = self.getcaracterize(storing)
+
+        # print(f"Calculate edges: {end - start}")
+        # print("========================")
+
+        contextpbject = Context.context_from_dict(storing)
+        return contextpbject, target_series_name,context.index[-1]
+
+    def calculate_edges(self,alldata, timestamp):
+        #start = time.time()
+        storing = {}
+        storing["timestamp"] = timestamp
+
+        alldata_names = [nn[0] for nn in alldata]
+        alldata_data = [nn[1] for nn in alldata]
+
+        for namedd, datadd in zip(alldata_names, alldata_data):
+            storing[namedd] = datadd
+
+        # For context with more than two series calculate PC casualities
+        count = len([1 for lista in alldata_data if lista is not None])
+        if count > 1 and len(alldata[0][1]) > 5:
+            alldata_names = [nn[0] for nn in alldata if nn[1] is not None and
+len(set(nn[1]))>1]
+            alldata_data = [nn[1] for nn in alldata if nn[1] is not None and
+len(set(nn[1]))>1]
+
+            #end = time.time()
+            #print(f"before {end - start}")
+            #start=time.time()
+
+            if len(alldata) <= 1:
+                edges = []
+            else:
+                edges = self.calculate_causality(np.column_stack(alldata_data),
+alldata_names)
+            #end=time.time()
+            #print(f"actual edge calculation {end-start}")
+            if edges is None:
+                singleedges = []
+            else:
+                singleedges = edges
+            # print(edges)
+            storing["edges"] = singleedges
+            return storing
+        storing["edges"] = []
+        return storing
+
+    def calculate_causality(self, dataor, names):
+        num_time_series = len(dataor)
+        data = np.array(dataor)
+        edges = self.causality_discovery(names, data)
+        # edges=self.calculatewithPc(names,data)
+        # edges=self.calculatewith_fci(names,data)
+        # edges=self.salesforcePC(names,data)
+        return edges
+    def getcaracterize(self,context):
+        edges = context["edges"]
+        characterizations = []
+        for edge in edges:
+            name1 = edge[0]
+            name2 = edge[1]
+            values1 = context[name1]
+            values2 = [float(kati) for kati in context[name2]]
+
+            occurence=len(values1)-1
+            for i in range(len(values1)-2,0,-1):
+                if values1[i] != values1[-1]:
+                    occurence = i+1
+                    break
+            previusoccurence = 0
+            for i in range(occurence-2,0,-1):
+                if values1[i] !=  values1[occurence-1]:
+                    previusoccurence = i
+
+            if occurence - previusoccurence < 2:  # or len(values2)-
+occurence<2:
+                characterizations.append("uknown")
+                continue
+            values2before = values2[previusoccurence:occurence]
+            # stdv = statistics.stdev(values2before)
+            # mean = statistics.stdev(values2before)
+            # values2before=[v if v<mean+5*stdv else mean for v in
+values2before]
+
+            # values2after=values2[occurence:]
+            values2after = [values2[-1]]
+            # stdv = statistics.stdev(values2after)
+            # mean = statistics.stdev(values2after)
+            # values2after = [v if v < mean + 3 * stdv else mean for v in
+values2after]
+
+            stdv = statistics.stdev(values2before)
+            if len(values2before) == 0:
+                char = "uknown"
+            elif statistics.median(values2before) - statistics.median
+(values2after) > 2 * stdv:
+                char = "decrease"
+            elif statistics.median(values2after) - statistics.median
+(values2before) > 2 * stdv:
+                char = "increase"
+            else:
+                char = "uknown"
+            characterizations.append(char)
+        return characterizations
+
+
+    def __del__(self):
+        if self.file_path is None:
+            return
+        my_file = Path(self.file_path)
+        if my_file.is_file():
+            return
+        else:
+            self._save_contexts()
 
 class ContextGenerator:
 
     def __init__(self, target, context_horizon="8",
 Causalityfunct=calculate_with_pc, debug=False):
         """
         This Class handle the Context Generation. It keeps an internal buffer
@@ -63,15 +289,15 @@
 hours,days,minutes,seconds"
 
         self.horizon = int(self.horizon)
         self.interpret_history_pos = 0
         self.context_pos = 0
 
     def collect_data(self, timestamp, source, name, value=None,
-type="Univariate"):
+type="Univariate",replace=[]):
         '''
         This method is used when data are passed iteratively, and stored in
 buffer
         When data of target source arrive, a corresponding context is produced.
         Sources can be of different sample rate (all sources are mapped to the
 targets sample rate when context is produced)
 
@@ -98,39 +324,51 @@
 
         **value**: The value (float), in case this is None the arrived data is
 considered as event
 
         **type**: the type of the data can be one of "isolated","configuration"
 when no value is passed
 
+        **replace**: a list of tuples, which define a replacement policy. If a
+tuple (e,b) exist in replace list, then
+        when a b event is inserted, it will replace an e event with the same
+timestamp (if exists).
+
         **return**:  structure.Context object when the data name match to the
 target name or None.
         '''
 
         if value is None:
             if type not in ["isolated", "configuration"]:
                 assert False, "The type must be defined as one of \"isolated\"
 and \"configuration\" when no value is passed"
         eventpoint = Eventpoint(code=name, source=source, timestamp=timestamp,
 details=value, type=type)
-        self.add_to_buffer(eventpoint)
+        self.add_to_buffer(eventpoint,replace)
         if self.target == name or self.target == f"{name}@{source}":
             contextobject = self.generate_context(e=eventpoint,
 buffer=self.buffer)
             return contextobject
         else:
             return None
 
-    def add_to_buffer(self, e: Eventpoint):
+    def add_to_buffer(self, e: Eventpoint, replace: list):
         """
         Adds an Event point to the buffer (keeping the buffer time ordered)
         """
         index = len(self.buffer)
         for i in range(len(self.buffer) - 1, 0, -1):
-            if self.buffer[i].timestamp <= e.timestamp:
+            # check for replacement
+            if self.buffer[i].timestamp == e.timestamp:
+                for rep in replace:
+                    if self.buffer[i].code==rep[0] and e.code==rep[1]:
+                        self.buffer[i]=e
+                        return
+                index = i + 1
+            if self.buffer[i].timestamp < e.timestamp:
                 index = i + 1
                 break
         if index == len(self.buffer):
             self.buffer.append(e)
         else:
             self.buffer = self.buffer[: index] + [e] + self.buffer[index:]
 
@@ -821,15 +1059,15 @@
       hours,days,minutes,seconds"
 
               self.horizon = int(self.horizon)
               self.interpret_history_pos = 0
               self.context_pos = 0
 
           def collect_data(self, timestamp, source, name, value=None,
-      type="Univariate"):
+      type="Univariate",replace=[]):
               '''
               This method is used when data are passed iteratively, and stored
       in buffer
               When data of target source arrive, a corresponding context is
       produced.
               Sources can be of different sample rate (all sources are mapped
       to the targets sample rate when context is produced)
@@ -858,40 +1096,52 @@
 
               **value**: The value (float), in case this is None the arrived
       data is considered as event
 
               **type**: the type of the data can be one of
       "isolated","configuration" when no value is passed
 
+              **replace**: a list of tuples, which define a replacement policy.
+      If a tuple (e,b) exist in replace list, then
+              when a b event is inserted, it will replace an e event with the
+      same timestamp (if exists).
+
               **return**:  structure.Context object when the data name match to
       the target name or None.
               '''
 
               if value is None:
                   if type not in ["isolated", "configuration"]:
                       assert False, "The type must be defined as one of
       \"isolated\" and \"configuration\" when no value is passed"
               eventpoint = Eventpoint(code=name, source=source,
       timestamp=timestamp, details=value, type=type)
-              self.add_to_buffer(eventpoint)
+              self.add_to_buffer(eventpoint,replace)
               if self.target == name or self.target == f"{name}@{source}":
                   contextobject = self.generate_context(e=eventpoint,
       buffer=self.buffer)
                   return contextobject
               else:
                   return None
 
-          def add_to_buffer(self, e: Eventpoint):
+          def add_to_buffer(self, e: Eventpoint, replace: list):
               """
               Adds an Event point to the buffer (keeping the buffer time
       ordered)
               """
               index = len(self.buffer)
               for i in range(len(self.buffer) - 1, 0, -1):
-                  if self.buffer[i].timestamp <= e.timestamp:
+                  # check for replacement
+                  if self.buffer[i].timestamp == e.timestamp:
+                      for rep in replace:
+                          if self.buffer[i].code==rep[0] and e.code==rep[1]:
+                              self.buffer[i]=e
+                              return
+                      index = i + 1
+                  if self.buffer[i].timestamp < e.timestamp:
                       index = i + 1
                       break
               if index == len(self.buffer):
                   self.buffer.append(e)
               else:
                   self.buffer = self.buffer[: index] + [e] + self.buffer[index:
       ]
@@ -1548,25 +1798,32 @@
                 npcontext[mask, 3] = 1
                 code_with_source = [f"{code}{source}" if source[0] == "@" else
             f"{code}@{source}" for code, source in
                                     zip(npcontext[:, 1], npcontext[:, 2])]
                 npcontext[:, 1] = code_with_source
 
                 return npcontext
-        def add_to_buffer(self, e:_E_v_e_n_t_p_o_i_n_t)
+        def add_to_buffer(self, e:_E_v_e_n_t_p_o_i_n_t, replace:list)
             Adds an Event point to the buffer (keeping the buffer time ordered)
             Expand source code
-            def add_to_buffer(self, e: Eventpoint):
+            def add_to_buffer(self, e: Eventpoint, replace: list):
                 """
                 Adds an Event point to the buffer (keeping the buffer time
             ordered)
                 """
                 index = len(self.buffer)
                 for i in range(len(self.buffer) - 1, 0, -1):
-                    if self.buffer[i].timestamp <= e.timestamp:
+                    # check for replacement
+                    if self.buffer[i].timestamp == e.timestamp:
+                        for rep in replace:
+                            if self.buffer[i].code==rep[0] and e.code==rep[1]:
+                                self.buffer[i]=e
+                                return
+                        index = i + 1
+                    if self.buffer[i].timestamp < e.timestamp:
                         index = i + 1
                         break
                 if index == len(self.buffer):
                     self.buffer.append(e)
                 else:
                     self.buffer = self.buffer[: index] + [e] + self.buffer
             [index:]
@@ -1868,15 +2125,15 @@
                 elif statistics.median(values2after) - statistics.median
             (values2before) > 2 * stdv:
                     char = "increase"
                 else:
                     char = "unknown"
                 return char
         def collect_data(self, timestamp, source, name, value=None,
-        type='Univariate')
+        type='Univariate', replace=[])
             This method is used when data are passed iteratively, and stored in
             buffer When data of target source arrive, a corresponding context
             is produced. Sources can be of different sample rate (all sources
             are mapped to the targets sample rate when context is produced)
             Sources can be of either:
             1) Continuous type (those that have some kind of arithmetic value)
             2) Discrete events (without value) , where one of the type isolated
@@ -1890,19 +2147,22 @@
             ttiimmeessttaammpp: The timestamp of the arrived value
             ssoouurrccee: The source of the arrived value
             nnaammee: The name (or identifier) of the arrived value
             vvaalluuee: The value (float), in case this is None the arrived data is
             considered as event
             ttyyppee: the type of the data can be one of "isolated","configuration"
             when no value is passed
+            rreeppllaaccee: a list of tuples, which define a replacement policy. If a
+            tuple (e,b) exist in replace list, then when a b event is inserted,
+            it will replace an e event with the same timestamp (if exists).
             rreettuurrnn: structure.Context object when the data name match to the
             target name or None.
             Expand source code
             def collect_data(self, timestamp, source, name, value=None,
-            type="Univariate"):
+            type="Univariate",replace=[]):
                 '''
                 This method is used when data are passed iteratively, and
             stored in buffer
                 When data of target source arrive, a corresponding context is
             produced.
                 Sources can be of different sample rate (all sources are mapped
             to the targets sample rate when context is produced)
@@ -1931,25 +2191,30 @@
 
                 **value**: The value (float), in case this is None the arrived
             data is considered as event
 
                 **type**: the type of the data can be one of
             "isolated","configuration" when no value is passed
 
+                **replace**: a list of tuples, which define a replacement
+            policy. If a tuple (e,b) exist in replace list, then
+                when a b event is inserted, it will replace an e event with the
+            same timestamp (if exists).
+
                 **return**:  structure.Context object when the data name match
             to the target name or None.
                 '''
 
                 if value is None:
                     if type not in ["isolated", "configuration"]:
                         assert False, "The type must be defined as one of
             \"isolated\" and \"configuration\" when no value is passed"
                 eventpoint = Eventpoint(code=name, source=source,
             timestamp=timestamp, details=value, type=type)
-                self.add_to_buffer(eventpoint)
+                self.add_to_buffer(eventpoint,replace)
                 if self.target == name or self.target == f"{name}@{source}":
                     contextobject = self.generate_context(e=eventpoint,
             buffer=self.buffer)
                     return contextobject
                 else:
                     return None
         def create_context(self, current:_E_v_e_n_t_p_o_i_n_t, buffer)
@@ -2383,14 +2648,405 @@
         def plot_interpretation(self, filteredges=None)
             Expand source code
             def plot_interpretation(self, filteredges=None):
                 if filteredges is None:
                     filteredges = [["", "", ""]]
                 show_context_interpretations(self.contexts, self.target,
             filteredges=filteredges)
+  class ContextGeneratorBatch (df_data, target, type_of_series,
+  context_horizon='8 hours', Causalityfunct=<function calculate_with_pc>,
+  debug=False, file_path=None)
+      This version doesn't support interpretation and is created for faster
+      experiments using Context.
+      ddff__ddaattaa The data to consider in context in form of Data Frame.
+      ** target** The name of the target source, which will be used as the
+      baseline in order to map different samples
+      ttyyppee__ooff__sseerriieess: dictionary which define the type of each series
+      (isolated,configuration or continuous) rate to that of the target sample
+      rate.
+      ccoonntteexxtt__hhoorriizzoonn The time period to look back for context data, the form
+      of that parameter is "8 hours"
+      CCaauussaalliittyyffuunncctt the causality discovery method to use to produce causal
+      relationships between context data, This must be a function with
+      parameters two equal size lists, one with names and the other with data
+      (a list of list or 2D numpy array).
+      ddeebbuugg If it runs on debug mode
+      ffiillee__ppaatthh Store the results of context in pickle file, considered only
+      when it is not None.
+      Expand source code
+      class ContextGeneratorBatch():
+          def __init__(self,df_data,target,type_of_series,context_horizon="8
+      hours",Causalityfunct=calculate_with_pc,debug=False,file_path=None):
+              """
+              This version doesn't support interpretation and is created for
+      faster experiments using Context.
+
+              **df_data** The data to consider in context in form of Data
+      Frame.
+
+              ** target** The name of the target source, which will be used as
+      the baseline in order to map different samples
+
+              **type_of_series**: dictionary which define the type of each
+      series (isolated,configuration or continuous)
+               rate to that of the target sample rate.
+
+              **context_horizon** The time period to look back for context
+      data, the form of that parameter is "8 hours"
+
+              **Causalityfunct** the causality discovery method to use to
+      produce causal relationships between context data,
+                  This must be a function with parameters two equal size lists,
+      one with names and the other
+                  with data (a list of list or 2D numpy array).
+
+              **debug** If it runs on debug mode
+
+              **file_path** Store the results of context in pickle file,
+      considered only when it is not None.
+              """
+
+              self.file_path=file_path
+              self.debug=debug
+              self.target=target
+              self.df_data=df_data
+
+
+              self.contexts=self._load_contexts()
+
+              self.causality_discovery=Causalityfunct
+              self.buffer=[]
+
+
+              #helpers
+              self.type_of_series = type_of_series
+              self.horizon = context_horizon.split(" ")[0]
+              if len(context_horizon.split(" ")) == 1:
+                  self.horizon_time = "hours"
+              else:
+                  if context_horizon.split(" ")[1] in ["days", "hours",
+      "minutes", "seconds"]:
+                      self.horizon_time = context_horizon.split(" ")[1]
+                  else:
+                      assert False, "Time horizon must be either a single
+      number or in form of \"8 hours\" where acceptable time frames are
+      hours,days,minutes,seconds"
+
+              self.horizon = int(self.horizon)
+              self.interpret_history_pos = 0
+              self.context_pos = 0
+
+
+          def generate_context(self,datetime_index):
+              contextpbject, target_series_name,time_index=self.create_context
+      (datetime_index)
+
+              self.contexts[time_index]=contextpbject
+
+              return contextpbject
+
+          def _save_contexts(self):
+              if self.file_path is None:
+                  return
+              with open(self.file_path, 'wb') as f:
+                  pickle.dump(self.contexts, f)
+
+          def _load_contexts(self):
+              if self.file_path is None:
+                  return {}
+
+              my_file = Path(self.file_path)
+              if my_file.is_file():
+                  with open(self.file_path, 'rb') as f:
+                      return pickle.load(f)
+              else:
+                  return  {}
+          def create_context(self, datetime_index):
+
+              start_index = datetime_index - pd.Timedelta(self.horizon,
+      self.horizon_time)
+
+              context=self.df_data.loc[start_index:datetime_index]
+
+              allcodes = np.unique(self.df_data.columns)
+              allcodes = [code for code in allcodes]
+              allcodes = set(allcodes)
+
+              ## build target series
+              target_series_name= self.target
+              target_series=context[self.target].values
+
+              ## create series for each source (alldata)
+              alldata = []
+              for col in context.columns:
+                  alldata.append((col, context[col].values))
+              # end = time.time()
+              # print(f"Create series: {end-start}")
+
+              storing = self.calculate_edges(alldata, context.index[-1])
+              storing["characterization"] = self.getcaracterize(storing)
+
+              # print(f"Calculate edges: {end - start}")
+              # print("========================")
+
+              contextpbject = Context.context_from_dict(storing)
+              return contextpbject, target_series_name,context.index[-1]
+
+          def calculate_edges(self,alldata, timestamp):
+              #start = time.time()
+              storing = {}
+              storing["timestamp"] = timestamp
+
+              alldata_names = [nn[0] for nn in alldata]
+              alldata_data = [nn[1] for nn in alldata]
+
+              for namedd, datadd in zip(alldata_names, alldata_data):
+                  storing[namedd] = datadd
+
+              # For context with more than two series calculate PC casualities
+              count = len([1 for lista in alldata_data if lista is not None])
+              if count > 1 and len(alldata[0][1]) > 5:
+                  alldata_names = [nn[0] for nn in alldata if nn[1] is not None
+      and len(set(nn[1]))>1]
+                  alldata_data = [nn[1] for nn in alldata if nn[1] is not None
+      and len(set(nn[1]))>1]
+
+                  #end = time.time()
+                  #print(f"before {end - start}")
+                  #start=time.time()
+
+                  if len(alldata) <= 1:
+                      edges = []
+                  else:
+                      edges = self.calculate_causality(np.column_stack
+      (alldata_data), alldata_names)
+                  #end=time.time()
+                  #print(f"actual edge calculation {end-start}")
+                  if edges is None:
+                      singleedges = []
+                  else:
+                      singleedges = edges
+                  # print(edges)
+                  storing["edges"] = singleedges
+                  return storing
+              storing["edges"] = []
+              return storing
+
+          def calculate_causality(self, dataor, names):
+              num_time_series = len(dataor)
+              data = np.array(dataor)
+              edges = self.causality_discovery(names, data)
+              # edges=self.calculatewithPc(names,data)
+              # edges=self.calculatewith_fci(names,data)
+              # edges=self.salesforcePC(names,data)
+              return edges
+          def getcaracterize(self,context):
+              edges = context["edges"]
+              characterizations = []
+              for edge in edges:
+                  name1 = edge[0]
+                  name2 = edge[1]
+                  values1 = context[name1]
+                  values2 = [float(kati) for kati in context[name2]]
+
+                  occurence=len(values1)-1
+                  for i in range(len(values1)-2,0,-1):
+                      if values1[i] != values1[-1]:
+                          occurence = i+1
+                          break
+                  previusoccurence = 0
+                  for i in range(occurence-2,0,-1):
+                      if values1[i] !=  values1[occurence-1]:
+                          previusoccurence = i
+
+                  if occurence - previusoccurence < 2:  # or len(values2)-
+      occurence<2:
+                      characterizations.append("uknown")
+                      continue
+                  values2before = values2[previusoccurence:occurence]
+                  # stdv = statistics.stdev(values2before)
+                  # mean = statistics.stdev(values2before)
+                  # values2before=[v if v<mean+5*stdv else mean for v in
+      values2before]
+
+                  # values2after=values2[occurence:]
+                  values2after = [values2[-1]]
+                  # stdv = statistics.stdev(values2after)
+                  # mean = statistics.stdev(values2after)
+                  # values2after = [v if v < mean + 3 * stdv else mean for v in
+      values2after]
+
+                  stdv = statistics.stdev(values2before)
+                  if len(values2before) == 0:
+                      char = "uknown"
+                  elif statistics.median(values2before) - statistics.median
+      (values2after) > 2 * stdv:
+                      char = "decrease"
+                  elif statistics.median(values2after) - statistics.median
+      (values2before) > 2 * stdv:
+                      char = "increase"
+                  else:
+                      char = "uknown"
+                  characterizations.append(char)
+              return characterizations
+
+
+          def __del__(self):
+              if self.file_path is None:
+                  return
+              my_file = Path(self.file_path)
+              if my_file.is_file():
+                  return
+              else:
+                  self._save_contexts()
+      ******** MMeetthhooddss ********
+        def calculate_causality(self, dataor, names)
+            Expand source code
+            def calculate_causality(self, dataor, names):
+                num_time_series = len(dataor)
+                data = np.array(dataor)
+                edges = self.causality_discovery(names, data)
+                # edges=self.calculatewithPc(names,data)
+                # edges=self.calculatewith_fci(names,data)
+                # edges=self.salesforcePC(names,data)
+                return edges
+        def calculate_edges(self, alldata, timestamp)
+            Expand source code
+            def calculate_edges(self,alldata, timestamp):
+                #start = time.time()
+                storing = {}
+                storing["timestamp"] = timestamp
+
+                alldata_names = [nn[0] for nn in alldata]
+                alldata_data = [nn[1] for nn in alldata]
+
+                for namedd, datadd in zip(alldata_names, alldata_data):
+                    storing[namedd] = datadd
+
+                # For context with more than two series calculate PC
+            casualities
+                count = len([1 for lista in alldata_data if lista is not None])
+                if count > 1 and len(alldata[0][1]) > 5:
+                    alldata_names = [nn[0] for nn in alldata if nn[1] is not
+            None and len(set(nn[1]))>1]
+                    alldata_data = [nn[1] for nn in alldata if nn[1] is not
+            None and len(set(nn[1]))>1]
+
+                    #end = time.time()
+                    #print(f"before {end - start}")
+                    #start=time.time()
+
+                    if len(alldata) <= 1:
+                        edges = []
+                    else:
+                        edges = self.calculate_causality(np.column_stack
+            (alldata_data), alldata_names)
+                    #end=time.time()
+                    #print(f"actual edge calculation {end-start}")
+                    if edges is None:
+                        singleedges = []
+                    else:
+                        singleedges = edges
+                    # print(edges)
+                    storing["edges"] = singleedges
+                    return storing
+                storing["edges"] = []
+                return storing
+        def create_context(self, datetime_index)
+            Expand source code
+            def create_context(self, datetime_index):
+
+                start_index = datetime_index - pd.Timedelta(self.horizon,
+            self.horizon_time)
+
+                context=self.df_data.loc[start_index:datetime_index]
+
+                allcodes = np.unique(self.df_data.columns)
+                allcodes = [code for code in allcodes]
+                allcodes = set(allcodes)
+
+                ## build target series
+                target_series_name= self.target
+                target_series=context[self.target].values
+
+                ## create series for each source (alldata)
+                alldata = []
+                for col in context.columns:
+                    alldata.append((col, context[col].values))
+                # end = time.time()
+                # print(f"Create series: {end-start}")
+
+                storing = self.calculate_edges(alldata, context.index[-1])
+                storing["characterization"] = self.getcaracterize(storing)
+
+                # print(f"Calculate edges: {end - start}")
+                # print("========================")
+
+                contextpbject = Context.context_from_dict(storing)
+                return contextpbject, target_series_name,context.index[-1]
+        def generate_context(self, datetime_index)
+            Expand source code
+            def generate_context(self,datetime_index):
+                contextpbject,
+            target_series_name,time_index=self.create_context(datetime_index)
+
+                self.contexts[time_index]=contextpbject
+
+                return contextpbject
+        def getcaracterize(self, context)
+            Expand source code
+            def getcaracterize(self,context):
+                edges = context["edges"]
+                characterizations = []
+                for edge in edges:
+                    name1 = edge[0]
+                    name2 = edge[1]
+                    values1 = context[name1]
+                    values2 = [float(kati) for kati in context[name2]]
+
+                    occurence=len(values1)-1
+                    for i in range(len(values1)-2,0,-1):
+                        if values1[i] != values1[-1]:
+                            occurence = i+1
+                            break
+                    previusoccurence = 0
+                    for i in range(occurence-2,0,-1):
+                        if values1[i] !=  values1[occurence-1]:
+                            previusoccurence = i
+
+                    if occurence - previusoccurence < 2:  # or len(values2)-
+            occurence<2:
+                        characterizations.append("uknown")
+                        continue
+                    values2before = values2[previusoccurence:occurence]
+                    # stdv = statistics.stdev(values2before)
+                    # mean = statistics.stdev(values2before)
+                    # values2before=[v if v<mean+5*stdv else mean for v in
+            values2before]
+
+                    # values2after=values2[occurence:]
+                    values2after = [values2[-1]]
+                    # stdv = statistics.stdev(values2after)
+                    # mean = statistics.stdev(values2after)
+                    # values2after = [v if v < mean + 3 * stdv else mean for v
+            in values2after]
+
+                    stdv = statistics.stdev(values2before)
+                    if len(values2before) == 0:
+                        char = "uknown"
+                    elif statistics.median(values2before) - statistics.median
+            (values2after) > 2 * stdv:
+                        char = "decrease"
+                    elif statistics.median(values2after) - statistics.median
+            (values2before) > 2 * stdv:
+                        char = "increase"
+                    else:
+                        char = "uknown"
+                    characterizations.append(char)
+                return characterizations
 ************ IInnddeexx ************
     * ******** SSuuppeerr--mmoodduullee ********
           o _P_d_m_C_o_n_t_e_x_t
     * ******** _CC_ll_aa_ss_ss_ee_ss ********
           o ****** _CC_oo_nn_tt_ee_xx_tt_GG_ee_nn_ee_rr_aa_tt_oo_rr ******
                 # _N_u_m_p_y___p_r_e_p_r_o_c_c_e_s_s
                 # _a_d_d___t_o___b_u_f_f_e_r
@@ -2407,8 +3063,14 @@
                 # _c_r_e_a_t_e___c_o_n_t_i_n_u_o_u_s___r_e_p_r_e_s_e_n_t_a_t_i_o_n
                 # _c_r_e_a_t_e___i_n_t_e_r_p_r_e_t_a_t_i_o_n
                 # _g_e_n_e_r_a_t_e___c_o_n_t_e_x_t
                 # _g_e_t___c_h_a_r_a_c_t_e_r_i_z_a_t_i_o_n
                 # _i_n_t_e_r_p_r_e_t
                 # _p_l_o_t
                 # _p_l_o_t___i_n_t_e_r_p_r_e_t_a_t_i_o_n
+          o ****** _CC_oo_nn_tt_ee_xx_tt_GG_ee_nn_ee_rr_aa_tt_oo_rr_BB_aa_tt_cc_hh ******
+                # _c_a_l_c_u_l_a_t_e___c_a_u_s_a_l_i_t_y
+                # _c_a_l_c_u_l_a_t_e___e_d_g_e_s
+                # _c_r_e_a_t_e___c_o_n_t_e_x_t
+                # _g_e_n_e_r_a_t_e___c_o_n_t_e_x_t
+                # _g_e_t_c_a_r_a_c_t_e_r_i_z_e
 Generated by_p_d_o_c_0_._1_0_._0.
```

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/Pipelines.html` & `pdmcontext-0.1.2/Documentation/PdmContext/Pipelines.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/index.html` & `pdmcontext-0.1.2/Documentation/PdmContext/index.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/index_old.html` & `pdmcontext-0.1.2/Documentation/PdmContext/index_old.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/causal_discovery_functions.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/causal_discovery_functions.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/dbconnector.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/dbconnector.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/distances.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/distances.html`

 * *Files 22% similar despite different names*

```diff
@@ -158,15 +158,15 @@
             if a &lt; 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
     if similarity is None:
-        return cc_m, (cc_m, similarity)
+        return cc_m#, (cc_m, similarity)
     else:
         return a * cc_m + b * similarity
 
 
 def _z_norm(series):
     if min(series) != max(series):
         ms1 = statistics.mean(series)
@@ -245,15 +245,97 @@
                 print(f&#34;Final cc_m = {cc_m}&#34;)
         else:
             cc_m = 0
     else:
         cc_m = 0
     # cc_m  [-1,1] -&gt; [0,1]
 
+    similarity=calculate_jaccard(a, context1, context2)
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity
+
+
+def distance_3D_sbd_jaccard(context1: Context, context2: Context, a, verbose=False):
+    &#34;&#34;&#34;
+    Calculation of similarity between two Context objects based on two quantities:
+        1) The first quantity is based on the 3d sbd distance upon all context data.
+        2) Jaccard similarity of the edges in the CR (if we ignore the direction)
+
+    **context1**: A context object
+
+    **context2**: A context object
+
+    **a**: the weight of SBD similarity
+
+    **verbose**:
+
+    **return**: a similarity between 0 and 1
+    &#34;&#34;&#34;
+    import kshape.core as kcore
+
+    #print(&#34;========================================&#34;)
+    #step1=time.time()
+    b = 1 - a
+    common_values = []
+    uncommon_values = []
+    for key in context1.CD.keys():
+        if key in context2.CD.keys() and context1.CD[key] is not None and context2.CD[key] is not None:
+            common_values.append(key)
+        else:
+            uncommon_values.append(key)
+    for key in context2.CD.keys():
+        if key not in context1.CD.keys():
+            uncommon_values.append(key)
+    #step2 = time.time()
+    #print(f&#34;{step2-step1} : common_names&#34;)
+    context1series=[]
+    context2series=[]
+    if len(common_values) &gt; 0 and a &gt; 0.0000000001 and len(context2.CD[common_values[0]]) &gt; 5 and len(context1.CD[common_values[0]]) &gt; 5:
+        All_common_cc = []
+        sizee = min(len(context1.CD[common_values[0]]), len(context2.CD[common_values[0]]))
+        for key in common_values:
+            #step11 = time.time()
+            All_common_cc.append(key)
+            firtsseries = context1.CD[key][-sizee:]
+            secondseries = context2.CD[key][-sizee:]
+            # step21 = time.time()
+            # print(f&#34;{step21 - step11} : cut&#34;)
+            #firtsseries = _z_norm_np(firtsseries)
+            #secondseries = _z_norm_np(secondseries)
+            # step31 = time.time()
+            # print(f&#34;{step31 - step21} : normalize&#34;)
+            context1series.append(firtsseries)
+            context2series.append(secondseries)
+        #step3 = time.time()
+        #print(f&#34;{step3 - step2} : normalize and gather&#34;)
+        in_cc_m = np.max(kcore._ncc_c_3dim([np.array(context1series), np.array(context2series)]))
+        #step4 = time.time()
+        #print(f&#34;{step4 - step3} : SBD&#34;)
+        cc_m = in_cc_m * len(All_common_cc) / (len(All_common_cc) + len(uncommon_values))
+        if verbose:
+            print(f&#34;Common cc_m = {in_cc_m}&#34;)
+            print(f&#34;uncommon_values: {len(uncommon_values)}&#34;)
+            print(f&#34;Final cc_m = {cc_m}&#34;)
+    else:
+        cc_m = 0
+    # cc_m  [-1,1] -&gt; [0,1]
+
     # check common causes-characterizations:
+    similarity=calculate_jaccard(a, context1, context2)
+
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity,(cc_m, similarity)
+
+
+def calculate_jaccard(a,context1,context2):
+    b=1-a
     if b &gt; 0.000000001:
         # check common causes-characterizations:
         common = 0
 
         edges1 = ignore_order(context1)
         edges2 = ignore_order(context2)
 
@@ -272,18 +354,15 @@
         else:
             if a &lt; 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
-    if similarity is None:
-        return cc_m, (cc_m, similarity)
-    else:
-        return a * cc_m + b * similarity
+    return similarity
 
 
 def ignore_order(context1: Context):
     edges1 = []
 
     for edge in context1.CR[&#39;edges&#39;]:
         if edge[0] &gt; edge[1]:
@@ -329,14 +408,144 @@
 <section>
 </section>
 <section>
 </section>
 <section>
 <h2 class="section-title" id="header-functions">Functions</h2>
 <dl>
+<dt id="PdmContext.utils.distances.calculate_jaccard"><code class="name flex">
+<span>def <span class="ident">calculate_jaccard</span></span>(<span>a, context1, context2)</span>
+</code></dt>
+<dd>
+<div class="desc"></div>
+<details class="source">
+<summary>
+<span>Expand source code</span>
+</summary>
+<pre><code class="python">def calculate_jaccard(a,context1,context2):
+    b=1-a
+    if b &gt; 0.000000001:
+        # check common causes-characterizations:
+        common = 0
+
+        edges1 = ignore_order(context1)
+        edges2 = ignore_order(context2)
+
+        for edge in edges1:
+            for edge2 in edges2:
+                if edge[0] == edge2[0] and edge[1] == edge2[1]:
+                    common += 1
+
+        if (len(edges1) + len(edges2) - common) &gt; 0:
+            if common == 0:
+                jaccard = 0
+            else:
+                jaccard = common / (len(edges1) + len(edges2) - common)
+            similarity = jaccard
+        # there are no samples Jaccard(empty,empty) = ? , in that case we use only first part
+        else:
+            if a &lt; 0.0000001:
+                similarity = 1
+            else:
+                similarity = None
+    else:
+        similarity = 0
+    return similarity</code></pre>
+</details>
+</dd>
+<dt id="PdmContext.utils.distances.distance_3D_sbd_jaccard"><code class="name flex">
+<span>def <span class="ident">distance_3D_sbd_jaccard</span></span>(<span>context1:<a title="PdmContext.utils.structure.Context" href="structure.html#PdmContext.utils.structure.Context">Context</a>, context2:<a title="PdmContext.utils.structure.Context" href="structure.html#PdmContext.utils.structure.Context">Context</a>, a, verbose=False)</span>
+</code></dt>
+<dd>
+<div class="desc"><p>Calculation of similarity between two Context objects based on two quantities:
+1) The first quantity is based on the 3d sbd distance upon all context data.
+2) Jaccard similarity of the edges in the CR (if we ignore the direction)</p>
+<p><strong>context1</strong>: A context object</p>
+<p><strong>context2</strong>: A context object</p>
+<p><strong>a</strong>: the weight of SBD similarity</p>
+<p><strong>verbose</strong>:</p>
+<p><strong>return</strong>: a similarity between 0 and 1</p></div>
+<details class="source">
+<summary>
+<span>Expand source code</span>
+</summary>
+<pre><code class="python">def distance_3D_sbd_jaccard(context1: Context, context2: Context, a, verbose=False):
+    &#34;&#34;&#34;
+    Calculation of similarity between two Context objects based on two quantities:
+        1) The first quantity is based on the 3d sbd distance upon all context data.
+        2) Jaccard similarity of the edges in the CR (if we ignore the direction)
+
+    **context1**: A context object
+
+    **context2**: A context object
+
+    **a**: the weight of SBD similarity
+
+    **verbose**:
+
+    **return**: a similarity between 0 and 1
+    &#34;&#34;&#34;
+    import kshape.core as kcore
+
+    #print(&#34;========================================&#34;)
+    #step1=time.time()
+    b = 1 - a
+    common_values = []
+    uncommon_values = []
+    for key in context1.CD.keys():
+        if key in context2.CD.keys() and context1.CD[key] is not None and context2.CD[key] is not None:
+            common_values.append(key)
+        else:
+            uncommon_values.append(key)
+    for key in context2.CD.keys():
+        if key not in context1.CD.keys():
+            uncommon_values.append(key)
+    #step2 = time.time()
+    #print(f&#34;{step2-step1} : common_names&#34;)
+    context1series=[]
+    context2series=[]
+    if len(common_values) &gt; 0 and a &gt; 0.0000000001 and len(context2.CD[common_values[0]]) &gt; 5 and len(context1.CD[common_values[0]]) &gt; 5:
+        All_common_cc = []
+        sizee = min(len(context1.CD[common_values[0]]), len(context2.CD[common_values[0]]))
+        for key in common_values:
+            #step11 = time.time()
+            All_common_cc.append(key)
+            firtsseries = context1.CD[key][-sizee:]
+            secondseries = context2.CD[key][-sizee:]
+            # step21 = time.time()
+            # print(f&#34;{step21 - step11} : cut&#34;)
+            #firtsseries = _z_norm_np(firtsseries)
+            #secondseries = _z_norm_np(secondseries)
+            # step31 = time.time()
+            # print(f&#34;{step31 - step21} : normalize&#34;)
+            context1series.append(firtsseries)
+            context2series.append(secondseries)
+        #step3 = time.time()
+        #print(f&#34;{step3 - step2} : normalize and gather&#34;)
+        in_cc_m = np.max(kcore._ncc_c_3dim([np.array(context1series), np.array(context2series)]))
+        #step4 = time.time()
+        #print(f&#34;{step4 - step3} : SBD&#34;)
+        cc_m = in_cc_m * len(All_common_cc) / (len(All_common_cc) + len(uncommon_values))
+        if verbose:
+            print(f&#34;Common cc_m = {in_cc_m}&#34;)
+            print(f&#34;uncommon_values: {len(uncommon_values)}&#34;)
+            print(f&#34;Final cc_m = {cc_m}&#34;)
+    else:
+        cc_m = 0
+    # cc_m  [-1,1] -&gt; [0,1]
+
+    # check common causes-characterizations:
+    similarity=calculate_jaccard(a, context1, context2)
+
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity,(cc_m, similarity)</code></pre>
+</details>
+</dd>
 <dt id="PdmContext.utils.distances.distance_cc"><code class="name flex">
 <span>def <span class="ident">distance_cc</span></span>(<span>context1:<a title="PdmContext.utils.structure.Context" href="structure.html#PdmContext.utils.structure.Context">Context</a>, context2:<a title="PdmContext.utils.structure.Context" href="structure.html#PdmContext.utils.structure.Context">Context</a>, a, verbose=False)</span>
 </code></dt>
 <dd>
 <div class="desc"><p>Calculation of similarity between two Context objects based on two quantities:
 1) The first quantity is based on the sbd distance
 We calculate the minimum (average) sbd between all common series in the CD of contexts, from all possible shifts.
@@ -421,41 +630,15 @@
                 print(f&#34;Final cc_m = {cc_m}&#34;)
         else:
             cc_m = 0
     else:
         cc_m = 0
     # cc_m  [-1,1] -&gt; [0,1]
 
-    # check common causes-characterizations:
-    if b &gt; 0.000000001:
-        # check common causes-characterizations:
-        common = 0
-
-        edges1 = ignore_order(context1)
-        edges2 = ignore_order(context2)
-
-        for edge in edges1:
-            for edge2 in edges2:
-                if edge[0] == edge2[0] and edge[1] == edge2[1]:
-                    common += 1
-
-        if (len(edges1) + len(edges2) - common) &gt; 0:
-            if common == 0:
-                jaccard = 0
-            else:
-                jaccard = common / (len(edges1) + len(edges2) - common)
-            similarity = jaccard
-        # there are no samples Jaccard(empty,empty) = ? , in that case we use only first part
-        else:
-            if a &lt; 0.0000001:
-                similarity = 1
-            else:
-                similarity = None
-    else:
-        similarity = 0
+    similarity=calculate_jaccard(a, context1, context2)
     if similarity is None:
         return cc_m, (cc_m, similarity)
     else:
         return a * cc_m + b * similarity</code></pre>
 </details>
 </dd>
 <dt id="PdmContext.utils.distances.distance_eu_z"><code class="name flex">
@@ -566,15 +749,15 @@
             if a &lt; 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
     if similarity is None:
-        return cc_m, (cc_m, similarity)
+        return cc_m#, (cc_m, similarity)
     else:
         return a * cc_m + b * similarity</code></pre>
 </details>
 </dd>
 <dt id="PdmContext.utils.distances.ignore_order"><code class="name flex">
 <span>def <span class="ident">ignore_order</span></span>(<span>context1:<a title="PdmContext.utils.structure.Context" href="structure.html#PdmContext.utils.structure.Context">Context</a>)</span>
 </code></dt>
@@ -691,15 +874,17 @@
 <ul id="index">
 <li><h3>Super-module</h3>
 <ul>
 <li><code><a title="PdmContext.utils" href="index.html">PdmContext.utils</a></code></li>
 </ul>
 </li>
 <li><h3><a href="#header-functions">Functions</a></h3>
-<ul class="two-column">
+<ul class="">
+<li><code><a title="PdmContext.utils.distances.calculate_jaccard" href="#PdmContext.utils.distances.calculate_jaccard">calculate_jaccard</a></code></li>
+<li><code><a title="PdmContext.utils.distances.distance_3D_sbd_jaccard" href="#PdmContext.utils.distances.distance_3D_sbd_jaccard">distance_3D_sbd_jaccard</a></code></li>
 <li><code><a title="PdmContext.utils.distances.distance_cc" href="#PdmContext.utils.distances.distance_cc">distance_cc</a></code></li>
 <li><code><a title="PdmContext.utils.distances.distance_eu_z" href="#PdmContext.utils.distances.distance_eu_z">distance_eu_z</a></code></li>
 <li><code><a title="PdmContext.utils.distances.ignore_order" href="#PdmContext.utils.distances.ignore_order">ignore_order</a></code></li>
 <li><code><a title="PdmContext.utils.distances.ignore_order_list" href="#PdmContext.utils.distances.ignore_order_list">ignore_order_list</a></code></li>
 <li><code><a title="PdmContext.utils.distances.nearest" href="#PdmContext.utils.distances.nearest">nearest</a></code></li>
 <li><code><a title="PdmContext.utils.distances.np_pearson_cor" href="#PdmContext.utils.distances.np_pearson_cor">np_pearson_cor</a></code></li>
 </ul>
```

#### html2text {}

```diff
@@ -147,15 +147,15 @@
             if a < 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
     if similarity is None:
-        return cc_m, (cc_m, similarity)
+        return cc_m#, (cc_m, similarity)
     else:
         return a * cc_m + b * similarity
 
 
 def _z_norm(series):
     if min(series) != max(series):
         ms1 = statistics.mean(series)
@@ -243,15 +243,106 @@
                 print(f"Final cc_m = {cc_m}")
         else:
             cc_m = 0
     else:
         cc_m = 0
     # cc_m  [-1,1] -> [0,1]
 
+    similarity=calculate_jaccard(a, context1, context2)
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity
+
+
+def distance_3D_sbd_jaccard(context1: Context, context2: Context, a,
+verbose=False):
+    """
+    Calculation of similarity between two Context objects based on two
+quantities:
+        1) The first quantity is based on the 3d sbd distance upon all context
+data.
+        2) Jaccard similarity of the edges in the CR (if we ignore the
+direction)
+
+    **context1**: A context object
+
+    **context2**: A context object
+
+    **a**: the weight of SBD similarity
+
+    **verbose**:
+
+    **return**: a similarity between 0 and 1
+    """
+    import kshape.core as kcore
+
+    #print("========================================")
+    #step1=time.time()
+    b = 1 - a
+    common_values = []
+    uncommon_values = []
+    for key in context1.CD.keys():
+        if key in context2.CD.keys() and context1.CD[key] is not None and
+context2.CD[key] is not None:
+            common_values.append(key)
+        else:
+            uncommon_values.append(key)
+    for key in context2.CD.keys():
+        if key not in context1.CD.keys():
+            uncommon_values.append(key)
+    #step2 = time.time()
+    #print(f"{step2-step1} : common_names")
+    context1series=[]
+    context2series=[]
+    if len(common_values) > 0 and a > 0.0000000001 and len(context2.CD
+[common_values[0]]) > 5 and len(context1.CD[common_values[0]]) > 5:
+        All_common_cc = []
+        sizee = min(len(context1.CD[common_values[0]]), len(context2.CD
+[common_values[0]]))
+        for key in common_values:
+            #step11 = time.time()
+            All_common_cc.append(key)
+            firtsseries = context1.CD[key][-sizee:]
+            secondseries = context2.CD[key][-sizee:]
+            # step21 = time.time()
+            # print(f"{step21 - step11} : cut")
+            #firtsseries = _z_norm_np(firtsseries)
+            #secondseries = _z_norm_np(secondseries)
+            # step31 = time.time()
+            # print(f"{step31 - step21} : normalize")
+            context1series.append(firtsseries)
+            context2series.append(secondseries)
+        #step3 = time.time()
+        #print(f"{step3 - step2} : normalize and gather")
+        in_cc_m = np.max(kcore._ncc_c_3dim([np.array(context1series), np.array
+(context2series)]))
+        #step4 = time.time()
+        #print(f"{step4 - step3} : SBD")
+        cc_m = in_cc_m * len(All_common_cc) / (len(All_common_cc) + len
+(uncommon_values))
+        if verbose:
+            print(f"Common cc_m = {in_cc_m}")
+            print(f"uncommon_values: {len(uncommon_values)}")
+            print(f"Final cc_m = {cc_m}")
+    else:
+        cc_m = 0
+    # cc_m  [-1,1] -> [0,1]
+
     # check common causes-characterizations:
+    similarity=calculate_jaccard(a, context1, context2)
+
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity,(cc_m, similarity)
+
+
+def calculate_jaccard(a,context1,context2):
+    b=1-a
     if b > 0.000000001:
         # check common causes-characterizations:
         common = 0
 
         edges1 = ignore_order(context1)
         edges2 = ignore_order(context2)
 
@@ -271,18 +362,15 @@
         else:
             if a < 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
-    if similarity is None:
-        return cc_m, (cc_m, similarity)
-    else:
-        return a * cc_m + b * similarity
+    return similarity
 
 
 def ignore_order(context1: Context):
     edges1 = []
 
     for edge in context1.CR['edges']:
         if edge[0] > edge[1]:
@@ -320,14 +408,139 @@
 
     x_len = len(x)
     fft_size = 1 << (2 * x_len - 1).bit_length()
     cc = ifft(fft(x, fft_size) * np.conj(fft(y, fft_size)))
     cc = np.concatenate((cc[-(x_len - 1):], cc[:x_len]))
     return np.real(cc) / den
 ********** FFuunnccttiioonnss **********
+  def calculate_jaccard(a, context1, context2)
+      Expand source code
+      def calculate_jaccard(a,context1,context2):
+          b=1-a
+          if b > 0.000000001:
+              # check common causes-characterizations:
+              common = 0
+
+              edges1 = ignore_order(context1)
+              edges2 = ignore_order(context2)
+
+              for edge in edges1:
+                  for edge2 in edges2:
+                      if edge[0] == edge2[0] and edge[1] == edge2[1]:
+                          common += 1
+
+              if (len(edges1) + len(edges2) - common) > 0:
+                  if common == 0:
+                      jaccard = 0
+                  else:
+                      jaccard = common / (len(edges1) + len(edges2) - common)
+                  similarity = jaccard
+              # there are no samples Jaccard(empty,empty) = ? , in that case we
+      use only first part
+              else:
+                  if a < 0.0000001:
+                      similarity = 1
+                  else:
+                      similarity = None
+          else:
+              similarity = 0
+          return similarity
+  def distance_3D_sbd_jaccard(context1:_C_o_n_t_e_x_t, context2:_C_o_n_t_e_x_t, a,
+  verbose=False)
+      Calculation of similarity between two Context objects based on two
+      quantities: 1) The first quantity is based on the 3d sbd distance upon
+      all context data. 2) Jaccard similarity of the edges in the CR (if we
+      ignore the direction)
+      ccoonntteexxtt11: A context object
+      ccoonntteexxtt22: A context object
+      aa: the weight of SBD similarity
+      vveerrbboossee:
+      rreettuurrnn: a similarity between 0 and 1
+      Expand source code
+      def distance_3D_sbd_jaccard(context1: Context, context2: Context, a,
+      verbose=False):
+          """
+          Calculation of similarity between two Context objects based on two
+      quantities:
+              1) The first quantity is based on the 3d sbd distance upon all
+      context data.
+              2) Jaccard similarity of the edges in the CR (if we ignore the
+      direction)
+
+          **context1**: A context object
+
+          **context2**: A context object
+
+          **a**: the weight of SBD similarity
+
+          **verbose**:
+
+          **return**: a similarity between 0 and 1
+          """
+          import kshape.core as kcore
+
+          #print("========================================")
+          #step1=time.time()
+          b = 1 - a
+          common_values = []
+          uncommon_values = []
+          for key in context1.CD.keys():
+              if key in context2.CD.keys() and context1.CD[key] is not None and
+      context2.CD[key] is not None:
+                  common_values.append(key)
+              else:
+                  uncommon_values.append(key)
+          for key in context2.CD.keys():
+              if key not in context1.CD.keys():
+                  uncommon_values.append(key)
+          #step2 = time.time()
+          #print(f"{step2-step1} : common_names")
+          context1series=[]
+          context2series=[]
+          if len(common_values) > 0 and a > 0.0000000001 and len(context2.CD
+      [common_values[0]]) > 5 and len(context1.CD[common_values[0]]) > 5:
+              All_common_cc = []
+              sizee = min(len(context1.CD[common_values[0]]), len(context2.CD
+      [common_values[0]]))
+              for key in common_values:
+                  #step11 = time.time()
+                  All_common_cc.append(key)
+                  firtsseries = context1.CD[key][-sizee:]
+                  secondseries = context2.CD[key][-sizee:]
+                  # step21 = time.time()
+                  # print(f"{step21 - step11} : cut")
+                  #firtsseries = _z_norm_np(firtsseries)
+                  #secondseries = _z_norm_np(secondseries)
+                  # step31 = time.time()
+                  # print(f"{step31 - step21} : normalize")
+                  context1series.append(firtsseries)
+                  context2series.append(secondseries)
+              #step3 = time.time()
+              #print(f"{step3 - step2} : normalize and gather")
+              in_cc_m = np.max(kcore._ncc_c_3dim([np.array(context1series),
+      np.array(context2series)]))
+              #step4 = time.time()
+              #print(f"{step4 - step3} : SBD")
+              cc_m = in_cc_m * len(All_common_cc) / (len(All_common_cc) + len
+      (uncommon_values))
+              if verbose:
+                  print(f"Common cc_m = {in_cc_m}")
+                  print(f"uncommon_values: {len(uncommon_values)}")
+                  print(f"Final cc_m = {cc_m}")
+          else:
+              cc_m = 0
+          # cc_m  [-1,1] -> [0,1]
+
+          # check common causes-characterizations:
+          similarity=calculate_jaccard(a, context1, context2)
+
+          if similarity is None:
+              return cc_m, (cc_m, similarity)
+          else:
+              return a * cc_m + b * similarity,(cc_m, similarity)
   def distance_cc(context1:_C_o_n_t_e_x_t, context2:_C_o_n_t_e_x_t, a, verbose=False)
       Calculation of similarity between two Context objects based on two
       quantities: 1) The first quantity is based on the sbd distance We
       calculate the minimum (average) sbd between all common series in the CD
       of contexts, from all possible shifts. The shifts apply to all series
       each time. Each time we use the last n values (where n is the size of the
       shorter series) Which is also weighted from the ratio of common values.
@@ -415,42 +628,15 @@
                       print(f"Final cc_m = {cc_m}")
               else:
                   cc_m = 0
           else:
               cc_m = 0
           # cc_m  [-1,1] -> [0,1]
 
-          # check common causes-characterizations:
-          if b > 0.000000001:
-              # check common causes-characterizations:
-              common = 0
-
-              edges1 = ignore_order(context1)
-              edges2 = ignore_order(context2)
-
-              for edge in edges1:
-                  for edge2 in edges2:
-                      if edge[0] == edge2[0] and edge[1] == edge2[1]:
-                          common += 1
-
-              if (len(edges1) + len(edges2) - common) > 0:
-                  if common == 0:
-                      jaccard = 0
-                  else:
-                      jaccard = common / (len(edges1) + len(edges2) - common)
-                  similarity = jaccard
-              # there are no samples Jaccard(empty,empty) = ? , in that case we
-      use only first part
-              else:
-                  if a < 0.0000001:
-                      similarity = 1
-                  else:
-                      similarity = None
-          else:
-              similarity = 0
+          similarity=calculate_jaccard(a, context1, context2)
           if similarity is None:
               return cc_m, (cc_m, similarity)
           else:
               return a * cc_m + b * similarity
   def distance_eu_z(context1:_C_o_n_t_e_x_t, context2:_C_o_n_t_e_x_t, a, verbose=False)
       Calculation of similarity between two Context objects based on two
       quantities: 1) The first quantity is based on the Euclidean distance
@@ -567,15 +753,15 @@
                   if a < 0.0000001:
                       similarity = 1
                   else:
                       similarity = None
           else:
               similarity = 0
           if similarity is None:
-              return cc_m, (cc_m, similarity)
+              return cc_m#, (cc_m, similarity)
           else:
               return a * cc_m + b * similarity
   def ignore_order(context1:_C_o_n_t_e_x_t)
       Expand source code
       def ignore_order(context1: Context):
           edges1 = []
 
@@ -646,14 +832,16 @@
       yvss))
           # bound the values to -1 to 1 in the event of precision issues
           return np.maximum(np.minimum(result, 1.0), -1.0)
 ************ IInnddeexx ************
     * ******** SSuuppeerr--mmoodduullee ********
           o _P_d_m_C_o_n_t_e_x_t_._u_t_i_l_s
     * ******** _FF_uu_nn_cc_tt_ii_oo_nn_ss ********
+          o _c_a_l_c_u_l_a_t_e___j_a_c_c_a_r_d
+          o _d_i_s_t_a_n_c_e___3_D___s_b_d___j_a_c_c_a_r_d
           o _d_i_s_t_a_n_c_e___c_c
           o _d_i_s_t_a_n_c_e___e_u___z
           o _i_g_n_o_r_e___o_r_d_e_r
           o _i_g_n_o_r_e___o_r_d_e_r___l_i_s_t
           o _n_e_a_r_e_s_t
           o _n_p___p_e_a_r_s_o_n___c_o_r
 Generated by_p_d_o_c_0_._1_0_._0.
```

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/index.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/index.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/showcontext.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/showcontext.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/simulate_stream.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/simulate_stream.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/Documentation/PdmContext/utils/structure.html` & `pdmcontext-0.1.2/Documentation/PdmContext/utils/structure.html`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/Example.ipynb` & `pdmcontext-0.1.2/src/Example.ipynb`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/dummy_data.csv` & `pdmcontext-0.1.2/src/dummy_data.csv`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/test_main.py` & `pdmcontext-0.1.2/src/test_main.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/.ipynb_checkpoints/Example-checkpoint.ipynb` & `pdmcontext-0.1.2/src/.ipynb_checkpoints/Example-checkpoint.ipynb`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/.ipynb_checkpoints/test_main-checkpoint.py` & `pdmcontext-0.1.2/src/.ipynb_checkpoints/test_main-checkpoint.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/ContextClustering.py` & `pdmcontext-0.1.2/src/PdmContext/ContextClustering.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/ContextGeneration.py` & `pdmcontext-0.1.2/src/PdmContext/ContextGeneration.py`

 * *Files 17% similar despite different names*

```diff
@@ -1,15 +1,220 @@
 import numpy as np
 import statistics
 
 import pandas as pd
 from PdmContext.utils.structure import Eventpoint, Context
 from PdmContext.utils.causal_discovery_functions import calculate_with_pc
 from PdmContext.utils.showcontext import show_context_list, show_context_interpretations
+from pathlib import Path
+import pickle
 
+class ContextGeneratorBatch():
+    def __init__(self,df_data,target,type_of_series,context_horizon="8 hours",Causalityfunct=calculate_with_pc,debug=False,file_path=None):
+        """
+        This version doesn't support interpretation and is created for faster experiments using Context.
+
+        **df_data** The data to consider in context in form of Data Frame.
+
+        ** target** The name of the target source, which will be used as the baseline in order to map different samples
+
+        **type_of_series**: dictionary which define the type of each series (isolated,configuration or continuous)
+         rate to that of the target sample rate.
+
+        **context_horizon** The time period to look back for context data, the form of that parameter is "8 hours"
+
+        **Causalityfunct** the causality discovery method to use to produce causal relationships between context data,
+            This must be a function with parameters two equal size lists, one with names and the other
+            with data (a list of list or 2D numpy array).
+
+        **debug** If it runs on debug mode
+
+        **file_path** Store the results of context in pickle file, considered only when it is not None.
+        """
+
+        self.file_path=file_path
+        self.debug=debug
+        self.target=target
+        self.df_data=df_data
+
+
+        self.contexts=self._load_contexts()
+
+        self.causality_discovery=Causalityfunct
+        self.buffer=[]
+
+
+        #helpers
+        self.type_of_series = type_of_series
+        self.horizon = context_horizon.split(" ")[0]
+        if len(context_horizon.split(" ")) == 1:
+            self.horizon_time = "hours"
+        else:
+            if context_horizon.split(" ")[1] in ["days", "hours", "minutes", "seconds"]:
+                self.horizon_time = context_horizon.split(" ")[1]
+            else:
+                assert False, "Time horizon must be either a single number or in form of \"8 hours\" where acceptable time frames are hours,days,minutes,seconds"
+
+        self.horizon = int(self.horizon)
+        self.interpret_history_pos = 0
+        self.context_pos = 0
+
+
+    def generate_context(self,datetime_index):
+        contextpbject, target_series_name,time_index=self.create_context(datetime_index)
+
+        self.contexts[time_index]=contextpbject
+
+        return contextpbject
+
+    def _save_contexts(self):
+        if self.file_path is None:
+            return
+        with open(self.file_path, 'wb') as f:
+            pickle.dump(self.contexts, f)
+
+    def _load_contexts(self):
+        if self.file_path is None:
+            return {}
+
+        my_file = Path(self.file_path)
+        if my_file.is_file():
+            with open(self.file_path, 'rb') as f:
+                return pickle.load(f)
+        else:
+            return  {}
+    def create_context(self, datetime_index):
+
+        start_index = datetime_index - pd.Timedelta(self.horizon, self.horizon_time)
+
+        context=self.df_data.loc[start_index:datetime_index]
+
+        allcodes = np.unique(self.df_data.columns)
+        allcodes = [code for code in allcodes]
+        allcodes = set(allcodes)
+
+        ## build target series
+        target_series_name= self.target
+        target_series=context[self.target].values
+
+        ## create series for each source (alldata)
+        alldata = []
+        for col in context.columns:
+            alldata.append((col, context[col].values))
+        # end = time.time()
+        # print(f"Create series: {end-start}")
+
+        storing = self.calculate_edges(alldata, context.index[-1])
+        storing["characterization"] = self.getcaracterize(storing)
+
+        # print(f"Calculate edges: {end - start}")
+        # print("========================")
+
+        contextpbject = Context.context_from_dict(storing)
+        return contextpbject, target_series_name,context.index[-1]
+
+    def calculate_edges(self,alldata, timestamp):
+        #start = time.time()
+        storing = {}
+        storing["timestamp"] = timestamp
+
+        alldata_names = [nn[0] for nn in alldata]
+        alldata_data = [nn[1] for nn in alldata]
+
+        for namedd, datadd in zip(alldata_names, alldata_data):
+            storing[namedd] = datadd
+
+        # For context with more than two series calculate PC casualities
+        count = len([1 for lista in alldata_data if lista is not None])
+        if count > 1 and len(alldata[0][1]) > 5:
+            alldata_names = [nn[0] for nn in alldata if nn[1] is not None and len(set(nn[1]))>1]
+            alldata_data = [nn[1] for nn in alldata if nn[1] is not None and len(set(nn[1]))>1]
+
+            #end = time.time()
+            #print(f"before {end - start}")
+            #start=time.time()
+
+            if len(alldata) <= 1:
+                edges = []
+            else:
+                edges = self.calculate_causality(np.column_stack(alldata_data), alldata_names)
+            #end=time.time()
+            #print(f"actual edge calculation {end-start}")
+            if edges is None:
+                singleedges = []
+            else:
+                singleedges = edges
+            # print(edges)
+            storing["edges"] = singleedges
+            return storing
+        storing["edges"] = []
+        return storing
+
+    def calculate_causality(self, dataor, names):
+        num_time_series = len(dataor)
+        data = np.array(dataor)
+        edges = self.causality_discovery(names, data)
+        # edges=self.calculatewithPc(names,data)
+        # edges=self.calculatewith_fci(names,data)
+        # edges=self.salesforcePC(names,data)
+        return edges
+    def getcaracterize(self,context):
+        edges = context["edges"]
+        characterizations = []
+        for edge in edges:
+            name1 = edge[0]
+            name2 = edge[1]
+            values1 = context[name1]
+            values2 = [float(kati) for kati in context[name2]]
+
+            occurence=len(values1)-1
+            for i in range(len(values1)-2,0,-1):
+                if values1[i] != values1[-1]:
+                    occurence = i+1
+                    break
+            previusoccurence = 0
+            for i in range(occurence-2,0,-1):
+                if values1[i] !=  values1[occurence-1]:
+                    previusoccurence = i
+
+            if occurence - previusoccurence < 2:  # or len(values2)-occurence<2:
+                characterizations.append("uknown")
+                continue
+            values2before = values2[previusoccurence:occurence]
+            # stdv = statistics.stdev(values2before)
+            # mean = statistics.stdev(values2before)
+            # values2before=[v if v<mean+5*stdv else mean for v in values2before]
+
+            # values2after=values2[occurence:]
+            values2after = [values2[-1]]
+            # stdv = statistics.stdev(values2after)
+            # mean = statistics.stdev(values2after)
+            # values2after = [v if v < mean + 3 * stdv else mean for v in values2after]
+
+            stdv = statistics.stdev(values2before)
+            if len(values2before) == 0:
+                char = "uknown"
+            elif statistics.median(values2before) - statistics.median(values2after) > 2 * stdv:
+                char = "decrease"
+            elif statistics.median(values2after) - statistics.median(values2before) > 2 * stdv:
+                char = "increase"
+            else:
+                char = "uknown"
+            characterizations.append(char)
+        return characterizations
+
+
+    def __del__(self):
+        if self.file_path is None:
+            return
+        my_file = Path(self.file_path)
+        if my_file.is_file():
+            return
+        else:
+            self._save_contexts()
 
 class ContextGenerator:
 
     def __init__(self, target, context_horizon="8", Causalityfunct=calculate_with_pc, debug=False):
         """
         This Class handle the Context Generation. It keeps an internal buffer to build the context for a target series based
         on the provided context_horizon. All data are passed though the collect_data method, which return a correspoding
@@ -49,15 +254,15 @@
             else:
                 assert False, "Time horizon must be either a single number or in form of \"8 hours\" where acceptable time frames are hours,days,minutes,seconds"
 
         self.horizon = int(self.horizon)
         self.interpret_history_pos = 0
         self.context_pos = 0
 
-    def collect_data(self, timestamp, source, name, value=None, type="Univariate"):
+    def collect_data(self, timestamp, source, name, value=None, type="Univariate",replace=[]):
         '''
         This method is used when data are passed iteratively, and stored in buffer
         When data of target source arrive, a corresponding context is produced.
         Sources can be of different sample rate (all sources are mapped to the targets sample rate when context is produced)
 
         Sources can be of either:
 
@@ -76,35 +281,45 @@
 
         **name**: The name (or identifier) of the arrived value
 
         **value**: The value (float), in case this is None the arrived data is considered as event
 
         **type**: the type of the data can be one of "isolated","configuration" when no value is passed
 
+        **replace**: a list of tuples, which define a replacement policy. If a tuple (e,b) exist in replace list, then
+        when a b event is inserted, it will replace an e event with the same timestamp (if exists).
+
         **return**:  structure.Context object when the data name match to the target name or None.
         '''
 
         if value is None:
             if type not in ["isolated", "configuration"]:
                 assert False, "The type must be defined as one of \"isolated\" and \"configuration\" when no value is passed"
         eventpoint = Eventpoint(code=name, source=source, timestamp=timestamp, details=value, type=type)
-        self.add_to_buffer(eventpoint)
+        self.add_to_buffer(eventpoint,replace)
         if self.target == name or self.target == f"{name}@{source}":
             contextobject = self.generate_context(e=eventpoint, buffer=self.buffer)
             return contextobject
         else:
             return None
 
-    def add_to_buffer(self, e: Eventpoint):
+    def add_to_buffer(self, e: Eventpoint, replace: list):
         """
         Adds an Event point to the buffer (keeping the buffer time ordered)
         """
         index = len(self.buffer)
         for i in range(len(self.buffer) - 1, 0, -1):
-            if self.buffer[i].timestamp <= e.timestamp:
+            # check for replacement
+            if self.buffer[i].timestamp == e.timestamp:
+                for rep in replace:
+                    if self.buffer[i].code==rep[0] and e.code==rep[1]:
+                        self.buffer[i]=e
+                        return
+                index = i + 1
+            if self.buffer[i].timestamp < e.timestamp:
                 index = i + 1
                 break
         if index == len(self.buffer):
             self.buffer.append(e)
         else:
             self.buffer = self.buffer[: index] + [e] + self.buffer[index:]
```

### Comparing `pdmcontext-0.1.1/src/PdmContext/Pipelines.py` & `pdmcontext-0.1.2/src/PdmContext/Pipelines.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/utils/causal_discovery_functions.py` & `pdmcontext-0.1.2/src/PdmContext/utils/causal_discovery_functions.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/utils/dbconnector.py` & `pdmcontext-0.1.2/src/PdmContext/utils/dbconnector.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/utils/distances.py` & `pdmcontext-0.1.2/src/PdmContext/utils/distances.py`

 * *Files 18% similar despite different names*

```diff
@@ -130,15 +130,15 @@
             if a < 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
     if similarity is None:
-        return cc_m, (cc_m, similarity)
+        return cc_m#, (cc_m, similarity)
     else:
         return a * cc_m + b * similarity
 
 
 def _z_norm(series):
     if min(series) != max(series):
         ms1 = statistics.mean(series)
@@ -217,15 +217,97 @@
                 print(f"Final cc_m = {cc_m}")
         else:
             cc_m = 0
     else:
         cc_m = 0
     # cc_m  [-1,1] -> [0,1]
 
+    similarity=calculate_jaccard(a, context1, context2)
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity
+
+
+def distance_3D_sbd_jaccard(context1: Context, context2: Context, a, verbose=False):
+    """
+    Calculation of similarity between two Context objects based on two quantities:
+        1) The first quantity is based on the 3d sbd distance upon all context data.
+        2) Jaccard similarity of the edges in the CR (if we ignore the direction)
+
+    **context1**: A context object
+
+    **context2**: A context object
+
+    **a**: the weight of SBD similarity
+
+    **verbose**:
+
+    **return**: a similarity between 0 and 1
+    """
+    import kshape.core as kcore
+
+    #print("========================================")
+    #step1=time.time()
+    b = 1 - a
+    common_values = []
+    uncommon_values = []
+    for key in context1.CD.keys():
+        if key in context2.CD.keys() and context1.CD[key] is not None and context2.CD[key] is not None:
+            common_values.append(key)
+        else:
+            uncommon_values.append(key)
+    for key in context2.CD.keys():
+        if key not in context1.CD.keys():
+            uncommon_values.append(key)
+    #step2 = time.time()
+    #print(f"{step2-step1} : common_names")
+    context1series=[]
+    context2series=[]
+    if len(common_values) > 0 and a > 0.0000000001 and len(context2.CD[common_values[0]]) > 5 and len(context1.CD[common_values[0]]) > 5:
+        All_common_cc = []
+        sizee = min(len(context1.CD[common_values[0]]), len(context2.CD[common_values[0]]))
+        for key in common_values:
+            #step11 = time.time()
+            All_common_cc.append(key)
+            firtsseries = context1.CD[key][-sizee:]
+            secondseries = context2.CD[key][-sizee:]
+            # step21 = time.time()
+            # print(f"{step21 - step11} : cut")
+            #firtsseries = _z_norm_np(firtsseries)
+            #secondseries = _z_norm_np(secondseries)
+            # step31 = time.time()
+            # print(f"{step31 - step21} : normalize")
+            context1series.append(firtsseries)
+            context2series.append(secondseries)
+        #step3 = time.time()
+        #print(f"{step3 - step2} : normalize and gather")
+        in_cc_m = np.max(kcore._ncc_c_3dim([np.array(context1series), np.array(context2series)]))
+        #step4 = time.time()
+        #print(f"{step4 - step3} : SBD")
+        cc_m = in_cc_m * len(All_common_cc) / (len(All_common_cc) + len(uncommon_values))
+        if verbose:
+            print(f"Common cc_m = {in_cc_m}")
+            print(f"uncommon_values: {len(uncommon_values)}")
+            print(f"Final cc_m = {cc_m}")
+    else:
+        cc_m = 0
+    # cc_m  [-1,1] -> [0,1]
+
     # check common causes-characterizations:
+    similarity=calculate_jaccard(a, context1, context2)
+
+    if similarity is None:
+        return cc_m, (cc_m, similarity)
+    else:
+        return a * cc_m + b * similarity,(cc_m, similarity)
+
+
+def calculate_jaccard(a,context1,context2):
+    b=1-a
     if b > 0.000000001:
         # check common causes-characterizations:
         common = 0
 
         edges1 = ignore_order(context1)
         edges2 = ignore_order(context2)
 
@@ -244,18 +326,15 @@
         else:
             if a < 0.0000001:
                 similarity = 1
             else:
                 similarity = None
     else:
         similarity = 0
-    if similarity is None:
-        return cc_m, (cc_m, similarity)
-    else:
-        return a * cc_m + b * similarity
+    return similarity
 
 
 def ignore_order(context1: Context):
     edges1 = []
 
     for edge in context1.CR['edges']:
         if edge[0] > edge[1]:
```

### Comparing `pdmcontext-0.1.1/src/PdmContext/utils/showcontext.py` & `pdmcontext-0.1.2/src/PdmContext/utils/showcontext.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/utils/simulate_stream.py` & `pdmcontext-0.1.2/src/PdmContext/utils/simulate_stream.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/PdmContext/utils/structure.py` & `pdmcontext-0.1.2/src/PdmContext/utils/structure.py`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/images/CDextraction.png` & `pdmcontext-0.1.2/src/images/CDextraction.png`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/src/images/.ipynb_checkpoints/CDextraction-checkpoint.png` & `pdmcontext-0.1.2/src/images/.ipynb_checkpoints/CDextraction-checkpoint.png`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/README.md` & `pdmcontext-0.1.2/README.md`

 * *Files identical despite different names*

### Comparing `pdmcontext-0.1.1/pyproject.toml` & `pdmcontext-0.1.2/pyproject.toml`

 * *Files 1% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 [project]
 name = "PdmContext"
-version = "0.1.1"
+version = "0.1.2"
 authors = [
   { name="Apostolos Giannoulidis", email="agiannous@csd.auth.gr" },
 ]
 description = "Context is used here to provide a better understanding of how changes in data affect anomaly detection task. Essentially, Context represent the data (CD), existing in a time window, and their relationships (CR), where the relationships are extracted using causal discovery between the data (the causal discovery method can be user defiend)."
 readme = "README.md"
 requires-python = ">=3.8"
```

### Comparing `pdmcontext-0.1.1/PKG-INFO` & `pdmcontext-0.1.2/PKG-INFO`

 * *Files 0% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.3
 Name: PdmContext
-Version: 0.1.1
+Version: 0.1.2
 Summary: Context is used here to provide a better understanding of how changes in data affect anomaly detection task. Essentially, Context represent the data (CD), existing in a time window, and their relationships (CR), where the relationships are extracted using causal discovery between the data (the causal discovery method can be user defiend).
 Project-URL: Homepage, https://github.com/agiannoul/PdMContext
 Project-URL: Issues, https://github.com/agiannoul/PdMContext/issues
 Project-URL: documentation, https://pd-m-context.vercel.app/
 Author-email: Apostolos Giannoulidis <agiannous@csd.auth.gr>
 Classifier: License :: OSI Approved :: MIT License
 Classifier: Operating System :: OS Independent
```

