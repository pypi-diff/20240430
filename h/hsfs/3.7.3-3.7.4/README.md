# Comparing `tmp/hsfs-3.7.3.tar.gz` & `tmp/hsfs-3.7.4.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "hsfs-3.7.3.tar", last modified: Thu Apr 25 17:32:47 2024, max compression
+gzip compressed data, was "hsfs-3.7.4.tar", last modified: Tue Apr 30 07:24:03 2024, max compression
```

## Comparing `hsfs-3.7.3.tar` & `hsfs-3.7.4.tar`

### file list

```diff
@@ -1,135 +1,135 @@
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.847803 hsfs-3.7.3/
--rw-r--r--   0     1006     1006       40 2024-01-11 15:40:27.000000 hsfs-3.7.3/MANIFEST.in
--rw-r--r--   0     1006     1006     8377 2024-04-25 17:32:47.843803 hsfs-3.7.3/PKG-INFO
--rw-r--r--   0     1006     1006     5950 2024-04-25 17:32:46.000000 hsfs-3.7.3/README.md
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.803803 hsfs-3.7.3/hsfs/
--rw-r--r--   0     1006     1006     1421 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/__init__.py
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.807803 hsfs-3.7.3/hsfs/client/
--rw-r--r--   0     1006     1006     1694 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/client/__init__.py
--rw-r--r--   0     1006     1006     1401 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/client/auth.py
--rw-r--r--   0     1006     1006     9570 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/client/base.py
--rw-r--r--   0     1006     1006     3028 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/client/exceptions.py
--rw-r--r--   0     1006     1006    13155 2024-04-15 10:29:25.000000 hsfs-3.7.3/hsfs/client/external.py
--rw-r--r--   0     1006     1006     6207 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/client/hopsworks.py
--rw-r--r--   0     1006     1006    15180 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/client/online_store_rest_client.py
--rw-r--r--   0     1006     1006     1554 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/code.py
--rw-r--r--   0     1006     1006    14393 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/connection.py
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.811803 hsfs-3.7.3/hsfs/constructor/
--rw-r--r--   0     1006     1006      605 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/constructor/__init__.py
--rw-r--r--   0     1006     1006     1497 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/external_feature_group_alias.py
--rw-r--r--   0     1006     1006     5612 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/filter.py
--rw-r--r--   0     1006     1006     3635 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/fs_query.py
--rw-r--r--   0     1006     1006     1749 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/hudi_feature_group_alias.py
--rw-r--r--   0     1006     1006     2161 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/join.py
--rw-r--r--   0     1006     1006     1587 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/prepared_statement_parameter.py
--rw-r--r--   0     1006     1006    29539 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/query.py
--rw-r--r--   0     1006     1006     3349 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/constructor/serving_prepared_statement.py
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.843803 hsfs-3.7.3/hsfs/core/
--rw-r--r--   0     1006     1006      605 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/__init__.py
--rw-r--r--   0     1006     1006    15490 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/arrow_flight_client.py
--rw-r--r--   0     1006     1006     4156 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/builtin_transformation_function.py
--rw-r--r--   0     1006     1006     1853 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/code_api.py
--rw-r--r--   0     1006     1006     2032 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/code_engine.py
--rw-r--r--   0     1006     1006     3629 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/dataset_api.py
--rw-r--r--   0     1006     1006     7809 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/delta_engine.py
--rw-r--r--   0     1006     1006     1040 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/deltastreamer_jobconf.py
--rw-r--r--   0     1006     1006     1627 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/execution.py
--rw-r--r--   0     1006     1006     5396 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/expectation_api.py
--rw-r--r--   0     1006     1006     2632 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/expectation_engine.py
--rw-r--r--   0     1006     1006     6356 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/expectation_suite_api.py
--rw-r--r--   0     1006     1006     4060 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/expectation_suite_engine.py
--rw-r--r--   0     1006     1006     9810 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/explicit_provenance.py
--rw-r--r--   0     1006     1006     6198 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/external_feature_group_engine.py
--rw-r--r--   0     1006     1006    11207 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_descriptive_statistics.py
--rw-r--r--   0     1006     1006    13837 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_group_api.py
--rw-r--r--   0     1006     1006     6663 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_group_base_engine.py
--rw-r--r--   0     1006     1006    14833 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_group_engine.py
--rw-r--r--   0     1006     1006    34734 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_monitoring_config.py
--rw-r--r--   0     1006     1006    10497 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_monitoring_config_api.py
--rw-r--r--   0     1006     1006    21382 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_monitoring_config_engine.py
--rw-r--r--   0     1006     1006     7864 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_monitoring_result.py
--rw-r--r--   0     1006     1006     5921 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_monitoring_result_api.py
--rw-r--r--   0     1006     1006    24868 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_monitoring_result_engine.py
--rw-r--r--   0     1006     1006     1238 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/feature_store_api.py
--rw-r--r--   0     1006     1006    10499 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_view_api.py
--rw-r--r--   0     1006     1006    32376 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/feature_view_engine.py
--rw-r--r--   0     1006     1006     5023 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/great_expectation_engine.py
--rw-r--r--   0     1006     1006      828 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/hosts_api.py
--rw-r--r--   0     1006     1006    11737 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/hudi_engine.py
--rw-r--r--   0     1006     1006     1229 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/ingestion_job.py
--rw-r--r--   0     1006     1006     2262 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/ingestion_job_conf.py
--rw-r--r--   0     1006     1006     1087 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/inode.py
--rw-r--r--   0     1006     1006     8626 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/job.py
--rw-r--r--   0     1006     1006     2814 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/job_api.py
--rw-r--r--   0     1006     1006     2065 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/job_configuration.py
--rw-r--r--   0     1006     1006     3079 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/job_schedule.py
--rw-r--r--   0     1006     1006     1205 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/kafka_api.py
--rw-r--r--   0     1006     1006    11557 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/monitoring_window_config.py
--rw-r--r--   0     1006     1006    17012 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/monitoring_window_config_engine.py
--rw-r--r--   0     1006     1006     8709 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/online_store_rest_client_api.py
--rw-r--r--   0     1006     1006    32516 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/online_store_rest_client_engine.py
--rw-r--r--   0     1006     1006     3090 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/opensearch.py
--rw-r--r--   0     1006     1006     4419 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/opensearch_api.py
--rw-r--r--   0     1006     1006      898 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/project_api.py
--rw-r--r--   0     1006     1006     1093 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/query_constructor_api.py
--rw-r--r--   0     1006     1006      875 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/services_api.py
--rw-r--r--   0     1006     1006     1981 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/spine_group_engine.py
--rw-r--r--   0     1006     1006    12655 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/statistics_api.py
--rw-r--r--   0     1006     1006    20903 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/statistics_engine.py
--rw-r--r--   0     1006     1006     3072 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/storage_connector_api.py
--rw-r--r--   0     1006     1006     4696 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/tags_api.py
--rw-r--r--   0     1006     1006     6685 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/training_dataset_api.py
--rw-r--r--   0     1006     1006     6210 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/training_dataset_engine.py
--rw-r--r--   0     1006     1006     2148 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/training_dataset_job_conf.py
--rw-r--r--   0     1006     1006     4161 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/core/transformation_function_api.py
--rw-r--r--   0     1006     1006    12712 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/transformation_function_engine.py
--rw-r--r--   0     1006     1006     4773 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/validation_report_api.py
--rw-r--r--   0     1006     1006     3640 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/validation_report_engine.py
--rw-r--r--   0     1006     1006     2158 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/validation_result_api.py
--rw-r--r--   0     1006     1006     5469 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/validation_result_engine.py
--rw-r--r--   0     1006     1006     2297 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/variable_api.py
--rw-r--r--   0     1006     1006    11843 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/vector_db_client.py
--rwxr-xr-x   0     1006     1006    41829 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/core/vector_server.py
--rw-r--r--   0     1006     1006     1655 2024-01-11 15:40:27.000000 hsfs-3.7.3/hsfs/decorators.py
--rw-r--r--   0     1006     1006     5552 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/embedding.py
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.843803 hsfs-3.7.3/hsfs/engine/
--rw-r--r--   0     1006     1006     2486 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/engine/__init__.py
--rw-r--r--   0     1006     1006    53838 2024-04-25 17:32:42.000000 hsfs-3.7.3/hsfs/engine/python.py
--rw-r--r--   0     1006     1006    47336 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/engine/spark.py
--rw-r--r--   0     1006     1006     1118 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/engine/spark_no_metastore.py
--rw-r--r--   0     1006     1006    23612 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/expectation_suite.py
--rw-r--r--   0     1006     1006     6960 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/feature.py
--rw-r--r--   0     1006     1006   156932 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/feature_group.py
--rw-r--r--   0     1006     1006     3955 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/feature_group_commit.py
--rw-r--r--   0     1006     1006     1992 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/feature_group_writer.py
--rw-r--r--   0     1006     1006    78556 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/feature_store.py
--rw-r--r--   0     1006     1006   163846 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/feature_view.py
--rw-r--r--   0     1006     1006     4822 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/ge_expectation.py
--rw-r--r--   0     1006     1006     8651 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/ge_validation_result.py
--rw-r--r--   0     1006     1006     3456 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/serving_key.py
--rw-r--r--   0     1006     1006     2081 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/split_statistics.py
--rw-r--r--   0     1006     1006     8298 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/statistics.py
--rw-r--r--   0     1006     1006     3331 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/statistics_config.py
--rw-r--r--   0     1006     1006    49738 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/storage_connector.py
--rw-r--r--   0     1006     1006     1868 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/tag.py
--rw-r--r--   0     1006     1006    39576 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/training_dataset.py
--rw-r--r--   0     1006     1006     4836 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/training_dataset_feature.py
--rw-r--r--   0     1006     1006     2816 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/training_dataset_split.py
--rw-r--r--   0     1006     1006     8947 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/transformation_function.py
--rw-r--r--   0     1006     1006     2197 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/transformation_function_attached.py
--rw-r--r--   0     1006     1006     7760 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/usage.py
--rw-r--r--   0     1006     1006     3323 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/user.py
--rw-r--r--   0     1006     1006    15871 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/util.py
--rw-r--r--   0     1006     1006     7537 2024-04-11 18:09:58.000000 hsfs-3.7.3/hsfs/validation_report.py
--rw-r--r--   0     1006     1006      628 2024-04-25 17:32:42.000000 hsfs-3.7.3/hsfs/version.py
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.803803 hsfs-3.7.3/hsfs.egg-info/
--rw-r--r--   0     1006     1006     8377 2024-04-25 17:32:47.000000 hsfs-3.7.3/hsfs.egg-info/PKG-INFO
--rw-r--r--   0     1006     1006     3650 2024-04-25 17:32:47.000000 hsfs-3.7.3/hsfs.egg-info/SOURCES.txt
--rw-r--r--   0     1006     1006        1 2024-04-25 17:32:47.000000 hsfs-3.7.3/hsfs.egg-info/dependency_links.txt
--rw-r--r--   0     1006     1006      892 2024-04-25 17:32:47.000000 hsfs-3.7.3/hsfs.egg-info/requires.txt
--rw-r--r--   0     1006     1006        5 2024-04-25 17:32:47.000000 hsfs-3.7.3/hsfs.egg-info/top_level.txt
--rw-r--r--   0     1006     1006       38 2024-04-25 17:32:47.847803 hsfs-3.7.3/setup.cfg
--rw-r--r--   0     1006     1006     3310 2024-04-11 18:09:58.000000 hsfs-3.7.3/setup.py
-drwxr-xr-x   0     1006     1006        0 2024-04-25 17:32:47.843803 hsfs-3.7.3/tests/
--rw-r--r--   0     1006     1006      605 2024-01-11 15:40:27.000000 hsfs-3.7.3/tests/__init__.py
--rw-r--r--   0     1006     1006    34202 2024-04-11 18:09:58.000000 hsfs-3.7.3/tests/test_storage_connector.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.368218 hsfs-3.7.4/
+-rw-r--r--   0     1006     1006       40 2024-01-11 15:40:27.000000 hsfs-3.7.4/MANIFEST.in
+-rw-r--r--   0     1006     1006     8377 2024-04-30 07:24:03.368218 hsfs-3.7.4/PKG-INFO
+-rw-r--r--   0     1006     1006     5950 2024-04-30 07:24:02.000000 hsfs-3.7.4/README.md
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.352218 hsfs-3.7.4/hsfs/
+-rw-r--r--   0     1006     1006     1421 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/__init__.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.356218 hsfs-3.7.4/hsfs/client/
+-rw-r--r--   0     1006     1006     1694 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/client/__init__.py
+-rw-r--r--   0     1006     1006     1401 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/client/auth.py
+-rw-r--r--   0     1006     1006     9570 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/client/base.py
+-rw-r--r--   0     1006     1006     3028 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/client/exceptions.py
+-rw-r--r--   0     1006     1006    13155 2024-04-15 10:29:25.000000 hsfs-3.7.4/hsfs/client/external.py
+-rw-r--r--   0     1006     1006     6207 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/client/hopsworks.py
+-rw-r--r--   0     1006     1006    15180 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/client/online_store_rest_client.py
+-rw-r--r--   0     1006     1006     1554 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/code.py
+-rw-r--r--   0     1006     1006    14393 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/connection.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.356218 hsfs-3.7.4/hsfs/constructor/
+-rw-r--r--   0     1006     1006      605 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/constructor/__init__.py
+-rw-r--r--   0     1006     1006     1497 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/external_feature_group_alias.py
+-rw-r--r--   0     1006     1006     5612 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/filter.py
+-rw-r--r--   0     1006     1006     3635 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/fs_query.py
+-rw-r--r--   0     1006     1006     1749 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/hudi_feature_group_alias.py
+-rw-r--r--   0     1006     1006     2161 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/join.py
+-rw-r--r--   0     1006     1006     1587 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/prepared_statement_parameter.py
+-rw-r--r--   0     1006     1006    29552 2024-04-26 05:47:12.000000 hsfs-3.7.4/hsfs/constructor/query.py
+-rw-r--r--   0     1006     1006     3349 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/constructor/serving_prepared_statement.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.368218 hsfs-3.7.4/hsfs/core/
+-rw-r--r--   0     1006     1006      605 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/__init__.py
+-rw-r--r--   0     1006     1006    24518 2024-04-26 05:47:12.000000 hsfs-3.7.4/hsfs/core/arrow_flight_client.py
+-rw-r--r--   0     1006     1006     4156 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/builtin_transformation_function.py
+-rw-r--r--   0     1006     1006     1853 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/code_api.py
+-rw-r--r--   0     1006     1006     2032 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/code_engine.py
+-rw-r--r--   0     1006     1006     3629 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/dataset_api.py
+-rw-r--r--   0     1006     1006     7809 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/delta_engine.py
+-rw-r--r--   0     1006     1006     1040 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/deltastreamer_jobconf.py
+-rw-r--r--   0     1006     1006     1627 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/execution.py
+-rw-r--r--   0     1006     1006     5396 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/expectation_api.py
+-rw-r--r--   0     1006     1006     2632 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/expectation_engine.py
+-rw-r--r--   0     1006     1006     6356 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/expectation_suite_api.py
+-rw-r--r--   0     1006     1006     4060 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/expectation_suite_engine.py
+-rw-r--r--   0     1006     1006     9810 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/explicit_provenance.py
+-rw-r--r--   0     1006     1006     6198 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/external_feature_group_engine.py
+-rw-r--r--   0     1006     1006    11212 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/feature_descriptive_statistics.py
+-rw-r--r--   0     1006     1006    16789 2024-04-30 07:23:58.000000 hsfs-3.7.4/hsfs/core/feature_group_api.py
+-rw-r--r--   0     1006     1006     6976 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/feature_group_base_engine.py
+-rw-r--r--   0     1006     1006    14833 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_group_engine.py
+-rw-r--r--   0     1006     1006    34754 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/feature_monitoring_config.py
+-rw-r--r--   0     1006     1006    10497 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_monitoring_config_api.py
+-rw-r--r--   0     1006     1006    21382 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_monitoring_config_engine.py
+-rw-r--r--   0     1006     1006     7864 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_monitoring_result.py
+-rw-r--r--   0     1006     1006     5921 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_monitoring_result_api.py
+-rw-r--r--   0     1006     1006    24868 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_monitoring_result_engine.py
+-rw-r--r--   0     1006     1006     1238 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/feature_store_api.py
+-rw-r--r--   0     1006     1006    10499 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/feature_view_api.py
+-rw-r--r--   0     1006     1006    32375 2024-04-26 05:47:12.000000 hsfs-3.7.4/hsfs/core/feature_view_engine.py
+-rw-r--r--   0     1006     1006     5023 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/great_expectation_engine.py
+-rw-r--r--   0     1006     1006      828 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/hosts_api.py
+-rw-r--r--   0     1006     1006    11709 2024-04-30 07:23:58.000000 hsfs-3.7.4/hsfs/core/hudi_engine.py
+-rw-r--r--   0     1006     1006     1229 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/ingestion_job.py
+-rw-r--r--   0     1006     1006     2262 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/ingestion_job_conf.py
+-rw-r--r--   0     1006     1006     1087 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/inode.py
+-rw-r--r--   0     1006     1006     8626 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/job.py
+-rw-r--r--   0     1006     1006     2814 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/job_api.py
+-rw-r--r--   0     1006     1006     2065 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/job_configuration.py
+-rw-r--r--   0     1006     1006     3079 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/job_schedule.py
+-rw-r--r--   0     1006     1006     1205 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/kafka_api.py
+-rw-r--r--   0     1006     1006    11542 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/monitoring_window_config.py
+-rw-r--r--   0     1006     1006    16985 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/monitoring_window_config_engine.py
+-rw-r--r--   0     1006     1006     8709 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/online_store_rest_client_api.py
+-rw-r--r--   0     1006     1006    32516 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/online_store_rest_client_engine.py
+-rw-r--r--   0     1006     1006     3090 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/opensearch.py
+-rw-r--r--   0     1006     1006     4419 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/opensearch_api.py
+-rw-r--r--   0     1006     1006      898 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/project_api.py
+-rw-r--r--   0     1006     1006     1093 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/query_constructor_api.py
+-rw-r--r--   0     1006     1006      875 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/services_api.py
+-rw-r--r--   0     1006     1006     1981 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/spine_group_engine.py
+-rw-r--r--   0     1006     1006    12655 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/statistics_api.py
+-rw-r--r--   0     1006     1006    20950 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/statistics_engine.py
+-rw-r--r--   0     1006     1006     3072 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/storage_connector_api.py
+-rw-r--r--   0     1006     1006     4696 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/tags_api.py
+-rw-r--r--   0     1006     1006     6685 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/training_dataset_api.py
+-rw-r--r--   0     1006     1006     6210 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/training_dataset_engine.py
+-rw-r--r--   0     1006     1006     2148 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/training_dataset_job_conf.py
+-rw-r--r--   0     1006     1006     4161 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/core/transformation_function_api.py
+-rw-r--r--   0     1006     1006    12712 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/transformation_function_engine.py
+-rw-r--r--   0     1006     1006     4773 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/validation_report_api.py
+-rw-r--r--   0     1006     1006     3640 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/validation_report_engine.py
+-rw-r--r--   0     1006     1006     2158 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/validation_result_api.py
+-rw-r--r--   0     1006     1006     5492 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/core/validation_result_engine.py
+-rw-r--r--   0     1006     1006     2259 2024-04-26 05:47:12.000000 hsfs-3.7.4/hsfs/core/variable_api.py
+-rw-r--r--   0     1006     1006    11843 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/vector_db_client.py
+-rwxr-xr-x   0     1006     1006    41829 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/core/vector_server.py
+-rw-r--r--   0     1006     1006     1655 2024-01-11 15:40:27.000000 hsfs-3.7.4/hsfs/decorators.py
+-rw-r--r--   0     1006     1006     5552 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/embedding.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.368218 hsfs-3.7.4/hsfs/engine/
+-rw-r--r--   0     1006     1006     2486 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/engine/__init__.py
+-rw-r--r--   0     1006     1006    54331 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/engine/python.py
+-rw-r--r--   0     1006     1006    47924 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/engine/spark.py
+-rw-r--r--   0     1006     1006     1118 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/engine/spark_no_metastore.py
+-rw-r--r--   0     1006     1006    23612 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/expectation_suite.py
+-rw-r--r--   0     1006     1006     7022 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/feature.py
+-rw-r--r--   0     1006     1006   157204 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/feature_group.py
+-rw-r--r--   0     1006     1006     3955 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/feature_group_commit.py
+-rw-r--r--   0     1006     1006     1992 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/feature_group_writer.py
+-rw-r--r--   0     1006     1006    79282 2024-04-30 07:23:58.000000 hsfs-3.7.4/hsfs/feature_store.py
+-rw-r--r--   0     1006     1006   164157 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/feature_view.py
+-rw-r--r--   0     1006     1006     4822 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/ge_expectation.py
+-rw-r--r--   0     1006     1006     8651 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/ge_validation_result.py
+-rw-r--r--   0     1006     1006     3456 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/serving_key.py
+-rw-r--r--   0     1006     1006     2081 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/split_statistics.py
+-rw-r--r--   0     1006     1006     8409 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/statistics.py
+-rw-r--r--   0     1006     1006     3366 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/statistics_config.py
+-rw-r--r--   0     1006     1006    49774 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/storage_connector.py
+-rw-r--r--   0     1006     1006     1868 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/tag.py
+-rw-r--r--   0     1006     1006    39842 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/training_dataset.py
+-rw-r--r--   0     1006     1006     4960 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/training_dataset_feature.py
+-rw-r--r--   0     1006     1006     2816 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/training_dataset_split.py
+-rw-r--r--   0     1006     1006     8982 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/transformation_function.py
+-rw-r--r--   0     1006     1006     2197 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/transformation_function_attached.py
+-rw-r--r--   0     1006     1006     7760 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/usage.py
+-rw-r--r--   0     1006     1006     3323 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/user.py
+-rw-r--r--   0     1006     1006    16242 2024-04-30 07:22:38.000000 hsfs-3.7.4/hsfs/util.py
+-rw-r--r--   0     1006     1006     7537 2024-04-11 18:09:58.000000 hsfs-3.7.4/hsfs/validation_report.py
+-rw-r--r--   0     1006     1006      628 2024-04-30 07:23:58.000000 hsfs-3.7.4/hsfs/version.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.352218 hsfs-3.7.4/hsfs.egg-info/
+-rw-r--r--   0     1006     1006     8377 2024-04-30 07:24:03.000000 hsfs-3.7.4/hsfs.egg-info/PKG-INFO
+-rw-r--r--   0     1006     1006     3650 2024-04-30 07:24:03.000000 hsfs-3.7.4/hsfs.egg-info/SOURCES.txt
+-rw-r--r--   0     1006     1006        1 2024-04-30 07:24:03.000000 hsfs-3.7.4/hsfs.egg-info/dependency_links.txt
+-rw-r--r--   0     1006     1006      892 2024-04-30 07:24:03.000000 hsfs-3.7.4/hsfs.egg-info/requires.txt
+-rw-r--r--   0     1006     1006        5 2024-04-30 07:24:03.000000 hsfs-3.7.4/hsfs.egg-info/top_level.txt
+-rw-r--r--   0     1006     1006       38 2024-04-30 07:24:03.368218 hsfs-3.7.4/setup.cfg
+-rw-r--r--   0     1006     1006     3310 2024-04-11 18:09:58.000000 hsfs-3.7.4/setup.py
+drwxr-xr-x   0     1006     1006        0 2024-04-30 07:24:03.368218 hsfs-3.7.4/tests/
+-rw-r--r--   0     1006     1006      605 2024-01-11 15:40:27.000000 hsfs-3.7.4/tests/__init__.py
+-rw-r--r--   0     1006     1006    34202 2024-04-11 18:09:58.000000 hsfs-3.7.4/tests/test_storage_connector.py
```

### Comparing `hsfs-3.7.3/PKG-INFO` & `hsfs-3.7.4/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 Metadata-Version: 2.1
 Name: hsfs
-Version: 3.7.3
+Version: 3.7.4
 Summary: HSFS: An environment independent client to interact with the Hopsworks Featurestore
 Home-page: https://github.com/logicalclocks/feature-store-api
 Author: Hopsworks AB
 Author-email: moritz@logicalclocks.com
 License: Apache License 2.0
-Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.3
+Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.4
 Description: # Hopsworks Feature Store
         
         <p align="center">
           <a href="https://community.hopsworks.ai"><img
             src="https://img.shields.io/discourse/users?label=Hopsworks%20Community&server=https%3A%2F%2Fcommunity.hopsworks.ai"
             alt="Hopsworks Community"
           /></a>
```

#### html2text {}

```diff
@@ -1,12 +1,12 @@
-Metadata-Version: 2.1 Name: hsfs Version: 3.7.3 Summary: HSFS: An environment
+Metadata-Version: 2.1 Name: hsfs Version: 3.7.4 Summary: HSFS: An environment
 independent client to interact with the Hopsworks Featurestore Home-page:
 https://github.com/logicalclocks/feature-store-api Author: Hopsworks AB Author-
 email: moritz@logicalclocks.com License: Apache License 2.0 Download-URL:
-https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.3
+https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.4
 Description: # Hopsworks Feature Store
 _[_H_o_p_s_w_o_r_k_s_ _C_o_m_m_u_n_i_t_y_]_[_H_o_p_s_w_o_r_k_s_ _F_e_a_t_u_r_e_ _S_t_o_r_e_ _D_o_c_u_m_e_n_t_a_t_i_o_n_]_[_P_y_P_i_S_t_a_t_u_s_]_[_S_c_a_l_a_/
                 _J_a_v_a_ _A_r_t_i_f_a_c_t_s_]_[_D_o_w_n_l_o_a_d_s_]_[_C_o_d_e_S_t_y_l_e_][License]
 HSFS is the library to interact with the Hopsworks Feature Store. The library
 makes creating new features, feature groups and training datasets easy. The
 library is environment independent and can be used in two modes: - Spark mode:
 For data engineering jobs that create and write features into the feature store
```

### Comparing `hsfs-3.7.3/README.md` & `hsfs-3.7.4/README.md`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/__init__.py` & `hsfs-3.7.4/hsfs/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/__init__.py` & `hsfs-3.7.4/hsfs/client/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/auth.py` & `hsfs-3.7.4/hsfs/client/auth.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/base.py` & `hsfs-3.7.4/hsfs/client/base.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/exceptions.py` & `hsfs-3.7.4/hsfs/client/exceptions.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/external.py` & `hsfs-3.7.4/hsfs/client/external.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/hopsworks.py` & `hsfs-3.7.4/hsfs/client/hopsworks.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/client/online_store_rest_client.py` & `hsfs-3.7.4/hsfs/client/online_store_rest_client.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/code.py` & `hsfs-3.7.4/hsfs/code.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/connection.py` & `hsfs-3.7.4/hsfs/connection.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/__init__.py` & `hsfs-3.7.4/hsfs/constructor/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/external_feature_group_alias.py` & `hsfs-3.7.4/hsfs/constructor/external_feature_group_alias.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/filter.py` & `hsfs-3.7.4/hsfs/constructor/filter.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/fs_query.py` & `hsfs-3.7.4/hsfs/constructor/fs_query.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/hudi_feature_group_alias.py` & `hsfs-3.7.4/hsfs/constructor/hudi_feature_group_alias.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/join.py` & `hsfs-3.7.4/hsfs/constructor/join.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/prepared_statement_parameter.py` & `hsfs-3.7.4/hsfs/constructor/prepared_statement_parameter.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/constructor/query.py` & `hsfs-3.7.4/hsfs/constructor/query.py`

 * *Files 1% similar despite different names*

```diff
@@ -134,15 +134,15 @@
 
         # Arguments
             online: Read from online storage. Defaults to `False`.
             dataframe_type: DataFrame type to return. Defaults to `"default"`.
             read_options: Dictionary of read options for Spark in spark engine.
                 Only for python engine:
                 * key `"use_hive"` and value `True` to read query with Hive instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key "hive_config" to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 Defaults to `{}`.
 
         # Returns
```

### Comparing `hsfs-3.7.3/hsfs/constructor/serving_prepared_statement.py` & `hsfs-3.7.4/hsfs/constructor/serving_prepared_statement.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/__init__.py` & `hsfs-3.7.4/hsfs/core/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/builtin_transformation_function.py` & `hsfs-3.7.4/hsfs/core/builtin_transformation_function.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/code_api.py` & `hsfs-3.7.4/hsfs/core/code_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/code_engine.py` & `hsfs-3.7.4/hsfs/core/code_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/dataset_api.py` & `hsfs-3.7.4/hsfs/core/dataset_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/delta_engine.py` & `hsfs-3.7.4/hsfs/core/delta_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/deltastreamer_jobconf.py` & `hsfs-3.7.4/hsfs/core/deltastreamer_jobconf.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/execution.py` & `hsfs-3.7.4/hsfs/core/execution.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/expectation_api.py` & `hsfs-3.7.4/hsfs/core/expectation_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/expectation_engine.py` & `hsfs-3.7.4/hsfs/core/expectation_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/expectation_suite_api.py` & `hsfs-3.7.4/hsfs/core/expectation_suite_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/expectation_suite_engine.py` & `hsfs-3.7.4/hsfs/core/expectation_suite_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/explicit_provenance.py` & `hsfs-3.7.4/hsfs/core/explicit_provenance.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/external_feature_group_engine.py` & `hsfs-3.7.4/hsfs/core/external_feature_group_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_descriptive_statistics.py` & `hsfs-3.7.4/hsfs/core/feature_descriptive_statistics.py`

 * *Files 1% similar despite different names*

```diff
@@ -9,19 +9,20 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import humps
 from typing import Optional, Union, Mapping
-from hsfs.util import FeatureStoreEncoder
+from hsfs import util
 
 
 class FeatureDescriptiveStatistics:
     _SINGLE_VALUE_STATISTICS = [
         "count",
         "completeness",
         "num_non_null_values",
@@ -61,17 +62,16 @@
         uniqueness: Optional[float] = None,
         exact_num_distinct_values: Optional[int] = None,
         extended_statistics: Optional[Union[dict, str]] = None,
         id: Optional[int] = None,
         **kwargs,
     ):
         self._id = id
-        self._feature_name = feature_name
         self._feature_type = feature_type
-        self._feature_name = feature_name
+        self._feature_name = util.autofix_feature_name(feature_name)
         self._count = count
         self._completeness = completeness
         self._num_non_null_values = num_non_null_values
         self._num_null_values = num_null_values
         self._approx_num_distinct_values = approx_num_distinct_values
         self._min = min
         self._max = max
@@ -196,15 +196,15 @@
             "percentiles": self._percentiles,
         }
         if self._extended_statistics is not None:
             _dict["extendedStatistics"] = json.dumps(self._extended_statistics)
         return _dict
 
     def json(self) -> str:
-        return json.dumps(self, cls=FeatureStoreEncoder)
+        return json.dumps(self, cls=util.FeatureStoreEncoder)
 
     def __str__(self):
         return self.json()
 
     def __repr__(self) -> str:
         return json.dumps(humps.decamelize(self.to_dict()), indent=2)
```

### Comparing `hsfs-3.7.3/hsfs/core/feature_group_base_engine.py` & `hsfs-3.7.4/hsfs/core/feature_group_base_engine.py`

 * *Files 3% similar despite different names*

```diff
@@ -9,16 +9,18 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 from hsfs.core import feature_group_api, storage_connector_api, tags_api, kafka_api
+from hsfs import util
 from hsfs.client.exceptions import FeatureStoreException
 
 
 class FeatureGroupBaseEngine:
     ENTITY_TYPE = "featuregroups"
 
     def __init__(self, feature_store_id):
@@ -99,60 +101,66 @@
         )
 
     def new_feature_list(self, feature_group, updated_features):
         # take original schema and replaces the updated features and returns the new list
         new_features = []
         for feature in feature_group.features:
             if not any(
-                updated.name.lower() == feature.name for updated in updated_features
+                util.autofix_feature_name(updated.name) == feature.name
+                for updated in updated_features
             ):
                 new_features.append(feature)
         return new_features + updated_features
 
     def _verify_schema_compatibility(self, feature_group_features, dataframe_features):
         err = []
-        feature_df_dict = {feat.name: feat.type for feat in dataframe_features}
+        feature_df_dict = {
+            util.autofix_feature_name(feat.name): feat.type
+            for feat in dataframe_features
+        }
         for feature_fg in feature_group_features:
+            name = util.autofix_feature_name(feature_fg.name)
             fg_type = feature_fg.type.lower().replace(" ", "")
             # check if feature exists dataframe
-            if feature_fg.name in feature_df_dict:
-                df_type = feature_df_dict[feature_fg.name].lower().replace(" ", "")
+            if name in feature_df_dict:
+                df_type = feature_df_dict[name].lower().replace(" ", "")
                 # remove match from lookup table
-                del feature_df_dict[feature_fg.name]
+                del feature_df_dict[name]
 
                 # check if types match
                 if fg_type != df_type:
                     # don't check structs for exact match
                     if fg_type.startswith("struct") and df_type.startswith("struct"):
                         continue
 
                     err += [
-                        f"{feature_fg.name} ("
-                        f"expected type: '{fg_type}', "
+                        f"{name} (expected type: '{fg_type}', "
                         f"derived from input: '{df_type}') has the wrong type."
                     ]
 
             else:
                 err += [
-                    f"{feature_fg.name} (type: '{feature_fg.type}') is missing from "
+                    f"{name} (type: '{feature_fg.type}') is missing from "
                     f"input dataframe."
                 ]
 
         # any features that are left in lookup table are superfluous
         for feature_df_name, feature_df_type in feature_df_dict.items():
             err += [
-                f"{feature_df_name} (type: '{feature_df_type}') does not exist "
+                f"{util.autofix_feature_name(feature_df_name)} (type: '{feature_df_type}') does not exist "
                 f"in feature group."
             ]
 
         # raise exception if any errors were found.
         if len(err) > 0:
             raise FeatureStoreException(
                 "Features are not compatible with Feature Group schema: "
                 + "".join(["\n - " + e for e in err])
+                + "\nNote that feature (or column) names are case insensitive and "
+                "spaces are automatically replaced with underscores."
             )
 
     def get_subject(self, feature_group):
         return self._kafka_api.get_subject(
             feature_group._feature_store_id,
             feature_group.get_fg_name(),
         )
```

### Comparing `hsfs-3.7.3/hsfs/core/feature_group_engine.py` & `hsfs-3.7.4/hsfs/core/feature_group_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_monitoring_config.py` & `hsfs-3.7.4/hsfs/core/feature_monitoring_config.py`

 * *Files 0% similar despite different names*

```diff
@@ -9,21 +9,22 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import humps
 from enum import Enum
 from datetime import datetime, date
 from typing import Any, Dict, List, Optional, Union
-from hsfs.util import FeatureStoreEncoder
+from hsfs import util
 from hsfs.client.exceptions import FeatureStoreException
 
 from hsfs.core import monitoring_window_config as mwc
 from hsfs.core.feature_monitoring_result import FeatureMonitoringResult
 from hsfs.core.job_schedule import JobSchedule
 from hsfs.core import (
     monitoring_window_config_engine,
@@ -201,15 +202,15 @@
 
         the_dict["referenceWindowConfig"] = reference_window_config
         the_dict["statisticsComparisonConfig"] = statistics_comparison_config
 
         return the_dict
 
     def json(self) -> str:
-        return json.dumps(self, cls=FeatureStoreEncoder)
+        return json.dumps(self, cls=util.FeatureStoreEncoder)
 
     def __str__(self):
         return self.json()
 
     def __repr__(self):
         return f"FeatureMonitoringConfig({self._name!r}, {self._feature_monitoring_type!r})"
```

### Comparing `hsfs-3.7.3/hsfs/core/feature_monitoring_config_api.py` & `hsfs-3.7.4/hsfs/core/feature_monitoring_config_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_monitoring_config_engine.py` & `hsfs-3.7.4/hsfs/core/feature_monitoring_config_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_monitoring_result.py` & `hsfs-3.7.4/hsfs/core/feature_monitoring_result.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_monitoring_result_api.py` & `hsfs-3.7.4/hsfs/core/feature_monitoring_result_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_monitoring_result_engine.py` & `hsfs-3.7.4/hsfs/core/feature_monitoring_result_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_store_api.py` & `hsfs-3.7.4/hsfs/core/feature_store_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_view_api.py` & `hsfs-3.7.4/hsfs/core/feature_view_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/feature_view_engine.py` & `hsfs-3.7.4/hsfs/core/feature_view_engine.py`

 * *Files 0% similar despite different names*

```diff
@@ -768,19 +768,19 @@
         return self._feature_view_api.get_parent_feature_groups(
             feature_view_obj.name, feature_view_obj.version
         )
 
     def _check_feature_group_accessibility(self, feature_view_obj):
         if engine.get_type() in ["python", "hive"]:
             if arrow_flight_client.get_instance().is_enabled():
-                if not arrow_flight_client.get_instance().supports(
+                if not arrow_flight_client.supports(
                     feature_view_obj.query.featuregroups
                 ):
                     raise NotImplementedError(
-                        "ArrowFlightServer can only read from cached feature groups"
+                        "Hopsworks Feature Query Service can only read from cached feature groups"
                         " and external feature groups on BigQuery and Snowflake."
                         " When using other external feature groups please use "
                         "`feature_view.create_training_data` instead. "
                         "If you are using spines, use a Spark Kernel."
                     )
             elif not feature_view_obj.query.is_cache_feature_group_only():
                 raise NotImplementedError(
```

### Comparing `hsfs-3.7.3/hsfs/core/great_expectation_engine.py` & `hsfs-3.7.4/hsfs/core/great_expectation_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/hosts_api.py` & `hsfs-3.7.4/hsfs/core/hosts_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/hudi_engine.py` & `hsfs-3.7.4/hsfs/core/hudi_engine.py`

 * *Files 1% similar despite different names*

```diff
@@ -226,18 +226,17 @@
         self, save_empty_dataframe_callback, hudi_fg_alias, read_options
     ):
         fg_table_name = hudi_fg_alias.feature_group._get_table_name()
         if sorted(self._spark_session.table(hudi_fg_alias.alias).columns) != sorted(
             self._spark_session.table(fg_table_name).columns
         ):
             full_fg = self._feature_group_api.get(
-                hudi_fg_alias.feature_group._feature_store_id,
-                hudi_fg_alias.feature_group.name,
-                hudi_fg_alias.feature_group.version,
-                feature_group_api.FeatureGroupApi.CACHED,
+                feature_store_id=hudi_fg_alias.feature_group._feature_store_id,
+                name=hudi_fg_alias.feature_group.name,
+                version=hudi_fg_alias.feature_group.version,
             )
 
             save_empty_dataframe_callback(full_fg)
 
             self.register_temporary_table(
                 hudi_fg_alias,
                 read_options,
```

### Comparing `hsfs-3.7.3/hsfs/core/ingestion_job.py` & `hsfs-3.7.4/hsfs/core/ingestion_job.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/ingestion_job_conf.py` & `hsfs-3.7.4/hsfs/core/ingestion_job_conf.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/inode.py` & `hsfs-3.7.4/hsfs/core/inode.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/job.py` & `hsfs-3.7.4/hsfs/core/job.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/job_api.py` & `hsfs-3.7.4/hsfs/core/job_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/job_configuration.py` & `hsfs-3.7.4/hsfs/core/job_configuration.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/job_schedule.py` & `hsfs-3.7.4/hsfs/core/job_schedule.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/kafka_api.py` & `hsfs-3.7.4/hsfs/core/kafka_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/monitoring_window_config.py` & `hsfs-3.7.4/hsfs/core/monitoring_window_config.py`

 * *Files 0% similar despite different names*

```diff
@@ -13,15 +13,15 @@
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
 import json
 import humps
 from typing import List, Optional, Union
-from hsfs.util import FeatureStoreEncoder
+from hsfs import util
 from enum import Enum
 
 from hsfs.core import monitoring_window_config_engine
 
 
 class WindowConfigType(str, Enum):
     ALL_TIME = "ALL_TIME"
@@ -172,15 +172,15 @@
             the_dict["specificValue"] = self._specific_value
         elif self._window_config_type == WindowConfigType.TRAINING_DATASET:
             the_dict["trainingDatasetVersion"] = self._training_dataset_version
 
         return the_dict
 
     def json(self) -> str:
-        return json.dumps(self, cls=FeatureStoreEncoder)
+        return json.dumps(self, cls=util.FeatureStoreEncoder)
 
     def __str__(self):
         return self.json()
 
     def __repr__(self):
         return f"MonitoringWindowConfig({self._window_config_type!r})"
```

### Comparing `hsfs-3.7.3/hsfs/core/monitoring_window_config_engine.py` & `hsfs-3.7.4/hsfs/core/monitoring_window_config_engine.py`

 * *Files 0% similar despite different names*

```diff
@@ -19,15 +19,15 @@
 
 from hsfs import feature_group, feature_view
 from hsfs.core import monitoring_window_config as mwc
 from hsfs.core.feature_descriptive_statistics import FeatureDescriptiveStatistics
 from hsfs.core import statistics_engine
 from hsfs.training_dataset_split import TrainingDatasetSplit
 from hsfs.client.exceptions import RestAPIError
-from hsfs.util import convert_event_time_to_timestamp
+from hsfs import util
 
 
 class MonitoringWindowConfigEngine:
     _MAX_TIME_RANGE_LENGTH = 12
 
     def __init__(self, **kwargs):
         # No need to initialize anything
@@ -425,8 +425,8 @@
 
         Args:
             event_time: datetime: Event time to round and convert.
 
         Returns:
             datetime: Rounded and converted event time.
         """
-        return convert_event_time_to_timestamp(event_time)
+        return util.convert_event_time_to_timestamp(event_time)
```

### Comparing `hsfs-3.7.3/hsfs/core/online_store_rest_client_api.py` & `hsfs-3.7.4/hsfs/core/online_store_rest_client_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/online_store_rest_client_engine.py` & `hsfs-3.7.4/hsfs/core/online_store_rest_client_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/opensearch.py` & `hsfs-3.7.4/hsfs/core/opensearch.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/opensearch_api.py` & `hsfs-3.7.4/hsfs/core/opensearch_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/project_api.py` & `hsfs-3.7.4/hsfs/core/project_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/query_constructor_api.py` & `hsfs-3.7.4/hsfs/core/query_constructor_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/services_api.py` & `hsfs-3.7.4/hsfs/core/services_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/spine_group_engine.py` & `hsfs-3.7.4/hsfs/core/spine_group_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/statistics_api.py` & `hsfs-3.7.4/hsfs/core/statistics_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/statistics_engine.py` & `hsfs-3.7.4/hsfs/core/statistics_engine.py`

 * *Files 2% similar despite different names*

```diff
@@ -9,25 +9,26 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import warnings
 from typing import List, Union, Optional
 
 from datetime import datetime, date
 
 from hsfs import engine, statistics, util, split_statistics
 from hsfs.client import exceptions
 from hsfs.core import statistics_api, job
-from hsfs.core.feature_descriptive_statistics import FeatureDescriptiveStatistics
+from hsfs.core import feature_descriptive_statistics as fds_mod
 
 
 class StatisticsEngine:
     def __init__(self, feature_store_id, entity_type):
         self._statistics_api = statistics_api.StatisticsApi(
             feature_store_id, entity_type
         )
@@ -428,20 +429,22 @@
             )
         else:
             stats = self._statistics_api.post(
                 metadata_instance, stats=stats, training_dataset_version=None
             )
         return stats
 
-    def _parse_deequ_statistics(self, stats) -> List[FeatureDescriptiveStatistics]:
+    def _parse_deequ_statistics(
+        self, stats
+    ) -> List[fds_mod.FeatureDescriptiveStatistics]:
         if stats is None:
             warnings.warn(
                 "There is no Deequ statistics to deserialize. A possible cause might be that Deequ did not succeed in the statistics computation.",
                 category=util.StatisticsWarning,
             )
             return None
         if isinstance(stats, str):
             stats = json.loads(stats)
         return [
-            FeatureDescriptiveStatistics.from_deequ_json(col_stats)
+            fds_mod.FeatureDescriptiveStatistics.from_deequ_json(col_stats)
             for col_stats in stats["columns"]
         ]
```

### Comparing `hsfs-3.7.3/hsfs/core/storage_connector_api.py` & `hsfs-3.7.4/hsfs/core/storage_connector_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/tags_api.py` & `hsfs-3.7.4/hsfs/core/tags_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/training_dataset_api.py` & `hsfs-3.7.4/hsfs/core/training_dataset_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/training_dataset_engine.py` & `hsfs-3.7.4/hsfs/core/training_dataset_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/training_dataset_job_conf.py` & `hsfs-3.7.4/hsfs/core/training_dataset_job_conf.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/transformation_function_api.py` & `hsfs-3.7.4/hsfs/core/transformation_function_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/transformation_function_engine.py` & `hsfs-3.7.4/hsfs/core/transformation_function_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/validation_report_api.py` & `hsfs-3.7.4/hsfs/core/validation_report_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/validation_report_engine.py` & `hsfs-3.7.4/hsfs/core/validation_report_engine.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/validation_result_api.py` & `hsfs-3.7.4/hsfs/core/validation_result_api.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/validation_result_engine.py` & `hsfs-3.7.4/hsfs/core/validation_result_engine.py`

 * *Files 2% similar despite different names*

```diff
@@ -9,19 +9,20 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 from typing import Union, List, Dict
 from hsfs.core import validation_result_api
 from datetime import datetime, date
-from hsfs.util import convert_event_time_to_timestamp
+from hsfs import util
 
 from hsfs.ge_validation_result import ValidationResult
 from great_expectations.core import ExpectationValidationResult
 
 
 class ValidationResultEngine:
     def __init__(self, feature_store_id: int, feature_group_id: int):
@@ -104,26 +105,26 @@
                     f"Illegal Value {ingestion_filter} in filter_by."
                     + f"Allowed values are {', '.join(allowed_ingestion_filters)}"
                 )
 
         query_params["filter_by"].extend(ingestion_filters)
 
         if start_validation_time and end_validation_time:
-            if convert_event_time_to_timestamp(
+            if util.convert_event_time_to_timestamp(
                 start_validation_time
-            ) > convert_event_time_to_timestamp(end_validation_time):
+            ) > util.convert_event_time_to_timestamp(end_validation_time):
                 raise ValueError(
                     f"start_validation_time : {start_validation_time} is posterior to end_validation_time : {end_validation_time}"
                 )
 
         if start_validation_time:
             query_params["filter_by"].append(
                 "validation_time_gte:"
-                + str(convert_event_time_to_timestamp(start_validation_time))
+                + str(util.convert_event_time_to_timestamp(start_validation_time))
             )
         if end_validation_time:
             query_params["filter_by"].append(
                 "validation_time_lte:"
-                + str(convert_event_time_to_timestamp(end_validation_time))
+                + str(util.convert_event_time_to_timestamp(end_validation_time))
             )
 
         return query_params
```

### Comparing `hsfs-3.7.3/hsfs/core/variable_api.py` & `hsfs-3.7.4/hsfs/core/variable_api.py`

 * *Files 5% similar despite different names*

```diff
@@ -17,17 +17,14 @@
 from hsfs import client
 import re
 
 from hsfs.client.exceptions import RestAPIError
 
 
 class VariableApi:
-    def __init__(self):
-        pass
-
     def get_version(self, software: str):
         _client = client.get_instance()
         path_params = [
             "variables",
             "versions",
         ]
```

### Comparing `hsfs-3.7.3/hsfs/core/vector_db_client.py` & `hsfs-3.7.4/hsfs/core/vector_db_client.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/core/vector_server.py` & `hsfs-3.7.4/hsfs/core/vector_server.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/decorators.py` & `hsfs-3.7.4/hsfs/decorators.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/embedding.py` & `hsfs-3.7.4/hsfs/embedding.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/engine/__init__.py` & `hsfs-3.7.4/hsfs/engine/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/engine/python.py` & `hsfs-3.7.4/hsfs/engine/python.py`

 * *Files 2% similar despite different names*

```diff
@@ -148,30 +148,28 @@
             )
         else:
             return self._jdbc(
                 sql_query, online_conn, dataframe_type, read_options, schema
             )
 
     def is_flyingduck_query_supported(self, query, read_options={}):
-        return arrow_flight_client.get_instance().is_query_supported(
-            query, read_options
-        )
+        return arrow_flight_client.is_query_supported(query, read_options)
 
     def _sql_offline(
         self,
         sql_query,
         feature_store,
         dataframe_type,
         schema=None,
         hive_config=None,
         arrow_flight_config={},
     ):
-        if arrow_flight_client.get_instance().is_flyingduck_query_object(sql_query):
+        if isinstance(sql_query, dict) and "query_string" in sql_query:
             result_df = util.run_with_loading_animation(
-                "Reading data from Hopsworks, using ArrowFlight",
+                "Reading data from Hopsworks, using Hopsworks Feature Query Service",
                 arrow_flight_client.get_instance().read_query,
                 sql_query,
                 arrow_flight_config,
             )
         else:
             with self._create_hive_connection(
                 feature_store, hive_config=hive_config
@@ -273,15 +271,15 @@
         while offset < total_count:
             total_count, inode_list = self._dataset_api.list_files(
                 location, offset, 100
             )
 
             for inode in inode_list:
                 if not self._is_metadata_file(inode.path):
-                    if arrow_flight_client.get_instance().is_data_format_supported(
+                    if arrow_flight_client.is_data_format_supported(
                         data_format, read_options
                     ):
                         arrow_flight_config = read_options.get("arrow_flight_config")
                         df = arrow_flight_client.get_instance().read_path(
                             inode.path, arrow_flight_config
                         )
                     else:
@@ -510,29 +508,41 @@
         pass
 
     def convert_to_default_dataframe(self, dataframe):
         if isinstance(dataframe, pd.DataFrame):
             upper_case_features = [
                 col for col in dataframe.columns if any(re.finditer("[A-Z]", col))
             ]
+            space_features = [col for col in dataframe.columns if " " in col]
 
             # make shallow copy so the original df does not get changed
             # this is always needed to keep the user df unchanged
             dataframe_copy = dataframe.copy(deep=False)
 
             # making a shallow copy of the dataframe so that column names are unchanged
             if len(upper_case_features) > 0:
                 warnings.warn(
                     "The ingested dataframe contains upper case letters in feature names: `{}`. "
                     "Feature names are sanitized to lower case in the feature store.".format(
                         upper_case_features
                     ),
                     util.FeatureGroupWarning,
                 )
-                dataframe_copy.columns = [x.lower() for x in dataframe_copy.columns]
+            if len(space_features) > 0:
+                warnings.warn(
+                    "The ingested dataframe contains feature names with spaces: `{}`. "
+                    "Feature names are sanitized to use underscore '_' in the feature store.".format(
+                        space_features
+                    ),
+                    util.FeatureGroupWarning,
+                    stacklevel=1,
+                )
+            dataframe_copy.columns = [
+                util.autofix_feature_name(x) for x in dataframe_copy.columns
+            ]
 
             # convert timestamps with timezone to UTC
             for col in dataframe_copy.columns:
                 if isinstance(
                     dataframe_copy[col].dtype, pd.core.dtypes.dtypes.DatetimeTZDtype
                 ):
                     dataframe_copy[col] = dataframe_copy[col].dt.tz_convert(None)
@@ -545,15 +555,15 @@
             + "The provided dataframe has type: {}".format(type(dataframe))
         )
 
     def parse_schema_feature_group(self, dataframe, time_travel_format=None):
         arrow_schema = pa.Schema.from_pandas(dataframe, preserve_index=False)
         features = []
         for feat_name in arrow_schema.names:
-            name = feat_name.lower()
+            name = util.autofix_feature_name(feat_name)
             try:
                 converted_type = self._convert_pandas_dtype_to_offline_type(
                     arrow_schema.field(feat_name).type
                 )
             except ValueError as e:
                 raise FeatureStoreException(f"Feature '{name}': {str(e)}")
             features.append(feature.Feature(name, converted_type))
@@ -761,24 +771,22 @@
     ):
         if not feature_view_obj and not isinstance(dataset, query.Query):
             raise Exception(
                 "Currently only query based training datasets are supported by the Python engine"
             )
 
         if (
-            arrow_flight_client.get_instance().is_query_supported(
-                dataset, user_write_options
-            )
+            arrow_flight_client.is_query_supported(dataset, user_write_options)
             and len(training_dataset.splits) == 0
             and len(training_dataset.transformation_functions) == 0
             and training_dataset.data_format == "parquet"
         ):
             query_obj, _ = dataset._prep_read(False, user_write_options)
             response = util.run_with_loading_animation(
-                "Materializing data to Hopsworks, using ArrowFlight",
+                "Materializing data to Hopsworks, using Hopsworks Feature Query Service",
                 arrow_flight_client.get_instance().create_training_dataset,
                 feature_view_obj,
                 training_dataset,
                 query_obj,
                 user_write_options.get("arrow_flight_config", {}),
             )
```

### Comparing `hsfs-3.7.3/hsfs/engine/spark.py` & `hsfs-3.7.4/hsfs/engine/spark.py`

 * *Files 1% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import os
 import shutil
 import json
 import copy
 import importlib.util
 import re
@@ -71,15 +72,15 @@
             return self.items()
 
         setattr(pd.DataFrame, "iteritems", iteritems)
 except ImportError:
     pass
 
 from hsfs import feature, training_dataset_feature, client, util
-from hsfs.feature_group import ExternalFeatureGroup, SpineGroup
+from hsfs import feature_group as fg_mod
 from hsfs.storage_connector import StorageConnector
 from hsfs.client.exceptions import FeatureStoreException
 from hsfs.client import hopsworks
 from hsfs.core import (
     hudi_engine,
     delta_engine,
     transformation_function_engine,
@@ -150,15 +151,15 @@
             sql_query, feature_store, online_conn, "default", read_options
         ).show(n)
 
     def set_job_group(self, group_id, description):
         self._spark_session.sparkContext.setJobGroup(group_id, description)
 
     def register_external_temporary_table(self, external_fg, alias):
-        if not isinstance(external_fg, SpineGroup):
+        if not isinstance(external_fg, fg_mod.SpineGroup):
             external_dataset = external_fg.storage_connector.read(
                 external_fg.query,
                 external_fg.data_format,
                 external_fg.options,
                 external_fg.storage_connector._get_path(external_fg.path),
             )
         else:
@@ -255,25 +256,35 @@
         elif isinstance(dataframe, RDD):
             dataframe = dataframe.toDF()
 
         if isinstance(dataframe, DataFrame):
             upper_case_features = [
                 c for c in dataframe.columns if any(re.finditer("[A-Z]", c))
             ]
+            space_features = [c for c in dataframe.columns if " " in c]
             if len(upper_case_features) > 0:
                 warnings.warn(
                     "The ingested dataframe contains upper case letters in feature names: `{}`. "
                     "Feature names are sanitized to lower case in the feature store.".format(
                         upper_case_features
                     ),
                     util.FeatureGroupWarning,
                 )
+            if len(space_features) > 0:
+                warnings.warn(
+                    "The ingested dataframe contains feature names with spaces: `{}`. "
+                    "Feature names are sanitized to use underscore '_' in the feature store.".format(
+                        space_features
+                    ),
+                    util.FeatureGroupWarning,
+                    stacklevel=1,
+                )
 
             lowercase_dataframe = dataframe.select(
-                [col(x).alias(x.lower()) for x in dataframe.columns]
+                [col(x).alias(util.autofix_feature_name(x)) for x in dataframe.columns]
             )
             # for streaming dataframes this will be handled in DeltaStreamerTransformer.java class
             if not lowercase_dataframe.isStreaming:
                 nullable_schema = copy.deepcopy(lowercase_dataframe.schema)
                 for struct_field in nullable_schema:
                     struct_field.nullable = True
                 lowercase_dataframe = self._spark_session.createDataFrame(
@@ -300,15 +311,15 @@
         storage,
         offline_write_options,
         online_write_options,
         validation_id=None,
     ):
         try:
             if (
-                isinstance(feature_group, ExternalFeatureGroup)
+                isinstance(feature_group, fg_mod.ExternalFeatureGroup)
                 and feature_group.online_enabled
             ) or feature_group.stream:
                 self._save_online_dataframe(
                     feature_group, dataframe, online_write_options
                 )
             else:
                 if storage == "offline" or not online_enabled:
@@ -911,32 +922,32 @@
             options.update(provided_options)
         return options
 
     def parse_schema_feature_group(self, dataframe, time_travel_format=None):
         features = []
         using_hudi = time_travel_format == "HUDI"
         for feat in dataframe.schema:
-            name = feat.name.lower()
+            name = util.autofix_feature_name(feat.name)
             try:
                 converted_type = Engine.convert_spark_type_to_offline_type(
                     feat.dataType, using_hudi
                 )
             except ValueError as e:
-                raise FeatureStoreException(f"Feature '{name}': {str(e)}")
+                raise FeatureStoreException(f"Feature '{feat.name}': {str(e)}") from e
             features.append(
                 feature.Feature(
                     name, converted_type, feat.metadata.get("description", None)
                 )
             )
         return features
 
     def parse_schema_training_dataset(self, dataframe):
         return [
             training_dataset_feature.TrainingDatasetFeature(
-                feat.name.lower(), feat.dataType.simpleString()
+                util.autofix_feature_name(feat.name), feat.dataType.simpleString()
             )
             for feat in dataframe.schema
         ]
 
     def setup_storage_connector(self, storage_connector, path=None):
         if storage_connector.type == StorageConnector.S3:
             return self._setup_s3_hadoop_conf(storage_connector, path)
```

### Comparing `hsfs-3.7.3/hsfs/engine/spark_no_metastore.py` & `hsfs-3.7.4/hsfs/engine/spark_no_metastore.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/expectation_suite.py` & `hsfs-3.7.4/hsfs/expectation_suite.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/feature.py` & `hsfs-3.7.4/hsfs/feature.py`

 * *Files 1% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import humps
 import json
 
 from hsfs import util
 from hsfs.constructor import filter
 
@@ -39,16 +40,16 @@
         partition=None,
         hudi_precombine_key=None,
         online_type=None,
         default_value=None,
         feature_group_id=None,
         feature_group=None,
         **kwargs,
-    ):
-        self._name = name.lower()
+    ) -> None:
+        self._name = util.autofix_feature_name(name)
         self._type = type
         self._description = description
         self._primary = primary or False
         self._partition = partition or False
         self._hudi_precombine_key = hudi_precombine_key or False
         self._online_type = online_type
         self._default_value = default_value
```

### Comparing `hsfs-3.7.3/hsfs/feature_group.py` & `hsfs-3.7.4/hsfs/feature_group.py`

 * *Files 0% similar despite different names*

```diff
@@ -31,9779 +31,9796 @@
 000001e0: 6573 7320 6f72 2069 6d70 6c69 6564 2e0a  ess or implied..
 000001f0: 2320 2020 5365 6520 7468 6520 4c69 6365  #   See the Lice
 00000200: 6e73 6520 666f 7220 7468 6520 7370 6563  nse for the spec
 00000210: 6966 6963 206c 616e 6775 6167 6520 676f  ific language go
 00000220: 7665 726e 696e 6720 7065 726d 6973 7369  verning permissi
 00000230: 6f6e 7320 616e 640a 2320 2020 6c69 6d69  ons and.#   limi
 00000240: 7461 7469 6f6e 7320 756e 6465 7220 7468  tations under th
-00000250: 6520 4c69 6365 6e73 652e 0a23 0a0a 696d  e License..#..im
-00000260: 706f 7274 2063 6f70 790a 696d 706f 7274  port copy.import
-00000270: 2074 696d 650a 0a66 726f 6d20 6873 6673   time..from hsfs
-00000280: 2e65 6d62 6564 6469 6e67 2069 6d70 6f72  .embedding impor
-00000290: 7420 456d 6265 6464 696e 6749 6e64 6578  t EmbeddingIndex
-000002a0: 0a66 726f 6d20 6873 6673 2e67 655f 7661  .from hsfs.ge_va
-000002b0: 6c69 6461 7469 6f6e 5f72 6573 756c 7420  lidation_result 
-000002c0: 696d 706f 7274 2056 616c 6964 6174 696f  import Validatio
-000002d0: 6e52 6573 756c 740a 696d 706f 7274 2068  nResult.import h
-000002e0: 756d 7073 0a69 6d70 6f72 7420 6a73 6f6e  umps.import json
-000002f0: 0a69 6d70 6f72 7420 7761 726e 696e 6773  .import warnings
-00000300: 0a69 6d70 6f72 7420 7061 6e64 6173 2061  .import pandas a
-00000310: 7320 7064 0a69 6d70 6f72 7420 6e75 6d70  s pd.import nump
-00000320: 7920 6173 206e 700a 696d 706f 7274 2067  y as np.import g
-00000330: 7265 6174 5f65 7870 6563 7461 7469 6f6e  reat_expectation
-00000340: 7320 6173 2067 650a 696d 706f 7274 2061  s as ge.import a
-00000350: 7672 6f2e 7363 6865 6d61 0a66 726f 6d20  vro.schema.from 
-00000360: 6873 6673 2e63 6f6e 7374 7275 6374 6f72  hsfs.constructor
-00000370: 2e66 696c 7465 7220 696d 706f 7274 2046  .filter import F
-00000380: 696c 7465 722c 204c 6f67 6963 0a66 726f  ilter, Logic.fro
-00000390: 6d20 7479 7069 6e67 2069 6d70 6f72 7420  m typing import 
-000003a0: 4f70 7469 6f6e 616c 2c20 556e 696f 6e2c  Optional, Union,
-000003b0: 2041 6e79 2c20 4469 6374 2c20 4c69 7374   Any, Dict, List
-000003c0: 2c20 5479 7065 5661 722c 2054 7570 6c65  , TypeVar, Tuple
-000003d0: 0a0a 6672 6f6d 2064 6174 6574 696d 6520  ..from datetime 
-000003e0: 696d 706f 7274 2064 6174 6574 696d 652c  import datetime,
-000003f0: 2064 6174 650a 0a66 726f 6d20 6873 6673   date..from hsfs
-00000400: 2069 6d70 6f72 7420 280a 2020 2020 7574   import (.    ut
-00000410: 696c 2c0a 2020 2020 656e 6769 6e65 2c0a  il,.    engine,.
-00000420: 2020 2020 6665 6174 7572 652c 0a20 2020      feature,.   
-00000430: 2075 7365 722c 0a20 2020 2066 6561 7475   user,.    featu
-00000440: 7265 5f67 726f 7570 5f77 7269 7465 722c  re_group_writer,
-00000450: 0a20 2020 2073 746f 7261 6765 5f63 6f6e  .    storage_con
-00000460: 6e65 6374 6f72 2061 7320 7363 2c0a 290a  nector as sc,.).
-00000470: 6672 6f6d 2068 7366 732e 636f 7265 2069  from hsfs.core i
-00000480: 6d70 6f72 7420 280a 2020 2020 6665 6174  mport (.    feat
-00000490: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
-000004a0: 2c0a 2020 2020 7374 6174 6973 7469 6373  ,.    statistics
-000004b0: 5f65 6e67 696e 652c 0a20 2020 2065 7870  _engine,.    exp
-000004c0: 6563 7461 7469 6f6e 5f73 7569 7465 5f65  ectation_suite_e
-000004d0: 6e67 696e 652c 0a20 2020 2076 616c 6964  ngine,.    valid
-000004e0: 6174 696f 6e5f 7265 706f 7274 5f65 6e67  ation_report_eng
-000004f0: 696e 652c 0a20 2020 2063 6f64 655f 656e  ine,.    code_en
-00000500: 6769 6e65 2c0a 2020 2020 6578 7465 726e  gine,.    extern
-00000510: 616c 5f66 6561 7475 7265 5f67 726f 7570  al_feature_group
-00000520: 5f65 6e67 696e 652c 0a20 2020 2073 7069  _engine,.    spi
-00000530: 6e65 5f67 726f 7570 5f65 6e67 696e 652c  ne_group_engine,
-00000540: 0a20 2020 2076 616c 6964 6174 696f 6e5f  .    validation_
-00000550: 7265 7375 6c74 5f65 6e67 696e 652c 0a20  result_engine,. 
-00000560: 2020 206a 6f62 5f61 7069 2c0a 2020 2020     job_api,.    
-00000570: 6665 6174 7572 655f 6d6f 6e69 746f 7269  feature_monitori
-00000580: 6e67 5f63 6f6e 6669 675f 656e 6769 6e65  ng_config_engine
-00000590: 2c0a 2020 2020 6665 6174 7572 655f 6d6f  ,.    feature_mo
-000005a0: 6e69 746f 7269 6e67 5f72 6573 756c 745f  nitoring_result_
-000005b0: 656e 6769 6e65 2c0a 290a 0a66 726f 6d20  engine,.)..from 
-000005c0: 6873 6673 2e73 7461 7469 7374 6963 735f  hsfs.statistics_
-000005d0: 636f 6e66 6967 2069 6d70 6f72 7420 5374  config import St
-000005e0: 6174 6973 7469 6373 436f 6e66 6967 0a66  atisticsConfig.f
-000005f0: 726f 6d20 6873 6673 2e73 7461 7469 7374  rom hsfs.statist
-00000600: 6963 7320 696d 706f 7274 2053 7461 7469  ics import Stati
-00000610: 7374 6963 730a 6672 6f6d 2068 7366 732e  stics.from hsfs.
-00000620: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00000630: 6520 696d 706f 7274 2045 7870 6563 7461  e import Expecta
-00000640: 7469 6f6e 5375 6974 650a 6672 6f6d 2068  tionSuite.from h
-00000650: 7366 732e 7661 6c69 6461 7469 6f6e 5f72  sfs.validation_r
-00000660: 6570 6f72 7420 696d 706f 7274 2056 616c  eport import Val
-00000670: 6964 6174 696f 6e52 6570 6f72 740a 6672  idationReport.fr
-00000680: 6f6d 2068 7366 732e 636f 7265 2069 6d70  om hsfs.core imp
-00000690: 6f72 7420 6665 6174 7572 655f 6d6f 6e69  ort feature_moni
-000006a0: 746f 7269 6e67 5f63 6f6e 6669 6720 6173  toring_config as
-000006b0: 2066 6d63 0a66 726f 6d20 6873 6673 2e63   fmc.from hsfs.c
-000006c0: 6f72 6520 696d 706f 7274 2066 6561 7475  ore import featu
-000006d0: 7265 5f6d 6f6e 6974 6f72 696e 675f 7265  re_monitoring_re
-000006e0: 7375 6c74 2061 7320 666d 720a 6672 6f6d  sult as fmr.from
-000006f0: 2068 7366 732e 636f 6e73 7472 7563 746f   hsfs.constructo
-00000700: 7220 696d 706f 7274 2071 7565 7279 2c20  r import query, 
-00000710: 6669 6c74 6572 0a66 726f 6d20 6873 6673  filter.from hsfs
-00000720: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-00000730: 6e73 2069 6d70 6f72 7420 4665 6174 7572  ns import Featur
-00000740: 6553 746f 7265 4578 6365 7074 696f 6e2c  eStoreException,
-00000750: 2052 6573 7441 5049 4572 726f 720a 6672   RestAPIError.fr
-00000760: 6f6d 2068 7366 732e 636f 7265 2e6a 6f62  om hsfs.core.job
-00000770: 2069 6d70 6f72 7420 4a6f 620a 6672 6f6d   import Job.from
-00000780: 2068 7366 732e 636f 7265 2e76 6172 6961   hsfs.core.varia
-00000790: 626c 655f 6170 6920 696d 706f 7274 2056  ble_api import V
-000007a0: 6172 6961 626c 6541 7069 0a66 726f 6d20  ariableApi.from 
-000007b0: 6873 6673 2e63 6f72 6520 696d 706f 7274  hsfs.core import
-000007c0: 2067 7265 6174 5f65 7870 6563 7461 7469   great_expectati
-000007d0: 6f6e 5f65 6e67 696e 650a 6672 6f6d 2068  on_engine.from h
-000007e0: 7366 732e 636f 7265 2e76 6563 746f 725f  sfs.core.vector_
-000007f0: 6462 5f63 6c69 656e 7420 696d 706f 7274  db_client import
-00000800: 2056 6563 746f 7244 6243 6c69 656e 740a   VectorDbClient.
-00000810: 0a0a 636c 6173 7320 4665 6174 7572 6547  ..class FeatureG
-00000820: 726f 7570 4261 7365 3a0a 2020 2020 6465  roupBase:.    de
-00000830: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
-00000840: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00000850: 2020 6e61 6d65 2c0a 2020 2020 2020 2020    name,.        
-00000860: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-00000870: 2066 6561 7475 7265 7374 6f72 655f 6964   featurestore_id
-00000880: 2c0a 2020 2020 2020 2020 6c6f 6361 7469  ,.        locati
-00000890: 6f6e 2c0a 2020 2020 2020 2020 6576 656e  on,.        even
-000008a0: 745f 7469 6d65 3d4e 6f6e 652c 0a20 2020  t_time=None,.   
-000008b0: 2020 2020 206f 6e6c 696e 655f 656e 6162       online_enab
-000008c0: 6c65 643d 4661 6c73 652c 0a20 2020 2020  led=False,.     
-000008d0: 2020 2069 643d 4e6f 6e65 2c0a 2020 2020     id=None,.    
-000008e0: 2020 2020 656d 6265 6464 696e 675f 696e      embedding_in
-000008f0: 6465 783d 4e6f 6e65 2c0a 2020 2020 2020  dex=None,.      
-00000900: 2020 6578 7065 6374 6174 696f 6e5f 7375    expectation_su
-00000910: 6974 653d 4e6f 6e65 2c0a 2020 2020 2020  ite=None,.      
-00000920: 2020 6f6e 6c69 6e65 5f74 6f70 6963 5f6e    online_topic_n
-00000930: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
-00000940: 2020 746f 7069 635f 6e61 6d65 3d4e 6f6e    topic_name=Non
-00000950: 652c 0a20 2020 2020 2020 206e 6f74 6966  e,.        notif
-00000960: 6963 6174 696f 6e5f 746f 7069 635f 6e61  ication_topic_na
-00000970: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-00000980: 2064 6570 7265 6361 7465 643d 4661 6c73   deprecated=Fals
-00000990: 652c 0a20 2020 2020 2020 202a 2a6b 7761  e,.        **kwa
-000009a0: 7267 732c 0a20 2020 2029 3a0a 2020 2020  rgs,.    ):.    
-000009b0: 2020 2020 7365 6c66 2e5f 7665 7273 696f      self._versio
-000009c0: 6e20 3d20 7665 7273 696f 6e0a 2020 2020  n = version.    
-000009d0: 2020 2020 7365 6c66 2e5f 6e61 6d65 203d      self._name =
-000009e0: 206e 616d 650a 2020 2020 2020 2020 7365   name.        se
-000009f0: 6c66 2e65 7665 6e74 5f74 696d 6520 3d20  lf.event_time = 
-00000a00: 6576 656e 745f 7469 6d65 0a20 2020 2020  event_time.     
-00000a10: 2020 2073 656c 662e 5f6f 6e6c 696e 655f     self._online_
-00000a20: 656e 6162 6c65 6420 3d20 6f6e 6c69 6e65  enabled = online
-00000a30: 5f65 6e61 626c 6564 0a20 2020 2020 2020  _enabled.       
-00000a40: 2073 656c 662e 5f6c 6f63 6174 696f 6e20   self._location 
-00000a50: 3d20 6c6f 6361 7469 6f6e 0a20 2020 2020  = location.     
-00000a60: 2020 2073 656c 662e 5f69 6420 3d20 6964     self._id = id
-00000a70: 0a20 2020 2020 2020 2073 656c 662e 5f73  .        self._s
-00000a80: 7562 6a65 6374 203d 204e 6f6e 650a 2020  ubject = None.  
-00000a90: 2020 2020 2020 7365 6c66 2e5f 6f6e 6c69        self._onli
-00000aa0: 6e65 5f74 6f70 6963 5f6e 616d 6520 3d20  ne_topic_name = 
-00000ab0: 6f6e 6c69 6e65 5f74 6f70 6963 5f6e 616d  online_topic_nam
-00000ac0: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
-00000ad0: 746f 7069 635f 6e61 6d65 203d 2074 6f70  topic_name = top
-00000ae0: 6963 5f6e 616d 650a 2020 2020 2020 2020  ic_name.        
-00000af0: 7365 6c66 2e5f 6e6f 7469 6669 6361 7469  self._notificati
-00000b00: 6f6e 5f74 6f70 6963 5f6e 616d 6520 3d20  on_topic_name = 
-00000b10: 6e6f 7469 6669 6361 7469 6f6e 5f74 6f70  notification_top
-00000b20: 6963 5f6e 616d 650a 2020 2020 2020 2020  ic_name.        
-00000b30: 7365 6c66 2e5f 6465 7072 6563 6174 6564  self._deprecated
-00000b40: 203d 2064 6570 7265 6361 7465 640a 2020   = deprecated.  
-00000b50: 2020 2020 2020 7365 6c66 2e5f 6665 6174        self._feat
-00000b60: 7572 655f 7374 6f72 655f 6964 203d 2066  ure_store_id = f
-00000b70: 6561 7475 7265 7374 6f72 655f 6964 0a20  eaturestore_id. 
-00000b80: 2020 2020 2020 2023 2075 7365 2073 6574         # use set
-00000b90: 7465 7220 666f 7220 636f 7272 6563 7420  ter for correct 
-00000ba0: 636f 6e76 6572 7369 6f6e 0a20 2020 2020  conversion.     
-00000bb0: 2020 2073 656c 662e 6578 7065 6374 6174     self.expectat
-00000bc0: 696f 6e5f 7375 6974 6520 3d20 6578 7065  ion_suite = expe
-00000bd0: 6374 6174 696f 6e5f 7375 6974 650a 2020  ctation_suite.  
-00000be0: 2020 2020 2020 7365 6c66 2e5f 7374 6174        self._stat
-00000bf0: 6973 7469 6373 5f65 6e67 696e 6520 3d20  istics_engine = 
-00000c00: 7374 6174 6973 7469 6373 5f65 6e67 696e  statistics_engin
-00000c10: 652e 5374 6174 6973 7469 6373 456e 6769  e.StatisticsEngi
-00000c20: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
-00000c30: 6665 6174 7572 6573 746f 7265 5f69 642c  featurestore_id,
-00000c40: 2073 656c 662e 454e 5449 5459 5f54 5950   self.ENTITY_TYP
-00000c50: 450a 2020 2020 2020 2020 290a 2020 2020  E.        ).    
-00000c60: 2020 2020 7365 6c66 2e5f 636f 6465 5f65      self._code_e
-00000c70: 6e67 696e 6520 3d20 636f 6465 5f65 6e67  ngine = code_eng
-00000c80: 696e 652e 436f 6465 456e 6769 6e65 2866  ine.CodeEngine(f
-00000c90: 6561 7475 7265 7374 6f72 655f 6964 2c20  eaturestore_id, 
-00000ca0: 7365 6c66 2e45 4e54 4954 595f 5459 5045  self.ENTITY_TYPE
-00000cb0: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00000cc0: 6772 6561 745f 6578 7065 6374 6174 696f  great_expectatio
-00000cd0: 6e5f 656e 6769 6e65 203d 2028 0a20 2020  n_engine = (.   
-00000ce0: 2020 2020 2020 2020 2067 7265 6174 5f65           great_e
-00000cf0: 7870 6563 7461 7469 6f6e 5f65 6e67 696e  xpectation_engin
-00000d00: 652e 4772 6561 7445 7870 6563 7461 7469  e.GreatExpectati
-00000d10: 6f6e 456e 6769 6e65 2866 6561 7475 7265  onEngine(feature
-00000d20: 7374 6f72 655f 6964 290a 2020 2020 2020  store_id).      
-00000d30: 2020 290a 2020 2020 2020 2020 6966 2073    ).        if s
-00000d40: 656c 662e 5f69 6420 6973 206e 6f74 204e  elf._id is not N
-00000d50: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00000d60: 2069 6620 6578 7065 6374 6174 696f 6e5f   if expectation_
-00000d70: 7375 6974 653a 0a20 2020 2020 2020 2020  suite:.         
-00000d80: 2020 2020 2020 2073 656c 662e 5f65 7870         self._exp
-00000d90: 6563 7461 7469 6f6e 5f73 7569 7465 2e5f  ectation_suite._
-00000da0: 696e 6974 5f65 7870 6563 7461 7469 6f6e  init_expectation
-00000db0: 5f65 6e67 696e 6528 0a20 2020 2020 2020  _engine(.       
-00000dc0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00000dd0: 7475 7265 5f73 746f 7265 5f69 643d 6665  ture_store_id=fe
-00000de0: 6174 7572 6573 746f 7265 5f69 642c 2066  aturestore_id, f
-00000df0: 6561 7475 7265 5f67 726f 7570 5f69 643d  eature_group_id=
-00000e00: 7365 6c66 2e5f 6964 0a20 2020 2020 2020  self._id.       
-00000e10: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00000e20: 2020 2020 2020 2073 656c 662e 5f65 7870         self._exp
-00000e30: 6563 7461 7469 6f6e 5f73 7569 7465 5f65  ectation_suite_e
-00000e40: 6e67 696e 6520 3d20 280a 2020 2020 2020  ngine = (.      
-00000e50: 2020 2020 2020 2020 2020 6578 7065 6374            expect
-00000e60: 6174 696f 6e5f 7375 6974 655f 656e 6769  ation_suite_engi
-00000e70: 6e65 2e45 7870 6563 7461 7469 6f6e 5375  ne.ExpectationSu
-00000e80: 6974 6545 6e67 696e 6528 0a20 2020 2020  iteEngine(.     
-00000e90: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00000ea0: 6561 7475 7265 5f73 746f 7265 5f69 643d  eature_store_id=
-00000eb0: 6665 6174 7572 6573 746f 7265 5f69 642c  featurestore_id,
-00000ec0: 2066 6561 7475 7265 5f67 726f 7570 5f69   feature_group_i
-00000ed0: 643d 7365 6c66 2e5f 6964 0a20 2020 2020  d=self._id.     
-00000ee0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-00000ef0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00000f00: 2020 2020 2020 2073 656c 662e 5f76 616c         self._val
-00000f10: 6964 6174 696f 6e5f 7265 706f 7274 5f65  idation_report_e
-00000f20: 6e67 696e 6520 3d20 280a 2020 2020 2020  ngine = (.      
-00000f30: 2020 2020 2020 2020 2020 7661 6c69 6461            valida
-00000f40: 7469 6f6e 5f72 6570 6f72 745f 656e 6769  tion_report_engi
-00000f50: 6e65 2e56 616c 6964 6174 696f 6e52 6570  ne.ValidationRep
-00000f60: 6f72 7445 6e67 696e 6528 0a20 2020 2020  ortEngine(.     
-00000f70: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00000f80: 6561 7475 7265 7374 6f72 655f 6964 2c20  eaturestore_id, 
-00000f90: 7365 6c66 2e5f 6964 0a20 2020 2020 2020  self._id.       
-00000fa0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00000fb0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00000fc0: 2020 2020 2073 656c 662e 5f76 616c 6964       self._valid
-00000fd0: 6174 696f 6e5f 7265 7375 6c74 5f65 6e67  ation_result_eng
-00000fe0: 696e 6520 3d20 280a 2020 2020 2020 2020  ine = (.        
-00000ff0: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
-00001000: 6f6e 5f72 6573 756c 745f 656e 6769 6e65  on_result_engine
-00001010: 2e56 616c 6964 6174 696f 6e52 6573 756c  .ValidationResul
-00001020: 7445 6e67 696e 6528 0a20 2020 2020 2020  tEngine(.       
-00001030: 2020 2020 2020 2020 2020 2020 2066 6561               fea
-00001040: 7475 7265 7374 6f72 655f 6964 2c20 7365  turestore_id, se
-00001050: 6c66 2e5f 6964 0a20 2020 2020 2020 2020  lf._id.         
-00001060: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00001070: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00001080: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-00001090: 5f6d 6f6e 6974 6f72 696e 675f 636f 6e66  _monitoring_conf
-000010a0: 6967 5f65 6e67 696e 6520 3d20 280a 2020  ig_engine = (.  
-000010b0: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-000010c0: 6174 7572 655f 6d6f 6e69 746f 7269 6e67  ature_monitoring
-000010d0: 5f63 6f6e 6669 675f 656e 6769 6e65 2e46  _config_engine.F
-000010e0: 6561 7475 7265 4d6f 6e69 746f 7269 6e67  eatureMonitoring
-000010f0: 436f 6e66 6967 456e 6769 6e65 280a 2020  ConfigEngine(.  
-00001100: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001110: 2020 6665 6174 7572 655f 7374 6f72 655f    feature_store_
-00001120: 6964 3d66 6561 7475 7265 7374 6f72 655f  id=featurestore_
-00001130: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-00001140: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00001150: 6772 6f75 705f 6964 3d73 656c 662e 5f69  group_id=self._i
-00001160: 642c 0a20 2020 2020 2020 2020 2020 2020  d,.             
-00001170: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00001180: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
-00001190: 656c 662e 5f66 6561 7475 7265 5f6d 6f6e  elf._feature_mon
-000011a0: 6974 6f72 696e 675f 7265 7375 6c74 5f65  itoring_result_e
-000011b0: 6e67 696e 6520 3d20 280a 2020 2020 2020  ngine = (.      
-000011c0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-000011d0: 655f 6d6f 6e69 746f 7269 6e67 5f72 6573  e_monitoring_res
-000011e0: 756c 745f 656e 6769 6e65 2e46 6561 7475  ult_engine.Featu
-000011f0: 7265 4d6f 6e69 746f 7269 6e67 5265 7375  reMonitoringResu
-00001200: 6c74 456e 6769 6e65 280a 2020 2020 2020  ltEngine(.      
-00001210: 2020 2020 2020 2020 2020 2020 2020 6665                fe
-00001220: 6174 7572 655f 7374 6f72 655f 6964 3d73  ature_store_id=s
-00001230: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-00001240: 7265 5f69 642c 0a20 2020 2020 2020 2020  re_id,.         
-00001250: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00001260: 7265 5f67 726f 7570 5f69 643d 7365 6c66  re_group_id=self
-00001270: 2e5f 6964 2c0a 2020 2020 2020 2020 2020  ._id,.          
-00001280: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00001290: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
-000012a0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-000012b0: 7265 5f69 6420 3d20 6665 6174 7572 6573  re_id = features
-000012c0: 746f 7265 5f69 640a 2020 2020 2020 2020  tore_id.        
-000012d0: 7365 6c66 2e5f 7661 7269 6162 6c65 5f61  self._variable_a
-000012e0: 7069 203d 2056 6172 6961 626c 6541 7069  pi = VariableApi
-000012f0: 2829 0a20 2020 2020 2020 2073 656c 662e  ().        self.
-00001300: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
-00001310: 6e67 696e 6520 3d20 4e6f 6e65 0a20 2020  ngine = None.   
-00001320: 2020 2020 2073 656c 662e 5f6d 756c 7469       self._multi
-00001330: 5f70 6172 745f 696e 7365 7274 203d 2046  _part_insert = F
-00001340: 616c 7365 0a20 2020 2020 2020 2073 656c  alse.        sel
-00001350: 662e 5f65 6d62 6564 6469 6e67 5f69 6e64  f._embedding_ind
-00001360: 6578 203d 2065 6d62 6564 6469 6e67 5f69  ex = embedding_i
-00001370: 6e64 6578 0a0a 2020 2020 2020 2020 7365  ndex..        se
-00001380: 6c66 2e63 6865 636b 5f64 6570 7265 6361  lf.check_depreca
-00001390: 7465 6428 290a 0a20 2020 2064 6566 2063  ted()..    def c
-000013a0: 6865 636b 5f64 6570 7265 6361 7465 6428  heck_deprecated(
-000013b0: 7365 6c66 293a 0a20 2020 2020 2020 2069  self):.        i
-000013c0: 6620 7365 6c66 2e64 6570 7265 6361 7465  f self.deprecate
-000013d0: 643a 0a20 2020 2020 2020 2020 2020 2077  d:.            w
-000013e0: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
-000013f0: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00001400: 4665 6174 7572 6520 4772 6f75 7020 607b  Feature Group `{
-00001410: 7365 6c66 2e5f 6e61 6d65 7d60 2c20 7665  self._name}`, ve
-00001420: 7273 696f 6e20 607b 7365 6c66 2e5f 7665  rsion `{self._ve
-00001430: 7273 696f 6e7d 6020 6973 2064 6570 7265  rsion}` is depre
-00001440: 6361 7465 6422 0a20 2020 2020 2020 2020  cated".         
-00001450: 2020 2029 0a0a 2020 2020 6465 6620 6465     )..    def de
-00001460: 6c65 7465 2873 656c 6629 3a0a 2020 2020  lete(self):.    
-00001470: 2020 2020 2222 2244 726f 7020 7468 6520      """Drop the 
-00001480: 656e 7469 7265 2066 6561 7475 7265 2067  entire feature g
-00001490: 726f 7570 2061 6c6f 6e67 2077 6974 6820  roup along with 
-000014a0: 6974 7320 6665 6174 7572 6520 6461 7461  its feature data
-000014b0: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
-000014c0: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
-000014d0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-000014e0: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
-000014f0: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
-00001500: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
-00001510: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
-00001520: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-00001530: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
-00001540: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
-00001550: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
-00001560: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
-00001570: 7475 7265 5f67 726f 7570 280a 2020 2020  ture_group(.    
-00001580: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001590: 6e61 6d65 3d27 6269 7463 6f69 6e5f 7072  name='bitcoin_pr
-000015a0: 6963 6527 2c0a 2020 2020 2020 2020 2020  ice',.          
-000015b0: 2020 2020 2020 2020 2020 7665 7273 696f            versio
-000015c0: 6e3d 310a 2020 2020 2020 2020 2020 2020  n=1.            
-000015d0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-000015e0: 2020 2020 2020 2023 2064 656c 6574 6520         # delete 
-000015f0: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00001600: 700a 2020 2020 2020 2020 2020 2020 6667  p.            fg
-00001610: 2e64 656c 6574 6528 290a 2020 2020 2020  .delete().      
-00001620: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
-00001630: 2020 2021 2121 2064 616e 6765 7220 2250     !!! danger "P
-00001640: 6f74 656e 7469 616c 6c79 2064 616e 6765  otentially dange
-00001650: 726f 7573 206f 7065 7261 7469 6f6e 220a  rous operation".
-00001660: 2020 2020 2020 2020 2020 2020 5468 6973              This
-00001670: 206f 7065 7261 7469 6f6e 2064 726f 7073   operation drops
-00001680: 2061 6c6c 206d 6574 6164 6174 6120 6173   all metadata as
-00001690: 736f 6369 6174 6564 2077 6974 6820 2a2a  sociated with **
-000016a0: 7468 6973 2076 6572 7369 6f6e 2a2a 206f  this version** o
-000016b0: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-000016c0: 2020 6665 6174 7572 6520 6772 6f75 7020    feature group 
-000016d0: 2a2a 616e 642a 2a20 616c 6c20 7468 6520  **and** all the 
-000016e0: 6665 6174 7572 6520 6461 7461 2069 6e20  feature data in 
-000016f0: 6f66 666c 696e 6520 616e 6420 6f6e 6c69  offline and onli
-00001700: 6e65 2073 746f 7261 6765 0a20 2020 2020  ne storage.     
-00001710: 2020 2020 2020 2061 7373 6f63 6961 7465         associate
-00001720: 6420 7769 7468 2069 742e 0a0a 2020 2020  d with it...    
-00001730: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
-00001740: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
-00001750: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-00001760: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
-00001770: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00001780: 2020 2020 7761 726e 696e 6773 2e77 6172      warnings.war
-00001790: 6e28 0a20 2020 2020 2020 2020 2020 2022  n(.            "
-000017a0: 416c 6c20 6a6f 6273 2061 7373 6f63 6961  All jobs associa
-000017b0: 7465 6420 746f 2066 6561 7475 7265 2067  ted to feature g
-000017c0: 726f 7570 2060 7b7d 602c 2076 6572 7369  roup `{}`, versi
-000017d0: 6f6e 2060 7b7d 6020 7769 6c6c 2062 6520  on `{}` will be 
-000017e0: 7265 6d6f 7665 642e 222e 666f 726d 6174  removed.".format
-000017f0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00001800: 2020 7365 6c66 2e5f 6e61 6d65 2c20 7365    self._name, se
-00001810: 6c66 2e5f 7665 7273 696f 6e0a 2020 2020  lf._version.    
-00001820: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
-00001830: 2020 2020 2020 2075 7469 6c2e 4a6f 6257         util.JobW
-00001840: 6172 6e69 6e67 2c0a 2020 2020 2020 2020  arning,.        
-00001850: 290a 2020 2020 2020 2020 7365 6c66 2e5f  ).        self._
-00001860: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
-00001870: 6769 6e65 2e64 656c 6574 6528 7365 6c66  gine.delete(self
-00001880: 290a 0a20 2020 2064 6566 2073 656c 6563  )..    def selec
-00001890: 745f 616c 6c28 0a20 2020 2020 2020 2073  t_all(.        s
-000018a0: 656c 662c 0a20 2020 2020 2020 2069 6e63  elf,.        inc
-000018b0: 6c75 6465 5f70 7269 6d61 7279 5f6b 6579  lude_primary_key
-000018c0: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-000018d0: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
-000018e0: 2069 6e63 6c75 6465 5f65 7665 6e74 5f74   include_event_t
-000018f0: 696d 653a 204f 7074 696f 6e61 6c5b 626f  ime: Optional[bo
-00001900: 6f6c 5d20 3d20 5472 7565 2c0a 2020 2020  ol] = True,.    
-00001910: 293a 0a20 2020 2020 2020 2022 2222 5365  ):.        """Se
-00001920: 6c65 6374 2061 6c6c 2066 6561 7475 7265  lect all feature
-00001930: 7320 696e 2074 6865 2066 6561 7475 7265  s in the feature
-00001940: 2067 726f 7570 2061 6e64 2072 6574 7572   group and retur
-00001950: 6e20 6120 7175 6572 7920 6f62 6a65 6374  n a query object
-00001960: 2e0a 0a20 2020 2020 2020 2054 6865 2071  ...        The q
-00001970: 7565 7279 2063 616e 2062 6520 7573 6564  uery can be used
-00001980: 2074 6f20 636f 6e73 7472 7563 7420 6a6f   to construct jo
-00001990: 696e 7320 6f66 2066 6561 7475 7265 2067  ins of feature g
-000019a0: 726f 7570 7320 6f72 2063 7265 6174 6520  roups or create 
-000019b0: 610a 2020 2020 2020 2020 6665 6174 7572  a.        featur
-000019c0: 6520 7669 6577 2e0a 0a20 2020 2020 2020  e view...       
-000019d0: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-000019e0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-000019f0: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-00001a00: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-00001a10: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-00001a20: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-00001a30: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-00001a40: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-00001a50: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-00001a60: 730a 2020 2020 2020 2020 2020 2020 6667  s.            fg
-00001a70: 3120 3d20 6673 2e67 6574 5f6f 725f 6372  1 = fs.get_or_cr
-00001a80: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-00001a90: 7570 282e 2e2e 290a 2020 2020 2020 2020  up(...).        
-00001aa0: 2020 2020 6667 3220 3d20 6673 2e67 6574      fg2 = fs.get
-00001ab0: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
-00001ac0: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
-00001ad0: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
-00001ae0: 7374 7275 6374 2074 6865 2071 7565 7279  struct the query
-00001af0: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
-00001b00: 7279 203d 2066 6731 2e73 656c 6563 745f  ry = fg1.select_
-00001b10: 616c 6c28 292e 6a6f 696e 2866 6732 2e73  all().join(fg2.s
-00001b20: 656c 6563 745f 616c 6c28 2929 0a0a 2020  elect_all())..  
-00001b30: 2020 2020 2020 2020 2020 2320 7368 6f77            # show
-00001b40: 2066 6972 7374 2035 2072 6f77 730a 2020   first 5 rows.  
-00001b50: 2020 2020 2020 2020 2020 7175 6572 792e            query.
-00001b60: 7368 6f77 2835 290a 0a0a 2020 2020 2020  show(5)...      
-00001b70: 2020 2020 2020 2320 7365 6c65 6374 2061        # select a
-00001b80: 6c6c 2066 6561 7475 7265 7320 6578 636c  ll features excl
-00001b90: 7564 6520 7072 696d 6172 7920 6b65 7920  ude primary key 
-00001ba0: 616e 6420 6576 656e 7420 7469 6d65 0a20  and event time. 
-00001bb0: 2020 2020 2020 2020 2020 2066 726f 6d20             from 
-00001bc0: 6873 6673 2e66 6561 7475 7265 2069 6d70  hsfs.feature imp
-00001bd0: 6f72 7420 4665 6174 7572 650a 2020 2020  ort Feature.    
-00001be0: 2020 2020 2020 2020 6667 203d 2066 732e          fg = fs.
-00001bf0: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-00001c00: 726f 7570 280a 2020 2020 2020 2020 2020  roup(.          
-00001c10: 2020 2020 2020 2020 2020 2266 6722 2c0a            "fg",.
-00001c20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c30: 2020 2020 6665 6174 7572 6573 3d5b 0a20      features=[. 
-00001c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c50: 2020 2020 2020 2020 2020 2046 6561 7475             Featu
-00001c60: 7265 2822 6964 222c 2074 7970 653d 2273  re("id", type="s
-00001c70: 7472 696e 6722 292c 0a20 2020 2020 2020  tring"),.       
-00001c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001c90: 2020 2020 2046 6561 7475 7265 2822 7473       Feature("ts
-00001ca0: 222c 2074 7970 653d 2262 6967 696e 7422  ", type="bigint"
-00001cb0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
-00001cc0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-00001cd0: 6561 7475 7265 2822 6631 222c 2074 7970  eature("f1", typ
-00001ce0: 653d 2264 6174 6522 292c 0a20 2020 2020  e="date"),.     
-00001cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d00: 2020 2020 2020 2046 6561 7475 7265 2822         Feature("
-00001d10: 6632 222c 2074 7970 653d 2264 6f75 626c  f2", type="doubl
-00001d20: 6522 290a 2020 2020 2020 2020 2020 2020  e").            
-00001d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00001d40: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00001d50: 2020 2020 2020 2070 7269 6d61 7279 5f6b         primary_k
-00001d60: 6579 3d5b 2269 6422 5d2c 0a20 2020 2020  ey=["id"],.     
-00001d70: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00001d80: 7665 6e74 5f74 696d 653d 2274 7322 290a  vent_time="ts").
-00001d90: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
-00001da0: 7279 203d 2066 672e 7365 6c65 6374 5f61  ry = fg.select_a
-00001db0: 6c6c 2829 0a20 2020 2020 2020 2020 2020  ll().           
-00001dc0: 2071 7565 7279 2e66 6561 7475 7265 730a   query.features.
-00001dd0: 2020 2020 2020 2020 2020 2020 2320 5b46              # [F
-00001de0: 6561 7475 7265 2827 6964 272c 202e 2e2e  eature('id', ...
-00001df0: 292c 2046 6561 7475 7265 2827 7473 272c  ), Feature('ts',
-00001e00: 202e 2e2e 292c 2046 6561 7475 7265 2827   ...), Feature('
-00001e10: 6631 272c 202e 2e2e 292c 2046 6561 7475  f1', ...), Featu
-00001e20: 7265 2827 6632 272c 202e 2e2e 295d 0a0a  re('f2', ...)]..
-00001e30: 2020 2020 2020 2020 2020 2020 7175 6572              quer
-00001e40: 7920 3d20 6667 2e73 656c 6563 745f 616c  y = fg.select_al
-00001e50: 6c28 696e 636c 7564 655f 7072 696d 6172  l(include_primar
-00001e60: 795f 6b65 793d 4661 6c73 652c 2069 6e63  y_key=False, inc
-00001e70: 6c75 6465 5f65 7665 6e74 5f74 696d 653d  lude_event_time=
-00001e80: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
-00001e90: 2020 2071 7565 7279 2e66 6561 7475 7265     query.feature
-00001ea0: 730a 2020 2020 2020 2020 2020 2020 2320  s.            # 
-00001eb0: 5b46 6561 7475 7265 2827 6631 272c 202e  [Feature('f1', .
-00001ec0: 2e2e 292c 2046 6561 7475 7265 2827 6632  ..), Feature('f2
-00001ed0: 272c 202e 2e2e 295d 0a20 2020 2020 2020  ', ...)].       
-00001ee0: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-00001ef0: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-00001f00: 2020 2020 2020 2020 2020 696e 636c 7564            includ
-00001f10: 655f 7072 696d 6172 795f 6b65 793a 2049  e_primary_key: I
-00001f20: 6620 5472 7565 2c20 696e 636c 7564 6520  f True, include 
-00001f30: 7072 696d 6172 7920 6b65 7920 6f66 2074  primary key of t
-00001f40: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-00001f50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00001f60: 2074 6f20 7468 6520 6665 6174 7572 6520   to the feature 
-00001f70: 6c69 7374 2e20 4465 6661 756c 7473 2074  list. Defaults t
-00001f80: 6f20 5472 7565 2e0a 2020 2020 2020 2020  o True..        
-00001f90: 2020 2020 696e 636c 7564 655f 6576 656e      include_even
-00001fa0: 745f 7469 6d65 3a20 4966 2054 7275 652c  t_time: If True,
-00001fb0: 2069 6e63 6c75 6465 2065 7665 6e74 2074   include event t
-00001fc0: 696d 6520 6f66 2074 6865 2066 6561 7475  ime of the featu
-00001fd0: 7265 2067 726f 7570 0a20 2020 2020 2020  re group.       
-00001fe0: 2020 2020 2020 2020 2074 6f20 7468 6520           to the 
-00001ff0: 6665 6174 7572 6520 6c69 7374 2e20 4465  feature list. De
-00002000: 6661 756c 7473 2074 6f20 5472 7565 2e0a  faults to True..
-00002010: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-00002020: 730a 2020 2020 2020 2020 2020 2020 6051  s.            `Q
-00002030: 7565 7279 602e 2041 2071 7565 7279 206f  uery`. A query o
-00002040: 626a 6563 7420 7769 7468 2061 6c6c 2066  bject with all f
-00002050: 6561 7475 7265 7320 6f66 2074 6865 2066  eatures of the f
-00002060: 6561 7475 7265 2067 726f 7570 2e0a 2020  eature group..  
-00002070: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00002080: 2020 6966 2069 6e63 6c75 6465 5f65 7665    if include_eve
-00002090: 6e74 5f74 696d 6520 616e 6420 696e 636c  nt_time and incl
-000020a0: 7564 655f 7072 696d 6172 795f 6b65 793a  ude_primary_key:
-000020b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-000020c0: 7572 6e20 7175 6572 792e 5175 6572 7928  urn query.Query(
-000020d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000020e0: 206c 6566 745f 6665 6174 7572 655f 6772   left_feature_gr
-000020f0: 6f75 703d 7365 6c66 2c0a 2020 2020 2020  oup=self,.      
-00002100: 2020 2020 2020 2020 2020 6c65 6674 5f66            left_f
-00002110: 6561 7475 7265 733d 7365 6c66 2e5f 6665  eatures=self._fe
-00002120: 6174 7572 6573 2c0a 2020 2020 2020 2020  atures,.        
-00002130: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00002140: 7374 6f72 655f 6e61 6d65 3d73 656c 662e  store_name=self.
-00002150: 5f66 6561 7475 7265 5f73 746f 7265 5f6e  _feature_store_n
-00002160: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00002170: 2020 2020 2066 6561 7475 7265 5f73 746f       feature_sto
-00002180: 7265 5f69 643d 7365 6c66 2e5f 6665 6174  re_id=self._feat
-00002190: 7572 655f 7374 6f72 655f 6964 2c0a 2020  ure_store_id,.  
-000021a0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-000021b0: 2020 2020 656c 6966 2069 6e63 6c75 6465      elif include
-000021c0: 5f65 7665 6e74 5f74 696d 653a 0a20 2020  _event_time:.   
-000021d0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
-000021e0: 7365 6c66 2e73 656c 6563 745f 6578 6365  self.select_exce
-000021f0: 7074 2873 656c 662e 7072 696d 6172 795f  pt(self.primary_
-00002200: 6b65 7929 0a20 2020 2020 2020 2065 6c69  key).        eli
-00002210: 6620 696e 636c 7564 655f 7072 696d 6172  f include_primar
-00002220: 795f 6b65 793a 0a20 2020 2020 2020 2020  y_key:.         
-00002230: 2020 2072 6574 7572 6e20 7365 6c66 2e73     return self.s
-00002240: 656c 6563 745f 6578 6365 7074 285b 7365  elect_except([se
-00002250: 6c66 2e65 7665 6e74 5f74 696d 655d 290a  lf.event_time]).
-00002260: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00002270: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00002280: 2073 656c 662e 7365 6c65 6374 5f65 7863   self.select_exc
-00002290: 6570 7428 7365 6c66 2e70 7269 6d61 7279  ept(self.primary
-000022a0: 5f6b 6579 202b 205b 7365 6c66 2e65 7665  _key + [self.eve
-000022b0: 6e74 5f74 696d 655d 290a 0a20 2020 2064  nt_time])..    d
-000022c0: 6566 2073 656c 6563 7428 7365 6c66 2c20  ef select(self, 
-000022d0: 6665 6174 7572 6573 3a20 4c69 7374 5b55  features: List[U
-000022e0: 6e69 6f6e 5b73 7472 2c20 6665 6174 7572  nion[str, featur
-000022f0: 652e 4665 6174 7572 655d 5d29 3a0a 2020  e.Feature]]):.  
-00002300: 2020 2020 2020 2222 2253 656c 6563 7420        """Select 
-00002310: 6120 7375 6273 6574 206f 6620 6665 6174  a subset of feat
-00002320: 7572 6573 206f 6620 7468 6520 6665 6174  ures of the feat
-00002330: 7572 6520 6772 6f75 7020 616e 6420 7265  ure group and re
-00002340: 7475 726e 2061 2071 7565 7279 206f 626a  turn a query obj
-00002350: 6563 742e 0a0a 2020 2020 2020 2020 5468  ect...        Th
-00002360: 6520 7175 6572 7920 6361 6e20 6265 2075  e query can be u
-00002370: 7365 6420 746f 2063 6f6e 7374 7275 6374  sed to construct
-00002380: 206a 6f69 6e73 206f 6620 6665 6174 7572   joins of featur
-00002390: 6520 6772 6f75 7073 206f 7220 6372 6561  e groups or crea
-000023a0: 7465 2061 0a20 2020 2020 2020 2066 6561  te a.        fea
-000023b0: 7475 7265 2076 6965 7720 7769 7468 2061  ture view with a
-000023c0: 2073 7562 7365 7420 6f66 2066 6561 7475   subset of featu
-000023d0: 7265 7320 6f66 2074 6865 2066 6561 7475  res of the featu
-000023e0: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
-000023f0: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
-00002400: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-00002410: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-00002420: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
-00002430: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
-00002440: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
-00002450: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
-00002460: 2020 2320 6765 7420 7468 6520 4665 6174    # get the Feat
-00002470: 7572 6520 4772 6f75 7020 696e 7374 616e  ure Group instan
-00002480: 6365 0a20 2020 2020 2020 2020 2020 2066  ce.            f
-00002490: 726f 6d20 6873 6673 2e66 6561 7475 7265  rom hsfs.feature
-000024a0: 2069 6d70 6f72 7420 4665 6174 7572 650a   import Feature.
-000024b0: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
-000024c0: 2066 732e 6372 6561 7465 5f66 6561 7475   fs.create_featu
-000024d0: 7265 5f67 726f 7570 280a 2020 2020 2020  re_group(.      
-000024e0: 2020 2020 2020 2020 2020 2020 2020 2266                "f
-000024f0: 6722 2c0a 2020 2020 2020 2020 2020 2020  g",.            
-00002500: 2020 2020 2020 2020 6665 6174 7572 6573          features
-00002510: 3d5b 0a20 2020 2020 2020 2020 2020 2020  =[.             
-00002520: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-00002530: 6561 7475 7265 2822 6964 222c 2074 7970  eature("id", typ
-00002540: 653d 2273 7472 696e 6722 292c 0a20 2020  e="string"),.   
-00002550: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002560: 2020 2020 2020 2020 2046 6561 7475 7265           Feature
-00002570: 2822 7473 222c 2074 7970 653d 2262 6967  ("ts", type="big
-00002580: 696e 7422 292c 0a20 2020 2020 2020 2020  int"),.         
-00002590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025a0: 2020 2046 6561 7475 7265 2822 6631 222c     Feature("f1",
-000025b0: 2074 7970 653d 2264 6174 6522 292c 0a20   type="date"),. 
-000025c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000025d0: 2020 2020 2020 2020 2020 2046 6561 7475             Featu
-000025e0: 7265 2822 6632 222c 2074 7970 653d 2264  re("f2", type="d
-000025f0: 6f75 626c 6522 290a 2020 2020 2020 2020  ouble").        
-00002600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002610: 2020 2020 5d2c 0a20 2020 2020 2020 2020      ],.         
-00002620: 2020 2020 2020 2020 2020 2070 7269 6d61             prima
-00002630: 7279 5f6b 6579 3d5b 2269 6422 5d2c 0a20  ry_key=["id"],. 
-00002640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002650: 2020 2065 7665 6e74 5f74 696d 653d 2274     event_time="t
-00002660: 7322 290a 0a20 2020 2020 2020 2020 2020  s")..           
-00002670: 2023 2063 6f6e 7374 7275 6374 2071 7565   # construct que
-00002680: 7279 0a20 2020 2020 2020 2020 2020 2071  ry.            q
-00002690: 7565 7279 203d 2066 672e 7365 6c65 6374  uery = fg.select
-000026a0: 285b 2269 6422 2c20 2266 3122 5d29 0a20  (["id", "f1"]). 
-000026b0: 2020 2020 2020 2020 2020 2071 7565 7279             query
-000026c0: 2e66 6561 7475 7265 730a 2020 2020 2020  .features.      
-000026d0: 2020 2020 2020 2320 5b46 6561 7475 7265        # [Feature
-000026e0: 2827 6964 272c 202e 2e2e 292c 2046 6561  ('id', ...), Fea
-000026f0: 7475 7265 2827 6631 272c 202e 2e2e 295d  ture('f1', ...)]
-00002700: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-00002710: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-00002720: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00002730: 2020 6665 6174 7572 6573 3a20 4120 6c69    features: A li
-00002740: 7374 206f 6620 6046 6561 7475 7265 6020  st of `Feature` 
-00002750: 6f62 6a65 6374 7320 6f72 2066 6561 7475  objects or featu
-00002760: 7265 206e 616d 6573 2061 730a 2020 2020  re names as.    
-00002770: 2020 2020 2020 2020 2020 2020 7374 7269              stri
-00002780: 6e67 7320 746f 2062 6520 7365 6c65 6374  ngs to be select
-00002790: 6564 2e0a 0a20 2020 2020 2020 2023 2052  ed...        # R
-000027a0: 6574 7572 6e73 0a20 2020 2020 2020 2020  eturns.         
-000027b0: 2020 2060 5175 6572 7960 3a20 4120 7175     `Query`: A qu
-000027c0: 6572 7920 6f62 6a65 6374 2077 6974 6820  ery object with 
-000027d0: 7468 6520 7365 6c65 6374 6564 2066 6561  the selected fea
-000027e0: 7475 7265 7320 6f66 2074 6865 2066 6561  tures of the fea
-000027f0: 7475 7265 2067 726f 7570 2e0a 2020 2020  ture group..    
-00002800: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00002810: 7265 7475 726e 2071 7565 7279 2e51 7565  return query.Que
-00002820: 7279 280a 2020 2020 2020 2020 2020 2020  ry(.            
-00002830: 6c65 6674 5f66 6561 7475 7265 5f67 726f  left_feature_gro
-00002840: 7570 3d73 656c 662c 0a20 2020 2020 2020  up=self,.       
-00002850: 2020 2020 206c 6566 745f 6665 6174 7572       left_featur
-00002860: 6573 3d66 6561 7475 7265 732c 0a20 2020  es=features,.   
-00002870: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00002880: 5f73 746f 7265 5f6e 616d 653d 7365 6c66  _store_name=self
-00002890: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
-000028a0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-000028b0: 2020 6665 6174 7572 655f 7374 6f72 655f    feature_store_
-000028c0: 6964 3d73 656c 662e 5f66 6561 7475 7265  id=self._feature
-000028d0: 5f73 746f 7265 5f69 642c 0a20 2020 2020  _store_id,.     
-000028e0: 2020 2029 0a0a 2020 2020 6465 6620 7365     )..    def se
-000028f0: 6c65 6374 5f65 7863 6570 7428 7365 6c66  lect_except(self
-00002900: 2c20 6665 6174 7572 6573 3a20 4f70 7469  , features: Opti
-00002910: 6f6e 616c 5b4c 6973 745b 556e 696f 6e5b  onal[List[Union[
-00002920: 7374 722c 2066 6561 7475 7265 2e46 6561  str, feature.Fea
-00002930: 7475 7265 5d5d 5d20 3d20 5b5d 293a 0a20  ture]]] = []):. 
-00002940: 2020 2020 2020 2022 2222 5365 6c65 6374         """Select
-00002950: 2061 6c6c 2066 6561 7475 7265 7320 696e   all features in
-00002960: 636c 7564 696e 6720 7072 696d 6172 7920  cluding primary 
-00002970: 6b65 7920 616e 6420 6576 656e 7420 7469  key and event ti
-00002980: 6d65 2066 6561 7475 7265 0a20 2020 2020  me feature.     
-00002990: 2020 206f 6620 7468 6520 6665 6174 7572     of the featur
-000029a0: 6520 6772 6f75 7020 6578 6365 7074 2070  e group except p
-000029b0: 726f 7669 6465 6420 6066 6561 7475 7265  rovided `feature
-000029c0: 7360 2061 6e64 2072 6574 7572 6e20 6120  s` and return a 
-000029d0: 7175 6572 7920 6f62 6a65 6374 2e0a 0a20  query object... 
-000029e0: 2020 2020 2020 2054 6865 2071 7565 7279         The query
-000029f0: 2063 616e 2062 6520 7573 6564 2074 6f20   can be used to 
-00002a00: 636f 6e73 7472 7563 7420 6a6f 696e 7320  construct joins 
-00002a10: 6f66 2066 6561 7475 7265 2067 726f 7570  of feature group
-00002a20: 7320 6f72 2063 7265 6174 6520 610a 2020  s or create a.  
-00002a30: 2020 2020 2020 6665 6174 7572 6520 7669        feature vi
-00002a40: 6577 2077 6974 6820 6120 7375 6273 6574  ew with a subset
-00002a50: 206f 6620 6665 6174 7572 6573 206f 6620   of features of 
-00002a60: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00002a70: 702e 0a0a 2020 2020 2020 2020 2121 2120  p...        !!! 
-00002a80: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
-00002a90: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-00002aa0: 2020 2020 2020 2020 2020 2320 636f 6e6e            # conn
-00002ab0: 6563 7420 746f 2074 6865 2046 6561 7475  ect to the Featu
-00002ac0: 7265 2053 746f 7265 0a20 2020 2020 2020  re Store.       
-00002ad0: 2020 2020 2066 7320 3d20 2e2e 2e0a 0a20       fs = ..... 
-00002ae0: 2020 2020 2020 2020 2020 2023 2067 6574             # get
-00002af0: 2074 6865 2046 6561 7475 7265 2047 726f   the Feature Gro
-00002b00: 7570 2069 6e73 7461 6e63 650a 2020 2020  up instance.    
-00002b10: 2020 2020 2020 2020 6672 6f6d 2068 7366          from hsf
-00002b20: 732e 6665 6174 7572 6520 696d 706f 7274  s.feature import
-00002b30: 2046 6561 7475 7265 0a20 2020 2020 2020   Feature.       
-00002b40: 2020 2020 2066 6720 3d20 6673 2e63 7265       fg = fs.cre
-00002b50: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
-00002b60: 7028 0a20 2020 2020 2020 2020 2020 2020  p(.             
-00002b70: 2020 2020 2020 2022 6667 222c 0a20 2020         "fg",.   
-00002b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002b90: 2066 6561 7475 7265 733d 5b0a 2020 2020   features=[.    
-00002ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002bb0: 2020 2020 2020 2020 4665 6174 7572 6528          Feature(
-00002bc0: 2269 6422 2c20 7479 7065 3d22 7374 7269  "id", type="stri
-00002bd0: 6e67 2229 2c0a 2020 2020 2020 2020 2020  ng"),.          
+00000250: 6520 4c69 6365 6e73 652e 0a23 0a66 726f  e License..#.fro
+00000260: 6d20 5f5f 6675 7475 7265 5f5f 2069 6d70  m __future__ imp
+00000270: 6f72 7420 616e 6e6f 7461 7469 6f6e 730a  ort annotations.
+00000280: 0a69 6d70 6f72 7420 636f 7079 0a69 6d70  .import copy.imp
+00000290: 6f72 7420 7469 6d65 0a0a 6672 6f6d 2068  ort time..from h
+000002a0: 7366 732e 656d 6265 6464 696e 6720 696d  sfs.embedding im
+000002b0: 706f 7274 2045 6d62 6564 6469 6e67 496e  port EmbeddingIn
+000002c0: 6465 780a 6672 6f6d 2068 7366 732e 6765  dex.from hsfs.ge
+000002d0: 5f76 616c 6964 6174 696f 6e5f 7265 7375  _validation_resu
+000002e0: 6c74 2069 6d70 6f72 7420 5661 6c69 6461  lt import Valida
+000002f0: 7469 6f6e 5265 7375 6c74 0a69 6d70 6f72  tionResult.impor
+00000300: 7420 6875 6d70 730a 696d 706f 7274 206a  t humps.import j
+00000310: 736f 6e0a 696d 706f 7274 2077 6172 6e69  son.import warni
+00000320: 6e67 730a 696d 706f 7274 2070 616e 6461  ngs.import panda
+00000330: 7320 6173 2070 640a 696d 706f 7274 206e  s as pd.import n
+00000340: 756d 7079 2061 7320 6e70 0a69 6d70 6f72  umpy as np.impor
+00000350: 7420 6772 6561 745f 6578 7065 6374 6174  t great_expectat
+00000360: 696f 6e73 2061 7320 6765 0a69 6d70 6f72  ions as ge.impor
+00000370: 7420 6176 726f 2e73 6368 656d 610a 6672  t avro.schema.fr
+00000380: 6f6d 2068 7366 732e 636f 6e73 7472 7563  om hsfs.construc
+00000390: 746f 722e 6669 6c74 6572 2069 6d70 6f72  tor.filter impor
+000003a0: 7420 4669 6c74 6572 2c20 4c6f 6769 630a  t Filter, Logic.
+000003b0: 6672 6f6d 2074 7970 696e 6720 696d 706f  from typing impo
+000003c0: 7274 204f 7074 696f 6e61 6c2c 2055 6e69  rt Optional, Uni
+000003d0: 6f6e 2c20 416e 792c 2044 6963 742c 204c  on, Any, Dict, L
+000003e0: 6973 742c 2054 7970 6556 6172 2c20 5475  ist, TypeVar, Tu
+000003f0: 706c 650a 0a66 726f 6d20 6461 7465 7469  ple..from dateti
+00000400: 6d65 2069 6d70 6f72 7420 6461 7465 7469  me import dateti
+00000410: 6d65 2c20 6461 7465 0a0a 6672 6f6d 2068  me, date..from h
+00000420: 7366 7320 696d 706f 7274 2028 0a20 2020  sfs import (.   
+00000430: 2075 7469 6c2c 0a20 2020 2065 6e67 696e   util,.    engin
+00000440: 652c 0a20 2020 2066 6561 7475 7265 2c0a  e,.    feature,.
+00000450: 2020 2020 7573 6572 2c0a 2020 2020 6665      user,.    fe
+00000460: 6174 7572 655f 6772 6f75 705f 7772 6974  ature_group_writ
+00000470: 6572 2c0a 2020 2020 7374 6f72 6167 655f  er,.    storage_
+00000480: 636f 6e6e 6563 746f 7220 6173 2073 632c  connector as sc,
+00000490: 0a29 0a66 726f 6d20 6873 6673 2e63 6f72  .).from hsfs.cor
+000004a0: 6520 696d 706f 7274 2028 0a20 2020 2066  e import (.    f
+000004b0: 6561 7475 7265 5f67 726f 7570 5f65 6e67  eature_group_eng
+000004c0: 696e 652c 0a20 2020 2073 7461 7469 7374  ine,.    statist
+000004d0: 6963 735f 656e 6769 6e65 2c0a 2020 2020  ics_engine,.    
+000004e0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+000004f0: 655f 656e 6769 6e65 2c0a 2020 2020 7661  e_engine,.    va
+00000500: 6c69 6461 7469 6f6e 5f72 6570 6f72 745f  lidation_report_
+00000510: 656e 6769 6e65 2c0a 2020 2020 636f 6465  engine,.    code
+00000520: 5f65 6e67 696e 652c 0a20 2020 2065 7874  _engine,.    ext
+00000530: 6572 6e61 6c5f 6665 6174 7572 655f 6772  ernal_feature_gr
+00000540: 6f75 705f 656e 6769 6e65 2c0a 2020 2020  oup_engine,.    
+00000550: 7370 696e 655f 6772 6f75 705f 656e 6769  spine_group_engi
+00000560: 6e65 2c0a 2020 2020 7661 6c69 6461 7469  ne,.    validati
+00000570: 6f6e 5f72 6573 756c 745f 656e 6769 6e65  on_result_engine
+00000580: 2c0a 2020 2020 6a6f 625f 6170 692c 0a20  ,.    job_api,. 
+00000590: 2020 2066 6561 7475 7265 5f6d 6f6e 6974     feature_monit
+000005a0: 6f72 696e 675f 636f 6e66 6967 5f65 6e67  oring_config_eng
+000005b0: 696e 652c 0a20 2020 2066 6561 7475 7265  ine,.    feature
+000005c0: 5f6d 6f6e 6974 6f72 696e 675f 7265 7375  _monitoring_resu
+000005d0: 6c74 5f65 6e67 696e 652c 0a29 0a0a 6672  lt_engine,.)..fr
+000005e0: 6f6d 2068 7366 732e 7374 6174 6973 7469  om hsfs.statisti
+000005f0: 6373 5f63 6f6e 6669 6720 696d 706f 7274  cs_config import
+00000600: 2053 7461 7469 7374 6963 7343 6f6e 6669   StatisticsConfi
+00000610: 670a 6672 6f6d 2068 7366 732e 7374 6174  g.from hsfs.stat
+00000620: 6973 7469 6373 2069 6d70 6f72 7420 5374  istics import St
+00000630: 6174 6973 7469 6373 0a66 726f 6d20 6873  atistics.from hs
+00000640: 6673 2e65 7870 6563 7461 7469 6f6e 5f73  fs.expectation_s
+00000650: 7569 7465 2069 6d70 6f72 7420 4578 7065  uite import Expe
+00000660: 6374 6174 696f 6e53 7569 7465 0a66 726f  ctationSuite.fro
+00000670: 6d20 6873 6673 2e76 616c 6964 6174 696f  m hsfs.validatio
+00000680: 6e5f 7265 706f 7274 2069 6d70 6f72 7420  n_report import 
+00000690: 5661 6c69 6461 7469 6f6e 5265 706f 7274  ValidationReport
+000006a0: 0a66 726f 6d20 6873 6673 2e63 6f72 6520  .from hsfs.core 
+000006b0: 696d 706f 7274 2066 6561 7475 7265 5f6d  import feature_m
+000006c0: 6f6e 6974 6f72 696e 675f 636f 6e66 6967  onitoring_config
+000006d0: 2061 7320 666d 630a 6672 6f6d 2068 7366   as fmc.from hsf
+000006e0: 732e 636f 7265 2069 6d70 6f72 7420 6665  s.core import fe
+000006f0: 6174 7572 655f 6d6f 6e69 746f 7269 6e67  ature_monitoring
+00000700: 5f72 6573 756c 7420 6173 2066 6d72 0a66  _result as fmr.f
+00000710: 726f 6d20 6873 6673 2e63 6f6e 7374 7275  rom hsfs.constru
+00000720: 6374 6f72 2069 6d70 6f72 7420 7175 6572  ctor import quer
+00000730: 7920 6173 2071 7565 7279 5f6d 6f64 0a66  y as query_mod.f
+00000740: 726f 6d20 6873 6673 2e63 6f6e 7374 7275  rom hsfs.constru
+00000750: 6374 6f72 2069 6d70 6f72 7420 6669 6c74  ctor import filt
+00000760: 6572 2061 7320 6669 6c74 6572 5f6d 6f64  er as filter_mod
+00000770: 0a66 726f 6d20 6873 6673 2e63 6c69 656e  .from hsfs.clien
+00000780: 742e 6578 6365 7074 696f 6e73 2069 6d70  t.exceptions imp
+00000790: 6f72 7420 4665 6174 7572 6553 746f 7265  ort FeatureStore
+000007a0: 4578 6365 7074 696f 6e2c 2052 6573 7441  Exception, RestA
+000007b0: 5049 4572 726f 720a 6672 6f6d 2068 7366  PIError.from hsf
+000007c0: 732e 636f 7265 2e6a 6f62 2069 6d70 6f72  s.core.job impor
+000007d0: 7420 4a6f 620a 6672 6f6d 2068 7366 732e  t Job.from hsfs.
+000007e0: 636f 7265 2e76 6172 6961 626c 655f 6170  core.variable_ap
+000007f0: 6920 696d 706f 7274 2056 6172 6961 626c  i import Variabl
+00000800: 6541 7069 0a66 726f 6d20 6873 6673 2e63  eApi.from hsfs.c
+00000810: 6f72 6520 696d 706f 7274 2067 7265 6174  ore import great
+00000820: 5f65 7870 6563 7461 7469 6f6e 5f65 6e67  _expectation_eng
+00000830: 696e 650a 6672 6f6d 2068 7366 732e 636f  ine.from hsfs.co
+00000840: 7265 2e76 6563 746f 725f 6462 5f63 6c69  re.vector_db_cli
+00000850: 656e 7420 696d 706f 7274 2056 6563 746f  ent import Vecto
+00000860: 7244 6243 6c69 656e 740a 0a0a 636c 6173  rDbClient...clas
+00000870: 7320 4665 6174 7572 6547 726f 7570 4261  s FeatureGroupBa
+00000880: 7365 3a0a 2020 2020 6465 6620 5f5f 696e  se:.    def __in
+00000890: 6974 5f5f 280a 2020 2020 2020 2020 7365  it__(.        se
+000008a0: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
+000008b0: 2c0a 2020 2020 2020 2020 7665 7273 696f  ,.        versio
+000008c0: 6e2c 0a20 2020 2020 2020 2066 6561 7475  n,.        featu
+000008d0: 7265 7374 6f72 655f 6964 2c0a 2020 2020  restore_id,.    
+000008e0: 2020 2020 6c6f 6361 7469 6f6e 2c0a 2020      location,.  
+000008f0: 2020 2020 2020 6576 656e 745f 7469 6d65        event_time
+00000900: 3d4e 6f6e 652c 0a20 2020 2020 2020 206f  =None,.        o
+00000910: 6e6c 696e 655f 656e 6162 6c65 643d 4661  nline_enabled=Fa
+00000920: 6c73 652c 0a20 2020 2020 2020 2069 643d  lse,.        id=
+00000930: 4e6f 6e65 2c0a 2020 2020 2020 2020 656d  None,.        em
+00000940: 6265 6464 696e 675f 696e 6465 783d 4e6f  bedding_index=No
+00000950: 6e65 2c0a 2020 2020 2020 2020 6578 7065  ne,.        expe
+00000960: 6374 6174 696f 6e5f 7375 6974 653d 4e6f  ctation_suite=No
+00000970: 6e65 2c0a 2020 2020 2020 2020 6f6e 6c69  ne,.        onli
+00000980: 6e65 5f74 6f70 6963 5f6e 616d 653d 4e6f  ne_topic_name=No
+00000990: 6e65 2c0a 2020 2020 2020 2020 746f 7069  ne,.        topi
+000009a0: 635f 6e61 6d65 3d4e 6f6e 652c 0a20 2020  c_name=None,.   
+000009b0: 2020 2020 206e 6f74 6966 6963 6174 696f       notificatio
+000009c0: 6e5f 746f 7069 635f 6e61 6d65 3d4e 6f6e  n_topic_name=Non
+000009d0: 652c 0a20 2020 2020 2020 2064 6570 7265  e,.        depre
+000009e0: 6361 7465 643d 4661 6c73 652c 0a20 2020  cated=False,.   
+000009f0: 2020 2020 202a 2a6b 7761 7267 732c 0a20       **kwargs,. 
+00000a00: 2020 2029 3a0a 2020 2020 2020 2020 7365     ):.        se
+00000a10: 6c66 2e5f 7665 7273 696f 6e20 3d20 7665  lf._version = ve
+00000a20: 7273 696f 6e0a 2020 2020 2020 2020 7365  rsion.        se
+00000a30: 6c66 2e5f 6e61 6d65 203d 206e 616d 650a  lf._name = name.
+00000a40: 2020 2020 2020 2020 7365 6c66 2e65 7665          self.eve
+00000a50: 6e74 5f74 696d 6520 3d20 6576 656e 745f  nt_time = event_
+00000a60: 7469 6d65 0a20 2020 2020 2020 2073 656c  time.        sel
+00000a70: 662e 5f6f 6e6c 696e 655f 656e 6162 6c65  f._online_enable
+00000a80: 6420 3d20 6f6e 6c69 6e65 5f65 6e61 626c  d = online_enabl
+00000a90: 6564 0a20 2020 2020 2020 2073 656c 662e  ed.        self.
+00000aa0: 5f6c 6f63 6174 696f 6e20 3d20 6c6f 6361  _location = loca
+00000ab0: 7469 6f6e 0a20 2020 2020 2020 2073 656c  tion.        sel
+00000ac0: 662e 5f69 6420 3d20 6964 0a20 2020 2020  f._id = id.     
+00000ad0: 2020 2073 656c 662e 5f73 7562 6a65 6374     self._subject
+00000ae0: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
+00000af0: 7365 6c66 2e5f 6f6e 6c69 6e65 5f74 6f70  self._online_top
+00000b00: 6963 5f6e 616d 6520 3d20 6f6e 6c69 6e65  ic_name = online
+00000b10: 5f74 6f70 6963 5f6e 616d 650a 2020 2020  _topic_name.    
+00000b20: 2020 2020 7365 6c66 2e5f 746f 7069 635f      self._topic_
+00000b30: 6e61 6d65 203d 2074 6f70 6963 5f6e 616d  name = topic_nam
+00000b40: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00000b50: 6e6f 7469 6669 6361 7469 6f6e 5f74 6f70  notification_top
+00000b60: 6963 5f6e 616d 6520 3d20 6e6f 7469 6669  ic_name = notifi
+00000b70: 6361 7469 6f6e 5f74 6f70 6963 5f6e 616d  cation_topic_nam
+00000b80: 650a 2020 2020 2020 2020 7365 6c66 2e5f  e.        self._
+00000b90: 6465 7072 6563 6174 6564 203d 2064 6570  deprecated = dep
+00000ba0: 7265 6361 7465 640a 2020 2020 2020 2020  recated.        
+00000bb0: 7365 6c66 2e5f 6665 6174 7572 655f 7374  self._feature_st
+00000bc0: 6f72 655f 6964 203d 2066 6561 7475 7265  ore_id = feature
+00000bd0: 7374 6f72 655f 6964 0a20 2020 2020 2020  store_id.       
+00000be0: 2023 2075 7365 2073 6574 7465 7220 666f   # use setter fo
+00000bf0: 7220 636f 7272 6563 7420 636f 6e76 6572  r correct conver
+00000c00: 7369 6f6e 0a20 2020 2020 2020 2073 656c  sion.        sel
+00000c10: 662e 6578 7065 6374 6174 696f 6e5f 7375  f.expectation_su
+00000c20: 6974 6520 3d20 6578 7065 6374 6174 696f  ite = expectatio
+00000c30: 6e5f 7375 6974 650a 2020 2020 2020 2020  n_suite.        
+00000c40: 7365 6c66 2e5f 7374 6174 6973 7469 6373  self._statistics
+00000c50: 5f65 6e67 696e 6520 3d20 7374 6174 6973  _engine = statis
+00000c60: 7469 6373 5f65 6e67 696e 652e 5374 6174  tics_engine.Stat
+00000c70: 6973 7469 6373 456e 6769 6e65 280a 2020  isticsEngine(.  
+00000c80: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00000c90: 6573 746f 7265 5f69 642c 2073 656c 662e  estore_id, self.
+00000ca0: 454e 5449 5459 5f54 5950 450a 2020 2020  ENTITY_TYPE.    
+00000cb0: 2020 2020 290a 2020 2020 2020 2020 7365      ).        se
+00000cc0: 6c66 2e5f 636f 6465 5f65 6e67 696e 6520  lf._code_engine 
+00000cd0: 3d20 636f 6465 5f65 6e67 696e 652e 436f  = code_engine.Co
+00000ce0: 6465 456e 6769 6e65 2866 6561 7475 7265  deEngine(feature
+00000cf0: 7374 6f72 655f 6964 2c20 7365 6c66 2e45  store_id, self.E
+00000d00: 4e54 4954 595f 5459 5045 290a 2020 2020  NTITY_TYPE).    
+00000d10: 2020 2020 7365 6c66 2e5f 6772 6561 745f      self._great_
+00000d20: 6578 7065 6374 6174 696f 6e5f 656e 6769  expectation_engi
+00000d30: 6e65 203d 2028 0a20 2020 2020 2020 2020  ne = (.         
+00000d40: 2020 2067 7265 6174 5f65 7870 6563 7461     great_expecta
+00000d50: 7469 6f6e 5f65 6e67 696e 652e 4772 6561  tion_engine.Grea
+00000d60: 7445 7870 6563 7461 7469 6f6e 456e 6769  tExpectationEngi
+00000d70: 6e65 2866 6561 7475 7265 7374 6f72 655f  ne(featurestore_
+00000d80: 6964 290a 2020 2020 2020 2020 290a 2020  id).        ).  
+00000d90: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
+00000da0: 6420 6973 206e 6f74 204e 6f6e 653a 0a20  d is not None:. 
+00000db0: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
+00000dc0: 7065 6374 6174 696f 6e5f 7375 6974 653a  pectation_suite:
+00000dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00000de0: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
+00000df0: 6f6e 5f73 7569 7465 2e5f 696e 6974 5f65  on_suite._init_e
+00000e00: 7870 6563 7461 7469 6f6e 5f65 6e67 696e  xpectation_engin
+00000e10: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00000e20: 2020 2020 2020 2066 6561 7475 7265 5f73         feature_s
+00000e30: 746f 7265 5f69 643d 6665 6174 7572 6573  tore_id=features
+00000e40: 746f 7265 5f69 642c 2066 6561 7475 7265  tore_id, feature
+00000e50: 5f67 726f 7570 5f69 643d 7365 6c66 2e5f  _group_id=self._
+00000e60: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
+00000e70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00000e80: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
+00000e90: 6f6e 5f73 7569 7465 5f65 6e67 696e 6520  on_suite_engine 
+00000ea0: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00000eb0: 2020 2020 6578 7065 6374 6174 696f 6e5f      expectation_
+00000ec0: 7375 6974 655f 656e 6769 6e65 2e45 7870  suite_engine.Exp
+00000ed0: 6563 7461 7469 6f6e 5375 6974 6545 6e67  ectationSuiteEng
+00000ee0: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
+00000ef0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00000f00: 5f73 746f 7265 5f69 643d 6665 6174 7572  _store_id=featur
+00000f10: 6573 746f 7265 5f69 642c 2066 6561 7475  estore_id, featu
+00000f20: 7265 5f67 726f 7570 5f69 643d 7365 6c66  re_group_id=self
+00000f30: 2e5f 6964 0a20 2020 2020 2020 2020 2020  ._id.           
+00000f40: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00000f50: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00000f60: 2073 656c 662e 5f76 616c 6964 6174 696f   self._validatio
+00000f70: 6e5f 7265 706f 7274 5f65 6e67 696e 6520  n_report_engine 
+00000f80: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00000f90: 2020 2020 7661 6c69 6461 7469 6f6e 5f72      validation_r
+00000fa0: 6570 6f72 745f 656e 6769 6e65 2e56 616c  eport_engine.Val
+00000fb0: 6964 6174 696f 6e52 6570 6f72 7445 6e67  idationReportEng
+00000fc0: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
+00000fd0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+00000fe0: 7374 6f72 655f 6964 2c20 7365 6c66 2e5f  store_id, self._
+00000ff0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
+00001000: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00001010: 2029 0a20 2020 2020 2020 2020 2020 2073   ).            s
+00001020: 656c 662e 5f76 616c 6964 6174 696f 6e5f  elf._validation_
+00001030: 7265 7375 6c74 5f65 6e67 696e 6520 3d20  result_engine = 
+00001040: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00001050: 2020 7661 6c69 6461 7469 6f6e 5f72 6573    validation_res
+00001060: 756c 745f 656e 6769 6e65 2e56 616c 6964  ult_engine.Valid
+00001070: 6174 696f 6e52 6573 756c 7445 6e67 696e  ationResultEngin
+00001080: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+00001090: 2020 2020 2020 2066 6561 7475 7265 7374         featurest
+000010a0: 6f72 655f 6964 2c20 7365 6c66 2e5f 6964  ore_id, self._id
+000010b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000010c0: 2029 0a20 2020 2020 2020 2020 2020 2029   ).            )
+000010d0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000010e0: 662e 5f66 6561 7475 7265 5f6d 6f6e 6974  f._feature_monit
+000010f0: 6f72 696e 675f 636f 6e66 6967 5f65 6e67  oring_config_eng
+00001100: 696e 6520 3d20 280a 2020 2020 2020 2020  ine = (.        
+00001110: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00001120: 6d6f 6e69 746f 7269 6e67 5f63 6f6e 6669  monitoring_confi
+00001130: 675f 656e 6769 6e65 2e46 6561 7475 7265  g_engine.Feature
+00001140: 4d6f 6e69 746f 7269 6e67 436f 6e66 6967  MonitoringConfig
+00001150: 456e 6769 6e65 280a 2020 2020 2020 2020  Engine(.        
+00001160: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00001170: 7572 655f 7374 6f72 655f 6964 3d66 6561  ure_store_id=fea
+00001180: 7475 7265 7374 6f72 655f 6964 2c0a 2020  turestore_id,.  
+00001190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000011a0: 2020 6665 6174 7572 655f 6772 6f75 705f    feature_group_
+000011b0: 6964 3d73 656c 662e 5f69 642c 0a20 2020  id=self._id,.   
+000011c0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+000011d0: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+000011e0: 2020 2020 2020 2020 2073 656c 662e 5f66           self._f
+000011f0: 6561 7475 7265 5f6d 6f6e 6974 6f72 696e  eature_monitorin
+00001200: 675f 7265 7375 6c74 5f65 6e67 696e 6520  g_result_engine 
+00001210: 3d20 280a 2020 2020 2020 2020 2020 2020  = (.            
+00001220: 2020 2020 6665 6174 7572 655f 6d6f 6e69      feature_moni
+00001230: 746f 7269 6e67 5f72 6573 756c 745f 656e  toring_result_en
+00001240: 6769 6e65 2e46 6561 7475 7265 4d6f 6e69  gine.FeatureMoni
+00001250: 746f 7269 6e67 5265 7375 6c74 456e 6769  toringResultEngi
+00001260: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
+00001270: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+00001280: 7374 6f72 655f 6964 3d73 656c 662e 5f66  store_id=self._f
+00001290: 6561 7475 7265 5f73 746f 7265 5f69 642c  eature_store_id,
+000012a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000012b0: 2020 2020 2066 6561 7475 7265 5f67 726f       feature_gro
+000012c0: 7570 5f69 643d 7365 6c66 2e5f 6964 2c0a  up_id=self._id,.
+000012d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000012e0: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
+000012f0: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+00001300: 6561 7475 7265 5f73 746f 7265 5f69 6420  eature_store_id 
+00001310: 3d20 6665 6174 7572 6573 746f 7265 5f69  = featurestore_i
+00001320: 640a 2020 2020 2020 2020 7365 6c66 2e5f  d.        self._
+00001330: 7661 7269 6162 6c65 5f61 7069 203d 2056  variable_api = V
+00001340: 6172 6961 626c 6541 7069 2829 0a20 2020  ariableApi().   
+00001350: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
+00001360: 7265 5f67 726f 7570 5f65 6e67 696e 6520  re_group_engine 
+00001370: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00001380: 656c 662e 5f6d 756c 7469 5f70 6172 745f  elf._multi_part_
+00001390: 696e 7365 7274 203d 2046 616c 7365 0a20  insert = False. 
+000013a0: 2020 2020 2020 2073 656c 662e 5f65 6d62         self._emb
+000013b0: 6564 6469 6e67 5f69 6e64 6578 203d 2065  edding_index = e
+000013c0: 6d62 6564 6469 6e67 5f69 6e64 6578 0a0a  mbedding_index..
+000013d0: 2020 2020 2020 2020 7365 6c66 2e63 6865          self.che
+000013e0: 636b 5f64 6570 7265 6361 7465 6428 290a  ck_deprecated().
+000013f0: 0a20 2020 2064 6566 2063 6865 636b 5f64  .    def check_d
+00001400: 6570 7265 6361 7465 6428 7365 6c66 293a  eprecated(self):
+00001410: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00001420: 2e64 6570 7265 6361 7465 643a 0a20 2020  .deprecated:.   
+00001430: 2020 2020 2020 2020 2077 6172 6e69 6e67           warning
+00001440: 732e 7761 726e 280a 2020 2020 2020 2020  s.warn(.        
+00001450: 2020 2020 2020 2020 6622 4665 6174 7572          f"Featur
+00001460: 6520 4772 6f75 7020 607b 7365 6c66 2e5f  e Group `{self._
+00001470: 6e61 6d65 7d60 2c20 7665 7273 696f 6e20  name}`, version 
+00001480: 607b 7365 6c66 2e5f 7665 7273 696f 6e7d  `{self._version}
+00001490: 6020 6973 2064 6570 7265 6361 7465 6422  ` is deprecated"
+000014a0: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
+000014b0: 2020 2020 6465 6620 6465 6c65 7465 2873      def delete(s
+000014c0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+000014d0: 2244 726f 7020 7468 6520 656e 7469 7265  "Drop the entire
+000014e0: 2066 6561 7475 7265 2067 726f 7570 2061   feature group a
+000014f0: 6c6f 6e67 2077 6974 6820 6974 7320 6665  long with its fe
+00001500: 6174 7572 6520 6461 7461 2e0a 0a20 2020  ature data...   
+00001510: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
+00001520: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00001530: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+00001540: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
+00001550: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
+00001560: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
+00001570: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
+00001580: 2020 2020 2320 6765 7420 7468 6520 4665      # get the Fe
+00001590: 6174 7572 6520 4772 6f75 7020 696e 7374  ature Group inst
+000015a0: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
+000015b0: 2066 6720 3d20 6673 2e67 6574 5f6f 725f   fg = fs.get_or_
+000015c0: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
+000015d0: 726f 7570 280a 2020 2020 2020 2020 2020  roup(.          
+000015e0: 2020 2020 2020 2020 2020 6e61 6d65 3d27            name='
+000015f0: 6269 7463 6f69 6e5f 7072 6963 6527 2c0a  bitcoin_price',.
+00001600: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001610: 2020 2020 7665 7273 696f 6e3d 310a 2020      version=1.  
+00001620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001630: 2020 290a 0a20 2020 2020 2020 2020 2020    )..           
+00001640: 2023 2064 656c 6574 6520 7468 6520 6665   # delete the fe
+00001650: 6174 7572 6520 6772 6f75 700a 2020 2020  ature group.    
+00001660: 2020 2020 2020 2020 6667 2e64 656c 6574          fg.delet
+00001670: 6528 290a 2020 2020 2020 2020 2020 2020  e().            
+00001680: 6060 600a 0a20 2020 2020 2020 2021 2121  ```..        !!!
+00001690: 2064 616e 6765 7220 2250 6f74 656e 7469   danger "Potenti
+000016a0: 616c 6c79 2064 616e 6765 726f 7573 206f  ally dangerous o
+000016b0: 7065 7261 7469 6f6e 220a 2020 2020 2020  peration".      
+000016c0: 2020 2020 2020 5468 6973 206f 7065 7261        This opera
+000016d0: 7469 6f6e 2064 726f 7073 2061 6c6c 206d  tion drops all m
+000016e0: 6574 6164 6174 6120 6173 736f 6369 6174  etadata associat
+000016f0: 6564 2077 6974 6820 2a2a 7468 6973 2076  ed with **this v
+00001700: 6572 7369 6f6e 2a2a 206f 6620 7468 650a  ersion** of the.
+00001710: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00001720: 7572 6520 6772 6f75 7020 2a2a 616e 642a  ure group **and*
+00001730: 2a20 616c 6c20 7468 6520 6665 6174 7572  * all the featur
+00001740: 6520 6461 7461 2069 6e20 6f66 666c 696e  e data in offlin
+00001750: 6520 616e 6420 6f6e 6c69 6e65 2073 746f  e and online sto
+00001760: 7261 6765 0a20 2020 2020 2020 2020 2020  rage.           
+00001770: 2061 7373 6f63 6961 7465 6420 7769 7468   associated with
+00001780: 2069 742e 0a0a 2020 2020 2020 2020 2320   it...        # 
+00001790: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
+000017a0: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
+000017b0: 6578 6365 7074 696f 6e73 2e52 6573 7441  exceptions.RestA
+000017c0: 5049 4572 726f 7260 2e0a 2020 2020 2020  PIError`..      
+000017d0: 2020 2222 220a 2020 2020 2020 2020 7761    """.        wa
+000017e0: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
+000017f0: 2020 2020 2020 2020 2022 416c 6c20 6a6f           "All jo
+00001800: 6273 2061 7373 6f63 6961 7465 6420 746f  bs associated to
+00001810: 2066 6561 7475 7265 2067 726f 7570 2060   feature group `
+00001820: 7b7d 602c 2076 6572 7369 6f6e 2060 7b7d  {}`, version `{}
+00001830: 6020 7769 6c6c 2062 6520 7265 6d6f 7665  ` will be remove
+00001840: 642e 222e 666f 726d 6174 280a 2020 2020  d.".format(.    
+00001850: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001860: 2e5f 6e61 6d65 2c20 7365 6c66 2e5f 7665  ._name, self._ve
+00001870: 7273 696f 6e0a 2020 2020 2020 2020 2020  rsion.          
+00001880: 2020 292c 0a20 2020 2020 2020 2020 2020    ),.           
+00001890: 2075 7469 6c2e 4a6f 6257 6172 6e69 6e67   util.JobWarning
+000018a0: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
+000018b0: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
+000018c0: 655f 6772 6f75 705f 656e 6769 6e65 2e64  e_group_engine.d
+000018d0: 656c 6574 6528 7365 6c66 290a 0a20 2020  elete(self)..   
+000018e0: 2064 6566 2073 656c 6563 745f 616c 6c28   def select_all(
+000018f0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00001900: 2020 2020 2020 2069 6e63 6c75 6465 5f70         include_p
+00001910: 7269 6d61 7279 5f6b 6579 3a20 4f70 7469  rimary_key: Opti
+00001920: 6f6e 616c 5b62 6f6f 6c5d 203d 2054 7275  onal[bool] = Tru
+00001930: 652c 0a20 2020 2020 2020 2069 6e63 6c75  e,.        inclu
+00001940: 6465 5f65 7665 6e74 5f74 696d 653a 204f  de_event_time: O
+00001950: 7074 696f 6e61 6c5b 626f 6f6c 5d20 3d20  ptional[bool] = 
+00001960: 5472 7565 2c0a 2020 2020 293a 0a20 2020  True,.    ):.   
+00001970: 2020 2020 2022 2222 5365 6c65 6374 2061       """Select a
+00001980: 6c6c 2066 6561 7475 7265 7320 696e 2074  ll features in t
+00001990: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+000019a0: 2061 6e64 2072 6574 7572 6e20 6120 7175   and return a qu
+000019b0: 6572 7920 6f62 6a65 6374 2e0a 0a20 2020  ery object...   
+000019c0: 2020 2020 2054 6865 2071 7565 7279 2063       The query c
+000019d0: 616e 2062 6520 7573 6564 2074 6f20 636f  an be used to co
+000019e0: 6e73 7472 7563 7420 6a6f 696e 7320 6f66  nstruct joins of
+000019f0: 2066 6561 7475 7265 2067 726f 7570 7320   feature groups 
+00001a00: 6f72 2063 7265 6174 6520 610a 2020 2020  or create a.    
+00001a10: 2020 2020 6665 6174 7572 6520 7669 6577      feature view
+00001a20: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+00001a30: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+00001a40: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+00001a50: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
+00001a60: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
+00001a70: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
+00001a80: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
+00001a90: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+00001aa0: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+00001ab0: 7020 696e 7374 616e 6365 730a 2020 2020  p instances.    
+00001ac0: 2020 2020 2020 2020 6667 3120 3d20 6673          fg1 = fs
+00001ad0: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
+00001ae0: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
+00001af0: 290a 2020 2020 2020 2020 2020 2020 6667  ).            fg
+00001b00: 3220 3d20 6673 2e67 6574 5f6f 725f 6372  2 = fs.get_or_cr
+00001b10: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
+00001b20: 7570 282e 2e2e 290a 0a20 2020 2020 2020  up(...)..       
+00001b30: 2020 2020 2023 2063 6f6e 7374 7275 6374       # construct
+00001b40: 2074 6865 2071 7565 7279 0a20 2020 2020   the query.     
+00001b50: 2020 2020 2020 2071 7565 7279 203d 2066         query = f
+00001b60: 6731 2e73 656c 6563 745f 616c 6c28 292e  g1.select_all().
+00001b70: 6a6f 696e 2866 6732 2e73 656c 6563 745f  join(fg2.select_
+00001b80: 616c 6c28 2929 0a0a 2020 2020 2020 2020  all())..        
+00001b90: 2020 2020 2320 7368 6f77 2066 6972 7374      # show first
+00001ba0: 2035 2072 6f77 730a 2020 2020 2020 2020   5 rows.        
+00001bb0: 2020 2020 7175 6572 792e 7368 6f77 2835      query.show(5
+00001bc0: 290a 0a0a 2020 2020 2020 2020 2020 2020  )...            
+00001bd0: 2320 7365 6c65 6374 2061 6c6c 2066 6561  # select all fea
+00001be0: 7475 7265 7320 6578 636c 7564 6520 7072  tures exclude pr
+00001bf0: 696d 6172 7920 6b65 7920 616e 6420 6576  imary key and ev
+00001c00: 656e 7420 7469 6d65 0a20 2020 2020 2020  ent time.       
+00001c10: 2020 2020 2066 726f 6d20 6873 6673 2e66       from hsfs.f
+00001c20: 6561 7475 7265 2069 6d70 6f72 7420 4665  eature import Fe
+00001c30: 6174 7572 650a 2020 2020 2020 2020 2020  ature.          
+00001c40: 2020 6667 203d 2066 732e 6372 6561 7465    fg = fs.create
+00001c50: 5f66 6561 7475 7265 5f67 726f 7570 280a  _feature_group(.
+00001c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001c70: 2020 2020 2266 6722 2c0a 2020 2020 2020      "fg",.      
+00001c80: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+00001c90: 6174 7572 6573 3d5b 0a20 2020 2020 2020  atures=[.       
+00001ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001cb0: 2020 2020 2046 6561 7475 7265 2822 6964       Feature("id
+00001cc0: 222c 2074 7970 653d 2273 7472 696e 6722  ", type="string"
+00001cd0: 292c 0a20 2020 2020 2020 2020 2020 2020  ),.             
+00001ce0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
+00001cf0: 6561 7475 7265 2822 7473 222c 2074 7970  eature("ts", typ
+00001d00: 653d 2262 6967 696e 7422 292c 0a20 2020  e="bigint"),.   
+00001d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001d20: 2020 2020 2020 2020 2046 6561 7475 7265           Feature
+00001d30: 2822 6631 222c 2074 7970 653d 2264 6174  ("f1", type="dat
+00001d40: 6522 292c 0a20 2020 2020 2020 2020 2020  e"),.           
+00001d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001d60: 2046 6561 7475 7265 2822 6632 222c 2074   Feature("f2", t
+00001d70: 7970 653d 2264 6f75 626c 6522 290a 2020  ype="double").  
+00001d80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001d90: 2020 2020 2020 2020 2020 5d2c 0a20 2020            ],.   
+00001da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00001db0: 2070 7269 6d61 7279 5f6b 6579 3d5b 2269   primary_key=["i
+00001dc0: 6422 5d2c 0a20 2020 2020 2020 2020 2020  d"],.           
+00001dd0: 2020 2020 2020 2020 2065 7665 6e74 5f74           event_t
+00001de0: 696d 653d 2274 7322 290a 0a20 2020 2020  ime="ts")..     
+00001df0: 2020 2020 2020 2071 7565 7279 203d 2066         query = f
+00001e00: 672e 7365 6c65 6374 5f61 6c6c 2829 0a20  g.select_all(). 
+00001e10: 2020 2020 2020 2020 2020 2071 7565 7279             query
+00001e20: 2e66 6561 7475 7265 730a 2020 2020 2020  .features.      
+00001e30: 2020 2020 2020 2320 5b46 6561 7475 7265        # [Feature
+00001e40: 2827 6964 272c 202e 2e2e 292c 2046 6561  ('id', ...), Fea
+00001e50: 7475 7265 2827 7473 272c 202e 2e2e 292c  ture('ts', ...),
+00001e60: 2046 6561 7475 7265 2827 6631 272c 202e   Feature('f1', .
+00001e70: 2e2e 292c 2046 6561 7475 7265 2827 6632  ..), Feature('f2
+00001e80: 272c 202e 2e2e 295d 0a0a 2020 2020 2020  ', ...)]..      
+00001e90: 2020 2020 2020 7175 6572 7920 3d20 6667        query = fg
+00001ea0: 2e73 656c 6563 745f 616c 6c28 696e 636c  .select_all(incl
+00001eb0: 7564 655f 7072 696d 6172 795f 6b65 793d  ude_primary_key=
+00001ec0: 4661 6c73 652c 2069 6e63 6c75 6465 5f65  False, include_e
+00001ed0: 7665 6e74 5f74 696d 653d 4661 6c73 6529  vent_time=False)
+00001ee0: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
+00001ef0: 7279 2e66 6561 7475 7265 730a 2020 2020  ry.features.    
+00001f00: 2020 2020 2020 2020 2320 5b46 6561 7475          # [Featu
+00001f10: 7265 2827 6631 272c 202e 2e2e 292c 2046  re('f1', ...), F
+00001f20: 6561 7475 7265 2827 6632 272c 202e 2e2e  eature('f2', ...
+00001f30: 295d 0a20 2020 2020 2020 2020 2020 2060  )].            `
+00001f40: 6060 0a0a 2020 2020 2020 2020 2320 4172  ``..        # Ar
+00001f50: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
+00001f60: 2020 2020 696e 636c 7564 655f 7072 696d      include_prim
+00001f70: 6172 795f 6b65 793a 2049 6620 5472 7565  ary_key: If True
+00001f80: 2c20 696e 636c 7564 6520 7072 696d 6172  , include primar
+00001f90: 7920 6b65 7920 6f66 2074 6865 2066 6561  y key of the fea
+00001fa0: 7475 7265 2067 726f 7570 0a20 2020 2020  ture group.     
+00001fb0: 2020 2020 2020 2020 2020 2074 6f20 7468             to th
+00001fc0: 6520 6665 6174 7572 6520 6c69 7374 2e20  e feature list. 
+00001fd0: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
+00001fe0: 2e0a 2020 2020 2020 2020 2020 2020 696e  ..            in
+00001ff0: 636c 7564 655f 6576 656e 745f 7469 6d65  clude_event_time
+00002000: 3a20 4966 2054 7275 652c 2069 6e63 6c75  : If True, inclu
+00002010: 6465 2065 7665 6e74 2074 696d 6520 6f66  de event time of
+00002020: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00002030: 7570 0a20 2020 2020 2020 2020 2020 2020  up.             
+00002040: 2020 2074 6f20 7468 6520 6665 6174 7572     to the featur
+00002050: 6520 6c69 7374 2e20 4465 6661 756c 7473  e list. Defaults
+00002060: 2074 6f20 5472 7565 2e0a 2020 2020 2020   to True..      
+00002070: 2020 2320 5265 7475 726e 730a 2020 2020    # Returns.    
+00002080: 2020 2020 2020 2020 6051 7565 7279 602e          `Query`.
+00002090: 2041 2071 7565 7279 206f 626a 6563 7420   A query object 
+000020a0: 7769 7468 2061 6c6c 2066 6561 7475 7265  with all feature
+000020b0: 7320 6f66 2074 6865 2066 6561 7475 7265  s of the feature
+000020c0: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
+000020d0: 2222 220a 2020 2020 2020 2020 6966 2069  """.        if i
+000020e0: 6e63 6c75 6465 5f65 7665 6e74 5f74 696d  nclude_event_tim
+000020f0: 6520 616e 6420 696e 636c 7564 655f 7072  e and include_pr
+00002100: 696d 6172 795f 6b65 793a 0a20 2020 2020  imary_key:.     
+00002110: 2020 2020 2020 2072 6574 7572 6e20 7175         return qu
+00002120: 6572 795f 6d6f 642e 5175 6572 7928 0a20  ery_mod.Query(. 
+00002130: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+00002140: 6566 745f 6665 6174 7572 655f 6772 6f75  eft_feature_grou
+00002150: 703d 7365 6c66 2c0a 2020 2020 2020 2020  p=self,.        
+00002160: 2020 2020 2020 2020 6c65 6674 5f66 6561          left_fea
+00002170: 7475 7265 733d 7365 6c66 2e5f 6665 6174  tures=self._feat
+00002180: 7572 6573 2c0a 2020 2020 2020 2020 2020  ures,.          
+00002190: 2020 2020 2020 6665 6174 7572 655f 7374        feature_st
+000021a0: 6f72 655f 6e61 6d65 3d73 656c 662e 5f66  ore_name=self._f
+000021b0: 6561 7475 7265 5f73 746f 7265 5f6e 616d  eature_store_nam
+000021c0: 652c 0a20 2020 2020 2020 2020 2020 2020  e,.             
+000021d0: 2020 2066 6561 7475 7265 5f73 746f 7265     feature_store
+000021e0: 5f69 643d 7365 6c66 2e5f 6665 6174 7572  _id=self._featur
+000021f0: 655f 7374 6f72 655f 6964 2c0a 2020 2020  e_store_id,.    
+00002200: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00002210: 2020 656c 6966 2069 6e63 6c75 6465 5f65    elif include_e
+00002220: 7665 6e74 5f74 696d 653a 0a20 2020 2020  vent_time:.     
+00002230: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00002240: 6c66 2e73 656c 6563 745f 6578 6365 7074  lf.select_except
+00002250: 2873 656c 662e 7072 696d 6172 795f 6b65  (self.primary_ke
+00002260: 7929 0a20 2020 2020 2020 2065 6c69 6620  y).        elif 
+00002270: 696e 636c 7564 655f 7072 696d 6172 795f  include_primary_
+00002280: 6b65 793a 0a20 2020 2020 2020 2020 2020  key:.           
+00002290: 2072 6574 7572 6e20 7365 6c66 2e73 656c   return self.sel
+000022a0: 6563 745f 6578 6365 7074 285b 7365 6c66  ect_except([self
+000022b0: 2e65 7665 6e74 5f74 696d 655d 290a 2020  .event_time]).  
+000022c0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
+000022d0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000022e0: 656c 662e 7365 6c65 6374 5f65 7863 6570  elf.select_excep
+000022f0: 7428 7365 6c66 2e70 7269 6d61 7279 5f6b  t(self.primary_k
+00002300: 6579 202b 205b 7365 6c66 2e65 7665 6e74  ey + [self.event
+00002310: 5f74 696d 655d 290a 0a20 2020 2064 6566  _time])..    def
+00002320: 2073 656c 6563 7428 7365 6c66 2c20 6665   select(self, fe
+00002330: 6174 7572 6573 3a20 4c69 7374 5b55 6e69  atures: List[Uni
+00002340: 6f6e 5b73 7472 2c20 6665 6174 7572 652e  on[str, feature.
+00002350: 4665 6174 7572 655d 5d29 3a0a 2020 2020  Feature]]):.    
+00002360: 2020 2020 2222 2253 656c 6563 7420 6120      """Select a 
+00002370: 7375 6273 6574 206f 6620 6665 6174 7572  subset of featur
+00002380: 6573 206f 6620 7468 6520 6665 6174 7572  es of the featur
+00002390: 6520 6772 6f75 7020 616e 6420 7265 7475  e group and retu
+000023a0: 726e 2061 2071 7565 7279 206f 626a 6563  rn a query objec
+000023b0: 742e 0a0a 2020 2020 2020 2020 5468 6520  t...        The 
+000023c0: 7175 6572 7920 6361 6e20 6265 2075 7365  query can be use
+000023d0: 6420 746f 2063 6f6e 7374 7275 6374 206a  d to construct j
+000023e0: 6f69 6e73 206f 6620 6665 6174 7572 6520  oins of feature 
+000023f0: 6772 6f75 7073 206f 7220 6372 6561 7465  groups or create
+00002400: 2061 0a20 2020 2020 2020 2066 6561 7475   a.        featu
+00002410: 7265 2076 6965 7720 7769 7468 2061 2073  re view with a s
+00002420: 7562 7365 7420 6f66 2066 6561 7475 7265  ubset of feature
+00002430: 7320 6f66 2074 6865 2066 6561 7475 7265  s of the feature
+00002440: 2067 726f 7570 2e0a 0a20 2020 2020 2020   group...       
+00002450: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+00002460: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00002470: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
+00002480: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
+00002490: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
+000024a0: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
+000024b0: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
+000024c0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
+000024d0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
+000024e0: 0a20 2020 2020 2020 2020 2020 2066 726f  .            fro
+000024f0: 6d20 6873 6673 2e66 6561 7475 7265 2069  m hsfs.feature i
+00002500: 6d70 6f72 7420 4665 6174 7572 650a 2020  mport Feature.  
+00002510: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+00002520: 732e 6372 6561 7465 5f66 6561 7475 7265  s.create_feature
+00002530: 5f67 726f 7570 280a 2020 2020 2020 2020  _group(.        
+00002540: 2020 2020 2020 2020 2020 2020 2266 6722              "fg"
+00002550: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002560: 2020 2020 2020 6665 6174 7572 6573 3d5b        features=[
+00002570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00002580: 2020 2020 2020 2020 2020 2020 2046 6561               Fea
+00002590: 7475 7265 2822 6964 222c 2074 7970 653d  ture("id", type=
+000025a0: 2273 7472 696e 6722 292c 0a20 2020 2020  "string"),.     
+000025b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000025c0: 2020 2020 2020 2046 6561 7475 7265 2822         Feature("
+000025d0: 7473 222c 2074 7970 653d 2262 6967 696e  ts", type="bigin
+000025e0: 7422 292c 0a20 2020 2020 2020 2020 2020  t"),.           
+000025f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002600: 2046 6561 7475 7265 2822 6631 222c 2074   Feature("f1", t
+00002610: 7970 653d 2264 6174 6522 292c 0a20 2020  ype="date"),.   
+00002620: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002630: 2020 2020 2020 2020 2046 6561 7475 7265           Feature
+00002640: 2822 6632 222c 2074 7970 653d 2264 6f75  ("f2", type="dou
+00002650: 626c 6522 290a 2020 2020 2020 2020 2020  ble").          
+00002660: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002670: 2020 5d2c 0a20 2020 2020 2020 2020 2020    ],.           
+00002680: 2020 2020 2020 2020 2070 7269 6d61 7279           primary
+00002690: 5f6b 6579 3d5b 2269 6422 5d2c 0a20 2020  _key=["id"],.   
+000026a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000026b0: 2065 7665 6e74 5f74 696d 653d 2274 7322   event_time="ts"
+000026c0: 290a 0a20 2020 2020 2020 2020 2020 2023  )..            #
+000026d0: 2063 6f6e 7374 7275 6374 2071 7565 7279   construct query
+000026e0: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
+000026f0: 7279 203d 2066 672e 7365 6c65 6374 285b  ry = fg.select([
+00002700: 2269 6422 2c20 2266 3122 5d29 0a20 2020  "id", "f1"]).   
+00002710: 2020 2020 2020 2020 2071 7565 7279 2e66           query.f
+00002720: 6561 7475 7265 730a 2020 2020 2020 2020  eatures.        
+00002730: 2020 2020 2320 5b46 6561 7475 7265 2827      # [Feature('
+00002740: 6964 272c 202e 2e2e 292c 2046 6561 7475  id', ...), Featu
+00002750: 7265 2827 6631 272c 202e 2e2e 295d 0a20  re('f1', ...)]. 
+00002760: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+00002770: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+00002780: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+00002790: 6665 6174 7572 6573 3a20 4120 6c69 7374  features: A list
+000027a0: 206f 6620 6046 6561 7475 7265 6020 6f62   of `Feature` ob
+000027b0: 6a65 6374 7320 6f72 2066 6561 7475 7265  jects or feature
+000027c0: 206e 616d 6573 2061 730a 2020 2020 2020   names as.      
+000027d0: 2020 2020 2020 2020 2020 7374 7269 6e67            string
+000027e0: 7320 746f 2062 6520 7365 6c65 6374 6564  s to be selected
+000027f0: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
+00002800: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
+00002810: 2060 5175 6572 7960 3a20 4120 7175 6572   `Query`: A quer
+00002820: 7920 6f62 6a65 6374 2077 6974 6820 7468  y object with th
+00002830: 6520 7365 6c65 6374 6564 2066 6561 7475  e selected featu
+00002840: 7265 7320 6f66 2074 6865 2066 6561 7475  res of the featu
+00002850: 7265 2067 726f 7570 2e0a 2020 2020 2020  re group..      
+00002860: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00002870: 7475 726e 2071 7565 7279 5f6d 6f64 2e51  turn query_mod.Q
+00002880: 7565 7279 280a 2020 2020 2020 2020 2020  uery(.          
+00002890: 2020 6c65 6674 5f66 6561 7475 7265 5f67    left_feature_g
+000028a0: 726f 7570 3d73 656c 662c 0a20 2020 2020  roup=self,.     
+000028b0: 2020 2020 2020 206c 6566 745f 6665 6174         left_feat
+000028c0: 7572 6573 3d66 6561 7475 7265 732c 0a20  ures=features,. 
+000028d0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+000028e0: 7265 5f73 746f 7265 5f6e 616d 653d 7365  re_store_name=se
+000028f0: 6c66 2e5f 6665 6174 7572 655f 7374 6f72  lf._feature_stor
+00002900: 655f 6e61 6d65 2c0a 2020 2020 2020 2020  e_name,.        
+00002910: 2020 2020 6665 6174 7572 655f 7374 6f72      feature_stor
+00002920: 655f 6964 3d73 656c 662e 5f66 6561 7475  e_id=self._featu
+00002930: 7265 5f73 746f 7265 5f69 642c 0a20 2020  re_store_id,.   
+00002940: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+00002950: 7365 6c65 6374 5f65 7863 6570 7428 7365  select_except(se
+00002960: 6c66 2c20 6665 6174 7572 6573 3a20 4f70  lf, features: Op
+00002970: 7469 6f6e 616c 5b4c 6973 745b 556e 696f  tional[List[Unio
+00002980: 6e5b 7374 722c 2066 6561 7475 7265 2e46  n[str, feature.F
+00002990: 6561 7475 7265 5d5d 5d20 3d20 5b5d 293a  eature]]] = []):
+000029a0: 0a20 2020 2020 2020 2022 2222 5365 6c65  .        """Sele
+000029b0: 6374 2061 6c6c 2066 6561 7475 7265 7320  ct all features 
+000029c0: 696e 636c 7564 696e 6720 7072 696d 6172  including primar
+000029d0: 7920 6b65 7920 616e 6420 6576 656e 7420  y key and event 
+000029e0: 7469 6d65 2066 6561 7475 7265 0a20 2020  time feature.   
+000029f0: 2020 2020 206f 6620 7468 6520 6665 6174       of the feat
+00002a00: 7572 6520 6772 6f75 7020 6578 6365 7074  ure group except
+00002a10: 2070 726f 7669 6465 6420 6066 6561 7475   provided `featu
+00002a20: 7265 7360 2061 6e64 2072 6574 7572 6e20  res` and return 
+00002a30: 6120 7175 6572 7920 6f62 6a65 6374 2e0a  a query object..
+00002a40: 0a20 2020 2020 2020 2054 6865 2071 7565  .        The que
+00002a50: 7279 2063 616e 2062 6520 7573 6564 2074  ry can be used t
+00002a60: 6f20 636f 6e73 7472 7563 7420 6a6f 696e  o construct join
+00002a70: 7320 6f66 2066 6561 7475 7265 2067 726f  s of feature gro
+00002a80: 7570 7320 6f72 2063 7265 6174 6520 610a  ups or create a.
+00002a90: 2020 2020 2020 2020 6665 6174 7572 6520          feature 
+00002aa0: 7669 6577 2077 6974 6820 6120 7375 6273  view with a subs
+00002ab0: 6574 206f 6620 6665 6174 7572 6573 206f  et of features o
+00002ac0: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
+00002ad0: 6f75 702e 0a0a 2020 2020 2020 2020 2121  oup...        !!
+00002ae0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+00002af0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00002b00: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+00002b10: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+00002b20: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+00002b30: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+00002b40: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+00002b50: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+00002b60: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+00002b70: 2020 2020 2020 2020 2020 6672 6f6d 2068            from h
+00002b80: 7366 732e 6665 6174 7572 6520 696d 706f  sfs.feature impo
+00002b90: 7274 2046 6561 7475 7265 0a20 2020 2020  rt Feature.     
+00002ba0: 2020 2020 2020 2066 6720 3d20 6673 2e63         fg = fs.c
+00002bb0: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
+00002bc0: 6f75 7028 0a20 2020 2020 2020 2020 2020  oup(.           
+00002bd0: 2020 2020 2020 2020 2022 6667 222c 0a20           "fg",. 
 00002be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002bf0: 2020 4665 6174 7572 6528 2274 7322 2c20    Feature("ts", 
-00002c00: 7479 7065 3d22 6269 6769 6e74 2229 2c0a  type="bigint"),.
-00002c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c20: 2020 2020 2020 2020 2020 2020 4665 6174              Feat
-00002c30: 7572 6528 2266 3122 2c20 7479 7065 3d22  ure("f1", type="
-00002c40: 6461 7465 2229 2c0a 2020 2020 2020 2020  date"),.        
-00002c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002c60: 2020 2020 4665 6174 7572 6528 2266 3222      Feature("f2"
-00002c70: 2c20 7479 7065 3d22 646f 7562 6c65 2229  , type="double")
-00002c80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002c90: 2020 2020 2020 2020 2020 2020 205d 2c0a               ],.
-00002ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00002cb0: 2020 2020 7072 696d 6172 795f 6b65 793d      primary_key=
-00002cc0: 5b22 6964 225d 2c0a 2020 2020 2020 2020  ["id"],.        
-00002cd0: 2020 2020 2020 2020 2020 2020 6576 656e              even
-00002ce0: 745f 7469 6d65 3d22 7473 2229 0a0a 2020  t_time="ts")..  
-00002cf0: 2020 2020 2020 2020 2020 2320 636f 6e73            # cons
-00002d00: 7472 7563 7420 7175 6572 790a 2020 2020  truct query.    
-00002d10: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-00002d20: 6667 2e73 656c 6563 745f 6578 6365 7074  fg.select_except
-00002d30: 285b 2274 7322 2c20 2266 3122 5d29 0a20  (["ts", "f1"]). 
-00002d40: 2020 2020 2020 2020 2020 2071 7565 7279             query
-00002d50: 2e66 6561 7475 7265 730a 2020 2020 2020  .features.      
-00002d60: 2020 2020 2020 2320 5b46 6561 7475 7265        # [Feature
-00002d70: 2827 6964 272c 202e 2e2e 292c 2046 6561  ('id', ...), Fea
-00002d80: 7475 7265 2827 6631 272c 202e 2e2e 295d  ture('f1', ...)]
-00002d90: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-00002da0: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-00002db0: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00002dc0: 2020 6665 6174 7572 6573 3a20 4120 6c69    features: A li
-00002dd0: 7374 206f 6620 6046 6561 7475 7265 6020  st of `Feature` 
-00002de0: 6f62 6a65 6374 7320 6f72 2066 6561 7475  objects or featu
-00002df0: 7265 206e 616d 6573 2061 730a 2020 2020  re names as.    
-00002e00: 2020 2020 2020 2020 2020 2020 7374 7269              stri
-00002e10: 6e67 7320 746f 2062 6520 6578 636c 7564  ngs to be exclud
-00002e20: 6564 2066 726f 6d20 7468 6520 7365 6c65  ed from the sele
-00002e30: 6374 696f 6e2e 2044 6566 6175 6c74 7320  ction. Defaults 
-00002e40: 746f 205b 5d2c 0a20 2020 2020 2020 2020  to [],.         
-00002e50: 2020 2020 2020 2073 656c 6563 7469 6e67         selecting
-00002e60: 2061 6c6c 2066 6561 7475 7265 732e 0a0a   all features...
-00002e70: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-00002e80: 730a 2020 2020 2020 2020 2020 2020 6051  s.            `Q
-00002e90: 7565 7279 603a 2041 2071 7565 7279 206f  uery`: A query o
-00002ea0: 626a 6563 7420 7769 7468 2074 6865 2073  bject with the s
-00002eb0: 656c 6563 7465 6420 6665 6174 7572 6573  elected features
-00002ec0: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00002ed0: 6772 6f75 702e 0a20 2020 2020 2020 2022  group..        "
-00002ee0: 2222 0a20 2020 2020 2020 2069 6620 6665  "".        if fe
-00002ef0: 6174 7572 6573 3a0a 2020 2020 2020 2020  atures:.        
-00002f00: 2020 2020 6578 6365 7074 5f66 6561 7475      except_featu
-00002f10: 7265 7320 3d20 5b0a 2020 2020 2020 2020  res = [.        
-00002f20: 2020 2020 2020 2020 662e 6e61 6d65 2069          f.name i
-00002f30: 6620 6973 696e 7374 616e 6365 2866 2c20  f isinstance(f, 
-00002f40: 6665 6174 7572 652e 4665 6174 7572 6529  feature.Feature)
-00002f50: 2065 6c73 6520 6620 666f 7220 6620 696e   else f for f in
-00002f60: 2066 6561 7475 7265 730a 2020 2020 2020   features.      
-00002f70: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00002f80: 2020 2020 7265 7475 726e 2071 7565 7279      return query
-00002f90: 2e51 7565 7279 280a 2020 2020 2020 2020  .Query(.        
-00002fa0: 2020 2020 2020 2020 6c65 6674 5f66 6561          left_fea
-00002fb0: 7475 7265 5f67 726f 7570 3d73 656c 662c  ture_group=self,
-00002fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002fd0: 206c 6566 745f 6665 6174 7572 6573 3d5b   left_features=[
-00002fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00002ff0: 2020 2020 2066 2066 6f72 2066 2069 6e20       f for f in 
-00003000: 7365 6c66 2e5f 6665 6174 7572 6573 2069  self._features i
-00003010: 6620 662e 6e61 6d65 206e 6f74 2069 6e20  f f.name not in 
-00003020: 6578 6365 7074 5f66 6561 7475 7265 730a  except_features.
-00003030: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003040: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00003050: 2020 2066 6561 7475 7265 5f73 746f 7265     feature_store
-00003060: 5f6e 616d 653d 7365 6c66 2e5f 6665 6174  _name=self._feat
-00003070: 7572 655f 7374 6f72 655f 6e61 6d65 2c0a  ure_store_name,.
-00003080: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00003090: 6665 6174 7572 655f 7374 6f72 655f 6964  feature_store_id
-000030a0: 3d73 656c 662e 5f66 6561 7475 7265 5f73  =self._feature_s
-000030b0: 746f 7265 5f69 642c 0a20 2020 2020 2020  tore_id,.       
-000030c0: 2020 2020 2029 0a20 2020 2020 2020 2065       ).        e
-000030d0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
-000030e0: 2072 6574 7572 6e20 7365 6c66 2e73 656c   return self.sel
-000030f0: 6563 745f 616c 6c28 290a 0a20 2020 2064  ect_all()..    d
-00003100: 6566 2066 696c 7465 7228 7365 6c66 2c20  ef filter(self, 
-00003110: 663a 2055 6e69 6f6e 5b66 696c 7465 722e  f: Union[filter.
-00003120: 4669 6c74 6572 2c20 6669 6c74 6572 2e4c  Filter, filter.L
-00003130: 6f67 6963 5d29 3a0a 2020 2020 2020 2020  ogic]):.        
-00003140: 2222 2241 7070 6c79 2066 696c 7465 7220  """Apply filter 
-00003150: 746f 2074 6865 2066 6561 7475 7265 2067  to the feature g
-00003160: 726f 7570 2e0a 0a20 2020 2020 2020 2053  roup...        S
-00003170: 656c 6563 7473 2061 6c6c 2066 6561 7475  elects all featu
-00003180: 7265 7320 616e 6420 7265 7475 726e 7320  res and returns 
-00003190: 7468 6520 7265 7375 6c74 696e 6720 6051  the resulting `Q
-000031a0: 7565 7279 6020 7769 7468 2074 6865 2061  uery` with the a
-000031b0: 7070 6c69 6564 2066 696c 7465 722e 0a20  pplied filter.. 
-000031c0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
-000031d0: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
-000031e0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-000031f0: 2020 2020 2066 726f 6d20 6873 6673 2e66       from hsfs.f
-00003200: 6561 7475 7265 2069 6d70 6f72 7420 4665  eature import Fe
-00003210: 6174 7572 650a 0a20 2020 2020 2020 2020  ature..         
-00003220: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
-00003230: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
-00003240: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
-00003250: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
-00003260: 2020 2020 2320 6765 7420 7468 6520 4665      # get the Fe
-00003270: 6174 7572 6520 4772 6f75 7020 696e 7374  ature Group inst
-00003280: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
-00003290: 2066 6720 3d20 6673 2e67 6574 5f6f 725f   fg = fs.get_or_
-000032a0: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-000032b0: 726f 7570 282e 2e2e 290a 0a20 2020 2020  roup(...)..     
-000032c0: 2020 2020 2020 2066 672e 6669 6c74 6572         fg.filter
-000032d0: 2846 6561 7475 7265 2822 7765 656b 6c79  (Feature("weekly
-000032e0: 5f73 616c 6573 2229 203e 2031 3030 3029  _sales") > 1000)
-000032f0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-00003300: 0a0a 2020 2020 2020 2020 4966 2079 6f75  ..        If you
-00003310: 2061 7265 2070 6c61 6e6e 696e 6720 746f   are planning to
-00003320: 206a 6f69 6e20 7468 6520 6669 6c74 6572   join the filter
-00003330: 6564 2066 6561 7475 7265 2067 726f 7570  ed feature group
-00003340: 206c 6174 6572 206f 6e20 7769 7468 2061   later on with a
-00003350: 6e6f 7468 6572 0a20 2020 2020 2020 2066  nother.        f
-00003360: 6561 7475 7265 2067 726f 7570 2c20 6d61  eature group, ma
-00003370: 6b65 2073 7572 6520 746f 2073 656c 6563  ke sure to selec
-00003380: 7420 7468 6520 6669 6c74 6572 6564 2066  t the filtered f
-00003390: 6561 7475 7265 2065 7870 6c69 6369 746c  eature explicitl
-000033a0: 7920 6672 6f6d 2074 6865 0a20 2020 2020  y from the.     
-000033b0: 2020 2072 6573 7065 6374 6976 6520 6665     respective fe
-000033c0: 6174 7572 6520 6772 6f75 703a 0a20 2020  ature group:.   
-000033d0: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
-000033e0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-000033f0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-00003400: 2020 2066 672e 6669 6c74 6572 2866 672e     fg.filter(fg.
-00003410: 6665 6174 7572 6531 203d 3d20 3129 2e73  feature1 == 1).s
-00003420: 686f 7728 3130 290a 2020 2020 2020 2020  how(10).        
-00003430: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-00003440: 2043 6f6d 706f 7369 7465 2066 696c 7465   Composite filte
-00003450: 7273 2072 6571 7569 7265 2070 6172 656e  rs require paren
-00003460: 7468 6573 6973 3a0a 2020 2020 2020 2020  thesis:.        
-00003470: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
-00003480: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-00003490: 6e0a 2020 2020 2020 2020 2020 2020 6667  n.            fg
-000034a0: 2e66 696c 7465 7228 2866 672e 6665 6174  .filter((fg.feat
-000034b0: 7572 6531 203d 3d20 3129 207c 2028 6667  ure1 == 1) | (fg
-000034c0: 2e66 6561 7475 7265 3220 3e3d 2032 2929  .feature2 >= 2))
-000034d0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-000034e0: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-000034f0: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00003500: 2020 663a 2046 696c 7465 7220 6f62 6a65    f: Filter obje
-00003510: 6374 2e0a 0a20 2020 2020 2020 2023 2052  ct...        # R
-00003520: 6574 7572 6e73 0a20 2020 2020 2020 2020  eturns.         
-00003530: 2020 2060 5175 6572 7960 2e20 5468 6520     `Query`. The 
-00003540: 7175 6572 7920 6f62 6a65 6374 2077 6974  query object wit
-00003550: 6820 7468 6520 6170 706c 6965 6420 6669  h the applied fi
-00003560: 6c74 6572 2e0a 2020 2020 2020 2020 2222  lter..        ""
-00003570: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00003580: 2073 656c 662e 7365 6c65 6374 5f61 6c6c   self.select_all
-00003590: 2829 2e66 696c 7465 7228 6629 0a0a 2020  ().filter(f)..  
-000035a0: 2020 6465 6620 6164 645f 7461 6728 7365    def add_tag(se
-000035b0: 6c66 2c20 6e61 6d65 3a20 7374 722c 2076  lf, name: str, v
-000035c0: 616c 7565 293a 0a20 2020 2020 2020 2022  alue):.        "
-000035d0: 2222 4174 7461 6368 2061 2074 6167 2074  ""Attach a tag t
-000035e0: 6f20 6120 6665 6174 7572 6520 6772 6f75  o a feature grou
-000035f0: 702e 0a0a 2020 2020 2020 2020 4120 7461  p...        A ta
-00003600: 6720 636f 6e73 6973 7473 206f 6620 6120  g consists of a 
-00003610: 3c6e 616d 652c 7661 6c75 653e 2070 6169  <name,value> pai
-00003620: 722e 2054 6167 206e 616d 6573 2061 7265  r. Tag names are
-00003630: 2075 6e69 7175 6520 6964 656e 7469 6669   unique identifi
-00003640: 6572 7320 6163 726f 7373 2074 6865 2077  ers across the w
-00003650: 686f 6c65 2063 6c75 7374 6572 2e0a 2020  hole cluster..  
-00003660: 2020 2020 2020 5468 6520 7661 6c75 6520        The value 
-00003670: 6f66 2061 2074 6167 2063 616e 2062 6520  of a tag can be 
-00003680: 616e 7920 7661 6c69 6420 6a73 6f6e 202d  any valid json -
-00003690: 2070 7269 6d69 7469 7665 732c 2061 7272   primitives, arr
-000036a0: 6179 7320 6f72 206a 736f 6e20 6f62 6a65  ays or json obje
-000036b0: 6374 732e 0a0a 2020 2020 2020 2020 2121  cts...        !!
-000036c0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-000036d0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-000036e0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-000036f0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
-00003700: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
-00003710: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
-00003720: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
-00003730: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
-00003740: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
-00003750: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
-00003760: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
-00003770: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
-00003780: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
-00003790: 6667 2e61 6464 5f74 6167 286e 616d 653d  fg.add_tag(name=
-000037a0: 2265 7861 6d70 6c65 5f74 6167 222c 2076  "example_tag", v
-000037b0: 616c 7565 3d22 3432 2229 0a20 2020 2020  alue="42").     
-000037c0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-000037d0: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-000037e0: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-000037f0: 3a20 4e61 6d65 206f 6620 7468 6520 7461  : Name of the ta
-00003800: 6720 746f 2062 6520 6164 6465 642e 0a20  g to be added.. 
-00003810: 2020 2020 2020 2020 2020 2076 616c 7565             value
-00003820: 3a20 5661 6c75 6520 6f66 2074 6865 2074  : Value of the t
-00003830: 6167 2074 6f20 6265 2061 6464 6564 2e0a  ag to be added..
-00003840: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
-00003850: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
-00003860: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
-00003870: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
-00003880: 6f72 6020 696e 2063 6173 6520 7468 6520  or` in case the 
-00003890: 6261 636b 656e 6420 6661 696c 7320 746f  backend fails to
-000038a0: 2061 6464 2074 6865 2074 6167 2e0a 2020   add the tag..  
-000038b0: 2020 2020 2020 2222 220a 0a20 2020 2020        """..     
-000038c0: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-000038d0: 5f67 726f 7570 5f65 6e67 696e 652e 6164  _group_engine.ad
-000038e0: 645f 7461 6728 7365 6c66 2c20 6e61 6d65  d_tag(self, name
-000038f0: 2c20 7661 6c75 6529 0a0a 2020 2020 6465  , value)..    de
-00003900: 6620 6465 6c65 7465 5f74 6167 2873 656c  f delete_tag(sel
-00003910: 662c 206e 616d 653a 2073 7472 293a 0a20  f, name: str):. 
-00003920: 2020 2020 2020 2022 2222 4465 6c65 7465         """Delete
-00003930: 2061 2074 6167 2061 7474 6163 6865 6420   a tag attached 
-00003940: 746f 2061 2066 6561 7475 7265 2067 726f  to a feature gro
-00003950: 7570 2e0a 0a20 2020 2020 2020 2021 2121  up...        !!!
-00003960: 2065 7861 6d70 6c65 0a20 2020 2020 2020   example.       
-00003970: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
-00003980: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
-00003990: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
-000039a0: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
-000039b0: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
-000039c0: 2020 2020 2020 2020 2020 2020 2320 6765              # ge
-000039d0: 7420 7468 6520 4665 6174 7572 6520 4772  t the Feature Gr
-000039e0: 6f75 7020 696e 7374 616e 6365 0a20 2020  oup instance.   
-000039f0: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
-00003a00: 2e67 6574 5f6f 725f 6372 6561 7465 5f66  .get_or_create_f
-00003a10: 6561 7475 7265 5f67 726f 7570 282e 2e2e  eature_group(...
-00003a20: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00003a30: 672e 6465 6c65 7465 5f74 6167 2822 6578  g.delete_tag("ex
-00003a40: 616d 706c 655f 7461 6722 290a 2020 2020  ample_tag").    
-00003a50: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
-00003a60: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
-00003a70: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00003a80: 653a 204e 616d 6520 6f66 2074 6865 2074  e: Name of the t
-00003a90: 6167 2074 6f20 6265 2072 656d 6f76 6564  ag to be removed
-00003aa0: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
-00003ab0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
-00003ac0: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
-00003ad0: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
-00003ae0: 7272 6f72 6020 696e 2063 6173 6520 7468  rror` in case th
-00003af0: 6520 6261 636b 656e 6420 6661 696c 7320  e backend fails 
-00003b00: 746f 2064 656c 6574 6520 7468 6520 7461  to delete the ta
-00003b10: 672e 0a20 2020 2020 2020 2022 2222 0a20  g..        """. 
-00003b20: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
-00003b30: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
-00003b40: 652e 6465 6c65 7465 5f74 6167 2873 656c  e.delete_tag(sel
-00003b50: 662c 206e 616d 6529 0a0a 2020 2020 6465  f, name)..    de
-00003b60: 6620 6765 745f 7461 6728 7365 6c66 2c20  f get_tag(self, 
-00003b70: 6e61 6d65 3a20 7374 7229 3a0a 2020 2020  name: str):.    
-00003b80: 2020 2020 2222 2247 6574 2074 6865 2074      """Get the t
-00003b90: 6167 7320 6f66 2061 2066 6561 7475 7265  ags of a feature
-00003ba0: 2067 726f 7570 2e0a 0a20 2020 2020 2020   group...       
-00003bb0: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-00003bc0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00003bd0: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-00003be0: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-00003bf0: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-00003c00: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-00003c10: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-00003c20: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-00003c30: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-00003c40: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
-00003c50: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
-00003c60: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
-00003c70: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
-00003c80: 2020 2066 675f 7461 675f 7661 6c75 6520     fg_tag_value 
-00003c90: 3d20 6667 2e67 6574 5f74 6167 2822 6578  = fg.get_tag("ex
-00003ca0: 616d 706c 655f 7461 6722 290a 2020 2020  ample_tag").    
-00003cb0: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
-00003cc0: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
-00003cd0: 0a20 2020 2020 2020 2020 2020 206e 616d  .            nam
-00003ce0: 653a 204e 616d 6520 6f66 2074 6865 2074  e: Name of the t
-00003cf0: 6167 2074 6f20 6765 742e 0a0a 2020 2020  ag to get...    
-00003d00: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-00003d10: 2020 2020 2020 2020 2020 7461 6720 7661            tag va
-00003d20: 6c75 650a 0a20 2020 2020 2020 2023 2052  lue..        # R
-00003d30: 6169 7365 730a 2020 2020 2020 2020 2020  aises.          
-00003d40: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
-00003d50: 7863 6570 7469 6f6e 732e 5265 7374 4150  xceptions.RestAP
-00003d60: 4945 7272 6f72 6020 696e 2063 6173 6520  IError` in case 
-00003d70: 7468 6520 6261 636b 656e 6420 6661 696c  the backend fail
-00003d80: 7320 746f 2072 6574 7269 6576 6520 7468  s to retrieve th
-00003d90: 6520 7461 672e 0a20 2020 2020 2020 2022  e tag..        "
-00003da0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00003db0: 6e20 7365 6c66 2e5f 6665 6174 7572 655f  n self._feature_
-00003dc0: 6772 6f75 705f 656e 6769 6e65 2e67 6574  group_engine.get
-00003dd0: 5f74 6167 2873 656c 662c 206e 616d 6529  _tag(self, name)
-00003de0: 0a0a 2020 2020 6465 6620 6765 745f 7461  ..    def get_ta
-00003df0: 6773 2873 656c 6629 3a0a 2020 2020 2020  gs(self):.      
-00003e00: 2020 2222 2252 6574 7269 6576 6573 2061    """Retrieves a
-00003e10: 6c6c 2074 6167 7320 6174 7461 6368 6564  ll tags attached
-00003e20: 2074 6f20 6120 6665 6174 7572 6520 6772   to a feature gr
-00003e30: 6f75 702e 0a0a 2020 2020 2020 2020 2320  oup...        # 
-00003e40: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00003e50: 2020 2020 6044 6963 745b 7374 722c 206f      `Dict[str, o
-00003e60: 626a 5d60 206f 6620 7461 6773 2e0a 0a20  bj]` of tags... 
-00003e70: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
-00003e80: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-00003e90: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-00003ea0: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
-00003eb0: 6020 696e 2063 6173 6520 7468 6520 6261  ` in case the ba
-00003ec0: 636b 656e 6420 6661 696c 7320 746f 2072  ckend fails to r
-00003ed0: 6574 7269 6576 6520 7468 6520 7461 6773  etrieve the tags
-00003ee0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00003ef0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00003f00: 662e 5f66 6561 7475 7265 5f67 726f 7570  f._feature_group
-00003f10: 5f65 6e67 696e 652e 6765 745f 7461 6773  _engine.get_tags
-00003f20: 2873 656c 6629 0a0a 2020 2020 6465 6620  (self)..    def 
-00003f30: 6765 745f 7061 7265 6e74 5f66 6561 7475  get_parent_featu
-00003f40: 7265 5f67 726f 7570 7328 7365 6c66 293a  re_groups(self):
-00003f50: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
-00003f60: 7468 6520 7061 7265 6e74 7320 6f66 2074  the parents of t
-00003f70: 6869 7320 6665 6174 7572 6520 6772 6f75  his feature grou
-00003f80: 702c 2062 6173 6564 206f 6e20 6578 706c  p, based on expl
-00003f90: 6963 6974 2070 726f 7665 6e61 6e63 652e  icit provenance.
-00003fa0: 0a20 2020 2020 2020 2050 6172 656e 7473  .        Parents
-00003fb0: 2061 7265 2066 6561 7475 7265 2067 726f   are feature gro
-00003fc0: 7570 7320 6f72 2065 7874 6572 6e61 6c20  ups or external 
-00003fd0: 6665 6174 7572 6520 6772 6f75 7073 2e20  feature groups. 
-00003fe0: 5468 6573 6520 6665 6174 7572 650a 2020  These feature.  
-00003ff0: 2020 2020 2020 6772 6f75 7073 2063 616e        groups can
-00004000: 2062 6520 6163 6365 7373 6962 6c65 2c20   be accessible, 
-00004010: 6465 6c65 7465 6420 6f72 2069 6e61 6363  deleted or inacc
-00004020: 6573 7369 626c 652e 0a20 2020 2020 2020  essible..       
-00004030: 2046 6f72 2064 656c 6574 6564 2061 6e64   For deleted and
-00004040: 2069 6e61 6363 6573 7369 626c 6520 6665   inaccessible fe
-00004050: 6174 7572 6520 6772 6f75 7073 2c20 6f6e  ature groups, on
-00004060: 6c79 2061 206d 696e 696d 616c 2069 6e66  ly a minimal inf
-00004070: 6f72 6d61 7469 6f6e 2069 730a 2020 2020  ormation is.    
-00004080: 2020 2020 7265 7475 726e 6564 2e0a 0a20      returned... 
-00004090: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
-000040a0: 0a20 2020 2020 2020 2020 2020 2060 5072  .            `Pr
-000040b0: 6f76 656e 616e 6365 4c69 6e6b 7360 3a20  ovenanceLinks`: 
-000040c0: 4f62 6a65 6374 2063 6f6e 7461 696e 696e  Object containin
-000040d0: 6720 7468 6520 7365 6374 696f 6e20 6f66  g the section of
-000040e0: 2070 726f 7665 6e61 6e63 6520 6772 6170   provenance grap
-000040f0: 6820 7265 7175 6573 7465 642e 0a0a 2020  h requested...  
-00004100: 2020 2020 2020 2320 5261 6973 6573 0a20        # Raises. 
-00004110: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
-00004120: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-00004130: 6e73 2e52 6573 7441 5049 4572 726f 7260  ns.RestAPIError`
-00004140: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00004150: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00004160: 662e 5f66 6561 7475 7265 5f67 726f 7570  f._feature_group
-00004170: 5f65 6e67 696e 652e 6765 745f 7061 7265  _engine.get_pare
-00004180: 6e74 5f66 6561 7475 7265 5f67 726f 7570  nt_feature_group
-00004190: 7328 7365 6c66 290a 0a20 2020 2064 6566  s(self)..    def
-000041a0: 2067 6574 5f67 656e 6572 6174 6564 5f66   get_generated_f
-000041b0: 6561 7475 7265 5f76 6965 7773 2873 656c  eature_views(sel
-000041c0: 6629 3a0a 2020 2020 2020 2020 2222 2247  f):.        """G
-000041d0: 6574 2074 6865 2067 656e 6572 6174 6564  et the generated
-000041e0: 2066 6561 7475 7265 2076 6965 7720 7573   feature view us
-000041f0: 696e 6720 7468 6973 2066 6561 7475 7265  ing this feature
-00004200: 2067 726f 7570 2c20 6261 7365 6420 6f6e   group, based on
-00004210: 2065 7870 6c69 6369 740a 2020 2020 2020   explicit.      
-00004220: 2020 7072 6f76 656e 616e 6365 2e20 5468    provenance. Th
-00004230: 6573 6520 6665 6174 7572 6520 7669 6577  ese feature view
-00004240: 7320 6361 6e20 6265 2061 6363 6573 7369  s can be accessi
-00004250: 626c 6520 6f72 2069 6e61 6363 6573 7369  ble or inaccessi
-00004260: 626c 652e 2045 7870 6c69 6369 740a 2020  ble. Explicit.  
-00004270: 2020 2020 2020 7072 6f76 656e 616e 6365        provenance
-00004280: 2064 6f65 7320 6e6f 7420 7472 6163 6b20   does not track 
-00004290: 6465 6c65 7465 6420 6765 6e65 7261 7465  deleted generate
-000042a0: 6420 6665 6174 7572 6520 7669 6577 206c  d feature view l
-000042b0: 696e 6b73 2c20 736f 2064 656c 6574 6564  inks, so deleted
-000042c0: 0a20 2020 2020 2020 2077 696c 6c20 616c  .        will al
-000042d0: 7761 7973 2062 6520 656d 7074 792e 0a20  ways be empty.. 
-000042e0: 2020 2020 2020 2046 6f72 2069 6e61 6363         For inacc
-000042f0: 6573 7369 626c 6520 6665 6174 7572 6520  essible feature 
-00004300: 7669 6577 732c 206f 6e6c 7920 6120 6d69  views, only a mi
-00004310: 6e69 6d61 6c20 696e 666f 726d 6174 696f  nimal informatio
-00004320: 6e20 6973 2072 6574 7572 6e65 642e 0a0a  n is returned...
-00004330: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-00004340: 730a 2020 2020 2020 2020 2020 2020 6050  s.            `P
-00004350: 726f 7665 6e61 6e63 654c 696e 6b73 603a  rovenanceLinks`:
-00004360: 204f 626a 6563 7420 636f 6e74 6169 6e69   Object containi
-00004370: 6e67 2074 6865 2073 6563 7469 6f6e 206f  ng the section o
-00004380: 6620 7072 6f76 656e 616e 6365 2067 7261  f provenance gra
-00004390: 7068 2072 6571 7565 7374 6564 2e0a 0a20  ph requested... 
-000043a0: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
-000043b0: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-000043c0: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-000043d0: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
-000043e0: 602e 0a20 2020 2020 2020 2022 2222 0a20  `..        """. 
-000043f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00004400: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
-00004410: 705f 656e 6769 6e65 2e67 6574 5f67 656e  p_engine.get_gen
-00004420: 6572 6174 6564 5f66 6561 7475 7265 5f76  erated_feature_v
-00004430: 6965 7773 2873 656c 6629 0a0a 2020 2020  iews(self)..    
-00004440: 6465 6620 6765 745f 6765 6e65 7261 7465  def get_generate
-00004450: 645f 6665 6174 7572 655f 6772 6f75 7073  d_feature_groups
-00004460: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00004470: 2222 2247 6574 2074 6865 2067 656e 6572  """Get the gener
-00004480: 6174 6564 2066 6561 7475 7265 2067 726f  ated feature gro
-00004490: 7570 7320 7573 696e 6720 7468 6973 2066  ups using this f
-000044a0: 6561 7475 7265 2067 726f 7570 2c20 6261  eature group, ba
-000044b0: 7365 6420 6f6e 2065 7870 6c69 6369 740a  sed on explicit.
-000044c0: 2020 2020 2020 2020 7072 6f76 656e 616e          provenan
-000044d0: 6365 2e20 5468 6573 6520 6665 6174 7572  ce. These featur
-000044e0: 6520 6772 6f75 7073 2063 616e 2062 6520  e groups can be 
-000044f0: 6163 6365 7373 6962 6c65 206f 7220 696e  accessible or in
-00004500: 6163 6365 7373 6962 6c65 2e20 4578 706c  accessible. Expl
-00004510: 6963 6974 0a20 2020 2020 2020 2070 726f  icit.        pro
-00004520: 7665 6e61 6e63 6520 646f 6573 206e 6f74  venance does not
-00004530: 2074 7261 636b 2064 656c 6574 6564 2067   track deleted g
-00004540: 656e 6572 6174 6564 2066 6561 7475 7265  enerated feature
-00004550: 2067 726f 7570 206c 696e 6b73 2c20 736f   group links, so
-00004560: 2064 656c 6574 6564 0a20 2020 2020 2020   deleted.       
-00004570: 2077 696c 6c20 616c 7761 7973 2062 6520   will always be 
-00004580: 656d 7074 792e 0a20 2020 2020 2020 2046  empty..        F
-00004590: 6f72 2069 6e61 6363 6573 7369 626c 6520  or inaccessible 
-000045a0: 6665 6174 7572 6520 6772 6f75 7073 2c20  feature groups, 
-000045b0: 6f6e 6c79 2061 206d 696e 696d 616c 2069  only a minimal i
-000045c0: 6e66 6f72 6d61 7469 6f6e 2069 7320 7265  nformation is re
-000045d0: 7475 726e 6564 2e0a 0a20 2020 2020 2020  turned...       
-000045e0: 2023 2052 6574 7572 6e73 0a20 2020 2020   # Returns.     
-000045f0: 2020 2020 2020 2060 5072 6f76 656e 616e         `Provenan
-00004600: 6365 4c69 6e6b 7360 3a20 4f62 6a65 6374  ceLinks`: Object
-00004610: 2063 6f6e 7461 696e 696e 6720 7468 6520   containing the 
-00004620: 7365 6374 696f 6e20 6f66 2070 726f 7665  section of prove
-00004630: 6e61 6e63 6520 6772 6170 6820 7265 7175  nance graph requ
-00004640: 6573 7465 642e 0a0a 2020 2020 2020 2020  ested...        
-00004650: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
-00004660: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
-00004670: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
-00004680: 7441 5049 4572 726f 7260 2e0a 2020 2020  tAPIError`..    
-00004690: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-000046a0: 7265 7475 726e 2073 656c 662e 5f66 6561  return self._fea
-000046b0: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
-000046c0: 652e 6765 745f 6765 6e65 7261 7465 645f  e.get_generated_
-000046d0: 6665 6174 7572 655f 6772 6f75 7073 2873  feature_groups(s
-000046e0: 656c 6629 0a0a 2020 2020 6465 6620 6765  elf)..    def ge
-000046f0: 745f 6665 6174 7572 6528 7365 6c66 2c20  t_feature(self, 
-00004700: 6e61 6d65 3a20 7374 7229 3a0a 2020 2020  name: str):.    
-00004710: 2020 2020 2222 2252 6574 7269 6576 6520      """Retrieve 
-00004720: 6120 6046 6561 7475 7265 6020 6f62 6a65  a `Feature` obje
-00004730: 6374 2066 726f 6d20 7468 6520 7363 6865  ct from the sche
-00004740: 6d61 206f 6620 7468 6520 6665 6174 7572  ma of the featur
-00004750: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
-00004760: 2020 5468 6572 6520 6172 6520 7365 7665    There are seve
-00004770: 7261 6c20 7761 7973 2074 6f20 6163 6365  ral ways to acce
-00004780: 7373 2066 6561 7475 7265 7320 6f66 2061  ss features of a
-00004790: 2066 6561 7475 7265 2067 726f 7570 3a0a   feature group:.
-000047a0: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
-000047b0: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
-000047c0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-000047d0: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
-000047e0: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
-000047f0: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
-00004800: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
-00004810: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-00004820: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
-00004830: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
-00004840: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
-00004850: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
-00004860: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
-00004870: 2020 2020 2020 2020 2020 2023 2067 6574             # get
-00004880: 2046 6561 7475 7265 2069 6e73 7461 6e73   Feature instans
-00004890: 650a 2020 2020 2020 2020 2020 2020 6667  e.            fg
-000048a0: 2e66 6561 7475 7265 310a 2020 2020 2020  .feature1.      
-000048b0: 2020 2020 2020 6667 5b22 6665 6174 7572        fg["featur
-000048c0: 6531 225d 0a20 2020 2020 2020 2020 2020  e1"].           
-000048d0: 2066 672e 6765 745f 6665 6174 7572 6528   fg.get_feature(
-000048e0: 2266 6561 7475 7265 3122 290a 2020 2020  "feature1").    
-000048f0: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
-00004900: 2020 2020 2021 2121 206e 6f74 650a 2020       !!! note.  
-00004910: 2020 2020 2020 2020 2020 4174 7472 6962            Attrib
-00004920: 7574 6520 6163 6365 7373 2074 6f20 6665  ute access to fe
-00004930: 6174 7572 6573 2077 6f72 6b73 206f 6e6c  atures works onl
-00004940: 7920 666f 7220 6e6f 6e2d 7265 7365 7276  y for non-reserv
-00004950: 6564 206e 616d 6573 2e20 466f 7220 6578  ed names. For ex
-00004960: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-00004970: 2020 6665 6174 7572 6573 206e 616d 6564    features named
-00004980: 2060 6964 6020 6f72 2060 6e61 6d65 6020   `id` or `name` 
-00004990: 7769 6c6c 206e 6f74 2062 6520 6163 6365  will not be acce
-000049a0: 7373 6962 6c65 2076 6961 2060 6667 2e6e  ssible via `fg.n
-000049b0: 616d 6560 2c20 696e 7374 6561 640a 2020  ame`, instead.  
-000049c0: 2020 2020 2020 2020 2020 7468 6973 2077            this w
-000049d0: 696c 6c20 7265 7475 726e 2074 6865 206e  ill return the n
-000049e0: 616d 6520 6f66 2074 6865 2066 6561 7475  ame of the featu
-000049f0: 7265 2067 726f 7570 2069 7473 656c 662e  re group itself.
-00004a00: 2046 616c 6c20 6261 636b 206f 6e20 7573   Fall back on us
-00004a10: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00004a20: 7468 6520 6067 6574 5f66 6561 7475 7265  the `get_feature
-00004a30: 6020 6d65 7468 6f64 2e0a 0a20 2020 2020  ` method...     
-00004a40: 2020 2023 2041 7267 756d 656e 7473 3a0a     # Arguments:.
-00004a50: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-00004a60: 3a20 5468 6520 6e61 6d65 206f 6620 7468  : The name of th
-00004a70: 6520 6665 6174 7572 6520 746f 2072 6574  e feature to ret
-00004a80: 7269 6576 650a 0a20 2020 2020 2020 2023  rieve..        #
-00004a90: 2052 6574 7572 6e73 3a0a 2020 2020 2020   Returns:.      
-00004aa0: 2020 2020 2020 4665 6174 7572 653a 2054        Feature: T
-00004ab0: 6865 2066 6561 7475 7265 206f 626a 6563  he feature objec
-00004ac0: 740a 0a20 2020 2020 2020 2023 2052 6169  t..        # Rai
-00004ad0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
-00004ae0: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
-00004af0: 6570 7469 6f6e 732e 4665 6174 7572 6553  eptions.FeatureS
-00004b00: 746f 7265 4578 6365 7074 696f 6e60 2e0a  toreException`..
-00004b10: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00004b20: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
-00004b30: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00004b40: 2e5f 5f67 6574 6974 656d 5f5f 286e 616d  .__getitem__(nam
-00004b50: 6529 0a20 2020 2020 2020 2065 7863 6570  e).        excep
-00004b60: 7420 4b65 7945 7272 6f72 3a0a 2020 2020  t KeyError:.    
-00004b70: 2020 2020 2020 2020 7261 6973 6520 4665          raise Fe
-00004b80: 6174 7572 6553 746f 7265 4578 6365 7074  atureStoreExcept
-00004b90: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
-00004ba0: 2020 2020 2066 2227 4665 6174 7572 6547       f"'FeatureG
-00004bb0: 726f 7570 2720 6f62 6a65 6374 2068 6173  roup' object has
-00004bc0: 206e 6f20 6665 6174 7572 6520 6361 6c6c   no feature call
-00004bd0: 6564 2027 7b6e 616d 657d 272e 220a 2020  ed '{name}'.".  
-00004be0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-00004bf0: 2064 6566 2075 7064 6174 655f 7374 6174   def update_stat
-00004c00: 6973 7469 6373 5f63 6f6e 6669 6728 7365  istics_config(se
-00004c10: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00004c20: 5570 6461 7465 2074 6865 2073 7461 7469  Update the stati
-00004c30: 7374 6963 7320 636f 6e66 6967 7572 6174  stics configurat
-00004c40: 696f 6e20 6f66 2074 6865 2066 6561 7475  ion of the featu
-00004c50: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
-00004c60: 2020 2043 6861 6e67 6520 7468 6520 6073     Change the `s
-00004c70: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
-00004c80: 6020 6f62 6a65 6374 2061 6e64 2070 6572  ` object and per
-00004c90: 7369 7374 2074 6865 2063 6861 6e67 6573  sist the changes
-00004ca0: 2062 7920 6361 6c6c 696e 670a 2020 2020   by calling.    
-00004cb0: 2020 2020 7468 6973 206d 6574 686f 642e      this method.
-00004cc0: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
-00004cd0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-00004ce0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-00004cf0: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-00004d00: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-00004d10: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-00004d20: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-00004d30: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-00004d40: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-00004d50: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-00004d60: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
-00004d70: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
-00004d80: 7572 655f 6772 6f75 7028 2e2e 2e29 0a0a  ure_group(...)..
-00004d90: 2020 2020 2020 2020 2020 2020 6667 2e75              fg.u
-00004da0: 7064 6174 655f 7374 6174 6973 7469 6373  pdate_statistics
-00004db0: 5f63 6f6e 6669 6728 290a 2020 2020 2020  _config().      
-00004dc0: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
-00004dd0: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
-00004de0: 2020 2020 2020 2020 2060 4665 6174 7572           `Featur
-00004df0: 6547 726f 7570 602e 2054 6865 2075 7064  eGroup`. The upd
-00004e00: 6174 6564 206d 6574 6164 6174 6120 6f62  ated metadata ob
-00004e10: 6a65 6374 206f 6620 7468 6520 6665 6174  ject of the feat
-00004e20: 7572 6520 6772 6f75 702e 0a0a 2020 2020  ure group...    
-00004e30: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
-00004e40: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
-00004e50: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-00004e60: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
-00004e70: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-00004e80: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-00004e90: 6f6e 732e 4665 6174 7572 6553 746f 7265  ons.FeatureStore
-00004ea0: 4578 6365 7074 696f 6e60 2e0a 2020 2020  Exception`..    
-00004eb0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00004ec0: 7365 6c66 2e5f 6368 6563 6b5f 7374 6174  self._check_stat
-00004ed0: 6973 7469 6373 5f73 7570 706f 7274 2829  istics_support()
-00004ee0: 2020 2320 7261 6973 6573 2061 6e20 6572    # raises an er
-00004ef0: 726f 7220 6966 2073 7461 7473 206e 6f74  ror if stats not
-00004f00: 2073 7570 706f 7274 6564 0a20 2020 2020   supported.     
-00004f10: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-00004f20: 5f67 726f 7570 5f65 6e67 696e 652e 7570  _group_engine.up
-00004f30: 6461 7465 5f73 7461 7469 7374 6963 735f  date_statistics_
-00004f40: 636f 6e66 6967 2873 656c 6629 0a20 2020  config(self).   
-00004f50: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00004f60: 0a0a 2020 2020 6465 6620 7570 6461 7465  ..    def update
-00004f70: 5f64 6573 6372 6970 7469 6f6e 2873 656c  _description(sel
-00004f80: 662c 2064 6573 6372 6970 7469 6f6e 3a20  f, description: 
-00004f90: 7374 7229 3a0a 2020 2020 2020 2020 2222  str):.        ""
-00004fa0: 2255 7064 6174 6520 7468 6520 6465 7363  "Update the desc
-00004fb0: 7269 7074 696f 6e20 6f66 2074 6865 2066  ription of the f
-00004fc0: 6561 7475 7265 2067 726f 7570 2e0a 0a20  eature group... 
-00004fd0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
-00004fe0: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
-00004ff0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00005000: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
-00005010: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
-00005020: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
-00005030: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
-00005040: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
-00005050: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
-00005060: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
-00005070: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
-00005080: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
-00005090: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
-000050a0: 2020 2020 2020 2020 2066 672e 7570 6461           fg.upda
-000050b0: 7465 5f64 6573 6372 6970 7469 6f6e 2864  te_description(d
-000050c0: 6573 6372 6970 7469 6f6e 3d22 4d75 6368  escription="Much
-000050d0: 2062 6574 7465 7220 6465 7363 7269 7074   better descript
-000050e0: 696f 6e2e 2229 0a20 2020 2020 2020 2020  ion.").         
-000050f0: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-00005100: 2121 2120 696e 666f 2022 5361 6665 2075  !!! info "Safe u
-00005110: 7064 6174 6522 0a20 2020 2020 2020 2020  pdate".         
-00005120: 2020 2054 6869 7320 6d65 7468 6f64 2075     This method u
-00005130: 7064 6174 6573 2074 6865 2066 6561 7475  pdates the featu
-00005140: 7265 2067 726f 7570 2064 6573 6372 6970  re group descrip
-00005150: 7469 6f6e 2073 6166 656c 792e 2049 6e20  tion safely. In 
-00005160: 6361 7365 206f 6620 6661 696c 7572 650a  case of failure.
-00005170: 2020 2020 2020 2020 2020 2020 796f 7572              your
-00005180: 206c 6f63 616c 206d 6574 6164 6174 6120   local metadata 
-00005190: 6f62 6a65 6374 2077 696c 6c20 6b65 6570  object will keep
-000051a0: 2074 6865 206f 6c64 2064 6573 6372 6970   the old descrip
-000051b0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2023  tion...        #
-000051c0: 2041 7267 756d 656e 7473 0a20 2020 2020   Arguments.     
-000051d0: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
-000051e0: 6f6e 3a20 4e65 7720 6465 7363 7269 7074  on: New descript
-000051f0: 696f 6e20 7374 7269 6e67 2e0a 0a20 2020  ion string...   
-00005200: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
-00005210: 2020 2020 2020 2020 2020 2060 4665 6174             `Feat
-00005220: 7572 6547 726f 7570 602e 2054 6865 2075  ureGroup`. The u
-00005230: 7064 6174 6564 2066 6561 7475 7265 2067  pdated feature g
-00005240: 726f 7570 206f 626a 6563 742e 0a20 2020  roup object..   
-00005250: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00005260: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
-00005270: 726f 7570 5f65 6e67 696e 652e 7570 6461  roup_engine.upda
-00005280: 7465 5f64 6573 6372 6970 7469 6f6e 2873  te_description(s
-00005290: 656c 662c 2064 6573 6372 6970 7469 6f6e  elf, description
-000052a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000052b0: 2073 656c 660a 0a20 2020 2064 6566 2075   self..    def u
-000052c0: 7064 6174 655f 6e6f 7469 6669 6361 7469  pdate_notificati
-000052d0: 6f6e 5f74 6f70 6963 5f6e 616d 6528 7365  on_topic_name(se
-000052e0: 6c66 2c20 6e6f 7469 6669 6361 7469 6f6e  lf, notification
-000052f0: 5f74 6f70 6963 5f6e 616d 653a 2073 7472  _topic_name: str
-00005300: 293a 0a20 2020 2020 2020 2022 2222 5570  ):.        """Up
-00005310: 6461 7465 2074 6865 206e 6f74 6966 6963  date the notific
-00005320: 6174 696f 6e20 746f 7069 6320 6e61 6d65  ation topic name
-00005330: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-00005340: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
-00005350: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
-00005360: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-00005370: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
-00005380: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
-00005390: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
-000053a0: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
-000053b0: 2e0a 0a20 2020 2020 2020 2020 2020 2023  ...            #
-000053c0: 2067 6574 2074 6865 2046 6561 7475 7265   get the Feature
-000053d0: 2047 726f 7570 2069 6e73 7461 6e63 650a   Group instance.
-000053e0: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
-000053f0: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
-00005400: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
-00005410: 2e2e 2e29 0a0a 2020 2020 2020 2020 2020  ...)..          
-00005420: 2020 6667 2e75 7064 6174 655f 6e6f 7469    fg.update_noti
-00005430: 6669 6361 7469 6f6e 5f74 6f70 6963 5f6e  fication_topic_n
-00005440: 616d 6528 6e6f 7469 6669 6361 7469 6f6e  ame(notification
-00005450: 5f74 6f70 6963 5f6e 616d 653d 226e 6f74  _topic_name="not
-00005460: 6966 6963 6174 696f 6e5f 746f 7069 635f  ification_topic_
-00005470: 6e61 6d65 2229 0a20 2020 2020 2020 2020  name").         
-00005480: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-00005490: 2121 2120 696e 666f 2022 5361 6665 2075  !!! info "Safe u
-000054a0: 7064 6174 6522 0a20 2020 2020 2020 2020  pdate".         
-000054b0: 2020 2054 6869 7320 6d65 7468 6f64 2075     This method u
-000054c0: 7064 6174 6573 2074 6865 2066 6561 7475  pdates the featu
-000054d0: 7265 2067 726f 7570 206e 6f74 6966 6963  re group notific
-000054e0: 6174 696f 6e20 746f 7069 6320 6e61 6d65  ation topic name
-000054f0: 2073 6166 656c 792e 2049 6e20 6361 7365   safely. In case
-00005500: 206f 6620 6661 696c 7572 650a 2020 2020   of failure.    
-00005510: 2020 2020 2020 2020 796f 7572 206c 6f63          your loc
-00005520: 616c 206d 6574 6164 6174 6120 6f62 6a65  al metadata obje
-00005530: 6374 2077 696c 6c20 6b65 6570 2074 6865  ct will keep the
-00005540: 206f 6c64 206e 6f74 6966 6963 6174 696f   old notificatio
-00005550: 6e20 746f 7069 6320 6e61 6d65 2e0a 0a20  n topic name... 
-00005560: 2020 2020 2020 2023 2041 7267 756d 656e         # Argumen
-00005570: 7473 0a20 2020 2020 2020 2020 2020 206e  ts.            n
-00005580: 6f74 6966 6963 6174 696f 6e5f 746f 7069  otification_topi
-00005590: 635f 6e61 6d65 3a20 4e61 6d65 206f 6620  c_name: Name of 
-000055a0: 7468 6520 746f 7069 6320 7573 6564 2066  the topic used f
-000055b0: 6f72 2073 656e 6469 6e67 206e 6f74 6966  or sending notif
-000055c0: 6963 6174 696f 6e73 2077 6865 6e20 656e  ications when en
-000055d0: 7472 6965 730a 2020 2020 2020 2020 2020  tries.          
-000055e0: 2020 2020 2020 6172 6520 696e 7365 7274        are insert
-000055f0: 6564 206f 7220 7570 6461 7465 6420 6f6e  ed or updated on
-00005600: 2074 6865 206f 6e6c 696e 6520 6665 6174   the online feat
-00005610: 7572 6520 7374 6f72 652e 2049 6620 7365  ure store. If se
-00005620: 7420 746f 204e 6f6e 6520 6e6f 206e 6f74  t to None no not
-00005630: 6966 6963 6174 696f 6e73 2061 7265 2073  ifications are s
-00005640: 656e 742e 0a0a 2020 2020 2020 2020 2320  ent...        # 
-00005650: 5265 7475 726e 730a 2020 2020 2020 2020  Returns.        
-00005660: 2020 2020 6046 6561 7475 7265 4772 6f75      `FeatureGrou
-00005670: 7060 2e20 5468 6520 7570 6461 7465 6420  p`. The updated 
-00005680: 6665 6174 7572 6520 6772 6f75 7020 6f62  feature group ob
-00005690: 6a65 6374 2e0a 2020 2020 2020 2020 2222  ject..        ""
-000056a0: 220a 2020 2020 2020 2020 7365 6c66 2e5f  ".        self._
-000056b0: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
-000056c0: 6769 6e65 2e75 7064 6174 655f 6e6f 7469  gine.update_noti
-000056d0: 6669 6361 7469 6f6e 5f74 6f70 6963 5f6e  fication_topic_n
-000056e0: 616d 6528 0a20 2020 2020 2020 2020 2020  ame(.           
-000056f0: 2073 656c 662c 206e 6f74 6966 6963 6174   self, notificat
-00005700: 696f 6e5f 746f 7069 635f 6e61 6d65 0a20  ion_topic_name. 
-00005710: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005720: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00005730: 2020 6465 6620 7570 6461 7465 5f64 6570    def update_dep
-00005740: 7265 6361 7465 6428 7365 6c66 2c20 6465  recated(self, de
-00005750: 7072 6563 6174 653a 2062 6f6f 6c20 3d20  precate: bool = 
-00005760: 5472 7565 293a 0a20 2020 2020 2020 2022  True):.        "
-00005770: 2222 4465 7072 6563 6174 6520 7468 6520  ""Deprecate the 
-00005780: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
-00005790: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
-000057a0: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
-000057b0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
-000057c0: 2020 2020 2020 2320 636f 6e6e 6563 7420        # connect 
-000057d0: 746f 2074 6865 2046 6561 7475 7265 2053  to the Feature S
-000057e0: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
-000057f0: 2066 7320 3d20 2e2e 2e0a 0a20 2020 2020   fs = .....     
-00005800: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
-00005810: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
-00005820: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
-00005830: 2020 2020 6667 203d 2066 732e 6765 745f      fg = fs.get_
-00005840: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
-00005850: 655f 6772 6f75 7028 2e2e 2e29 0a0a 2020  e_group(...)..  
-00005860: 2020 2020 2020 2020 2020 6667 2e75 7064            fg.upd
-00005870: 6174 655f 6465 7072 6563 6174 6564 2864  ate_deprecated(d
-00005880: 6570 7265 6361 7465 3d54 7275 6529 0a20  eprecate=True). 
-00005890: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
-000058a0: 2020 2020 2020 2020 2121 2120 696e 666f          !!! info
-000058b0: 2022 5361 6665 2075 7064 6174 6522 0a20   "Safe update". 
-000058c0: 2020 2020 2020 2020 2020 2054 6869 7320             This 
-000058d0: 6d65 7468 6f64 2075 7064 6174 6573 2074  method updates t
-000058e0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-000058f0: 2073 6166 656c 792e 2049 6e20 6361 7365   safely. In case
-00005900: 206f 6620 6661 696c 7572 650a 2020 2020   of failure.    
-00005910: 2020 2020 2020 2020 796f 7572 206c 6f63          your loc
-00005920: 616c 206d 6574 6164 6174 6120 6f62 6a65  al metadata obje
-00005930: 6374 2077 696c 6c20 6265 206b 6570 7420  ct will be kept 
-00005940: 756e 6368 616e 6765 642e 0a0a 2020 2020  unchanged...    
-00005950: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-00005960: 2020 2020 2020 2020 2020 2020 6465 7072              depr
-00005970: 6563 6174 653a 2042 6f6f 6c65 616e 2076  ecate: Boolean v
-00005980: 616c 7565 2069 6465 6e74 6966 7969 6e67  alue identifying
-00005990: 2069 6620 7468 6520 6665 6174 7572 6520   if the feature 
-000059a0: 6772 6f75 7020 7368 6f75 6c64 2062 6520  group should be 
-000059b0: 6465 7072 6563 6174 6564 2e20 4465 6661  deprecated. Defa
-000059c0: 756c 7473 2074 6f20 5472 7565 2e0a 0a20  ults to True... 
-000059d0: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
-000059e0: 0a20 2020 2020 2020 2020 2020 2060 4665  .            `Fe
-000059f0: 6174 7572 6547 726f 7570 602e 2054 6865  atureGroup`. The
-00005a00: 2075 7064 6174 6564 2066 6561 7475 7265   updated feature
-00005a10: 2067 726f 7570 206f 626a 6563 742e 0a20   group object.. 
-00005a20: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-00005a30: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-00005a40: 5f67 726f 7570 5f65 6e67 696e 652e 7570  _group_engine.up
-00005a50: 6461 7465 5f64 6570 7265 6361 7465 6428  date_deprecated(
-00005a60: 7365 6c66 2c20 6465 7072 6563 6174 6529  self, deprecate)
-00005a70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00005a80: 7365 6c66 0a0a 2020 2020 6465 6620 7570  self..    def up
-00005a90: 6461 7465 5f66 6561 7475 7265 7328 7365  date_features(se
-00005aa0: 6c66 2c20 6665 6174 7572 6573 3a20 556e  lf, features: Un
-00005ab0: 696f 6e5b 6665 6174 7572 652e 4665 6174  ion[feature.Feat
-00005ac0: 7572 652c 204c 6973 745b 6665 6174 7572  ure, List[featur
-00005ad0: 652e 4665 6174 7572 655d 5d29 3a0a 2020  e.Feature]]):.  
-00005ae0: 2020 2020 2020 2222 2255 7064 6174 6520        """Update 
-00005af0: 6d65 7461 6461 7461 206f 6620 6665 6174  metadata of feat
-00005b00: 7572 6573 2069 6e20 7468 6973 2066 6561  ures in this fea
-00005b10: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
-00005b20: 2020 2020 2043 7572 7265 6e74 6c79 2069       Currently i
-00005b30: 7427 7320 6f6e 6c79 2073 7570 706f 7274  t's only support
-00005b40: 6564 2074 6f20 7570 6461 7465 2074 6865  ed to update the
-00005b50: 2064 6573 6372 6970 7469 6f6e 206f 6620   description of 
-00005b60: 6120 6665 6174 7572 652e 0a0a 2020 2020  a feature...    
-00005b70: 2020 2020 2121 2120 6461 6e67 6572 2022      !!! danger "
-00005b80: 556e 7361 6665 2075 7064 6174 6522 0a20  Unsafe update". 
-00005b90: 2020 2020 2020 2020 2020 204e 6f74 6520             Note 
-00005ba0: 7468 6174 2069 6620 796f 7520 7573 6520  that if you use 
-00005bb0: 616e 2065 7869 7374 696e 6720 6046 6561  an existing `Fea
-00005bc0: 7475 7265 6020 6f62 6a65 6374 206f 6620  ture` object of 
-00005bd0: 7468 6520 7363 6865 6d61 2069 6e20 7468  the schema in th
-00005be0: 650a 2020 2020 2020 2020 2020 2020 6665  e.            fe
-00005bf0: 6174 7572 6520 6772 6f75 7020 6d65 7461  ature group meta
-00005c00: 6461 7461 206f 626a 6563 742c 2074 6869  data object, thi
-00005c10: 7320 6d69 6768 7420 6c65 6176 6520 796f  s might leave yo
-00005c20: 7572 206d 6574 6164 6174 6120 6f62 6a65  ur metadata obje
-00005c30: 6374 2069 6e20 610a 2020 2020 2020 2020  ct in a.        
-00005c40: 2020 2020 636f 7272 7570 7465 6420 7374      corrupted st
-00005c50: 6174 6520 6966 2074 6865 2075 7064 6174  ate if the updat
-00005c60: 6520 6661 696c 732e 0a0a 2020 2020 2020  e fails...      
-00005c70: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-00005c80: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00005c90: 6573 3a20 6046 6561 7475 7265 6020 6f72  es: `Feature` or
-00005ca0: 206c 6973 7420 6f66 2066 6561 7475 7265   list of feature
-00005cb0: 732e 2041 2066 6561 7475 7265 206f 626a  s. A feature obj
-00005cc0: 6563 7420 6f72 206c 6973 7420 7468 6572  ect or list ther
-00005cd0: 656f 6620 746f 0a20 2020 2020 2020 2020  eof to.         
-00005ce0: 2020 2020 2020 2062 6520 7570 6461 7465         be update
-00005cf0: 642e 0a0a 2020 2020 2020 2020 2320 5265  d...        # Re
-00005d00: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
-00005d10: 2020 6046 6561 7475 7265 4772 6f75 7060    `FeatureGroup`
-00005d20: 2e20 5468 6520 7570 6461 7465 6420 6665  . The updated fe
-00005d30: 6174 7572 6520 6772 6f75 7020 6f62 6a65  ature group obje
-00005d40: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
-00005d50: 2020 2020 2020 2020 6e65 775f 6665 6174          new_feat
-00005d60: 7572 6573 203d 205b 5d0a 2020 2020 2020  ures = [].      
-00005d70: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
-00005d80: 6665 6174 7572 6573 2c20 6665 6174 7572  features, featur
-00005d90: 652e 4665 6174 7572 6529 3a0a 2020 2020  e.Feature):.    
-00005da0: 2020 2020 2020 2020 6e65 775f 6665 6174          new_feat
-00005db0: 7572 6573 2e61 7070 656e 6428 6665 6174  ures.append(feat
-00005dc0: 7572 6573 290a 2020 2020 2020 2020 656c  ures).        el
-00005dd0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-00005de0: 6174 7572 6573 2c20 6c69 7374 293a 0a20  atures, list):. 
-00005df0: 2020 2020 2020 2020 2020 2066 6f72 2066             for f
-00005e00: 6561 7420 696e 2066 6561 7475 7265 733a  eat in features:
-00005e10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00005e20: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
-00005e30: 6561 742c 2066 6561 7475 7265 2e46 6561  eat, feature.Fea
-00005e40: 7475 7265 293a 0a20 2020 2020 2020 2020  ture):.         
-00005e50: 2020 2020 2020 2020 2020 206e 6577 5f66             new_f
-00005e60: 6561 7475 7265 732e 6170 7065 6e64 2866  eatures.append(f
-00005e70: 6561 7429 0a20 2020 2020 2020 2020 2020  eat).           
-00005e80: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
-00005e90: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00005ea0: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-00005eb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005ec0: 2020 2020 2020 2020 2254 6865 2061 7267          "The arg
-00005ed0: 756d 656e 7420 6066 6561 7475 7265 7360  ument `features`
-00005ee0: 2068 6173 2074 6f20 6265 206f 6620 7479   has to be of ty
-00005ef0: 7065 2060 4665 6174 7572 6560 206f 7220  pe `Feature` or 
-00005f00: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00005f10: 2020 2020 2020 2020 2020 2261 206c 6973            "a lis
-00005f20: 7420 7468 6572 656f 662c 2062 7574 2061  t thereof, but a
-00005f30: 6e20 656c 656d 656e 7420 6973 206f 6620  n element is of 
-00005f40: 7479 7065 3a20 607b 7d60 222e 666f 726d  type: `{}`".form
-00005f50: 6174 280a 2020 2020 2020 2020 2020 2020  at(.            
-00005f60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f70: 7479 7065 2866 6561 7475 7265 7329 0a20  type(features). 
-00005f80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005f90: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00005fa0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-00005fb0: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00005fc0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00005fd0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
-00005fe0: 2020 2020 2020 2020 2020 2254 6865 2061            "The a
-00005ff0: 7267 756d 656e 7420 6066 6561 7475 7265  rgument `feature
-00006000: 7360 2068 6173 2074 6f20 6265 206f 6620  s` has to be of 
-00006010: 7479 7065 2060 4665 6174 7572 6560 206f  type `Feature` o
-00006020: 7220 6120 6c69 7374 2022 0a20 2020 2020  r a list ".     
-00006030: 2020 2020 2020 2020 2020 2022 7468 6572             "ther
-00006040: 656f 662c 2062 7574 2069 7320 6f66 2074  eof, but is of t
-00006050: 7970 653a 2060 7b7d 6022 2e66 6f72 6d61  ype: `{}`".forma
-00006060: 7428 7479 7065 2866 6561 7475 7265 7329  t(type(features)
-00006070: 290a 2020 2020 2020 2020 2020 2020 290a  ).            ).
-00006080: 2020 2020 2020 2020 7365 6c66 2e5f 6665          self._fe
-00006090: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
-000060a0: 6e65 2e75 7064 6174 655f 6665 6174 7572  ne.update_featur
-000060b0: 6573 2873 656c 662c 206e 6577 5f66 6561  es(self, new_fea
-000060c0: 7475 7265 7329 0a20 2020 2020 2020 2072  tures).        r
-000060d0: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
-000060e0: 6465 6620 7570 6461 7465 5f66 6561 7475  def update_featu
-000060f0: 7265 5f64 6573 6372 6970 7469 6f6e 2873  re_description(s
-00006100: 656c 662c 2066 6561 7475 7265 5f6e 616d  elf, feature_nam
-00006110: 653a 2073 7472 2c20 6465 7363 7269 7074  e: str, descript
-00006120: 696f 6e3a 2073 7472 293a 0a20 2020 2020  ion: str):.     
-00006130: 2020 2022 2222 5570 6461 7465 2074 6865     """Update the
-00006140: 2064 6573 6372 6970 7469 6f6e 206f 6620   description of 
-00006150: 6120 7369 6e67 6c65 2066 6561 7475 7265  a single feature
-00006160: 2069 6e20 7468 6973 2066 6561 7475 7265   in this feature
-00006170: 2067 726f 7570 2e0a 0a20 2020 2020 2020   group...       
-00006180: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-00006190: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-000061a0: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-000061b0: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-000061c0: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-000061d0: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-000061e0: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-000061f0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
-00006200: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
-00006210: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
-00006220: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
-00006230: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
-00006240: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
-00006250: 2020 2066 672e 7570 6461 7465 5f66 6561     fg.update_fea
-00006260: 7475 7265 5f64 6573 6372 6970 7469 6f6e  ture_description
-00006270: 2866 6561 7475 7265 5f6e 616d 653d 226d  (feature_name="m
-00006280: 696e 5f74 656d 7022 2c0a 2020 2020 2020  in_temp",.      
-00006290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000062a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000062b0: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
-000062c0: 224d 7563 6820 6265 7474 6572 2066 6561  "Much better fea
-000062d0: 7475 7265 2064 6573 6372 6970 7469 6f6e  ture description
-000062e0: 2e22 290a 2020 2020 2020 2020 2020 2020  .").            
-000062f0: 6060 600a 0a20 2020 2020 2020 2021 2121  ```..        !!!
-00006300: 2069 6e66 6f20 2253 6166 6520 7570 6461   info "Safe upda
-00006310: 7465 220a 2020 2020 2020 2020 2020 2020  te".            
-00006320: 5468 6973 206d 6574 686f 6420 7570 6461  This method upda
-00006330: 7465 7320 7468 6520 6665 6174 7572 6520  tes the feature 
-00006340: 6465 7363 7269 7074 696f 6e20 7361 6665  description safe
-00006350: 6c79 2e20 496e 2063 6173 6520 6f66 2066  ly. In case of f
-00006360: 6169 6c75 7265 0a20 2020 2020 2020 2020  ailure.         
-00006370: 2020 2079 6f75 7220 6c6f 6361 6c20 6d65     your local me
-00006380: 7461 6461 7461 206f 626a 6563 7420 7769  tadata object wi
-00006390: 6c6c 206b 6565 7020 7468 6520 6f6c 6420  ll keep the old 
-000063a0: 6465 7363 7269 7074 696f 6e2e 0a0a 2020  description...  
-000063b0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
-000063c0: 730a 2020 2020 2020 2020 2020 2020 6665  s.            fe
-000063d0: 6174 7572 655f 6e61 6d65 3a20 4e61 6d65  ature_name: Name
-000063e0: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-000063f0: 746f 2062 6520 7570 6461 7465 642e 0a20  to be updated.. 
-00006400: 2020 2020 2020 2020 2020 2064 6573 6372             descr
-00006410: 6970 7469 6f6e 3a20 4e65 7720 6465 7363  iption: New desc
-00006420: 7269 7074 696f 6e20 7374 7269 6e67 2e0a  ription string..
-00006430: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-00006440: 6e73 0a20 2020 2020 2020 2020 2020 2060  ns.            `
-00006450: 4665 6174 7572 6547 726f 7570 602e 2054  FeatureGroup`. T
-00006460: 6865 2075 7064 6174 6564 2066 6561 7475  he updated featu
-00006470: 7265 2067 726f 7570 206f 626a 6563 742e  re group object.
-00006480: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00006490: 2020 2020 2066 5f63 6f70 7920 3d20 636f       f_copy = co
-000064a0: 7079 2e64 6565 7063 6f70 7928 7365 6c66  py.deepcopy(self
-000064b0: 5b66 6561 7475 7265 5f6e 616d 655d 290a  [feature_name]).
-000064c0: 2020 2020 2020 2020 665f 636f 7079 2e64          f_copy.d
-000064d0: 6573 6372 6970 7469 6f6e 203d 2064 6573  escription = des
-000064e0: 6372 6970 7469 6f6e 0a20 2020 2020 2020  cription.       
-000064f0: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
-00006500: 726f 7570 5f65 6e67 696e 652e 7570 6461  roup_engine.upda
-00006510: 7465 5f66 6561 7475 7265 7328 7365 6c66  te_features(self
-00006520: 2c20 5b66 5f63 6f70 795d 290a 2020 2020  , [f_copy]).    
-00006530: 2020 2020 7265 7475 726e 2073 656c 660a      return self.
-00006540: 0a20 2020 2064 6566 2061 7070 656e 645f  .    def append_
-00006550: 6665 6174 7572 6573 2873 656c 662c 2066  features(self, f
-00006560: 6561 7475 7265 733a 2055 6e69 6f6e 5b66  eatures: Union[f
-00006570: 6561 7475 7265 2e46 6561 7475 7265 2c20  eature.Feature, 
-00006580: 4c69 7374 5b66 6561 7475 7265 2e46 6561  List[feature.Fea
-00006590: 7475 7265 5d5d 293a 0a20 2020 2020 2020  ture]]):.       
-000065a0: 2022 2222 4170 7065 6e64 2066 6561 7475   """Append featu
-000065b0: 7265 7320 746f 2074 6865 2073 6368 656d  res to the schem
-000065c0: 6120 6f66 2074 6865 2066 6561 7475 7265  a of the feature
-000065d0: 2067 726f 7570 2e0a 0a20 2020 2020 2020   group...       
-000065e0: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
-000065f0: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00006600: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
-00006610: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
-00006620: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
-00006630: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
-00006640: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
-00006650: 2320 6465 6669 6e65 2066 6561 7475 7265  # define feature
-00006660: 7320 746f 2062 6520 696e 7365 7274 6564  s to be inserted
-00006670: 2069 6e20 7468 6520 6665 6174 7572 6520   in the feature 
-00006680: 6772 6f75 700a 2020 2020 2020 2020 2020  group.          
-00006690: 2020 6665 6174 7572 6573 203d 205b 0a20    features = [. 
-000066a0: 2020 2020 2020 2020 2020 2020 2020 2046                 F
-000066b0: 6561 7475 7265 286e 616d 653d 2269 6422  eature(name="id"
-000066c0: 2c74 7970 653d 2269 6e74 222c 6f6e 6c69  ,type="int",onli
-000066d0: 6e65 5f74 7970 653d 2269 6e74 2229 2c0a  ne_type="int"),.
-000066e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000066f0: 4665 6174 7572 6528 6e61 6d65 3d22 6e61  Feature(name="na
-00006700: 6d65 222c 7479 7065 3d22 7374 7269 6e67  me",type="string
-00006710: 222c 6f6e 6c69 6e65 5f74 7970 653d 2276  ",online_type="v
-00006720: 6172 6368 6172 2832 3029 2229 0a20 2020  archar(20)").   
-00006730: 2020 2020 2020 2020 205d 0a0a 2020 2020           ]..    
-00006740: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-00006750: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
-00006760: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
-00006770: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
-00006780: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
-00006790: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
-000067a0: 2020 2020 2020 2020 2020 2066 672e 6170             fg.ap
-000067b0: 7065 6e64 5f66 6561 7475 7265 7328 6665  pend_features(fe
-000067c0: 6174 7572 6573 290a 2020 2020 2020 2020  atures).        
-000067d0: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-000067e0: 2021 2121 2069 6e66 6f20 2253 6166 6520   !!! info "Safe 
-000067f0: 6170 7065 6e64 220a 2020 2020 2020 2020  append".        
-00006800: 2020 2020 5468 6973 206d 6574 686f 6420      This method 
-00006810: 6170 7065 6e64 7320 7468 6520 6665 6174  appends the feat
-00006820: 7572 6573 2074 6f20 7468 6520 6665 6174  ures to the feat
-00006830: 7572 6520 6772 6f75 7020 6465 7363 7269  ure group descri
-00006840: 7074 696f 6e20 7361 6665 6c79 2e0a 2020  ption safely..  
-00006850: 2020 2020 2020 2020 2020 496e 2063 6173            In cas
-00006860: 6520 6f66 2066 6169 6c75 7265 2079 6f75  e of failure you
-00006870: 7220 6c6f 6361 6c20 6d65 7461 6461 7461  r local metadata
-00006880: 206f 626a 6563 7420 7769 6c6c 2063 6f6e   object will con
-00006890: 7461 696e 2074 6865 2063 6f72 7265 6374  tain the correct
-000068a0: 0a20 2020 2020 2020 2020 2020 2073 6368  .            sch
-000068b0: 656d 612e 0a0a 2020 2020 2020 2020 4974  ema...        It
-000068c0: 2069 7320 6f6e 6c79 2070 6f73 7369 626c   is only possibl
-000068d0: 6520 746f 2061 7070 656e 6420 6665 6174  e to append feat
-000068e0: 7572 6573 2074 6f20 6120 6665 6174 7572  ures to a featur
-000068f0: 6520 6772 6f75 702e 2052 656d 6f76 696e  e group. Removin
-00006900: 670a 2020 2020 2020 2020 6665 6174 7572  g.        featur
-00006910: 6573 2069 7320 636f 6e73 6964 6572 6564  es is considered
-00006920: 2061 2062 7265 616b 696e 6720 6368 616e   a breaking chan
-00006930: 6765 2e0a 0a20 2020 2020 2020 2023 2041  ge...        # A
-00006940: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
-00006950: 2020 2020 2066 6561 7475 7265 733a 2046       features: F
-00006960: 6561 7475 7265 206f 7220 6c69 7374 2e20  eature or list. 
-00006970: 4120 6665 6174 7572 6520 6f62 6a65 6374  A feature object
-00006980: 206f 7220 6c69 7374 2074 6865 7265 6f66   or list thereof
-00006990: 2074 6f20 6170 7065 6e64 2074 6f0a 2020   to append to.  
-000069a0: 2020 2020 2020 2020 2020 2020 2020 7468                th
-000069b0: 6520 7363 6865 6d61 206f 6620 7468 6520  e schema of the 
-000069c0: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
-000069d0: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
-000069e0: 730a 2020 2020 2020 2020 2020 2020 6046  s.            `F
-000069f0: 6561 7475 7265 4772 6f75 7060 2e20 5468  eatureGroup`. Th
-00006a00: 6520 7570 6461 7465 6420 6665 6174 7572  e updated featur
-00006a10: 6520 6772 6f75 7020 6f62 6a65 6374 2e0a  e group object..
-00006a20: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00006a30: 2020 2020 6e65 775f 6665 6174 7572 6573      new_features
-00006a40: 203d 205b 5d0a 2020 2020 2020 2020 6966   = [].        if
-00006a50: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
-00006a60: 7572 6573 2c20 6665 6174 7572 652e 4665  ures, feature.Fe
-00006a70: 6174 7572 6529 3a0a 2020 2020 2020 2020  ature):.        
-00006a80: 2020 2020 6e65 775f 6665 6174 7572 6573      new_features
-00006a90: 2e61 7070 656e 6428 6665 6174 7572 6573  .append(features
-00006aa0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00006ab0: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
-00006ac0: 6573 2c20 6c69 7374 293a 0a20 2020 2020  es, list):.     
-00006ad0: 2020 2020 2020 2066 6f72 2066 6561 7420         for feat 
-00006ae0: 696e 2066 6561 7475 7265 733a 0a20 2020  in features:.   
-00006af0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-00006b00: 6973 696e 7374 616e 6365 2866 6561 742c  isinstance(feat,
-00006b10: 2066 6561 7475 7265 2e46 6561 7475 7265   feature.Feature
-00006b20: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-00006b30: 2020 2020 2020 206e 6577 5f66 6561 7475         new_featu
-00006b40: 7265 732e 6170 7065 6e64 2866 6561 7429  res.append(feat)
-00006b50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006b60: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00006b70: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-00006b80: 2054 7970 6545 7272 6f72 280a 2020 2020   TypeError(.    
-00006b90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006ba0: 2020 2020 2254 6865 2061 7267 756d 656e      "The argumen
-00006bb0: 7420 6066 6561 7475 7265 7360 2068 6173  t `features` has
-00006bc0: 2074 6f20 6265 206f 6620 7479 7065 2060   to be of type `
-00006bd0: 4665 6174 7572 6560 206f 7220 220a 2020  Feature` or ".  
-00006be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006bf0: 2020 2020 2020 2261 206c 6973 7420 7468        "a list th
-00006c00: 6572 656f 662c 2062 7574 2061 6e20 656c  ereof, but an el
-00006c10: 656d 656e 7420 6973 206f 6620 7479 7065  ement is of type
-00006c20: 3a20 607b 7d60 222e 666f 726d 6174 280a  : `{}`".format(.
-00006c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c40: 2020 2020 2020 2020 2020 2020 7479 7065              type
-00006c50: 2866 6561 7475 7265 7329 0a20 2020 2020  (features).     
-00006c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00006c70: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
-00006c80: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00006c90: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00006ca0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00006cb0: 7272 6f72 280a 2020 2020 2020 2020 2020  rror(.          
-00006cc0: 2020 2020 2020 2254 6865 2061 7267 756d        "The argum
-00006cd0: 656e 7420 6066 6561 7475 7265 7360 2068  ent `features` h
-00006ce0: 6173 2074 6f20 6265 206f 6620 7479 7065  as to be of type
-00006cf0: 2060 4665 6174 7572 6560 206f 7220 6120   `Feature` or a 
-00006d00: 6c69 7374 2022 0a20 2020 2020 2020 2020  list ".         
-00006d10: 2020 2020 2020 2022 7468 6572 656f 662c         "thereof,
-00006d20: 2062 7574 2069 7320 6f66 2074 7970 653a   but is of type:
-00006d30: 2060 7b7d 6022 2e66 6f72 6d61 7428 7479   `{}`".format(ty
-00006d40: 7065 2866 6561 7475 7265 7329 290a 2020  pe(features)).  
-00006d50: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00006d60: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
-00006d70: 655f 6772 6f75 705f 656e 6769 6e65 2e61  e_group_engine.a
-00006d80: 7070 656e 645f 6665 6174 7572 6573 2873  ppend_features(s
-00006d90: 656c 662c 206e 6577 5f66 6561 7475 7265  elf, new_feature
-00006da0: 7329 0a20 2020 2020 2020 2072 6574 7572  s).        retur
-00006db0: 6e20 7365 6c66 0a0a 2020 2020 6465 6620  n self..    def 
-00006dc0: 6765 745f 6578 7065 6374 6174 696f 6e5f  get_expectation_
-00006dd0: 7375 6974 6528 0a20 2020 2020 2020 2073  suite(.        s
-00006de0: 656c 662c 2067 655f 7479 7065 3a20 626f  elf, ge_type: bo
-00006df0: 6f6c 203d 2054 7275 650a 2020 2020 2920  ol = True.    ) 
-00006e00: 2d3e 2055 6e69 6f6e 5b45 7870 6563 7461  -> Union[Expecta
-00006e10: 7469 6f6e 5375 6974 652c 2067 652e 636f  tionSuite, ge.co
-00006e20: 7265 2e45 7870 6563 7461 7469 6f6e 5375  re.ExpectationSu
-00006e30: 6974 652c 204e 6f6e 655d 3a0a 2020 2020  ite, None]:.    
-00006e40: 2020 2020 2222 2252 6574 7572 6e20 7468      """Return th
-00006e50: 6520 6578 7065 6374 6174 696f 6e20 7375  e expectation su
-00006e60: 6974 6520 6174 7461 6368 6564 2074 6f20  ite attached to 
-00006e70: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00006e80: 7020 6966 2069 7420 6578 6973 7473 2e0a  p if it exists..
-00006e90: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
-00006ea0: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
-00006eb0: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-00006ec0: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
-00006ed0: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
-00006ee0: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
-00006ef0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
-00006f00: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
-00006f10: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
-00006f20: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
-00006f30: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
-00006f40: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
-00006f50: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
-00006f60: 2020 2020 2020 2020 2020 2065 7870 5f73             exp_s
-00006f70: 7569 7465 203d 2066 672e 6765 745f 6578  uite = fg.get_ex
-00006f80: 7065 6374 6174 696f 6e5f 7375 6974 6528  pectation_suite(
-00006f90: 290a 2020 2020 2020 2020 2020 2020 6060  ).            ``
-00006fa0: 600a 0a20 2020 2020 2020 2023 2041 7267  `..        # Arg
-00006fb0: 756d 656e 7473 0a20 2020 2020 2020 2020  uments.         
-00006fc0: 2020 2067 655f 7479 7065 3a20 4966 2060     ge_type: If `
-00006fd0: 5472 7565 6020 7265 7475 726e 7320 6120  True` returns a 
-00006fe0: 6e61 7469 7665 2047 7265 6174 2045 7870  native Great Exp
-00006ff0: 6563 7461 7469 6f6e 2074 7970 652c 2048  ectation type, H
-00007000: 6f70 7377 6f72 6b73 0a20 2020 2020 2020  opsworks.       
-00007010: 2020 2020 2020 2020 2063 7573 746f 6d20           custom 
-00007020: 7479 7065 206f 7468 6572 7769 7365 2e20  type otherwise. 
-00007030: 436f 6e76 6572 7369 6f6e 2063 616e 2062  Conversion can b
-00007040: 6520 7065 7266 6f72 6d65 6420 7669 6120  e performed via 
-00007050: 7468 6520 6074 6f5f 6765 5f74 7970 6528  the `to_ge_type(
-00007060: 2960 0a20 2020 2020 2020 2020 2020 2020  )`.             
-00007070: 2020 206d 6574 686f 6420 6f6e 2068 6f70     method on hop
-00007080: 7377 6f72 6b73 2074 7970 652e 2044 6566  sworks type. Def
-00007090: 6175 6c74 7320 746f 2060 5472 7565 602e  aults to `True`.
-000070a0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
-000070b0: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
-000070c0: 6045 7870 6563 7461 7469 6f6e 5375 6974  `ExpectationSuit
-000070d0: 6560 2e20 5468 6520 6578 7065 6374 6174  e`. The expectat
-000070e0: 696f 6e20 7375 6974 6520 6174 7461 6368  ion suite attach
-000070f0: 6564 2074 6f20 7468 6520 6665 6174 7572  ed to the featur
-00007100: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
-00007110: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
-00007120: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-00007130: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
-00007140: 6573 7441 5049 4572 726f 7260 2e0a 2020  estAPIError`..  
-00007150: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00007160: 2020 2320 4176 6f69 6420 7468 726f 7769    # Avoid throwi
-00007170: 6e67 2061 6e20 6572 726f 7220 6966 2046  ng an error if F
-00007180: 6561 7475 7265 2047 726f 7570 206e 6f74  eature Group not
-00007190: 2069 6e69 7469 616c 6973 6564 2e0a 2020   initialised..  
-000071a0: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
-000071b0: 643a 0a20 2020 2020 2020 2020 2020 2073  d:.            s
-000071c0: 656c 662e 5f65 7870 6563 7461 7469 6f6e  elf._expectation
-000071d0: 5f73 7569 7465 203d 2073 656c 662e 5f65  _suite = self._e
-000071e0: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-000071f0: 5f65 6e67 696e 652e 6765 7428 290a 0a20  _engine.get().. 
-00007200: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00007210: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00007220: 6520 6973 206e 6f74 204e 6f6e 6520 616e  e is not None an
-00007230: 6420 6765 5f74 7970 6520 6973 2054 7275  d ge_type is Tru
-00007240: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-00007250: 6574 7572 6e20 7365 6c66 2e5f 6578 7065  eturn self._expe
-00007260: 6374 6174 696f 6e5f 7375 6974 652e 746f  ctation_suite.to
-00007270: 5f67 655f 7479 7065 2829 0a20 2020 2020  _ge_type().     
-00007280: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
-00007290: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-000072a0: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
-000072b0: 6974 650a 0a20 2020 2064 6566 2073 6176  ite..    def sav
-000072c0: 655f 6578 7065 6374 6174 696f 6e5f 7375  e_expectation_su
-000072d0: 6974 6528 0a20 2020 2020 2020 2073 656c  ite(.        sel
-000072e0: 662c 0a20 2020 2020 2020 2065 7870 6563  f,.        expec
-000072f0: 7461 7469 6f6e 5f73 7569 7465 3a20 556e  tation_suite: Un
-00007300: 696f 6e5b 4578 7065 6374 6174 696f 6e53  ion[ExpectationS
-00007310: 7569 7465 2c20 6765 2e63 6f72 652e 4578  uite, ge.core.Ex
-00007320: 7065 6374 6174 696f 6e53 7569 7465 5d2c  pectationSuite],
-00007330: 0a20 2020 2020 2020 2072 756e 5f76 616c  .        run_val
-00007340: 6964 6174 696f 6e3a 2062 6f6f 6c20 3d20  idation: bool = 
-00007350: 5472 7565 2c0a 2020 2020 2020 2020 7661  True,.        va
-00007360: 6c69 6461 7469 6f6e 5f69 6e67 6573 7469  lidation_ingesti
-00007370: 6f6e 5f70 6f6c 6963 793a 2073 7472 203d  on_policy: str =
-00007380: 2022 414c 5741 5953 222c 0a20 2020 2020   "ALWAYS",.     
-00007390: 2020 206f 7665 7277 7269 7465 3a20 626f     overwrite: bo
-000073a0: 6f6c 203d 2046 616c 7365 2c0a 2020 2020  ol = False,.    
-000073b0: 2920 2d3e 2055 6e69 6f6e 5b45 7870 6563  ) -> Union[Expec
-000073c0: 7461 7469 6f6e 5375 6974 652c 2067 652e  tationSuite, ge.
-000073d0: 636f 7265 2e45 7870 6563 7461 7469 6f6e  core.Expectation
-000073e0: 5375 6974 655d 3a0a 2020 2020 2020 2020  Suite]:.        
-000073f0: 2222 2241 7474 6163 6820 616e 2065 7870  """Attach an exp
-00007400: 6563 7461 7469 6f6e 2073 7569 7465 2074  ectation suite t
-00007410: 6f20 6120 6665 6174 7572 6520 6772 6f75  o a feature grou
-00007420: 7020 616e 6420 7361 7665 7320 6974 2066  p and saves it f
-00007430: 6f72 2066 7574 7572 6520 7573 652e 2049  or future use. I
-00007440: 6620 616e 2065 7870 6563 7461 7469 6f6e  f an expectation
-00007450: 0a20 2020 2020 2020 2073 7569 7465 2069  .        suite i
-00007460: 7320 616c 7265 6164 7920 6174 7461 6368  s already attach
-00007470: 6564 2c20 6974 2069 7320 7265 706c 6163  ed, it is replac
-00007480: 6564 2e20 4e6f 7465 2074 6861 7420 7468  ed. Note that th
-00007490: 6520 7072 6f76 6964 6564 2065 7870 6563  e provided expec
-000074a0: 7461 7469 6f6e 2073 7569 7465 2069 7320  tation suite is 
-000074b0: 6d6f 6469 6669 6564 0a20 2020 2020 2020  modified.       
-000074c0: 2069 6e70 6c61 6365 2074 6f20 696e 636c   inplace to incl
-000074d0: 7564 6520 6578 7065 6374 6174 696f 6e49  ude expectationI
-000074e0: 6420 6669 656c 6473 2e0a 0a20 2020 2020  d fields...     
-000074f0: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
-00007500: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-00007510: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-00007520: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
-00007530: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
-00007540: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
-00007550: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
-00007560: 2020 2320 6765 7420 7468 6520 4665 6174    # get the Feat
-00007570: 7572 6520 4772 6f75 7020 696e 7374 616e  ure Group instan
-00007580: 6365 0a20 2020 2020 2020 2020 2020 2066  ce.            f
-00007590: 6720 3d20 6673 2e67 6574 5f6f 725f 6372  g = fs.get_or_cr
-000075a0: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-000075b0: 7570 282e 2e2e 290a 0a20 2020 2020 2020  up(...)..       
-000075c0: 2020 2020 2066 672e 7361 7665 5f65 7870       fg.save_exp
-000075d0: 6563 7461 7469 6f6e 5f73 7569 7465 2865  ectation_suite(e
-000075e0: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-000075f0: 2c20 7275 6e5f 7661 6c69 6461 7469 6f6e  , run_validation
-00007600: 3d54 7275 6529 0a20 2020 2020 2020 2020  =True).         
-00007610: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-00007620: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
-00007630: 2020 2020 2020 2020 6578 7065 6374 6174          expectat
-00007640: 696f 6e5f 7375 6974 653a 2054 6865 2065  ion_suite: The e
-00007650: 7870 6563 7461 7469 6f6e 2073 7569 7465  xpectation suite
-00007660: 2074 6f20 6174 7461 6368 2074 6f20 7468   to attach to th
-00007670: 6520 4665 6174 7572 6520 4772 6f75 702e  e Feature Group.
-00007680: 0a20 2020 2020 2020 2020 2020 206f 7665  .            ove
-00007690: 7277 7269 7465 3a20 4966 2061 6e20 4578  rwrite: If an Ex
-000076a0: 7065 6374 6174 696f 6e20 5375 6974 6520  pectation Suite 
-000076b0: 6973 2061 6c72 6561 6479 2061 7474 6163  is already attac
-000076c0: 6865 642c 206f 7665 7277 7269 7465 2069  hed, overwrite i
-000076d0: 742e 0a20 2020 2020 2020 2020 2020 2020  t..             
-000076e0: 2020 2054 6865 206e 6577 2073 7569 7465     The new suite
-000076f0: 2077 696c 6c20 6861 7665 2069 7473 206f   will have its o
-00007700: 776e 2076 616c 6964 6174 696f 6e20 6869  wn validation hi
-00007710: 7374 6f72 792c 2062 7574 2066 6f72 6d65  story, but forme
-00007720: 7220 7265 706f 7274 7320 6172 6520 7072  r reports are pr
-00007730: 6573 6572 7665 642e 0a20 2020 2020 2020  eserved..       
-00007740: 2020 2020 2072 756e 5f76 616c 6964 6174       run_validat
-00007750: 696f 6e3a 2053 6574 2077 6865 7468 6572  ion: Set whether
-00007760: 2074 6865 2065 7870 6563 7461 7469 6f6e   the expectation
-00007770: 5f73 7569 7465 2077 696c 6c20 7275 6e20  _suite will run 
-00007780: 6f6e 2069 6e67 6573 7469 6f6e 0a20 2020  on ingestion.   
-00007790: 2020 2020 2020 2020 2076 616c 6964 6174           validat
-000077a0: 696f 6e5f 696e 6765 7374 696f 6e5f 706f  ion_ingestion_po
-000077b0: 6c69 6379 3a20 5365 7420 7468 6520 706f  licy: Set the po
-000077c0: 6c69 6379 2066 6f72 2069 6e67 6573 7469  licy for ingesti
-000077d0: 6f6e 2074 6f20 7468 6520 4665 6174 7572  on to the Featur
-000077e0: 6520 4772 6f75 702e 0a20 2020 2020 2020  e Group..       
-000077f0: 2020 2020 2020 2020 202d 2022 5354 5249           - "STRI
-00007800: 4354 2220 6f6e 6c79 2061 6c6c 6f77 7320  CT" only allows 
-00007810: 4461 7461 4672 616d 6520 7061 7373 696e  DataFrame passin
-00007820: 6720 7661 6c69 6461 7469 6f6e 2074 6f20  g validation to 
-00007830: 6265 2069 6e73 6572 7465 6420 696e 746f  be inserted into
-00007840: 2046 6561 7475 7265 2047 726f 7570 2e0a   Feature Group..
-00007850: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007860: 2d20 2241 4c57 4159 5322 2061 6c77 6179  - "ALWAYS" alway
-00007870: 7320 696e 7365 7274 2074 6865 2044 6174  s insert the Dat
-00007880: 6146 7261 6d65 2074 6f20 7468 6520 4665  aFrame to the Fe
-00007890: 6174 7572 6520 4772 6f75 702c 2069 7272  ature Group, irr
-000078a0: 6573 7065 6374 6976 6520 6f66 206f 7665  espective of ove
-000078b0: 7261 6c6c 2076 616c 6964 6174 696f 6e20  rall validation 
-000078c0: 7265 7375 6c74 2e0a 0a20 2020 2020 2020  result...       
-000078d0: 2023 2052 6169 7365 730a 2020 2020 2020   # Raises.      
-000078e0: 2020 2020 2020 6068 7366 732e 636c 6965        `hsfs.clie
-000078f0: 6e74 2e65 7863 6570 7469 6f6e 732e 5265  nt.exceptions.Re
-00007900: 7374 4150 4945 7272 6f72 602e 0a20 2020  stAPIError`..   
-00007910: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-00007920: 2069 6620 6973 696e 7374 616e 6365 2865   if isinstance(e
-00007930: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-00007940: 2c20 6765 2e63 6f72 652e 4578 7065 6374  , ge.core.Expect
-00007950: 6174 696f 6e53 7569 7465 293a 0a20 2020  ationSuite):.   
-00007960: 2020 2020 2020 2020 2074 6d70 5f65 7870           tmp_exp
-00007970: 6563 7461 7469 6f6e 5f73 7569 7465 203d  ectation_suite =
-00007980: 2045 7870 6563 7461 7469 6f6e 5375 6974   ExpectationSuit
-00007990: 652e 6672 6f6d 5f67 655f 7479 7065 280a  e.from_ge_type(.
-000079a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000079b0: 6765 5f65 7870 6563 7461 7469 6f6e 5f73  ge_expectation_s
-000079c0: 7569 7465 3d65 7870 6563 7461 7469 6f6e  uite=expectation
-000079d0: 5f73 7569 7465 2c0a 2020 2020 2020 2020  _suite,.        
-000079e0: 2020 2020 2020 2020 7275 6e5f 7661 6c69          run_vali
-000079f0: 6461 7469 6f6e 3d72 756e 5f76 616c 6964  dation=run_valid
-00007a00: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-00007a10: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
-00007a20: 6e5f 696e 6765 7374 696f 6e5f 706f 6c69  n_ingestion_poli
-00007a30: 6379 3d76 616c 6964 6174 696f 6e5f 696e  cy=validation_in
-00007a40: 6765 7374 696f 6e5f 706f 6c69 6379 2c0a  gestion_policy,.
-00007a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007a60: 6665 6174 7572 655f 7374 6f72 655f 6964  feature_store_id
-00007a70: 3d73 656c 662e 5f66 6561 7475 7265 5f73  =self._feature_s
-00007a80: 746f 7265 5f69 642c 0a20 2020 2020 2020  tore_id,.       
-00007a90: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00007aa0: 5f67 726f 7570 5f69 643d 7365 6c66 2e5f  _group_id=self._
-00007ab0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-00007ac0: 290a 2020 2020 2020 2020 656c 6966 2069  ).        elif i
-00007ad0: 7369 6e73 7461 6e63 6528 6578 7065 6374  sinstance(expect
-00007ae0: 6174 696f 6e5f 7375 6974 652c 2045 7870  ation_suite, Exp
-00007af0: 6563 7461 7469 6f6e 5375 6974 6529 3a0a  ectationSuite):.
-00007b00: 2020 2020 2020 2020 2020 2020 746d 705f              tmp_
-00007b10: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00007b20: 6520 3d20 6578 7065 6374 6174 696f 6e5f  e = expectation_
-00007b30: 7375 6974 652e 746f 5f6a 736f 6e5f 6469  suite.to_json_di
-00007b40: 6374 2864 6563 616d 656c 697a 653d 5472  ct(decamelize=Tr
-00007b50: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-00007b60: 746d 705f 6578 7065 6374 6174 696f 6e5f  tmp_expectation_
-00007b70: 7375 6974 655b 2266 6561 7475 7265 5f67  suite["feature_g
-00007b80: 726f 7570 5f69 6422 5d20 3d20 7365 6c66  roup_id"] = self
-00007b90: 2e5f 6964 0a20 2020 2020 2020 2020 2020  ._id.           
-00007ba0: 2074 6d70 5f65 7870 6563 7461 7469 6f6e   tmp_expectation
-00007bb0: 5f73 7569 7465 5b22 6665 6174 7572 655f  _suite["feature_
-00007bc0: 7374 6f72 655f 6964 225d 203d 2073 656c  store_id"] = sel
-00007bd0: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-00007be0: 5f69 640a 2020 2020 2020 2020 2020 2020  _id.            
-00007bf0: 746d 705f 6578 7065 6374 6174 696f 6e5f  tmp_expectation_
-00007c00: 7375 6974 6520 3d20 4578 7065 6374 6174  suite = Expectat
-00007c10: 696f 6e53 7569 7465 282a 2a74 6d70 5f65  ionSuite(**tmp_e
-00007c20: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-00007c30: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
-00007c40: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00007c50: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
-00007c60: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-00007c70: 6520 7072 6f76 6964 6564 2065 7870 6563  e provided expec
-00007c80: 7461 7469 6f6e 2073 7569 7465 2074 7970  tation suite typ
-00007c90: 6520 607b 7d60 2069 7320 6e6f 7420 7375  e `{}` is not su
-00007ca0: 7070 6f72 7465 642e 2055 7365 2047 7265  pported. Use Gre
-00007cb0: 6174 2045 7870 6563 7461 7469 6f6e 2060  at Expectation `
-00007cc0: 4578 7065 6374 6174 696f 6e53 7569 7465  ExpectationSuite
-00007cd0: 6020 6f72 2048 5346 5327 206f 776e 2060  ` or HSFS' own `
-00007ce0: 4578 7065 6374 6174 696f 6e53 7569 7465  ExpectationSuite
-00007cf0: 6020 6f62 6a65 6374 2e22 2e66 6f72 6d61  ` object.".forma
-00007d00: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00007d10: 2020 2020 2020 2074 7970 6528 6578 7065         type(expe
-00007d20: 6374 6174 696f 6e5f 7375 6974 6529 0a20  ctation_suite). 
-00007d30: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-00007d40: 0a20 2020 2020 2020 2020 2020 2029 0a0a  .            )..
-00007d50: 2020 2020 2020 2020 6966 206f 7665 7277          if overw
-00007d60: 7269 7465 3a0a 2020 2020 2020 2020 2020  rite:.          
-00007d70: 2020 7365 6c66 2e64 656c 6574 655f 6578    self.delete_ex
-00007d80: 7065 6374 6174 696f 6e5f 7375 6974 6528  pectation_suite(
-00007d90: 290a 0a20 2020 2020 2020 2069 6620 7365  )..        if se
-00007da0: 6c66 2e5f 6964 3a0a 2020 2020 2020 2020  lf._id:.        
-00007db0: 2020 2020 7365 6c66 2e5f 6578 7065 6374      self._expect
-00007dc0: 6174 696f 6e5f 7375 6974 6520 3d20 7365  ation_suite = se
-00007dd0: 6c66 2e5f 6578 7065 6374 6174 696f 6e5f  lf._expectation_
-00007de0: 7375 6974 655f 656e 6769 6e65 2e73 6176  suite_engine.sav
-00007df0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
-00007e00: 2020 2074 6d70 5f65 7870 6563 7461 7469     tmp_expectati
-00007e10: 6f6e 5f73 7569 7465 0a20 2020 2020 2020  on_suite.       
-00007e20: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00007e30: 2020 2065 7870 6563 7461 7469 6f6e 5f73     expectation_s
-00007e40: 7569 7465 203d 2073 656c 662e 5f65 7870  uite = self._exp
-00007e50: 6563 7461 7469 6f6e 5f73 7569 7465 2e74  ectation_suite.t
-00007e60: 6f5f 6765 5f74 7970 6528 290a 2020 2020  o_ge_type().    
-00007e70: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00007e80: 2020 2020 2020 2320 4164 6465 6420 746f        # Added to
-00007e90: 2061 766f 6964 2074 6872 6f77 696e 6720   avoid throwing 
-00007ea0: 616e 2065 7272 6f72 2069 6620 4665 6174  an error if Feat
-00007eb0: 7572 6520 4772 6f75 7020 6973 206e 6f74  ure Group is not
-00007ec0: 2069 6e69 7469 616c 6973 6564 2077 6974   initialised wit
-00007ed0: 6820 7468 6520 6261 636b 656e 640a 2020  h the backend.  
-00007ee0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00007ef0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00007f00: 6520 3d20 746d 705f 6578 7065 6374 6174  e = tmp_expectat
-00007f10: 696f 6e5f 7375 6974 650a 0a20 2020 2064  ion_suite..    d
-00007f20: 6566 2064 656c 6574 655f 6578 7065 6374  ef delete_expect
-00007f30: 6174 696f 6e5f 7375 6974 6528 7365 6c66  ation_suite(self
-00007f40: 2920 2d3e 204e 6f6e 653a 0a20 2020 2020  ) -> None:.     
-00007f50: 2020 2022 2222 4465 6c65 7465 2074 6865     """Delete the
-00007f60: 2065 7870 6563 7461 7469 6f6e 2073 7569   expectation sui
-00007f70: 7465 2061 7474 6163 6865 6420 746f 2074  te attached to t
-00007f80: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-00007f90: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
-00007fa0: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
-00007fb0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-00007fc0: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
-00007fd0: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
-00007fe0: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
-00007ff0: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
-00008000: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-00008010: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
-00008020: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
-00008030: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
-00008040: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
-00008050: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
-00008060: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
-00008070: 6465 6c65 7465 5f65 7870 6563 7461 7469  delete_expectati
-00008080: 6f6e 5f73 7569 7465 2829 0a20 2020 2020  on_suite().     
-00008090: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-000080a0: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
-000080b0: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
-000080c0: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-000080d0: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
-000080e0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-000080f0: 2020 2020 6966 2073 656c 662e 6765 745f      if self.get_
-00008100: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00008110: 6528 2920 6973 206e 6f74 204e 6f6e 653a  e() is not None:
-00008120: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00008130: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
-00008140: 7569 7465 5f65 6e67 696e 652e 6465 6c65  uite_engine.dele
-00008150: 7465 2873 656c 662e 5f65 7870 6563 7461  te(self._expecta
-00008160: 7469 6f6e 5f73 7569 7465 2e69 6429 0a20  tion_suite.id). 
-00008170: 2020 2020 2020 2073 656c 662e 5f65 7870         self._exp
-00008180: 6563 7461 7469 6f6e 5f73 7569 7465 203d  ectation_suite =
-00008190: 204e 6f6e 650a 0a20 2020 2064 6566 2067   None..    def g
-000081a0: 6574 5f6c 6174 6573 745f 7661 6c69 6461  et_latest_valida
-000081b0: 7469 6f6e 5f72 6570 6f72 7428 0a20 2020  tion_report(.   
-000081c0: 2020 2020 2073 656c 662c 2067 655f 7479       self, ge_ty
-000081d0: 7065 3a20 626f 6f6c 203d 2054 7275 650a  pe: bool = True.
-000081e0: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b56      ) -> Union[V
-000081f0: 616c 6964 6174 696f 6e52 6570 6f72 742c  alidationReport,
-00008200: 2067 652e 636f 7265 2e45 7870 6563 7461   ge.core.Expecta
-00008210: 7469 6f6e 5375 6974 6556 616c 6964 6174  tionSuiteValidat
-00008220: 696f 6e52 6573 756c 742c 204e 6f6e 655d  ionResult, None]
-00008230: 3a0a 2020 2020 2020 2020 2222 2252 6574  :.        """Ret
-00008240: 7572 6e20 7468 6520 6c61 7465 7374 2076  urn the latest v
-00008250: 616c 6964 6174 696f 6e20 7265 706f 7274  alidation report
-00008260: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
-00008270: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
-00008280: 6620 6974 2065 7869 7374 732e 0a0a 2020  f it exists...  
-00008290: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
-000082a0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
-000082b0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-000082c0: 2020 2020 2320 636f 6e6e 6563 7420 746f      # connect to
-000082d0: 2074 6865 2046 6561 7475 7265 2053 746f   the Feature Sto
-000082e0: 7265 0a20 2020 2020 2020 2020 2020 2066  re.            f
-000082f0: 7320 3d20 2e2e 2e0a 0a20 2020 2020 2020  s = .....       
-00008300: 2020 2020 2023 2067 6574 2074 6865 2046       # get the F
-00008310: 6561 7475 7265 2047 726f 7570 2069 6e73  eature Group ins
-00008320: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
-00008330: 2020 6667 203d 2066 732e 6765 745f 6f72    fg = fs.get_or
-00008340: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
-00008350: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
-00008360: 2020 2020 2020 2020 6c61 7465 7374 5f76          latest_v
-00008370: 616c 5f72 6570 6f72 7420 3d20 6667 2e67  al_report = fg.g
-00008380: 6574 5f6c 6174 6573 745f 7661 6c69 6461  et_latest_valida
-00008390: 7469 6f6e 5f72 6570 6f72 7428 290a 2020  tion_report().  
-000083a0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
-000083b0: 2020 2020 2020 2023 2041 7267 756d 656e         # Argumen
-000083c0: 7473 0a20 2020 2020 2020 2020 2020 2067  ts.            g
-000083d0: 655f 7479 7065 3a20 4966 2060 5472 7565  e_type: If `True
-000083e0: 6020 7265 7475 726e 7320 6120 6e61 7469  ` returns a nati
-000083f0: 7665 2047 7265 6174 2045 7870 6563 7461  ve Great Expecta
-00008400: 7469 6f6e 2074 7970 652c 2048 6f70 7377  tion type, Hopsw
-00008410: 6f72 6b73 0a20 2020 2020 2020 2020 2020  orks.           
-00008420: 2020 2020 2063 7573 746f 6d20 7479 7065       custom type
-00008430: 206f 7468 6572 7769 7365 2e20 436f 6e76   otherwise. Conv
-00008440: 6572 7369 6f6e 2063 616e 2062 6520 7065  ersion can be pe
-00008450: 7266 6f72 6d65 6420 7669 6120 7468 6520  rformed via the 
-00008460: 6074 6f5f 6765 5f74 7970 6528 2960 0a20  `to_ge_type()`. 
-00008470: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-00008480: 6574 686f 6420 6f6e 2068 6f70 7377 6f72  ethod on hopswor
-00008490: 6b73 2074 7970 652e 2044 6566 6175 6c74  ks type. Default
-000084a0: 7320 746f 2060 5472 7565 602e 0a0a 2020  s to `True`...  
-000084b0: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-000084c0: 2020 2020 2020 2020 2020 2020 6056 616c              `Val
-000084d0: 6964 6174 696f 6e52 6570 6f72 7460 2e20  idationReport`. 
-000084e0: 5468 6520 6c61 7465 7374 2076 616c 6964  The latest valid
-000084f0: 6174 696f 6e20 7265 706f 7274 2061 7474  ation report att
-00008500: 6163 6865 6420 746f 2074 6865 2046 6561  ached to the Fea
-00008510: 7475 7265 2047 726f 7570 2e0a 0a20 2020  ture Group...   
-00008520: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
-00008530: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-00008540: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-00008550: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
-00008560: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-00008570: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00008580: 2e5f 7661 6c69 6461 7469 6f6e 5f72 6570  ._validation_rep
-00008590: 6f72 745f 656e 6769 6e65 2e67 6574 5f6c  ort_engine.get_l
-000085a0: 6173 7428 6765 5f74 7970 653d 6765 5f74  ast(ge_type=ge_t
-000085b0: 7970 6529 0a0a 2020 2020 6465 6620 6765  ype)..    def ge
-000085c0: 745f 616c 6c5f 7661 6c69 6461 7469 6f6e  t_all_validation
-000085d0: 5f72 6570 6f72 7473 280a 2020 2020 2020  _reports(.      
-000085e0: 2020 7365 6c66 2c20 6765 5f74 7970 653a    self, ge_type:
-000085f0: 2062 6f6f 6c20 3d20 5472 7565 0a20 2020   bool = True.   
-00008600: 2029 202d 3e20 4c69 7374 5b55 6e69 6f6e   ) -> List[Union
-00008610: 5b56 616c 6964 6174 696f 6e52 6570 6f72  [ValidationRepor
-00008620: 742c 2067 652e 636f 7265 2e45 7870 6563  t, ge.core.Expec
-00008630: 7461 7469 6f6e 5375 6974 6556 616c 6964  tationSuiteValid
-00008640: 6174 696f 6e52 6573 756c 745d 5d3a 0a20  ationResult]]:. 
-00008650: 2020 2020 2020 2022 2222 5265 7475 726e         """Return
-00008660: 2074 6865 206c 6174 6573 7420 7661 6c69   the latest vali
-00008670: 6461 7469 6f6e 2072 6570 6f72 7420 6174  dation report at
-00008680: 7461 6368 6564 2074 6f20 7468 6520 6665  tached to the fe
-00008690: 6174 7572 6520 6772 6f75 7020 6966 2069  ature group if i
-000086a0: 7420 6578 6973 7473 2e0a 0a20 2020 2020  t exists...     
-000086b0: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
-000086c0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-000086d0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-000086e0: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
-000086f0: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
-00008700: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
-00008710: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
-00008720: 2020 2320 6765 7420 7468 6520 4665 6174    # get the Feat
-00008730: 7572 6520 4772 6f75 7020 696e 7374 616e  ure Group instan
-00008740: 6365 0a20 2020 2020 2020 2020 2020 2066  ce.            f
-00008750: 6720 3d20 6673 2e67 6574 5f6f 725f 6372  g = fs.get_or_cr
-00008760: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-00008770: 7570 282e 2e2e 290a 0a20 2020 2020 2020  up(...)..       
-00008780: 2020 2020 2076 616c 5f72 6570 6f72 7473       val_reports
-00008790: 203d 2066 672e 6765 745f 616c 6c5f 7661   = fg.get_all_va
-000087a0: 6c69 6461 7469 6f6e 5f72 6570 6f72 7473  lidation_reports
-000087b0: 2829 0a20 2020 2020 2020 2020 2020 2060  ().            `
-000087c0: 6060 0a0a 2020 2020 2020 2020 2320 4172  ``..        # Ar
-000087d0: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-000087e0: 2020 2020 6765 5f74 7970 653a 2049 6620      ge_type: If 
-000087f0: 6054 7275 6560 2072 6574 7572 6e73 2061  `True` returns a
-00008800: 206e 6174 6976 6520 4772 6561 7420 4578   native Great Ex
-00008810: 7065 6374 6174 696f 6e20 7479 7065 2c20  pectation type, 
-00008820: 486f 7073 776f 726b 730a 2020 2020 2020  Hopsworks.      
-00008830: 2020 2020 2020 2020 2020 6375 7374 6f6d            custom
-00008840: 2074 7970 6520 6f74 6865 7277 6973 652e   type otherwise.
-00008850: 2043 6f6e 7665 7273 696f 6e20 6361 6e20   Conversion can 
-00008860: 6265 2070 6572 666f 726d 6564 2076 6961  be performed via
-00008870: 2074 6865 2060 746f 5f67 655f 7479 7065   the `to_ge_type
-00008880: 2829 600a 2020 2020 2020 2020 2020 2020  ()`.            
-00008890: 2020 2020 6d65 7468 6f64 206f 6e20 686f      method on ho
-000088a0: 7073 776f 726b 7320 7479 7065 2e20 4465  psworks type. De
-000088b0: 6661 756c 7473 2074 6f20 6054 7275 6560  faults to `True`
-000088c0: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
-000088d0: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
-000088e0: 2055 6e69 6f6e 5b4c 6973 745b 6056 616c   Union[List[`Val
-000088f0: 6964 6174 696f 6e52 6570 6f72 7460 5d2c  idationReport`],
-00008900: 2060 5661 6c69 6461 7469 6f6e 5265 706f   `ValidationRepo
-00008910: 7274 605d 2e20 416c 6c20 7661 6c69 6461  rt`]. All valida
-00008920: 7469 6f6e 2072 6570 6f72 7473 2061 7474  tion reports att
-00008930: 6163 6865 6420 746f 2074 6865 2066 6561  ached to the fea
-00008940: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
-00008950: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
-00008960: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-00008970: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-00008980: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
-00008990: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
-000089a0: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
-000089b0: 696f 6e73 2e46 6561 7475 7265 5374 6f72  ions.FeatureStor
-000089c0: 6545 7863 6570 7469 6f6e 602e 0a20 2020  eException`..   
-000089d0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-000089e0: 2069 6620 7365 6c66 2e5f 6964 3a0a 2020   if self._id:.  
-000089f0: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00008a00: 2073 656c 662e 5f76 616c 6964 6174 696f   self._validatio
-00008a10: 6e5f 7265 706f 7274 5f65 6e67 696e 652e  n_report_engine.
-00008a20: 6765 745f 616c 6c28 6765 5f74 7970 653d  get_all(ge_type=
-00008a30: 6765 5f74 7970 6529 0a20 2020 2020 2020  ge_type).       
-00008a40: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-00008a50: 2020 2072 6169 7365 2046 6561 7475 7265     raise Feature
-00008a60: 5374 6f72 6545 7863 6570 7469 6f6e 280a  StoreException(.
-00008a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008a80: 224f 6e6c 7920 4665 6174 7572 6520 4772  "Only Feature Gr
-00008a90: 6f75 7020 7265 6769 7374 6572 6564 2077  oup registered w
-00008aa0: 6974 6820 486f 7073 776f 726b 7320 6361  ith Hopsworks ca
-00008ab0: 6e20 6665 7463 6820 7661 6c69 6461 7469  n fetch validati
-00008ac0: 6f6e 2072 6570 6f72 7473 2e22 0a20 2020  on reports.".   
-00008ad0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-00008ae0: 6465 6620 7361 7665 5f76 616c 6964 6174  def save_validat
-00008af0: 696f 6e5f 7265 706f 7274 280a 2020 2020  ion_report(.    
-00008b00: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00008b10: 2020 7661 6c69 6461 7469 6f6e 5f72 6570    validation_rep
-00008b20: 6f72 743a 2055 6e69 6f6e 5b0a 2020 2020  ort: Union[.    
-00008b30: 2020 2020 2020 2020 6469 6374 2c0a 2020          dict,.  
-00008b40: 2020 2020 2020 2020 2020 5661 6c69 6461            Valida
-00008b50: 7469 6f6e 5265 706f 7274 2c0a 2020 2020  tionReport,.    
-00008b60: 2020 2020 2020 2020 6765 2e63 6f72 652e          ge.core.
-00008b70: 6578 7065 6374 6174 696f 6e5f 7661 6c69  expectation_vali
-00008b80: 6461 7469 6f6e 5f72 6573 756c 742e 4578  dation_result.Ex
-00008b90: 7065 6374 6174 696f 6e53 7569 7465 5661  pectationSuiteVa
-00008ba0: 6c69 6461 7469 6f6e 5265 7375 6c74 2c0a  lidationResult,.
-00008bb0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-00008bc0: 2020 2069 6e67 6573 7469 6f6e 5f72 6573     ingestion_res
-00008bd0: 756c 743a 2073 7472 203d 2022 554e 4b4e  ult: str = "UNKN
-00008be0: 4f57 4e22 2c0a 2020 2020 2020 2020 6765  OWN",.        ge
-00008bf0: 5f74 7970 653a 2062 6f6f 6c20 3d20 5472  _type: bool = Tr
-00008c00: 7565 2c0a 2020 2020 2920 2d3e 2055 6e69  ue,.    ) -> Uni
-00008c10: 6f6e 5b56 616c 6964 6174 696f 6e52 6570  on[ValidationRep
-00008c20: 6f72 742c 2067 652e 636f 7265 2e45 7870  ort, ge.core.Exp
-00008c30: 6563 7461 7469 6f6e 5375 6974 6556 616c  ectationSuiteVal
-00008c40: 6964 6174 696f 6e52 6573 756c 745d 3a0a  idationResult]:.
-00008c50: 2020 2020 2020 2020 2222 2253 6176 6520          """Save 
-00008c60: 7661 6c69 6461 7469 6f6e 2072 6570 6f72  validation repor
-00008c70: 7420 746f 2068 6f70 7377 6f72 6b73 2070  t to hopsworks p
-00008c80: 6c61 7466 6f72 6d20 616c 6f6e 6720 7072  latform along pr
-00008c90: 6576 696f 7573 2072 6570 6f72 7473 206f  evious reports o
-00008ca0: 6620 7468 6520 7361 6d65 2046 6561 7475  f the same Featu
-00008cb0: 7265 2047 726f 7570 2e0a 0a20 2020 2020  re Group...     
-00008cc0: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
-00008cd0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-00008ce0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-00008cf0: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
-00008d00: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
-00008d10: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
-00008d20: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
-00008d30: 2020 2320 6765 7420 7468 6520 4665 6174    # get the Feat
-00008d40: 7572 6520 4772 6f75 7020 696e 7374 616e  ure Group instan
-00008d50: 6365 0a20 2020 2020 2020 2020 2020 2066  ce.            f
-00008d60: 6720 3d20 6673 2e67 6574 5f6f 725f 6372  g = fs.get_or_cr
-00008d70: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-00008d80: 7570 282e 2e2e 2c20 6578 7065 6374 6174  up(..., expectat
-00008d90: 696f 6e5f 7375 6974 653d 6578 7065 6374  ion_suite=expect
-00008da0: 6174 696f 6e5f 7375 6974 6529 0a0a 2020  ation_suite)..  
-00008db0: 2020 2020 2020 2020 2020 7661 6c69 6461            valida
-00008dc0: 7469 6f6e 5f72 6570 6f72 7420 3d20 6772  tion_report = gr
-00008dd0: 6561 745f 6578 7065 6374 6174 696f 6e73  eat_expectations
-00008de0: 2e66 726f 6d5f 7061 6e64 6173 280a 2020  .from_pandas(.  
-00008df0: 2020 2020 2020 2020 2020 2020 2020 6d79                my
-00008e00: 5f65 7870 6572 696d 656e 7461 6c5f 6665  _experimental_fe
-00008e10: 6174 7572 6573 5f64 662c 0a20 2020 2020  atures_df,.     
-00008e20: 2020 2020 2020 2020 2020 2066 672e 6765             fg.ge
-00008e30: 745f 6578 7065 6374 6174 696f 6e5f 7375  t_expectation_su
-00008e40: 6974 6528 2929 2e76 616c 6964 6174 6528  ite()).validate(
-00008e50: 290a 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00008e60: 672e 7361 7665 5f76 616c 6964 6174 696f  g.save_validatio
-00008e70: 6e5f 7265 706f 7274 2876 616c 6964 6174  n_report(validat
-00008e80: 696f 6e5f 7265 706f 7274 2c20 696e 6765  ion_report, inge
-00008e90: 7374 696f 6e5f 7265 7375 6c74 3d22 4558  stion_result="EX
-00008ea0: 5045 5249 4d45 4e54 2229 0a20 2020 2020  PERIMENT").     
-00008eb0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-00008ec0: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-00008ed0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
-00008ee0: 6461 7469 6f6e 5f72 6570 6f72 743a 2054  dation_report: T
-00008ef0: 6865 2076 616c 6964 6174 696f 6e20 7265  he validation re
-00008f00: 706f 7274 2074 6f20 6174 7461 6368 2074  port to attach t
-00008f10: 6f20 7468 6520 4665 6174 7572 6520 4772  o the Feature Gr
-00008f20: 6f75 702e 0a20 2020 2020 2020 2020 2020  oup..           
-00008f30: 2069 6e67 6573 7469 6f6e 5f72 6573 756c   ingestion_resul
-00008f40: 743a 2053 7065 6369 6679 2074 6865 2066  t: Specify the f
-00008f50: 6174 6520 6f66 2074 6865 2061 7373 6f63  ate of the assoc
-00008f60: 6961 7465 6420 6461 7461 2c20 6465 6661  iated data, defa
-00008f70: 756c 7473 0a20 2020 2020 2020 2020 2020  ults.           
-00008f80: 2020 2020 2074 6f20 2255 4e4b 4e4f 574e       to "UNKNOWN
-00008f90: 222e 2053 7570 706f 7274 6564 206f 7074  ". Supported opt
-00008fa0: 696f 6e73 2061 7265 2020 2255 4e4b 4e4f  ions are  "UNKNO
-00008fb0: 574e 222c 2022 494e 4745 5354 4544 222c  WN", "INGESTED",
-00008fc0: 2022 5245 4a45 4354 4544 222c 0a20 2020   "REJECTED",.   
-00008fd0: 2020 2020 2020 2020 2020 2020 2022 4558               "EX
-00008fe0: 5045 5249 4d45 4e54 222c 2022 4647 5f44  PERIMENT", "FG_D
-00008ff0: 4154 4122 2e20 5573 6520 2249 4e47 4553  ATA". Use "INGES
-00009000: 5445 4422 206f 7220 2252 454a 4543 5445  TED" or "REJECTE
-00009010: 4422 2066 6f72 2076 616c 6964 6174 696f  D" for validatio
-00009020: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-00009030: 2020 6f66 2044 6174 6146 7261 6d65 7320    of DataFrames 
-00009040: 746f 2062 6520 696e 7365 7274 6564 2069  to be inserted i
-00009050: 6e20 7468 6520 4665 6174 7572 6520 4772  n the Feature Gr
-00009060: 6f75 702e 2055 7365 2022 4558 5045 5249  oup. Use "EXPERI
-00009070: 4d45 4e54 220a 2020 2020 2020 2020 2020  MENT".          
-00009080: 2020 2020 2020 666f 7220 7465 7374 696e        for testin
-00009090: 6720 616e 6420 6465 7665 6c6f 706d 656e  g and developmen
-000090a0: 7420 616e 6420 2246 475f 4441 5441 2220  t and "FG_DATA" 
-000090b0: 7768 656e 2076 616c 6964 6174 696e 6720  when validating 
-000090c0: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
-000090d0: 2020 2020 2061 6c72 6561 6479 2069 6e20       already in 
-000090e0: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
-000090f0: 702e 0a20 2020 2020 2020 2020 2020 2067  p..            g
-00009100: 655f 7479 7065 3a20 4966 2060 5472 7565  e_type: If `True
-00009110: 6020 7265 7475 726e 7320 6120 6e61 7469  ` returns a nati
-00009120: 7665 2047 7265 6174 2045 7870 6563 7461  ve Great Expecta
-00009130: 7469 6f6e 2074 7970 652c 2048 6f70 7377  tion type, Hopsw
-00009140: 6f72 6b73 0a20 2020 2020 2020 2020 2020  orks.           
-00009150: 2020 2020 2063 7573 746f 6d20 7479 7065       custom type
-00009160: 206f 7468 6572 7769 7365 2e20 436f 6e76   otherwise. Conv
-00009170: 6572 7369 6f6e 2063 616e 2062 6520 7065  ersion can be pe
-00009180: 7266 6f72 6d65 6420 7669 6120 7468 6520  rformed via the 
-00009190: 6074 6f5f 6765 5f74 7970 6528 2960 0a20  `to_ge_type()`. 
-000091a0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-000091b0: 6574 686f 6420 6f6e 2068 6f70 7377 6f72  ethod on hopswor
-000091c0: 6b73 2074 7970 652e 2044 6566 6175 6c74  ks type. Default
-000091d0: 7320 746f 2060 5472 7565 602e 0a0a 2020  s to `True`...  
-000091e0: 2020 2020 2020 2320 5261 6973 6573 0a20        # Raises. 
-000091f0: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
-00009200: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-00009210: 6e73 2e52 6573 7441 5049 4572 726f 7260  ns.RestAPIError`
-00009220: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
-00009230: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
-00009240: 643a 0a20 2020 2020 2020 2020 2020 2069  d:.            i
-00009250: 6620 6973 696e 7374 616e 6365 280a 2020  f isinstance(.  
-00009260: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00009270: 6c69 6461 7469 6f6e 5f72 6570 6f72 742c  lidation_report,
-00009280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009290: 2067 652e 636f 7265 2e65 7870 6563 7461   ge.core.expecta
-000092a0: 7469 6f6e 5f76 616c 6964 6174 696f 6e5f  tion_validation_
-000092b0: 7265 7375 6c74 2e45 7870 6563 7461 7469  result.Expectati
-000092c0: 6f6e 5375 6974 6556 616c 6964 6174 696f  onSuiteValidatio
-000092d0: 6e52 6573 756c 742c 0a20 2020 2020 2020  nResult,.       
-000092e0: 2020 2020 2029 3a0a 2020 2020 2020 2020       ):.        
-000092f0: 2020 2020 2020 2020 7265 706f 7274 203d          report =
-00009300: 2056 616c 6964 6174 696f 6e52 6570 6f72   ValidationRepor
-00009310: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
-00009320: 2020 2020 2020 202a 2a76 616c 6964 6174         **validat
-00009330: 696f 6e5f 7265 706f 7274 2e74 6f5f 6a73  ion_report.to_js
-00009340: 6f6e 5f64 6963 7428 292c 0a20 2020 2020  on_dict(),.     
-00009350: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00009360: 6e67 6573 7469 6f6e 5f72 6573 756c 743d  ngestion_result=
-00009370: 696e 6765 7374 696f 6e5f 7265 7375 6c74  ingestion_result
-00009380: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009390: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-000093a0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-000093b0: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
-000093c0: 742c 2064 6963 7429 3a0a 2020 2020 2020  t, dict):.      
-000093d0: 2020 2020 2020 2020 2020 7265 706f 7274            report
-000093e0: 203d 2056 616c 6964 6174 696f 6e52 6570   = ValidationRep
-000093f0: 6f72 7428 0a20 2020 2020 2020 2020 2020  ort(.           
-00009400: 2020 2020 2020 2020 202a 2a76 616c 6964           **valid
-00009410: 6174 696f 6e5f 7265 706f 7274 2c20 696e  ation_report, in
-00009420: 6765 7374 696f 6e5f 7265 7375 6c74 3d69  gestion_result=i
-00009430: 6e67 6573 7469 6f6e 5f72 6573 756c 740a  ngestion_result.
-00009440: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009450: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
-00009460: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
-00009470: 6c69 6461 7469 6f6e 5f72 6570 6f72 742c  lidation_report,
-00009480: 2056 616c 6964 6174 696f 6e52 6570 6f72   ValidationRepor
-00009490: 7429 3a0a 2020 2020 2020 2020 2020 2020  t):.            
-000094a0: 2020 2020 7265 706f 7274 203d 2076 616c      report = val
-000094b0: 6964 6174 696f 6e5f 7265 706f 7274 0a20  idation_report. 
-000094c0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000094d0: 6620 696e 6765 7374 696f 6e5f 7265 7375  f ingestion_resu
-000094e0: 6c74 2021 3d20 2255 4e4b 4e4f 574e 223a  lt != "UNKNOWN":
-000094f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009500: 2020 2020 2072 6570 6f72 742e 696e 6765       report.inge
-00009510: 7374 696f 6e5f 7265 7375 6c74 203d 2069  stion_result = i
-00009520: 6e67 6573 7469 6f6e 5f72 6573 756c 740a  ngestion_result.
-00009530: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00009540: 7572 6e20 7365 6c66 2e5f 7661 6c69 6461  urn self._valida
-00009550: 7469 6f6e 5f72 6570 6f72 745f 656e 6769  tion_report_engi
-00009560: 6e65 2e73 6176 6528 0a20 2020 2020 2020  ne.save(.       
-00009570: 2020 2020 2020 2020 2076 616c 6964 6174           validat
-00009580: 696f 6e5f 7265 706f 7274 3d72 6570 6f72  ion_report=repor
-00009590: 742c 2067 655f 7479 7065 3d67 655f 7479  t, ge_type=ge_ty
-000095a0: 7065 0a20 2020 2020 2020 2020 2020 2029  pe.            )
-000095b0: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-000095c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000095d0: 2046 6561 7475 7265 5374 6f72 6545 7863   FeatureStoreExc
-000095e0: 6570 7469 6f6e 280a 2020 2020 2020 2020  eption(.        
-000095f0: 2020 2020 2020 2020 224f 6e6c 7920 4665          "Only Fe
-00009600: 6174 7572 6520 4772 6f75 7020 7265 6769  ature Group regi
-00009610: 7374 6572 6564 2077 6974 6820 486f 7073  stered with Hops
-00009620: 776f 726b 7320 6361 6e20 7570 6c6f 6164  works can upload
-00009630: 2076 616c 6964 6174 696f 6e20 7265 706f   validation repo
-00009640: 7274 732e 220a 2020 2020 2020 2020 2020  rts.".          
-00009650: 2020 290a 0a20 2020 2064 6566 2067 6574    )..    def get
-00009660: 5f76 616c 6964 6174 696f 6e5f 6869 7374  _validation_hist
-00009670: 6f72 7928 0a20 2020 2020 2020 2073 656c  ory(.        sel
-00009680: 662c 0a20 2020 2020 2020 2065 7870 6563  f,.        expec
-00009690: 7461 7469 6f6e 5f69 643a 2069 6e74 2c0a  tation_id: int,.
-000096a0: 2020 2020 2020 2020 7374 6172 745f 7661          start_va
-000096b0: 6c69 6461 7469 6f6e 5f74 696d 653a 2055  lidation_time: U
-000096c0: 6e69 6f6e 5b73 7472 2c20 696e 742c 2064  nion[str, int, d
-000096d0: 6174 6574 696d 652c 2064 6174 652c 204e  atetime, date, N
-000096e0: 6f6e 655d 203d 204e 6f6e 652c 0a20 2020  one] = None,.   
-000096f0: 2020 2020 2065 6e64 5f76 616c 6964 6174       end_validat
-00009700: 696f 6e5f 7469 6d65 3a20 556e 696f 6e5b  ion_time: Union[
-00009710: 7374 722c 2069 6e74 2c20 6461 7465 7469  str, int, dateti
-00009720: 6d65 2c20 6461 7465 2c20 4e6f 6e65 5d20  me, date, None] 
-00009730: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00009740: 6669 6c74 6572 5f62 793a 204c 6973 745b  filter_by: List[
-00009750: 7374 725d 203d 205b 5d2c 0a20 2020 2020  str] = [],.     
-00009760: 2020 2067 655f 7479 7065 3a20 626f 6f6c     ge_type: bool
-00009770: 203d 2054 7275 652c 0a20 2020 2029 202d   = True,.    ) -
-00009780: 3e20 556e 696f 6e5b 4c69 7374 5b56 616c  > Union[List[Val
-00009790: 6964 6174 696f 6e52 6573 756c 745d 2c20  idationResult], 
-000097a0: 4c69 7374 5b67 652e 636f 7265 2e45 7870  List[ge.core.Exp
-000097b0: 6563 7461 7469 6f6e 5661 6c69 6461 7469  ectationValidati
-000097c0: 6f6e 5265 7375 6c74 5d5d 3a0a 2020 2020  onResult]]:.    
-000097d0: 2020 2020 2222 2246 6574 6368 2076 616c      """Fetch val
-000097e0: 6964 6174 696f 6e20 6869 7374 6f72 7920  idation history 
-000097f0: 6f66 2061 6e20 4578 7065 6374 6174 696f  of an Expectatio
-00009800: 6e20 7370 6563 6966 6965 6420 6279 2069  n specified by i
-00009810: 7473 2069 642e 0a0a 2020 2020 2020 2020  ts id...        
-00009820: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
-00009830: 2020 2020 6060 6070 7974 686f 6e33 0a20      ```python3. 
-00009840: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
-00009850: 6e5f 6869 7374 6f72 7920 3d20 6667 2e67  n_history = fg.g
-00009860: 6574 5f76 616c 6964 6174 696f 6e5f 6869  et_validation_hi
-00009870: 7374 6f72 7928 0a20 2020 2020 2020 2020  story(.         
-00009880: 2020 2065 7870 6563 7461 7469 6f6e 5f69     expectation_i
-00009890: 643d 312c 0a20 2020 2020 2020 2020 2020  d=1,.           
-000098a0: 2066 696c 7465 725f 6279 3d5b 2252 454a   filter_by=["REJ
-000098b0: 4543 5445 4422 2c20 2255 4e4b 4e4f 574e  ECTED", "UNKNOWN
-000098c0: 225d 2c0a 2020 2020 2020 2020 2020 2020  "],.            
-000098d0: 7374 6172 745f 7661 6c69 6461 7469 6f6e  start_validation
-000098e0: 5f74 696d 653d 2232 3032 322d 3031 2d30  _time="2022-01-0
-000098f0: 3120 3030 3a30 303a 3030 222c 0a20 2020  1 00:00:00",.   
-00009900: 2020 2020 2020 2020 2065 6e64 5f76 616c           end_val
-00009910: 6964 6174 696f 6e5f 7469 6d65 3d64 6174  idation_time=dat
-00009920: 6574 696d 652e 6461 7465 7469 6d65 2e6e  etime.datetime.n
-00009930: 6f77 2829 2c0a 2020 2020 2020 2020 2020  ow(),.          
-00009940: 2020 6765 5f74 7970 653d 4661 6c73 650a    ge_type=False.
-00009950: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00009960: 2020 6060 600a 0a20 2020 2020 2020 2023    ```..        #
-00009970: 2041 7267 756d 656e 7473 0a20 2020 2020   Arguments.     
-00009980: 2020 2020 2020 2065 7870 6563 7461 7469         expectati
-00009990: 6f6e 5f69 643a 2069 6420 6f66 2074 6865  on_id: id of the
-000099a0: 2045 7870 6563 7461 7469 6f6e 2066 6f72   Expectation for
-000099b0: 2077 6869 6368 2074 6f20 6665 7463 6820   which to fetch 
-000099c0: 7468 6520 7661 6c69 6461 7469 6f6e 2068  the validation h
-000099d0: 6973 746f 7279 0a20 2020 2020 2020 2020  istory.         
-000099e0: 2020 2066 696c 7465 725f 6279 3a20 6c69     filter_by: li
-000099f0: 7374 206f 6620 696e 6765 7374 696f 6e5f  st of ingestion_
-00009a00: 7265 7375 6c74 2063 6174 6567 6f72 7920  result category 
-00009a10: 746f 206b 6565 702e 204f 6f70 7469 6f6e  to keep. Ooption
-00009a20: 7320 6172 6520 2249 4e47 4553 5445 4422  s are "INGESTED"
-00009a30: 2c20 2252 454a 4543 5445 4422 2c20 2246  , "REJECTED", "F
-00009a40: 475f 4441 5441 222c 2022 4558 5045 5249  G_DATA", "EXPERI
-00009a50: 4d45 4e54 222c 2022 554e 4b4e 4f57 4e22  MENT", "UNKNOWN"
-00009a60: 2e0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-00009a70: 6172 745f 7661 6c69 6461 7469 6f6e 5f74  art_validation_t
-00009a80: 696d 653a 2066 6574 6368 206f 6e6c 7920  ime: fetch only 
-00009a90: 7661 6c69 6461 7469 6f6e 2072 6573 756c  validation resul
-00009aa0: 7420 706f 7374 6572 696f 7220 746f 2074  t posterior to t
-00009ab0: 6865 2070 726f 7669 6465 6420 7469 6d65  he provided time
-00009ac0: 2c20 696e 636c 7573 6976 652e 0a20 2020  , inclusive..   
-00009ad0: 2020 2020 2020 2020 2053 7570 706f 7274           Support
-00009ae0: 6564 2066 6f72 6d61 7420 696e 636c 7564  ed format includ
-00009af0: 6520 7469 6d65 7374 616d 7073 2869 6e74  e timestamps(int
-00009b00: 292c 2064 6174 6574 696d 652c 2064 6174  ), datetime, dat
-00009b10: 6520 6f72 2073 7472 696e 6720 666f 726d  e or string form
-00009b20: 6174 7465 6420 746f 2062 6520 6461 7475  atted to be datu
-00009b30: 7469 6c73 2070 6172 7361 626c 652e 2053  tils parsable. S
-00009b40: 6565 2065 7861 6d70 6c65 7320 6162 6f76  ee examples abov
-00009b50: 652e 0a20 2020 2020 2020 2020 2020 2065  e..            e
-00009b60: 6e64 5f76 616c 6964 6174 696f 6e5f 7469  nd_validation_ti
-00009b70: 6d65 3a20 6665 7463 6820 6f6e 6c79 2076  me: fetch only v
-00009b80: 616c 6964 6174 696f 6e20 7265 7375 6c74  alidation result
-00009b90: 2070 7269 6f72 2074 6f20 7468 6520 7072   prior to the pr
-00009ba0: 6f76 6964 6564 2074 696d 652c 2069 6e63  ovided time, inc
-00009bb0: 6c75 7369 7665 2e0a 2020 2020 2020 2020  lusive..        
-00009bc0: 2020 2020 5375 7070 6f72 7465 6420 666f      Supported fo
-00009bd0: 726d 6174 2069 6e63 6c75 6465 2074 696d  rmat include tim
-00009be0: 6573 7461 6d70 7328 696e 7429 2c20 6461  estamps(int), da
-00009bf0: 7465 7469 6d65 2c20 6461 7465 206f 7220  tetime, date or 
-00009c00: 7374 7269 6e67 2066 6f72 6d61 7474 6564  string formatted
-00009c10: 2074 6f20 6265 2064 6174 7574 696c 7320   to be datutils 
-00009c20: 7061 7273 6162 6c65 2e20 5365 6520 6578  parsable. See ex
-00009c30: 616d 706c 6573 2061 626f 7665 2e0a 0a20  amples above... 
-00009c40: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
-00009c50: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-00009c60: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-00009c70: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
-00009c80: 602e 0a0a 2020 2020 2020 2020 2320 5265  `...        # Re
-00009c90: 7475 726e 0a20 2020 2020 2020 2020 2020  turn.           
-00009ca0: 2055 6e69 6f6e 5b4c 6973 745b 6056 616c   Union[List[`Val
-00009cb0: 6964 6174 696f 6e52 6573 756c 7460 5d2c  idationResult`],
-00009cc0: 204c 6973 745b 6045 7870 6563 7461 7469   List[`Expectati
-00009cd0: 6f6e 5661 6c69 6461 7469 6f6e 5265 7375  onValidationResu
-00009ce0: 6c74 605d 5d20 4120 6c69 7374 206f 6620  lt`]] A list of 
-00009cf0: 7661 6c69 6461 7469 6f6e 2072 6573 756c  validation resul
-00009d00: 7420 636f 6e6e 6563 7465 6420 746f 2074  t connected to t
-00009d10: 6865 2065 7870 6563 7461 7469 6f6e 5f69  he expectation_i
-00009d20: 640a 2020 2020 2020 2020 2222 220a 2020  d.        """.  
-00009d30: 2020 2020 2020 6d61 6a6f 722c 206d 696e        major, min
-00009d40: 6f72 203d 2073 656c 662e 5f76 6172 6961  or = self._varia
-00009d50: 626c 655f 6170 692e 7061 7273 655f 6d61  ble_api.parse_ma
-00009d60: 6a6f 725f 616e 645f 6d69 6e6f 7228 0a20  jor_and_minor(. 
-00009d70: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00009d80: 5f76 6172 6961 626c 655f 6170 692e 6765  _variable_api.ge
-00009d90: 745f 7665 7273 696f 6e28 2268 6f70 7377  t_version("hopsw
-00009da0: 6f72 6b73 2229 0a20 2020 2020 2020 2029  orks").        )
-00009db0: 0a20 2020 2020 2020 2069 6620 6d61 6a6f  .        if majo
-00009dc0: 7220 3d3d 2022 3322 2061 6e64 206d 696e  r == "3" and min
-00009dd0: 6f72 203d 3d20 2230 223a 0a20 2020 2020  or == "0":.     
-00009de0: 2020 2020 2020 2072 6169 7365 2046 6561         raise Fea
-00009df0: 7475 7265 5374 6f72 6545 7863 6570 7469  tureStoreExcepti
-00009e00: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
-00009e10: 2020 2020 2254 6865 2068 6f70 7377 6f72      "The hopswor
-00009e20: 6b73 2073 6572 7665 7220 646f 6573 206e  ks server does n
-00009e30: 6f74 2073 7570 706f 7274 2074 6869 7320  ot support this 
-00009e40: 6f70 6572 6174 696f 6e2e 2055 7064 6174  operation. Updat
-00009e50: 6520 7365 7276 6572 2074 6f20 686f 7073  e server to hops
-00009e60: 776f 726b 7320 3e33 2e31 2074 6f20 656e  works >3.1 to en
-00009e70: 6162 6c65 2073 7570 706f 7274 2e22 0a20  able support.". 
-00009e80: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-00009e90: 2020 2020 2020 6966 2073 656c 662e 5f69        if self._i
-00009ea0: 643a 0a20 2020 2020 2020 2020 2020 2072  d:.            r
-00009eb0: 6574 7572 6e20 7365 6c66 2e5f 7661 6c69  eturn self._vali
-00009ec0: 6461 7469 6f6e 5f72 6573 756c 745f 656e  dation_result_en
-00009ed0: 6769 6e65 2e67 6574 5f76 616c 6964 6174  gine.get_validat
-00009ee0: 696f 6e5f 6869 7374 6f72 7928 0a20 2020  ion_history(.   
-00009ef0: 2020 2020 2020 2020 2020 2020 2065 7870               exp
-00009f00: 6563 7461 7469 6f6e 5f69 643d 6578 7065  ectation_id=expe
-00009f10: 6374 6174 696f 6e5f 6964 2c0a 2020 2020  ctation_id,.    
-00009f20: 2020 2020 2020 2020 2020 2020 7374 6172              star
-00009f30: 745f 7661 6c69 6461 7469 6f6e 5f74 696d  t_validation_tim
-00009f40: 653d 7374 6172 745f 7661 6c69 6461 7469  e=start_validati
-00009f50: 6f6e 5f74 696d 652c 0a20 2020 2020 2020  on_time,.       
-00009f60: 2020 2020 2020 2020 2065 6e64 5f76 616c           end_val
-00009f70: 6964 6174 696f 6e5f 7469 6d65 3d65 6e64  idation_time=end
-00009f80: 5f76 616c 6964 6174 696f 6e5f 7469 6d65  _validation_time
-00009f90: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00009fa0: 2020 6669 6c74 6572 5f62 793d 6669 6c74    filter_by=filt
-00009fb0: 6572 5f62 792c 0a20 2020 2020 2020 2020  er_by,.         
-00009fc0: 2020 2020 2020 2067 655f 7479 7065 3d67         ge_type=g
-00009fd0: 655f 7479 7065 2c0a 2020 2020 2020 2020  e_type,.        
-00009fe0: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-00009ff0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000a000: 7261 6973 6520 4665 6174 7572 6553 746f  raise FeatureSto
-0000a010: 7265 4578 6365 7074 696f 6e28 0a20 2020  reException(.   
-0000a020: 2020 2020 2020 2020 2020 2020 2022 4f6e               "On
-0000a030: 6c79 2046 6561 7475 7265 2047 726f 7570  ly Feature Group
-0000a040: 2072 6567 6973 7465 7265 6420 7769 7468   registered with
-0000a050: 2048 6f70 7377 6f72 6b73 2063 616e 2066   Hopsworks can f
-0000a060: 6574 6368 2076 616c 6964 6174 696f 6e20  etch validation 
-0000a070: 6869 7374 6f72 792e 220a 2020 2020 2020  history.".      
-0000a080: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0000a090: 2076 616c 6964 6174 6528 0a20 2020 2020   validate(.     
-0000a0a0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000a0b0: 2064 6174 6166 7261 6d65 3a20 4f70 7469   dataframe: Opti
-0000a0c0: 6f6e 616c 5b0a 2020 2020 2020 2020 2020  onal[.          
-0000a0d0: 2020 556e 696f 6e5b 7064 2e44 6174 6146    Union[pd.DataF
-0000a0e0: 7261 6d65 2c20 5479 7065 5661 7228 2270  rame, TypeVar("p
-0000a0f0: 7973 7061 726b 2e73 716c 2e44 6174 6146  yspark.sql.DataF
-0000a100: 7261 6d65 2229 5d20 2023 206e 6f71 613a  rame")]  # noqa:
-0000a110: 2046 3832 310a 2020 2020 2020 2020 5d20   F821.        ] 
-0000a120: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000a130: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-0000a140: 653a 204f 7074 696f 6e61 6c5b 4578 7065  e: Optional[Expe
-0000a150: 6374 6174 696f 6e53 7569 7465 5d20 3d20  ctationSuite] = 
-0000a160: 4e6f 6e65 2c0a 2020 2020 2020 2020 7361  None,.        sa
-0000a170: 7665 5f72 6570 6f72 743a 204f 7074 696f  ve_report: Optio
-0000a180: 6e61 6c5b 626f 6f6c 5d20 3d20 4661 6c73  nal[bool] = Fals
-0000a190: 652c 0a20 2020 2020 2020 2076 616c 6964  e,.        valid
-0000a1a0: 6174 696f 6e5f 6f70 7469 6f6e 733a 204f  ation_options: O
-0000a1b0: 7074 696f 6e61 6c5b 4469 6374 5b41 6e79  ptional[Dict[Any
-0000a1c0: 2c20 416e 795d 5d20 3d20 7b7d 2c0a 2020  , Any]] = {},.  
-0000a1d0: 2020 2020 2020 696e 6765 7374 696f 6e5f        ingestion_
-0000a1e0: 7265 7375 6c74 3a20 7374 7220 3d20 2255  result: str = "U
-0000a1f0: 4e4b 4e4f 574e 222c 0a20 2020 2020 2020  NKNOWN",.       
-0000a200: 2067 655f 7479 7065 3a20 626f 6f6c 203d   ge_type: bool =
-0000a210: 2054 7275 652c 0a20 2020 2029 202d 3e20   True,.    ) -> 
-0000a220: 556e 696f 6e5b 6765 2e63 6f72 652e 4578  Union[ge.core.Ex
-0000a230: 7065 6374 6174 696f 6e53 7569 7465 5661  pectationSuiteVa
-0000a240: 6c69 6461 7469 6f6e 5265 7375 6c74 2c20  lidationResult, 
-0000a250: 5661 6c69 6461 7469 6f6e 5265 706f 7274  ValidationReport
-0000a260: 2c20 4e6f 6e65 5d3a 0a20 2020 2020 2020  , None]:.       
-0000a270: 2022 2222 5275 6e20 7661 6c69 6461 7469   """Run validati
-0000a280: 6f6e 2062 6173 6564 206f 6e20 7468 6520  on based on the 
-0000a290: 6174 7461 6368 6564 2065 7870 6563 7461  attached expecta
-0000a2a0: 7469 6f6e 732e 0a0a 2020 2020 2020 2020  tions...        
-0000a2b0: 5275 6e73 2061 6e79 2065 7870 6563 7461  Runs any expecta
-0000a2c0: 7469 6f6e 2061 7474 6163 6865 6420 7769  tion attached wi
-0000a2d0: 7468 2044 6565 7175 2e20 4275 7420 616c  th Deequ. But al
-0000a2e0: 736f 2072 756e 7320 6174 7461 6368 6564  so runs attached
-0000a2f0: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
-0000a300: 6f6e 0a20 2020 2020 2020 2053 7569 7465  on.        Suite
-0000a310: 732e 0a0a 2020 2020 2020 2020 2121 2120  s...        !!! 
-0000a320: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
-0000a330: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-0000a340: 2020 2020 2020 2020 2020 2320 636f 6e6e            # conn
-0000a350: 6563 7420 746f 2074 6865 2046 6561 7475  ect to the Featu
-0000a360: 7265 2053 746f 7265 0a20 2020 2020 2020  re Store.       
-0000a370: 2020 2020 2066 7320 3d20 2e2e 2e0a 0a20       fs = ..... 
-0000a380: 2020 2020 2020 2020 2020 2023 2067 6574             # get
-0000a390: 2066 6561 7475 7265 2067 726f 7570 2069   feature group i
-0000a3a0: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
-0000a3b0: 2020 2020 6667 203d 2066 732e 6765 745f      fg = fs.get_
-0000a3c0: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
-0000a3d0: 655f 6772 6f75 7028 2e2e 2e29 0a0a 2020  e_group(...)..  
-0000a3e0: 2020 2020 2020 2020 2020 6765 5f72 6570            ge_rep
-0000a3f0: 6f72 7420 3d20 6667 2e76 616c 6964 6174  ort = fg.validat
-0000a400: 6528 6466 2c20 7361 7665 5f72 6570 6f72  e(df, save_repor
-0000a410: 743d 4661 6c73 6529 0a20 2020 2020 2020  t=False).       
-0000a420: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-0000a430: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-0000a440: 2020 2020 2020 2020 2020 6461 7461 6672            datafr
-0000a450: 616d 653a 2054 6865 2064 6174 6166 7261  ame: The datafra
-0000a460: 6d65 2074 6f20 7275 6e20 7468 6520 6461  me to run the da
-0000a470: 7461 2076 616c 6964 6174 696f 6e20 6578  ta validation ex
-0000a480: 7065 6374 6174 696f 6e73 2061 6761 696e  pectations again
-0000a490: 7374 2e0a 2020 2020 2020 2020 2020 2020  st..            
-0000a4a0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-0000a4b0: 653a 204f 7074 696f 6e61 6c6c 7920 7072  e: Optionally pr
-0000a4c0: 6f76 6964 6520 616e 2045 7870 6563 7461  ovide an Expecta
-0000a4d0: 7469 6f6e 2053 7569 7465 2074 6f20 6f76  tion Suite to ov
-0000a4e0: 6572 7269 6465 2074 6865 0a20 2020 2020  erride the.     
-0000a4f0: 2020 2020 2020 2020 2020 206f 6e65 2074             one t
-0000a500: 6861 7420 6973 2070 6f73 7369 626c 7920  hat is possibly 
-0000a510: 6174 7461 6368 6564 2074 6f20 7468 6520  attached to the 
-0000a520: 6665 6174 7572 6520 6772 6f75 702e 2054  feature group. T
-0000a530: 6869 7320 6973 2075 7365 6675 6c20 666f  his is useful fo
-0000a540: 720a 2020 2020 2020 2020 2020 2020 2020  r.              
-0000a550: 2020 7465 7374 696e 6720 6e65 7720 4578    testing new Ex
-0000a560: 7065 6374 6174 696f 6e20 7375 6974 6573  pectation suites
-0000a570: 2e20 5768 656e 2061 6e20 6578 7472 6120  . When an extra 
-0000a580: 7375 6974 6520 6973 2070 726f 7669 6465  suite is provide
-0000a590: 642c 2074 6865 2072 6573 756c 7473 0a20  d, the results. 
-0000a5a0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
-0000a5b0: 696c 6c20 6e65 7665 7220 6265 2070 6572  ill never be per
-0000a5c0: 7369 7374 6564 2e20 4465 6661 756c 7473  sisted. Defaults
-0000a5d0: 2074 6f20 604e 6f6e 6560 2e0a 2020 2020   to `None`..    
-0000a5e0: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
-0000a5f0: 6f6e 5f6f 7074 696f 6e73 3a20 4164 6469  on_options: Addi
-0000a600: 7469 6f6e 616c 2076 616c 6964 6174 696f  tional validatio
-0000a610: 6e20 6f70 7469 6f6e 7320 6173 206b 6579  n options as key
-0000a620: 2d76 616c 7565 2070 6169 7273 2c20 6465  -value pairs, de
-0000a630: 6661 756c 7473 2074 6f20 607b 7d60 2e0a  faults to `{}`..
-0000a640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a650: 2a20 6b65 7920 6072 756e 5f76 616c 6964  * key `run_valid
-0000a660: 6174 696f 6e60 2062 6f6f 6c65 616e 2076  ation` boolean v
-0000a670: 616c 7565 2c20 7365 7420 746f 2060 4661  alue, set to `Fa
-0000a680: 6c73 6560 2074 6f20 736b 6970 2076 616c  lse` to skip val
-0000a690: 6964 6174 696f 6e20 7465 6d70 6f72 6172  idation temporar
-0000a6a0: 696c 7920 6f6e 2069 6e67 6573 7469 6f6e  ily on ingestion
-0000a6b0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000a6c0: 2020 2a20 6b65 7920 6067 655f 7661 6c69    * key `ge_vali
-0000a6d0: 6461 7465 5f6b 7761 7267 7360 2061 2064  date_kwargs` a d
-0000a6e0: 6963 7469 6f6e 6172 7920 636f 6e74 6169  ictionary contai
-0000a6f0: 6e69 6e67 206b 7761 7267 7320 666f 7220  ning kwargs for 
-0000a700: 7468 6520 7661 6c69 6461 7465 206d 6574  the validate met
-0000a710: 686f 6420 6f66 2047 7265 6174 2045 7870  hod of Great Exp
-0000a720: 6563 7461 7469 6f6e 732e 0a20 2020 2020  ectations..     
-0000a730: 2020 2020 2020 2069 6e67 6573 7469 6f6e         ingestion
-0000a740: 5f72 6573 756c 743a 2053 7065 6369 6679  _result: Specify
-0000a750: 2074 6865 2066 6174 6520 6f66 2074 6865   the fate of the
-0000a760: 2061 7373 6f63 6961 7465 6420 6461 7461   associated data
-0000a770: 2c20 6465 6661 756c 7473 0a20 2020 2020  , defaults.     
-0000a780: 2020 2020 2020 2020 2020 2074 6f20 2255             to "U
-0000a790: 4e4b 4e4f 574e 222e 2053 7570 706f 7274  NKNOWN". Support
-0000a7a0: 6564 206f 7074 696f 6e73 2061 7265 2020  ed options are  
-0000a7b0: 2255 4e4b 4e4f 574e 222c 2022 494e 4745  "UNKNOWN", "INGE
-0000a7c0: 5354 4544 222c 2022 5245 4a45 4354 4544  STED", "REJECTED
-0000a7d0: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0000a7e0: 2020 2022 4558 5045 5249 4d45 4e54 222c     "EXPERIMENT",
-0000a7f0: 2022 4647 5f44 4154 4122 2e20 5573 6520   "FG_DATA". Use 
-0000a800: 2249 4e47 4553 5445 4422 206f 7220 2252  "INGESTED" or "R
-0000a810: 454a 4543 5445 4422 2066 6f72 2076 616c  EJECTED" for val
-0000a820: 6964 6174 696f 6e0a 2020 2020 2020 2020  idation.        
-0000a830: 2020 2020 2020 2020 6f66 2044 6174 6146          of DataF
-0000a840: 7261 6d65 7320 746f 2062 6520 696e 7365  rames to be inse
-0000a850: 7274 6564 2069 6e20 7468 6520 4665 6174  rted in the Feat
-0000a860: 7572 6520 4772 6f75 702e 2055 7365 2022  ure Group. Use "
-0000a870: 4558 5045 5249 4d45 4e54 220a 2020 2020  EXPERIMENT".    
-0000a880: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-0000a890: 7465 7374 696e 6720 616e 6420 6465 7665  testing and deve
-0000a8a0: 6c6f 706d 656e 7420 616e 6420 2246 475f  lopment and "FG_
-0000a8b0: 4441 5441 2220 7768 656e 2076 616c 6964  DATA" when valid
-0000a8c0: 6174 696e 6720 6461 7461 0a20 2020 2020  ating data.     
-0000a8d0: 2020 2020 2020 2020 2020 2061 6c72 6561             alrea
-0000a8e0: 6479 2069 6e20 7468 6520 4665 6174 7572  dy in the Featur
-0000a8f0: 6520 4772 6f75 702e 0a20 2020 2020 2020  e Group..       
-0000a900: 2020 2020 2073 6176 655f 7265 706f 7274       save_report
-0000a910: 3a20 5768 6574 6865 7220 746f 2073 6176  : Whether to sav
-0000a920: 6520 7468 6520 7265 706f 7274 2074 6f20  e the report to 
-0000a930: 7468 6520 6261 636b 656e 642e 2054 6869  the backend. Thi
-0000a940: 7320 6973 206f 6e6c 7920 706f 7373 6962  s is only possib
-0000a950: 6c65 2069 6620 7468 6520 4578 7065 6374  le if the Expect
-0000a960: 6174 696f 6e20 7375 6974 650a 2020 2020  ation suite.    
-0000a970: 2020 2020 2020 2020 2020 2020 6973 2069              is i
-0000a980: 6e69 7469 616c 6973 6564 2061 6e64 2061  nitialised and a
-0000a990: 7474 6163 6865 6420 746f 2074 6865 2046  ttached to the F
-0000a9a0: 6561 7475 7265 2047 726f 7570 2e20 4465  eature Group. De
-0000a9b0: 6661 756c 7473 2074 6f20 4661 6c73 652e  faults to False.
-0000a9c0: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
-0000a9d0: 7479 7065 3a20 5768 6574 6865 7220 746f  type: Whether to
-0000a9e0: 2072 6574 7572 6e20 6120 4772 6561 7420   return a Great 
-0000a9f0: 4578 7065 6374 6174 696f 6e73 206f 626a  Expectations obj
-0000aa00: 6563 7420 6f72 2048 6f70 7377 6f72 6b73  ect or Hopsworks
-0000aa10: 206f 776e 2061 6273 7472 6163 7469 6f6e   own abstraction
-0000aa20: 2e20 4465 6661 756c 7473 2074 6f20 5472  . Defaults to Tr
-0000aa30: 7565 2e0a 0a20 2020 2020 2020 2023 2052  ue...        # R
-0000aa40: 6574 7572 6e73 0a20 2020 2020 2020 2020  eturns.         
-0000aa50: 2020 2041 2056 616c 6964 6174 696f 6e20     A Validation 
-0000aa60: 5265 706f 7274 2070 726f 6475 6365 6420  Report produced 
-0000aa70: 6279 2047 7265 6174 2045 7870 6563 7461  by Great Expecta
-0000aa80: 7469 6f6e 732e 0a20 2020 2020 2020 2022  tions..        "
-0000aa90: 2222 0a20 2020 2020 2020 2023 2041 6374  "".        # Act
-0000aaa0: 6976 6974 7920 6973 206c 6f67 6765 6420  ivity is logged 
-0000aab0: 6f6e 6c79 2069 6620 6120 7468 6520 7661  only if a the va
-0000aac0: 6c69 6461 7469 6f6e 2063 6f6e 6365 726e  lidation concern
-0000aad0: 7320 7468 6520 6665 6174 7572 6520 6772  s the feature gr
-0000aae0: 6f75 7020 616e 6420 6e6f 7420 6120 7370  oup and not a sp
-0000aaf0: 6563 6966 6963 2064 6174 6166 7261 6d65  ecific dataframe
-0000ab00: 0a20 2020 2020 2020 2069 6620 6461 7461  .        if data
-0000ab10: 6672 616d 6520 6973 204e 6f6e 653a 0a20  frame is None:. 
-0000ab20: 2020 2020 2020 2020 2020 2064 6174 6166             dataf
-0000ab30: 7261 6d65 203d 2073 656c 662e 7265 6164  rame = self.read
-0000ab40: 2829 0a20 2020 2020 2020 2020 2020 2069  ().            i
-0000ab50: 6620 696e 6765 7374 696f 6e5f 7265 7375  f ingestion_resu
-0000ab60: 6c74 203d 3d20 2255 4e4b 4e4f 574e 223a  lt == "UNKNOWN":
-0000ab70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ab80: 2069 6e67 6573 7469 6f6e 5f72 6573 756c   ingestion_resul
-0000ab90: 7420 3d20 2246 475f 4441 5441 220a 0a20  t = "FG_DATA".. 
-0000aba0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000abb0: 6c66 2e5f 6772 6561 745f 6578 7065 6374  lf._great_expect
-0000abc0: 6174 696f 6e5f 656e 6769 6e65 2e76 616c  ation_engine.val
-0000abd0: 6964 6174 6528 0a20 2020 2020 2020 2020  idate(.         
-0000abe0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0000abf0: 2020 2020 2064 6174 6166 7261 6d65 3d65       dataframe=e
-0000ac00: 6e67 696e 652e 6765 745f 696e 7374 616e  ngine.get_instan
-0000ac10: 6365 2829 2e63 6f6e 7665 7274 5f74 6f5f  ce().convert_to_
-0000ac20: 6465 6661 756c 745f 6461 7461 6672 616d  default_datafram
-0000ac30: 6528 6461 7461 6672 616d 6529 2c0a 2020  e(dataframe),.  
-0000ac40: 2020 2020 2020 2020 2020 6578 7065 6374            expect
-0000ac50: 6174 696f 6e5f 7375 6974 653d 6578 7065  ation_suite=expe
-0000ac60: 6374 6174 696f 6e5f 7375 6974 652c 0a20  ctation_suite,. 
-0000ac70: 2020 2020 2020 2020 2020 2073 6176 655f             save_
-0000ac80: 7265 706f 7274 3d73 6176 655f 7265 706f  report=save_repo
-0000ac90: 7274 2c0a 2020 2020 2020 2020 2020 2020  rt,.            
-0000aca0: 7661 6c69 6461 7469 6f6e 5f6f 7074 696f  validation_optio
-0000acb0: 6e73 3d76 616c 6964 6174 696f 6e5f 6f70  ns=validation_op
-0000acc0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
-0000acd0: 2020 2069 6e67 6573 7469 6f6e 5f72 6573     ingestion_res
-0000ace0: 756c 743d 696e 6765 7374 696f 6e5f 7265  ult=ingestion_re
-0000acf0: 7375 6c74 2c0a 2020 2020 2020 2020 2020  sult,.          
-0000ad00: 2020 6765 5f74 7970 653d 6765 5f74 7970    ge_type=ge_typ
-0000ad10: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-0000ad20: 2020 4063 6c61 7373 6d65 7468 6f64 0a20    @classmethod. 
-0000ad30: 2020 2064 6566 2066 726f 6d5f 7265 7370     def from_resp
-0000ad40: 6f6e 7365 5f6a 736f 6e28 636c 732c 2066  onse_json(cls, f
-0000ad50: 6561 7475 7265 5f67 726f 7570 5f6a 736f  eature_group_jso
-0000ad60: 6e29 3a0a 2020 2020 2020 2020 6966 2028  n):.        if (
-0000ad70: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
-0000ad80: 7475 7265 5f67 726f 7570 5f6a 736f 6e5b  ture_group_json[
-0000ad90: 2274 7970 6522 5d20 3d3d 2022 6f6e 4465  "type"] == "onDe
-0000ada0: 6d61 6e64 4665 6174 7572 6567 726f 7570  mandFeaturegroup
-0000adb0: 4454 4f22 0a20 2020 2020 2020 2020 2020  DTO".           
-0000adc0: 2061 6e64 206e 6f74 2066 6561 7475 7265   and not feature
-0000add0: 5f67 726f 7570 5f6a 736f 6e5b 2273 7069  _group_json["spi
-0000ade0: 6e65 225d 0a20 2020 2020 2020 2029 3a0a  ne"].        ):.
-0000adf0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-0000ae00: 7572 655f 6772 6f75 705f 6f62 6a20 3d20  ure_group_obj = 
-0000ae10: 4578 7465 726e 616c 4665 6174 7572 6547  ExternalFeatureG
-0000ae20: 726f 7570 2e66 726f 6d5f 7265 7370 6f6e  roup.from_respon
-0000ae30: 7365 5f6a 736f 6e28 0a20 2020 2020 2020  se_json(.       
-0000ae40: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0000ae50: 5f67 726f 7570 5f6a 736f 6e0a 2020 2020  _group_json.    
-0000ae60: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000ae70: 2020 656c 6966 2028 0a20 2020 2020 2020    elif (.       
-0000ae80: 2020 2020 2066 6561 7475 7265 5f67 726f       feature_gro
-0000ae90: 7570 5f6a 736f 6e5b 2274 7970 6522 5d20  up_json["type"] 
-0000aea0: 3d3d 2022 6f6e 4465 6d61 6e64 4665 6174  == "onDemandFeat
-0000aeb0: 7572 6567 726f 7570 4454 4f22 0a20 2020  uregroupDTO".   
-0000aec0: 2020 2020 2020 2020 2061 6e64 2066 6561           and fea
-0000aed0: 7475 7265 5f67 726f 7570 5f6a 736f 6e5b  ture_group_json[
-0000aee0: 2273 7069 6e65 225d 0a20 2020 2020 2020  "spine"].       
-0000aef0: 2029 3a0a 2020 2020 2020 2020 2020 2020   ):.            
-0000af00: 6665 6174 7572 655f 6772 6f75 705f 6f62  feature_group_ob
-0000af10: 6a20 3d20 5370 696e 6547 726f 7570 2e66  j = SpineGroup.f
-0000af20: 726f 6d5f 7265 7370 6f6e 7365 5f6a 736f  rom_response_jso
-0000af30: 6e28 6665 6174 7572 655f 6772 6f75 705f  n(feature_group_
-0000af40: 6a73 6f6e 290a 2020 2020 2020 2020 656c  json).        el
-0000af50: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-0000af60: 6665 6174 7572 655f 6772 6f75 705f 6f62  feature_group_ob
-0000af70: 6a20 3d20 4665 6174 7572 6547 726f 7570  j = FeatureGroup
-0000af80: 2e66 726f 6d5f 7265 7370 6f6e 7365 5f6a  .from_response_j
-0000af90: 736f 6e28 6665 6174 7572 655f 6772 6f75  son(feature_grou
-0000afa0: 705f 6a73 6f6e 290a 2020 2020 2020 2020  p_json).        
-0000afb0: 7265 7475 726e 2066 6561 7475 7265 5f67  return feature_g
-0000afc0: 726f 7570 5f6f 626a 0a0a 2020 2020 6465  roup_obj..    de
-0000afd0: 6620 6765 745f 6665 6174 7572 655f 6d6f  f get_feature_mo
-0000afe0: 6e69 746f 7269 6e67 5f63 6f6e 6669 6773  nitoring_configs
-0000aff0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000b000: 2020 2020 2020 2020 6e61 6d65 3a20 4f70          name: Op
-0000b010: 7469 6f6e 616c 5b73 7472 5d20 3d20 4e6f  tional[str] = No
-0000b020: 6e65 2c0a 2020 2020 2020 2020 6665 6174  ne,.        feat
-0000b030: 7572 655f 6e61 6d65 3a20 4f70 7469 6f6e  ure_name: Option
-0000b040: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000b050: 2020 2020 2020 2020 636f 6e66 6967 5f69          config_i
-0000b060: 643a 204f 7074 696f 6e61 6c5b 696e 745d  d: Optional[int]
-0000b070: 203d 204e 6f6e 652c 0a20 2020 2029 202d   = None,.    ) -
-0000b080: 3e20 556e 696f 6e5b 0a20 2020 2020 2020  > Union[.       
-0000b090: 2022 666d 632e 4665 6174 7572 654d 6f6e   "fmc.FeatureMon
-0000b0a0: 6974 6f72 696e 6743 6f6e 6669 6722 2c20  itoringConfig", 
-0000b0b0: 4c69 7374 5b22 666d 632e 4665 6174 7572  List["fmc.Featur
-0000b0c0: 654d 6f6e 6974 6f72 696e 6743 6f6e 6669  eMonitoringConfi
-0000b0d0: 6722 5d2c 204e 6f6e 650a 2020 2020 5d3a  g"], None.    ]:
-0000b0e0: 0a20 2020 2020 2020 2022 2222 4665 7463  .        """Fetc
-0000b0f0: 6820 616c 6c20 6665 6174 7572 6520 6d6f  h all feature mo
-0000b100: 6e69 746f 7269 6e67 2063 6f6e 6669 6773  nitoring configs
-0000b110: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
-0000b120: 2066 6561 7475 7265 2067 726f 7570 2c20   feature group, 
-0000b130: 6f72 2066 6574 6368 2062 7920 6e61 6d65  or fetch by name
-0000b140: 206f 7220 6665 6174 7572 6520 6e61 6d65   or feature name
-0000b150: 206f 6e6c 792e 0a20 2020 2020 2020 2049   only..        I
-0000b160: 6620 6e6f 2061 7267 756d 656e 7473 2069  f no arguments i
-0000b170: 7320 7072 6f76 6964 6564 2074 6865 206d  s provided the m
-0000b180: 6574 686f 6420 7769 6c6c 2072 6574 7572  ethod will retur
-0000b190: 6e20 616c 6c20 6665 6174 7572 6520 6d6f  n all feature mo
-0000b1a0: 6e69 746f 7269 6e67 2063 6f6e 6669 6773  nitoring configs
-0000b1b0: 0a20 2020 2020 2020 2061 7474 6163 6865  .        attache
-0000b1c0: 6420 746f 2074 6865 2066 6561 7475 7265  d to the feature
-0000b1d0: 2067 726f 7570 2c20 6d65 616e 696e 6720   group, meaning 
-0000b1e0: 616c 6c20 6665 6174 7572 6520 6d6f 6e69  all feature moni
-0000b1f0: 746f 7269 6e67 2063 6f6e 6669 6773 2074  toring configs t
-0000b200: 6861 7420 6172 6520 6174 7461 6368 0a20  hat are attach. 
-0000b210: 2020 2020 2020 2074 6f20 6120 6665 6174         to a feat
-0000b220: 7572 6520 696e 2074 6865 2066 6561 7475  ure in the featu
-0000b230: 7265 2067 726f 7570 2e20 4966 2079 6f75  re group. If you
-0000b240: 2077 6973 6820 746f 2066 6574 6368 2061   wish to fetch a
-0000b250: 2073 696e 676c 6520 636f 6e66 6967 2c20   single config, 
-0000b260: 7072 6f76 6964 6520 7468 650a 2020 2020  provide the.    
-0000b270: 2020 2020 6974 7320 6e61 6d65 2e20 4966      its name. If
-0000b280: 2079 6f75 2077 6973 6820 746f 2066 6574   you wish to fet
-0000b290: 6368 2061 6c6c 2063 6f6e 6669 6773 2061  ch all configs a
-0000b2a0: 7474 6163 6865 6420 746f 2061 2070 6172  ttached to a par
-0000b2b0: 7469 6375 6c61 7220 6665 6174 7572 652c  ticular feature,
-0000b2c0: 2070 726f 7669 6465 0a20 2020 2020 2020   provide.       
-0000b2d0: 2074 6865 2066 6561 7475 7265 206e 616d   the feature nam
-0000b2e0: 652e 0a20 2020 2020 2020 2021 2121 2065  e..        !!! e
-0000b2f0: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
-0000b300: 2020 2060 6060 7079 7468 6f6e 330a 2020     ```python3.  
-0000b310: 2020 2020 2020 2020 2020 2320 6665 7463            # fetc
-0000b320: 6820 796f 7572 2066 6561 7475 7265 2067  h your feature g
-0000b330: 726f 7570 0a20 2020 2020 2020 2020 2020  roup.           
-0000b340: 2066 6720 3d20 6673 2e67 6574 5f66 6561   fg = fs.get_fea
-0000b350: 7475 7265 5f67 726f 7570 286e 616d 653d  ture_group(name=
-0000b360: 226d 795f 6665 6174 7572 655f 6772 6f75  "my_feature_grou
-0000b370: 7022 2c20 7665 7273 696f 6e3d 3129 0a20  p", version=1). 
-0000b380: 2020 2020 2020 2020 2020 2023 2066 6574             # fet
-0000b390: 6368 2061 6c6c 2066 6561 7475 7265 206d  ch all feature m
-0000b3a0: 6f6e 6974 6f72 696e 6720 636f 6e66 6967  onitoring config
-0000b3b0: 7320 6174 7461 6368 6564 2074 6f20 7468  s attached to th
-0000b3c0: 6520 6665 6174 7572 6520 6772 6f75 700a  e feature group.
-0000b3d0: 2020 2020 2020 2020 2020 2020 666d 5f63              fm_c
-0000b3e0: 6f6e 6669 6773 203d 2066 672e 6765 745f  onfigs = fg.get_
-0000b3f0: 6665 6174 7572 655f 6d6f 6e69 746f 7269  feature_monitori
-0000b400: 6e67 5f63 6f6e 6669 6773 2829 0a20 2020  ng_configs().   
-0000b410: 2020 2020 2020 2020 2023 2066 6574 6368           # fetch
-0000b420: 2061 2073 696e 676c 6520 6665 6174 7572   a single featur
-0000b430: 6520 6d6f 6e69 746f 7269 6e67 2063 6f6e  e monitoring con
-0000b440: 6669 6720 6279 206e 616d 650a 2020 2020  fig by name.    
-0000b450: 2020 2020 2020 2020 666d 5f63 6f6e 6669          fm_confi
-0000b460: 6720 3d20 6667 2e67 6574 5f66 6561 7475  g = fg.get_featu
-0000b470: 7265 5f6d 6f6e 6974 6f72 696e 675f 636f  re_monitoring_co
-0000b480: 6e66 6967 7328 6e61 6d65 3d22 6d79 5f63  nfigs(name="my_c
-0000b490: 6f6e 6669 6722 290a 2020 2020 2020 2020  onfig").        
-0000b4a0: 2020 2020 2320 6665 7463 6820 616c 6c20      # fetch all 
-0000b4b0: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
-0000b4c0: 6e67 2063 6f6e 6669 6773 2061 7474 6163  ng configs attac
-0000b4d0: 6865 6420 746f 2061 2070 6172 7469 6375  hed to a particu
-0000b4e0: 6c61 7220 6665 6174 7572 650a 2020 2020  lar feature.    
-0000b4f0: 2020 2020 2020 2020 666d 5f63 6f6e 6669          fm_confi
-0000b500: 6773 203d 2066 672e 6765 745f 6665 6174  gs = fg.get_feat
-0000b510: 7572 655f 6d6f 6e69 746f 7269 6e67 5f63  ure_monitoring_c
-0000b520: 6f6e 6669 6773 2866 6561 7475 7265 5f6e  onfigs(feature_n
-0000b530: 616d 653d 226d 795f 6665 6174 7572 6522  ame="my_feature"
-0000b540: 290a 2020 2020 2020 2020 2020 2020 2320  ).            # 
-0000b550: 6665 7463 6820 6120 7369 6e67 6c65 2066  fetch a single f
-0000b560: 6561 7475 7265 206d 6f6e 6974 6f72 696e  eature monitorin
-0000b570: 6720 636f 6e66 6967 2077 6974 6820 6120  g config with a 
-0000b580: 6769 7665 6e20 6964 0a20 2020 2020 2020  given id.       
-0000b590: 2020 2020 2066 6d5f 636f 6e66 6967 203d       fm_config =
-0000b5a0: 2066 672e 6765 745f 6665 6174 7572 655f   fg.get_feature_
-0000b5b0: 6d6f 6e69 746f 7269 6e67 5f63 6f6e 6669  monitoring_confi
-0000b5c0: 6773 2863 6f6e 6669 675f 6964 3d31 290a  gs(config_id=1).
-0000b5d0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-0000b5e0: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
-0000b5f0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-0000b600: 6e61 6d65 3a20 4966 2070 726f 7669 6465  name: If provide
-0000b610: 6420 6665 7463 6820 6f6e 6c79 2074 6865  d fetch only the
-0000b620: 2066 6561 7475 7265 206d 6f6e 6974 6f72   feature monitor
-0000b630: 696e 6720 636f 6e66 6967 2077 6974 6820  ing config with 
-0000b640: 7468 6520 6769 7665 6e20 6e61 6d65 2e0a  the given name..
-0000b650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b660: 4465 6661 756c 7473 2074 6f20 4e6f 6e65  Defaults to None
-0000b670: 2e0a 2020 2020 2020 2020 2020 2020 6665  ..            fe
-0000b680: 6174 7572 655f 6e61 6d65 3a20 4966 2070  ature_name: If p
-0000b690: 726f 7669 6465 642c 2066 6574 6368 206f  rovided, fetch o
-0000b6a0: 6e6c 7920 636f 6e66 6967 7320 6174 7461  nly configs atta
-0000b6b0: 6368 6564 2074 6f20 6120 7061 7274 6963  ched to a partic
-0000b6c0: 756c 6172 2066 6561 7475 7265 2e0a 2020  ular feature..  
-0000b6d0: 2020 2020 2020 2020 2020 2020 2020 4465                De
-0000b6e0: 6661 756c 7473 2074 6f20 4e6f 6e65 2e0a  faults to None..
-0000b6f0: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
-0000b700: 6967 5f69 643a 2049 6620 7072 6f76 6964  ig_id: If provid
-0000b710: 6564 2c20 6665 7463 6820 6f6e 6c79 2074  ed, fetch only t
-0000b720: 6865 2066 6561 7475 7265 206d 6f6e 6974  he feature monit
-0000b730: 6f72 696e 6720 636f 6e66 6967 2077 6974  oring config wit
-0000b740: 6820 7468 6520 6769 7665 6e20 6964 2e0a  h the given id..
-0000b750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b760: 4465 6661 756c 7473 2074 6f20 4e6f 6e65  Defaults to None
-0000b770: 2e0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
-0000b780: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
-0000b790: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
-0000b7a0: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
-0000b7b0: 726f 7260 2e0a 2020 2020 2020 2020 2020  ror`..          
-0000b7c0: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
-0000b7d0: 7863 6570 7469 6f6e 732e 4665 6174 7572  xceptions.Featur
-0000b7e0: 6553 746f 7265 4578 6365 7074 696f 6e60  eStoreException`
-0000b7f0: 2e0a 2020 2020 2020 2020 2020 2020 5661  ..            Va
-0000b800: 6c75 6545 7272 6f72 3a20 6966 2062 6f74  lueError: if bot
-0000b810: 6820 6e61 6d65 2061 6e64 2066 6561 7475  h name and featu
-0000b820: 7265 5f6e 616d 6520 6172 6520 7072 6f76  re_name are prov
-0000b830: 6964 6564 2e0a 2020 2020 2020 2020 2020  ided..          
-0000b840: 2020 5479 7065 4572 726f 723a 2069 6620    TypeError: if 
-0000b850: 6e61 6d65 206f 7220 6665 6174 7572 655f  name or feature_
-0000b860: 6e61 6d65 2061 7265 206e 6f74 2073 7472  name are not str
-0000b870: 696e 6720 6f72 204e 6f6e 652e 0a20 2020  ing or None..   
-0000b880: 2020 2020 2023 2052 6574 7572 6e0a 2020       # Return.  
-0000b890: 2020 2020 2020 2020 2020 556e 696f 6e5b            Union[
-0000b8a0: 6046 6561 7475 7265 4d6f 6e69 746f 7269  `FeatureMonitori
-0000b8b0: 6e67 436f 6e66 6967 602c 204c 6973 745b  ngConfig`, List[
-0000b8c0: 6046 6561 7475 7265 4d6f 6e69 746f 7269  `FeatureMonitori
-0000b8d0: 6e67 436f 6e66 6967 605d 2c20 4e6f 6e65  ngConfig`], None
-0000b8e0: 5d0a 2020 2020 2020 2020 2020 2020 2020  ].              
-0000b8f0: 2020 4120 6c69 7374 206f 6620 6665 6174    A list of feat
-0000b900: 7572 6520 6d6f 6e69 746f 7269 6e67 2063  ure monitoring c
-0000b910: 6f6e 6669 6773 2e20 4966 206e 616d 6520  onfigs. If name 
-0000b920: 7072 6f76 6964 6564 2c0a 2020 2020 2020  provided,.      
-0000b930: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0000b940: 7320 6569 7468 6572 2061 2073 696e 676c  s either a singl
-0000b950: 6520 636f 6e66 6967 206f 7220 4e6f 6e65  e config or None
-0000b960: 2069 6620 6e6f 7420 666f 756e 642e 0a20   if not found.. 
-0000b970: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
-0000b980: 2020 2069 6620 6e6f 7420 7365 6c66 2e5f     if not self._
-0000b990: 6964 3a0a 2020 2020 2020 2020 2020 2020  id:.            
-0000b9a0: 7261 6973 6520 4665 6174 7572 6553 746f  raise FeatureSto
-0000b9b0: 7265 4578 6365 7074 696f 6e28 0a20 2020  reException(.   
-0000b9c0: 2020 2020 2020 2020 2020 2020 2022 4f6e               "On
-0000b9d0: 6c79 2046 6561 7475 7265 2047 726f 7570  ly Feature Group
-0000b9e0: 2072 6567 6973 7465 7265 6420 7769 7468   registered with
-0000b9f0: 2048 6f70 7377 6f72 6b73 2063 616e 2066   Hopsworks can f
-0000ba00: 6574 6368 2066 6561 7475 7265 206d 6f6e  etch feature mon
-0000ba10: 6974 6f72 696e 6720 636f 6e66 6967 7572  itoring configur
-0000ba20: 6174 696f 6e73 2e22 0a20 2020 2020 2020  ations.".       
-0000ba30: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
-0000ba40: 7265 7475 726e 2073 656c 662e 5f66 6561  return self._fea
-0000ba50: 7475 7265 5f6d 6f6e 6974 6f72 696e 675f  ture_monitoring_
-0000ba60: 636f 6e66 6967 5f65 6e67 696e 652e 6765  config_engine.ge
-0000ba70: 745f 6665 6174 7572 655f 6d6f 6e69 746f  t_feature_monito
-0000ba80: 7269 6e67 5f63 6f6e 6669 6773 280a 2020  ring_configs(.  
-0000ba90: 2020 2020 2020 2020 2020 6e61 6d65 3d6e            name=n
-0000baa0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-0000bab0: 2066 6561 7475 7265 5f6e 616d 653d 6665   feature_name=fe
-0000bac0: 6174 7572 655f 6e61 6d65 2c0a 2020 2020  ature_name,.    
-0000bad0: 2020 2020 2020 2020 636f 6e66 6967 5f69          config_i
-0000bae0: 643d 636f 6e66 6967 5f69 642c 0a20 2020  d=config_id,.   
-0000baf0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
-0000bb00: 6765 745f 6665 6174 7572 655f 6d6f 6e69  get_feature_moni
-0000bb10: 746f 7269 6e67 5f68 6973 746f 7279 280a  toring_history(.
-0000bb20: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
-0000bb30: 2020 2020 2020 636f 6e66 6967 5f6e 616d        config_nam
-0000bb40: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-0000bb50: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000bb60: 2063 6f6e 6669 675f 6964 3a20 4f70 7469   config_id: Opti
-0000bb70: 6f6e 616c 5b69 6e74 5d20 3d20 4e6f 6e65  onal[int] = None
-0000bb80: 2c0a 2020 2020 2020 2020 7374 6172 745f  ,.        start_
-0000bb90: 7469 6d65 3a20 4f70 7469 6f6e 616c 5b55  time: Optional[U
-0000bba0: 6e69 6f6e 5b69 6e74 2c20 7374 722c 2064  nion[int, str, d
-0000bbb0: 6174 6574 696d 652c 2064 6174 655d 5d20  atetime, date]] 
-0000bbc0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-0000bbd0: 656e 645f 7469 6d65 3a20 4f70 7469 6f6e  end_time: Option
-0000bbe0: 616c 5b55 6e69 6f6e 5b69 6e74 2c20 7374  al[Union[int, st
-0000bbf0: 722c 2064 6174 6574 696d 652c 2064 6174  r, datetime, dat
-0000bc00: 655d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  e]] = None,.    
-0000bc10: 2020 2020 7769 7468 5f73 7461 7469 7374      with_statist
-0000bc20: 6963 733a 204f 7074 696f 6e61 6c5b 626f  ics: Optional[bo
-0000bc30: 6f6c 5d20 3d20 5472 7565 2c0a 2020 2020  ol] = True,.    
-0000bc40: 2920 2d3e 204c 6973 745b 2266 6d72 2e46  ) -> List["fmr.F
-0000bc50: 6561 7475 7265 4d6f 6e69 746f 7269 6e67  eatureMonitoring
-0000bc60: 5265 7375 6c74 225d 3a0a 2020 2020 2020  Result"]:.      
-0000bc70: 2020 2222 2246 6574 6368 2066 6561 7475    """Fetch featu
-0000bc80: 7265 206d 6f6e 6974 6f72 696e 6720 6869  re monitoring hi
-0000bc90: 7374 6f72 7920 666f 7220 6120 6769 7665  story for a give
-0000bca0: 6e20 6665 6174 7572 6520 6d6f 6e69 746f  n feature monito
-0000bcb0: 7269 6e67 2063 6f6e 6669 672e 0a20 2020  ring config..   
-0000bcc0: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
-0000bcd0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-0000bce0: 7079 7468 6f6e 330a 2020 2020 2020 2020  python3.        
-0000bcf0: 2020 2020 2320 6665 7463 6820 796f 7572      # fetch your
-0000bd00: 2066 6561 7475 7265 2067 726f 7570 0a20   feature group. 
-0000bd10: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
-0000bd20: 6673 2e67 6574 5f66 6561 7475 7265 5f67  fs.get_feature_g
-0000bd30: 726f 7570 286e 616d 653d 226d 795f 6665  roup(name="my_fe
-0000bd40: 6174 7572 655f 6772 6f75 7022 2c20 7665  ature_group", ve
-0000bd50: 7273 696f 6e3d 3129 0a20 2020 2020 2020  rsion=1).       
-0000bd60: 2020 2020 2023 2066 6574 6368 2066 6561       # fetch fea
-0000bd70: 7475 7265 206d 6f6e 6974 6f72 696e 6720  ture monitoring 
-0000bd80: 6869 7374 6f72 7920 666f 7220 6120 6769  history for a gi
-0000bd90: 7665 6e20 6665 6174 7572 6520 6d6f 6e69  ven feature moni
-0000bda0: 746f 7269 6e67 2063 6f6e 6669 670a 2020  toring config.  
-0000bdb0: 2020 2020 2020 2020 2020 666d 5f68 6973            fm_his
-0000bdc0: 746f 7279 203d 2066 672e 6765 745f 6665  tory = fg.get_fe
-0000bdd0: 6174 7572 655f 6d6f 6e69 746f 7269 6e67  ature_monitoring
-0000bde0: 5f68 6973 746f 7279 280a 2020 2020 2020  _history(.      
-0000bdf0: 2020 2020 2020 2020 2020 636f 6e66 6967            config
-0000be00: 5f6e 616d 653d 226d 795f 636f 6e66 6967  _name="my_config
-0000be10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0000be20: 2020 2073 7461 7274 5f74 696d 653d 2232     start_time="2
-0000be30: 3032 302d 3031 2d30 3122 2c0a 2020 2020  020-01-01",.    
-0000be40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0000be50: 2020 2020 2020 2320 6665 7463 6820 6665        # fetch fe
-0000be60: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
-0000be70: 2068 6973 746f 7279 2066 6f72 2061 2067   history for a g
-0000be80: 6976 656e 2066 6561 7475 7265 206d 6f6e  iven feature mon
-0000be90: 6974 6f72 696e 6720 636f 6e66 6967 2069  itoring config i
-0000bea0: 640a 2020 2020 2020 2020 2020 2020 666d  d.            fm
-0000beb0: 5f68 6973 746f 7279 203d 2066 672e 6765  _history = fg.ge
-0000bec0: 745f 6665 6174 7572 655f 6d6f 6e69 746f  t_feature_monito
-0000bed0: 7269 6e67 5f68 6973 746f 7279 280a 2020  ring_history(.  
-0000bee0: 2020 2020 2020 2020 2020 2020 2020 636f                co
-0000bef0: 6e66 6967 5f69 643d 312c 0a20 2020 2020  nfig_id=1,.     
-0000bf00: 2020 2020 2020 2020 2020 2073 7461 7274             start
-0000bf10: 5f74 696d 653d 6461 7465 7469 6d65 2e6e  _time=datetime.n
-0000bf20: 6f77 2829 202d 2074 696d 6564 656c 7461  ow() - timedelta
-0000bf30: 2877 6565 6b73 3d32 292c 0a20 2020 2020  (weeks=2),.     
-0000bf40: 2020 2020 2020 2020 2020 2065 6e64 5f74             end_t
-0000bf50: 696d 653d 6461 7465 7469 6d65 2e6e 6f77  ime=datetime.now
-0000bf60: 2829 202d 2074 696d 6564 656c 7461 2877  () - timedelta(w
-0000bf70: 6565 6b73 3d31 292c 0a20 2020 2020 2020  eeks=1),.       
-0000bf80: 2020 2020 2020 2020 2077 6974 685f 7374           with_st
-0000bf90: 6174 6973 7469 6373 3d46 616c 7365 2c0a  atistics=False,.
-0000bfa0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0000bfb0: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
-0000bfc0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
-0000bfd0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
-0000bfe0: 6e66 6967 5f6e 616d 653a 2054 6865 206e  nfig_name: The n
-0000bff0: 616d 6520 6f66 2074 6865 2066 6561 7475  ame of the featu
-0000c000: 7265 206d 6f6e 6974 6f72 696e 6720 636f  re monitoring co
-0000c010: 6e66 6967 2074 6f20 6665 7463 6820 6869  nfig to fetch hi
-0000c020: 7374 6f72 7920 666f 722e 0a20 2020 2020  story for..     
-0000c030: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-0000c040: 6c74 7320 746f 204e 6f6e 652e 0a20 2020  lts to None..   
-0000c050: 2020 2020 2020 2020 2063 6f6e 6669 675f           config_
-0000c060: 6964 3a20 5468 6520 6964 206f 6620 7468  id: The id of th
-0000c070: 6520 6665 6174 7572 6520 6d6f 6e69 746f  e feature monito
-0000c080: 7269 6e67 2063 6f6e 6669 6720 746f 2066  ring config to f
-0000c090: 6574 6368 2068 6973 746f 7279 2066 6f72  etch history for
-0000c0a0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000c0b0: 2020 4465 6661 756c 7473 2074 6f20 4e6f    Defaults to No
-0000c0c0: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
-0000c0d0: 7374 6172 745f 7469 6d65 3a20 5468 6520  start_time: The 
-0000c0e0: 7374 6172 7420 6461 7465 206f 6620 7468  start date of th
-0000c0f0: 6520 6665 6174 7572 6520 6d6f 6e69 746f  e feature monito
-0000c100: 7269 6e67 2068 6973 746f 7279 2074 6f20  ring history to 
-0000c110: 6665 7463 682e 0a20 2020 2020 2020 2020  fetch..         
-0000c120: 2020 2020 2020 2044 6566 6175 6c74 7320         Defaults 
-0000c130: 746f 204e 6f6e 652e 0a20 2020 2020 2020  to None..       
-0000c140: 2020 2020 2065 6e64 5f74 696d 653a 2054       end_time: T
-0000c150: 6865 2065 6e64 2064 6174 6520 6f66 2074  he end date of t
-0000c160: 6865 2066 6561 7475 7265 206d 6f6e 6974  he feature monit
-0000c170: 6f72 696e 6720 6869 7374 6f72 7920 746f  oring history to
-0000c180: 2066 6574 6368 2e0a 2020 2020 2020 2020   fetch..        
-0000c190: 2020 2020 2020 2020 4465 6661 756c 7473          Defaults
-0000c1a0: 2074 6f20 4e6f 6e65 2e0a 2020 2020 2020   to None..      
-0000c1b0: 2020 2020 2020 7769 7468 5f73 7461 7469        with_stati
-0000c1c0: 7374 6963 733a 2057 6865 7468 6572 2074  stics: Whether t
-0000c1d0: 6f20 696e 636c 7564 6520 7374 6174 6973  o include statis
-0000c1e0: 7469 6373 2069 6e20 7468 6520 6665 6174  tics in the feat
-0000c1f0: 7572 6520 6d6f 6e69 746f 7269 6e67 2068  ure monitoring h
-0000c200: 6973 746f 7279 2e0a 2020 2020 2020 2020  istory..        
-0000c210: 2020 2020 2020 2020 4465 6661 756c 7473          Defaults
-0000c220: 2074 6f20 5472 7565 2e20 4966 2046 616c   to True. If Fal
-0000c230: 7365 2c20 6f6e 6c79 206d 6574 6164 6174  se, only metadat
-0000c240: 6120 6162 6f75 7420 7468 6520 6d6f 6e69  a about the moni
-0000c250: 746f 7269 6e67 2077 696c 6c20 6265 2066  toring will be f
-0000c260: 6574 6368 6564 2e0a 2020 2020 2020 2020  etched..        
-0000c270: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
-0000c280: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
-0000c290: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
-0000c2a0: 7441 5049 4572 726f 7260 2e0a 2020 2020  tAPIError`..    
-0000c2b0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-0000c2c0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-0000c2d0: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
-0000c2e0: 7074 696f 6e60 2e0a 2020 2020 2020 2020  ption`..        
-0000c2f0: 2020 2020 5661 6c75 6545 7272 6f72 3a20      ValueError: 
-0000c300: 6966 2062 6f74 6820 636f 6e66 6967 5f6e  if both config_n
-0000c310: 616d 6520 616e 6420 636f 6e66 6967 5f69  ame and config_i
-0000c320: 6420 6172 6520 7072 6f76 6964 6564 2e0a  d are provided..
-0000c330: 2020 2020 2020 2020 2020 2020 5479 7065              Type
-0000c340: 4572 726f 723a 2069 6620 636f 6e66 6967  Error: if config
-0000c350: 5f6e 616d 6520 6f72 2063 6f6e 6669 675f  _name or config_
-0000c360: 6964 2061 7265 206e 6f74 2072 6573 7065  id are not respe
-0000c370: 6374 6976 656c 7920 7374 7269 6e67 2c20  ctively string, 
-0000c380: 696e 7420 6f72 204e 6f6e 652e 0a20 2020  int or None..   
-0000c390: 2020 2020 2023 2052 6574 7572 6e0a 2020       # Return.  
-0000c3a0: 2020 2020 2020 2020 2020 4c69 7374 5b60            List[`
-0000c3b0: 4665 6174 7572 654d 6f6e 6974 6f72 696e  FeatureMonitorin
-0000c3c0: 6752 6573 756c 7460 5d0a 2020 2020 2020  gResult`].      
-0000c3d0: 2020 2020 2020 2020 2020 4120 6c69 7374            A list
-0000c3e0: 206f 6620 6665 6174 7572 6520 6d6f 6e69   of feature moni
-0000c3f0: 746f 7269 6e67 2072 6573 756c 7473 2063  toring results c
-0000c400: 6f6e 7461 696e 696e 6720 7468 6520 6d6f  ontaining the mo
-0000c410: 6e69 746f 7269 6e67 206d 6574 6164 6174  nitoring metadat
-0000c420: 610a 2020 2020 2020 2020 2020 2020 2020  a.              
-0000c430: 2020 6173 2077 656c 6c20 6173 2074 6865    as well as the
-0000c440: 2063 6f6d 7075 7465 6420 7374 6174 6973   computed statis
-0000c450: 7469 6373 2066 6f72 2074 6865 2064 6574  tics for the det
-0000c460: 6563 7469 6f6e 2061 6e64 2072 6566 6572  ection and refer
-0000c470: 656e 6365 2077 696e 646f 770a 2020 2020  ence window.    
-0000c480: 2020 2020 2020 2020 2020 2020 6966 2072              if r
-0000c490: 6571 7565 7374 6564 2e0a 2020 2020 2020  equested..      
-0000c4a0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0000c4b0: 206e 6f74 2073 656c 662e 5f69 643a 0a20   not self._id:. 
-0000c4c0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-0000c4d0: 2046 6561 7475 7265 5374 6f72 6545 7863   FeatureStoreExc
-0000c4e0: 6570 7469 6f6e 280a 2020 2020 2020 2020  eption(.        
-0000c4f0: 2020 2020 2020 2020 224f 6e6c 7920 4665          "Only Fe
-0000c500: 6174 7572 6520 4772 6f75 7020 7265 6769  ature Group regi
-0000c510: 7374 6572 6564 2077 6974 6820 486f 7073  stered with Hops
-0000c520: 776f 726b 7320 6361 6e20 6665 7463 6820  works can fetch 
-0000c530: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
-0000c540: 6e67 2068 6973 746f 7279 2e22 0a20 2020  ng history.".   
-0000c550: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
-0000c560: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000c570: 5f66 6561 7475 7265 5f6d 6f6e 6974 6f72  _feature_monitor
-0000c580: 696e 675f 7265 7375 6c74 5f65 6e67 696e  ing_result_engin
-0000c590: 652e 6765 745f 6665 6174 7572 655f 6d6f  e.get_feature_mo
-0000c5a0: 6e69 746f 7269 6e67 5f72 6573 756c 7473  nitoring_results
-0000c5b0: 280a 2020 2020 2020 2020 2020 2020 636f  (.            co
-0000c5c0: 6e66 6967 5f6e 616d 653d 636f 6e66 6967  nfig_name=config
-0000c5d0: 5f6e 616d 652c 0a20 2020 2020 2020 2020  _name,.         
-0000c5e0: 2020 2063 6f6e 6669 675f 6964 3d63 6f6e     config_id=con
-0000c5f0: 6669 675f 6964 2c0a 2020 2020 2020 2020  fig_id,.        
-0000c600: 2020 2020 7374 6172 745f 7469 6d65 3d73      start_time=s
-0000c610: 7461 7274 5f74 696d 652c 0a20 2020 2020  tart_time,.     
-0000c620: 2020 2020 2020 2065 6e64 5f74 696d 653d         end_time=
-0000c630: 656e 645f 7469 6d65 2c0a 2020 2020 2020  end_time,.      
-0000c640: 2020 2020 2020 7769 7468 5f73 7461 7469        with_stati
-0000c650: 7374 6963 733d 7769 7468 5f73 7461 7469  stics=with_stati
-0000c660: 7374 6963 732c 0a20 2020 2020 2020 2029  stics,.        )
-0000c670: 0a0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-0000c680: 5f73 7461 7469 7374 6963 735f 6d6f 6e69  _statistics_moni
-0000c690: 746f 7269 6e67 280a 2020 2020 2020 2020  toring(.        
-0000c6a0: 7365 6c66 2c0a 2020 2020 2020 2020 6e61  self,.        na
-0000c6b0: 6d65 3a20 7374 722c 0a20 2020 2020 2020  me: str,.       
-0000c6c0: 2066 6561 7475 7265 5f6e 616d 653a 204f   feature_name: O
-0000c6d0: 7074 696f 6e61 6c5b 7374 725d 203d 204e  ptional[str] = N
-0000c6e0: 6f6e 652c 0a20 2020 2020 2020 2064 6573  one,.        des
-0000c6f0: 6372 6970 7469 6f6e 3a20 4f70 7469 6f6e  cription: Option
-0000c700: 616c 5b73 7472 5d20 3d20 4e6f 6e65 2c0a  al[str] = None,.
-0000c710: 2020 2020 2020 2020 7374 6172 745f 6461          start_da
-0000c720: 7465 5f74 696d 653a 204f 7074 696f 6e61  te_time: Optiona
-0000c730: 6c5b 556e 696f 6e5b 696e 742c 2073 7472  l[Union[int, str
-0000c740: 2c20 6461 7465 7469 6d65 2c20 6461 7465  , datetime, date
-0000c750: 2c20 7064 2e54 696d 6573 7461 6d70 5d5d  , pd.Timestamp]]
-0000c760: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-0000c770: 2065 6e64 5f64 6174 655f 7469 6d65 3a20   end_date_time: 
-0000c780: 4f70 7469 6f6e 616c 5b55 6e69 6f6e 5b69  Optional[Union[i
-0000c790: 6e74 2c20 7374 722c 2064 6174 6574 696d  nt, str, datetim
-0000c7a0: 652c 2064 6174 652c 2070 642e 5469 6d65  e, date, pd.Time
-0000c7b0: 7374 616d 705d 5d20 3d20 4e6f 6e65 2c0a  stamp]] = None,.
-0000c7c0: 2020 2020 2020 2020 6372 6f6e 5f65 7870          cron_exp
-0000c7d0: 7265 7373 696f 6e3a 204f 7074 696f 6e61  ression: Optiona
-0000c7e0: 6c5b 7374 725d 203d 2022 3020 3020 3132  l[str] = "0 0 12
-0000c7f0: 203f 202a 202a 202a 222c 0a20 2020 2029   ? * * *",.    )
-0000c800: 202d 3e20 2266 6d63 2e46 6561 7475 7265   -> "fmc.Feature
-0000c810: 4d6f 6e69 746f 7269 6e67 436f 6e66 6967  MonitoringConfig
-0000c820: 223a 0a20 2020 2020 2020 2022 2222 5275  ":.        """Ru
-0000c830: 6e20 6120 6a6f 6220 746f 2063 6f6d 7075  n a job to compu
-0000c840: 7465 2073 7461 7469 7374 6963 7320 6f6e  te statistics on
-0000c850: 2073 6e61 7073 686f 7420 6f66 2066 6561   snapshot of fea
-0000c860: 7475 7265 2064 6174 6120 6f6e 2061 2073  ture data on a s
-0000c870: 6368 6564 756c 652e 0a20 2020 2020 2020  chedule..       
-0000c880: 2021 2121 2065 7870 6572 696d 656e 7461   !!! experimenta
-0000c890: 6c0a 2020 2020 2020 2020 2020 2020 5075  l.            Pu
-0000c8a0: 626c 6963 2041 5049 2069 7320 7375 626a  blic API is subj
-0000c8b0: 6563 7420 746f 2063 6861 6e67 652c 2074  ect to change, t
-0000c8c0: 6869 7320 6665 6174 7572 6520 6973 206e  his feature is n
-0000c8d0: 6f74 2073 7569 7461 626c 6520 666f 7220  ot suitable for 
-0000c8e0: 7072 6f64 7563 7469 6f6e 2075 7365 2d63  production use-c
-0000c8f0: 6173 6573 2e0a 2020 2020 2020 2020 2121  ases..        !!
-0000c900: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-0000c910: 2020 2020 2020 6060 6070 7974 686f 6e33        ```python3
-0000c920: 0a20 2020 2020 2020 2020 2020 2023 2066  .            # f
-0000c930: 6574 6368 2066 6561 7475 7265 2067 726f  etch feature gro
-0000c940: 7570 0a20 2020 2020 2020 2020 2020 2066  up.            f
-0000c950: 6720 3d20 6673 2e67 6574 5f66 6561 7475  g = fs.get_featu
-0000c960: 7265 5f67 726f 7570 286e 616d 653d 226d  re_group(name="m
-0000c970: 795f 6665 6174 7572 655f 6772 6f75 7022  y_feature_group"
-0000c980: 2c20 7665 7273 696f 6e3d 3129 0a20 2020  , version=1).   
-0000c990: 2020 2020 2020 2020 2023 2065 6e61 626c           # enabl
-0000c9a0: 6520 7374 6174 6973 7469 6373 206d 6f6e  e statistics mon
-0000c9b0: 6974 6f72 696e 670a 2020 2020 2020 2020  itoring.        
-0000c9c0: 2020 2020 6d79 5f63 6f6e 6669 6720 3d20      my_config = 
-0000c9d0: 6667 2e63 7265 6174 655f 7374 6174 6973  fg.create_statis
-0000c9e0: 7469 6373 5f6d 6f6e 6974 6f72 696e 6728  tics_monitoring(
-0000c9f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000ca00: 206e 616d 653d 226d 795f 636f 6e66 6967   name="my_config
-0000ca10: 222c 0a20 2020 2020 2020 2020 2020 2020  ",.             
-0000ca20: 2020 2073 7461 7274 5f64 6174 655f 7469     start_date_ti
-0000ca30: 6d65 3d22 3230 3231 2d30 312d 3031 2030  me="2021-01-01 0
-0000ca40: 303a 3030 3a30 3022 2c0a 2020 2020 2020  0:00:00",.      
-0000ca50: 2020 2020 2020 2020 2020 6465 7363 7269            descri
-0000ca60: 7074 696f 6e3d 226d 7920 6465 7363 7269  ption="my descri
-0000ca70: 7074 696f 6e22 2c0a 2020 2020 2020 2020  ption",.        
-0000ca80: 2020 2020 2020 2020 6372 6f6e 5f65 7870          cron_exp
-0000ca90: 7265 7373 696f 6e3d 2230 2030 2031 3220  ression="0 0 12 
-0000caa0: 3f20 2a20 2a20 2a22 2c0a 2020 2020 2020  ? * * *",.      
-0000cab0: 2020 2020 2020 292e 7769 7468 5f64 6574        ).with_det
-0000cac0: 6563 7469 6f6e 5f77 696e 646f 7728 0a20  ection_window(. 
-0000cad0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000cae0: 2053 7461 7469 7374 6963 7320 636f 6d70   Statistics comp
-0000caf0: 7574 6564 206f 6e20 3130 2520 6f66 2074  uted on 10% of t
-0000cb00: 6865 206c 6173 7420 7765 656b 206f 6620  he last week of 
-0000cb10: 6461 7461 0a20 2020 2020 2020 2020 2020  data.           
-0000cb20: 2020 2020 2074 696d 655f 6f66 6673 6574       time_offset
-0000cb30: 3d22 3177 222c 0a20 2020 2020 2020 2020  ="1w",.         
-0000cb40: 2020 2020 2020 2072 6f77 5f70 6572 6365         row_perce
-0000cb50: 6e74 6167 653d 302e 312c 0a20 2020 2020  ntage=0.1,.     
-0000cb60: 2020 2020 2020 2029 2e73 6176 6528 290a         ).save().
-0000cb70: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-0000cb80: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
-0000cb90: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
-0000cba0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
-0000cbb0: 6520 6665 6174 7572 6520 6d6f 6e69 746f  e feature monito
-0000cbc0: 7269 6e67 2063 6f6e 6669 6775 7261 7469  ring configurati
-0000cbd0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
-0000cbe0: 2020 2020 6e61 6d65 206d 7573 7420 6265      name must be
-0000cbf0: 2075 6e69 7175 6520 666f 7220 616c 6c20   unique for all 
-0000cc00: 636f 6e66 6967 7572 6174 696f 6e73 2061  configurations a
-0000cc10: 7474 6163 6865 6420 746f 2074 6865 2066  ttached to the f
-0000cc20: 6561 7475 7265 2067 726f 7570 2e0a 2020  eature group..  
-0000cc30: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-0000cc40: 655f 6e61 6d65 3a20 4e61 6d65 206f 6620  e_name: Name of 
-0000cc50: 7468 6520 6665 6174 7572 6520 746f 206d  the feature to m
-0000cc60: 6f6e 6974 6f72 2e20 4966 206e 6f74 2073  onitor. If not s
-0000cc70: 7065 6369 6669 6564 2c20 7374 6174 6973  pecified, statis
-0000cc80: 7469 6373 0a20 2020 2020 2020 2020 2020  tics.           
-0000cc90: 2020 2020 2077 696c 6c20 6265 2063 6f6d       will be com
-0000cca0: 7075 7465 6420 666f 7220 616c 6c20 6665  puted for all fe
-0000ccb0: 6174 7572 6573 2e0a 2020 2020 2020 2020  atures..        
-0000ccc0: 2020 2020 6465 7363 7269 7074 696f 6e3a      description:
-0000ccd0: 2044 6573 6372 6970 7469 6f6e 206f 6620   Description of 
-0000cce0: 7468 6520 6665 6174 7572 6520 6d6f 6e69  the feature moni
-0000ccf0: 746f 7269 6e67 2063 6f6e 6669 6775 7261  toring configura
-0000cd00: 7469 6f6e 2e0a 2020 2020 2020 2020 2020  tion..          
-0000cd10: 2020 7374 6172 745f 6461 7465 5f74 696d    start_date_tim
-0000cd20: 653a 2053 7461 7274 2064 6174 6520 616e  e: Start date an
-0000cd30: 6420 7469 6d65 2066 726f 6d20 7768 6963  d time from whic
-0000cd40: 6820 746f 2073 7461 7274 2063 6f6d 7075  h to start compu
-0000cd50: 7469 6e67 2073 7461 7469 7374 6963 732e  ting statistics.
-0000cd60: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
-0000cd70: 5f64 6174 655f 7469 6d65 3a20 456e 6420  _date_time: End 
-0000cd80: 6461 7465 2061 6e64 2074 696d 6520 6174  date and time at
-0000cd90: 2077 6869 6368 2074 6f20 7374 6f70 2063   which to stop c
-0000cda0: 6f6d 7075 7469 6e67 2073 7461 7469 7374  omputing statist
-0000cdb0: 6963 732e 0a20 2020 2020 2020 2020 2020  ics..           
-0000cdc0: 2063 726f 6e5f 6578 7072 6573 7369 6f6e   cron_expression
-0000cdd0: 3a20 4372 6f6e 2065 7870 7265 7373 696f  : Cron expressio
-0000cde0: 6e20 746f 2075 7365 2074 6f20 7363 6865  n to use to sche
-0000cdf0: 6475 6c65 2074 6865 206a 6f62 2e20 5468  dule the job. Th
-0000ce00: 6520 6372 6f6e 2065 7870 7265 7373 696f  e cron expressio
-0000ce10: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
-0000ce20: 2020 6d75 7374 2062 6520 696e 2055 5443    must be in UTC
-0000ce30: 2061 6e64 2066 6f6c 6c6f 7720 7468 6520   and follow the 
-0000ce40: 5175 6172 747a 2073 7065 6369 6669 6361  Quartz specifica
-0000ce50: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
-0000ce60: 2027 3020 3020 3132 203f 202a 202a 202a   '0 0 12 ? * * *
-0000ce70: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-0000ce80: 2020 2065 7665 7279 2064 6179 2061 7420     every day at 
-0000ce90: 3132 706d 2055 5443 2e0a 2020 2020 2020  12pm UTC..      
-0000cea0: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
-0000ceb0: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-0000cec0: 656e 742e 6578 6365 7074 696f 6e73 2e46  ent.exceptions.F
-0000ced0: 6561 7475 7265 5374 6f72 6545 7863 6570  eatureStoreExcep
-0000cee0: 7469 6f6e 602e 0a20 2020 2020 2020 2023  tion`..        #
-0000cef0: 2052 6574 7572 6e0a 2020 2020 2020 2020   Return.        
-0000cf00: 2020 2020 6046 6561 7475 7265 4d6f 6e69      `FeatureMoni
-0000cf10: 746f 7269 6e67 436f 6e66 6967 6020 436f  toringConfig` Co
-0000cf20: 6e66 6967 7572 6174 696f 6e20 7769 7468  nfiguration with
-0000cf30: 206d 696e 696d 616c 2069 6e66 6f72 6d61   minimal informa
-0000cf40: 7469 6f6e 2061 626f 7574 2074 6865 2066  tion about the f
-0000cf50: 6561 7475 7265 206d 6f6e 6974 6f72 696e  eature monitorin
-0000cf60: 672e 0a20 2020 2020 2020 2020 2020 2020  g..             
-0000cf70: 2020 2041 6464 6974 696f 6e61 6c20 696e     Additional in
-0000cf80: 666f 726d 6174 696f 6e20 6172 6520 7265  formation are re
-0000cf90: 7175 6972 6564 2062 6566 6f72 6520 6665  quired before fe
-0000cfa0: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
-0000cfb0: 2069 7320 656e 6162 6c65 642e 0a20 2020   is enabled..   
-0000cfc0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000cfd0: 2069 6620 6e6f 7420 7365 6c66 2e5f 6964   if not self._id
-0000cfe0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
-0000cff0: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
-0000d000: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
-0000d010: 2020 2020 2020 2020 2020 2022 4f6e 6c79             "Only
-0000d020: 2046 6561 7475 7265 2047 726f 7570 2072   Feature Group r
-0000d030: 6567 6973 7465 7265 6420 7769 7468 2048  egistered with H
-0000d040: 6f70 7377 6f72 6b73 2063 616e 2065 6e61  opsworks can ena
-0000d050: 626c 6520 7363 6865 6475 6c65 6420 7374  ble scheduled st
-0000d060: 6174 6973 7469 6373 206d 6f6e 6974 6f72  atistics monitor
-0000d070: 696e 672e 220a 2020 2020 2020 2020 2020  ing.".          
-0000d080: 2020 290a 0a20 2020 2020 2020 2072 6574    )..        ret
-0000d090: 7572 6e20 7365 6c66 2e5f 6665 6174 7572  urn self._featur
-0000d0a0: 655f 6d6f 6e69 746f 7269 6e67 5f63 6f6e  e_monitoring_con
-0000d0b0: 6669 675f 656e 6769 6e65 2e5f 6275 696c  fig_engine._buil
-0000d0c0: 645f 6465 6661 756c 745f 7374 6174 6973  d_default_statis
-0000d0d0: 7469 6373 5f6d 6f6e 6974 6f72 696e 675f  tics_monitoring_
-0000d0e0: 636f 6e66 6967 280a 2020 2020 2020 2020  config(.        
-0000d0f0: 2020 2020 6e61 6d65 3d6e 616d 652c 0a20      name=name,. 
-0000d100: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-0000d110: 7265 5f6e 616d 653d 6665 6174 7572 655f  re_name=feature_
-0000d120: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-0000d130: 2020 6465 7363 7269 7074 696f 6e3d 6465    description=de
-0000d140: 7363 7269 7074 696f 6e2c 0a20 2020 2020  scription,.     
-0000d150: 2020 2020 2020 2073 7461 7274 5f64 6174         start_dat
-0000d160: 655f 7469 6d65 3d73 7461 7274 5f64 6174  e_time=start_dat
-0000d170: 655f 7469 6d65 2c0a 2020 2020 2020 2020  e_time,.        
-0000d180: 2020 2020 7661 6c69 645f 6665 6174 7572      valid_featur
-0000d190: 655f 6e61 6d65 733d 5b66 6561 742e 6e61  e_names=[feat.na
-0000d1a0: 6d65 2066 6f72 2066 6561 7420 696e 2073  me for feat in s
-0000d1b0: 656c 662e 5f66 6561 7475 7265 735d 2c0a  elf._features],.
-0000d1c0: 2020 2020 2020 2020 2020 2020 656e 645f              end_
-0000d1d0: 6461 7465 5f74 696d 653d 656e 645f 6461  date_time=end_da
-0000d1e0: 7465 5f74 696d 652c 0a20 2020 2020 2020  te_time,.       
-0000d1f0: 2020 2020 2063 726f 6e5f 6578 7072 6573       cron_expres
-0000d200: 7369 6f6e 3d63 726f 6e5f 6578 7072 6573  sion=cron_expres
-0000d210: 7369 6f6e 2c0a 2020 2020 2020 2020 290a  sion,.        ).
-0000d220: 0a20 2020 2064 6566 2063 7265 6174 655f  .    def create_
-0000d230: 6665 6174 7572 655f 6d6f 6e69 746f 7269  feature_monitori
-0000d240: 6e67 280a 2020 2020 2020 2020 7365 6c66  ng(.        self
-0000d250: 2c0a 2020 2020 2020 2020 6e61 6d65 3a20  ,.        name: 
-0000d260: 7374 722c 0a20 2020 2020 2020 2066 6561  str,.        fea
-0000d270: 7475 7265 5f6e 616d 653a 2073 7472 2c0a  ture_name: str,.
-0000d280: 2020 2020 2020 2020 6465 7363 7269 7074          descript
-0000d290: 696f 6e3a 204f 7074 696f 6e61 6c5b 7374  ion: Optional[st
-0000d2a0: 725d 203d 204e 6f6e 652c 0a20 2020 2020  r] = None,.     
-0000d2b0: 2020 2073 7461 7274 5f64 6174 655f 7469     start_date_ti
-0000d2c0: 6d65 3a20 4f70 7469 6f6e 616c 5b55 6e69  me: Optional[Uni
-0000d2d0: 6f6e 5b69 6e74 2c20 7374 722c 2064 6174  on[int, str, dat
-0000d2e0: 6574 696d 652c 2064 6174 652c 2070 642e  etime, date, pd.
-0000d2f0: 5469 6d65 7374 616d 705d 5d20 3d20 4e6f  Timestamp]] = No
-0000d300: 6e65 2c0a 2020 2020 2020 2020 656e 645f  ne,.        end_
-0000d310: 6461 7465 5f74 696d 653a 204f 7074 696f  date_time: Optio
-0000d320: 6e61 6c5b 556e 696f 6e5b 696e 742c 2073  nal[Union[int, s
-0000d330: 7472 2c20 6461 7465 7469 6d65 2c20 6461  tr, datetime, da
-0000d340: 7465 2c20 7064 2e54 696d 6573 7461 6d70  te, pd.Timestamp
-0000d350: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
-0000d360: 2020 2063 726f 6e5f 6578 7072 6573 7369     cron_expressi
-0000d370: 6f6e 3a20 4f70 7469 6f6e 616c 5b73 7472  on: Optional[str
-0000d380: 5d20 3d20 2230 2030 2031 3220 3f20 2a20  ] = "0 0 12 ? * 
-0000d390: 2a20 2a22 2c0a 2020 2020 2920 2d3e 2022  * *",.    ) -> "
-0000d3a0: 666d 632e 4665 6174 7572 654d 6f6e 6974  fmc.FeatureMonit
-0000d3b0: 6f72 696e 6743 6f6e 6669 6722 3a0a 2020  oringConfig":.  
-0000d3c0: 2020 2020 2020 2222 2245 6e61 626c 6520        """Enable 
-0000d3d0: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
-0000d3e0: 6e67 2074 6f20 636f 6d70 6172 6520 7374  ng to compare st
-0000d3f0: 6174 6973 7469 6373 206f 6e20 736e 6170  atistics on snap
-0000d400: 7368 6f74 7320 6f66 2066 6561 7475 7265  shots of feature
-0000d410: 2064 6174 6120 6f76 6572 2074 696d 652e   data over time.
-0000d420: 0a20 2020 2020 2020 2021 2121 2065 7870  .        !!! exp
-0000d430: 6572 696d 656e 7461 6c0a 2020 2020 2020  erimental.      
-0000d440: 2020 2020 2020 5075 626c 6963 2041 5049        Public API
-0000d450: 2069 7320 7375 626a 6563 7420 746f 2063   is subject to c
-0000d460: 6861 6e67 652c 2074 6869 7320 6665 6174  hange, this feat
-0000d470: 7572 6520 6973 206e 6f74 2073 7569 7461  ure is not suita
-0000d480: 626c 6520 666f 7220 7072 6f64 7563 7469  ble for producti
-0000d490: 6f6e 2075 7365 2d63 6173 6573 2e0a 2020  on use-cases..  
-0000d4a0: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
-0000d4b0: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
-0000d4c0: 6070 7974 686f 6e33 0a20 2020 2020 2020  `python3.       
-0000d4d0: 2020 2020 2023 2066 6574 6368 2066 6561       # fetch fea
-0000d4e0: 7475 7265 2067 726f 7570 0a20 2020 2020  ture group.     
-0000d4f0: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
-0000d500: 6574 5f66 6561 7475 7265 5f67 726f 7570  et_feature_group
-0000d510: 286e 616d 653d 226d 795f 6665 6174 7572  (name="my_featur
-0000d520: 655f 6772 6f75 7022 2c20 7665 7273 696f  e_group", versio
-0000d530: 6e3d 3129 0a20 2020 2020 2020 2020 2020  n=1).           
-0000d540: 2023 2065 6e61 626c 6520 6665 6174 7572   # enable featur
-0000d550: 6520 6d6f 6e69 746f 7269 6e67 0a20 2020  e monitoring.   
-0000d560: 2020 2020 2020 2020 206d 795f 636f 6e66           my_conf
-0000d570: 6967 203d 2066 672e 6372 6561 7465 5f66  ig = fg.create_f
-0000d580: 6561 7475 7265 5f6d 6f6e 6974 6f72 696e  eature_monitorin
-0000d590: 6728 0a20 2020 2020 2020 2020 2020 2020  g(.             
-0000d5a0: 2020 206e 616d 653d 226d 795f 6d6f 6e69     name="my_moni
-0000d5b0: 746f 7269 6e67 5f63 6f6e 6669 6722 2c0a  toring_config",.
-0000d5c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d5d0: 6665 6174 7572 655f 6e61 6d65 3d22 6d79  feature_name="my
-0000d5e0: 5f66 6561 7475 7265 222c 0a20 2020 2020  _feature",.     
-0000d5f0: 2020 2020 2020 2020 2020 2064 6573 6372             descr
-0000d600: 6970 7469 6f6e 3d22 6d79 206d 6f6e 6974  iption="my monit
-0000d610: 6f72 696e 6720 636f 6e66 6967 2064 6573  oring config des
-0000d620: 6372 6970 7469 6f6e 222c 0a20 2020 2020  cription",.     
-0000d630: 2020 2020 2020 2020 2020 2063 726f 6e5f             cron_
-0000d640: 6578 7072 6573 7369 6f6e 3d22 3020 3020  expression="0 0 
-0000d650: 3132 203f 202a 202a 202a 222c 0a20 2020  12 ? * * *",.   
-0000d660: 2020 2020 2020 2020 2029 2e77 6974 685f           ).with_
-0000d670: 6465 7465 6374 696f 6e5f 7769 6e64 6f77  detection_window
-0000d680: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000d690: 2020 2320 4461 7461 2069 6e73 6572 7465    # Data inserte
-0000d6a0: 6420 696e 2074 6865 206c 6173 7420 6461  d in the last da
-0000d6b0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-0000d6c0: 2020 7469 6d65 5f6f 6666 7365 743d 2231    time_offset="1
-0000d6d0: 6422 2c0a 2020 2020 2020 2020 2020 2020  d",.            
-0000d6e0: 2020 2020 7769 6e64 6f77 5f6c 656e 6774      window_lengt
-0000d6f0: 683d 2231 6422 2c0a 2020 2020 2020 2020  h="1d",.        
-0000d700: 2020 2020 292e 7769 7468 5f72 6566 6572      ).with_refer
-0000d710: 656e 6365 5f77 696e 646f 7728 0a20 2020  ence_window(.   
-0000d720: 2020 2020 2020 2020 2020 2020 2023 2044               # D
-0000d730: 6174 6120 696e 7365 7274 6564 206c 6173  ata inserted las
-0000d740: 7420 7765 656b 206f 6e20 7468 6520 7361  t week on the sa
-0000d750: 6d65 2064 6179 0a20 2020 2020 2020 2020  me day.         
-0000d760: 2020 2020 2020 2074 696d 655f 6f66 6673         time_offs
-0000d770: 6574 3d22 3177 3164 222c 0a20 2020 2020  et="1w1d",.     
-0000d780: 2020 2020 2020 2020 2020 2077 696e 646f             windo
-0000d790: 775f 6c65 6e67 7468 3d22 3164 222c 0a20  w_length="1d",. 
-0000d7a0: 2020 2020 2020 2020 2020 2029 2e63 6f6d             ).com
-0000d7b0: 7061 7265 5f6f 6e28 0a20 2020 2020 2020  pare_on(.       
-0000d7c0: 2020 2020 2020 2020 206d 6574 7269 633d           metric=
-0000d7d0: 226d 6561 6e22 2c0a 2020 2020 2020 2020  "mean",.        
-0000d7e0: 2020 2020 2020 2020 7468 7265 7368 6f6c          threshol
-0000d7f0: 643d 302e 352c 0a20 2020 2020 2020 2020  d=0.5,.         
-0000d800: 2020 2029 2e73 6176 6528 290a 2020 2020     ).save().    
-0000d810: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
-0000d820: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-0000d830: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
-0000d840: 3a20 4e61 6d65 206f 6620 7468 6520 6665  : Name of the fe
-0000d850: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
-0000d860: 2063 6f6e 6669 6775 7261 7469 6f6e 2e0a   configuration..
-0000d870: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d880: 6e61 6d65 206d 7573 7420 6265 2075 6e69  name must be uni
-0000d890: 7175 6520 666f 7220 616c 6c20 636f 6e66  que for all conf
-0000d8a0: 6967 7572 6174 696f 6e73 2061 7474 6163  igurations attac
-0000d8b0: 6865 6420 746f 2074 6865 2066 6561 7475  hed to the featu
-0000d8c0: 7265 2067 726f 7570 2e0a 2020 2020 2020  re group..      
-0000d8d0: 2020 2020 2020 6665 6174 7572 655f 6e61        feature_na
-0000d8e0: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
-0000d8f0: 6665 6174 7572 6520 746f 206d 6f6e 6974  feature to monit
-0000d900: 6f72 2e0a 2020 2020 2020 2020 2020 2020  or..            
-0000d910: 6465 7363 7269 7074 696f 6e3a 2044 6573  description: Des
-0000d920: 6372 6970 7469 6f6e 206f 6620 7468 6520  cription of the 
-0000d930: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
-0000d940: 6e67 2063 6f6e 6669 6775 7261 7469 6f6e  ng configuration
-0000d950: 2e0a 2020 2020 2020 2020 2020 2020 7374  ..            st
-0000d960: 6172 745f 6461 7465 5f74 696d 653a 2053  art_date_time: S
-0000d970: 7461 7274 2064 6174 6520 616e 6420 7469  tart date and ti
-0000d980: 6d65 2066 726f 6d20 7768 6963 6820 746f  me from which to
-0000d990: 2073 7461 7274 2063 6f6d 7075 7469 6e67   start computing
-0000d9a0: 2073 7461 7469 7374 6963 732e 0a20 2020   statistics..   
-0000d9b0: 2020 2020 2020 2020 2065 6e64 5f64 6174           end_dat
-0000d9c0: 655f 7469 6d65 3a20 456e 6420 6461 7465  e_time: End date
-0000d9d0: 2061 6e64 2074 696d 6520 6174 2077 6869   and time at whi
-0000d9e0: 6368 2074 6f20 7374 6f70 2063 6f6d 7075  ch to stop compu
-0000d9f0: 7469 6e67 2073 7461 7469 7374 6963 732e  ting statistics.
-0000da00: 0a20 2020 2020 2020 2020 2020 2063 726f  .            cro
-0000da10: 6e5f 6578 7072 6573 7369 6f6e 3a20 4372  n_expression: Cr
-0000da20: 6f6e 2065 7870 7265 7373 696f 6e20 746f  on expression to
-0000da30: 2075 7365 2074 6f20 7363 6865 6475 6c65   use to schedule
-0000da40: 2074 6865 206a 6f62 2e20 5468 6520 6372   the job. The cr
-0000da50: 6f6e 2065 7870 7265 7373 696f 6e0a 2020  on expression.  
-0000da60: 2020 2020 2020 2020 2020 2020 2020 6d75                mu
-0000da70: 7374 2062 6520 696e 2055 5443 2061 6e64  st be in UTC and
-0000da80: 2066 6f6c 6c6f 7720 7468 6520 5175 6172   follow the Quar
-0000da90: 747a 2073 7065 6369 6669 6361 7469 6f6e  tz specification
-0000daa0: 2e20 4465 6661 756c 7420 6973 2027 3020  . Default is '0 
-0000dab0: 3020 3132 203f 202a 202a 202a 272c 0a20  0 12 ? * * *',. 
-0000dac0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-0000dad0: 7665 7279 2064 6179 2061 7420 3132 706d  very day at 12pm
-0000dae0: 2055 5443 2e0a 2020 2020 2020 2020 2320   UTC..        # 
-0000daf0: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
-0000db00: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
-0000db10: 6578 6365 7074 696f 6e73 2e46 6561 7475  exceptions.Featu
-0000db20: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
-0000db30: 602e 0a20 2020 2020 2020 2023 2052 6574  `..        # Ret
-0000db40: 7572 6e0a 2020 2020 2020 2020 2020 2020  urn.            
-0000db50: 6046 6561 7475 7265 4d6f 6e69 746f 7269  `FeatureMonitori
-0000db60: 6e67 436f 6e66 6967 6020 436f 6e66 6967  ngConfig` Config
-0000db70: 7572 6174 696f 6e20 7769 7468 206d 696e  uration with min
-0000db80: 696d 616c 2069 6e66 6f72 6d61 7469 6f6e  imal information
-0000db90: 2061 626f 7574 2074 6865 2066 6561 7475   about the featu
-0000dba0: 7265 206d 6f6e 6974 6f72 696e 672e 0a20  re monitoring.. 
-0000dbb0: 2020 2020 2020 2020 2020 2020 2020 2041                 A
-0000dbc0: 6464 6974 696f 6e61 6c20 696e 666f 726d  dditional inform
-0000dbd0: 6174 696f 6e20 6172 6520 7265 7175 6972  ation are requir
-0000dbe0: 6564 2062 6566 6f72 6520 6665 6174 7572  ed before featur
-0000dbf0: 6520 6d6f 6e69 746f 7269 6e67 2069 7320  e monitoring is 
-0000dc00: 656e 6162 6c65 642e 0a20 2020 2020 2020  enabled..       
-0000dc10: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
-0000dc20: 6e6f 7420 7365 6c66 2e5f 6964 3a0a 2020  not self._id:.  
-0000dc30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000dc40: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
-0000dc50: 7074 696f 6e28 0a20 2020 2020 2020 2020  ption(.         
-0000dc60: 2020 2020 2020 2022 4f6e 6c79 2046 6561         "Only Fea
-0000dc70: 7475 7265 2047 726f 7570 2072 6567 6973  ture Group regis
-0000dc80: 7465 7265 6420 7769 7468 2048 6f70 7377  tered with Hopsw
-0000dc90: 6f72 6b73 2063 616e 2065 6e61 626c 6520  orks can enable 
-0000dca0: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
-0000dcb0: 6e67 2e22 0a20 2020 2020 2020 2020 2020  ng.".           
-0000dcc0: 2029 0a0a 2020 2020 2020 2020 7265 7475   )..        retu
-0000dcd0: 726e 2073 656c 662e 5f66 6561 7475 7265  rn self._feature
-0000dce0: 5f6d 6f6e 6974 6f72 696e 675f 636f 6e66  _monitoring_conf
-0000dcf0: 6967 5f65 6e67 696e 652e 5f62 7569 6c64  ig_engine._build
-0000dd00: 5f64 6566 6175 6c74 5f66 6561 7475 7265  _default_feature
-0000dd10: 5f6d 6f6e 6974 6f72 696e 675f 636f 6e66  _monitoring_conf
-0000dd20: 6967 280a 2020 2020 2020 2020 2020 2020  ig(.            
-0000dd30: 6e61 6d65 3d6e 616d 652c 0a20 2020 2020  name=name,.     
-0000dd40: 2020 2020 2020 2066 6561 7475 7265 5f6e         feature_n
-0000dd50: 616d 653d 6665 6174 7572 655f 6e61 6d65  ame=feature_name
-0000dd60: 2c0a 2020 2020 2020 2020 2020 2020 6465  ,.            de
-0000dd70: 7363 7269 7074 696f 6e3d 6465 7363 7269  scription=descri
-0000dd80: 7074 696f 6e2c 0a20 2020 2020 2020 2020  ption,.         
-0000dd90: 2020 2073 7461 7274 5f64 6174 655f 7469     start_date_ti
-0000dda0: 6d65 3d73 7461 7274 5f64 6174 655f 7469  me=start_date_ti
-0000ddb0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-0000ddc0: 7661 6c69 645f 6665 6174 7572 655f 6e61  valid_feature_na
-0000ddd0: 6d65 733d 5b66 6561 742e 6e61 6d65 2066  mes=[feat.name f
-0000dde0: 6f72 2066 6561 7420 696e 2073 656c 662e  or feat in self.
-0000ddf0: 5f66 6561 7475 7265 735d 2c0a 2020 2020  _features],.    
-0000de00: 2020 2020 2020 2020 656e 645f 6461 7465          end_date
-0000de10: 5f74 696d 653d 656e 645f 6461 7465 5f74  _time=end_date_t
-0000de20: 696d 652c 0a20 2020 2020 2020 2020 2020  ime,.           
-0000de30: 2063 726f 6e5f 6578 7072 6573 7369 6f6e   cron_expression
-0000de40: 3d63 726f 6e5f 6578 7072 6573 7369 6f6e  =cron_expression
-0000de50: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-0000de60: 2064 6566 205f 5f67 6574 6174 7472 5f5f   def __getattr__
-0000de70: 2873 656c 662c 206e 616d 6529 3a0a 2020  (self, name):.  
-0000de80: 2020 2020 2020 7472 793a 0a20 2020 2020        try:.     
-0000de90: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0000dea0: 6c66 2e5f 5f67 6574 6974 656d 5f5f 286e  lf.__getitem__(n
-0000deb0: 616d 6529 0a20 2020 2020 2020 2065 7863  ame).        exc
-0000dec0: 6570 7420 4b65 7945 7272 6f72 3a0a 2020  ept KeyError:.  
-0000ded0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0000dee0: 4174 7472 6962 7574 6545 7272 6f72 280a  AttributeError(.
-0000def0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000df00: 6622 2746 6561 7475 7265 4772 6f75 7027  f"'FeatureGroup'
-0000df10: 206f 626a 6563 7420 6861 7320 6e6f 2061   object has no a
-0000df20: 7474 7269 6275 7465 2027 7b6e 616d 657d  ttribute '{name}
-0000df30: 272e 2022 0a20 2020 2020 2020 2020 2020  '. ".           
-0000df40: 2020 2020 2022 4966 2079 6f75 2061 7265       "If you are
-0000df50: 2074 7279 696e 6720 746f 2061 6363 6573   trying to acces
-0000df60: 7320 6120 6665 6174 7572 652c 2066 616c  s a feature, fal
-0000df70: 6c20 6261 636b 206f 6e20 220a 2020 2020  l back on ".    
-0000df80: 2020 2020 2020 2020 2020 2020 2275 7369              "usi
-0000df90: 6e67 2074 6865 2060 6765 745f 6665 6174  ng the `get_feat
-0000dfa0: 7572 6560 206d 6574 686f 642e 220a 2020  ure` method.".  
-0000dfb0: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
-0000dfc0: 2064 6566 205f 5f67 6574 6974 656d 5f5f   def __getitem__
-0000dfd0: 2873 656c 662c 206e 616d 6529 3a0a 2020  (self, name):.  
-0000dfe0: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
-0000dff0: 6e73 7461 6e63 6528 6e61 6d65 2c20 7374  nstance(name, st
-0000e000: 7229 3a0a 2020 2020 2020 2020 2020 2020  r):.            
-0000e010: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
-0000e020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000e030: 2066 2245 7870 6563 7465 6420 7479 7065   f"Expected type
-0000e040: 2060 7374 7260 2c20 676f 7420 607b 7479   `str`, got `{ty
-0000e050: 7065 286e 616d 6529 7d60 2e20 220a 2020  pe(name)}`. ".  
-0000e060: 2020 2020 2020 2020 2020 2020 2020 2246                "F
-0000e070: 6561 7475 7265 7320 6172 6520 6163 6365  eatures are acce
-0000e080: 7373 6962 6c65 2062 7920 6e61 6d65 2e22  ssible by name."
-0000e090: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-0000e0a0: 2020 2020 2020 2066 6561 7475 7265 203d         feature =
-0000e0b0: 205b 6620 666f 7220 6620 696e 2073 656c   [f for f in sel
-0000e0c0: 662e 5f5f 6765 7461 7474 7269 6275 7465  f.__getattribute
-0000e0d0: 5f5f 2822 5f66 6561 7475 7265 7322 2920  __("_features") 
-0000e0e0: 6966 2066 2e6e 616d 6520 3d3d 206e 616d  if f.name == nam
-0000e0f0: 655d 0a20 2020 2020 2020 2069 6620 6c65  e].        if le
-0000e100: 6e28 6665 6174 7572 6529 203d 3d20 313a  n(feature) == 1:
-0000e110: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-0000e120: 7572 6e20 6665 6174 7572 655b 305d 0a20  urn feature[0]. 
-0000e130: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0000e140: 2020 2020 2020 2020 2072 6169 7365 204b           raise K
-0000e150: 6579 4572 726f 7228 6622 2746 6561 7475  eyError(f"'Featu
-0000e160: 7265 4772 6f75 7027 206f 626a 6563 7420  reGroup' object 
-0000e170: 6861 7320 6e6f 2066 6561 7475 7265 2063  has no feature c
-0000e180: 616c 6c65 6420 277b 6e61 6d65 7d27 2e22  alled '{name}'."
-0000e190: 290a 0a20 2020 2040 7072 6f70 6572 7479  )..    @property
-0000e1a0: 0a20 2020 2064 6566 2073 7461 7469 7374  .    def statist
-0000e1b0: 6963 735f 636f 6e66 6967 2873 656c 6629  ics_config(self)
-0000e1c0: 3a0a 2020 2020 2020 2020 2222 2253 7461  :.        """Sta
-0000e1d0: 7469 7374 6963 7320 636f 6e66 6967 7572  tistics configur
-0000e1e0: 6174 696f 6e20 6f62 6a65 6374 2064 6566  ation object def
-0000e1f0: 696e 696e 6720 7468 6520 7365 7474 696e  ining the settin
-0000e200: 6773 2066 6f72 2073 7461 7469 7374 6963  gs for statistic
-0000e210: 730a 2020 2020 2020 2020 636f 6d70 7574  s.        comput
-0000e220: 6174 696f 6e20 6f66 2074 6865 2066 6561  ation of the fea
-0000e230: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
-0000e240: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
-0000e250: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-0000e260: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-0000e270: 732e 4665 6174 7572 6553 746f 7265 4578  s.FeatureStoreEx
-0000e280: 6365 7074 696f 6e60 2e0a 2020 2020 2020  ception`..      
-0000e290: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-0000e2a0: 6c66 2e5f 6368 6563 6b5f 7374 6174 6973  lf._check_statis
-0000e2b0: 7469 6373 5f73 7570 706f 7274 2829 2020  tics_support()  
-0000e2c0: 2320 7261 6973 6573 2061 6e20 6572 726f  # raises an erro
-0000e2d0: 7220 6966 2073 7461 7473 206e 6f74 2073  r if stats not s
-0000e2e0: 7570 706f 7274 6564 0a20 2020 2020 2020  upported.       
-0000e2f0: 2072 6574 7572 6e20 7365 6c66 2e5f 7374   return self._st
-0000e300: 6174 6973 7469 6373 5f63 6f6e 6669 670a  atistics_config.
-0000e310: 0a20 2020 2040 7374 6174 6973 7469 6373  .    @statistics
-0000e320: 5f63 6f6e 6669 672e 7365 7474 6572 0a20  _config.setter. 
-0000e330: 2020 2064 6566 2073 7461 7469 7374 6963     def statistic
-0000e340: 735f 636f 6e66 6967 2873 656c 662c 2073  s_config(self, s
-0000e350: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
-0000e360: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0000e370: 5f63 6865 636b 5f73 7461 7469 7374 6963  _check_statistic
-0000e380: 735f 7375 7070 6f72 7428 2920 2023 2072  s_support()  # r
-0000e390: 6169 7365 7320 616e 2065 7272 6f72 2069  aises an error i
-0000e3a0: 6620 7374 6174 7320 6e6f 7420 7375 7070  f stats not supp
-0000e3b0: 6f72 7465 640a 2020 2020 2020 2020 6966  orted.        if
-0000e3c0: 2069 7369 6e73 7461 6e63 6528 7374 6174   isinstance(stat
-0000e3d0: 6973 7469 6373 5f63 6f6e 6669 672c 2053  istics_config, S
-0000e3e0: 7461 7469 7374 6963 7343 6f6e 6669 6729  tatisticsConfig)
-0000e3f0: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-0000e400: 6c66 2e5f 7374 6174 6973 7469 6373 5f63  lf._statistics_c
-0000e410: 6f6e 6669 6720 3d20 7374 6174 6973 7469  onfig = statisti
-0000e420: 6373 5f63 6f6e 6669 670a 2020 2020 2020  cs_config.      
-0000e430: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0000e440: 6528 7374 6174 6973 7469 6373 5f63 6f6e  e(statistics_con
-0000e450: 6669 672c 2064 6963 7429 3a0a 2020 2020  fig, dict):.    
-0000e460: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-0000e470: 6174 6973 7469 6373 5f63 6f6e 6669 6720  atistics_config 
-0000e480: 3d20 5374 6174 6973 7469 6373 436f 6e66  = StatisticsConf
-0000e490: 6967 282a 2a73 7461 7469 7374 6963 735f  ig(**statistics_
-0000e4a0: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
-0000e4b0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
-0000e4c0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-0000e4d0: 672c 2062 6f6f 6c29 3a0a 2020 2020 2020  g, bool):.      
-0000e4e0: 2020 2020 2020 7365 6c66 2e5f 7374 6174        self._stat
-0000e4f0: 6973 7469 6373 5f63 6f6e 6669 6720 3d20  istics_config = 
-0000e500: 5374 6174 6973 7469 6373 436f 6e66 6967  StatisticsConfig
-0000e510: 2873 7461 7469 7374 6963 735f 636f 6e66  (statistics_conf
-0000e520: 6967 290a 2020 2020 2020 2020 656c 6966  ig).        elif
-0000e530: 2073 7461 7469 7374 6963 735f 636f 6e66   statistics_conf
-0000e540: 6967 2069 7320 4e6f 6e65 3a0a 2020 2020  ig is None:.    
-0000e550: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-0000e560: 6174 6973 7469 6373 5f63 6f6e 6669 6720  atistics_config 
-0000e570: 3d20 5374 6174 6973 7469 6373 436f 6e66  = StatisticsConf
-0000e580: 6967 2829 0a20 2020 2020 2020 2065 6c73  ig().        els
-0000e590: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
-0000e5a0: 6169 7365 2054 7970 6545 7272 6f72 280a  aise TypeError(.
-0000e5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e5c0: 2254 6865 2061 7267 756d 656e 7420 6073  "The argument `s
-0000e5d0: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
-0000e5e0: 6020 6861 7320 746f 2062 6520 604e 6f6e  ` has to be `Non
-0000e5f0: 6560 206f 6620 7479 7065 2060 5374 6174  e` of type `Stat
-0000e600: 6973 7469 6373 436f 6e66 6967 2c20 6062  isticsConfig, `b
-0000e610: 6f6f 6c60 206f 7220 6064 6963 7460 2c20  ool` or `dict`, 
-0000e620: 6275 7420 6973 206f 6620 7479 7065 3a20  but is of type: 
-0000e630: 607b 7d60 222e 666f 726d 6174 280a 2020  `{}`".format(.  
-0000e640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000e650: 2020 7479 7065 2873 7461 7469 7374 6963    type(statistic
-0000e660: 735f 636f 6e66 6967 290a 2020 2020 2020  s_config).      
-0000e670: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-0000e680: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0000e690: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000e6a0: 2066 6561 7475 7265 5f73 746f 7265 5f69   feature_store_i
-0000e6b0: 6428 7365 6c66 293a 0a20 2020 2020 2020  d(self):.       
-0000e6c0: 2072 6574 7572 6e20 7365 6c66 2e5f 6665   return self._fe
-0000e6d0: 6174 7572 655f 7374 6f72 655f 6964 0a0a  ature_store_id..
-0000e6e0: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-0000e6f0: 2020 6465 6620 6665 6174 7572 655f 7374    def feature_st
-0000e700: 6f72 6528 7365 6c66 293a 0a20 2020 2020  ore(self):.     
-0000e710: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
-0000e720: 6665 6174 7572 655f 7374 6f72 650a 0a20  feature_store.. 
-0000e730: 2020 2040 6665 6174 7572 655f 7374 6f72     @feature_stor
-0000e740: 652e 7365 7474 6572 0a20 2020 2064 6566  e.setter.    def
-0000e750: 2066 6561 7475 7265 5f73 746f 7265 2873   feature_store(s
-0000e760: 656c 662c 2066 6561 7475 7265 5f73 746f  elf, feature_sto
-0000e770: 7265 293a 0a20 2020 2020 2020 2073 656c  re):.        sel
-0000e780: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-0000e790: 203d 2066 6561 7475 7265 5f73 746f 7265   = feature_store
-0000e7a0: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-0000e7b0: 2020 2020 6465 6620 6e61 6d65 2873 656c      def name(sel
-0000e7c0: 6629 3a0a 2020 2020 2020 2020 2222 224e  f):.        """N
-0000e7d0: 616d 6520 6f66 2074 6865 2066 6561 7475  ame of the featu
-0000e7e0: 7265 2067 726f 7570 2e22 2222 0a20 2020  re group.""".   
-0000e7f0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-0000e800: 2e5f 6e61 6d65 0a0a 2020 2020 4070 726f  ._name..    @pro
-0000e810: 7065 7274 790a 2020 2020 6465 6620 7665  perty.    def ve
-0000e820: 7273 696f 6e28 7365 6c66 293a 0a20 2020  rsion(self):.   
-0000e830: 2020 2020 2022 2222 5665 7273 696f 6e20       """Version 
-0000e840: 6e75 6d62 6572 206f 6620 7468 6520 6665  number of the fe
-0000e850: 6174 7572 6520 6772 6f75 702e 2222 220a  ature group.""".
-0000e860: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000e870: 656c 662e 5f76 6572 7369 6f6e 0a0a 2020  elf._version..  
-0000e880: 2020 4076 6572 7369 6f6e 2e73 6574 7465    @version.sette
-0000e890: 720a 2020 2020 6465 6620 7665 7273 696f  r.    def versio
-0000e8a0: 6e28 7365 6c66 2c20 7665 7273 696f 6e29  n(self, version)
-0000e8b0: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
-0000e8c0: 7665 7273 696f 6e20 3d20 7665 7273 696f  version = versio
-0000e8d0: 6e0a 0a20 2020 2064 6566 2067 6574 5f66  n..    def get_f
-0000e8e0: 675f 6e61 6d65 2873 656c 6629 3a0a 2020  g_name(self):.  
-0000e8f0: 2020 2020 2020 7265 7475 726e 2066 227b        return f"{
-0000e900: 7365 6c66 2e6e 616d 657d 5f7b 7365 6c66  self.name}_{self
-0000e910: 2e76 6572 7369 6f6e 7d22 0a0a 2020 2020  .version}"..    
-0000e920: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-0000e930: 6620 7374 6174 6973 7469 6373 2873 656c  f statistics(sel
-0000e940: 6629 3a0a 2020 2020 2020 2020 2222 2247  f):.        """G
-0000e950: 6574 2074 6865 206c 6174 6573 7420 636f  et the latest co
-0000e960: 6d70 7574 6564 2073 7461 7469 7374 6963  mputed statistic
-0000e970: 7320 666f 7220 7468 6520 7768 6f6c 6520  s for the whole 
-0000e980: 6665 6174 7572 6520 6772 6f75 702e 0a0a  feature group...
-0000e990: 2020 2020 2020 2020 2320 5261 6973 6573          # Raises
-0000e9a0: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
-0000e9b0: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
-0000e9c0: 696f 6e73 2e46 6561 7475 7265 5374 6f72  ions.FeatureStor
-0000e9d0: 6545 7863 6570 7469 6f6e 602e 0a20 2020  eException`..   
-0000e9e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0000e9f0: 2073 656c 662e 5f63 6865 636b 5f73 7461   self._check_sta
-0000ea00: 7469 7374 6963 735f 7375 7070 6f72 7428  tistics_support(
-0000ea10: 2920 2023 2072 6169 7365 7320 616e 2065  )  # raises an e
-0000ea20: 7272 6f72 2069 6620 7374 6174 7320 6e6f  rror if stats no
-0000ea30: 7420 7375 7070 6f72 7465 640a 2020 2020  t supported.    
-0000ea40: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0000ea50: 5f73 7461 7469 7374 6963 735f 656e 6769  _statistics_engi
-0000ea60: 6e65 2e67 6574 2873 656c 6629 0a0a 2020  ne.get(self)..  
-0000ea70: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
-0000ea80: 6465 6620 7072 696d 6172 795f 6b65 7928  def primary_key(
-0000ea90: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-0000eaa0: 2222 4c69 7374 206f 6620 6665 6174 7572  ""List of featur
-0000eab0: 6573 2062 7569 6c64 696e 6720 7468 6520  es building the 
-0000eac0: 7072 696d 6172 7920 6b65 792e 2222 220a  primary key.""".
-0000ead0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0000eae0: 656c 662e 5f70 7269 6d61 7279 5f6b 6579  elf._primary_key
-0000eaf0: 0a0a 2020 2020 4070 7269 6d61 7279 5f6b  ..    @primary_k
-0000eb00: 6579 2e73 6574 7465 720a 2020 2020 6465  ey.setter.    de
-0000eb10: 6620 7072 696d 6172 795f 6b65 7928 7365  f primary_key(se
-0000eb20: 6c66 2c20 6e65 775f 7072 696d 6172 795f  lf, new_primary_
-0000eb30: 6b65 7929 3a0a 2020 2020 2020 2020 7365  key):.        se
-0000eb40: 6c66 2e5f 7072 696d 6172 795f 6b65 7920  lf._primary_key 
-0000eb50: 3d20 5b70 6b2e 6c6f 7765 7228 2920 666f  = [pk.lower() fo
-0000eb60: 7220 706b 2069 6e20 6e65 775f 7072 696d  r pk in new_prim
-0000eb70: 6172 795f 6b65 795d 0a0a 2020 2020 6465  ary_key]..    de
-0000eb80: 6620 6765 745f 7374 6174 6973 7469 6373  f get_statistics
-0000eb90: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0000eba0: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
-0000ebb0: 696f 6e5f 7469 6d65 3a20 4f70 7469 6f6e  ion_time: Option
-0000ebc0: 616c 5b55 6e69 6f6e 5b73 7472 2c20 696e  al[Union[str, in
-0000ebd0: 742c 2066 6c6f 6174 2c20 6461 7465 7469  t, float, dateti
-0000ebe0: 6d65 2c20 6461 7465 5d5d 203d 204e 6f6e  me, date]] = Non
-0000ebf0: 652c 0a20 2020 2020 2020 2066 6561 7475  e,.        featu
-0000ec00: 7265 5f6e 616d 6573 3a20 4f70 7469 6f6e  re_names: Option
-0000ec10: 616c 5b4c 6973 745b 7374 725d 5d20 3d20  al[List[str]] = 
-0000ec20: 4e6f 6e65 2c0a 2020 2020 2920 2d3e 204f  None,.    ) -> O
-0000ec30: 7074 696f 6e61 6c5b 5374 6174 6973 7469  ptional[Statisti
-0000ec40: 6373 5d3a 0a20 2020 2020 2020 2022 2222  cs]:.        """
-0000ec50: 5265 7475 726e 7320 7468 6520 7374 6174  Returns the stat
-0000ec60: 6973 7469 6373 2063 6f6d 7075 7465 6420  istics computed 
-0000ec70: 6174 2061 2073 7065 6369 6669 6320 7469  at a specific ti
-0000ec80: 6d65 2066 6f72 2074 6865 2063 7572 7265  me for the curre
-0000ec90: 6e74 2066 6561 7475 7265 2067 726f 7570  nt feature group
-0000eca0: 2e0a 0a20 2020 2020 2020 2049 6620 6063  ...        If `c
-0000ecb0: 6f6d 7075 7461 7469 6f6e 5f74 696d 6560  omputation_time`
-0000ecc0: 2069 7320 604e 6f6e 6560 2c20 7468 6520   is `None`, the 
-0000ecd0: 6d6f 7374 2072 6563 656e 7420 7374 6174  most recent stat
-0000ece0: 6973 7469 6373 2061 7265 2072 6574 7572  istics are retur
-0000ecf0: 6e65 642e 0a0a 2020 2020 2020 2020 2121  ned...        !!
-0000ed00: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-0000ed10: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-0000ed20: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-0000ed30: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
-0000ed40: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
-0000ed50: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
-0000ed60: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
-0000ed70: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
-0000ed80: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
-0000ed90: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
-0000eda0: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
-0000edb0: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
-0000edc0: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
-0000edd0: 6667 5f73 7461 7469 7374 6963 7320 3d20  fg_statistics = 
-0000ede0: 6667 2e67 6574 5f73 7461 7469 7374 6963  fg.get_statistic
-0000edf0: 7328 636f 6d70 7574 6174 696f 6e5f 7469  s(computation_ti
-0000ee00: 6d65 3d4e 6f6e 6529 0a20 2020 2020 2020  me=None).       
-0000ee10: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
-0000ee20: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-0000ee30: 2020 2020 2020 2020 2020 636f 6d70 7574            comput
-0000ee40: 6174 696f 6e5f 7469 6d65 3a20 4461 7465  ation_time: Date
-0000ee50: 2061 6e64 2074 696d 6520 7768 656e 2073   and time when s
-0000ee60: 7461 7469 7374 6963 7320 7765 7265 2063  tatistics were c
-0000ee70: 6f6d 7075 7465 642e 2044 6566 6175 6c74  omputed. Default
-0000ee80: 7320 746f 2060 4e6f 6e65 602e 2053 7472  s to `None`. Str
-0000ee90: 696e 6773 2073 686f 756c 640a 2020 2020  ings should.    
-0000eea0: 2020 2020 2020 2020 2020 2020 6265 2066              be f
-0000eeb0: 6f72 6d61 7474 6564 2069 6e20 6f6e 6520  ormatted in one 
-0000eec0: 6f66 2074 6865 2066 6f6c 6c6f 7769 6e67  of the following
-0000eed0: 2066 6f72 6d61 7473 2060 2559 2d25 6d2d   formats `%Y-%m-
-0000eee0: 2564 602c 2060 2559 2d25 6d2d 2564 2025  %d`, `%Y-%m-%d %
-0000eef0: 4860 2c20 6025 592d 256d 2d25 6420 2548  H`, `%Y-%m-%d %H
-0000ef00: 3a25 4d60 2c20 6025 592d 256d 2d25 6420  :%M`, `%Y-%m-%d 
-0000ef10: 2548 3a25 4d3a 2553 602c 0a20 2020 2020  %H:%M:%S`,.     
-0000ef20: 2020 2020 2020 2020 2020 206f 7220 6025             or `%
-0000ef30: 592d 256d 2d25 6420 2548 3a25 4d3a 2553  Y-%m-%d %H:%M:%S
-0000ef40: 2e25 6660 2e0a 2020 2020 2020 2020 2020  .%f`..          
-0000ef50: 2020 6665 6174 7572 655f 6e61 6d65 733a    feature_names:
-0000ef60: 204c 6973 7420 6f66 2066 6561 7475 7265   List of feature
-0000ef70: 206e 616d 6573 206f 6620 7768 6963 6820   names of which 
-0000ef80: 7374 6174 6973 7469 6373 2061 7265 2072  statistics are r
-0000ef90: 6574 7269 6576 6564 2e0a 2020 2020 2020  etrieved..      
-0000efa0: 2020 2320 5265 7475 726e 730a 2020 2020    # Returns.    
-0000efb0: 2020 2020 2020 2020 6053 7461 7469 7374          `Statist
-0000efc0: 6963 7360 2e20 5374 6174 6973 7469 6373  ics`. Statistics
-0000efd0: 206f 626a 6563 742e 0a0a 2020 2020 2020   object...      
-0000efe0: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
-0000eff0: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-0000f000: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
-0000f010: 6573 7441 5049 4572 726f 7260 0a20 2020  estAPIError`.   
-0000f020: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
-0000f030: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-0000f040: 2e46 6561 7475 7265 5374 6f72 6545 7863  .FeatureStoreExc
-0000f050: 6570 7469 6f6e 602e 0a20 2020 2020 2020  eption`..       
-0000f060: 2022 2222 0a20 2020 2020 2020 2073 656c   """.        sel
-0000f070: 662e 5f63 6865 636b 5f73 7461 7469 7374  f._check_statist
-0000f080: 6963 735f 7375 7070 6f72 7428 2920 2023  ics_support()  #
-0000f090: 2072 6169 7365 7320 616e 2065 7272 6f72   raises an error
-0000f0a0: 2069 6620 7374 6174 7320 6e6f 7420 7375   if stats not su
-0000f0b0: 7070 6f72 7465 640a 2020 2020 2020 2020  pported.        
-0000f0c0: 7265 7475 726e 2073 656c 662e 5f73 7461  return self._sta
-0000f0d0: 7469 7374 6963 735f 656e 6769 6e65 2e67  tistics_engine.g
-0000f0e0: 6574 280a 2020 2020 2020 2020 2020 2020  et(.            
-0000f0f0: 7365 6c66 2c20 636f 6d70 7574 6174 696f  self, computatio
-0000f100: 6e5f 7469 6d65 3d63 6f6d 7075 7461 7469  n_time=computati
-0000f110: 6f6e 5f74 696d 652c 2066 6561 7475 7265  on_time, feature
-0000f120: 5f6e 616d 6573 3d66 6561 7475 7265 5f6e  _names=feature_n
-0000f130: 616d 6573 0a20 2020 2020 2020 2029 0a0a  ames.        )..
-0000f140: 2020 2020 6465 6620 6765 745f 616c 6c5f      def get_all_
-0000f150: 7374 6174 6973 7469 6373 280a 2020 2020  statistics(.    
-0000f160: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-0000f170: 2020 636f 6d70 7574 6174 696f 6e5f 7469    computation_ti
-0000f180: 6d65 3a20 4f70 7469 6f6e 616c 5b55 6e69  me: Optional[Uni
-0000f190: 6f6e 5b73 7472 2c20 696e 742c 2066 6c6f  on[str, int, flo
-0000f1a0: 6174 2c20 6461 7465 7469 6d65 2c20 6461  at, datetime, da
-0000f1b0: 7465 5d5d 203d 204e 6f6e 652c 0a20 2020  te]] = None,.   
-0000f1c0: 2020 2020 2066 6561 7475 7265 5f6e 616d       feature_nam
-0000f1d0: 6573 3a20 4f70 7469 6f6e 616c 5b4c 6973  es: Optional[Lis
-0000f1e0: 745b 7374 725d 5d20 3d20 4e6f 6e65 2c0a  t[str]] = None,.
-0000f1f0: 2020 2020 2920 2d3e 204f 7074 696f 6e61      ) -> Optiona
-0000f200: 6c5b 4c69 7374 5b53 7461 7469 7374 6963  l[List[Statistic
-0000f210: 735d 5d3a 0a20 2020 2020 2020 2022 2222  s]]:.        """
-0000f220: 5265 7475 726e 7320 616c 6c20 7468 6520  Returns all the 
-0000f230: 7374 6174 6973 7469 6373 206d 6574 6164  statistics metad
-0000f240: 6174 6120 636f 6d70 7574 6564 2062 6566  ata computed bef
-0000f250: 6f72 6520 6120 7370 6563 6966 6963 2074  ore a specific t
-0000f260: 696d 6520 666f 7220 7468 6520 6375 7272  ime for the curr
-0000f270: 656e 7420 6665 6174 7572 6520 6772 6f75  ent feature grou
-0000f280: 702e 0a0a 2020 2020 2020 2020 4966 2060  p...        If `
-0000f290: 636f 6d70 7574 6174 696f 6e5f 7469 6d65  computation_time
-0000f2a0: 6020 6973 2060 4e6f 6e65 602c 2061 6c6c  ` is `None`, all
-0000f2b0: 2074 6865 2073 7461 7469 7374 6963 7320   the statistics 
-0000f2c0: 6d65 7461 6461 7461 2061 7265 2072 6574  metadata are ret
-0000f2d0: 7572 6e65 642e 0a0a 2020 2020 2020 2020  urned...        
-0000f2e0: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
-0000f2f0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
-0000f300: 6e0a 2020 2020 2020 2020 2020 2020 2320  n.            # 
-0000f310: 636f 6e6e 6563 7420 746f 2074 6865 2046  connect to the F
-0000f320: 6561 7475 7265 2053 746f 7265 0a20 2020  eature Store.   
-0000f330: 2020 2020 2020 2020 2066 7320 3d20 2e2e           fs = ..
-0000f340: 2e0a 0a20 2020 2020 2020 2020 2020 2023  ...            #
-0000f350: 2067 6574 2074 6865 2046 6561 7475 7265   get the Feature
-0000f360: 2047 726f 7570 2069 6e73 7461 6e63 650a   Group instance.
-0000f370: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
-0000f380: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
-0000f390: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
-0000f3a0: 2e2e 2e29 0a0a 2020 2020 2020 2020 2020  ...)..          
-0000f3b0: 2020 6667 5f73 7461 7469 7374 6963 7320    fg_statistics 
-0000f3c0: 3d20 6667 2e67 6574 5f73 7461 7469 7374  = fg.get_statist
-0000f3d0: 6963 7328 636f 6d70 7574 6174 696f 6e5f  ics(computation_
-0000f3e0: 7469 6d65 3d4e 6f6e 6529 0a20 2020 2020  time=None).     
-0000f3f0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-0000f400: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-0000f410: 2020 2020 2020 2020 2020 2020 636f 6d70              comp
-0000f420: 7574 6174 696f 6e5f 7469 6d65 3a20 4461  utation_time: Da
-0000f430: 7465 2061 6e64 2074 696d 6520 7768 656e  te and time when
-0000f440: 2073 7461 7469 7374 6963 7320 7765 7265   statistics were
-0000f450: 2063 6f6d 7075 7465 642e 2044 6566 6175   computed. Defau
-0000f460: 6c74 7320 746f 2060 4e6f 6e65 602e 2053  lts to `None`. S
-0000f470: 7472 696e 6773 2073 686f 756c 640a 2020  trings should.  
-0000f480: 2020 2020 2020 2020 2020 2020 2020 6265                be
-0000f490: 2066 6f72 6d61 7474 6564 2069 6e20 6f6e   formatted in on
-0000f4a0: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
-0000f4b0: 6e67 2066 6f72 6d61 7473 2060 2559 2d25  ng formats `%Y-%
-0000f4c0: 6d2d 2564 602c 2060 2559 2d25 6d2d 2564  m-%d`, `%Y-%m-%d
-0000f4d0: 2025 4860 2c20 6025 592d 256d 2d25 6420   %H`, `%Y-%m-%d 
-0000f4e0: 2548 3a25 4d60 2c20 6025 592d 256d 2d25  %H:%M`, `%Y-%m-%
-0000f4f0: 6420 2548 3a25 4d3a 2553 602c 0a20 2020  d %H:%M:%S`,.   
-0000f500: 2020 2020 2020 2020 2020 2020 206f 7220               or 
-0000f510: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
-0000f520: 2553 2e25 6660 2e0a 2020 2020 2020 2020  %S.%f`..        
-0000f530: 2020 2020 6665 6174 7572 655f 6e61 6d65      feature_name
-0000f540: 733a 204c 6973 7420 6f66 2066 6561 7475  s: List of featu
-0000f550: 7265 206e 616d 6573 206f 6620 7768 6963  re names of whic
-0000f560: 6820 7374 6174 6973 7469 6373 2061 7265  h statistics are
-0000f570: 2072 6574 7269 6576 6564 2e0a 2020 2020   retrieved..    
-0000f580: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
-0000f590: 2020 2020 2020 2020 2020 6053 7461 7469            `Stati
-0000f5a0: 7374 6963 7360 2e20 5374 6174 6973 7469  stics`. Statisti
-0000f5b0: 6373 206f 626a 6563 742e 0a0a 2020 2020  cs object...    
-0000f5c0: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
-0000f5d0: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
-0000f5e0: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
-0000f5f0: 2e52 6573 7441 5049 4572 726f 7260 0a20  .RestAPIError`. 
-0000f600: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
-0000f610: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-0000f620: 6e73 2e46 6561 7475 7265 5374 6f72 6545  ns.FeatureStoreE
-0000f630: 7863 6570 7469 6f6e 602e 0a20 2020 2020  xception`..     
-0000f640: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
-0000f650: 656c 662e 5f63 6865 636b 5f73 7461 7469  elf._check_stati
-0000f660: 7374 6963 735f 7375 7070 6f72 7428 2920  stics_support() 
-0000f670: 2023 2072 6169 7365 7320 616e 2065 7272   # raises an err
-0000f680: 6f72 2069 6620 7374 6174 7320 6e6f 7420  or if stats not 
-0000f690: 7375 7070 6f72 7465 640a 2020 2020 2020  supported.      
-0000f6a0: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
-0000f6b0: 7461 7469 7374 6963 735f 656e 6769 6e65  tatistics_engine
-0000f6c0: 2e67 6574 5f61 6c6c 280a 2020 2020 2020  .get_all(.      
-0000f6d0: 2020 2020 2020 7365 6c66 2c20 636f 6d70        self, comp
-0000f6e0: 7574 6174 696f 6e5f 7469 6d65 3d63 6f6d  utation_time=com
-0000f6f0: 7075 7461 7469 6f6e 5f74 696d 652c 2066  putation_time, f
-0000f700: 6561 7475 7265 5f6e 616d 6573 3d66 6561  eature_names=fea
-0000f710: 7475 7265 5f6e 616d 6573 0a20 2020 2020  ture_names.     
-0000f720: 2020 2029 0a0a 2020 2020 6465 6620 636f     )..    def co
-0000f730: 6d70 7574 655f 7374 6174 6973 7469 6373  mpute_statistics
-0000f740: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000f750: 2222 2252 6563 6f6d 7075 7465 2074 6865  """Recompute the
-0000f760: 2073 7461 7469 7374 6963 7320 666f 7220   statistics for 
-0000f770: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-0000f780: 7020 616e 6420 7361 7665 2074 6865 6d20  p and save them 
-0000f790: 746f 2074 6865 0a20 2020 2020 2020 2066  to the.        f
-0000f7a0: 6561 7475 7265 2073 746f 7265 2e0a 2020  eature store..  
-0000f7b0: 2020 2020 2020 5374 6174 6973 7469 6373        Statistics
-0000f7c0: 2061 7265 206f 6e6c 7920 636f 6d70 7574   are only comput
-0000f7d0: 6564 2066 6f72 2064 6174 6120 696e 2074  ed for data in t
-0000f7e0: 6865 206f 6666 6c69 6e65 2073 746f 7261  he offline stora
-0000f7f0: 6765 206f 6620 7468 6520 6665 6174 7572  ge of the featur
-0000f800: 650a 2020 2020 2020 2020 6772 6f75 702e  e.        group.
-0000f810: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
-0000f820: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-0000f830: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-0000f840: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-0000f850: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-0000f860: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-0000f870: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-0000f880: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-0000f890: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-0000f8a0: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-0000f8b0: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
-0000f8c0: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
-0000f8d0: 7572 655f 6772 6f75 7028 2e2e 2e29 0a0a  ure_group(...)..
-0000f8e0: 2020 2020 2020 2020 2020 2020 7374 6174              stat
-0000f8f0: 6973 7469 6373 5f6d 6574 6164 6174 6120  istics_metadata 
-0000f900: 3d20 6667 2e63 6f6d 7075 7465 5f73 7461  = fg.compute_sta
-0000f910: 7469 7374 6963 7328 290a 2020 2020 2020  tistics().      
-0000f920: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
-0000f930: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
-0000f940: 2020 2020 2020 2020 2060 5374 6174 6973           `Statis
-0000f950: 7469 6373 602e 2054 6865 2073 7461 7469  tics`. The stati
-0000f960: 7374 6963 7320 6d65 7461 6461 7461 206f  stics metadata o
-0000f970: 626a 6563 742e 0a0a 2020 2020 2020 2020  bject...        
-0000f980: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
-0000f990: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
-0000f9a0: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
-0000f9b0: 7441 5049 4572 726f 7260 2e20 556e 6162  tAPIError`. Unab
-0000f9c0: 6c65 2074 6f20 7065 7273 6973 7420 7468  le to persist th
-0000f9d0: 6520 7374 6174 6973 7469 6373 2e0a 2020  e statistics..  
-0000f9e0: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-0000f9f0: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-0000fa00: 732e 4665 6174 7572 6553 746f 7265 4578  s.FeatureStoreEx
-0000fa10: 6365 7074 696f 6e60 2e0a 2020 2020 2020  ception`..      
-0000fa20: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
-0000fa30: 6c66 2e5f 6368 6563 6b5f 7374 6174 6973  lf._check_statis
-0000fa40: 7469 6373 5f73 7570 706f 7274 2829 2020  tics_support()  
-0000fa50: 2320 7261 6973 6573 2061 6e20 6572 726f  # raises an erro
-0000fa60: 7220 6966 2073 7461 7473 206e 6f74 2073  r if stats not s
-0000fa70: 7570 706f 7274 6564 0a20 2020 2020 2020  upported.       
-0000fa80: 2069 6620 7365 6c66 2e73 7461 7469 7374   if self.statist
-0000fa90: 6963 735f 636f 6e66 6967 2e65 6e61 626c  ics_config.enabl
-0000faa0: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-0000fab0: 2320 446f 6e27 7420 7265 6164 2074 6865  # Don't read the
-0000fac0: 2064 6174 6166 7261 6d65 2068 6572 652c   dataframe here,
-0000fad0: 2074 6f20 6176 6f69 6420 7472 6967 6765   to avoid trigge
-0000fae0: 7269 6e67 2061 2072 6561 6420 6f70 6572  ring a read oper
-0000faf0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-0000fb00: 2020 2320 666f 7220 7468 6520 5079 7468    # for the Pyth
-0000fb10: 6f6e 2065 6e67 696e 652e 2054 6865 2050  on engine. The P
-0000fb20: 7974 686f 6e20 656e 6769 6e65 2069 7320  ython engine is 
-0000fb30: 676f 696e 6720 746f 2073 6574 7570 2061  going to setup a
-0000fb40: 2053 7061 726b 204a 6f62 0a20 2020 2020   Spark Job.     
-0000fb50: 2020 2020 2020 2023 2074 6f20 7570 6461         # to upda
-0000fb60: 7465 2074 6865 2073 7461 7469 7374 6963  te the statistic
-0000fb70: 732e 0a20 2020 2020 2020 2020 2020 2073  s..            s
-0000fb80: 656c 662e 5f73 7461 7469 7374 6963 735f  elf._statistics_
-0000fb90: 656e 6769 6e65 2e63 6f6d 7075 7465 5f61  engine.compute_a
-0000fba0: 6e64 5f73 6176 655f 7374 6174 6973 7469  nd_save_statisti
-0000fbb0: 6373 2873 656c 6629 0a20 2020 2020 2020  cs(self).       
-0000fbc0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
-0000fbd0: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-0000fbe0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0000fbf0: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-0000fc00: 2020 2020 2020 2020 2254 6865 2073 7461          "The sta
-0000fc10: 7469 7374 6963 7320 6172 6520 6e6f 7420  tistics are not 
-0000fc20: 656e 6162 6c65 6420 6f66 2066 6561 7475  enabled of featu
-0000fc30: 7265 2067 726f 7570 2060 7b7d 602c 2077  re group `{}`, w
-0000fc40: 6974 6820 7665 7273 696f 6e22 0a20 2020  ith version".   
-0000fc50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000fc60: 2022 2060 7b7d 602e 204e 6f20 7374 6174   " `{}`. No stat
-0000fc70: 6973 7469 6373 2063 6f6d 7075 7465 642e  istics computed.
-0000fc80: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0000fc90: 2020 292e 666f 726d 6174 2873 656c 662e    ).format(self.
-0000fca0: 5f6e 616d 652c 2073 656c 662e 5f76 6572  _name, self._ver
-0000fcb0: 7369 6f6e 292c 0a20 2020 2020 2020 2020  sion),.         
-0000fcc0: 2020 2020 2020 2075 7469 6c2e 5374 6f72         util.Stor
-0000fcd0: 6167 6557 6172 6e69 6e67 2c0a 2020 2020  ageWarning,.    
-0000fce0: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-0000fcf0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-0000fd00: 2065 6d62 6564 6469 6e67 5f69 6e64 6578   embedding_index
-0000fd10: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-0000fd20: 6966 2073 656c 662e 5f65 6d62 6564 6469  if self._embeddi
-0000fd30: 6e67 5f69 6e64 6578 3a0a 2020 2020 2020  ng_index:.      
-0000fd40: 2020 2020 2020 7365 6c66 2e5f 656d 6265        self._embe
-0000fd50: 6464 696e 675f 696e 6465 782e 6665 6174  dding_index.feat
-0000fd60: 7572 655f 6772 6f75 7020 3d20 7365 6c66  ure_group = self
-0000fd70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000fd80: 7365 6c66 2e5f 656d 6265 6464 696e 675f  self._embedding_
-0000fd90: 696e 6465 780a 0a20 2020 2040 656d 6265  index..    @embe
-0000fda0: 6464 696e 675f 696e 6465 782e 7365 7474  dding_index.sett
-0000fdb0: 6572 0a20 2020 2064 6566 2065 6d62 6564  er.    def embed
-0000fdc0: 6469 6e67 5f69 6e64 6578 2873 656c 662c  ding_index(self,
-0000fdd0: 2065 6d62 6564 6469 6e67 5f69 6e64 6578   embedding_index
-0000fde0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-0000fdf0: 5f65 6d62 6564 6469 6e67 5f69 6e64 6578  _embedding_index
-0000fe00: 203d 2065 6d62 6564 6469 6e67 5f69 6e64   = embedding_ind
-0000fe10: 6578 0a0a 2020 2020 4070 726f 7065 7274  ex..    @propert
-0000fe20: 790a 2020 2020 6465 6620 6576 656e 745f  y.    def event_
-0000fe30: 7469 6d65 2873 656c 6629 3a0a 2020 2020  time(self):.    
-0000fe40: 2020 2020 2222 2245 7665 6e74 2074 696d      """Event tim
-0000fe50: 6520 6665 6174 7572 6520 696e 2074 6865  e feature in the
-0000fe60: 2066 6561 7475 7265 2067 726f 7570 2e22   feature group."
-0000fe70: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-0000fe80: 6e20 7365 6c66 2e5f 6576 656e 745f 7469  n self._event_ti
-0000fe90: 6d65 0a0a 2020 2020 4065 7665 6e74 5f74  me..    @event_t
-0000fea0: 696d 652e 7365 7474 6572 0a20 2020 2064  ime.setter.    d
-0000feb0: 6566 2065 7665 6e74 5f74 696d 6528 7365  ef event_time(se
-0000fec0: 6c66 2c20 6665 6174 7572 655f 6e61 6d65  lf, feature_name
-0000fed0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d29  : Optional[str])
-0000fee0: 3a0a 2020 2020 2020 2020 6966 2066 6561  :.        if fea
-0000fef0: 7475 7265 5f6e 616d 6520 6973 204e 6f6e  ture_name is Non
-0000ff00: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-0000ff10: 656c 662e 5f65 7665 6e74 5f74 696d 6520  elf._event_time 
-0000ff20: 3d20 4e6f 6e65 0a20 2020 2020 2020 2020  = None.         
-0000ff30: 2020 2072 6574 7572 6e0a 2020 2020 2020     return.      
-0000ff40: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-0000ff50: 6528 6665 6174 7572 655f 6e61 6d65 2c20  e(feature_name, 
-0000ff60: 7374 7229 3a0a 2020 2020 2020 2020 2020  str):.          
-0000ff70: 2020 7365 6c66 2e5f 6576 656e 745f 7469    self._event_ti
-0000ff80: 6d65 203d 2066 6561 7475 7265 5f6e 616d  me = feature_nam
-0000ff90: 650a 2020 2020 2020 2020 2020 2020 7265  e.            re
-0000ffa0: 7475 726e 0a20 2020 2020 2020 2065 6c69  turn.        eli
-0000ffb0: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
-0000ffc0: 7475 7265 5f6e 616d 652c 206c 6973 7429  ture_name, list)
-0000ffd0: 2061 6e64 206c 656e 2866 6561 7475 7265   and len(feature
-0000ffe0: 5f6e 616d 6529 203d 3d20 313a 0a20 2020  _name) == 1:.   
-0000fff0: 2020 2020 2020 2020 2069 6620 6973 696e           if isin
-00010000: 7374 616e 6365 2866 6561 7475 7265 5f6e  stance(feature_n
-00010010: 616d 655b 305d 2c20 7374 7229 3a0a 2020  ame[0], str):.  
-00010020: 2020 2020 2020 2020 2020 2020 2020 7761                wa
-00010030: 726e 696e 6773 2e77 6172 6e28 0a20 2020  rnings.warn(.   
-00010040: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010050: 2022 5072 6f76 6964 696e 6720 6576 656e   "Providing even
-00010060: 745f 7469 6d65 2061 7320 6120 7369 6e67  t_time as a sing
-00010070: 6c65 2d65 6c65 6d65 6e74 206c 6973 7420  le-element list 
-00010080: 6973 2064 6570 7265 6361 7465 6422 0a20  is deprecated". 
-00010090: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000100a0: 2020 202b 2022 2061 6e64 2077 696c 6c20     + " and will 
-000100b0: 6265 2064 726f 7070 6564 2069 6e20 6675  be dropped in fu
-000100c0: 7475 7265 2076 6572 7369 6f6e 732e 2050  ture versions. P
-000100d0: 726f 7669 6465 2074 6865 2066 6561 7475  rovide the featu
-000100e0: 7265 5f6e 616d 6520 7374 7269 6e67 2069  re_name string i
-000100f0: 6e73 7465 6164 2e22 2c0a 2020 2020 2020  nstead.",.      
-00010100: 2020 2020 2020 2020 2020 2020 2020 4465                De
-00010110: 7072 6563 6174 696f 6e57 6172 6e69 6e67  precationWarning
-00010120: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00010130: 2020 2020 2020 7374 6163 6b6c 6576 656c        stacklevel
-00010140: 3d32 2c0a 2020 2020 2020 2020 2020 2020  =2,.            
-00010150: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00010160: 2020 2020 2020 7365 6c66 2e5f 6576 656e        self._even
-00010170: 745f 7469 6d65 203d 2066 6561 7475 7265  t_time = feature
-00010180: 5f6e 616d 655b 305d 0a20 2020 2020 2020  _name[0].       
-00010190: 2020 2020 2020 2020 2072 6574 7572 6e0a           return.
-000101a0: 0a20 2020 2020 2020 2072 6169 7365 2056  .        raise V
-000101b0: 616c 7565 4572 726f 7228 0a20 2020 2020  alueError(.     
-000101c0: 2020 2020 2020 2022 6576 656e 745f 7469         "event_ti
-000101d0: 6d65 206d 7573 7420 6265 2061 2073 7472  me must be a str
-000101e0: 696e 6720 636f 7272 6573 706f 6e64 696e  ing correspondin
-000101f0: 6720 746f 2061 6e20 6578 6973 7469 6e67  g to an existing
-00010200: 2066 6561 7475 7265 206e 616d 6520 6f66   feature name of
-00010210: 2074 6865 2046 6561 7475 7265 2047 726f   the Feature Gro
-00010220: 7570 2e22 0a20 2020 2020 2020 2029 0a0a  up.".        )..
-00010230: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00010240: 2020 6465 6620 6c6f 6361 7469 6f6e 2873    def location(s
-00010250: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
-00010260: 7475 726e 2073 656c 662e 5f6c 6f63 6174  turn self._locat
-00010270: 696f 6e0a 0a20 2020 2040 7072 6f70 6572  ion..    @proper
-00010280: 7479 0a20 2020 2064 6566 2065 7870 6563  ty.    def expec
-00010290: 7461 7469 6f6e 5f73 7569 7465 280a 2020  tation_suite(.  
-000102a0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-000102b0: 2920 2d3e 204f 7074 696f 6e61 6c5b 4578  ) -> Optional[Ex
-000102c0: 7065 6374 6174 696f 6e53 7569 7465 5d3a  pectationSuite]:
-000102d0: 0a20 2020 2020 2020 2022 2222 4578 7065  .        """Expe
-000102e0: 6374 6174 696f 6e20 5375 6974 6520 636f  ctation Suite co
-000102f0: 6e66 6967 7572 6174 696f 6e20 6f62 6a65  nfiguration obje
-00010300: 6374 2064 6566 696e 696e 6720 7468 6520  ct defining the 
-00010310: 7365 7474 696e 6773 2066 6f72 0a20 2020  settings for.   
-00010320: 2020 2020 2064 6174 6120 7661 6c69 6461       data valida
-00010330: 7469 6f6e 206f 6620 7468 6520 6665 6174  tion of the feat
-00010340: 7572 6520 6772 6f75 702e 2222 220a 2020  ure group.""".  
-00010350: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00010360: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
-00010370: 7569 7465 0a0a 2020 2020 4065 7870 6563  uite..    @expec
-00010380: 7461 7469 6f6e 5f73 7569 7465 2e73 6574  tation_suite.set
-00010390: 7465 720a 2020 2020 6465 6620 6578 7065  ter.    def expe
-000103a0: 6374 6174 696f 6e5f 7375 6974 6528 0a20  ctation_suite(. 
-000103b0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-000103c0: 2020 2020 2065 7870 6563 7461 7469 6f6e       expectation
-000103d0: 5f73 7569 7465 3a20 556e 696f 6e5b 0a20  _suite: Union[. 
-000103e0: 2020 2020 2020 2020 2020 2045 7870 6563             Expec
-000103f0: 7461 7469 6f6e 5375 6974 652c 2067 652e  tationSuite, ge.
-00010400: 636f 7265 2e45 7870 6563 7461 7469 6f6e  core.Expectation
-00010410: 5375 6974 652c 2064 6963 742c 204e 6f6e  Suite, dict, Non
-00010420: 650a 2020 2020 2020 2020 5d2c 0a20 2020  e.        ],.   
-00010430: 2029 3a0a 2020 2020 2020 2020 6966 2069   ):.        if i
-00010440: 7369 6e73 7461 6e63 6528 6578 7065 6374  sinstance(expect
-00010450: 6174 696f 6e5f 7375 6974 652c 2045 7870  ation_suite, Exp
-00010460: 6563 7461 7469 6f6e 5375 6974 6529 3a0a  ectationSuite):.
-00010470: 2020 2020 2020 2020 2020 2020 746d 705f              tmp_
-00010480: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00010490: 6520 3d20 6578 7065 6374 6174 696f 6e5f  e = expectation_
-000104a0: 7375 6974 652e 746f 5f6a 736f 6e5f 6469  suite.to_json_di
-000104b0: 6374 2864 6563 616d 656c 697a 653d 5472  ct(decamelize=Tr
-000104c0: 7565 290a 2020 2020 2020 2020 2020 2020  ue).            
-000104d0: 746d 705f 6578 7065 6374 6174 696f 6e5f  tmp_expectation_
-000104e0: 7375 6974 655b 2266 6561 7475 7265 5f67  suite["feature_g
-000104f0: 726f 7570 5f69 6422 5d20 3d20 7365 6c66  roup_id"] = self
-00010500: 2e5f 6964 0a20 2020 2020 2020 2020 2020  ._id.           
-00010510: 2074 6d70 5f65 7870 6563 7461 7469 6f6e   tmp_expectation
-00010520: 5f73 7569 7465 5b22 6665 6174 7572 655f  _suite["feature_
-00010530: 7374 6f72 655f 6964 225d 203d 2073 656c  store_id"] = sel
-00010540: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-00010550: 5f69 640a 2020 2020 2020 2020 2020 2020  _id.            
-00010560: 7365 6c66 2e5f 6578 7065 6374 6174 696f  self._expectatio
-00010570: 6e5f 7375 6974 6520 3d20 4578 7065 6374  n_suite = Expect
-00010580: 6174 696f 6e53 7569 7465 282a 2a74 6d70  ationSuite(**tmp
-00010590: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
-000105a0: 7465 290a 2020 2020 2020 2020 656c 6966  te).        elif
-000105b0: 2069 7369 6e73 7461 6e63 6528 6578 7065   isinstance(expe
-000105c0: 6374 6174 696f 6e5f 7375 6974 652c 2067  ctation_suite, g
-000105d0: 652e 636f 7265 2e65 7870 6563 7461 7469  e.core.expectati
-000105e0: 6f6e 5f73 7569 7465 2e45 7870 6563 7461  on_suite.Expecta
-000105f0: 7469 6f6e 5375 6974 6529 3a0a 2020 2020  tionSuite):.    
-00010600: 2020 2020 2020 2020 7365 6c66 2e5f 6578          self._ex
-00010610: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
-00010620: 3d20 4578 7065 6374 6174 696f 6e53 7569  = ExpectationSui
-00010630: 7465 280a 2020 2020 2020 2020 2020 2020  te(.            
-00010640: 2020 2020 2a2a 6578 7065 6374 6174 696f      **expectatio
-00010650: 6e5f 7375 6974 652e 746f 5f6a 736f 6e5f  n_suite.to_json_
-00010660: 6469 6374 2829 2c0a 2020 2020 2020 2020  dict(),.        
-00010670: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-00010680: 7374 6f72 655f 6964 3d73 656c 662e 5f66  store_id=self._f
-00010690: 6561 7475 7265 5f73 746f 7265 5f69 642c  eature_store_id,
-000106a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000106b0: 2066 6561 7475 7265 5f67 726f 7570 5f69   feature_group_i
-000106c0: 643d 7365 6c66 2e5f 6964 2c0a 2020 2020  d=self._id,.    
-000106d0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000106e0: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
-000106f0: 6528 6578 7065 6374 6174 696f 6e5f 7375  e(expectation_su
-00010700: 6974 652c 2064 6963 7429 3a0a 2020 2020  ite, dict):.    
-00010710: 2020 2020 2020 2020 746d 705f 6578 7065          tmp_expe
-00010720: 6374 6174 696f 6e5f 7375 6974 6520 3d20  ctation_suite = 
-00010730: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-00010740: 652e 636f 7079 2829 0a20 2020 2020 2020  e.copy().       
-00010750: 2020 2020 2074 6d70 5f65 7870 6563 7461       tmp_expecta
-00010760: 7469 6f6e 5f73 7569 7465 5b22 6665 6174  tion_suite["feat
-00010770: 7572 655f 7374 6f72 655f 6964 225d 203d  ure_store_id"] =
-00010780: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
-00010790: 746f 7265 5f69 640a 2020 2020 2020 2020  tore_id.        
-000107a0: 2020 2020 746d 705f 6578 7065 6374 6174      tmp_expectat
-000107b0: 696f 6e5f 7375 6974 655b 2266 6561 7475  ion_suite["featu
-000107c0: 7265 5f67 726f 7570 5f69 6422 5d20 3d20  re_group_id"] = 
-000107d0: 7365 6c66 2e5f 6964 0a20 2020 2020 2020  self._id.       
-000107e0: 2020 2020 2073 656c 662e 5f65 7870 6563       self._expec
-000107f0: 7461 7469 6f6e 5f73 7569 7465 203d 2045  tation_suite = E
-00010800: 7870 6563 7461 7469 6f6e 5375 6974 6528  xpectationSuite(
-00010810: 2a2a 746d 705f 6578 7065 6374 6174 696f  **tmp_expectatio
-00010820: 6e5f 7375 6974 6529 0a20 2020 2020 2020  n_suite).       
-00010830: 2065 6c69 6620 6578 7065 6374 6174 696f   elif expectatio
-00010840: 6e5f 7375 6974 6520 6973 204e 6f6e 653a  n_suite is None:
-00010850: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00010860: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
-00010870: 7569 7465 203d 204e 6f6e 650a 2020 2020  uite = None.    
-00010880: 2020 2020 656c 7365 3a0a 2020 2020 2020      else:.      
-00010890: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000108a0: 4572 726f 7228 0a20 2020 2020 2020 2020  Error(.         
-000108b0: 2020 2020 2020 2022 5468 6520 6172 6775         "The argu
-000108c0: 6d65 6e74 2060 6578 7065 6374 6174 696f  ment `expectatio
-000108d0: 6e5f 7375 6974 6560 2068 6173 2074 6f20  n_suite` has to 
-000108e0: 6265 2060 4e6f 6e65 6020 6f66 2074 7970  be `None` of typ
-000108f0: 6520 6045 7870 6563 7461 7469 6f6e 5375  e `ExpectationSu
-00010900: 6974 6560 206f 7220 6064 6963 7460 2c20  ite` or `dict`, 
-00010910: 6275 7420 6973 206f 6620 7479 7065 3a20  but is of type: 
-00010920: 607b 7d60 222e 666f 726d 6174 280a 2020  `{}`".format(.  
-00010930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010940: 2020 7479 7065 2865 7870 6563 7461 7469    type(expectati
-00010950: 6f6e 5f73 7569 7465 290a 2020 2020 2020  on_suite).      
-00010960: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00010970: 2020 2020 2020 2020 290a 0a20 2020 2040          )..    @
-00010980: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00010990: 206f 6e6c 696e 655f 656e 6162 6c65 6428   online_enabled(
-000109a0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000109b0: 2222 5365 7474 696e 6720 6966 2074 6865  ""Setting if the
-000109c0: 2066 6561 7475 7265 2067 726f 7570 2069   feature group i
-000109d0: 7320 6176 6169 6c61 626c 6520 696e 206f  s available in o
-000109e0: 6e6c 696e 6520 7374 6f72 6167 652e 2222  nline storage.""
-000109f0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00010a00: 2073 656c 662e 5f6f 6e6c 696e 655f 656e   self._online_en
-00010a10: 6162 6c65 640a 0a20 2020 2040 6f6e 6c69  abled..    @onli
-00010a20: 6e65 5f65 6e61 626c 6564 2e73 6574 7465  ne_enabled.sette
-00010a30: 720a 2020 2020 6465 6620 6f6e 6c69 6e65  r.    def online
-00010a40: 5f65 6e61 626c 6564 2873 656c 662c 206f  _enabled(self, o
-00010a50: 6e6c 696e 655f 656e 6162 6c65 6429 3a0a  nline_enabled):.
-00010a60: 2020 2020 2020 2020 7365 6c66 2e5f 6f6e          self._on
-00010a70: 6c69 6e65 5f65 6e61 626c 6564 203d 206f  line_enabled = o
-00010a80: 6e6c 696e 655f 656e 6162 6c65 640a 0a20  nline_enabled.. 
-00010a90: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00010aa0: 2064 6566 2074 6f70 6963 5f6e 616d 6528   def topic_name(
-00010ab0: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00010ac0: 2222 5468 6520 746f 7069 6320 7573 6564  ""The topic used
-00010ad0: 2066 6f72 2066 6561 7475 7265 2067 726f   for feature gro
-00010ae0: 7570 2064 6174 6120 696e 6765 7374 696f  up data ingestio
-00010af0: 6e2e 2222 220a 2020 2020 2020 2020 7265  n.""".        re
-00010b00: 7475 726e 2073 656c 662e 5f74 6f70 6963  turn self._topic
-00010b10: 5f6e 616d 650a 0a20 2020 2040 746f 7069  _name..    @topi
-00010b20: 635f 6e61 6d65 2e73 6574 7465 720a 2020  c_name.setter.  
-00010b30: 2020 6465 6620 746f 7069 635f 6e61 6d65    def topic_name
-00010b40: 2873 656c 662c 2074 6f70 6963 5f6e 616d  (self, topic_nam
-00010b50: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
-00010b60: 2e5f 746f 7069 635f 6e61 6d65 203d 2074  ._topic_name = t
-00010b70: 6f70 6963 5f6e 616d 650a 0a20 2020 2040  opic_name..    @
-00010b80: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00010b90: 206e 6f74 6966 6963 6174 696f 6e5f 746f   notification_to
-00010ba0: 7069 635f 6e61 6d65 2873 656c 6629 3a0a  pic_name(self):.
-00010bb0: 2020 2020 2020 2020 2222 2254 6865 2074          """The t
-00010bc0: 6f70 6963 2075 7365 6420 666f 7220 6665  opic used for fe
-00010bd0: 6174 7572 6520 6772 6f75 7020 6e6f 7469  ature group noti
-00010be0: 6669 6361 7469 6f6e 732e 2222 220a 2020  fications.""".  
-00010bf0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00010c00: 662e 5f6e 6f74 6966 6963 6174 696f 6e5f  f._notification_
-00010c10: 746f 7069 635f 6e61 6d65 0a0a 2020 2020  topic_name..    
-00010c20: 406e 6f74 6966 6963 6174 696f 6e5f 746f  @notification_to
-00010c30: 7069 635f 6e61 6d65 2e73 6574 7465 720a  pic_name.setter.
-00010c40: 2020 2020 6465 6620 6e6f 7469 6669 6361      def notifica
-00010c50: 7469 6f6e 5f74 6f70 6963 5f6e 616d 6528  tion_topic_name(
-00010c60: 7365 6c66 2c20 6e6f 7469 6669 6361 7469  self, notificati
-00010c70: 6f6e 5f74 6f70 6963 5f6e 616d 6529 3a0a  on_topic_name):.
-00010c80: 2020 2020 2020 2020 7365 6c66 2e5f 6e6f          self._no
-00010c90: 7469 6669 6361 7469 6f6e 5f74 6f70 6963  tification_topic
-00010ca0: 5f6e 616d 6520 3d20 6e6f 7469 6669 6361  _name = notifica
-00010cb0: 7469 6f6e 5f74 6f70 6963 5f6e 616d 650a  tion_topic_name.
-00010cc0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00010cd0: 2020 2064 6566 2064 6570 7265 6361 7465     def deprecate
-00010ce0: 6428 7365 6c66 293a 0a20 2020 2020 2020  d(self):.       
-00010cf0: 2022 2222 5365 7474 696e 6720 6966 2074   """Setting if t
-00010d00: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-00010d10: 2069 7320 6465 7072 6563 6174 6564 2e22   is deprecated."
-00010d20: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-00010d30: 6e20 7365 6c66 2e5f 6465 7072 6563 6174  n self._deprecat
-00010d40: 6564 0a0a 2020 2020 4064 6570 7265 6361  ed..    @depreca
-00010d50: 7465 642e 7365 7474 6572 0a20 2020 2064  ted.setter.    d
-00010d60: 6566 2064 6570 7265 6361 7465 6428 7365  ef deprecated(se
-00010d70: 6c66 2c20 6465 7072 6563 6174 6564 293a  lf, deprecated):
-00010d80: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-00010d90: 6570 7265 6361 7465 6420 3d20 6465 7072  eprecated = depr
-00010da0: 6563 6174 6564 0a0a 2020 2020 4070 726f  ecated..    @pro
-00010db0: 7065 7274 790a 2020 2020 6465 6620 7375  perty.    def su
-00010dc0: 626a 6563 7428 7365 6c66 293a 0a20 2020  bject(self):.   
-00010dd0: 2020 2020 2022 2222 5375 626a 6563 7420       """Subject 
-00010de0: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-00010df0: 726f 7570 2e22 2222 0a20 2020 2020 2020  roup.""".       
-00010e00: 2069 6620 7365 6c66 2e5f 7375 626a 6563   if self._subjec
-00010e10: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
-00010e20: 2020 2020 2020 2023 2063 6163 6865 2074         # cache t
-00010e30: 6865 2073 6368 656d 610a 2020 2020 2020  he schema.      
-00010e40: 2020 2020 2020 7365 6c66 2e5f 7375 626a        self._subj
-00010e50: 6563 7420 3d20 7365 6c66 2e5f 6665 6174  ect = self._feat
-00010e60: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
-00010e70: 2e67 6574 5f73 7562 6a65 6374 2873 656c  .get_subject(sel
-00010e80: 6629 0a20 2020 2020 2020 2072 6574 7572  f).        retur
-00010e90: 6e20 7365 6c66 2e5f 7375 626a 6563 740a  n self._subject.
-00010ea0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00010eb0: 2020 2064 6566 2061 7672 6f5f 7363 6865     def avro_sche
-00010ec0: 6d61 2873 656c 6629 3a0a 2020 2020 2020  ma(self):.      
-00010ed0: 2020 2222 2241 7672 6f20 7363 6865 6d61    """Avro schema
-00010ee0: 2072 6570 7265 7365 6e74 6174 696f 6e20   representation 
-00010ef0: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
-00010f00: 726f 7570 2e22 2222 0a20 2020 2020 2020  roup.""".       
-00010f10: 2072 6574 7572 6e20 7365 6c66 2e73 7562   return self.sub
-00010f20: 6a65 6374 5b22 7363 6865 6d61 225d 0a0a  ject["schema"]..
-00010f30: 2020 2020 6465 6620 6765 745f 636f 6d70      def get_comp
-00010f40: 6c65 785f 6665 6174 7572 6573 2873 656c  lex_features(sel
-00010f50: 6629 3a0a 2020 2020 2020 2020 2222 2252  f):.        """R
-00010f60: 6574 7572 6e73 2074 6865 206e 616d 6573  eturns the names
-00010f70: 206f 6620 616c 6c20 6665 6174 7572 6573   of all features
-00010f80: 2077 6974 6820 6120 636f 6d70 6c65 7820   with a complex 
-00010f90: 6461 7461 2074 7970 6520 696e 2074 6869  data type in thi
-00010fa0: 730a 2020 2020 2020 2020 6665 6174 7572  s.        featur
-00010fb0: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
-00010fc0: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
-00010fd0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-00010fe0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-00010ff0: 636f 6d70 6c65 785f 6474 7970 655f 6665  complex_dtype_fe
-00011000: 6174 7572 6573 203d 2066 672e 6765 745f  atures = fg.get_
-00011010: 636f 6d70 6c65 785f 6665 6174 7572 6573  complex_features
-00011020: 2829 0a20 2020 2020 2020 2020 2020 2060  ().            `
-00011030: 6060 0a20 2020 2020 2020 2022 2222 0a20  ``.        """. 
-00011040: 2020 2020 2020 2072 6574 7572 6e20 5b66         return [f
-00011050: 2e6e 616d 6520 666f 7220 6620 696e 2073  .name for f in s
-00011060: 656c 662e 6665 6174 7572 6573 2069 6620  elf.features if 
-00011070: 662e 6973 5f63 6f6d 706c 6578 2829 5d0a  f.is_complex()].
-00011080: 0a20 2020 2064 6566 205f 6765 745f 656e  .    def _get_en
-00011090: 636f 6465 645f 6176 726f 5f73 6368 656d  coded_avro_schem
-000110a0: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
-000110b0: 2063 6f6d 706c 6578 5f66 6561 7475 7265   complex_feature
-000110c0: 7320 3d20 7365 6c66 2e67 6574 5f63 6f6d  s = self.get_com
-000110d0: 706c 6578 5f66 6561 7475 7265 7328 290a  plex_features().
-000110e0: 2020 2020 2020 2020 7363 6865 6d61 203d          schema =
-000110f0: 206a 736f 6e2e 6c6f 6164 7328 7365 6c66   json.loads(self
-00011100: 2e61 7672 6f5f 7363 6865 6d61 290a 0a20  .avro_schema).. 
-00011110: 2020 2020 2020 2066 6f72 2066 6965 6c64         for field
-00011120: 2069 6e20 7363 6865 6d61 5b22 6669 656c   in schema["fiel
-00011130: 6473 225d 3a0a 2020 2020 2020 2020 2020  ds"]:.          
-00011140: 2020 6966 2066 6965 6c64 5b22 6e61 6d65    if field["name
-00011150: 225d 2069 6e20 636f 6d70 6c65 785f 6665  "] in complex_fe
-00011160: 6174 7572 6573 3a0a 2020 2020 2020 2020  atures:.        
-00011170: 2020 2020 2020 2020 6669 656c 645b 2274          field["t
-00011180: 7970 6522 5d20 3d20 5b22 6e75 6c6c 222c  ype"] = ["null",
-00011190: 2022 6279 7465 7322 5d0a 0a20 2020 2020   "bytes"]..     
-000111a0: 2020 2073 6368 656d 615f 7320 3d20 6a73     schema_s = js
-000111b0: 6f6e 2e64 756d 7073 2873 6368 656d 6129  on.dumps(schema)
-000111c0: 0a20 2020 2020 2020 2074 7279 3a0a 2020  .        try:.  
-000111d0: 2020 2020 2020 2020 2020 6176 726f 2e73            avro.s
-000111e0: 6368 656d 612e 7061 7273 6528 7363 6865  chema.parse(sche
-000111f0: 6d61 5f73 290a 2020 2020 2020 2020 6578  ma_s).        ex
-00011200: 6365 7074 2061 7672 6f2e 7363 6865 6d61  cept avro.schema
-00011210: 2e53 6368 656d 6150 6172 7365 4578 6365  .SchemaParseExce
-00011220: 7074 696f 6e20 6173 2065 3a0a 2020 2020  ption as e:.    
-00011230: 2020 2020 2020 2020 7261 6973 6520 4665          raise Fe
-00011240: 6174 7572 6553 746f 7265 4578 6365 7074  atureStoreExcept
-00011250: 696f 6e28 2246 6169 6c65 6420 746f 2063  ion("Failed to c
-00011260: 6f6e 7374 7275 6374 2041 7672 6f20 5363  onstruct Avro Sc
-00011270: 6865 6d61 3a20 7b7d 222e 666f 726d 6174  hema: {}".format
-00011280: 2865 2929 0a20 2020 2020 2020 2072 6574  (e)).        ret
-00011290: 7572 6e20 7363 6865 6d61 5f73 0a0a 2020  urn schema_s..  
-000112a0: 2020 6465 6620 5f67 6574 5f66 6561 7475    def _get_featu
-000112b0: 7265 5f61 7672 6f5f 7363 6865 6d61 2873  re_avro_schema(s
-000112c0: 656c 662c 2066 6561 7475 7265 5f6e 616d  elf, feature_nam
-000112d0: 6529 3a0a 2020 2020 2020 2020 666f 7220  e):.        for 
-000112e0: 6669 656c 6420 696e 206a 736f 6e2e 6c6f  field in json.lo
-000112f0: 6164 7328 7365 6c66 2e61 7672 6f5f 7363  ads(self.avro_sc
-00011300: 6865 6d61 295b 2266 6965 6c64 7322 5d3a  hema)["fields"]:
-00011310: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00011320: 6669 656c 645b 226e 616d 6522 5d20 3d3d  field["name"] ==
-00011330: 2066 6561 7475 7265 5f6e 616d 653a 0a20   feature_name:. 
-00011340: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00011350: 6574 7572 6e20 6a73 6f6e 2e64 756d 7073  eturn json.dumps
-00011360: 2866 6965 6c64 5b22 7479 7065 225d 290a  (field["type"]).
-00011370: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00011380: 2020 2064 6566 2066 6561 7475 7265 7328     def features(
-00011390: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-000113a0: 2222 4665 6174 7572 6520 4772 6f75 7020  ""Feature Group 
-000113b0: 7363 6865 6d61 2028 616c 6961 7329 2222  schema (alias)""
-000113c0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-000113d0: 2073 656c 662e 5f66 6561 7475 7265 730a   self._features.
-000113e0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-000113f0: 2020 2064 6566 2073 6368 656d 6128 7365     def schema(se
-00011400: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
-00011410: 4665 6174 7572 6520 4772 6f75 7020 7363  Feature Group sc
-00011420: 6865 6d61 2222 220a 2020 2020 2020 2020  hema""".        
-00011430: 7265 7475 726e 2073 656c 662e 5f66 6561  return self._fea
-00011440: 7475 7265 730a 0a20 2020 2064 6566 205f  tures..    def _
-00011450: 6172 655f 7374 6174 6973 7469 6373 5f6d  are_statistics_m
-00011460: 6973 7369 6e67 2873 656c 662c 2073 7461  issing(self, sta
-00011470: 7469 7374 6963 733a 2053 7461 7469 7374  tistics: Statist
-00011480: 6963 7329 3a0a 2020 2020 2020 2020 6966  ics):.        if
-00011490: 206e 6f74 2073 656c 662e 7374 6174 6973   not self.statis
-000114a0: 7469 6373 5f63 6f6e 6669 672e 656e 6162  tics_config.enab
-000114b0: 6c65 643a 0a20 2020 2020 2020 2020 2020  led:.           
-000114c0: 2072 6574 7572 6e20 4661 6c73 650a 2020   return False.  
-000114d0: 2020 2020 2020 656c 6966 2073 7461 7469        elif stati
-000114e0: 7374 6963 7320 6973 204e 6f6e 653a 0a20  stics is None:. 
-000114f0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00011500: 6e20 5472 7565 0a20 2020 2020 2020 2069  n True.        i
-00011510: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00011520: 7365 6c66 2e73 7461 7469 7374 6963 735f  self.statistics_
-00011530: 636f 6e66 6967 2e68 6973 746f 6772 616d  config.histogram
-00011540: 730a 2020 2020 2020 2020 2020 2020 6f72  s.            or
-00011550: 2073 656c 662e 7374 6174 6973 7469 6373   self.statistics
-00011560: 5f63 6f6e 6669 672e 636f 7272 656c 6174  _config.correlat
-00011570: 696f 6e73 0a20 2020 2020 2020 2020 2020  ions.           
-00011580: 206f 7220 7365 6c66 2e73 7461 7469 7374   or self.statist
-00011590: 6963 735f 636f 6e66 6967 2e65 7861 6374  ics_config.exact
-000115a0: 5f75 6e69 7175 656e 6573 730a 2020 2020  _uniqueness.    
-000115b0: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-000115c0: 2020 2023 2069 6620 7374 6174 6973 7469     # if statisti
-000115d0: 6373 2061 7265 206d 6973 7369 6e67 2c20  cs are missing, 
-000115e0: 7265 636f 6d70 7574 6520 616e 6420 7570  recompute and up
-000115f0: 6461 7465 2073 7461 7469 7374 6963 732e  date statistics.
-00011600: 0a20 2020 2020 2020 2020 2020 2023 2057  .            # W
-00011610: 6520 6e65 6564 2074 6f20 6368 6563 6b20  e need to check 
-00011620: 666f 7220 6d69 7373 696e 6720 7374 6174  for missing stat
-00011630: 6973 7469 6373 2062 6563 6175 7365 2074  istics because t
-00011640: 6865 2073 7461 7469 7374 6963 7320 636f  he statistics co
-00011650: 6e66 6967 2063 616e 2068 6176 6520 6265  nfig can have be
-00011660: 656e 206d 6f64 6966 6965 640a 2020 2020  en modified.    
-00011670: 2020 2020 2020 2020 666f 7220 6664 7320          for fds 
-00011680: 696e 2073 7461 7469 7374 6963 732e 6665  in statistics.fe
-00011690: 6174 7572 655f 6465 7363 7269 7074 6976  ature_descriptiv
-000116a0: 655f 7374 6174 6973 7469 6373 3a0a 2020  e_statistics:.  
-000116b0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-000116c0: 2066 6473 2e66 6561 7475 7265 5f74 7970   fds.feature_typ
-000116d0: 6520 696e 205b 2249 6e74 6567 7261 6c22  e in ["Integral"
-000116e0: 2c20 2246 7261 6374 696f 6e61 6c22 5d3a  , "Fractional"]:
-000116f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011700: 2020 2020 2069 6620 7365 6c66 2e73 7461       if self.sta
-00011710: 7469 7374 6963 735f 636f 6e66 6967 2e68  tistics_config.h
-00011720: 6973 746f 6772 616d 7320 616e 6420 280a  istograms and (.
-00011730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011740: 2020 2020 2020 2020 6664 732e 6578 7465          fds.exte
-00011750: 6e64 6564 5f73 7461 7469 7374 6963 7320  nded_statistics 
-00011760: 6973 204e 6f6e 650a 2020 2020 2020 2020  is None.        
-00011770: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011780: 6f72 2022 6869 7374 6f67 7261 6d22 206e  or "histogram" n
-00011790: 6f74 2069 6e20 6664 732e 6578 7465 6e64  ot in fds.extend
-000117a0: 6564 5f73 7461 7469 7374 6963 730a 2020  ed_statistics.  
-000117b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000117c0: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
-000117d0: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-000117e0: 7572 6e20 5472 7565 0a0a 2020 2020 2020  urn True..      
-000117f0: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00011800: 2073 656c 662e 7374 6174 6973 7469 6373   self.statistics
-00011810: 5f63 6f6e 6669 672e 636f 7272 656c 6174  _config.correlat
-00011820: 696f 6e73 2061 6e64 2028 0a20 2020 2020  ions and (.     
-00011830: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011840: 2020 2066 6473 2e65 7874 656e 6465 645f     fds.extended_
-00011850: 7374 6174 6973 7469 6373 2069 7320 4e6f  statistics is No
-00011860: 6e65 0a20 2020 2020 2020 2020 2020 2020  ne.             
-00011870: 2020 2020 2020 2020 2020 206f 7220 2263             or "c
-00011880: 6f72 7265 6c61 7469 6f6e 7322 206e 6f74  orrelations" not
-00011890: 2069 6e20 6664 732e 6578 7465 6e64 6564   in fds.extended
-000118a0: 5f73 7461 7469 7374 6963 730a 2020 2020  _statistics.    
-000118b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000118c0: 293a 0a20 2020 2020 2020 2020 2020 2020  ):.             
-000118d0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-000118e0: 6e20 5472 7565 0a0a 2020 2020 2020 2020  n True..        
-000118f0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00011900: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-00011910: 672e 6578 6163 745f 756e 6971 7565 6e65  g.exact_uniquene
-00011920: 7373 2061 6e64 2066 6473 2e75 6e69 7175  ss and fds.uniqu
-00011930: 656e 6573 7320 6973 204e 6f6e 653a 0a20  eness is None:. 
+00002bf0: 2020 2066 6561 7475 7265 733d 5b0a 2020     features=[.  
+00002c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c10: 2020 2020 2020 2020 2020 4665 6174 7572            Featur
+00002c20: 6528 2269 6422 2c20 7479 7065 3d22 7374  e("id", type="st
+00002c30: 7269 6e67 2229 2c0a 2020 2020 2020 2020  ring"),.        
+00002c40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002c50: 2020 2020 4665 6174 7572 6528 2274 7322      Feature("ts"
+00002c60: 2c20 7479 7065 3d22 6269 6769 6e74 2229  , type="bigint")
+00002c70: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002c80: 2020 2020 2020 2020 2020 2020 2020 4665                Fe
+00002c90: 6174 7572 6528 2266 3122 2c20 7479 7065  ature("f1", type
+00002ca0: 3d22 6461 7465 2229 2c0a 2020 2020 2020  ="date"),.      
+00002cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00002cc0: 2020 2020 2020 4665 6174 7572 6528 2266        Feature("f
+00002cd0: 3222 2c20 7479 7065 3d22 646f 7562 6c65  2", type="double
+00002ce0: 2229 0a20 2020 2020 2020 2020 2020 2020  ").             
+00002cf0: 2020 2020 2020 2020 2020 2020 2020 205d                 ]
+00002d00: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00002d10: 2020 2020 2020 7072 696d 6172 795f 6b65        primary_ke
+00002d20: 793d 5b22 6964 225d 2c0a 2020 2020 2020  y=["id"],.      
+00002d30: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00002d40: 656e 745f 7469 6d65 3d22 7473 2229 0a0a  ent_time="ts")..
+00002d50: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+00002d60: 6e73 7472 7563 7420 7175 6572 790a 2020  nstruct query.  
+00002d70: 2020 2020 2020 2020 2020 7175 6572 7920            query 
+00002d80: 3d20 6667 2e73 656c 6563 745f 6578 6365  = fg.select_exce
+00002d90: 7074 285b 2274 7322 2c20 2266 3122 5d29  pt(["ts", "f1"])
+00002da0: 0a20 2020 2020 2020 2020 2020 2071 7565  .            que
+00002db0: 7279 2e66 6561 7475 7265 730a 2020 2020  ry.features.    
+00002dc0: 2020 2020 2020 2020 2320 5b46 6561 7475          # [Featu
+00002dd0: 7265 2827 6964 272c 202e 2e2e 292c 2046  re('id', ...), F
+00002de0: 6561 7475 7265 2827 6631 272c 202e 2e2e  eature('f1', ...
+00002df0: 295d 0a20 2020 2020 2020 2020 2020 2060  )].            `
+00002e00: 6060 0a0a 2020 2020 2020 2020 2320 4172  ``..        # Ar
+00002e10: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
+00002e20: 2020 2020 6665 6174 7572 6573 3a20 4120      features: A 
+00002e30: 6c69 7374 206f 6620 6046 6561 7475 7265  list of `Feature
+00002e40: 6020 6f62 6a65 6374 7320 6f72 2066 6561  ` objects or fea
+00002e50: 7475 7265 206e 616d 6573 2061 730a 2020  ture names as.  
+00002e60: 2020 2020 2020 2020 2020 2020 2020 7374                st
+00002e70: 7269 6e67 7320 746f 2062 6520 6578 636c  rings to be excl
+00002e80: 7564 6564 2066 726f 6d20 7468 6520 7365  uded from the se
+00002e90: 6c65 6374 696f 6e2e 2044 6566 6175 6c74  lection. Default
+00002ea0: 7320 746f 205b 5d2c 0a20 2020 2020 2020  s to [],.       
+00002eb0: 2020 2020 2020 2020 2073 656c 6563 7469           selecti
+00002ec0: 6e67 2061 6c6c 2066 6561 7475 7265 732e  ng all features.
+00002ed0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
+00002ee0: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
+00002ef0: 6051 7565 7279 603a 2041 2071 7565 7279  `Query`: A query
+00002f00: 206f 626a 6563 7420 7769 7468 2074 6865   object with the
+00002f10: 2073 656c 6563 7465 6420 6665 6174 7572   selected featur
+00002f20: 6573 206f 6620 7468 6520 6665 6174 7572  es of the featur
+00002f30: 6520 6772 6f75 702e 0a20 2020 2020 2020  e group..       
+00002f40: 2022 2222 0a20 2020 2020 2020 2069 6620   """.        if 
+00002f50: 6665 6174 7572 6573 3a0a 2020 2020 2020  features:.      
+00002f60: 2020 2020 2020 6578 6365 7074 5f66 6561        except_fea
+00002f70: 7475 7265 7320 3d20 5b0a 2020 2020 2020  tures = [.      
+00002f80: 2020 2020 2020 2020 2020 662e 6e61 6d65            f.name
+00002f90: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+00002fa0: 2c20 6665 6174 7572 652e 4665 6174 7572  , feature.Featur
+00002fb0: 6529 2065 6c73 6520 6620 666f 7220 6620  e) else f for f 
+00002fc0: 696e 2066 6561 7475 7265 730a 2020 2020  in features.    
+00002fd0: 2020 2020 2020 2020 5d0a 2020 2020 2020          ].      
+00002fe0: 2020 2020 2020 7265 7475 726e 2071 7565        return que
+00002ff0: 7279 5f6d 6f64 2e51 7565 7279 280a 2020  ry_mod.Query(.  
+00003000: 2020 2020 2020 2020 2020 2020 2020 6c65                le
+00003010: 6674 5f66 6561 7475 7265 5f67 726f 7570  ft_feature_group
+00003020: 3d73 656c 662c 0a20 2020 2020 2020 2020  =self,.         
+00003030: 2020 2020 2020 206c 6566 745f 6665 6174         left_feat
+00003040: 7572 6573 3d5b 0a20 2020 2020 2020 2020  ures=[.         
+00003050: 2020 2020 2020 2020 2020 2066 2066 6f72             f for
+00003060: 2066 2069 6e20 7365 6c66 2e5f 6665 6174   f in self._feat
+00003070: 7572 6573 2069 6620 662e 6e61 6d65 206e  ures if f.name n
+00003080: 6f74 2069 6e20 6578 6365 7074 5f66 6561  ot in except_fea
+00003090: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
+000030a0: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+000030b0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+000030c0: 5f73 746f 7265 5f6e 616d 653d 7365 6c66  _store_name=self
+000030d0: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
+000030e0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+000030f0: 2020 2020 2020 6665 6174 7572 655f 7374        feature_st
+00003100: 6f72 655f 6964 3d73 656c 662e 5f66 6561  ore_id=self._fea
+00003110: 7475 7265 5f73 746f 7265 5f69 642c 0a20  ture_store_id,. 
+00003120: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00003130: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00003140: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00003150: 6c66 2e73 656c 6563 745f 616c 6c28 290a  lf.select_all().
+00003160: 0a20 2020 2064 6566 2066 696c 7465 7228  .    def filter(
+00003170: 7365 6c66 2c20 663a 2055 6e69 6f6e 5b66  self, f: Union[f
+00003180: 696c 7465 725f 6d6f 642e 4669 6c74 6572  ilter_mod.Filter
+00003190: 2c20 6669 6c74 6572 5f6d 6f64 2e4c 6f67  , filter_mod.Log
+000031a0: 6963 5d29 3a0a 2020 2020 2020 2020 2222  ic]):.        ""
+000031b0: 2241 7070 6c79 2066 696c 7465 7220 746f  "Apply filter to
+000031c0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+000031d0: 7570 2e0a 0a20 2020 2020 2020 2053 656c  up...        Sel
+000031e0: 6563 7473 2061 6c6c 2066 6561 7475 7265  ects all feature
+000031f0: 7320 616e 6420 7265 7475 726e 7320 7468  s and returns th
+00003200: 6520 7265 7375 6c74 696e 6720 6051 7565  e resulting `Que
+00003210: 7279 6020 7769 7468 2074 6865 2061 7070  ry` with the app
+00003220: 6c69 6564 2066 696c 7465 722e 0a20 2020  lied filter..   
+00003230: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
+00003240: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00003250: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+00003260: 2020 2066 726f 6d20 6873 6673 2e66 6561     from hsfs.fea
+00003270: 7475 7265 2069 6d70 6f72 7420 4665 6174  ture import Feat
+00003280: 7572 650a 0a20 2020 2020 2020 2020 2020  ure..           
+00003290: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
+000032a0: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
+000032b0: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
+000032c0: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
+000032d0: 2020 2320 6765 7420 7468 6520 4665 6174    # get the Feat
+000032e0: 7572 6520 4772 6f75 7020 696e 7374 616e  ure Group instan
+000032f0: 6365 0a20 2020 2020 2020 2020 2020 2066  ce.            f
+00003300: 6720 3d20 6673 2e67 6574 5f6f 725f 6372  g = fs.get_or_cr
+00003310: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
+00003320: 7570 282e 2e2e 290a 0a20 2020 2020 2020  up(...)..       
+00003330: 2020 2020 2066 672e 6669 6c74 6572 2846       fg.filter(F
+00003340: 6561 7475 7265 2822 7765 656b 6c79 5f73  eature("weekly_s
+00003350: 616c 6573 2229 203e 2031 3030 3029 0a20  ales") > 1000). 
+00003360: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+00003370: 2020 2020 2020 2020 4966 2079 6f75 2061          If you a
+00003380: 7265 2070 6c61 6e6e 696e 6720 746f 206a  re planning to j
+00003390: 6f69 6e20 7468 6520 6669 6c74 6572 6564  oin the filtered
+000033a0: 2066 6561 7475 7265 2067 726f 7570 206c   feature group l
+000033b0: 6174 6572 206f 6e20 7769 7468 2061 6e6f  ater on with ano
+000033c0: 7468 6572 0a20 2020 2020 2020 2066 6561  ther.        fea
+000033d0: 7475 7265 2067 726f 7570 2c20 6d61 6b65  ture group, make
+000033e0: 2073 7572 6520 746f 2073 656c 6563 7420   sure to select 
+000033f0: 7468 6520 6669 6c74 6572 6564 2066 6561  the filtered fea
+00003400: 7475 7265 2065 7870 6c69 6369 746c 7920  ture explicitly 
+00003410: 6672 6f6d 2074 6865 0a20 2020 2020 2020  from the.       
+00003420: 2072 6573 7065 6374 6976 6520 6665 6174   respective feat
+00003430: 7572 6520 6772 6f75 703a 0a20 2020 2020  ure group:.     
+00003440: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
+00003450: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+00003460: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+00003470: 2066 672e 6669 6c74 6572 2866 672e 6665   fg.filter(fg.fe
+00003480: 6174 7572 6531 203d 3d20 3129 2e73 686f  ature1 == 1).sho
+00003490: 7728 3130 290a 2020 2020 2020 2020 2020  w(10).          
+000034a0: 2020 6060 600a 0a20 2020 2020 2020 2043    ```..        C
+000034b0: 6f6d 706f 7369 7465 2066 696c 7465 7273  omposite filters
+000034c0: 2072 6571 7569 7265 2070 6172 656e 7468   require parenth
+000034d0: 6573 6973 3a0a 2020 2020 2020 2020 2121  esis:.        !!
+000034e0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+000034f0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00003500: 2020 2020 2020 2020 2020 2020 6667 2e66              fg.f
+00003510: 696c 7465 7228 2866 672e 6665 6174 7572  ilter((fg.featur
+00003520: 6531 203d 3d20 3129 207c 2028 6667 2e66  e1 == 1) | (fg.f
+00003530: 6561 7475 7265 3220 3e3d 2032 2929 0a20  eature2 >= 2)). 
+00003540: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+00003550: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+00003560: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+00003570: 663a 2046 696c 7465 7220 6f62 6a65 6374  f: Filter object
+00003580: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
+00003590: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
+000035a0: 2060 5175 6572 7960 2e20 5468 6520 7175   `Query`. The qu
+000035b0: 6572 7920 6f62 6a65 6374 2077 6974 6820  ery object with 
+000035c0: 7468 6520 6170 706c 6965 6420 6669 6c74  the applied filt
+000035d0: 6572 2e0a 2020 2020 2020 2020 2222 220a  er..        """.
+000035e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000035f0: 656c 662e 7365 6c65 6374 5f61 6c6c 2829  elf.select_all()
+00003600: 2e66 696c 7465 7228 6629 0a0a 2020 2020  .filter(f)..    
+00003610: 6465 6620 6164 645f 7461 6728 7365 6c66  def add_tag(self
+00003620: 2c20 6e61 6d65 3a20 7374 722c 2076 616c  , name: str, val
+00003630: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
+00003640: 4174 7461 6368 2061 2074 6167 2074 6f20  Attach a tag to 
+00003650: 6120 6665 6174 7572 6520 6772 6f75 702e  a feature group.
+00003660: 0a0a 2020 2020 2020 2020 4120 7461 6720  ..        A tag 
+00003670: 636f 6e73 6973 7473 206f 6620 6120 3c6e  consists of a <n
+00003680: 616d 652c 7661 6c75 653e 2070 6169 722e  ame,value> pair.
+00003690: 2054 6167 206e 616d 6573 2061 7265 2075   Tag names are u
+000036a0: 6e69 7175 6520 6964 656e 7469 6669 6572  nique identifier
+000036b0: 7320 6163 726f 7373 2074 6865 2077 686f  s across the who
+000036c0: 6c65 2063 6c75 7374 6572 2e0a 2020 2020  le cluster..    
+000036d0: 2020 2020 5468 6520 7661 6c75 6520 6f66      The value of
+000036e0: 2061 2074 6167 2063 616e 2062 6520 616e   a tag can be an
+000036f0: 7920 7661 6c69 6420 6a73 6f6e 202d 2070  y valid json - p
+00003700: 7269 6d69 7469 7665 732c 2061 7272 6179  rimitives, array
+00003710: 7320 6f72 206a 736f 6e20 6f62 6a65 6374  s or json object
+00003720: 732e 0a0a 2020 2020 2020 2020 2121 2120  s...        !!! 
+00003730: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
+00003740: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
+00003750: 2020 2020 2020 2020 2020 2320 636f 6e6e            # conn
+00003760: 6563 7420 746f 2074 6865 2046 6561 7475  ect to the Featu
+00003770: 7265 2053 746f 7265 0a20 2020 2020 2020  re Store.       
+00003780: 2020 2020 2066 7320 3d20 2e2e 2e0a 0a20       fs = ..... 
+00003790: 2020 2020 2020 2020 2020 2023 2067 6574             # get
+000037a0: 2074 6865 2046 6561 7475 7265 2047 726f   the Feature Gro
+000037b0: 7570 2069 6e73 7461 6e63 650a 2020 2020  up instance.    
+000037c0: 2020 2020 2020 2020 6667 203d 2066 732e          fg = fs.
+000037d0: 6765 745f 6f72 5f63 7265 6174 655f 6665  get_or_create_fe
+000037e0: 6174 7572 655f 6772 6f75 7028 2e2e 2e29  ature_group(...)
+000037f0: 0a0a 2020 2020 2020 2020 2020 2020 6667  ..            fg
+00003800: 2e61 6464 5f74 6167 286e 616d 653d 2265  .add_tag(name="e
+00003810: 7861 6d70 6c65 5f74 6167 222c 2076 616c  xample_tag", val
+00003820: 7565 3d22 3432 2229 0a20 2020 2020 2020  ue="42").       
+00003830: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00003840: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
+00003850: 2020 2020 2020 2020 2020 6e61 6d65 3a20            name: 
+00003860: 4e61 6d65 206f 6620 7468 6520 7461 6720  Name of the tag 
+00003870: 746f 2062 6520 6164 6465 642e 0a20 2020  to be added..   
+00003880: 2020 2020 2020 2020 2076 616c 7565 3a20           value: 
+00003890: 5661 6c75 6520 6f66 2074 6865 2074 6167  Value of the tag
+000038a0: 2074 6f20 6265 2061 6464 6564 2e0a 0a20   to be added... 
+000038b0: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
+000038c0: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
+000038d0: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
+000038e0: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
+000038f0: 6020 696e 2063 6173 6520 7468 6520 6261  ` in case the ba
+00003900: 636b 656e 6420 6661 696c 7320 746f 2061  ckend fails to a
+00003910: 6464 2074 6865 2074 6167 2e0a 2020 2020  dd the tag..    
+00003920: 2020 2020 2222 220a 0a20 2020 2020 2020      """..       
+00003930: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+00003940: 726f 7570 5f65 6e67 696e 652e 6164 645f  roup_engine.add_
+00003950: 7461 6728 7365 6c66 2c20 6e61 6d65 2c20  tag(self, name, 
+00003960: 7661 6c75 6529 0a0a 2020 2020 6465 6620  value)..    def 
+00003970: 6465 6c65 7465 5f74 6167 2873 656c 662c  delete_tag(self,
+00003980: 206e 616d 653a 2073 7472 293a 0a20 2020   name: str):.   
+00003990: 2020 2020 2022 2222 4465 6c65 7465 2061       """Delete a
+000039a0: 2074 6167 2061 7474 6163 6865 6420 746f   tag attached to
+000039b0: 2061 2066 6561 7475 7265 2067 726f 7570   a feature group
+000039c0: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+000039d0: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+000039e0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+000039f0: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
+00003a00: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
+00003a10: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
+00003a20: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
+00003a30: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+00003a40: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+00003a50: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
+00003a60: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
+00003a70: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+00003a80: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
+00003a90: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
+00003aa0: 6465 6c65 7465 5f74 6167 2822 6578 616d  delete_tag("exam
+00003ab0: 706c 655f 7461 6722 290a 2020 2020 2020  ple_tag").      
+00003ac0: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
+00003ad0: 2020 2023 2041 7267 756d 656e 7473 0a20     # Arguments. 
+00003ae0: 2020 2020 2020 2020 2020 206e 616d 653a             name:
+00003af0: 204e 616d 6520 6f66 2074 6865 2074 6167   Name of the tag
+00003b00: 2074 6f20 6265 2072 656d 6f76 6564 2e0a   to be removed..
+00003b10: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
+00003b20: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
+00003b30: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+00003b40: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
+00003b50: 6f72 6020 696e 2063 6173 6520 7468 6520  or` in case the 
+00003b60: 6261 636b 656e 6420 6661 696c 7320 746f  backend fails to
+00003b70: 2064 656c 6574 6520 7468 6520 7461 672e   delete the tag.
+00003b80: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00003b90: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
+00003ba0: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
+00003bb0: 6465 6c65 7465 5f74 6167 2873 656c 662c  delete_tag(self,
+00003bc0: 206e 616d 6529 0a0a 2020 2020 6465 6620   name)..    def 
+00003bd0: 6765 745f 7461 6728 7365 6c66 2c20 6e61  get_tag(self, na
+00003be0: 6d65 3a20 7374 7229 3a0a 2020 2020 2020  me: str):.      
+00003bf0: 2020 2222 2247 6574 2074 6865 2074 6167    """Get the tag
+00003c00: 7320 6f66 2061 2066 6561 7475 7265 2067  s of a feature g
+00003c10: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
+00003c20: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
+00003c30: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00003c40: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+00003c50: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
+00003c60: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
+00003c70: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
+00003c80: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00003c90: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
+00003ca0: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
+00003cb0: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
+00003cc0: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
+00003cd0: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
+00003ce0: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
+00003cf0: 2066 675f 7461 675f 7661 6c75 6520 3d20   fg_tag_value = 
+00003d00: 6667 2e67 6574 5f74 6167 2822 6578 616d  fg.get_tag("exam
+00003d10: 706c 655f 7461 6722 290a 2020 2020 2020  ple_tag").      
+00003d20: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
+00003d30: 2020 2023 2041 7267 756d 656e 7473 0a20     # Arguments. 
+00003d40: 2020 2020 2020 2020 2020 206e 616d 653a             name:
+00003d50: 204e 616d 6520 6f66 2074 6865 2074 6167   Name of the tag
+00003d60: 2074 6f20 6765 742e 0a0a 2020 2020 2020   to get...      
+00003d70: 2020 2320 5265 7475 726e 730a 2020 2020    # Returns.    
+00003d80: 2020 2020 2020 2020 7461 6720 7661 6c75          tag valu
+00003d90: 650a 0a20 2020 2020 2020 2023 2052 6169  e..        # Rai
+00003da0: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
+00003db0: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+00003dc0: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
+00003dd0: 7272 6f72 6020 696e 2063 6173 6520 7468  rror` in case th
+00003de0: 6520 6261 636b 656e 6420 6661 696c 7320  e backend fails 
+00003df0: 746f 2072 6574 7269 6576 6520 7468 6520  to retrieve the 
+00003e00: 7461 672e 0a20 2020 2020 2020 2022 2222  tag..        """
+00003e10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003e20: 7365 6c66 2e5f 6665 6174 7572 655f 6772  self._feature_gr
+00003e30: 6f75 705f 656e 6769 6e65 2e67 6574 5f74  oup_engine.get_t
+00003e40: 6167 2873 656c 662c 206e 616d 6529 0a0a  ag(self, name)..
+00003e50: 2020 2020 6465 6620 6765 745f 7461 6773      def get_tags
+00003e60: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00003e70: 2222 2252 6574 7269 6576 6573 2061 6c6c  """Retrieves all
+00003e80: 2074 6167 7320 6174 7461 6368 6564 2074   tags attached t
+00003e90: 6f20 6120 6665 6174 7572 6520 6772 6f75  o a feature grou
+00003ea0: 702e 0a0a 2020 2020 2020 2020 2320 5265  p...        # Re
+00003eb0: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
+00003ec0: 2020 6044 6963 745b 7374 722c 206f 626a    `Dict[str, obj
+00003ed0: 5d60 206f 6620 7461 6773 2e0a 0a20 2020  ]` of tags...   
+00003ee0: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
+00003ef0: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
+00003f00: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
+00003f10: 732e 5265 7374 4150 4945 7272 6f72 6020  s.RestAPIError` 
+00003f20: 696e 2063 6173 6520 7468 6520 6261 636b  in case the back
+00003f30: 656e 6420 6661 696c 7320 746f 2072 6574  end fails to ret
+00003f40: 7269 6576 6520 7468 6520 7461 6773 2e0a  rieve the tags..
+00003f50: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00003f60: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00003f70: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
+00003f80: 6e67 696e 652e 6765 745f 7461 6773 2873  ngine.get_tags(s
+00003f90: 656c 6629 0a0a 2020 2020 6465 6620 6765  elf)..    def ge
+00003fa0: 745f 7061 7265 6e74 5f66 6561 7475 7265  t_parent_feature
+00003fb0: 5f67 726f 7570 7328 7365 6c66 293a 0a20  _groups(self):. 
+00003fc0: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+00003fd0: 6520 7061 7265 6e74 7320 6f66 2074 6869  e parents of thi
+00003fe0: 7320 6665 6174 7572 6520 6772 6f75 702c  s feature group,
+00003ff0: 2062 6173 6564 206f 6e20 6578 706c 6963   based on explic
+00004000: 6974 2070 726f 7665 6e61 6e63 652e 0a20  it provenance.. 
+00004010: 2020 2020 2020 2050 6172 656e 7473 2061         Parents a
+00004020: 7265 2066 6561 7475 7265 2067 726f 7570  re feature group
+00004030: 7320 6f72 2065 7874 6572 6e61 6c20 6665  s or external fe
+00004040: 6174 7572 6520 6772 6f75 7073 2e20 5468  ature groups. Th
+00004050: 6573 6520 6665 6174 7572 650a 2020 2020  ese feature.    
+00004060: 2020 2020 6772 6f75 7073 2063 616e 2062      groups can b
+00004070: 6520 6163 6365 7373 6962 6c65 2c20 6465  e accessible, de
+00004080: 6c65 7465 6420 6f72 2069 6e61 6363 6573  leted or inacces
+00004090: 7369 626c 652e 0a20 2020 2020 2020 2046  sible..        F
+000040a0: 6f72 2064 656c 6574 6564 2061 6e64 2069  or deleted and i
+000040b0: 6e61 6363 6573 7369 626c 6520 6665 6174  naccessible feat
+000040c0: 7572 6520 6772 6f75 7073 2c20 6f6e 6c79  ure groups, only
+000040d0: 2061 206d 696e 696d 616c 2069 6e66 6f72   a minimal infor
+000040e0: 6d61 7469 6f6e 2069 730a 2020 2020 2020  mation is.      
+000040f0: 2020 7265 7475 726e 6564 2e0a 0a20 2020    returned...   
+00004100: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
+00004110: 2020 2020 2020 2020 2020 2060 5072 6f76             `Prov
+00004120: 656e 616e 6365 4c69 6e6b 7360 3a20 4f62  enanceLinks`: Ob
+00004130: 6a65 6374 2063 6f6e 7461 696e 696e 6720  ject containing 
+00004140: 7468 6520 7365 6374 696f 6e20 6f66 2070  the section of p
+00004150: 726f 7665 6e61 6e63 6520 6772 6170 6820  rovenance graph 
+00004160: 7265 7175 6573 7465 642e 0a0a 2020 2020  requested...    
+00004170: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+00004180: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+00004190: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+000041a0: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
+000041b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000041c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000041d0: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
+000041e0: 6e67 696e 652e 6765 745f 7061 7265 6e74  ngine.get_parent
+000041f0: 5f66 6561 7475 7265 5f67 726f 7570 7328  _feature_groups(
+00004200: 7365 6c66 290a 0a20 2020 2064 6566 2067  self)..    def g
+00004210: 6574 5f67 656e 6572 6174 6564 5f66 6561  et_generated_fea
+00004220: 7475 7265 5f76 6965 7773 2873 656c 6629  ture_views(self)
+00004230: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+00004240: 2074 6865 2067 656e 6572 6174 6564 2066   the generated f
+00004250: 6561 7475 7265 2076 6965 7720 7573 696e  eature view usin
+00004260: 6720 7468 6973 2066 6561 7475 7265 2067  g this feature g
+00004270: 726f 7570 2c20 6261 7365 6420 6f6e 2065  roup, based on e
+00004280: 7870 6c69 6369 740a 2020 2020 2020 2020  xplicit.        
+00004290: 7072 6f76 656e 616e 6365 2e20 5468 6573  provenance. Thes
+000042a0: 6520 6665 6174 7572 6520 7669 6577 7320  e feature views 
+000042b0: 6361 6e20 6265 2061 6363 6573 7369 626c  can be accessibl
+000042c0: 6520 6f72 2069 6e61 6363 6573 7369 626c  e or inaccessibl
+000042d0: 652e 2045 7870 6c69 6369 740a 2020 2020  e. Explicit.    
+000042e0: 2020 2020 7072 6f76 656e 616e 6365 2064      provenance d
+000042f0: 6f65 7320 6e6f 7420 7472 6163 6b20 6465  oes not track de
+00004300: 6c65 7465 6420 6765 6e65 7261 7465 6420  leted generated 
+00004310: 6665 6174 7572 6520 7669 6577 206c 696e  feature view lin
+00004320: 6b73 2c20 736f 2064 656c 6574 6564 0a20  ks, so deleted. 
+00004330: 2020 2020 2020 2077 696c 6c20 616c 7761         will alwa
+00004340: 7973 2062 6520 656d 7074 792e 0a20 2020  ys be empty..   
+00004350: 2020 2020 2046 6f72 2069 6e61 6363 6573       For inacces
+00004360: 7369 626c 6520 6665 6174 7572 6520 7669  sible feature vi
+00004370: 6577 732c 206f 6e6c 7920 6120 6d69 6e69  ews, only a mini
+00004380: 6d61 6c20 696e 666f 726d 6174 696f 6e20  mal information 
+00004390: 6973 2072 6574 7572 6e65 642e 0a0a 2020  is returned...  
+000043a0: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
+000043b0: 2020 2020 2020 2020 2020 2020 6050 726f              `Pro
+000043c0: 7665 6e61 6e63 654c 696e 6b73 603a 204f  venanceLinks`: O
+000043d0: 626a 6563 7420 636f 6e74 6169 6e69 6e67  bject containing
+000043e0: 2074 6865 2073 6563 7469 6f6e 206f 6620   the section of 
+000043f0: 7072 6f76 656e 616e 6365 2067 7261 7068  provenance graph
+00004400: 2072 6571 7565 7374 6564 2e0a 0a20 2020   requested...   
+00004410: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
+00004420: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
+00004430: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
+00004440: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
+00004450: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+00004460: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00004470: 2e5f 6665 6174 7572 655f 6772 6f75 705f  ._feature_group_
+00004480: 656e 6769 6e65 2e67 6574 5f67 656e 6572  engine.get_gener
+00004490: 6174 6564 5f66 6561 7475 7265 5f76 6965  ated_feature_vie
+000044a0: 7773 2873 656c 6629 0a0a 2020 2020 6465  ws(self)..    de
+000044b0: 6620 6765 745f 6765 6e65 7261 7465 645f  f get_generated_
+000044c0: 6665 6174 7572 655f 6772 6f75 7073 2873  feature_groups(s
+000044d0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+000044e0: 2247 6574 2074 6865 2067 656e 6572 6174  "Get the generat
+000044f0: 6564 2066 6561 7475 7265 2067 726f 7570  ed feature group
+00004500: 7320 7573 696e 6720 7468 6973 2066 6561  s using this fea
+00004510: 7475 7265 2067 726f 7570 2c20 6261 7365  ture group, base
+00004520: 6420 6f6e 2065 7870 6c69 6369 740a 2020  d on explicit.  
+00004530: 2020 2020 2020 7072 6f76 656e 616e 6365        provenance
+00004540: 2e20 5468 6573 6520 6665 6174 7572 6520  . These feature 
+00004550: 6772 6f75 7073 2063 616e 2062 6520 6163  groups can be ac
+00004560: 6365 7373 6962 6c65 206f 7220 696e 6163  cessible or inac
+00004570: 6365 7373 6962 6c65 2e20 4578 706c 6963  cessible. Explic
+00004580: 6974 0a20 2020 2020 2020 2070 726f 7665  it.        prove
+00004590: 6e61 6e63 6520 646f 6573 206e 6f74 2074  nance does not t
+000045a0: 7261 636b 2064 656c 6574 6564 2067 656e  rack deleted gen
+000045b0: 6572 6174 6564 2066 6561 7475 7265 2067  erated feature g
+000045c0: 726f 7570 206c 696e 6b73 2c20 736f 2064  roup links, so d
+000045d0: 656c 6574 6564 0a20 2020 2020 2020 2077  eleted.        w
+000045e0: 696c 6c20 616c 7761 7973 2062 6520 656d  ill always be em
+000045f0: 7074 792e 0a20 2020 2020 2020 2046 6f72  pty..        For
+00004600: 2069 6e61 6363 6573 7369 626c 6520 6665   inaccessible fe
+00004610: 6174 7572 6520 6772 6f75 7073 2c20 6f6e  ature groups, on
+00004620: 6c79 2061 206d 696e 696d 616c 2069 6e66  ly a minimal inf
+00004630: 6f72 6d61 7469 6f6e 2069 7320 7265 7475  ormation is retu
+00004640: 726e 6564 2e0a 0a20 2020 2020 2020 2023  rned...        #
+00004650: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+00004660: 2020 2020 2060 5072 6f76 656e 616e 6365       `Provenance
+00004670: 4c69 6e6b 7360 3a20 4f62 6a65 6374 2063  Links`: Object c
+00004680: 6f6e 7461 696e 696e 6720 7468 6520 7365  ontaining the se
+00004690: 6374 696f 6e20 6f66 2070 726f 7665 6e61  ction of provena
+000046a0: 6e63 6520 6772 6170 6820 7265 7175 6573  nce graph reques
+000046b0: 7465 642e 0a0a 2020 2020 2020 2020 2320  ted...        # 
+000046c0: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
+000046d0: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
+000046e0: 6578 6365 7074 696f 6e73 2e52 6573 7441  exceptions.RestA
+000046f0: 5049 4572 726f 7260 2e0a 2020 2020 2020  PIError`..      
+00004700: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
+00004710: 7475 726e 2073 656c 662e 5f66 6561 7475  turn self._featu
+00004720: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
+00004730: 6765 745f 6765 6e65 7261 7465 645f 6665  get_generated_fe
+00004740: 6174 7572 655f 6772 6f75 7073 2873 656c  ature_groups(sel
+00004750: 6629 0a0a 2020 2020 6465 6620 6765 745f  f)..    def get_
+00004760: 6665 6174 7572 6528 7365 6c66 2c20 6e61  feature(self, na
+00004770: 6d65 3a20 7374 7229 3a0a 2020 2020 2020  me: str):.      
+00004780: 2020 2222 2252 6574 7269 6576 6520 6120    """Retrieve a 
+00004790: 6046 6561 7475 7265 6020 6f62 6a65 6374  `Feature` object
+000047a0: 2066 726f 6d20 7468 6520 7363 6865 6d61   from the schema
+000047b0: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+000047c0: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+000047d0: 5468 6572 6520 6172 6520 7365 7665 7261  There are severa
+000047e0: 6c20 7761 7973 2074 6f20 6163 6365 7373  l ways to access
+000047f0: 2066 6561 7475 7265 7320 6f66 2061 2066   features of a f
+00004800: 6561 7475 7265 2067 726f 7570 3a0a 0a20  eature group:.. 
+00004810: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00004820: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
+00004830: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+00004840: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
+00004850: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
+00004860: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+00004870: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
+00004880: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
+00004890: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
+000048a0: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+000048b0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
+000048c0: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+000048d0: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
+000048e0: 2020 2020 2020 2020 2023 2067 6574 2046           # get F
+000048f0: 6561 7475 7265 2069 6e73 7461 6e73 650a  eature instanse.
+00004900: 2020 2020 2020 2020 2020 2020 6667 2e66              fg.f
+00004910: 6561 7475 7265 310a 2020 2020 2020 2020  eature1.        
+00004920: 2020 2020 6667 5b22 6665 6174 7572 6531      fg["feature1
+00004930: 225d 0a20 2020 2020 2020 2020 2020 2066  "].            f
+00004940: 672e 6765 745f 6665 6174 7572 6528 2266  g.get_feature("f
+00004950: 6561 7475 7265 3122 290a 2020 2020 2020  eature1").      
+00004960: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
+00004970: 2020 2021 2121 206e 6f74 650a 2020 2020     !!! note.    
+00004980: 2020 2020 2020 2020 4174 7472 6962 7574          Attribut
+00004990: 6520 6163 6365 7373 2074 6f20 6665 6174  e access to feat
+000049a0: 7572 6573 2077 6f72 6b73 206f 6e6c 7920  ures works only 
+000049b0: 666f 7220 6e6f 6e2d 7265 7365 7276 6564  for non-reserved
+000049c0: 206e 616d 6573 2e20 466f 7220 6578 616d   names. For exam
+000049d0: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
+000049e0: 6665 6174 7572 6573 206e 616d 6564 2060  features named `
+000049f0: 6964 6020 6f72 2060 6e61 6d65 6020 7769  id` or `name` wi
+00004a00: 6c6c 206e 6f74 2062 6520 6163 6365 7373  ll not be access
+00004a10: 6962 6c65 2076 6961 2060 6667 2e6e 616d  ible via `fg.nam
+00004a20: 6560 2c20 696e 7374 6561 640a 2020 2020  e`, instead.    
+00004a30: 2020 2020 2020 2020 7468 6973 2077 696c          this wil
+00004a40: 6c20 7265 7475 726e 2074 6865 206e 616d  l return the nam
+00004a50: 6520 6f66 2074 6865 2066 6561 7475 7265  e of the feature
+00004a60: 2067 726f 7570 2069 7473 656c 662e 2046   group itself. F
+00004a70: 616c 6c20 6261 636b 206f 6e20 7573 696e  all back on usin
+00004a80: 670a 2020 2020 2020 2020 2020 2020 7468  g.            th
+00004a90: 6520 6067 6574 5f66 6561 7475 7265 6020  e `get_feature` 
+00004aa0: 6d65 7468 6f64 2e0a 0a20 2020 2020 2020  method...       
+00004ab0: 2023 2041 7267 756d 656e 7473 3a0a 2020   # Arguments:.  
+00004ac0: 2020 2020 2020 2020 2020 6e61 6d65 3a20            name: 
+00004ad0: 5468 6520 6e61 6d65 206f 6620 7468 6520  The name of the 
+00004ae0: 6665 6174 7572 6520 746f 2072 6574 7269  feature to retri
+00004af0: 6576 650a 0a20 2020 2020 2020 2023 2052  eve..        # R
+00004b00: 6574 7572 6e73 3a0a 2020 2020 2020 2020  eturns:.        
+00004b10: 2020 2020 4665 6174 7572 653a 2054 6865      Feature: The
+00004b20: 2066 6561 7475 7265 206f 626a 6563 740a   feature object.
+00004b30: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
+00004b40: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
+00004b50: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+00004b60: 7469 6f6e 732e 4665 6174 7572 6553 746f  tions.FeatureSto
+00004b70: 7265 4578 6365 7074 696f 6e60 2e0a 2020  reException`..  
+00004b80: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00004b90: 2020 7472 793a 0a20 2020 2020 2020 2020    try:.         
+00004ba0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00004bb0: 5f67 6574 6974 656d 5f5f 286e 616d 6529  _getitem__(name)
+00004bc0: 0a20 2020 2020 2020 2065 7863 6570 7420  .        except 
+00004bd0: 4b65 7945 7272 6f72 3a0a 2020 2020 2020  KeyError:.      
+00004be0: 2020 2020 2020 7261 6973 6520 4665 6174        raise Feat
+00004bf0: 7572 6553 746f 7265 4578 6365 7074 696f  ureStoreExceptio
+00004c00: 6e28 0a20 2020 2020 2020 2020 2020 2020  n(.             
+00004c10: 2020 2066 2227 4665 6174 7572 6547 726f     f"'FeatureGro
+00004c20: 7570 2720 6f62 6a65 6374 2068 6173 206e  up' object has n
+00004c30: 6f20 6665 6174 7572 6520 6361 6c6c 6564  o feature called
+00004c40: 2027 7b6e 616d 657d 272e 220a 2020 2020   '{name}'.".    
+00004c50: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+00004c60: 6566 2075 7064 6174 655f 7374 6174 6973  ef update_statis
+00004c70: 7469 6373 5f63 6f6e 6669 6728 7365 6c66  tics_config(self
+00004c80: 293a 0a20 2020 2020 2020 2022 2222 5570  ):.        """Up
+00004c90: 6461 7465 2074 6865 2073 7461 7469 7374  date the statist
+00004ca0: 6963 7320 636f 6e66 6967 7572 6174 696f  ics configuratio
+00004cb0: 6e20 6f66 2074 6865 2066 6561 7475 7265  n of the feature
+00004cc0: 2067 726f 7570 2e0a 0a20 2020 2020 2020   group...       
+00004cd0: 2043 6861 6e67 6520 7468 6520 6073 7461   Change the `sta
+00004ce0: 7469 7374 6963 735f 636f 6e66 6967 6020  tistics_config` 
+00004cf0: 6f62 6a65 6374 2061 6e64 2070 6572 7369  object and persi
+00004d00: 7374 2074 6865 2063 6861 6e67 6573 2062  st the changes b
+00004d10: 7920 6361 6c6c 696e 670a 2020 2020 2020  y calling.      
+00004d20: 2020 7468 6973 206d 6574 686f 642e 0a0a    this method...
+00004d30: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
+00004d40: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
+00004d50: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+00004d60: 2020 2020 2020 2320 636f 6e6e 6563 7420        # connect 
+00004d70: 746f 2074 6865 2046 6561 7475 7265 2053  to the Feature S
+00004d80: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
+00004d90: 2066 7320 3d20 2e2e 2e0a 0a20 2020 2020   fs = .....     
+00004da0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
+00004db0: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
+00004dc0: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
+00004dd0: 2020 2020 6667 203d 2066 732e 6765 745f      fg = fs.get_
+00004de0: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
+00004df0: 655f 6772 6f75 7028 2e2e 2e29 0a0a 2020  e_group(...)..  
+00004e00: 2020 2020 2020 2020 2020 6667 2e75 7064            fg.upd
+00004e10: 6174 655f 7374 6174 6973 7469 6373 5f63  ate_statistics_c
+00004e20: 6f6e 6669 6728 290a 2020 2020 2020 2020  onfig().        
+00004e30: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
+00004e40: 2023 2052 6574 7572 6e73 0a20 2020 2020   # Returns.     
+00004e50: 2020 2020 2020 2060 4665 6174 7572 6547         `FeatureG
+00004e60: 726f 7570 602e 2054 6865 2075 7064 6174  roup`. The updat
+00004e70: 6564 206d 6574 6164 6174 6120 6f62 6a65  ed metadata obje
+00004e80: 6374 206f 6620 7468 6520 6665 6174 7572  ct of the featur
+00004e90: 6520 6772 6f75 702e 0a0a 2020 2020 2020  e group...      
+00004ea0: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
+00004eb0: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
+00004ec0: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
+00004ed0: 6573 7441 5049 4572 726f 7260 2e0a 2020  estAPIError`..  
+00004ee0: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
+00004ef0: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
+00004f00: 732e 4665 6174 7572 6553 746f 7265 4578  s.FeatureStoreEx
+00004f10: 6365 7074 696f 6e60 2e0a 2020 2020 2020  ception`..      
+00004f20: 2020 2222 220a 2020 2020 2020 2020 7365    """.        se
+00004f30: 6c66 2e5f 6368 6563 6b5f 7374 6174 6973  lf._check_statis
+00004f40: 7469 6373 5f73 7570 706f 7274 2829 2020  tics_support()  
+00004f50: 2320 7261 6973 6573 2061 6e20 6572 726f  # raises an erro
+00004f60: 7220 6966 2073 7461 7473 206e 6f74 2073  r if stats not s
+00004f70: 7570 706f 7274 6564 0a20 2020 2020 2020  upported.       
+00004f80: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+00004f90: 726f 7570 5f65 6e67 696e 652e 7570 6461  roup_engine.upda
+00004fa0: 7465 5f73 7461 7469 7374 6963 735f 636f  te_statistics_co
+00004fb0: 6e66 6967 2873 656c 6629 0a20 2020 2020  nfig(self).     
+00004fc0: 2020 2072 6574 7572 6e20 7365 6c66 0a0a     return self..
+00004fd0: 2020 2020 6465 6620 7570 6461 7465 5f64      def update_d
+00004fe0: 6573 6372 6970 7469 6f6e 2873 656c 662c  escription(self,
+00004ff0: 2064 6573 6372 6970 7469 6f6e 3a20 7374   description: st
+00005000: 7229 3a0a 2020 2020 2020 2020 2222 2255  r):.        """U
+00005010: 7064 6174 6520 7468 6520 6465 7363 7269  pdate the descri
+00005020: 7074 696f 6e20 6f66 2074 6865 2066 6561  ption of the fea
+00005030: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
+00005040: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
+00005050: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00005060: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+00005070: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
+00005080: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
+00005090: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
+000050a0: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
+000050b0: 2020 2020 2320 6765 7420 7468 6520 4665      # get the Fe
+000050c0: 6174 7572 6520 4772 6f75 7020 696e 7374  ature Group inst
+000050d0: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
+000050e0: 2066 6720 3d20 6673 2e67 6574 5f6f 725f   fg = fs.get_or_
+000050f0: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
+00005100: 726f 7570 282e 2e2e 290a 0a20 2020 2020  roup(...)..     
+00005110: 2020 2020 2020 2066 672e 7570 6461 7465         fg.update
+00005120: 5f64 6573 6372 6970 7469 6f6e 2864 6573  _description(des
+00005130: 6372 6970 7469 6f6e 3d22 4d75 6368 2062  cription="Much b
+00005140: 6574 7465 7220 6465 7363 7269 7074 696f  etter descriptio
+00005150: 6e2e 2229 0a20 2020 2020 2020 2020 2020  n.").           
+00005160: 2060 6060 0a0a 2020 2020 2020 2020 2121   ```..        !!
+00005170: 2120 696e 666f 2022 5361 6665 2075 7064  ! info "Safe upd
+00005180: 6174 6522 0a20 2020 2020 2020 2020 2020  ate".           
+00005190: 2054 6869 7320 6d65 7468 6f64 2075 7064   This method upd
+000051a0: 6174 6573 2074 6865 2066 6561 7475 7265  ates the feature
+000051b0: 2067 726f 7570 2064 6573 6372 6970 7469   group descripti
+000051c0: 6f6e 2073 6166 656c 792e 2049 6e20 6361  on safely. In ca
+000051d0: 7365 206f 6620 6661 696c 7572 650a 2020  se of failure.  
+000051e0: 2020 2020 2020 2020 2020 796f 7572 206c            your l
+000051f0: 6f63 616c 206d 6574 6164 6174 6120 6f62  ocal metadata ob
+00005200: 6a65 6374 2077 696c 6c20 6b65 6570 2074  ject will keep t
+00005210: 6865 206f 6c64 2064 6573 6372 6970 7469  he old descripti
+00005220: 6f6e 2e0a 0a20 2020 2020 2020 2023 2041  on...        # A
+00005230: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+00005240: 2020 2020 2064 6573 6372 6970 7469 6f6e       description
+00005250: 3a20 4e65 7720 6465 7363 7269 7074 696f  : New descriptio
+00005260: 6e20 7374 7269 6e67 2e0a 0a20 2020 2020  n string...     
+00005270: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
+00005280: 2020 2020 2020 2020 2060 4665 6174 7572           `Featur
+00005290: 6547 726f 7570 602e 2054 6865 2075 7064  eGroup`. The upd
+000052a0: 6174 6564 2066 6561 7475 7265 2067 726f  ated feature gro
+000052b0: 7570 206f 626a 6563 742e 0a20 2020 2020  up object..     
+000052c0: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
+000052d0: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
+000052e0: 7570 5f65 6e67 696e 652e 7570 6461 7465  up_engine.update
+000052f0: 5f64 6573 6372 6970 7469 6f6e 2873 656c  _description(sel
+00005300: 662c 2064 6573 6372 6970 7469 6f6e 290a  f, description).
+00005310: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00005320: 656c 660a 0a20 2020 2064 6566 2075 7064  elf..    def upd
+00005330: 6174 655f 6e6f 7469 6669 6361 7469 6f6e  ate_notification
+00005340: 5f74 6f70 6963 5f6e 616d 6528 7365 6c66  _topic_name(self
+00005350: 2c20 6e6f 7469 6669 6361 7469 6f6e 5f74  , notification_t
+00005360: 6f70 6963 5f6e 616d 653a 2073 7472 293a  opic_name: str):
+00005370: 0a20 2020 2020 2020 2022 2222 5570 6461  .        """Upda
+00005380: 7465 2074 6865 206e 6f74 6966 6963 6174  te the notificat
+00005390: 696f 6e20 746f 7069 6320 6e61 6d65 206f  ion topic name o
+000053a0: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
+000053b0: 6f75 702e 0a0a 2020 2020 2020 2020 2121  oup...        !!
+000053c0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+000053d0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+000053e0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+000053f0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+00005400: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+00005410: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+00005420: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+00005430: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+00005440: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+00005450: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+00005460: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+00005470: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+00005480: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+00005490: 6667 2e75 7064 6174 655f 6e6f 7469 6669  fg.update_notifi
+000054a0: 6361 7469 6f6e 5f74 6f70 6963 5f6e 616d  cation_topic_nam
+000054b0: 6528 6e6f 7469 6669 6361 7469 6f6e 5f74  e(notification_t
+000054c0: 6f70 6963 5f6e 616d 653d 226e 6f74 6966  opic_name="notif
+000054d0: 6963 6174 696f 6e5f 746f 7069 635f 6e61  ication_topic_na
+000054e0: 6d65 2229 0a20 2020 2020 2020 2020 2020  me").           
+000054f0: 2060 6060 0a0a 2020 2020 2020 2020 2121   ```..        !!
+00005500: 2120 696e 666f 2022 5361 6665 2075 7064  ! info "Safe upd
+00005510: 6174 6522 0a20 2020 2020 2020 2020 2020  ate".           
+00005520: 2054 6869 7320 6d65 7468 6f64 2075 7064   This method upd
+00005530: 6174 6573 2074 6865 2066 6561 7475 7265  ates the feature
+00005540: 2067 726f 7570 206e 6f74 6966 6963 6174   group notificat
+00005550: 696f 6e20 746f 7069 6320 6e61 6d65 2073  ion topic name s
+00005560: 6166 656c 792e 2049 6e20 6361 7365 206f  afely. In case o
+00005570: 6620 6661 696c 7572 650a 2020 2020 2020  f failure.      
+00005580: 2020 2020 2020 796f 7572 206c 6f63 616c        your local
+00005590: 206d 6574 6164 6174 6120 6f62 6a65 6374   metadata object
+000055a0: 2077 696c 6c20 6b65 6570 2074 6865 206f   will keep the o
+000055b0: 6c64 206e 6f74 6966 6963 6174 696f 6e20  ld notification 
+000055c0: 746f 7069 6320 6e61 6d65 2e0a 0a20 2020  topic name...   
+000055d0: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+000055e0: 0a20 2020 2020 2020 2020 2020 206e 6f74  .            not
+000055f0: 6966 6963 6174 696f 6e5f 746f 7069 635f  ification_topic_
+00005600: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
+00005610: 6520 746f 7069 6320 7573 6564 2066 6f72  e topic used for
+00005620: 2073 656e 6469 6e67 206e 6f74 6966 6963   sending notific
+00005630: 6174 696f 6e73 2077 6865 6e20 656e 7472  ations when entr
+00005640: 6965 730a 2020 2020 2020 2020 2020 2020  ies.            
+00005650: 2020 2020 6172 6520 696e 7365 7274 6564      are inserted
+00005660: 206f 7220 7570 6461 7465 6420 6f6e 2074   or updated on t
+00005670: 6865 206f 6e6c 696e 6520 6665 6174 7572  he online featur
+00005680: 6520 7374 6f72 652e 2049 6620 7365 7420  e store. If set 
+00005690: 746f 204e 6f6e 6520 6e6f 206e 6f74 6966  to None no notif
+000056a0: 6963 6174 696f 6e73 2061 7265 2073 656e  ications are sen
+000056b0: 742e 0a0a 2020 2020 2020 2020 2320 5265  t...        # Re
+000056c0: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
+000056d0: 2020 6046 6561 7475 7265 4772 6f75 7060    `FeatureGroup`
+000056e0: 2e20 5468 6520 7570 6461 7465 6420 6665  . The updated fe
+000056f0: 6174 7572 6520 6772 6f75 7020 6f62 6a65  ature group obje
+00005700: 6374 2e0a 2020 2020 2020 2020 2222 220a  ct..        """.
+00005710: 2020 2020 2020 2020 7365 6c66 2e5f 6665          self._fe
+00005720: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
+00005730: 6e65 2e75 7064 6174 655f 6e6f 7469 6669  ne.update_notifi
+00005740: 6361 7469 6f6e 5f74 6f70 6963 5f6e 616d  cation_topic_nam
+00005750: 6528 0a20 2020 2020 2020 2020 2020 2073  e(.            s
+00005760: 656c 662c 206e 6f74 6966 6963 6174 696f  elf, notificatio
+00005770: 6e5f 746f 7069 635f 6e61 6d65 0a20 2020  n_topic_name.   
+00005780: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
+00005790: 6574 7572 6e20 7365 6c66 0a0a 2020 2020  eturn self..    
+000057a0: 6465 6620 7570 6461 7465 5f64 6570 7265  def update_depre
+000057b0: 6361 7465 6428 7365 6c66 2c20 6465 7072  cated(self, depr
+000057c0: 6563 6174 653a 2062 6f6f 6c20 3d20 5472  ecate: bool = Tr
+000057d0: 7565 293a 0a20 2020 2020 2020 2022 2222  ue):.        """
+000057e0: 4465 7072 6563 6174 6520 7468 6520 6665  Deprecate the fe
+000057f0: 6174 7572 6520 6772 6f75 702e 0a0a 2020  ature group...  
+00005800: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
+00005810: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+00005820: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+00005830: 2020 2020 2320 636f 6e6e 6563 7420 746f      # connect to
+00005840: 2074 6865 2046 6561 7475 7265 2053 746f   the Feature Sto
+00005850: 7265 0a20 2020 2020 2020 2020 2020 2066  re.            f
+00005860: 7320 3d20 2e2e 2e0a 0a20 2020 2020 2020  s = .....       
+00005870: 2020 2020 2023 2067 6574 2074 6865 2046       # get the F
+00005880: 6561 7475 7265 2047 726f 7570 2069 6e73  eature Group ins
+00005890: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
+000058a0: 2020 6667 203d 2066 732e 6765 745f 6f72    fg = fs.get_or
+000058b0: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
+000058c0: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
+000058d0: 2020 2020 2020 2020 6667 2e75 7064 6174          fg.updat
+000058e0: 655f 6465 7072 6563 6174 6564 2864 6570  e_deprecated(dep
+000058f0: 7265 6361 7465 3d54 7275 6529 0a20 2020  recate=True).   
+00005900: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
+00005910: 2020 2020 2020 2121 2120 696e 666f 2022        !!! info "
+00005920: 5361 6665 2075 7064 6174 6522 0a20 2020  Safe update".   
+00005930: 2020 2020 2020 2020 2054 6869 7320 6d65           This me
+00005940: 7468 6f64 2075 7064 6174 6573 2074 6865  thod updates the
+00005950: 2066 6561 7475 7265 2067 726f 7570 2073   feature group s
+00005960: 6166 656c 792e 2049 6e20 6361 7365 206f  afely. In case o
+00005970: 6620 6661 696c 7572 650a 2020 2020 2020  f failure.      
+00005980: 2020 2020 2020 796f 7572 206c 6f63 616c        your local
+00005990: 206d 6574 6164 6174 6120 6f62 6a65 6374   metadata object
+000059a0: 2077 696c 6c20 6265 206b 6570 7420 756e   will be kept un
+000059b0: 6368 616e 6765 642e 0a0a 2020 2020 2020  changed...      
+000059c0: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
+000059d0: 2020 2020 2020 2020 2020 6465 7072 6563            deprec
+000059e0: 6174 653a 2042 6f6f 6c65 616e 2076 616c  ate: Boolean val
+000059f0: 7565 2069 6465 6e74 6966 7969 6e67 2069  ue identifying i
+00005a00: 6620 7468 6520 6665 6174 7572 6520 6772  f the feature gr
+00005a10: 6f75 7020 7368 6f75 6c64 2062 6520 6465  oup should be de
+00005a20: 7072 6563 6174 6564 2e20 4465 6661 756c  precated. Defaul
+00005a30: 7473 2074 6f20 5472 7565 2e0a 0a20 2020  ts to True...   
+00005a40: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
+00005a50: 2020 2020 2020 2020 2020 2060 4665 6174             `Feat
+00005a60: 7572 6547 726f 7570 602e 2054 6865 2075  ureGroup`. The u
+00005a70: 7064 6174 6564 2066 6561 7475 7265 2067  pdated feature g
+00005a80: 726f 7570 206f 626a 6563 742e 0a20 2020  roup object..   
+00005a90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+00005aa0: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+00005ab0: 726f 7570 5f65 6e67 696e 652e 7570 6461  roup_engine.upda
+00005ac0: 7465 5f64 6570 7265 6361 7465 6428 7365  te_deprecated(se
+00005ad0: 6c66 2c20 6465 7072 6563 6174 6529 0a20  lf, deprecate). 
+00005ae0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00005af0: 6c66 0a0a 2020 2020 6465 6620 7570 6461  lf..    def upda
+00005b00: 7465 5f66 6561 7475 7265 7328 7365 6c66  te_features(self
+00005b10: 2c20 6665 6174 7572 6573 3a20 556e 696f  , features: Unio
+00005b20: 6e5b 6665 6174 7572 652e 4665 6174 7572  n[feature.Featur
+00005b30: 652c 204c 6973 745b 6665 6174 7572 652e  e, List[feature.
+00005b40: 4665 6174 7572 655d 5d29 3a0a 2020 2020  Feature]]):.    
+00005b50: 2020 2020 2222 2255 7064 6174 6520 6d65      """Update me
+00005b60: 7461 6461 7461 206f 6620 6665 6174 7572  tadata of featur
+00005b70: 6573 2069 6e20 7468 6973 2066 6561 7475  es in this featu
+00005b80: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
+00005b90: 2020 2043 7572 7265 6e74 6c79 2069 7427     Currently it'
+00005ba0: 7320 6f6e 6c79 2073 7570 706f 7274 6564  s only supported
+00005bb0: 2074 6f20 7570 6461 7465 2074 6865 2064   to update the d
+00005bc0: 6573 6372 6970 7469 6f6e 206f 6620 6120  escription of a 
+00005bd0: 6665 6174 7572 652e 0a0a 2020 2020 2020  feature...      
+00005be0: 2020 2121 2120 6461 6e67 6572 2022 556e    !!! danger "Un
+00005bf0: 7361 6665 2075 7064 6174 6522 0a20 2020  safe update".   
+00005c00: 2020 2020 2020 2020 204e 6f74 6520 7468           Note th
+00005c10: 6174 2069 6620 796f 7520 7573 6520 616e  at if you use an
+00005c20: 2065 7869 7374 696e 6720 6046 6561 7475   existing `Featu
+00005c30: 7265 6020 6f62 6a65 6374 206f 6620 7468  re` object of th
+00005c40: 6520 7363 6865 6d61 2069 6e20 7468 650a  e schema in the.
+00005c50: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00005c60: 7572 6520 6772 6f75 7020 6d65 7461 6461  ure group metada
+00005c70: 7461 206f 626a 6563 742c 2074 6869 7320  ta object, this 
+00005c80: 6d69 6768 7420 6c65 6176 6520 796f 7572  might leave your
+00005c90: 206d 6574 6164 6174 6120 6f62 6a65 6374   metadata object
+00005ca0: 2069 6e20 610a 2020 2020 2020 2020 2020   in a.          
+00005cb0: 2020 636f 7272 7570 7465 6420 7374 6174    corrupted stat
+00005cc0: 6520 6966 2074 6865 2075 7064 6174 6520  e if the update 
+00005cd0: 6661 696c 732e 0a0a 2020 2020 2020 2020  fails...        
+00005ce0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
+00005cf0: 2020 2020 2020 2020 6665 6174 7572 6573          features
+00005d00: 3a20 6046 6561 7475 7265 6020 6f72 206c  : `Feature` or l
+00005d10: 6973 7420 6f66 2066 6561 7475 7265 732e  ist of features.
+00005d20: 2041 2066 6561 7475 7265 206f 626a 6563   A feature objec
+00005d30: 7420 6f72 206c 6973 7420 7468 6572 656f  t or list thereo
+00005d40: 6620 746f 0a20 2020 2020 2020 2020 2020  f to.           
+00005d50: 2020 2020 2062 6520 7570 6461 7465 642e       be updated.
+00005d60: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
+00005d70: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
+00005d80: 6046 6561 7475 7265 4772 6f75 7060 2e20  `FeatureGroup`. 
+00005d90: 5468 6520 7570 6461 7465 6420 6665 6174  The updated feat
+00005da0: 7572 6520 6772 6f75 7020 6f62 6a65 6374  ure group object
+00005db0: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+00005dc0: 2020 2020 2020 6e65 775f 6665 6174 7572        new_featur
+00005dd0: 6573 203d 205b 5d0a 2020 2020 2020 2020  es = [].        
+00005de0: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
+00005df0: 6174 7572 6573 2c20 6665 6174 7572 652e  atures, feature.
+00005e00: 4665 6174 7572 6529 3a0a 2020 2020 2020  Feature):.      
+00005e10: 2020 2020 2020 6e65 775f 6665 6174 7572        new_featur
+00005e20: 6573 2e61 7070 656e 6428 6665 6174 7572  es.append(featur
+00005e30: 6573 290a 2020 2020 2020 2020 656c 6966  es).        elif
+00005e40: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
+00005e50: 7572 6573 2c20 6c69 7374 293a 0a20 2020  ures, list):.   
+00005e60: 2020 2020 2020 2020 2066 6f72 2066 6561           for fea
+00005e70: 7420 696e 2066 6561 7475 7265 733a 0a20  t in features:. 
+00005e80: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00005e90: 6620 6973 696e 7374 616e 6365 2866 6561  f isinstance(fea
+00005ea0: 742c 2066 6561 7475 7265 2e46 6561 7475  t, feature.Featu
+00005eb0: 7265 293a 0a20 2020 2020 2020 2020 2020  re):.           
+00005ec0: 2020 2020 2020 2020 206e 6577 5f66 6561           new_fea
+00005ed0: 7475 7265 732e 6170 7065 6e64 2866 6561  tures.append(fea
+00005ee0: 7429 0a20 2020 2020 2020 2020 2020 2020  t).             
+00005ef0: 2020 2065 6c73 653a 0a20 2020 2020 2020     else:.       
+00005f00: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+00005f10: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+00005f20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f30: 2020 2020 2020 2254 6865 2061 7267 756d        "The argum
+00005f40: 656e 7420 6066 6561 7475 7265 7360 2068  ent `features` h
+00005f50: 6173 2074 6f20 6265 206f 6620 7479 7065  as to be of type
+00005f60: 2060 4665 6174 7572 6560 206f 7220 220a   `Feature` or ".
+00005f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005f80: 2020 2020 2020 2020 2261 206c 6973 7420          "a list 
+00005f90: 7468 6572 656f 662c 2062 7574 2061 6e20  thereof, but an 
+00005fa0: 656c 656d 656e 7420 6973 206f 6620 7479  element is of ty
+00005fb0: 7065 3a20 607b 7d60 222e 666f 726d 6174  pe: `{}`".format
+00005fc0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00005fd0: 2020 2020 2020 2020 2020 2020 2020 7479                ty
+00005fe0: 7065 2866 6561 7475 7265 7329 0a20 2020  pe(features).   
+00005ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006000: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00006010: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00006020: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+00006030: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00006040: 6545 7272 6f72 280a 2020 2020 2020 2020  eError(.        
+00006050: 2020 2020 2020 2020 2254 6865 2061 7267          "The arg
+00006060: 756d 656e 7420 6066 6561 7475 7265 7360  ument `features`
+00006070: 2068 6173 2074 6f20 6265 206f 6620 7479   has to be of ty
+00006080: 7065 2060 4665 6174 7572 6560 206f 7220  pe `Feature` or 
+00006090: 6120 6c69 7374 2022 0a20 2020 2020 2020  a list ".       
+000060a0: 2020 2020 2020 2020 2022 7468 6572 656f           "thereo
+000060b0: 662c 2062 7574 2069 7320 6f66 2074 7970  f, but is of typ
+000060c0: 653a 2060 7b7d 6022 2e66 6f72 6d61 7428  e: `{}`".format(
+000060d0: 7479 7065 2866 6561 7475 7265 7329 290a  type(features)).
+000060e0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+000060f0: 2020 2020 2020 7365 6c66 2e5f 6665 6174        self._feat
+00006100: 7572 655f 6772 6f75 705f 656e 6769 6e65  ure_group_engine
+00006110: 2e75 7064 6174 655f 6665 6174 7572 6573  .update_features
+00006120: 2873 656c 662c 206e 6577 5f66 6561 7475  (self, new_featu
+00006130: 7265 7329 0a20 2020 2020 2020 2072 6574  res).        ret
+00006140: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+00006150: 6620 7570 6461 7465 5f66 6561 7475 7265  f update_feature
+00006160: 5f64 6573 6372 6970 7469 6f6e 2873 656c  _description(sel
+00006170: 662c 2066 6561 7475 7265 5f6e 616d 653a  f, feature_name:
+00006180: 2073 7472 2c20 6465 7363 7269 7074 696f   str, descriptio
+00006190: 6e3a 2073 7472 293a 0a20 2020 2020 2020  n: str):.       
+000061a0: 2022 2222 5570 6461 7465 2074 6865 2064   """Update the d
+000061b0: 6573 6372 6970 7469 6f6e 206f 6620 6120  escription of a 
+000061c0: 7369 6e67 6c65 2066 6561 7475 7265 2069  single feature i
+000061d0: 6e20 7468 6973 2066 6561 7475 7265 2067  n this feature g
+000061e0: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
+000061f0: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
+00006200: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00006210: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+00006220: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
+00006230: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
+00006240: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
+00006250: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00006260: 6765 7420 7468 6520 4665 6174 7572 6520  get the Feature 
+00006270: 4772 6f75 7020 696e 7374 616e 6365 0a20  Group instance. 
+00006280: 2020 2020 2020 2020 2020 2066 6720 3d20             fg = 
+00006290: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
+000062a0: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
+000062b0: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
+000062c0: 2066 672e 7570 6461 7465 5f66 6561 7475   fg.update_featu
+000062d0: 7265 5f64 6573 6372 6970 7469 6f6e 2866  re_description(f
+000062e0: 6561 7475 7265 5f6e 616d 653d 226d 696e  eature_name="min
+000062f0: 5f74 656d 7022 2c0a 2020 2020 2020 2020  _temp",.        
+00006300: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006320: 2020 6465 7363 7269 7074 696f 6e3d 224d    description="M
+00006330: 7563 6820 6265 7474 6572 2066 6561 7475  uch better featu
+00006340: 7265 2064 6573 6372 6970 7469 6f6e 2e22  re description."
+00006350: 290a 2020 2020 2020 2020 2020 2020 6060  ).            ``
+00006360: 600a 0a20 2020 2020 2020 2021 2121 2069  `..        !!! i
+00006370: 6e66 6f20 2253 6166 6520 7570 6461 7465  nfo "Safe update
+00006380: 220a 2020 2020 2020 2020 2020 2020 5468  ".            Th
+00006390: 6973 206d 6574 686f 6420 7570 6461 7465  is method update
+000063a0: 7320 7468 6520 6665 6174 7572 6520 6465  s the feature de
+000063b0: 7363 7269 7074 696f 6e20 7361 6665 6c79  scription safely
+000063c0: 2e20 496e 2063 6173 6520 6f66 2066 6169  . In case of fai
+000063d0: 6c75 7265 0a20 2020 2020 2020 2020 2020  lure.           
+000063e0: 2079 6f75 7220 6c6f 6361 6c20 6d65 7461   your local meta
+000063f0: 6461 7461 206f 626a 6563 7420 7769 6c6c  data object will
+00006400: 206b 6565 7020 7468 6520 6f6c 6420 6465   keep the old de
+00006410: 7363 7269 7074 696f 6e2e 0a0a 2020 2020  scription...    
+00006420: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
+00006430: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00006440: 7572 655f 6e61 6d65 3a20 4e61 6d65 206f  ure_name: Name o
+00006450: 6620 7468 6520 6665 6174 7572 6520 746f  f the feature to
+00006460: 2062 6520 7570 6461 7465 642e 0a20 2020   be updated..   
+00006470: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
+00006480: 7469 6f6e 3a20 4e65 7720 6465 7363 7269  tion: New descri
+00006490: 7074 696f 6e20 7374 7269 6e67 2e0a 0a20  ption string... 
+000064a0: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
+000064b0: 0a20 2020 2020 2020 2020 2020 2060 4665  .            `Fe
+000064c0: 6174 7572 6547 726f 7570 602e 2054 6865  atureGroup`. The
+000064d0: 2075 7064 6174 6564 2066 6561 7475 7265   updated feature
+000064e0: 2067 726f 7570 206f 626a 6563 742e 0a20   group object.. 
+000064f0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00006500: 2020 2066 5f63 6f70 7920 3d20 636f 7079     f_copy = copy
+00006510: 2e64 6565 7063 6f70 7928 7365 6c66 5b66  .deepcopy(self[f
+00006520: 6561 7475 7265 5f6e 616d 655d 290a 2020  eature_name]).  
+00006530: 2020 2020 2020 665f 636f 7079 2e64 6573        f_copy.des
+00006540: 6372 6970 7469 6f6e 203d 2064 6573 6372  cription = descr
+00006550: 6970 7469 6f6e 0a20 2020 2020 2020 2073  iption.        s
+00006560: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
+00006570: 7570 5f65 6e67 696e 652e 7570 6461 7465  up_engine.update
+00006580: 5f66 6561 7475 7265 7328 7365 6c66 2c20  _features(self, 
+00006590: 5b66 5f63 6f70 795d 290a 2020 2020 2020  [f_copy]).      
+000065a0: 2020 7265 7475 726e 2073 656c 660a 0a20    return self.. 
+000065b0: 2020 2064 6566 2061 7070 656e 645f 6665     def append_fe
+000065c0: 6174 7572 6573 2873 656c 662c 2066 6561  atures(self, fea
+000065d0: 7475 7265 733a 2055 6e69 6f6e 5b66 6561  tures: Union[fea
+000065e0: 7475 7265 2e46 6561 7475 7265 2c20 4c69  ture.Feature, Li
+000065f0: 7374 5b66 6561 7475 7265 2e46 6561 7475  st[feature.Featu
+00006600: 7265 5d5d 293a 0a20 2020 2020 2020 2022  re]]):.        "
+00006610: 2222 4170 7065 6e64 2066 6561 7475 7265  ""Append feature
+00006620: 7320 746f 2074 6865 2073 6368 656d 6120  s to the schema 
+00006630: 6f66 2074 6865 2066 6561 7475 7265 2067  of the feature g
+00006640: 726f 7570 2e0a 0a20 2020 2020 2020 2021  roup...        !
+00006650: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
+00006660: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+00006670: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+00006680: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
+00006690: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
+000066a0: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
+000066b0: 0a0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+000066c0: 6465 6669 6e65 2066 6561 7475 7265 7320  define features 
+000066d0: 746f 2062 6520 696e 7365 7274 6564 2069  to be inserted i
+000066e0: 6e20 7468 6520 6665 6174 7572 6520 6772  n the feature gr
+000066f0: 6f75 700a 2020 2020 2020 2020 2020 2020  oup.            
+00006700: 6665 6174 7572 6573 203d 205b 0a20 2020  features = [.   
+00006710: 2020 2020 2020 2020 2020 2020 2046 6561               Fea
+00006720: 7475 7265 286e 616d 653d 2269 6422 2c74  ture(name="id",t
+00006730: 7970 653d 2269 6e74 222c 6f6e 6c69 6e65  ype="int",online
+00006740: 5f74 7970 653d 2269 6e74 2229 2c0a 2020  _type="int"),.  
+00006750: 2020 2020 2020 2020 2020 2020 2020 4665                Fe
+00006760: 6174 7572 6528 6e61 6d65 3d22 6e61 6d65  ature(name="name
+00006770: 222c 7479 7065 3d22 7374 7269 6e67 222c  ",type="string",
+00006780: 6f6e 6c69 6e65 5f74 7970 653d 2276 6172  online_type="var
+00006790: 6368 6172 2832 3029 2229 0a20 2020 2020  char(20)").     
+000067a0: 2020 2020 2020 205d 0a0a 2020 2020 2020         ]..      
+000067b0: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
+000067c0: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
+000067d0: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+000067e0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
+000067f0: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+00006800: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
+00006810: 2020 2020 2020 2020 2066 672e 6170 7065           fg.appe
+00006820: 6e64 5f66 6561 7475 7265 7328 6665 6174  nd_features(feat
+00006830: 7572 6573 290a 2020 2020 2020 2020 2020  ures).          
+00006840: 2020 6060 600a 0a20 2020 2020 2020 2021    ```..        !
+00006850: 2121 2069 6e66 6f20 2253 6166 6520 6170  !! info "Safe ap
+00006860: 7065 6e64 220a 2020 2020 2020 2020 2020  pend".          
+00006870: 2020 5468 6973 206d 6574 686f 6420 6170    This method ap
+00006880: 7065 6e64 7320 7468 6520 6665 6174 7572  pends the featur
+00006890: 6573 2074 6f20 7468 6520 6665 6174 7572  es to the featur
+000068a0: 6520 6772 6f75 7020 6465 7363 7269 7074  e group descript
+000068b0: 696f 6e20 7361 6665 6c79 2e0a 2020 2020  ion safely..    
+000068c0: 2020 2020 2020 2020 496e 2063 6173 6520          In case 
+000068d0: 6f66 2066 6169 6c75 7265 2079 6f75 7220  of failure your 
+000068e0: 6c6f 6361 6c20 6d65 7461 6461 7461 206f  local metadata o
+000068f0: 626a 6563 7420 7769 6c6c 2063 6f6e 7461  bject will conta
+00006900: 696e 2074 6865 2063 6f72 7265 6374 0a20  in the correct. 
+00006910: 2020 2020 2020 2020 2020 2073 6368 656d             schem
+00006920: 612e 0a0a 2020 2020 2020 2020 4974 2069  a...        It i
+00006930: 7320 6f6e 6c79 2070 6f73 7369 626c 6520  s only possible 
+00006940: 746f 2061 7070 656e 6420 6665 6174 7572  to append featur
+00006950: 6573 2074 6f20 6120 6665 6174 7572 6520  es to a feature 
+00006960: 6772 6f75 702e 2052 656d 6f76 696e 670a  group. Removing.
+00006970: 2020 2020 2020 2020 6665 6174 7572 6573          features
+00006980: 2069 7320 636f 6e73 6964 6572 6564 2061   is considered a
+00006990: 2062 7265 616b 696e 6720 6368 616e 6765   breaking change
+000069a0: 2e0a 0a20 2020 2020 2020 2023 2041 7267  ...        # Arg
+000069b0: 756d 656e 7473 0a20 2020 2020 2020 2020  uments.         
+000069c0: 2020 2066 6561 7475 7265 733a 2046 6561     features: Fea
+000069d0: 7475 7265 206f 7220 6c69 7374 2e20 4120  ture or list. A 
+000069e0: 6665 6174 7572 6520 6f62 6a65 6374 206f  feature object o
+000069f0: 7220 6c69 7374 2074 6865 7265 6f66 2074  r list thereof t
+00006a00: 6f20 6170 7065 6e64 2074 6f0a 2020 2020  o append to.    
+00006a10: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00006a20: 7363 6865 6d61 206f 6620 7468 6520 6665  schema of the fe
+00006a30: 6174 7572 6520 6772 6f75 702e 0a0a 2020  ature group...  
+00006a40: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
+00006a50: 2020 2020 2020 2020 2020 2020 6046 6561              `Fea
+00006a60: 7475 7265 4772 6f75 7060 2e20 5468 6520  tureGroup`. The 
+00006a70: 7570 6461 7465 6420 6665 6174 7572 6520  updated feature 
+00006a80: 6772 6f75 7020 6f62 6a65 6374 2e0a 2020  group object..  
+00006a90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00006aa0: 2020 6e65 775f 6665 6174 7572 6573 203d    new_features =
+00006ab0: 205b 5d0a 2020 2020 2020 2020 6966 2069   [].        if i
+00006ac0: 7369 6e73 7461 6e63 6528 6665 6174 7572  sinstance(featur
+00006ad0: 6573 2c20 6665 6174 7572 652e 4665 6174  es, feature.Feat
+00006ae0: 7572 6529 3a0a 2020 2020 2020 2020 2020  ure):.          
+00006af0: 2020 6e65 775f 6665 6174 7572 6573 2e61    new_features.a
+00006b00: 7070 656e 6428 6665 6174 7572 6573 290a  ppend(features).
+00006b10: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+00006b20: 6e73 7461 6e63 6528 6665 6174 7572 6573  nstance(features
+00006b30: 2c20 6c69 7374 293a 0a20 2020 2020 2020  , list):.       
+00006b40: 2020 2020 2066 6f72 2066 6561 7420 696e       for feat in
+00006b50: 2066 6561 7475 7265 733a 0a20 2020 2020   features:.     
+00006b60: 2020 2020 2020 2020 2020 2069 6620 6973             if is
+00006b70: 696e 7374 616e 6365 2866 6561 742c 2066  instance(feat, f
+00006b80: 6561 7475 7265 2e46 6561 7475 7265 293a  eature.Feature):
+00006b90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00006ba0: 2020 2020 206e 6577 5f66 6561 7475 7265       new_feature
+00006bb0: 732e 6170 7065 6e64 2866 6561 7429 0a20  s.append(feat). 
+00006bc0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+00006bd0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00006be0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00006bf0: 7970 6545 7272 6f72 280a 2020 2020 2020  ypeError(.      
+00006c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c10: 2020 2254 6865 2061 7267 756d 656e 7420    "The argument 
+00006c20: 6066 6561 7475 7265 7360 2068 6173 2074  `features` has t
+00006c30: 6f20 6265 206f 6620 7479 7065 2060 4665  o be of type `Fe
+00006c40: 6174 7572 6560 206f 7220 220a 2020 2020  ature` or ".    
+00006c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006c60: 2020 2020 2261 206c 6973 7420 7468 6572      "a list ther
+00006c70: 656f 662c 2062 7574 2061 6e20 656c 656d  eof, but an elem
+00006c80: 656e 7420 6973 206f 6620 7479 7065 3a20  ent is of type: 
+00006c90: 607b 7d60 222e 666f 726d 6174 280a 2020  `{}`".format(.  
+00006ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006cb0: 2020 2020 2020 2020 2020 7479 7065 2866            type(f
+00006cc0: 6561 7475 7265 7329 0a20 2020 2020 2020  eatures).       
+00006cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00006ce0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
+00006cf0: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
+00006d00: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00006d10: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00006d20: 6f72 280a 2020 2020 2020 2020 2020 2020  or(.            
+00006d30: 2020 2020 2254 6865 2061 7267 756d 656e      "The argumen
+00006d40: 7420 6066 6561 7475 7265 7360 2068 6173  t `features` has
+00006d50: 2074 6f20 6265 206f 6620 7479 7065 2060   to be of type `
+00006d60: 4665 6174 7572 6560 206f 7220 6120 6c69  Feature` or a li
+00006d70: 7374 2022 0a20 2020 2020 2020 2020 2020  st ".           
+00006d80: 2020 2020 2022 7468 6572 656f 662c 2062       "thereof, b
+00006d90: 7574 2069 7320 6f66 2074 7970 653a 2060  ut is of type: `
+00006da0: 7b7d 6022 2e66 6f72 6d61 7428 7479 7065  {}`".format(type
+00006db0: 2866 6561 7475 7265 7329 290a 2020 2020  (features)).    
+00006dc0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00006dd0: 2020 7365 6c66 2e5f 6665 6174 7572 655f    self._feature_
+00006de0: 6772 6f75 705f 656e 6769 6e65 2e61 7070  group_engine.app
+00006df0: 656e 645f 6665 6174 7572 6573 2873 656c  end_features(sel
+00006e00: 662c 206e 6577 5f66 6561 7475 7265 7329  f, new_features)
+00006e10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00006e20: 7365 6c66 0a0a 2020 2020 6465 6620 6765  self..    def ge
+00006e30: 745f 6578 7065 6374 6174 696f 6e5f 7375  t_expectation_su
+00006e40: 6974 6528 0a20 2020 2020 2020 2073 656c  ite(.        sel
+00006e50: 662c 2067 655f 7479 7065 3a20 626f 6f6c  f, ge_type: bool
+00006e60: 203d 2054 7275 650a 2020 2020 2920 2d3e   = True.    ) ->
+00006e70: 2055 6e69 6f6e 5b45 7870 6563 7461 7469   Union[Expectati
+00006e80: 6f6e 5375 6974 652c 2067 652e 636f 7265  onSuite, ge.core
+00006e90: 2e45 7870 6563 7461 7469 6f6e 5375 6974  .ExpectationSuit
+00006ea0: 652c 204e 6f6e 655d 3a0a 2020 2020 2020  e, None]:.      
+00006eb0: 2020 2222 2252 6574 7572 6e20 7468 6520    """Return the 
+00006ec0: 6578 7065 6374 6174 696f 6e20 7375 6974  expectation suit
+00006ed0: 6520 6174 7461 6368 6564 2074 6f20 7468  e attached to th
+00006ee0: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
+00006ef0: 6966 2069 7420 6578 6973 7473 2e0a 0a20  if it exists... 
+00006f00: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00006f10: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
+00006f20: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+00006f30: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
+00006f40: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
+00006f50: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
+00006f60: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
+00006f70: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
+00006f80: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
+00006f90: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
+00006fa0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
+00006fb0: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+00006fc0: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
+00006fd0: 2020 2020 2020 2020 2065 7870 5f73 7569           exp_sui
+00006fe0: 7465 203d 2066 672e 6765 745f 6578 7065  te = fg.get_expe
+00006ff0: 6374 6174 696f 6e5f 7375 6974 6528 290a  ctation_suite().
+00007000: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
+00007010: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
+00007020: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+00007030: 2067 655f 7479 7065 3a20 4966 2060 5472   ge_type: If `Tr
+00007040: 7565 6020 7265 7475 726e 7320 6120 6e61  ue` returns a na
+00007050: 7469 7665 2047 7265 6174 2045 7870 6563  tive Great Expec
+00007060: 7461 7469 6f6e 2074 7970 652c 2048 6f70  tation type, Hop
+00007070: 7377 6f72 6b73 0a20 2020 2020 2020 2020  sworks.         
+00007080: 2020 2020 2020 2063 7573 746f 6d20 7479         custom ty
+00007090: 7065 206f 7468 6572 7769 7365 2e20 436f  pe otherwise. Co
+000070a0: 6e76 6572 7369 6f6e 2063 616e 2062 6520  nversion can be 
+000070b0: 7065 7266 6f72 6d65 6420 7669 6120 7468  performed via th
+000070c0: 6520 6074 6f5f 6765 5f74 7970 6528 2960  e `to_ge_type()`
+000070d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000070e0: 206d 6574 686f 6420 6f6e 2068 6f70 7377   method on hopsw
+000070f0: 6f72 6b73 2074 7970 652e 2044 6566 6175  orks type. Defau
+00007100: 6c74 7320 746f 2060 5472 7565 602e 0a0a  lts to `True`...
+00007110: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
+00007120: 730a 2020 2020 2020 2020 2020 2020 6045  s.            `E
+00007130: 7870 6563 7461 7469 6f6e 5375 6974 6560  xpectationSuite`
+00007140: 2e20 5468 6520 6578 7065 6374 6174 696f  . The expectatio
+00007150: 6e20 7375 6974 6520 6174 7461 6368 6564  n suite attached
+00007160: 2074 6f20 7468 6520 6665 6174 7572 6520   to the feature 
+00007170: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+00007180: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
+00007190: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
+000071a0: 742e 6578 6365 7074 696f 6e73 2e52 6573  t.exceptions.Res
+000071b0: 7441 5049 4572 726f 7260 2e0a 2020 2020  tAPIError`..    
+000071c0: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
+000071d0: 2320 4176 6f69 6420 7468 726f 7769 6e67  # Avoid throwing
+000071e0: 2061 6e20 6572 726f 7220 6966 2046 6561   an error if Fea
+000071f0: 7475 7265 2047 726f 7570 206e 6f74 2069  ture Group not i
+00007200: 6e69 7469 616c 6973 6564 2e0a 2020 2020  nitialised..    
+00007210: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
+00007220: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00007230: 662e 5f65 7870 6563 7461 7469 6f6e 5f73  f._expectation_s
+00007240: 7569 7465 203d 2073 656c 662e 5f65 7870  uite = self._exp
+00007250: 6563 7461 7469 6f6e 5f73 7569 7465 5f65  ectation_suite_e
+00007260: 6e67 696e 652e 6765 7428 290a 0a20 2020  ngine.get()..   
+00007270: 2020 2020 2069 6620 7365 6c66 2e5f 6578       if self._ex
+00007280: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
+00007290: 6973 206e 6f74 204e 6f6e 6520 616e 6420  is not None and 
+000072a0: 6765 5f74 7970 6520 6973 2054 7275 653a  ge_type is True:
+000072b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+000072c0: 7572 6e20 7365 6c66 2e5f 6578 7065 6374  urn self._expect
+000072d0: 6174 696f 6e5f 7375 6974 652e 746f 5f67  ation_suite.to_g
+000072e0: 655f 7479 7065 2829 0a20 2020 2020 2020  e_type().       
+000072f0: 2065 6c73 653a 0a20 2020 2020 2020 2020   else:.         
+00007300: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+00007310: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00007320: 650a 0a20 2020 2064 6566 2073 6176 655f  e..    def save_
+00007330: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00007340: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+00007350: 0a20 2020 2020 2020 2065 7870 6563 7461  .        expecta
+00007360: 7469 6f6e 5f73 7569 7465 3a20 556e 696f  tion_suite: Unio
+00007370: 6e5b 4578 7065 6374 6174 696f 6e53 7569  n[ExpectationSui
+00007380: 7465 2c20 6765 2e63 6f72 652e 4578 7065  te, ge.core.Expe
+00007390: 6374 6174 696f 6e53 7569 7465 5d2c 0a20  ctationSuite],. 
+000073a0: 2020 2020 2020 2072 756e 5f76 616c 6964         run_valid
+000073b0: 6174 696f 6e3a 2062 6f6f 6c20 3d20 5472  ation: bool = Tr
+000073c0: 7565 2c0a 2020 2020 2020 2020 7661 6c69  ue,.        vali
+000073d0: 6461 7469 6f6e 5f69 6e67 6573 7469 6f6e  dation_ingestion
+000073e0: 5f70 6f6c 6963 793a 2073 7472 203d 2022  _policy: str = "
+000073f0: 414c 5741 5953 222c 0a20 2020 2020 2020  ALWAYS",.       
+00007400: 206f 7665 7277 7269 7465 3a20 626f 6f6c   overwrite: bool
+00007410: 203d 2046 616c 7365 2c0a 2020 2020 2920   = False,.    ) 
+00007420: 2d3e 2055 6e69 6f6e 5b45 7870 6563 7461  -> Union[Expecta
+00007430: 7469 6f6e 5375 6974 652c 2067 652e 636f  tionSuite, ge.co
+00007440: 7265 2e45 7870 6563 7461 7469 6f6e 5375  re.ExpectationSu
+00007450: 6974 655d 3a0a 2020 2020 2020 2020 2222  ite]:.        ""
+00007460: 2241 7474 6163 6820 616e 2065 7870 6563  "Attach an expec
+00007470: 7461 7469 6f6e 2073 7569 7465 2074 6f20  tation suite to 
+00007480: 6120 6665 6174 7572 6520 6772 6f75 7020  a feature group 
+00007490: 616e 6420 7361 7665 7320 6974 2066 6f72  and saves it for
+000074a0: 2066 7574 7572 6520 7573 652e 2049 6620   future use. If 
+000074b0: 616e 2065 7870 6563 7461 7469 6f6e 0a20  an expectation. 
+000074c0: 2020 2020 2020 2073 7569 7465 2069 7320         suite is 
+000074d0: 616c 7265 6164 7920 6174 7461 6368 6564  already attached
+000074e0: 2c20 6974 2069 7320 7265 706c 6163 6564  , it is replaced
+000074f0: 2e20 4e6f 7465 2074 6861 7420 7468 6520  . Note that the 
+00007500: 7072 6f76 6964 6564 2065 7870 6563 7461  provided expecta
+00007510: 7469 6f6e 2073 7569 7465 2069 7320 6d6f  tion suite is mo
+00007520: 6469 6669 6564 0a20 2020 2020 2020 2069  dified.        i
+00007530: 6e70 6c61 6365 2074 6f20 696e 636c 7564  nplace to includ
+00007540: 6520 6578 7065 6374 6174 696f 6e49 6420  e expectationId 
+00007550: 6669 656c 6473 2e0a 0a20 2020 2020 2020  fields...       
+00007560: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+00007570: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00007580: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
+00007590: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
+000075a0: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
+000075b0: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
+000075c0: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
+000075d0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
+000075e0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
+000075f0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+00007600: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
+00007610: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+00007620: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
+00007630: 2020 2066 672e 7361 7665 5f65 7870 6563     fg.save_expec
+00007640: 7461 7469 6f6e 5f73 7569 7465 2865 7870  tation_suite(exp
+00007650: 6563 7461 7469 6f6e 5f73 7569 7465 2c20  ectation_suite, 
+00007660: 7275 6e5f 7661 6c69 6461 7469 6f6e 3d54  run_validation=T
+00007670: 7275 6529 0a20 2020 2020 2020 2020 2020  rue).           
+00007680: 2060 6060 0a0a 2020 2020 2020 2020 2320   ```..        # 
+00007690: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
+000076a0: 2020 2020 2020 6578 7065 6374 6174 696f        expectatio
+000076b0: 6e5f 7375 6974 653a 2054 6865 2065 7870  n_suite: The exp
+000076c0: 6563 7461 7469 6f6e 2073 7569 7465 2074  ectation suite t
+000076d0: 6f20 6174 7461 6368 2074 6f20 7468 6520  o attach to the 
+000076e0: 4665 6174 7572 6520 4772 6f75 702e 0a20  Feature Group.. 
+000076f0: 2020 2020 2020 2020 2020 206f 7665 7277             overw
+00007700: 7269 7465 3a20 4966 2061 6e20 4578 7065  rite: If an Expe
+00007710: 6374 6174 696f 6e20 5375 6974 6520 6973  ctation Suite is
+00007720: 2061 6c72 6561 6479 2061 7474 6163 6865   already attache
+00007730: 642c 206f 7665 7277 7269 7465 2069 742e  d, overwrite it.
+00007740: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007750: 2054 6865 206e 6577 2073 7569 7465 2077   The new suite w
+00007760: 696c 6c20 6861 7665 2069 7473 206f 776e  ill have its own
+00007770: 2076 616c 6964 6174 696f 6e20 6869 7374   validation hist
+00007780: 6f72 792c 2062 7574 2066 6f72 6d65 7220  ory, but former 
+00007790: 7265 706f 7274 7320 6172 6520 7072 6573  reports are pres
+000077a0: 6572 7665 642e 0a20 2020 2020 2020 2020  erved..         
+000077b0: 2020 2072 756e 5f76 616c 6964 6174 696f     run_validatio
+000077c0: 6e3a 2053 6574 2077 6865 7468 6572 2074  n: Set whether t
+000077d0: 6865 2065 7870 6563 7461 7469 6f6e 5f73  he expectation_s
+000077e0: 7569 7465 2077 696c 6c20 7275 6e20 6f6e  uite will run on
+000077f0: 2069 6e67 6573 7469 6f6e 0a20 2020 2020   ingestion.     
+00007800: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
+00007810: 6e5f 696e 6765 7374 696f 6e5f 706f 6c69  n_ingestion_poli
+00007820: 6379 3a20 5365 7420 7468 6520 706f 6c69  cy: Set the poli
+00007830: 6379 2066 6f72 2069 6e67 6573 7469 6f6e  cy for ingestion
+00007840: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+00007850: 4772 6f75 702e 0a20 2020 2020 2020 2020  Group..         
+00007860: 2020 2020 2020 202d 2022 5354 5249 4354         - "STRICT
+00007870: 2220 6f6e 6c79 2061 6c6c 6f77 7320 4461  " only allows Da
+00007880: 7461 4672 616d 6520 7061 7373 696e 6720  taFrame passing 
+00007890: 7661 6c69 6461 7469 6f6e 2074 6f20 6265  validation to be
+000078a0: 2069 6e73 6572 7465 6420 696e 746f 2046   inserted into F
+000078b0: 6561 7475 7265 2047 726f 7570 2e0a 2020  eature Group..  
+000078c0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+000078d0: 2241 4c57 4159 5322 2061 6c77 6179 7320  "ALWAYS" always 
+000078e0: 696e 7365 7274 2074 6865 2044 6174 6146  insert the DataF
+000078f0: 7261 6d65 2074 6f20 7468 6520 4665 6174  rame to the Feat
+00007900: 7572 6520 4772 6f75 702c 2069 7272 6573  ure Group, irres
+00007910: 7065 6374 6976 6520 6f66 206f 7665 7261  pective of overa
+00007920: 6c6c 2076 616c 6964 6174 696f 6e20 7265  ll validation re
+00007930: 7375 6c74 2e0a 0a20 2020 2020 2020 2023  sult...        #
+00007940: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
+00007950: 2020 2020 6068 7366 732e 636c 6965 6e74      `hsfs.client
+00007960: 2e65 7863 6570 7469 6f6e 732e 5265 7374  .exceptions.Rest
+00007970: 4150 4945 7272 6f72 602e 0a20 2020 2020  APIError`..     
+00007980: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00007990: 6620 6973 696e 7374 616e 6365 2865 7870  f isinstance(exp
+000079a0: 6563 7461 7469 6f6e 5f73 7569 7465 2c20  ectation_suite, 
+000079b0: 6765 2e63 6f72 652e 4578 7065 6374 6174  ge.core.Expectat
+000079c0: 696f 6e53 7569 7465 293a 0a20 2020 2020  ionSuite):.     
+000079d0: 2020 2020 2020 2074 6d70 5f65 7870 6563         tmp_expec
+000079e0: 7461 7469 6f6e 5f73 7569 7465 203d 2045  tation_suite = E
+000079f0: 7870 6563 7461 7469 6f6e 5375 6974 652e  xpectationSuite.
+00007a00: 6672 6f6d 5f67 655f 7479 7065 280a 2020  from_ge_type(.  
+00007a10: 2020 2020 2020 2020 2020 2020 2020 6765                ge
+00007a20: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
+00007a30: 7465 3d65 7870 6563 7461 7469 6f6e 5f73  te=expectation_s
+00007a40: 7569 7465 2c0a 2020 2020 2020 2020 2020  uite,.          
+00007a50: 2020 2020 2020 7275 6e5f 7661 6c69 6461        run_valida
+00007a60: 7469 6f6e 3d72 756e 5f76 616c 6964 6174  tion=run_validat
+00007a70: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00007a80: 2020 2020 2076 616c 6964 6174 696f 6e5f       validation_
+00007a90: 696e 6765 7374 696f 6e5f 706f 6c69 6379  ingestion_policy
+00007aa0: 3d76 616c 6964 6174 696f 6e5f 696e 6765  =validation_inge
+00007ab0: 7374 696f 6e5f 706f 6c69 6379 2c0a 2020  stion_policy,.  
+00007ac0: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+00007ad0: 6174 7572 655f 7374 6f72 655f 6964 3d73  ature_store_id=s
+00007ae0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
+00007af0: 7265 5f69 642c 0a20 2020 2020 2020 2020  re_id,.         
+00007b00: 2020 2020 2020 2066 6561 7475 7265 5f67         feature_g
+00007b10: 726f 7570 5f69 643d 7365 6c66 2e5f 6964  roup_id=self._id
+00007b20: 2c0a 2020 2020 2020 2020 2020 2020 290a  ,.            ).
+00007b30: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
+00007b40: 6e73 7461 6e63 6528 6578 7065 6374 6174  nstance(expectat
+00007b50: 696f 6e5f 7375 6974 652c 2045 7870 6563  ion_suite, Expec
+00007b60: 7461 7469 6f6e 5375 6974 6529 3a0a 2020  tationSuite):.  
+00007b70: 2020 2020 2020 2020 2020 746d 705f 6578            tmp_ex
+00007b80: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
+00007b90: 3d20 6578 7065 6374 6174 696f 6e5f 7375  = expectation_su
+00007ba0: 6974 652e 746f 5f6a 736f 6e5f 6469 6374  ite.to_json_dict
+00007bb0: 2864 6563 616d 656c 697a 653d 5472 7565  (decamelize=True
+00007bc0: 290a 2020 2020 2020 2020 2020 2020 746d  ).            tm
+00007bd0: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
+00007be0: 6974 655b 2266 6561 7475 7265 5f67 726f  ite["feature_gro
+00007bf0: 7570 5f69 6422 5d20 3d20 7365 6c66 2e5f  up_id"] = self._
+00007c00: 6964 0a20 2020 2020 2020 2020 2020 2074  id.            t
+00007c10: 6d70 5f65 7870 6563 7461 7469 6f6e 5f73  mp_expectation_s
+00007c20: 7569 7465 5b22 6665 6174 7572 655f 7374  uite["feature_st
+00007c30: 6f72 655f 6964 225d 203d 2073 656c 662e  ore_id"] = self.
+00007c40: 5f66 6561 7475 7265 5f73 746f 7265 5f69  _feature_store_i
+00007c50: 640a 2020 2020 2020 2020 2020 2020 746d  d.            tm
+00007c60: 705f 6578 7065 6374 6174 696f 6e5f 7375  p_expectation_su
+00007c70: 6974 6520 3d20 4578 7065 6374 6174 696f  ite = Expectatio
+00007c80: 6e53 7569 7465 282a 2a74 6d70 5f65 7870  nSuite(**tmp_exp
+00007c90: 6563 7461 7469 6f6e 5f73 7569 7465 290a  ectation_suite).
+00007ca0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00007cb0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00007cc0: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+00007cd0: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+00007ce0: 7072 6f76 6964 6564 2065 7870 6563 7461  provided expecta
+00007cf0: 7469 6f6e 2073 7569 7465 2074 7970 6520  tion suite type 
+00007d00: 607b 7d60 2069 7320 6e6f 7420 7375 7070  `{}` is not supp
+00007d10: 6f72 7465 642e 2055 7365 2047 7265 6174  orted. Use Great
+00007d20: 2045 7870 6563 7461 7469 6f6e 2060 4578   Expectation `Ex
+00007d30: 7065 6374 6174 696f 6e53 7569 7465 6020  pectationSuite` 
+00007d40: 6f72 2048 5346 5327 206f 776e 2060 4578  or HSFS' own `Ex
+00007d50: 7065 6374 6174 696f 6e53 7569 7465 6020  pectationSuite` 
+00007d60: 6f62 6a65 6374 2e22 2e66 6f72 6d61 7428  object.".format(
+00007d70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007d80: 2020 2020 2074 7970 6528 6578 7065 6374       type(expect
+00007d90: 6174 696f 6e5f 7375 6974 6529 0a20 2020  ation_suite).   
+00007da0: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
+00007db0: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
+00007dc0: 2020 2020 2020 6966 206f 7665 7277 7269        if overwri
+00007dd0: 7465 3a0a 2020 2020 2020 2020 2020 2020  te:.            
+00007de0: 7365 6c66 2e64 656c 6574 655f 6578 7065  self.delete_expe
+00007df0: 6374 6174 696f 6e5f 7375 6974 6528 290a  ctation_suite().
+00007e00: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00007e10: 2e5f 6964 3a0a 2020 2020 2020 2020 2020  ._id:.          
+00007e20: 2020 7365 6c66 2e5f 6578 7065 6374 6174    self._expectat
+00007e30: 696f 6e5f 7375 6974 6520 3d20 7365 6c66  ion_suite = self
+00007e40: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
+00007e50: 6974 655f 656e 6769 6e65 2e73 6176 6528  ite_engine.save(
+00007e60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007e70: 2074 6d70 5f65 7870 6563 7461 7469 6f6e   tmp_expectation
+00007e80: 5f73 7569 7465 0a20 2020 2020 2020 2020  _suite.         
+00007e90: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00007ea0: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
+00007eb0: 7465 203d 2073 656c 662e 5f65 7870 6563  te = self._expec
+00007ec0: 7461 7469 6f6e 5f73 7569 7465 2e74 6f5f  tation_suite.to_
+00007ed0: 6765 5f74 7970 6528 290a 2020 2020 2020  ge_type().      
+00007ee0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00007ef0: 2020 2020 2320 4164 6465 6420 746f 2061      # Added to a
+00007f00: 766f 6964 2074 6872 6f77 696e 6720 616e  void throwing an
+00007f10: 2065 7272 6f72 2069 6620 4665 6174 7572   error if Featur
+00007f20: 6520 4772 6f75 7020 6973 206e 6f74 2069  e Group is not i
+00007f30: 6e69 7469 616c 6973 6564 2077 6974 6820  nitialised with 
+00007f40: 7468 6520 6261 636b 656e 640a 2020 2020  the backend.    
+00007f50: 2020 2020 2020 2020 7365 6c66 2e5f 6578          self._ex
+00007f60: 7065 6374 6174 696f 6e5f 7375 6974 6520  pectation_suite 
+00007f70: 3d20 746d 705f 6578 7065 6374 6174 696f  = tmp_expectatio
+00007f80: 6e5f 7375 6974 650a 0a20 2020 2064 6566  n_suite..    def
+00007f90: 2064 656c 6574 655f 6578 7065 6374 6174   delete_expectat
+00007fa0: 696f 6e5f 7375 6974 6528 7365 6c66 2920  ion_suite(self) 
+00007fb0: 2d3e 204e 6f6e 653a 0a20 2020 2020 2020  -> None:.       
+00007fc0: 2022 2222 4465 6c65 7465 2074 6865 2065   """Delete the e
+00007fd0: 7870 6563 7461 7469 6f6e 2073 7569 7465  xpectation suite
+00007fe0: 2061 7474 6163 6865 6420 746f 2074 6865   attached to the
+00007ff0: 2046 6561 7475 7265 2047 726f 7570 2e0a   Feature Group..
+00008000: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+00008010: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+00008020: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+00008030: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+00008040: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+00008050: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+00008060: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+00008070: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+00008080: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+00008090: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+000080a0: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+000080b0: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+000080c0: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
+000080d0: 2020 2020 2020 2020 2020 2066 672e 6465             fg.de
+000080e0: 6c65 7465 5f65 7870 6563 7461 7469 6f6e  lete_expectation
+000080f0: 5f73 7569 7465 2829 0a20 2020 2020 2020  _suite().       
+00008100: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00008110: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
+00008120: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
+00008130: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
+00008140: 6573 7441 5049 4572 726f 7260 2e0a 2020  estAPIError`..  
+00008150: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00008160: 2020 6966 2073 656c 662e 6765 745f 6578    if self.get_ex
+00008170: 7065 6374 6174 696f 6e5f 7375 6974 6528  pectation_suite(
+00008180: 2920 6973 206e 6f74 204e 6f6e 653a 0a20  ) is not None:. 
+00008190: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000081a0: 5f65 7870 6563 7461 7469 6f6e 5f73 7569  _expectation_sui
+000081b0: 7465 5f65 6e67 696e 652e 6465 6c65 7465  te_engine.delete
+000081c0: 2873 656c 662e 5f65 7870 6563 7461 7469  (self._expectati
+000081d0: 6f6e 5f73 7569 7465 2e69 6429 0a20 2020  on_suite.id).   
+000081e0: 2020 2020 2073 656c 662e 5f65 7870 6563       self._expec
+000081f0: 7461 7469 6f6e 5f73 7569 7465 203d 204e  tation_suite = N
+00008200: 6f6e 650a 0a20 2020 2064 6566 2067 6574  one..    def get
+00008210: 5f6c 6174 6573 745f 7661 6c69 6461 7469  _latest_validati
+00008220: 6f6e 5f72 6570 6f72 7428 0a20 2020 2020  on_report(.     
+00008230: 2020 2073 656c 662c 2067 655f 7479 7065     self, ge_type
+00008240: 3a20 626f 6f6c 203d 2054 7275 650a 2020  : bool = True.  
+00008250: 2020 2920 2d3e 2055 6e69 6f6e 5b56 616c    ) -> Union[Val
+00008260: 6964 6174 696f 6e52 6570 6f72 742c 2067  idationReport, g
+00008270: 652e 636f 7265 2e45 7870 6563 7461 7469  e.core.Expectati
+00008280: 6f6e 5375 6974 6556 616c 6964 6174 696f  onSuiteValidatio
+00008290: 6e52 6573 756c 742c 204e 6f6e 655d 3a0a  nResult, None]:.
+000082a0: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
+000082b0: 6e20 7468 6520 6c61 7465 7374 2076 616c  n the latest val
+000082c0: 6964 6174 696f 6e20 7265 706f 7274 2061  idation report a
+000082d0: 7474 6163 6865 6420 746f 2074 6865 2046  ttached to the F
+000082e0: 6561 7475 7265 2047 726f 7570 2069 6620  eature Group if 
+000082f0: 6974 2065 7869 7374 732e 0a0a 2020 2020  it exists...    
+00008300: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
+00008310: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+00008320: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
+00008330: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
+00008340: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
+00008350: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
+00008360: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
+00008370: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
+00008380: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
+00008390: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
+000083a0: 6667 203d 2066 732e 6765 745f 6f72 5f63  fg = fs.get_or_c
+000083b0: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
+000083c0: 6f75 7028 2e2e 2e29 0a0a 2020 2020 2020  oup(...)..      
+000083d0: 2020 2020 2020 6c61 7465 7374 5f76 616c        latest_val
+000083e0: 5f72 6570 6f72 7420 3d20 6667 2e67 6574  _report = fg.get
+000083f0: 5f6c 6174 6573 745f 7661 6c69 6461 7469  _latest_validati
+00008400: 6f6e 5f72 6570 6f72 7428 290a 2020 2020  on_report().    
+00008410: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+00008420: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+00008430: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
+00008440: 7479 7065 3a20 4966 2060 5472 7565 6020  type: If `True` 
+00008450: 7265 7475 726e 7320 6120 6e61 7469 7665  returns a native
+00008460: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
+00008470: 6f6e 2074 7970 652c 2048 6f70 7377 6f72  on type, Hopswor
+00008480: 6b73 0a20 2020 2020 2020 2020 2020 2020  ks.             
+00008490: 2020 2063 7573 746f 6d20 7479 7065 206f     custom type o
+000084a0: 7468 6572 7769 7365 2e20 436f 6e76 6572  therwise. Conver
+000084b0: 7369 6f6e 2063 616e 2062 6520 7065 7266  sion can be perf
+000084c0: 6f72 6d65 6420 7669 6120 7468 6520 6074  ormed via the `t
+000084d0: 6f5f 6765 5f74 7970 6528 2960 0a20 2020  o_ge_type()`.   
+000084e0: 2020 2020 2020 2020 2020 2020 206d 6574               met
+000084f0: 686f 6420 6f6e 2068 6f70 7377 6f72 6b73  hod on hopsworks
+00008500: 2074 7970 652e 2044 6566 6175 6c74 7320   type. Defaults 
+00008510: 746f 2060 5472 7565 602e 0a0a 2020 2020  to `True`...    
+00008520: 2020 2020 2320 5265 7475 726e 730a 2020      # Returns.  
+00008530: 2020 2020 2020 2020 2020 6056 616c 6964            `Valid
+00008540: 6174 696f 6e52 6570 6f72 7460 2e20 5468  ationReport`. Th
+00008550: 6520 6c61 7465 7374 2076 616c 6964 6174  e latest validat
+00008560: 696f 6e20 7265 706f 7274 2061 7474 6163  ion report attac
+00008570: 6865 6420 746f 2074 6865 2046 6561 7475  hed to the Featu
+00008580: 7265 2047 726f 7570 2e0a 0a20 2020 2020  re Group...     
+00008590: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
+000085a0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
+000085b0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
+000085c0: 5265 7374 4150 4945 7272 6f72 602e 0a20  RestAPIError`.. 
+000085d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+000085e0: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+000085f0: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
+00008600: 745f 656e 6769 6e65 2e67 6574 5f6c 6173  t_engine.get_las
+00008610: 7428 6765 5f74 7970 653d 6765 5f74 7970  t(ge_type=ge_typ
+00008620: 6529 0a0a 2020 2020 6465 6620 6765 745f  e)..    def get_
+00008630: 616c 6c5f 7661 6c69 6461 7469 6f6e 5f72  all_validation_r
+00008640: 6570 6f72 7473 280a 2020 2020 2020 2020  eports(.        
+00008650: 7365 6c66 2c20 6765 5f74 7970 653a 2062  self, ge_type: b
+00008660: 6f6f 6c20 3d20 5472 7565 0a20 2020 2029  ool = True.    )
+00008670: 202d 3e20 4c69 7374 5b55 6e69 6f6e 5b56   -> List[Union[V
+00008680: 616c 6964 6174 696f 6e52 6570 6f72 742c  alidationReport,
+00008690: 2067 652e 636f 7265 2e45 7870 6563 7461   ge.core.Expecta
+000086a0: 7469 6f6e 5375 6974 6556 616c 6964 6174  tionSuiteValidat
+000086b0: 696f 6e52 6573 756c 745d 5d3a 0a20 2020  ionResult]]:.   
+000086c0: 2020 2020 2022 2222 5265 7475 726e 2074       """Return t
+000086d0: 6865 206c 6174 6573 7420 7661 6c69 6461  he latest valida
+000086e0: 7469 6f6e 2072 6570 6f72 7420 6174 7461  tion report atta
+000086f0: 6368 6564 2074 6f20 7468 6520 6665 6174  ched to the feat
+00008700: 7572 6520 6772 6f75 7020 6966 2069 7420  ure group if it 
+00008710: 6578 6973 7473 2e0a 0a20 2020 2020 2020  exists...       
+00008720: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+00008730: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00008740: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
+00008750: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
+00008760: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
+00008770: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
+00008780: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
+00008790: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
+000087a0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
+000087b0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+000087c0: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
+000087d0: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+000087e0: 282e 2e2e 290a 0a20 2020 2020 2020 2020  (...)..         
+000087f0: 2020 2076 616c 5f72 6570 6f72 7473 203d     val_reports =
+00008800: 2066 672e 6765 745f 616c 6c5f 7661 6c69   fg.get_all_vali
+00008810: 6461 7469 6f6e 5f72 6570 6f72 7473 2829  dation_reports()
+00008820: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00008830: 0a0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
+00008840: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
+00008850: 2020 6765 5f74 7970 653a 2049 6620 6054    ge_type: If `T
+00008860: 7275 6560 2072 6574 7572 6e73 2061 206e  rue` returns a n
+00008870: 6174 6976 6520 4772 6561 7420 4578 7065  ative Great Expe
+00008880: 6374 6174 696f 6e20 7479 7065 2c20 486f  ctation type, Ho
+00008890: 7073 776f 726b 730a 2020 2020 2020 2020  psworks.        
+000088a0: 2020 2020 2020 2020 6375 7374 6f6d 2074          custom t
+000088b0: 7970 6520 6f74 6865 7277 6973 652e 2043  ype otherwise. C
+000088c0: 6f6e 7665 7273 696f 6e20 6361 6e20 6265  onversion can be
+000088d0: 2070 6572 666f 726d 6564 2076 6961 2074   performed via t
+000088e0: 6865 2060 746f 5f67 655f 7479 7065 2829  he `to_ge_type()
+000088f0: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
+00008900: 2020 6d65 7468 6f64 206f 6e20 686f 7073    method on hops
+00008910: 776f 726b 7320 7479 7065 2e20 4465 6661  works type. Defa
+00008920: 756c 7473 2074 6f20 6054 7275 6560 2e0a  ults to `True`..
+00008930: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
+00008940: 6e73 0a20 2020 2020 2020 2020 2020 2055  ns.            U
+00008950: 6e69 6f6e 5b4c 6973 745b 6056 616c 6964  nion[List[`Valid
+00008960: 6174 696f 6e52 6570 6f72 7460 5d2c 2060  ationReport`], `
+00008970: 5661 6c69 6461 7469 6f6e 5265 706f 7274  ValidationReport
+00008980: 605d 2e20 416c 6c20 7661 6c69 6461 7469  `]. All validati
+00008990: 6f6e 2072 6570 6f72 7473 2061 7474 6163  on reports attac
+000089a0: 6865 6420 746f 2074 6865 2066 6561 7475  hed to the featu
+000089b0: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
+000089c0: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
+000089d0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
+000089e0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
+000089f0: 5265 7374 4150 4945 7272 6f72 602e 0a20  RestAPIError`.. 
+00008a00: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
+00008a10: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
+00008a20: 6e73 2e46 6561 7475 7265 5374 6f72 6545  ns.FeatureStoreE
+00008a30: 7863 6570 7469 6f6e 602e 0a20 2020 2020  xception`..     
+00008a40: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+00008a50: 6620 7365 6c66 2e5f 6964 3a0a 2020 2020  f self._id:.    
+00008a60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00008a70: 656c 662e 5f76 616c 6964 6174 696f 6e5f  elf._validation_
+00008a80: 7265 706f 7274 5f65 6e67 696e 652e 6765  report_engine.ge
+00008a90: 745f 616c 6c28 6765 5f74 7970 653d 6765  t_all(ge_type=ge
+00008aa0: 5f74 7970 6529 0a20 2020 2020 2020 2065  _type).        e
+00008ab0: 6c73 653a 0a20 2020 2020 2020 2020 2020  lse:.           
+00008ac0: 2072 6169 7365 2046 6561 7475 7265 5374   raise FeatureSt
+00008ad0: 6f72 6545 7863 6570 7469 6f6e 280a 2020  oreException(.  
+00008ae0: 2020 2020 2020 2020 2020 2020 2020 224f                "O
+00008af0: 6e6c 7920 4665 6174 7572 6520 4772 6f75  nly Feature Grou
+00008b00: 7020 7265 6769 7374 6572 6564 2077 6974  p registered wit
+00008b10: 6820 486f 7073 776f 726b 7320 6361 6e20  h Hopsworks can 
+00008b20: 6665 7463 6820 7661 6c69 6461 7469 6f6e  fetch validation
+00008b30: 2072 6570 6f72 7473 2e22 0a20 2020 2020   reports.".     
+00008b40: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+00008b50: 6620 7361 7665 5f76 616c 6964 6174 696f  f save_validatio
+00008b60: 6e5f 7265 706f 7274 280a 2020 2020 2020  n_report(.      
+00008b70: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+00008b80: 7661 6c69 6461 7469 6f6e 5f72 6570 6f72  validation_repor
+00008b90: 743a 2055 6e69 6f6e 5b0a 2020 2020 2020  t: Union[.      
+00008ba0: 2020 2020 2020 6469 6374 2c0a 2020 2020        dict,.    
+00008bb0: 2020 2020 2020 2020 5661 6c69 6461 7469          Validati
+00008bc0: 6f6e 5265 706f 7274 2c0a 2020 2020 2020  onReport,.      
+00008bd0: 2020 2020 2020 6765 2e63 6f72 652e 6578        ge.core.ex
+00008be0: 7065 6374 6174 696f 6e5f 7661 6c69 6461  pectation_valida
+00008bf0: 7469 6f6e 5f72 6573 756c 742e 4578 7065  tion_result.Expe
+00008c00: 6374 6174 696f 6e53 7569 7465 5661 6c69  ctationSuiteVali
+00008c10: 6461 7469 6f6e 5265 7375 6c74 2c0a 2020  dationResult,.  
+00008c20: 2020 2020 2020 5d2c 0a20 2020 2020 2020        ],.       
+00008c30: 2069 6e67 6573 7469 6f6e 5f72 6573 756c   ingestion_resul
+00008c40: 743a 2073 7472 203d 2022 554e 4b4e 4f57  t: str = "UNKNOW
+00008c50: 4e22 2c0a 2020 2020 2020 2020 6765 5f74  N",.        ge_t
+00008c60: 7970 653a 2062 6f6f 6c20 3d20 5472 7565  ype: bool = True
+00008c70: 2c0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ,.    ) -> Union
+00008c80: 5b56 616c 6964 6174 696f 6e52 6570 6f72  [ValidationRepor
+00008c90: 742c 2067 652e 636f 7265 2e45 7870 6563  t, ge.core.Expec
+00008ca0: 7461 7469 6f6e 5375 6974 6556 616c 6964  tationSuiteValid
+00008cb0: 6174 696f 6e52 6573 756c 745d 3a0a 2020  ationResult]:.  
+00008cc0: 2020 2020 2020 2222 2253 6176 6520 7661        """Save va
+00008cd0: 6c69 6461 7469 6f6e 2072 6570 6f72 7420  lidation report 
+00008ce0: 746f 2068 6f70 7377 6f72 6b73 2070 6c61  to hopsworks pla
+00008cf0: 7466 6f72 6d20 616c 6f6e 6720 7072 6576  tform along prev
+00008d00: 696f 7573 2072 6570 6f72 7473 206f 6620  ious reports of 
+00008d10: 7468 6520 7361 6d65 2046 6561 7475 7265  the same Feature
+00008d20: 2047 726f 7570 2e0a 0a20 2020 2020 2020   Group...       
+00008d30: 2021 2121 2065 7861 6d70 6c65 0a20 2020   !!! example.   
+00008d40: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
+00008d50: 6f6e 0a20 2020 2020 2020 2020 2020 2023  on.            #
+00008d60: 2063 6f6e 6e65 6374 2074 6f20 7468 6520   connect to the 
+00008d70: 4665 6174 7572 6520 5374 6f72 650a 2020  Feature Store.  
+00008d80: 2020 2020 2020 2020 2020 6673 203d 202e            fs = .
+00008d90: 2e2e 0a0a 2020 2020 2020 2020 2020 2020  ....            
+00008da0: 2320 6765 7420 7468 6520 4665 6174 7572  # get the Featur
+00008db0: 6520 4772 6f75 7020 696e 7374 616e 6365  e Group instance
+00008dc0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+00008dd0: 3d20 6673 2e67 6574 5f6f 725f 6372 6561  = fs.get_or_crea
+00008de0: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+00008df0: 282e 2e2e 2c20 6578 7065 6374 6174 696f  (..., expectatio
+00008e00: 6e5f 7375 6974 653d 6578 7065 6374 6174  n_suite=expectat
+00008e10: 696f 6e5f 7375 6974 6529 0a0a 2020 2020  ion_suite)..    
+00008e20: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
+00008e30: 6f6e 5f72 6570 6f72 7420 3d20 6772 6561  on_report = grea
+00008e40: 745f 6578 7065 6374 6174 696f 6e73 2e66  t_expectations.f
+00008e50: 726f 6d5f 7061 6e64 6173 280a 2020 2020  rom_pandas(.    
+00008e60: 2020 2020 2020 2020 2020 2020 6d79 5f65              my_e
+00008e70: 7870 6572 696d 656e 7461 6c5f 6665 6174  xperimental_feat
+00008e80: 7572 6573 5f64 662c 0a20 2020 2020 2020  ures_df,.       
+00008e90: 2020 2020 2020 2020 2066 672e 6765 745f           fg.get_
+00008ea0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00008eb0: 6528 2929 2e76 616c 6964 6174 6528 290a  e()).validate().
+00008ec0: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
+00008ed0: 7361 7665 5f76 616c 6964 6174 696f 6e5f  save_validation_
+00008ee0: 7265 706f 7274 2876 616c 6964 6174 696f  report(validatio
+00008ef0: 6e5f 7265 706f 7274 2c20 696e 6765 7374  n_report, ingest
+00008f00: 696f 6e5f 7265 7375 6c74 3d22 4558 5045  ion_result="EXPE
+00008f10: 5249 4d45 4e54 2229 0a20 2020 2020 2020  RIMENT").       
+00008f20: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00008f30: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
+00008f40: 2020 2020 2020 2020 2020 7661 6c69 6461            valida
+00008f50: 7469 6f6e 5f72 6570 6f72 743a 2054 6865  tion_report: The
+00008f60: 2076 616c 6964 6174 696f 6e20 7265 706f   validation repo
+00008f70: 7274 2074 6f20 6174 7461 6368 2074 6f20  rt to attach to 
+00008f80: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+00008f90: 702e 0a20 2020 2020 2020 2020 2020 2069  p..            i
+00008fa0: 6e67 6573 7469 6f6e 5f72 6573 756c 743a  ngestion_result:
+00008fb0: 2053 7065 6369 6679 2074 6865 2066 6174   Specify the fat
+00008fc0: 6520 6f66 2074 6865 2061 7373 6f63 6961  e of the associa
+00008fd0: 7465 6420 6461 7461 2c20 6465 6661 756c  ted data, defaul
+00008fe0: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
+00008ff0: 2020 2074 6f20 2255 4e4b 4e4f 574e 222e     to "UNKNOWN".
+00009000: 2053 7570 706f 7274 6564 206f 7074 696f   Supported optio
+00009010: 6e73 2061 7265 2020 2255 4e4b 4e4f 574e  ns are  "UNKNOWN
+00009020: 222c 2022 494e 4745 5354 4544 222c 2022  ", "INGESTED", "
+00009030: 5245 4a45 4354 4544 222c 0a20 2020 2020  REJECTED",.     
+00009040: 2020 2020 2020 2020 2020 2022 4558 5045             "EXPE
+00009050: 5249 4d45 4e54 222c 2022 4647 5f44 4154  RIMENT", "FG_DAT
+00009060: 4122 2e20 5573 6520 2249 4e47 4553 5445  A". Use "INGESTE
+00009070: 4422 206f 7220 2252 454a 4543 5445 4422  D" or "REJECTED"
+00009080: 2066 6f72 2076 616c 6964 6174 696f 6e0a   for validation.
+00009090: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000090a0: 6f66 2044 6174 6146 7261 6d65 7320 746f  of DataFrames to
+000090b0: 2062 6520 696e 7365 7274 6564 2069 6e20   be inserted in 
+000090c0: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+000090d0: 702e 2055 7365 2022 4558 5045 5249 4d45  p. Use "EXPERIME
+000090e0: 4e54 220a 2020 2020 2020 2020 2020 2020  NT".            
+000090f0: 2020 2020 666f 7220 7465 7374 696e 6720      for testing 
+00009100: 616e 6420 6465 7665 6c6f 706d 656e 7420  and development 
+00009110: 616e 6420 2246 475f 4441 5441 2220 7768  and "FG_DATA" wh
+00009120: 656e 2076 616c 6964 6174 696e 6720 6461  en validating da
+00009130: 7461 0a20 2020 2020 2020 2020 2020 2020  ta.             
+00009140: 2020 2061 6c72 6561 6479 2069 6e20 7468     already in th
+00009150: 6520 4665 6174 7572 6520 4772 6f75 702e  e Feature Group.
+00009160: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
+00009170: 7479 7065 3a20 4966 2060 5472 7565 6020  type: If `True` 
+00009180: 7265 7475 726e 7320 6120 6e61 7469 7665  returns a native
+00009190: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
+000091a0: 6f6e 2074 7970 652c 2048 6f70 7377 6f72  on type, Hopswor
+000091b0: 6b73 0a20 2020 2020 2020 2020 2020 2020  ks.             
+000091c0: 2020 2063 7573 746f 6d20 7479 7065 206f     custom type o
+000091d0: 7468 6572 7769 7365 2e20 436f 6e76 6572  therwise. Conver
+000091e0: 7369 6f6e 2063 616e 2062 6520 7065 7266  sion can be perf
+000091f0: 6f72 6d65 6420 7669 6120 7468 6520 6074  ormed via the `t
+00009200: 6f5f 6765 5f74 7970 6528 2960 0a20 2020  o_ge_type()`.   
+00009210: 2020 2020 2020 2020 2020 2020 206d 6574               met
+00009220: 686f 6420 6f6e 2068 6f70 7377 6f72 6b73  hod on hopsworks
+00009230: 2074 7970 652e 2044 6566 6175 6c74 7320   type. Defaults 
+00009240: 746f 2060 5472 7565 602e 0a0a 2020 2020  to `True`...    
+00009250: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+00009260: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+00009270: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+00009280: 2e52 6573 7441 5049 4572 726f 7260 2e0a  .RestAPIError`..
+00009290: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000092a0: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
+000092b0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+000092c0: 6973 696e 7374 616e 6365 280a 2020 2020  isinstance(.    
+000092d0: 2020 2020 2020 2020 2020 2020 7661 6c69              vali
+000092e0: 6461 7469 6f6e 5f72 6570 6f72 742c 0a20  dation_report,. 
+000092f0: 2020 2020 2020 2020 2020 2020 2020 2067                 g
+00009300: 652e 636f 7265 2e65 7870 6563 7461 7469  e.core.expectati
+00009310: 6f6e 5f76 616c 6964 6174 696f 6e5f 7265  on_validation_re
+00009320: 7375 6c74 2e45 7870 6563 7461 7469 6f6e  sult.Expectation
+00009330: 5375 6974 6556 616c 6964 6174 696f 6e52  SuiteValidationR
+00009340: 6573 756c 742c 0a20 2020 2020 2020 2020  esult,.         
+00009350: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+00009360: 2020 2020 2020 7265 706f 7274 203d 2056        report = V
+00009370: 616c 6964 6174 696f 6e52 6570 6f72 7428  alidationReport(
+00009380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00009390: 2020 2020 202a 2a76 616c 6964 6174 696f       **validatio
+000093a0: 6e5f 7265 706f 7274 2e74 6f5f 6a73 6f6e  n_report.to_json
+000093b0: 5f64 6963 7428 292c 0a20 2020 2020 2020  _dict(),.       
+000093c0: 2020 2020 2020 2020 2020 2020 2069 6e67               ing
+000093d0: 6573 7469 6f6e 5f72 6573 756c 743d 696e  estion_result=in
+000093e0: 6765 7374 696f 6e5f 7265 7375 6c74 2c0a  gestion_result,.
+000093f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009400: 290a 2020 2020 2020 2020 2020 2020 656c  ).            el
+00009410: 6966 2069 7369 6e73 7461 6e63 6528 7661  if isinstance(va
+00009420: 6c69 6461 7469 6f6e 5f72 6570 6f72 742c  lidation_report,
+00009430: 2064 6963 7429 3a0a 2020 2020 2020 2020   dict):.        
+00009440: 2020 2020 2020 2020 7265 706f 7274 203d          report =
+00009450: 2056 616c 6964 6174 696f 6e52 6570 6f72   ValidationRepor
+00009460: 7428 0a20 2020 2020 2020 2020 2020 2020  t(.             
+00009470: 2020 2020 2020 202a 2a76 616c 6964 6174         **validat
+00009480: 696f 6e5f 7265 706f 7274 2c20 696e 6765  ion_report, inge
+00009490: 7374 696f 6e5f 7265 7375 6c74 3d69 6e67  stion_result=ing
+000094a0: 6573 7469 6f6e 5f72 6573 756c 740a 2020  estion_result.  
+000094b0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+000094c0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+000094d0: 2069 7369 6e73 7461 6e63 6528 7661 6c69   isinstance(vali
+000094e0: 6461 7469 6f6e 5f72 6570 6f72 742c 2056  dation_report, V
+000094f0: 616c 6964 6174 696f 6e52 6570 6f72 7429  alidationReport)
+00009500: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00009510: 2020 7265 706f 7274 203d 2076 616c 6964    report = valid
+00009520: 6174 696f 6e5f 7265 706f 7274 0a20 2020  ation_report.   
+00009530: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00009540: 696e 6765 7374 696f 6e5f 7265 7375 6c74  ingestion_result
+00009550: 2021 3d20 2255 4e4b 4e4f 574e 223a 0a20   != "UNKNOWN":. 
+00009560: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009570: 2020 2072 6570 6f72 742e 696e 6765 7374     report.ingest
+00009580: 696f 6e5f 7265 7375 6c74 203d 2069 6e67  ion_result = ing
+00009590: 6573 7469 6f6e 5f72 6573 756c 740a 0a20  estion_result.. 
+000095a0: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+000095b0: 6e20 7365 6c66 2e5f 7661 6c69 6461 7469  n self._validati
+000095c0: 6f6e 5f72 6570 6f72 745f 656e 6769 6e65  on_report_engine
+000095d0: 2e73 6176 6528 0a20 2020 2020 2020 2020  .save(.         
+000095e0: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
+000095f0: 6e5f 7265 706f 7274 3d72 6570 6f72 742c  n_report=report,
+00009600: 2067 655f 7479 7065 3d67 655f 7479 7065   ge_type=ge_type
+00009610: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00009620: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
+00009630: 2020 2020 2020 2020 2072 6169 7365 2046           raise F
+00009640: 6561 7475 7265 5374 6f72 6545 7863 6570  eatureStoreExcep
+00009650: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+00009660: 2020 2020 2020 224f 6e6c 7920 4665 6174        "Only Feat
+00009670: 7572 6520 4772 6f75 7020 7265 6769 7374  ure Group regist
+00009680: 6572 6564 2077 6974 6820 486f 7073 776f  ered with Hopswo
+00009690: 726b 7320 6361 6e20 7570 6c6f 6164 2076  rks can upload v
+000096a0: 616c 6964 6174 696f 6e20 7265 706f 7274  alidation report
+000096b0: 732e 220a 2020 2020 2020 2020 2020 2020  s.".            
+000096c0: 290a 0a20 2020 2064 6566 2067 6574 5f76  )..    def get_v
+000096d0: 616c 6964 6174 696f 6e5f 6869 7374 6f72  alidation_histor
+000096e0: 7928 0a20 2020 2020 2020 2073 656c 662c  y(.        self,
+000096f0: 0a20 2020 2020 2020 2065 7870 6563 7461  .        expecta
+00009700: 7469 6f6e 5f69 643a 2069 6e74 2c0a 2020  tion_id: int,.  
+00009710: 2020 2020 2020 7374 6172 745f 7661 6c69        start_vali
+00009720: 6461 7469 6f6e 5f74 696d 653a 2055 6e69  dation_time: Uni
+00009730: 6f6e 5b73 7472 2c20 696e 742c 2064 6174  on[str, int, dat
+00009740: 6574 696d 652c 2064 6174 652c 204e 6f6e  etime, date, Non
+00009750: 655d 203d 204e 6f6e 652c 0a20 2020 2020  e] = None,.     
+00009760: 2020 2065 6e64 5f76 616c 6964 6174 696f     end_validatio
+00009770: 6e5f 7469 6d65 3a20 556e 696f 6e5b 7374  n_time: Union[st
+00009780: 722c 2069 6e74 2c20 6461 7465 7469 6d65  r, int, datetime
+00009790: 2c20 6461 7465 2c20 4e6f 6e65 5d20 3d20  , date, None] = 
+000097a0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6669  None,.        fi
+000097b0: 6c74 6572 5f62 793a 204c 6973 745b 7374  lter_by: List[st
+000097c0: 725d 203d 205b 5d2c 0a20 2020 2020 2020  r] = [],.       
+000097d0: 2067 655f 7479 7065 3a20 626f 6f6c 203d   ge_type: bool =
+000097e0: 2054 7275 652c 0a20 2020 2029 202d 3e20   True,.    ) -> 
+000097f0: 556e 696f 6e5b 4c69 7374 5b56 616c 6964  Union[List[Valid
+00009800: 6174 696f 6e52 6573 756c 745d 2c20 4c69  ationResult], Li
+00009810: 7374 5b67 652e 636f 7265 2e45 7870 6563  st[ge.core.Expec
+00009820: 7461 7469 6f6e 5661 6c69 6461 7469 6f6e  tationValidation
+00009830: 5265 7375 6c74 5d5d 3a0a 2020 2020 2020  Result]]:.      
+00009840: 2020 2222 2246 6574 6368 2076 616c 6964    """Fetch valid
+00009850: 6174 696f 6e20 6869 7374 6f72 7920 6f66  ation history of
+00009860: 2061 6e20 4578 7065 6374 6174 696f 6e20   an Expectation 
+00009870: 7370 6563 6966 6965 6420 6279 2069 7473  specified by its
+00009880: 2069 642e 0a0a 2020 2020 2020 2020 2121   id...        !!
+00009890: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+000098a0: 2020 6060 6070 7974 686f 6e33 0a20 2020    ```python3.   
+000098b0: 2020 2020 2076 616c 6964 6174 696f 6e5f       validation_
+000098c0: 6869 7374 6f72 7920 3d20 6667 2e67 6574  history = fg.get
+000098d0: 5f76 616c 6964 6174 696f 6e5f 6869 7374  _validation_hist
+000098e0: 6f72 7928 0a20 2020 2020 2020 2020 2020  ory(.           
+000098f0: 2065 7870 6563 7461 7469 6f6e 5f69 643d   expectation_id=
+00009900: 312c 0a20 2020 2020 2020 2020 2020 2066  1,.            f
+00009910: 696c 7465 725f 6279 3d5b 2252 454a 4543  ilter_by=["REJEC
+00009920: 5445 4422 2c20 2255 4e4b 4e4f 574e 225d  TED", "UNKNOWN"]
+00009930: 2c0a 2020 2020 2020 2020 2020 2020 7374  ,.            st
+00009940: 6172 745f 7661 6c69 6461 7469 6f6e 5f74  art_validation_t
+00009950: 696d 653d 2232 3032 322d 3031 2d30 3120  ime="2022-01-01 
+00009960: 3030 3a30 303a 3030 222c 0a20 2020 2020  00:00:00",.     
+00009970: 2020 2020 2020 2065 6e64 5f76 616c 6964         end_valid
+00009980: 6174 696f 6e5f 7469 6d65 3d64 6174 6574  ation_time=datet
+00009990: 696d 652e 6461 7465 7469 6d65 2e6e 6f77  ime.datetime.now
+000099a0: 2829 2c0a 2020 2020 2020 2020 2020 2020  (),.            
+000099b0: 6765 5f74 7970 653d 4661 6c73 650a 2020  ge_type=False.  
+000099c0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000099d0: 6060 600a 0a20 2020 2020 2020 2023 2041  ```..        # A
+000099e0: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+000099f0: 2020 2020 2065 7870 6563 7461 7469 6f6e       expectation
+00009a00: 5f69 643a 2069 6420 6f66 2074 6865 2045  _id: id of the E
+00009a10: 7870 6563 7461 7469 6f6e 2066 6f72 2077  xpectation for w
+00009a20: 6869 6368 2074 6f20 6665 7463 6820 7468  hich to fetch th
+00009a30: 6520 7661 6c69 6461 7469 6f6e 2068 6973  e validation his
+00009a40: 746f 7279 0a20 2020 2020 2020 2020 2020  tory.           
+00009a50: 2066 696c 7465 725f 6279 3a20 6c69 7374   filter_by: list
+00009a60: 206f 6620 696e 6765 7374 696f 6e5f 7265   of ingestion_re
+00009a70: 7375 6c74 2063 6174 6567 6f72 7920 746f  sult category to
+00009a80: 206b 6565 702e 204f 6f70 7469 6f6e 7320   keep. Ooptions 
+00009a90: 6172 6520 2249 4e47 4553 5445 4422 2c20  are "INGESTED", 
+00009aa0: 2252 454a 4543 5445 4422 2c20 2246 475f  "REJECTED", "FG_
+00009ab0: 4441 5441 222c 2022 4558 5045 5249 4d45  DATA", "EXPERIME
+00009ac0: 4e54 222c 2022 554e 4b4e 4f57 4e22 2e0a  NT", "UNKNOWN"..
+00009ad0: 2020 2020 2020 2020 2020 2020 7374 6172              star
+00009ae0: 745f 7661 6c69 6461 7469 6f6e 5f74 696d  t_validation_tim
+00009af0: 653a 2066 6574 6368 206f 6e6c 7920 7661  e: fetch only va
+00009b00: 6c69 6461 7469 6f6e 2072 6573 756c 7420  lidation result 
+00009b10: 706f 7374 6572 696f 7220 746f 2074 6865  posterior to the
+00009b20: 2070 726f 7669 6465 6420 7469 6d65 2c20   provided time, 
+00009b30: 696e 636c 7573 6976 652e 0a20 2020 2020  inclusive..     
+00009b40: 2020 2020 2020 2053 7570 706f 7274 6564         Supported
+00009b50: 2066 6f72 6d61 7420 696e 636c 7564 6520   format include 
+00009b60: 7469 6d65 7374 616d 7073 2869 6e74 292c  timestamps(int),
+00009b70: 2064 6174 6574 696d 652c 2064 6174 6520   datetime, date 
+00009b80: 6f72 2073 7472 696e 6720 666f 726d 6174  or string format
+00009b90: 7465 6420 746f 2062 6520 6461 7475 7469  ted to be datuti
+00009ba0: 6c73 2070 6172 7361 626c 652e 2053 6565  ls parsable. See
+00009bb0: 2065 7861 6d70 6c65 7320 6162 6f76 652e   examples above.
+00009bc0: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+00009bd0: 5f76 616c 6964 6174 696f 6e5f 7469 6d65  _validation_time
+00009be0: 3a20 6665 7463 6820 6f6e 6c79 2076 616c  : fetch only val
+00009bf0: 6964 6174 696f 6e20 7265 7375 6c74 2070  idation result p
+00009c00: 7269 6f72 2074 6f20 7468 6520 7072 6f76  rior to the prov
+00009c10: 6964 6564 2074 696d 652c 2069 6e63 6c75  ided time, inclu
+00009c20: 7369 7665 2e0a 2020 2020 2020 2020 2020  sive..          
+00009c30: 2020 5375 7070 6f72 7465 6420 666f 726d    Supported form
+00009c40: 6174 2069 6e63 6c75 6465 2074 696d 6573  at include times
+00009c50: 7461 6d70 7328 696e 7429 2c20 6461 7465  tamps(int), date
+00009c60: 7469 6d65 2c20 6461 7465 206f 7220 7374  time, date or st
+00009c70: 7269 6e67 2066 6f72 6d61 7474 6564 2074  ring formatted t
+00009c80: 6f20 6265 2064 6174 7574 696c 7320 7061  o be datutils pa
+00009c90: 7273 6162 6c65 2e20 5365 6520 6578 616d  rsable. See exam
+00009ca0: 706c 6573 2061 626f 7665 2e0a 0a20 2020  ples above...   
+00009cb0: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
+00009cc0: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
+00009cd0: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
+00009ce0: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
+00009cf0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
+00009d00: 726e 0a20 2020 2020 2020 2020 2020 2055  rn.            U
+00009d10: 6e69 6f6e 5b4c 6973 745b 6056 616c 6964  nion[List[`Valid
+00009d20: 6174 696f 6e52 6573 756c 7460 5d2c 204c  ationResult`], L
+00009d30: 6973 745b 6045 7870 6563 7461 7469 6f6e  ist[`Expectation
+00009d40: 5661 6c69 6461 7469 6f6e 5265 7375 6c74  ValidationResult
+00009d50: 605d 5d20 4120 6c69 7374 206f 6620 7661  `]] A list of va
+00009d60: 6c69 6461 7469 6f6e 2072 6573 756c 7420  lidation result 
+00009d70: 636f 6e6e 6563 7465 6420 746f 2074 6865  connected to the
+00009d80: 2065 7870 6563 7461 7469 6f6e 5f69 640a   expectation_id.
+00009d90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00009da0: 2020 2020 6d61 6a6f 722c 206d 696e 6f72      major, minor
+00009db0: 203d 2073 656c 662e 5f76 6172 6961 626c   = self._variabl
+00009dc0: 655f 6170 692e 7061 7273 655f 6d61 6a6f  e_api.parse_majo
+00009dd0: 725f 616e 645f 6d69 6e6f 7228 0a20 2020  r_and_minor(.   
+00009de0: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
+00009df0: 6172 6961 626c 655f 6170 692e 6765 745f  ariable_api.get_
+00009e00: 7665 7273 696f 6e28 2268 6f70 7377 6f72  version("hopswor
+00009e10: 6b73 2229 0a20 2020 2020 2020 2029 0a20  ks").        ). 
+00009e20: 2020 2020 2020 2069 6620 6d61 6a6f 7220         if major 
+00009e30: 3d3d 2022 3322 2061 6e64 206d 696e 6f72  == "3" and minor
+00009e40: 203d 3d20 2230 223a 0a20 2020 2020 2020   == "0":.       
+00009e50: 2020 2020 2072 6169 7365 2046 6561 7475       raise Featu
+00009e60: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
+00009e70: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00009e80: 2020 2254 6865 2068 6f70 7377 6f72 6b73    "The hopsworks
+00009e90: 2073 6572 7665 7220 646f 6573 206e 6f74   server does not
+00009ea0: 2073 7570 706f 7274 2074 6869 7320 6f70   support this op
+00009eb0: 6572 6174 696f 6e2e 2055 7064 6174 6520  eration. Update 
+00009ec0: 7365 7276 6572 2074 6f20 686f 7073 776f  server to hopswo
+00009ed0: 726b 7320 3e33 2e31 2074 6f20 656e 6162  rks >3.1 to enab
+00009ee0: 6c65 2073 7570 706f 7274 2e22 0a20 2020  le support.".   
+00009ef0: 2020 2020 2020 2020 2029 0a0a 2020 2020           )..    
+00009f00: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
+00009f10: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+00009f20: 7572 6e20 7365 6c66 2e5f 7661 6c69 6461  urn self._valida
+00009f30: 7469 6f6e 5f72 6573 756c 745f 656e 6769  tion_result_engi
+00009f40: 6e65 2e67 6574 5f76 616c 6964 6174 696f  ne.get_validatio
+00009f50: 6e5f 6869 7374 6f72 7928 0a20 2020 2020  n_history(.     
+00009f60: 2020 2020 2020 2020 2020 2065 7870 6563             expec
+00009f70: 7461 7469 6f6e 5f69 643d 6578 7065 6374  tation_id=expect
+00009f80: 6174 696f 6e5f 6964 2c0a 2020 2020 2020  ation_id,.      
+00009f90: 2020 2020 2020 2020 2020 7374 6172 745f            start_
+00009fa0: 7661 6c69 6461 7469 6f6e 5f74 696d 653d  validation_time=
+00009fb0: 7374 6172 745f 7661 6c69 6461 7469 6f6e  start_validation
+00009fc0: 5f74 696d 652c 0a20 2020 2020 2020 2020  _time,.         
+00009fd0: 2020 2020 2020 2065 6e64 5f76 616c 6964         end_valid
+00009fe0: 6174 696f 6e5f 7469 6d65 3d65 6e64 5f76  ation_time=end_v
+00009ff0: 616c 6964 6174 696f 6e5f 7469 6d65 2c0a  alidation_time,.
+0000a000: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a010: 6669 6c74 6572 5f62 793d 6669 6c74 6572  filter_by=filter
+0000a020: 5f62 792c 0a20 2020 2020 2020 2020 2020  _by,.           
+0000a030: 2020 2020 2067 655f 7479 7065 3d67 655f       ge_type=ge_
+0000a040: 7479 7065 2c0a 2020 2020 2020 2020 2020  type,.          
+0000a050: 2020 290a 2020 2020 2020 2020 656c 7365    ).        else
+0000a060: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000a070: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
+0000a080: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
+0000a090: 2020 2020 2020 2020 2020 2022 4f6e 6c79             "Only
+0000a0a0: 2046 6561 7475 7265 2047 726f 7570 2072   Feature Group r
+0000a0b0: 6567 6973 7465 7265 6420 7769 7468 2048  egistered with H
+0000a0c0: 6f70 7377 6f72 6b73 2063 616e 2066 6574  opsworks can fet
+0000a0d0: 6368 2076 616c 6964 6174 696f 6e20 6869  ch validation hi
+0000a0e0: 7374 6f72 792e 220a 2020 2020 2020 2020  story.".        
+0000a0f0: 2020 2020 290a 0a20 2020 2064 6566 2076      )..    def v
+0000a100: 616c 6964 6174 6528 0a20 2020 2020 2020  alidate(.       
+0000a110: 2073 656c 662c 0a20 2020 2020 2020 2064   self,.        d
+0000a120: 6174 6166 7261 6d65 3a20 4f70 7469 6f6e  ataframe: Option
+0000a130: 616c 5b0a 2020 2020 2020 2020 2020 2020  al[.            
+0000a140: 556e 696f 6e5b 7064 2e44 6174 6146 7261  Union[pd.DataFra
+0000a150: 6d65 2c20 5479 7065 5661 7228 2270 7973  me, TypeVar("pys
+0000a160: 7061 726b 2e73 716c 2e44 6174 6146 7261  park.sql.DataFra
+0000a170: 6d65 2229 5d20 2023 206e 6f71 613a 2046  me")]  # noqa: F
+0000a180: 3832 310a 2020 2020 2020 2020 5d20 3d20  821.        ] = 
+0000a190: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
+0000a1a0: 7065 6374 6174 696f 6e5f 7375 6974 653a  pectation_suite:
+0000a1b0: 204f 7074 696f 6e61 6c5b 4578 7065 6374   Optional[Expect
+0000a1c0: 6174 696f 6e53 7569 7465 5d20 3d20 4e6f  ationSuite] = No
+0000a1d0: 6e65 2c0a 2020 2020 2020 2020 7361 7665  ne,.        save
+0000a1e0: 5f72 6570 6f72 743a 204f 7074 696f 6e61  _report: Optiona
+0000a1f0: 6c5b 626f 6f6c 5d20 3d20 4661 6c73 652c  l[bool] = False,
+0000a200: 0a20 2020 2020 2020 2076 616c 6964 6174  .        validat
+0000a210: 696f 6e5f 6f70 7469 6f6e 733a 204f 7074  ion_options: Opt
+0000a220: 696f 6e61 6c5b 4469 6374 5b41 6e79 2c20  ional[Dict[Any, 
+0000a230: 416e 795d 5d20 3d20 7b7d 2c0a 2020 2020  Any]] = {},.    
+0000a240: 2020 2020 696e 6765 7374 696f 6e5f 7265      ingestion_re
+0000a250: 7375 6c74 3a20 7374 7220 3d20 2255 4e4b  sult: str = "UNK
+0000a260: 4e4f 574e 222c 0a20 2020 2020 2020 2067  NOWN",.        g
+0000a270: 655f 7479 7065 3a20 626f 6f6c 203d 2054  e_type: bool = T
+0000a280: 7275 652c 0a20 2020 2029 202d 3e20 556e  rue,.    ) -> Un
+0000a290: 696f 6e5b 6765 2e63 6f72 652e 4578 7065  ion[ge.core.Expe
+0000a2a0: 6374 6174 696f 6e53 7569 7465 5661 6c69  ctationSuiteVali
+0000a2b0: 6461 7469 6f6e 5265 7375 6c74 2c20 5661  dationResult, Va
+0000a2c0: 6c69 6461 7469 6f6e 5265 706f 7274 2c20  lidationReport, 
+0000a2d0: 4e6f 6e65 5d3a 0a20 2020 2020 2020 2022  None]:.        "
+0000a2e0: 2222 5275 6e20 7661 6c69 6461 7469 6f6e  ""Run validation
+0000a2f0: 2062 6173 6564 206f 6e20 7468 6520 6174   based on the at
+0000a300: 7461 6368 6564 2065 7870 6563 7461 7469  tached expectati
+0000a310: 6f6e 732e 0a0a 2020 2020 2020 2020 5275  ons...        Ru
+0000a320: 6e73 2061 6e79 2065 7870 6563 7461 7469  ns any expectati
+0000a330: 6f6e 2061 7474 6163 6865 6420 7769 7468  on attached with
+0000a340: 2044 6565 7175 2e20 4275 7420 616c 736f   Deequ. But also
+0000a350: 2072 756e 7320 6174 7461 6368 6564 2047   runs attached G
+0000a360: 7265 6174 2045 7870 6563 7461 7469 6f6e  reat Expectation
+0000a370: 0a20 2020 2020 2020 2053 7569 7465 732e  .        Suites.
+0000a380: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
+0000a390: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
+0000a3a0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+0000a3b0: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
+0000a3c0: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
+0000a3d0: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
+0000a3e0: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
+0000a3f0: 2020 2020 2020 2020 2023 2067 6574 2066           # get f
+0000a400: 6561 7475 7265 2067 726f 7570 2069 6e73  eature group ins
+0000a410: 7461 6e63 650a 2020 2020 2020 2020 2020  tance.          
+0000a420: 2020 6667 203d 2066 732e 6765 745f 6f72    fg = fs.get_or
+0000a430: 5f63 7265 6174 655f 6665 6174 7572 655f  _create_feature_
+0000a440: 6772 6f75 7028 2e2e 2e29 0a0a 2020 2020  group(...)..    
+0000a450: 2020 2020 2020 2020 6765 5f72 6570 6f72          ge_repor
+0000a460: 7420 3d20 6667 2e76 616c 6964 6174 6528  t = fg.validate(
+0000a470: 6466 2c20 7361 7665 5f72 6570 6f72 743d  df, save_report=
+0000a480: 4661 6c73 6529 0a20 2020 2020 2020 2020  False).         
+0000a490: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
+0000a4a0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
+0000a4b0: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
+0000a4c0: 653a 2054 6865 2064 6174 6166 7261 6d65  e: The dataframe
+0000a4d0: 2074 6f20 7275 6e20 7468 6520 6461 7461   to run the data
+0000a4e0: 2076 616c 6964 6174 696f 6e20 6578 7065   validation expe
+0000a4f0: 6374 6174 696f 6e73 2061 6761 696e 7374  ctations against
+0000a500: 2e0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
+0000a510: 7065 6374 6174 696f 6e5f 7375 6974 653a  pectation_suite:
+0000a520: 204f 7074 696f 6e61 6c6c 7920 7072 6f76   Optionally prov
+0000a530: 6964 6520 616e 2045 7870 6563 7461 7469  ide an Expectati
+0000a540: 6f6e 2053 7569 7465 2074 6f20 6f76 6572  on Suite to over
+0000a550: 7269 6465 2074 6865 0a20 2020 2020 2020  ride the.       
+0000a560: 2020 2020 2020 2020 206f 6e65 2074 6861           one tha
+0000a570: 7420 6973 2070 6f73 7369 626c 7920 6174  t is possibly at
+0000a580: 7461 6368 6564 2074 6f20 7468 6520 6665  tached to the fe
+0000a590: 6174 7572 6520 6772 6f75 702e 2054 6869  ature group. Thi
+0000a5a0: 7320 6973 2075 7365 6675 6c20 666f 720a  s is useful for.
+0000a5b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a5c0: 7465 7374 696e 6720 6e65 7720 4578 7065  testing new Expe
+0000a5d0: 6374 6174 696f 6e20 7375 6974 6573 2e20  ctation suites. 
+0000a5e0: 5768 656e 2061 6e20 6578 7472 6120 7375  When an extra su
+0000a5f0: 6974 6520 6973 2070 726f 7669 6465 642c  ite is provided,
+0000a600: 2074 6865 2072 6573 756c 7473 0a20 2020   the results.   
+0000a610: 2020 2020 2020 2020 2020 2020 2077 696c               wil
+0000a620: 6c20 6e65 7665 7220 6265 2070 6572 7369  l never be persi
+0000a630: 7374 6564 2e20 4465 6661 756c 7473 2074  sted. Defaults t
+0000a640: 6f20 604e 6f6e 6560 2e0a 2020 2020 2020  o `None`..      
+0000a650: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
+0000a660: 5f6f 7074 696f 6e73 3a20 4164 6469 7469  _options: Additi
+0000a670: 6f6e 616c 2076 616c 6964 6174 696f 6e20  onal validation 
+0000a680: 6f70 7469 6f6e 7320 6173 206b 6579 2d76  options as key-v
+0000a690: 616c 7565 2070 6169 7273 2c20 6465 6661  alue pairs, defa
+0000a6a0: 756c 7473 2074 6f20 607b 7d60 2e0a 2020  ults to `{}`..  
+0000a6b0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
+0000a6c0: 6b65 7920 6072 756e 5f76 616c 6964 6174  key `run_validat
+0000a6d0: 696f 6e60 2062 6f6f 6c65 616e 2076 616c  ion` boolean val
+0000a6e0: 7565 2c20 7365 7420 746f 2060 4661 6c73  ue, set to `Fals
+0000a6f0: 6560 2074 6f20 736b 6970 2076 616c 6964  e` to skip valid
+0000a700: 6174 696f 6e20 7465 6d70 6f72 6172 696c  ation temporaril
+0000a710: 7920 6f6e 2069 6e67 6573 7469 6f6e 2e0a  y on ingestion..
+0000a720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a730: 2a20 6b65 7920 6067 655f 7661 6c69 6461  * key `ge_valida
+0000a740: 7465 5f6b 7761 7267 7360 2061 2064 6963  te_kwargs` a dic
+0000a750: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
+0000a760: 6e67 206b 7761 7267 7320 666f 7220 7468  ng kwargs for th
+0000a770: 6520 7661 6c69 6461 7465 206d 6574 686f  e validate metho
+0000a780: 6420 6f66 2047 7265 6174 2045 7870 6563  d of Great Expec
+0000a790: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
+0000a7a0: 2020 2020 2069 6e67 6573 7469 6f6e 5f72       ingestion_r
+0000a7b0: 6573 756c 743a 2053 7065 6369 6679 2074  esult: Specify t
+0000a7c0: 6865 2066 6174 6520 6f66 2074 6865 2061  he fate of the a
+0000a7d0: 7373 6f63 6961 7465 6420 6461 7461 2c20  ssociated data, 
+0000a7e0: 6465 6661 756c 7473 0a20 2020 2020 2020  defaults.       
+0000a7f0: 2020 2020 2020 2020 2074 6f20 2255 4e4b           to "UNK
+0000a800: 4e4f 574e 222e 2053 7570 706f 7274 6564  NOWN". Supported
+0000a810: 206f 7074 696f 6e73 2061 7265 2020 2255   options are  "U
+0000a820: 4e4b 4e4f 574e 222c 2022 494e 4745 5354  NKNOWN", "INGEST
+0000a830: 4544 222c 2022 5245 4a45 4354 4544 222c  ED", "REJECTED",
+0000a840: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000a850: 2022 4558 5045 5249 4d45 4e54 222c 2022   "EXPERIMENT", "
+0000a860: 4647 5f44 4154 4122 2e20 5573 6520 2249  FG_DATA". Use "I
+0000a870: 4e47 4553 5445 4422 206f 7220 2252 454a  NGESTED" or "REJ
+0000a880: 4543 5445 4422 2066 6f72 2076 616c 6964  ECTED" for valid
+0000a890: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+0000a8a0: 2020 2020 2020 6f66 2044 6174 6146 7261        of DataFra
+0000a8b0: 6d65 7320 746f 2062 6520 696e 7365 7274  mes to be insert
+0000a8c0: 6564 2069 6e20 7468 6520 4665 6174 7572  ed in the Featur
+0000a8d0: 6520 4772 6f75 702e 2055 7365 2022 4558  e Group. Use "EX
+0000a8e0: 5045 5249 4d45 4e54 220a 2020 2020 2020  PERIMENT".      
+0000a8f0: 2020 2020 2020 2020 2020 666f 7220 7465            for te
+0000a900: 7374 696e 6720 616e 6420 6465 7665 6c6f  sting and develo
+0000a910: 706d 656e 7420 616e 6420 2246 475f 4441  pment and "FG_DA
+0000a920: 5441 2220 7768 656e 2076 616c 6964 6174  TA" when validat
+0000a930: 696e 6720 6461 7461 0a20 2020 2020 2020  ing data.       
+0000a940: 2020 2020 2020 2020 2061 6c72 6561 6479           already
+0000a950: 2069 6e20 7468 6520 4665 6174 7572 6520   in the Feature 
+0000a960: 4772 6f75 702e 0a20 2020 2020 2020 2020  Group..         
+0000a970: 2020 2073 6176 655f 7265 706f 7274 3a20     save_report: 
+0000a980: 5768 6574 6865 7220 746f 2073 6176 6520  Whether to save 
+0000a990: 7468 6520 7265 706f 7274 2074 6f20 7468  the report to th
+0000a9a0: 6520 6261 636b 656e 642e 2054 6869 7320  e backend. This 
+0000a9b0: 6973 206f 6e6c 7920 706f 7373 6962 6c65  is only possible
+0000a9c0: 2069 6620 7468 6520 4578 7065 6374 6174   if the Expectat
+0000a9d0: 696f 6e20 7375 6974 650a 2020 2020 2020  ion suite.      
+0000a9e0: 2020 2020 2020 2020 2020 6973 2069 6e69            is ini
+0000a9f0: 7469 616c 6973 6564 2061 6e64 2061 7474  tialised and att
+0000aa00: 6163 6865 6420 746f 2074 6865 2046 6561  ached to the Fea
+0000aa10: 7475 7265 2047 726f 7570 2e20 4465 6661  ture Group. Defa
+0000aa20: 756c 7473 2074 6f20 4661 6c73 652e 0a20  ults to False.. 
+0000aa30: 2020 2020 2020 2020 2020 2067 655f 7479             ge_ty
+0000aa40: 7065 3a20 5768 6574 6865 7220 746f 2072  pe: Whether to r
+0000aa50: 6574 7572 6e20 6120 4772 6561 7420 4578  eturn a Great Ex
+0000aa60: 7065 6374 6174 696f 6e73 206f 626a 6563  pectations objec
+0000aa70: 7420 6f72 2048 6f70 7377 6f72 6b73 206f  t or Hopsworks o
+0000aa80: 776e 2061 6273 7472 6163 7469 6f6e 2e20  wn abstraction. 
+0000aa90: 4465 6661 756c 7473 2074 6f20 5472 7565  Defaults to True
+0000aaa0: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
+0000aab0: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
+0000aac0: 2041 2056 616c 6964 6174 696f 6e20 5265   A Validation Re
+0000aad0: 706f 7274 2070 726f 6475 6365 6420 6279  port produced by
+0000aae0: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
+0000aaf0: 6f6e 732e 0a20 2020 2020 2020 2022 2222  ons..        """
+0000ab00: 0a20 2020 2020 2020 2023 2041 6374 6976  .        # Activ
+0000ab10: 6974 7920 6973 206c 6f67 6765 6420 6f6e  ity is logged on
+0000ab20: 6c79 2069 6620 6120 7468 6520 7661 6c69  ly if a the vali
+0000ab30: 6461 7469 6f6e 2063 6f6e 6365 726e 7320  dation concerns 
+0000ab40: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+0000ab50: 7020 616e 6420 6e6f 7420 6120 7370 6563  p and not a spec
+0000ab60: 6966 6963 2064 6174 6166 7261 6d65 0a20  ific dataframe. 
+0000ab70: 2020 2020 2020 2069 6620 6461 7461 6672         if datafr
+0000ab80: 616d 6520 6973 204e 6f6e 653a 0a20 2020  ame is None:.   
+0000ab90: 2020 2020 2020 2020 2064 6174 6166 7261           datafra
+0000aba0: 6d65 203d 2073 656c 662e 7265 6164 2829  me = self.read()
+0000abb0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+0000abc0: 696e 6765 7374 696f 6e5f 7265 7375 6c74  ingestion_result
+0000abd0: 203d 3d20 2255 4e4b 4e4f 574e 223a 0a20   == "UNKNOWN":. 
+0000abe0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+0000abf0: 6e67 6573 7469 6f6e 5f72 6573 756c 7420  ngestion_result 
+0000ac00: 3d20 2246 475f 4441 5441 220a 0a20 2020  = "FG_DATA"..   
+0000ac10: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000ac20: 2e5f 6772 6561 745f 6578 7065 6374 6174  ._great_expectat
+0000ac30: 696f 6e5f 656e 6769 6e65 2e76 616c 6964  ion_engine.valid
+0000ac40: 6174 6528 0a20 2020 2020 2020 2020 2020  ate(.           
+0000ac50: 2073 656c 662c 0a20 2020 2020 2020 2020   self,.         
+0000ac60: 2020 2064 6174 6166 7261 6d65 3d65 6e67     dataframe=eng
+0000ac70: 696e 652e 6765 745f 696e 7374 616e 6365  ine.get_instance
+0000ac80: 2829 2e63 6f6e 7665 7274 5f74 6f5f 6465  ().convert_to_de
+0000ac90: 6661 756c 745f 6461 7461 6672 616d 6528  fault_dataframe(
+0000aca0: 6461 7461 6672 616d 6529 2c0a 2020 2020  dataframe),.    
+0000acb0: 2020 2020 2020 2020 6578 7065 6374 6174          expectat
+0000acc0: 696f 6e5f 7375 6974 653d 6578 7065 6374  ion_suite=expect
+0000acd0: 6174 696f 6e5f 7375 6974 652c 0a20 2020  ation_suite,.   
+0000ace0: 2020 2020 2020 2020 2073 6176 655f 7265           save_re
+0000acf0: 706f 7274 3d73 6176 655f 7265 706f 7274  port=save_report
+0000ad00: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
+0000ad10: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
+0000ad20: 3d76 616c 6964 6174 696f 6e5f 6f70 7469  =validation_opti
+0000ad30: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
+0000ad40: 2069 6e67 6573 7469 6f6e 5f72 6573 756c   ingestion_resul
+0000ad50: 743d 696e 6765 7374 696f 6e5f 7265 7375  t=ingestion_resu
+0000ad60: 6c74 2c0a 2020 2020 2020 2020 2020 2020  lt,.            
+0000ad70: 6765 5f74 7970 653d 6765 5f74 7970 652c  ge_type=ge_type,
+0000ad80: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+0000ad90: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
+0000ada0: 2064 6566 2066 726f 6d5f 7265 7370 6f6e   def from_respon
+0000adb0: 7365 5f6a 736f 6e28 636c 732c 2066 6561  se_json(cls, fea
+0000adc0: 7475 7265 5f67 726f 7570 5f6a 736f 6e29  ture_group_json)
+0000add0: 3a0a 2020 2020 2020 2020 6966 2028 0a20  :.        if (. 
+0000ade0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+0000adf0: 7265 5f67 726f 7570 5f6a 736f 6e5b 2274  re_group_json["t
+0000ae00: 7970 6522 5d20 3d3d 2022 6f6e 4465 6d61  ype"] == "onDema
+0000ae10: 6e64 4665 6174 7572 6567 726f 7570 4454  ndFeaturegroupDT
+0000ae20: 4f22 0a20 2020 2020 2020 2020 2020 2061  O".            a
+0000ae30: 6e64 206e 6f74 2066 6561 7475 7265 5f67  nd not feature_g
+0000ae40: 726f 7570 5f6a 736f 6e5b 2273 7069 6e65  roup_json["spine
+0000ae50: 225d 0a20 2020 2020 2020 2029 3a0a 2020  "].        ):.  
+0000ae60: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+0000ae70: 655f 6772 6f75 705f 6f62 6a20 3d20 4578  e_group_obj = Ex
+0000ae80: 7465 726e 616c 4665 6174 7572 6547 726f  ternalFeatureGro
+0000ae90: 7570 2e66 726f 6d5f 7265 7370 6f6e 7365  up.from_response
+0000aea0: 5f6a 736f 6e28 0a20 2020 2020 2020 2020  _json(.         
+0000aeb0: 2020 2020 2020 2066 6561 7475 7265 5f67         feature_g
+0000aec0: 726f 7570 5f6a 736f 6e0a 2020 2020 2020  roup_json.      
+0000aed0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000aee0: 656c 6966 2028 0a20 2020 2020 2020 2020  elif (.         
+0000aef0: 2020 2066 6561 7475 7265 5f67 726f 7570     feature_group
+0000af00: 5f6a 736f 6e5b 2274 7970 6522 5d20 3d3d  _json["type"] ==
+0000af10: 2022 6f6e 4465 6d61 6e64 4665 6174 7572   "onDemandFeatur
+0000af20: 6567 726f 7570 4454 4f22 0a20 2020 2020  egroupDTO".     
+0000af30: 2020 2020 2020 2061 6e64 2066 6561 7475         and featu
+0000af40: 7265 5f67 726f 7570 5f6a 736f 6e5b 2273  re_group_json["s
+0000af50: 7069 6e65 225d 0a20 2020 2020 2020 2029  pine"].        )
+0000af60: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
+0000af70: 6174 7572 655f 6772 6f75 705f 6f62 6a20  ature_group_obj 
+0000af80: 3d20 5370 696e 6547 726f 7570 2e66 726f  = SpineGroup.fro
+0000af90: 6d5f 7265 7370 6f6e 7365 5f6a 736f 6e28  m_response_json(
+0000afa0: 6665 6174 7572 655f 6772 6f75 705f 6a73  feature_group_js
+0000afb0: 6f6e 290a 2020 2020 2020 2020 656c 7365  on).        else
+0000afc0: 3a0a 2020 2020 2020 2020 2020 2020 6665  :.            fe
+0000afd0: 6174 7572 655f 6772 6f75 705f 6f62 6a20  ature_group_obj 
+0000afe0: 3d20 4665 6174 7572 6547 726f 7570 2e66  = FeatureGroup.f
+0000aff0: 726f 6d5f 7265 7370 6f6e 7365 5f6a 736f  rom_response_jso
+0000b000: 6e28 6665 6174 7572 655f 6772 6f75 705f  n(feature_group_
+0000b010: 6a73 6f6e 290a 2020 2020 2020 2020 7265  json).        re
+0000b020: 7475 726e 2066 6561 7475 7265 5f67 726f  turn feature_gro
+0000b030: 7570 5f6f 626a 0a0a 2020 2020 6465 6620  up_obj..    def 
+0000b040: 6765 745f 6665 6174 7572 655f 6d6f 6e69  get_feature_moni
+0000b050: 746f 7269 6e67 5f63 6f6e 6669 6773 280a  toring_configs(.
+0000b060: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000b070: 2020 2020 2020 6e61 6d65 3a20 4f70 7469        name: Opti
+0000b080: 6f6e 616c 5b73 7472 5d20 3d20 4e6f 6e65  onal[str] = None
+0000b090: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
+0000b0a0: 655f 6e61 6d65 3a20 4f70 7469 6f6e 616c  e_name: Optional
+0000b0b0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0000b0c0: 2020 2020 2020 636f 6e66 6967 5f69 643a        config_id:
+0000b0d0: 204f 7074 696f 6e61 6c5b 696e 745d 203d   Optional[int] =
+0000b0e0: 204e 6f6e 652c 0a20 2020 2029 202d 3e20   None,.    ) -> 
+0000b0f0: 556e 696f 6e5b 0a20 2020 2020 2020 2022  Union[.        "
+0000b100: 666d 632e 4665 6174 7572 654d 6f6e 6974  fmc.FeatureMonit
+0000b110: 6f72 696e 6743 6f6e 6669 6722 2c20 4c69  oringConfig", Li
+0000b120: 7374 5b22 666d 632e 4665 6174 7572 654d  st["fmc.FeatureM
+0000b130: 6f6e 6974 6f72 696e 6743 6f6e 6669 6722  onitoringConfig"
+0000b140: 5d2c 204e 6f6e 650a 2020 2020 5d3a 0a20  ], None.    ]:. 
+0000b150: 2020 2020 2020 2022 2222 4665 7463 6820         """Fetch 
+0000b160: 616c 6c20 6665 6174 7572 6520 6d6f 6e69  all feature moni
+0000b170: 746f 7269 6e67 2063 6f6e 6669 6773 2061  toring configs a
+0000b180: 7474 6163 6865 6420 746f 2074 6865 2066  ttached to the f
+0000b190: 6561 7475 7265 2067 726f 7570 2c20 6f72  eature group, or
+0000b1a0: 2066 6574 6368 2062 7920 6e61 6d65 206f   fetch by name o
+0000b1b0: 7220 6665 6174 7572 6520 6e61 6d65 206f  r feature name o
+0000b1c0: 6e6c 792e 0a20 2020 2020 2020 2049 6620  nly..        If 
+0000b1d0: 6e6f 2061 7267 756d 656e 7473 2069 7320  no arguments is 
+0000b1e0: 7072 6f76 6964 6564 2074 6865 206d 6574  provided the met
+0000b1f0: 686f 6420 7769 6c6c 2072 6574 7572 6e20  hod will return 
+0000b200: 616c 6c20 6665 6174 7572 6520 6d6f 6e69  all feature moni
+0000b210: 746f 7269 6e67 2063 6f6e 6669 6773 0a20  toring configs. 
+0000b220: 2020 2020 2020 2061 7474 6163 6865 6420         attached 
+0000b230: 746f 2074 6865 2066 6561 7475 7265 2067  to the feature g
+0000b240: 726f 7570 2c20 6d65 616e 696e 6720 616c  roup, meaning al
+0000b250: 6c20 6665 6174 7572 6520 6d6f 6e69 746f  l feature monito
+0000b260: 7269 6e67 2063 6f6e 6669 6773 2074 6861  ring configs tha
+0000b270: 7420 6172 6520 6174 7461 6368 0a20 2020  t are attach.   
+0000b280: 2020 2020 2074 6f20 6120 6665 6174 7572       to a featur
+0000b290: 6520 696e 2074 6865 2066 6561 7475 7265  e in the feature
+0000b2a0: 2067 726f 7570 2e20 4966 2079 6f75 2077   group. If you w
+0000b2b0: 6973 6820 746f 2066 6574 6368 2061 2073  ish to fetch a s
+0000b2c0: 696e 676c 6520 636f 6e66 6967 2c20 7072  ingle config, pr
+0000b2d0: 6f76 6964 6520 7468 650a 2020 2020 2020  ovide the.      
+0000b2e0: 2020 6974 7320 6e61 6d65 2e20 4966 2079    its name. If y
+0000b2f0: 6f75 2077 6973 6820 746f 2066 6574 6368  ou wish to fetch
+0000b300: 2061 6c6c 2063 6f6e 6669 6773 2061 7474   all configs att
+0000b310: 6163 6865 6420 746f 2061 2070 6172 7469  ached to a parti
+0000b320: 6375 6c61 7220 6665 6174 7572 652c 2070  cular feature, p
+0000b330: 726f 7669 6465 0a20 2020 2020 2020 2074  rovide.        t
+0000b340: 6865 2066 6561 7475 7265 206e 616d 652e  he feature name.
+0000b350: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+0000b360: 6d70 6c65 0a20 2020 2020 2020 2020 2020  mple.           
+0000b370: 2060 6060 7079 7468 6f6e 330a 2020 2020   ```python3.    
+0000b380: 2020 2020 2020 2020 2320 6665 7463 6820          # fetch 
+0000b390: 796f 7572 2066 6561 7475 7265 2067 726f  your feature gro
+0000b3a0: 7570 0a20 2020 2020 2020 2020 2020 2066  up.            f
+0000b3b0: 6720 3d20 6673 2e67 6574 5f66 6561 7475  g = fs.get_featu
+0000b3c0: 7265 5f67 726f 7570 286e 616d 653d 226d  re_group(name="m
+0000b3d0: 795f 6665 6174 7572 655f 6772 6f75 7022  y_feature_group"
+0000b3e0: 2c20 7665 7273 696f 6e3d 3129 0a20 2020  , version=1).   
+0000b3f0: 2020 2020 2020 2020 2023 2066 6574 6368           # fetch
+0000b400: 2061 6c6c 2066 6561 7475 7265 206d 6f6e   all feature mon
+0000b410: 6974 6f72 696e 6720 636f 6e66 6967 7320  itoring configs 
+0000b420: 6174 7461 6368 6564 2074 6f20 7468 6520  attached to the 
+0000b430: 6665 6174 7572 6520 6772 6f75 700a 2020  feature group.  
+0000b440: 2020 2020 2020 2020 2020 666d 5f63 6f6e            fm_con
+0000b450: 6669 6773 203d 2066 672e 6765 745f 6665  figs = fg.get_fe
+0000b460: 6174 7572 655f 6d6f 6e69 746f 7269 6e67  ature_monitoring
+0000b470: 5f63 6f6e 6669 6773 2829 0a20 2020 2020  _configs().     
+0000b480: 2020 2020 2020 2023 2066 6574 6368 2061         # fetch a
+0000b490: 2073 696e 676c 6520 6665 6174 7572 6520   single feature 
+0000b4a0: 6d6f 6e69 746f 7269 6e67 2063 6f6e 6669  monitoring confi
+0000b4b0: 6720 6279 206e 616d 650a 2020 2020 2020  g by name.      
+0000b4c0: 2020 2020 2020 666d 5f63 6f6e 6669 6720        fm_config 
+0000b4d0: 3d20 6667 2e67 6574 5f66 6561 7475 7265  = fg.get_feature
+0000b4e0: 5f6d 6f6e 6974 6f72 696e 675f 636f 6e66  _monitoring_conf
+0000b4f0: 6967 7328 6e61 6d65 3d22 6d79 5f63 6f6e  igs(name="my_con
+0000b500: 6669 6722 290a 2020 2020 2020 2020 2020  fig").          
+0000b510: 2020 2320 6665 7463 6820 616c 6c20 6665    # fetch all fe
+0000b520: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
+0000b530: 2063 6f6e 6669 6773 2061 7474 6163 6865   configs attache
+0000b540: 6420 746f 2061 2070 6172 7469 6375 6c61  d to a particula
+0000b550: 7220 6665 6174 7572 650a 2020 2020 2020  r feature.      
+0000b560: 2020 2020 2020 666d 5f63 6f6e 6669 6773        fm_configs
+0000b570: 203d 2066 672e 6765 745f 6665 6174 7572   = fg.get_featur
+0000b580: 655f 6d6f 6e69 746f 7269 6e67 5f63 6f6e  e_monitoring_con
+0000b590: 6669 6773 2866 6561 7475 7265 5f6e 616d  figs(feature_nam
+0000b5a0: 653d 226d 795f 6665 6174 7572 6522 290a  e="my_feature").
+0000b5b0: 2020 2020 2020 2020 2020 2020 2320 6665              # fe
+0000b5c0: 7463 6820 6120 7369 6e67 6c65 2066 6561  tch a single fea
+0000b5d0: 7475 7265 206d 6f6e 6974 6f72 696e 6720  ture monitoring 
+0000b5e0: 636f 6e66 6967 2077 6974 6820 6120 6769  config with a gi
+0000b5f0: 7665 6e20 6964 0a20 2020 2020 2020 2020  ven id.         
+0000b600: 2020 2066 6d5f 636f 6e66 6967 203d 2066     fm_config = f
+0000b610: 672e 6765 745f 6665 6174 7572 655f 6d6f  g.get_feature_mo
+0000b620: 6e69 746f 7269 6e67 5f63 6f6e 6669 6773  nitoring_configs
+0000b630: 2863 6f6e 6669 675f 6964 3d31 290a 2020  (config_id=1).  
+0000b640: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+0000b650: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+0000b660: 730a 2020 2020 2020 2020 2020 2020 6e61  s.            na
+0000b670: 6d65 3a20 4966 2070 726f 7669 6465 6420  me: If provided 
+0000b680: 6665 7463 6820 6f6e 6c79 2074 6865 2066  fetch only the f
+0000b690: 6561 7475 7265 206d 6f6e 6974 6f72 696e  eature monitorin
+0000b6a0: 6720 636f 6e66 6967 2077 6974 6820 7468  g config with th
+0000b6b0: 6520 6769 7665 6e20 6e61 6d65 2e0a 2020  e given name..  
+0000b6c0: 2020 2020 2020 2020 2020 2020 2020 4465                De
+0000b6d0: 6661 756c 7473 2074 6f20 4e6f 6e65 2e0a  faults to None..
+0000b6e0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+0000b6f0: 7572 655f 6e61 6d65 3a20 4966 2070 726f  ure_name: If pro
+0000b700: 7669 6465 642c 2066 6574 6368 206f 6e6c  vided, fetch onl
+0000b710: 7920 636f 6e66 6967 7320 6174 7461 6368  y configs attach
+0000b720: 6564 2074 6f20 6120 7061 7274 6963 756c  ed to a particul
+0000b730: 6172 2066 6561 7475 7265 2e0a 2020 2020  ar feature..    
+0000b740: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+0000b750: 756c 7473 2074 6f20 4e6f 6e65 2e0a 2020  ults to None..  
+0000b760: 2020 2020 2020 2020 2020 636f 6e66 6967            config
+0000b770: 5f69 643a 2049 6620 7072 6f76 6964 6564  _id: If provided
+0000b780: 2c20 6665 7463 6820 6f6e 6c79 2074 6865  , fetch only the
+0000b790: 2066 6561 7475 7265 206d 6f6e 6974 6f72   feature monitor
+0000b7a0: 696e 6720 636f 6e66 6967 2077 6974 6820  ing config with 
+0000b7b0: 7468 6520 6769 7665 6e20 6964 2e0a 2020  the given id..  
+0000b7c0: 2020 2020 2020 2020 2020 2020 2020 4465                De
+0000b7d0: 6661 756c 7473 2074 6f20 4e6f 6e65 2e0a  faults to None..
+0000b7e0: 2020 2020 2020 2020 2320 5261 6973 6573          # Raises
+0000b7f0: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
+0000b800: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
+0000b810: 696f 6e73 2e52 6573 7441 5049 4572 726f  ions.RestAPIErro
+0000b820: 7260 2e0a 2020 2020 2020 2020 2020 2020  r`..            
+0000b830: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
+0000b840: 6570 7469 6f6e 732e 4665 6174 7572 6553  eptions.FeatureS
+0000b850: 746f 7265 4578 6365 7074 696f 6e60 2e0a  toreException`..
+0000b860: 2020 2020 2020 2020 2020 2020 5661 6c75              Valu
+0000b870: 6545 7272 6f72 3a20 6966 2062 6f74 6820  eError: if both 
+0000b880: 6e61 6d65 2061 6e64 2066 6561 7475 7265  name and feature
+0000b890: 5f6e 616d 6520 6172 6520 7072 6f76 6964  _name are provid
+0000b8a0: 6564 2e0a 2020 2020 2020 2020 2020 2020  ed..            
+0000b8b0: 5479 7065 4572 726f 723a 2069 6620 6e61  TypeError: if na
+0000b8c0: 6d65 206f 7220 6665 6174 7572 655f 6e61  me or feature_na
+0000b8d0: 6d65 2061 7265 206e 6f74 2073 7472 696e  me are not strin
+0000b8e0: 6720 6f72 204e 6f6e 652e 0a20 2020 2020  g or None..     
+0000b8f0: 2020 2023 2052 6574 7572 6e0a 2020 2020     # Return.    
+0000b900: 2020 2020 2020 2020 556e 696f 6e5b 6046          Union[`F
+0000b910: 6561 7475 7265 4d6f 6e69 746f 7269 6e67  eatureMonitoring
+0000b920: 436f 6e66 6967 602c 204c 6973 745b 6046  Config`, List[`F
+0000b930: 6561 7475 7265 4d6f 6e69 746f 7269 6e67  eatureMonitoring
+0000b940: 436f 6e66 6967 605d 2c20 4e6f 6e65 5d0a  Config`], None].
+0000b950: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000b960: 4120 6c69 7374 206f 6620 6665 6174 7572  A list of featur
+0000b970: 6520 6d6f 6e69 746f 7269 6e67 2063 6f6e  e monitoring con
+0000b980: 6669 6773 2e20 4966 206e 616d 6520 7072  figs. If name pr
+0000b990: 6f76 6964 6564 2c0a 2020 2020 2020 2020  ovided,.        
+0000b9a0: 2020 2020 2020 2020 7265 7475 726e 7320          returns 
+0000b9b0: 6569 7468 6572 2061 2073 696e 676c 6520  either a single 
+0000b9c0: 636f 6e66 6967 206f 7220 4e6f 6e65 2069  config or None i
+0000b9d0: 6620 6e6f 7420 666f 756e 642e 0a20 2020  f not found..   
+0000b9e0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000b9f0: 2069 6620 6e6f 7420 7365 6c66 2e5f 6964   if not self._id
+0000ba00: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000ba10: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
+0000ba20: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
+0000ba30: 2020 2020 2020 2020 2020 2022 4f6e 6c79             "Only
+0000ba40: 2046 6561 7475 7265 2047 726f 7570 2072   Feature Group r
+0000ba50: 6567 6973 7465 7265 6420 7769 7468 2048  egistered with H
+0000ba60: 6f70 7377 6f72 6b73 2063 616e 2066 6574  opsworks can fet
+0000ba70: 6368 2066 6561 7475 7265 206d 6f6e 6974  ch feature monit
+0000ba80: 6f72 696e 6720 636f 6e66 6967 7572 6174  oring configurat
+0000ba90: 696f 6e73 2e22 0a20 2020 2020 2020 2020  ions.".         
+0000baa0: 2020 2029 0a0a 2020 2020 2020 2020 7265     )..        re
+0000bab0: 7475 726e 2073 656c 662e 5f66 6561 7475  turn self._featu
+0000bac0: 7265 5f6d 6f6e 6974 6f72 696e 675f 636f  re_monitoring_co
+0000bad0: 6e66 6967 5f65 6e67 696e 652e 6765 745f  nfig_engine.get_
+0000bae0: 6665 6174 7572 655f 6d6f 6e69 746f 7269  feature_monitori
+0000baf0: 6e67 5f63 6f6e 6669 6773 280a 2020 2020  ng_configs(.    
+0000bb00: 2020 2020 2020 2020 6e61 6d65 3d6e 616d          name=nam
+0000bb10: 652c 0a20 2020 2020 2020 2020 2020 2066  e,.            f
+0000bb20: 6561 7475 7265 5f6e 616d 653d 6665 6174  eature_name=feat
+0000bb30: 7572 655f 6e61 6d65 2c0a 2020 2020 2020  ure_name,.      
+0000bb40: 2020 2020 2020 636f 6e66 6967 5f69 643d        config_id=
+0000bb50: 636f 6e66 6967 5f69 642c 0a20 2020 2020  config_id,.     
+0000bb60: 2020 2029 0a0a 2020 2020 6465 6620 6765     )..    def ge
+0000bb70: 745f 6665 6174 7572 655f 6d6f 6e69 746f  t_feature_monito
+0000bb80: 7269 6e67 5f68 6973 746f 7279 280a 2020  ring_history(.  
+0000bb90: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+0000bba0: 2020 2020 636f 6e66 6967 5f6e 616d 653a      config_name:
+0000bbb0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0000bbc0: 204e 6f6e 652c 0a20 2020 2020 2020 2063   None,.        c
+0000bbd0: 6f6e 6669 675f 6964 3a20 4f70 7469 6f6e  onfig_id: Option
+0000bbe0: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+0000bbf0: 2020 2020 2020 2020 7374 6172 745f 7469          start_ti
+0000bc00: 6d65 3a20 4f70 7469 6f6e 616c 5b55 6e69  me: Optional[Uni
+0000bc10: 6f6e 5b69 6e74 2c20 7374 722c 2064 6174  on[int, str, dat
+0000bc20: 6574 696d 652c 2064 6174 655d 5d20 3d20  etime, date]] = 
+0000bc30: 4e6f 6e65 2c0a 2020 2020 2020 2020 656e  None,.        en
+0000bc40: 645f 7469 6d65 3a20 4f70 7469 6f6e 616c  d_time: Optional
+0000bc50: 5b55 6e69 6f6e 5b69 6e74 2c20 7374 722c  [Union[int, str,
+0000bc60: 2064 6174 6574 696d 652c 2064 6174 655d   datetime, date]
+0000bc70: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0000bc80: 2020 7769 7468 5f73 7461 7469 7374 6963    with_statistic
+0000bc90: 733a 204f 7074 696f 6e61 6c5b 626f 6f6c  s: Optional[bool
+0000bca0: 5d20 3d20 5472 7565 2c0a 2020 2020 2920  ] = True,.    ) 
+0000bcb0: 2d3e 204c 6973 745b 2266 6d72 2e46 6561  -> List["fmr.Fea
+0000bcc0: 7475 7265 4d6f 6e69 746f 7269 6e67 5265  tureMonitoringRe
+0000bcd0: 7375 6c74 225d 3a0a 2020 2020 2020 2020  sult"]:.        
+0000bce0: 2222 2246 6574 6368 2066 6561 7475 7265  """Fetch feature
+0000bcf0: 206d 6f6e 6974 6f72 696e 6720 6869 7374   monitoring hist
+0000bd00: 6f72 7920 666f 7220 6120 6769 7665 6e20  ory for a given 
+0000bd10: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
+0000bd20: 6e67 2063 6f6e 6669 672e 0a20 2020 2020  ng config..     
+0000bd30: 2020 2021 2121 2065 7861 6d70 6c65 0a20     !!! example. 
+0000bd40: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+0000bd50: 7468 6f6e 330a 2020 2020 2020 2020 2020  thon3.          
+0000bd60: 2020 2320 6665 7463 6820 796f 7572 2066    # fetch your f
+0000bd70: 6561 7475 7265 2067 726f 7570 0a20 2020  eature group.   
+0000bd80: 2020 2020 2020 2020 2066 6720 3d20 6673           fg = fs
+0000bd90: 2e67 6574 5f66 6561 7475 7265 5f67 726f  .get_feature_gro
+0000bda0: 7570 286e 616d 653d 226d 795f 6665 6174  up(name="my_feat
+0000bdb0: 7572 655f 6772 6f75 7022 2c20 7665 7273  ure_group", vers
+0000bdc0: 696f 6e3d 3129 0a20 2020 2020 2020 2020  ion=1).         
+0000bdd0: 2020 2023 2066 6574 6368 2066 6561 7475     # fetch featu
+0000bde0: 7265 206d 6f6e 6974 6f72 696e 6720 6869  re monitoring hi
+0000bdf0: 7374 6f72 7920 666f 7220 6120 6769 7665  story for a give
+0000be00: 6e20 6665 6174 7572 6520 6d6f 6e69 746f  n feature monito
+0000be10: 7269 6e67 2063 6f6e 6669 670a 2020 2020  ring config.    
+0000be20: 2020 2020 2020 2020 666d 5f68 6973 746f          fm_histo
+0000be30: 7279 203d 2066 672e 6765 745f 6665 6174  ry = fg.get_feat
+0000be40: 7572 655f 6d6f 6e69 746f 7269 6e67 5f68  ure_monitoring_h
+0000be50: 6973 746f 7279 280a 2020 2020 2020 2020  istory(.        
+0000be60: 2020 2020 2020 2020 636f 6e66 6967 5f6e          config_n
+0000be70: 616d 653d 226d 795f 636f 6e66 6967 222c  ame="my_config",
+0000be80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000be90: 2073 7461 7274 5f74 696d 653d 2232 3032   start_time="202
+0000bea0: 302d 3031 2d30 3122 2c0a 2020 2020 2020  0-01-01",.      
+0000beb0: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+0000bec0: 2020 2020 2320 6665 7463 6820 6665 6174      # fetch feat
+0000bed0: 7572 6520 6d6f 6e69 746f 7269 6e67 2068  ure monitoring h
+0000bee0: 6973 746f 7279 2066 6f72 2061 2067 6976  istory for a giv
+0000bef0: 656e 2066 6561 7475 7265 206d 6f6e 6974  en feature monit
+0000bf00: 6f72 696e 6720 636f 6e66 6967 2069 640a  oring config id.
+0000bf10: 2020 2020 2020 2020 2020 2020 666d 5f68              fm_h
+0000bf20: 6973 746f 7279 203d 2066 672e 6765 745f  istory = fg.get_
+0000bf30: 6665 6174 7572 655f 6d6f 6e69 746f 7269  feature_monitori
+0000bf40: 6e67 5f68 6973 746f 7279 280a 2020 2020  ng_history(.    
+0000bf50: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+0000bf60: 6967 5f69 643d 312c 0a20 2020 2020 2020  ig_id=1,.       
+0000bf70: 2020 2020 2020 2020 2073 7461 7274 5f74           start_t
+0000bf80: 696d 653d 6461 7465 7469 6d65 2e6e 6f77  ime=datetime.now
+0000bf90: 2829 202d 2074 696d 6564 656c 7461 2877  () - timedelta(w
+0000bfa0: 6565 6b73 3d32 292c 0a20 2020 2020 2020  eeks=2),.       
+0000bfb0: 2020 2020 2020 2020 2065 6e64 5f74 696d           end_tim
+0000bfc0: 653d 6461 7465 7469 6d65 2e6e 6f77 2829  e=datetime.now()
+0000bfd0: 202d 2074 696d 6564 656c 7461 2877 6565   - timedelta(wee
+0000bfe0: 6b73 3d31 292c 0a20 2020 2020 2020 2020  ks=1),.         
+0000bff0: 2020 2020 2020 2077 6974 685f 7374 6174         with_stat
+0000c000: 6973 7469 6373 3d46 616c 7365 2c0a 2020  istics=False,.  
+0000c010: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+0000c020: 2020 2020 2020 2020 6060 600a 2020 2020          ```.    
+0000c030: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
+0000c040: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+0000c050: 6967 5f6e 616d 653a 2054 6865 206e 616d  ig_name: The nam
+0000c060: 6520 6f66 2074 6865 2066 6561 7475 7265  e of the feature
+0000c070: 206d 6f6e 6974 6f72 696e 6720 636f 6e66   monitoring conf
+0000c080: 6967 2074 6f20 6665 7463 6820 6869 7374  ig to fetch hist
+0000c090: 6f72 7920 666f 722e 0a20 2020 2020 2020  ory for..       
+0000c0a0: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
+0000c0b0: 7320 746f 204e 6f6e 652e 0a20 2020 2020  s to None..     
+0000c0c0: 2020 2020 2020 2063 6f6e 6669 675f 6964         config_id
+0000c0d0: 3a20 5468 6520 6964 206f 6620 7468 6520  : The id of the 
+0000c0e0: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
+0000c0f0: 6e67 2063 6f6e 6669 6720 746f 2066 6574  ng config to fet
+0000c100: 6368 2068 6973 746f 7279 2066 6f72 2e0a  ch history for..
+0000c110: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c120: 4465 6661 756c 7473 2074 6f20 4e6f 6e65  Defaults to None
+0000c130: 2e0a 2020 2020 2020 2020 2020 2020 7374  ..            st
+0000c140: 6172 745f 7469 6d65 3a20 5468 6520 7374  art_time: The st
+0000c150: 6172 7420 6461 7465 206f 6620 7468 6520  art date of the 
+0000c160: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
+0000c170: 6e67 2068 6973 746f 7279 2074 6f20 6665  ng history to fe
+0000c180: 7463 682e 0a20 2020 2020 2020 2020 2020  tch..           
+0000c190: 2020 2020 2044 6566 6175 6c74 7320 746f       Defaults to
+0000c1a0: 204e 6f6e 652e 0a20 2020 2020 2020 2020   None..         
+0000c1b0: 2020 2065 6e64 5f74 696d 653a 2054 6865     end_time: The
+0000c1c0: 2065 6e64 2064 6174 6520 6f66 2074 6865   end date of the
+0000c1d0: 2066 6561 7475 7265 206d 6f6e 6974 6f72   feature monitor
+0000c1e0: 696e 6720 6869 7374 6f72 7920 746f 2066  ing history to f
+0000c1f0: 6574 6368 2e0a 2020 2020 2020 2020 2020  etch..          
+0000c200: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
+0000c210: 6f20 4e6f 6e65 2e0a 2020 2020 2020 2020  o None..        
+0000c220: 2020 2020 7769 7468 5f73 7461 7469 7374      with_statist
+0000c230: 6963 733a 2057 6865 7468 6572 2074 6f20  ics: Whether to 
+0000c240: 696e 636c 7564 6520 7374 6174 6973 7469  include statisti
+0000c250: 6373 2069 6e20 7468 6520 6665 6174 7572  cs in the featur
+0000c260: 6520 6d6f 6e69 746f 7269 6e67 2068 6973  e monitoring his
+0000c270: 746f 7279 2e0a 2020 2020 2020 2020 2020  tory..          
+0000c280: 2020 2020 2020 4465 6661 756c 7473 2074        Defaults t
+0000c290: 6f20 5472 7565 2e20 4966 2046 616c 7365  o True. If False
+0000c2a0: 2c20 6f6e 6c79 206d 6574 6164 6174 6120  , only metadata 
+0000c2b0: 6162 6f75 7420 7468 6520 6d6f 6e69 746f  about the monito
+0000c2c0: 7269 6e67 2077 696c 6c20 6265 2066 6574  ring will be fet
+0000c2d0: 6368 6564 2e0a 2020 2020 2020 2020 2320  ched..        # 
+0000c2e0: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
+0000c2f0: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
+0000c300: 6578 6365 7074 696f 6e73 2e52 6573 7441  exceptions.RestA
+0000c310: 5049 4572 726f 7260 2e0a 2020 2020 2020  PIError`..      
+0000c320: 2020 2020 2020 6068 7366 732e 636c 6965        `hsfs.clie
+0000c330: 6e74 2e65 7863 6570 7469 6f6e 732e 4665  nt.exceptions.Fe
+0000c340: 6174 7572 6553 746f 7265 4578 6365 7074  atureStoreExcept
+0000c350: 696f 6e60 2e0a 2020 2020 2020 2020 2020  ion`..          
+0000c360: 2020 5661 6c75 6545 7272 6f72 3a20 6966    ValueError: if
+0000c370: 2062 6f74 6820 636f 6e66 6967 5f6e 616d   both config_nam
+0000c380: 6520 616e 6420 636f 6e66 6967 5f69 6420  e and config_id 
+0000c390: 6172 6520 7072 6f76 6964 6564 2e0a 2020  are provided..  
+0000c3a0: 2020 2020 2020 2020 2020 5479 7065 4572            TypeEr
+0000c3b0: 726f 723a 2069 6620 636f 6e66 6967 5f6e  ror: if config_n
+0000c3c0: 616d 6520 6f72 2063 6f6e 6669 675f 6964  ame or config_id
+0000c3d0: 2061 7265 206e 6f74 2072 6573 7065 6374   are not respect
+0000c3e0: 6976 656c 7920 7374 7269 6e67 2c20 696e  ively string, in
+0000c3f0: 7420 6f72 204e 6f6e 652e 0a20 2020 2020  t or None..     
+0000c400: 2020 2023 2052 6574 7572 6e0a 2020 2020     # Return.    
+0000c410: 2020 2020 2020 2020 4c69 7374 5b60 4665          List[`Fe
+0000c420: 6174 7572 654d 6f6e 6974 6f72 696e 6752  atureMonitoringR
+0000c430: 6573 756c 7460 5d0a 2020 2020 2020 2020  esult`].        
+0000c440: 2020 2020 2020 2020 4120 6c69 7374 206f          A list o
+0000c450: 6620 6665 6174 7572 6520 6d6f 6e69 746f  f feature monito
+0000c460: 7269 6e67 2072 6573 756c 7473 2063 6f6e  ring results con
+0000c470: 7461 696e 696e 6720 7468 6520 6d6f 6e69  taining the moni
+0000c480: 746f 7269 6e67 206d 6574 6164 6174 610a  toring metadata.
+0000c490: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000c4a0: 6173 2077 656c 6c20 6173 2074 6865 2063  as well as the c
+0000c4b0: 6f6d 7075 7465 6420 7374 6174 6973 7469  omputed statisti
+0000c4c0: 6373 2066 6f72 2074 6865 2064 6574 6563  cs for the detec
+0000c4d0: 7469 6f6e 2061 6e64 2072 6566 6572 656e  tion and referen
+0000c4e0: 6365 2077 696e 646f 770a 2020 2020 2020  ce window.      
+0000c4f0: 2020 2020 2020 2020 2020 6966 2072 6571            if req
+0000c500: 7565 7374 6564 2e0a 2020 2020 2020 2020  uested..        
+0000c510: 2222 220a 2020 2020 2020 2020 6966 206e  """.        if n
+0000c520: 6f74 2073 656c 662e 5f69 643a 0a20 2020  ot self._id:.   
+0000c530: 2020 2020 2020 2020 2072 6169 7365 2046           raise F
+0000c540: 6561 7475 7265 5374 6f72 6545 7863 6570  eatureStoreExcep
+0000c550: 7469 6f6e 280a 2020 2020 2020 2020 2020  tion(.          
+0000c560: 2020 2020 2020 224f 6e6c 7920 4665 6174        "Only Feat
+0000c570: 7572 6520 4772 6f75 7020 7265 6769 7374  ure Group regist
+0000c580: 6572 6564 2077 6974 6820 486f 7073 776f  ered with Hopswo
+0000c590: 726b 7320 6361 6e20 6665 7463 6820 6665  rks can fetch fe
+0000c5a0: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
+0000c5b0: 2068 6973 746f 7279 2e22 0a20 2020 2020   history.".     
+0000c5c0: 2020 2020 2020 2029 0a0a 2020 2020 2020         )..      
+0000c5d0: 2020 7265 7475 726e 2073 656c 662e 5f66    return self._f
+0000c5e0: 6561 7475 7265 5f6d 6f6e 6974 6f72 696e  eature_monitorin
+0000c5f0: 675f 7265 7375 6c74 5f65 6e67 696e 652e  g_result_engine.
+0000c600: 6765 745f 6665 6174 7572 655f 6d6f 6e69  get_feature_moni
+0000c610: 746f 7269 6e67 5f72 6573 756c 7473 280a  toring_results(.
+0000c620: 2020 2020 2020 2020 2020 2020 636f 6e66              conf
+0000c630: 6967 5f6e 616d 653d 636f 6e66 6967 5f6e  ig_name=config_n
+0000c640: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+0000c650: 2063 6f6e 6669 675f 6964 3d63 6f6e 6669   config_id=confi
+0000c660: 675f 6964 2c0a 2020 2020 2020 2020 2020  g_id,.          
+0000c670: 2020 7374 6172 745f 7469 6d65 3d73 7461    start_time=sta
+0000c680: 7274 5f74 696d 652c 0a20 2020 2020 2020  rt_time,.       
+0000c690: 2020 2020 2065 6e64 5f74 696d 653d 656e       end_time=en
+0000c6a0: 645f 7469 6d65 2c0a 2020 2020 2020 2020  d_time,.        
+0000c6b0: 2020 2020 7769 7468 5f73 7461 7469 7374      with_statist
+0000c6c0: 6963 733d 7769 7468 5f73 7461 7469 7374  ics=with_statist
+0000c6d0: 6963 732c 0a20 2020 2020 2020 2029 0a0a  ics,.        )..
+0000c6e0: 2020 2020 6465 6620 6372 6561 7465 5f73      def create_s
+0000c6f0: 7461 7469 7374 6963 735f 6d6f 6e69 746f  tatistics_monito
+0000c700: 7269 6e67 280a 2020 2020 2020 2020 7365  ring(.        se
+0000c710: 6c66 2c0a 2020 2020 2020 2020 6e61 6d65  lf,.        name
+0000c720: 3a20 7374 722c 0a20 2020 2020 2020 2066  : str,.        f
+0000c730: 6561 7475 7265 5f6e 616d 653a 204f 7074  eature_name: Opt
+0000c740: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
+0000c750: 652c 0a20 2020 2020 2020 2064 6573 6372  e,.        descr
+0000c760: 6970 7469 6f6e 3a20 4f70 7469 6f6e 616c  iption: Optional
+0000c770: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0000c780: 2020 2020 2020 7374 6172 745f 6461 7465        start_date
+0000c790: 5f74 696d 653a 204f 7074 696f 6e61 6c5b  _time: Optional[
+0000c7a0: 556e 696f 6e5b 696e 742c 2073 7472 2c20  Union[int, str, 
+0000c7b0: 6461 7465 7469 6d65 2c20 6461 7465 2c20  datetime, date, 
+0000c7c0: 7064 2e54 696d 6573 7461 6d70 5d5d 203d  pd.Timestamp]] =
+0000c7d0: 204e 6f6e 652c 0a20 2020 2020 2020 2065   None,.        e
+0000c7e0: 6e64 5f64 6174 655f 7469 6d65 3a20 4f70  nd_date_time: Op
+0000c7f0: 7469 6f6e 616c 5b55 6e69 6f6e 5b69 6e74  tional[Union[int
+0000c800: 2c20 7374 722c 2064 6174 6574 696d 652c  , str, datetime,
+0000c810: 2064 6174 652c 2070 642e 5469 6d65 7374   date, pd.Timest
+0000c820: 616d 705d 5d20 3d20 4e6f 6e65 2c0a 2020  amp]] = None,.  
+0000c830: 2020 2020 2020 6372 6f6e 5f65 7870 7265        cron_expre
+0000c840: 7373 696f 6e3a 204f 7074 696f 6e61 6c5b  ssion: Optional[
+0000c850: 7374 725d 203d 2022 3020 3020 3132 203f  str] = "0 0 12 ?
+0000c860: 202a 202a 202a 222c 0a20 2020 2029 202d   * * *",.    ) -
+0000c870: 3e20 2266 6d63 2e46 6561 7475 7265 4d6f  > "fmc.FeatureMo
+0000c880: 6e69 746f 7269 6e67 436f 6e66 6967 223a  nitoringConfig":
+0000c890: 0a20 2020 2020 2020 2022 2222 5275 6e20  .        """Run 
+0000c8a0: 6120 6a6f 6220 746f 2063 6f6d 7075 7465  a job to compute
+0000c8b0: 2073 7461 7469 7374 6963 7320 6f6e 2073   statistics on s
+0000c8c0: 6e61 7073 686f 7420 6f66 2066 6561 7475  napshot of featu
+0000c8d0: 7265 2064 6174 6120 6f6e 2061 2073 6368  re data on a sch
+0000c8e0: 6564 756c 652e 0a20 2020 2020 2020 2021  edule..        !
+0000c8f0: 2121 2065 7870 6572 696d 656e 7461 6c0a  !! experimental.
+0000c900: 2020 2020 2020 2020 2020 2020 5075 626c              Publ
+0000c910: 6963 2041 5049 2069 7320 7375 626a 6563  ic API is subjec
+0000c920: 7420 746f 2063 6861 6e67 652c 2074 6869  t to change, thi
+0000c930: 7320 6665 6174 7572 6520 6973 206e 6f74  s feature is not
+0000c940: 2073 7569 7461 626c 6520 666f 7220 7072   suitable for pr
+0000c950: 6f64 7563 7469 6f6e 2075 7365 2d63 6173  oduction use-cas
+0000c960: 6573 2e0a 2020 2020 2020 2020 2121 2120  es..        !!! 
+0000c970: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
+0000c980: 2020 2020 6060 6070 7974 686f 6e33 0a20      ```python3. 
+0000c990: 2020 2020 2020 2020 2020 2023 2066 6574             # fet
+0000c9a0: 6368 2066 6561 7475 7265 2067 726f 7570  ch feature group
+0000c9b0: 0a20 2020 2020 2020 2020 2020 2066 6720  .            fg 
+0000c9c0: 3d20 6673 2e67 6574 5f66 6561 7475 7265  = fs.get_feature
+0000c9d0: 5f67 726f 7570 286e 616d 653d 226d 795f  _group(name="my_
+0000c9e0: 6665 6174 7572 655f 6772 6f75 7022 2c20  feature_group", 
+0000c9f0: 7665 7273 696f 6e3d 3129 0a20 2020 2020  version=1).     
+0000ca00: 2020 2020 2020 2023 2065 6e61 626c 6520         # enable 
+0000ca10: 7374 6174 6973 7469 6373 206d 6f6e 6974  statistics monit
+0000ca20: 6f72 696e 670a 2020 2020 2020 2020 2020  oring.          
+0000ca30: 2020 6d79 5f63 6f6e 6669 6720 3d20 6667    my_config = fg
+0000ca40: 2e63 7265 6174 655f 7374 6174 6973 7469  .create_statisti
+0000ca50: 6373 5f6d 6f6e 6974 6f72 696e 6728 0a20  cs_monitoring(. 
+0000ca60: 2020 2020 2020 2020 2020 2020 2020 206e                 n
+0000ca70: 616d 653d 226d 795f 636f 6e66 6967 222c  ame="my_config",
+0000ca80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000ca90: 2073 7461 7274 5f64 6174 655f 7469 6d65   start_date_time
+0000caa0: 3d22 3230 3231 2d30 312d 3031 2030 303a  ="2021-01-01 00:
+0000cab0: 3030 3a30 3022 2c0a 2020 2020 2020 2020  00:00",.        
+0000cac0: 2020 2020 2020 2020 6465 7363 7269 7074          descript
+0000cad0: 696f 6e3d 226d 7920 6465 7363 7269 7074  ion="my descript
+0000cae0: 696f 6e22 2c0a 2020 2020 2020 2020 2020  ion",.          
+0000caf0: 2020 2020 2020 6372 6f6e 5f65 7870 7265        cron_expre
+0000cb00: 7373 696f 6e3d 2230 2030 2031 3220 3f20  ssion="0 0 12 ? 
+0000cb10: 2a20 2a20 2a22 2c0a 2020 2020 2020 2020  * * *",.        
+0000cb20: 2020 2020 292e 7769 7468 5f64 6574 6563      ).with_detec
+0000cb30: 7469 6f6e 5f77 696e 646f 7728 0a20 2020  tion_window(.   
+0000cb40: 2020 2020 2020 2020 2020 2020 2023 2053               # S
+0000cb50: 7461 7469 7374 6963 7320 636f 6d70 7574  tatistics comput
+0000cb60: 6564 206f 6e20 3130 2520 6f66 2074 6865  ed on 10% of the
+0000cb70: 206c 6173 7420 7765 656b 206f 6620 6461   last week of da
+0000cb80: 7461 0a20 2020 2020 2020 2020 2020 2020  ta.             
+0000cb90: 2020 2074 696d 655f 6f66 6673 6574 3d22     time_offset="
+0000cba0: 3177 222c 0a20 2020 2020 2020 2020 2020  1w",.           
+0000cbb0: 2020 2020 2072 6f77 5f70 6572 6365 6e74       row_percent
+0000cbc0: 6167 653d 302e 312c 0a20 2020 2020 2020  age=0.1,.       
+0000cbd0: 2020 2020 2029 2e73 6176 6528 290a 2020       ).save().  
+0000cbe0: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+0000cbf0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+0000cc00: 730a 2020 2020 2020 2020 2020 2020 6e61  s.            na
+0000cc10: 6d65 3a20 4e61 6d65 206f 6620 7468 6520  me: Name of the 
+0000cc20: 6665 6174 7572 6520 6d6f 6e69 746f 7269  feature monitori
+0000cc30: 6e67 2063 6f6e 6669 6775 7261 7469 6f6e  ng configuration
+0000cc40: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cc50: 2020 6e61 6d65 206d 7573 7420 6265 2075    name must be u
+0000cc60: 6e69 7175 6520 666f 7220 616c 6c20 636f  nique for all co
+0000cc70: 6e66 6967 7572 6174 696f 6e73 2061 7474  nfigurations att
+0000cc80: 6163 6865 6420 746f 2074 6865 2066 6561  ached to the fea
+0000cc90: 7475 7265 2067 726f 7570 2e0a 2020 2020  ture group..    
+0000cca0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+0000ccb0: 6e61 6d65 3a20 4e61 6d65 206f 6620 7468  name: Name of th
+0000ccc0: 6520 6665 6174 7572 6520 746f 206d 6f6e  e feature to mon
+0000ccd0: 6974 6f72 2e20 4966 206e 6f74 2073 7065  itor. If not spe
+0000cce0: 6369 6669 6564 2c20 7374 6174 6973 7469  cified, statisti
+0000ccf0: 6373 0a20 2020 2020 2020 2020 2020 2020  cs.             
+0000cd00: 2020 2077 696c 6c20 6265 2063 6f6d 7075     will be compu
+0000cd10: 7465 6420 666f 7220 616c 6c20 6665 6174  ted for all feat
+0000cd20: 7572 6573 2e0a 2020 2020 2020 2020 2020  ures..          
+0000cd30: 2020 6465 7363 7269 7074 696f 6e3a 2044    description: D
+0000cd40: 6573 6372 6970 7469 6f6e 206f 6620 7468  escription of th
+0000cd50: 6520 6665 6174 7572 6520 6d6f 6e69 746f  e feature monito
+0000cd60: 7269 6e67 2063 6f6e 6669 6775 7261 7469  ring configurati
+0000cd70: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+0000cd80: 7374 6172 745f 6461 7465 5f74 696d 653a  start_date_time:
+0000cd90: 2053 7461 7274 2064 6174 6520 616e 6420   Start date and 
+0000cda0: 7469 6d65 2066 726f 6d20 7768 6963 6820  time from which 
+0000cdb0: 746f 2073 7461 7274 2063 6f6d 7075 7469  to start computi
+0000cdc0: 6e67 2073 7461 7469 7374 6963 732e 0a20  ng statistics.. 
+0000cdd0: 2020 2020 2020 2020 2020 2065 6e64 5f64             end_d
+0000cde0: 6174 655f 7469 6d65 3a20 456e 6420 6461  ate_time: End da
+0000cdf0: 7465 2061 6e64 2074 696d 6520 6174 2077  te and time at w
+0000ce00: 6869 6368 2074 6f20 7374 6f70 2063 6f6d  hich to stop com
+0000ce10: 7075 7469 6e67 2073 7461 7469 7374 6963  puting statistic
+0000ce20: 732e 0a20 2020 2020 2020 2020 2020 2063  s..            c
+0000ce30: 726f 6e5f 6578 7072 6573 7369 6f6e 3a20  ron_expression: 
+0000ce40: 4372 6f6e 2065 7870 7265 7373 696f 6e20  Cron expression 
+0000ce50: 746f 2075 7365 2074 6f20 7363 6865 6475  to use to schedu
+0000ce60: 6c65 2074 6865 206a 6f62 2e20 5468 6520  le the job. The 
+0000ce70: 6372 6f6e 2065 7870 7265 7373 696f 6e0a  cron expression.
+0000ce80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ce90: 6d75 7374 2062 6520 696e 2055 5443 2061  must be in UTC a
+0000cea0: 6e64 2066 6f6c 6c6f 7720 7468 6520 5175  nd follow the Qu
+0000ceb0: 6172 747a 2073 7065 6369 6669 6361 7469  artz specificati
+0000cec0: 6f6e 2e20 4465 6661 756c 7420 6973 2027  on. Default is '
+0000ced0: 3020 3020 3132 203f 202a 202a 202a 272c  0 0 12 ? * * *',
+0000cee0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cef0: 2065 7665 7279 2064 6179 2061 7420 3132   every day at 12
+0000cf00: 706d 2055 5443 2e0a 2020 2020 2020 2020  pm UTC..        
+0000cf10: 2320 5261 6973 6573 0a20 2020 2020 2020  # Raises.       
+0000cf20: 2020 2020 2060 6873 6673 2e63 6c69 656e       `hsfs.clien
+0000cf30: 742e 6578 6365 7074 696f 6e73 2e46 6561  t.exceptions.Fea
+0000cf40: 7475 7265 5374 6f72 6545 7863 6570 7469  tureStoreExcepti
+0000cf50: 6f6e 602e 0a20 2020 2020 2020 2023 2052  on`..        # R
+0000cf60: 6574 7572 6e0a 2020 2020 2020 2020 2020  eturn.          
+0000cf70: 2020 6046 6561 7475 7265 4d6f 6e69 746f    `FeatureMonito
+0000cf80: 7269 6e67 436f 6e66 6967 6020 436f 6e66  ringConfig` Conf
+0000cf90: 6967 7572 6174 696f 6e20 7769 7468 206d  iguration with m
+0000cfa0: 696e 696d 616c 2069 6e66 6f72 6d61 7469  inimal informati
+0000cfb0: 6f6e 2061 626f 7574 2074 6865 2066 6561  on about the fea
+0000cfc0: 7475 7265 206d 6f6e 6974 6f72 696e 672e  ture monitoring.
+0000cfd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000cfe0: 2041 6464 6974 696f 6e61 6c20 696e 666f   Additional info
+0000cff0: 726d 6174 696f 6e20 6172 6520 7265 7175  rmation are requ
+0000d000: 6972 6564 2062 6566 6f72 6520 6665 6174  ired before feat
+0000d010: 7572 6520 6d6f 6e69 746f 7269 6e67 2069  ure monitoring i
+0000d020: 7320 656e 6162 6c65 642e 0a20 2020 2020  s enabled..     
+0000d030: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
+0000d040: 6620 6e6f 7420 7365 6c66 2e5f 6964 3a0a  f not self._id:.
+0000d050: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0000d060: 6520 4665 6174 7572 6553 746f 7265 4578  e FeatureStoreEx
+0000d070: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
+0000d080: 2020 2020 2020 2020 2022 4f6e 6c79 2046           "Only F
+0000d090: 6561 7475 7265 2047 726f 7570 2072 6567  eature Group reg
+0000d0a0: 6973 7465 7265 6420 7769 7468 2048 6f70  istered with Hop
+0000d0b0: 7377 6f72 6b73 2063 616e 2065 6e61 626c  sworks can enabl
+0000d0c0: 6520 7363 6865 6475 6c65 6420 7374 6174  e scheduled stat
+0000d0d0: 6973 7469 6373 206d 6f6e 6974 6f72 696e  istics monitorin
+0000d0e0: 672e 220a 2020 2020 2020 2020 2020 2020  g.".            
+0000d0f0: 290a 0a20 2020 2020 2020 2072 6574 7572  )..        retur
+0000d100: 6e20 7365 6c66 2e5f 6665 6174 7572 655f  n self._feature_
+0000d110: 6d6f 6e69 746f 7269 6e67 5f63 6f6e 6669  monitoring_confi
+0000d120: 675f 656e 6769 6e65 2e5f 6275 696c 645f  g_engine._build_
+0000d130: 6465 6661 756c 745f 7374 6174 6973 7469  default_statisti
+0000d140: 6373 5f6d 6f6e 6974 6f72 696e 675f 636f  cs_monitoring_co
+0000d150: 6e66 6967 280a 2020 2020 2020 2020 2020  nfig(.          
+0000d160: 2020 6e61 6d65 3d6e 616d 652c 0a20 2020    name=name,.   
+0000d170: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+0000d180: 5f6e 616d 653d 6665 6174 7572 655f 6e61  _name=feature_na
+0000d190: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0000d1a0: 6465 7363 7269 7074 696f 6e3d 6465 7363  description=desc
+0000d1b0: 7269 7074 696f 6e2c 0a20 2020 2020 2020  ription,.       
+0000d1c0: 2020 2020 2073 7461 7274 5f64 6174 655f       start_date_
+0000d1d0: 7469 6d65 3d73 7461 7274 5f64 6174 655f  time=start_date_
+0000d1e0: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
+0000d1f0: 2020 7661 6c69 645f 6665 6174 7572 655f    valid_feature_
+0000d200: 6e61 6d65 733d 5b66 6561 742e 6e61 6d65  names=[feat.name
+0000d210: 2066 6f72 2066 6561 7420 696e 2073 656c   for feat in sel
+0000d220: 662e 5f66 6561 7475 7265 735d 2c0a 2020  f._features],.  
+0000d230: 2020 2020 2020 2020 2020 656e 645f 6461            end_da
+0000d240: 7465 5f74 696d 653d 656e 645f 6461 7465  te_time=end_date
+0000d250: 5f74 696d 652c 0a20 2020 2020 2020 2020  _time,.         
+0000d260: 2020 2063 726f 6e5f 6578 7072 6573 7369     cron_expressi
+0000d270: 6f6e 3d63 726f 6e5f 6578 7072 6573 7369  on=cron_expressi
+0000d280: 6f6e 2c0a 2020 2020 2020 2020 290a 0a20  on,.        ).. 
+0000d290: 2020 2064 6566 2063 7265 6174 655f 6665     def create_fe
+0000d2a0: 6174 7572 655f 6d6f 6e69 746f 7269 6e67  ature_monitoring
+0000d2b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0000d2c0: 2020 2020 2020 2020 6e61 6d65 3a20 7374          name: st
+0000d2d0: 722c 0a20 2020 2020 2020 2066 6561 7475  r,.        featu
+0000d2e0: 7265 5f6e 616d 653a 2073 7472 2c0a 2020  re_name: str,.  
+0000d2f0: 2020 2020 2020 6465 7363 7269 7074 696f        descriptio
+0000d300: 6e3a 204f 7074 696f 6e61 6c5b 7374 725d  n: Optional[str]
+0000d310: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000d320: 2073 7461 7274 5f64 6174 655f 7469 6d65   start_date_time
+0000d330: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+0000d340: 5b69 6e74 2c20 7374 722c 2064 6174 6574  [int, str, datet
+0000d350: 696d 652c 2064 6174 652c 2070 642e 5469  ime, date, pd.Ti
+0000d360: 6d65 7374 616d 705d 5d20 3d20 4e6f 6e65  mestamp]] = None
+0000d370: 2c0a 2020 2020 2020 2020 656e 645f 6461  ,.        end_da
+0000d380: 7465 5f74 696d 653a 204f 7074 696f 6e61  te_time: Optiona
+0000d390: 6c5b 556e 696f 6e5b 696e 742c 2073 7472  l[Union[int, str
+0000d3a0: 2c20 6461 7465 7469 6d65 2c20 6461 7465  , datetime, date
+0000d3b0: 2c20 7064 2e54 696d 6573 7461 6d70 5d5d  , pd.Timestamp]]
+0000d3c0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
+0000d3d0: 2063 726f 6e5f 6578 7072 6573 7369 6f6e   cron_expression
+0000d3e0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
+0000d3f0: 3d20 2230 2030 2031 3220 3f20 2a20 2a20  = "0 0 12 ? * * 
+0000d400: 2a22 2c0a 2020 2020 2920 2d3e 2022 666d  *",.    ) -> "fm
+0000d410: 632e 4665 6174 7572 654d 6f6e 6974 6f72  c.FeatureMonitor
+0000d420: 696e 6743 6f6e 6669 6722 3a0a 2020 2020  ingConfig":.    
+0000d430: 2020 2020 2222 2245 6e61 626c 6520 6665      """Enable fe
+0000d440: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
+0000d450: 2074 6f20 636f 6d70 6172 6520 7374 6174   to compare stat
+0000d460: 6973 7469 6373 206f 6e20 736e 6170 7368  istics on snapsh
+0000d470: 6f74 7320 6f66 2066 6561 7475 7265 2064  ots of feature d
+0000d480: 6174 6120 6f76 6572 2074 696d 652e 0a20  ata over time.. 
+0000d490: 2020 2020 2020 2021 2121 2065 7870 6572         !!! exper
+0000d4a0: 696d 656e 7461 6c0a 2020 2020 2020 2020  imental.        
+0000d4b0: 2020 2020 5075 626c 6963 2041 5049 2069      Public API i
+0000d4c0: 7320 7375 626a 6563 7420 746f 2063 6861  s subject to cha
+0000d4d0: 6e67 652c 2074 6869 7320 6665 6174 7572  nge, this featur
+0000d4e0: 6520 6973 206e 6f74 2073 7569 7461 626c  e is not suitabl
+0000d4f0: 6520 666f 7220 7072 6f64 7563 7469 6f6e  e for production
+0000d500: 2075 7365 2d63 6173 6573 2e0a 2020 2020   use-cases..    
+0000d510: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
+0000d520: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+0000d530: 7974 686f 6e33 0a20 2020 2020 2020 2020  ython3.         
+0000d540: 2020 2023 2066 6574 6368 2066 6561 7475     # fetch featu
+0000d550: 7265 2067 726f 7570 0a20 2020 2020 2020  re group.       
+0000d560: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+0000d570: 5f66 6561 7475 7265 5f67 726f 7570 286e  _feature_group(n
+0000d580: 616d 653d 226d 795f 6665 6174 7572 655f  ame="my_feature_
+0000d590: 6772 6f75 7022 2c20 7665 7273 696f 6e3d  group", version=
+0000d5a0: 3129 0a20 2020 2020 2020 2020 2020 2023  1).            #
+0000d5b0: 2065 6e61 626c 6520 6665 6174 7572 6520   enable feature 
+0000d5c0: 6d6f 6e69 746f 7269 6e67 0a20 2020 2020  monitoring.     
+0000d5d0: 2020 2020 2020 206d 795f 636f 6e66 6967         my_config
+0000d5e0: 203d 2066 672e 6372 6561 7465 5f66 6561   = fg.create_fea
+0000d5f0: 7475 7265 5f6d 6f6e 6974 6f72 696e 6728  ture_monitoring(
+0000d600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000d610: 206e 616d 653d 226d 795f 6d6f 6e69 746f   name="my_monito
+0000d620: 7269 6e67 5f63 6f6e 6669 6722 2c0a 2020  ring_config",.  
+0000d630: 2020 2020 2020 2020 2020 2020 2020 6665                fe
+0000d640: 6174 7572 655f 6e61 6d65 3d22 6d79 5f66  ature_name="my_f
+0000d650: 6561 7475 7265 222c 0a20 2020 2020 2020  eature",.       
+0000d660: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
+0000d670: 7469 6f6e 3d22 6d79 206d 6f6e 6974 6f72  tion="my monitor
+0000d680: 696e 6720 636f 6e66 6967 2064 6573 6372  ing config descr
+0000d690: 6970 7469 6f6e 222c 0a20 2020 2020 2020  iption",.       
+0000d6a0: 2020 2020 2020 2020 2063 726f 6e5f 6578           cron_ex
+0000d6b0: 7072 6573 7369 6f6e 3d22 3020 3020 3132  pression="0 0 12
+0000d6c0: 203f 202a 202a 202a 222c 0a20 2020 2020   ? * * *",.     
+0000d6d0: 2020 2020 2020 2029 2e77 6974 685f 6465         ).with_de
+0000d6e0: 7465 6374 696f 6e5f 7769 6e64 6f77 280a  tection_window(.
+0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d700: 2320 4461 7461 2069 6e73 6572 7465 6420  # Data inserted 
+0000d710: 696e 2074 6865 206c 6173 7420 6461 790a  in the last day.
+0000d720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d730: 7469 6d65 5f6f 6666 7365 743d 2231 6422  time_offset="1d"
+0000d740: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+0000d750: 2020 7769 6e64 6f77 5f6c 656e 6774 683d    window_length=
+0000d760: 2231 6422 2c0a 2020 2020 2020 2020 2020  "1d",.          
+0000d770: 2020 292e 7769 7468 5f72 6566 6572 656e    ).with_referen
+0000d780: 6365 5f77 696e 646f 7728 0a20 2020 2020  ce_window(.     
+0000d790: 2020 2020 2020 2020 2020 2023 2044 6174             # Dat
+0000d7a0: 6120 696e 7365 7274 6564 206c 6173 7420  a inserted last 
+0000d7b0: 7765 656b 206f 6e20 7468 6520 7361 6d65  week on the same
+0000d7c0: 2064 6179 0a20 2020 2020 2020 2020 2020   day.           
+0000d7d0: 2020 2020 2074 696d 655f 6f66 6673 6574       time_offset
+0000d7e0: 3d22 3177 3164 222c 0a20 2020 2020 2020  ="1w1d",.       
+0000d7f0: 2020 2020 2020 2020 2077 696e 646f 775f           window_
+0000d800: 6c65 6e67 7468 3d22 3164 222c 0a20 2020  length="1d",.   
+0000d810: 2020 2020 2020 2020 2029 2e63 6f6d 7061           ).compa
+0000d820: 7265 5f6f 6e28 0a20 2020 2020 2020 2020  re_on(.         
+0000d830: 2020 2020 2020 206d 6574 7269 633d 226d         metric="m
+0000d840: 6561 6e22 2c0a 2020 2020 2020 2020 2020  ean",.          
+0000d850: 2020 2020 2020 7468 7265 7368 6f6c 643d        threshold=
+0000d860: 302e 352c 0a20 2020 2020 2020 2020 2020  0.5,.           
+0000d870: 2029 2e73 6176 6528 290a 2020 2020 2020   ).save().      
+0000d880: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
+0000d890: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
+0000d8a0: 2020 2020 2020 2020 2020 6e61 6d65 3a20            name: 
+0000d8b0: 4e61 6d65 206f 6620 7468 6520 6665 6174  Name of the feat
+0000d8c0: 7572 6520 6d6f 6e69 746f 7269 6e67 2063  ure monitoring c
+0000d8d0: 6f6e 6669 6775 7261 7469 6f6e 2e0a 2020  onfiguration..  
+0000d8e0: 2020 2020 2020 2020 2020 2020 2020 6e61                na
+0000d8f0: 6d65 206d 7573 7420 6265 2075 6e69 7175  me must be uniqu
+0000d900: 6520 666f 7220 616c 6c20 636f 6e66 6967  e for all config
+0000d910: 7572 6174 696f 6e73 2061 7474 6163 6865  urations attache
+0000d920: 6420 746f 2074 6865 2066 6561 7475 7265  d to the feature
+0000d930: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
+0000d940: 2020 2020 6665 6174 7572 655f 6e61 6d65      feature_name
+0000d950: 3a20 4e61 6d65 206f 6620 7468 6520 6665  : Name of the fe
+0000d960: 6174 7572 6520 746f 206d 6f6e 6974 6f72  ature to monitor
+0000d970: 2e0a 2020 2020 2020 2020 2020 2020 6465  ..            de
+0000d980: 7363 7269 7074 696f 6e3a 2044 6573 6372  scription: Descr
+0000d990: 6970 7469 6f6e 206f 6620 7468 6520 6665  iption of the fe
+0000d9a0: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
+0000d9b0: 2063 6f6e 6669 6775 7261 7469 6f6e 2e0a   configuration..
+0000d9c0: 2020 2020 2020 2020 2020 2020 7374 6172              star
+0000d9d0: 745f 6461 7465 5f74 696d 653a 2053 7461  t_date_time: Sta
+0000d9e0: 7274 2064 6174 6520 616e 6420 7469 6d65  rt date and time
+0000d9f0: 2066 726f 6d20 7768 6963 6820 746f 2073   from which to s
+0000da00: 7461 7274 2063 6f6d 7075 7469 6e67 2073  tart computing s
+0000da10: 7461 7469 7374 6963 732e 0a20 2020 2020  tatistics..     
+0000da20: 2020 2020 2020 2065 6e64 5f64 6174 655f         end_date_
+0000da30: 7469 6d65 3a20 456e 6420 6461 7465 2061  time: End date a
+0000da40: 6e64 2074 696d 6520 6174 2077 6869 6368  nd time at which
+0000da50: 2074 6f20 7374 6f70 2063 6f6d 7075 7469   to stop computi
+0000da60: 6e67 2073 7461 7469 7374 6963 732e 0a20  ng statistics.. 
+0000da70: 2020 2020 2020 2020 2020 2063 726f 6e5f             cron_
+0000da80: 6578 7072 6573 7369 6f6e 3a20 4372 6f6e  expression: Cron
+0000da90: 2065 7870 7265 7373 696f 6e20 746f 2075   expression to u
+0000daa0: 7365 2074 6f20 7363 6865 6475 6c65 2074  se to schedule t
+0000dab0: 6865 206a 6f62 2e20 5468 6520 6372 6f6e  he job. The cron
+0000dac0: 2065 7870 7265 7373 696f 6e0a 2020 2020   expression.    
+0000dad0: 2020 2020 2020 2020 2020 2020 6d75 7374              must
+0000dae0: 2062 6520 696e 2055 5443 2061 6e64 2066   be in UTC and f
+0000daf0: 6f6c 6c6f 7720 7468 6520 5175 6172 747a  ollow the Quartz
+0000db00: 2073 7065 6369 6669 6361 7469 6f6e 2e20   specification. 
+0000db10: 4465 6661 756c 7420 6973 2027 3020 3020  Default is '0 0 
+0000db20: 3132 203f 202a 202a 202a 272c 0a20 2020  12 ? * * *',.   
+0000db30: 2020 2020 2020 2020 2020 2020 2065 7665               eve
+0000db40: 7279 2064 6179 2061 7420 3132 706d 2055  ry day at 12pm U
+0000db50: 5443 2e0a 2020 2020 2020 2020 2320 5261  TC..        # Ra
+0000db60: 6973 6573 0a20 2020 2020 2020 2020 2020  ises.           
+0000db70: 2060 6873 6673 2e63 6c69 656e 742e 6578   `hsfs.client.ex
+0000db80: 6365 7074 696f 6e73 2e46 6561 7475 7265  ceptions.Feature
+0000db90: 5374 6f72 6545 7863 6570 7469 6f6e 602e  StoreException`.
+0000dba0: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
+0000dbb0: 6e0a 2020 2020 2020 2020 2020 2020 6046  n.            `F
+0000dbc0: 6561 7475 7265 4d6f 6e69 746f 7269 6e67  eatureMonitoring
+0000dbd0: 436f 6e66 6967 6020 436f 6e66 6967 7572  Config` Configur
+0000dbe0: 6174 696f 6e20 7769 7468 206d 696e 696d  ation with minim
+0000dbf0: 616c 2069 6e66 6f72 6d61 7469 6f6e 2061  al information a
+0000dc00: 626f 7574 2074 6865 2066 6561 7475 7265  bout the feature
+0000dc10: 206d 6f6e 6974 6f72 696e 672e 0a20 2020   monitoring..   
+0000dc20: 2020 2020 2020 2020 2020 2020 2041 6464               Add
+0000dc30: 6974 696f 6e61 6c20 696e 666f 726d 6174  itional informat
+0000dc40: 696f 6e20 6172 6520 7265 7175 6972 6564  ion are required
+0000dc50: 2062 6566 6f72 6520 6665 6174 7572 6520   before feature 
+0000dc60: 6d6f 6e69 746f 7269 6e67 2069 7320 656e  monitoring is en
+0000dc70: 6162 6c65 642e 0a20 2020 2020 2020 2022  abled..        "
+0000dc80: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
+0000dc90: 7420 7365 6c66 2e5f 6964 3a0a 2020 2020  t self._id:.    
+0000dca0: 2020 2020 2020 2020 7261 6973 6520 4665          raise Fe
+0000dcb0: 6174 7572 6553 746f 7265 4578 6365 7074  atureStoreExcept
+0000dcc0: 696f 6e28 0a20 2020 2020 2020 2020 2020  ion(.           
+0000dcd0: 2020 2020 2022 4f6e 6c79 2046 6561 7475       "Only Featu
+0000dce0: 7265 2047 726f 7570 2072 6567 6973 7465  re Group registe
+0000dcf0: 7265 6420 7769 7468 2048 6f70 7377 6f72  red with Hopswor
+0000dd00: 6b73 2063 616e 2065 6e61 626c 6520 6665  ks can enable fe
+0000dd10: 6174 7572 6520 6d6f 6e69 746f 7269 6e67  ature monitoring
+0000dd20: 2e22 0a20 2020 2020 2020 2020 2020 2029  .".            )
+0000dd30: 0a0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000dd40: 2073 656c 662e 5f66 6561 7475 7265 5f6d   self._feature_m
+0000dd50: 6f6e 6974 6f72 696e 675f 636f 6e66 6967  onitoring_config
+0000dd60: 5f65 6e67 696e 652e 5f62 7569 6c64 5f64  _engine._build_d
+0000dd70: 6566 6175 6c74 5f66 6561 7475 7265 5f6d  efault_feature_m
+0000dd80: 6f6e 6974 6f72 696e 675f 636f 6e66 6967  onitoring_config
+0000dd90: 280a 2020 2020 2020 2020 2020 2020 6e61  (.            na
+0000dda0: 6d65 3d6e 616d 652c 0a20 2020 2020 2020  me=name,.       
+0000ddb0: 2020 2020 2066 6561 7475 7265 5f6e 616d       feature_nam
+0000ddc0: 653d 6665 6174 7572 655f 6e61 6d65 2c0a  e=feature_name,.
+0000ddd0: 2020 2020 2020 2020 2020 2020 6465 7363              desc
+0000dde0: 7269 7074 696f 6e3d 6465 7363 7269 7074  ription=descript
+0000ddf0: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+0000de00: 2073 7461 7274 5f64 6174 655f 7469 6d65   start_date_time
+0000de10: 3d73 7461 7274 5f64 6174 655f 7469 6d65  =start_date_time
+0000de20: 2c0a 2020 2020 2020 2020 2020 2020 7661  ,.            va
+0000de30: 6c69 645f 6665 6174 7572 655f 6e61 6d65  lid_feature_name
+0000de40: 733d 5b66 6561 742e 6e61 6d65 2066 6f72  s=[feat.name for
+0000de50: 2066 6561 7420 696e 2073 656c 662e 5f66   feat in self._f
+0000de60: 6561 7475 7265 735d 2c0a 2020 2020 2020  eatures],.      
+0000de70: 2020 2020 2020 656e 645f 6461 7465 5f74        end_date_t
+0000de80: 696d 653d 656e 645f 6461 7465 5f74 696d  ime=end_date_tim
+0000de90: 652c 0a20 2020 2020 2020 2020 2020 2063  e,.            c
+0000dea0: 726f 6e5f 6578 7072 6573 7369 6f6e 3d63  ron_expression=c
+0000deb0: 726f 6e5f 6578 7072 6573 7369 6f6e 2c0a  ron_expression,.
+0000dec0: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0000ded0: 6566 205f 5f67 6574 6174 7472 5f5f 2873  ef __getattr__(s
+0000dee0: 656c 662c 206e 616d 6529 3a0a 2020 2020  elf, name):.    
+0000def0: 2020 2020 7472 793a 0a20 2020 2020 2020      try:.       
+0000df00: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0000df10: 2e5f 5f67 6574 6974 656d 5f5f 286e 616d  .__getitem__(nam
+0000df20: 6529 0a20 2020 2020 2020 2065 7863 6570  e).        excep
+0000df30: 7420 4b65 7945 7272 6f72 3a0a 2020 2020  t KeyError:.    
+0000df40: 2020 2020 2020 2020 7261 6973 6520 4174          raise At
+0000df50: 7472 6962 7574 6545 7272 6f72 280a 2020  tributeError(.  
+0000df60: 2020 2020 2020 2020 2020 2020 2020 6622                f"
+0000df70: 2746 6561 7475 7265 4772 6f75 7027 206f  'FeatureGroup' o
+0000df80: 626a 6563 7420 6861 7320 6e6f 2061 7474  bject has no att
+0000df90: 7269 6275 7465 2027 7b6e 616d 657d 272e  ribute '{name}'.
+0000dfa0: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+0000dfb0: 2020 2022 4966 2079 6f75 2061 7265 2074     "If you are t
+0000dfc0: 7279 696e 6720 746f 2061 6363 6573 7320  rying to access 
+0000dfd0: 6120 6665 6174 7572 652c 2066 616c 6c20  a feature, fall 
+0000dfe0: 6261 636b 206f 6e20 220a 2020 2020 2020  back on ".      
+0000dff0: 2020 2020 2020 2020 2020 2275 7369 6e67            "using
+0000e000: 2074 6865 2060 6765 745f 6665 6174 7572   the `get_featur
+0000e010: 6560 206d 6574 686f 642e 220a 2020 2020  e` method.".    
+0000e020: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0000e030: 6566 205f 5f67 6574 6974 656d 5f5f 2873  ef __getitem__(s
+0000e040: 656c 662c 206e 616d 6529 3a0a 2020 2020  elf, name):.    
+0000e050: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0000e060: 7461 6e63 6528 6e61 6d65 2c20 7374 7229  tance(name, str)
+0000e070: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+0000e080: 6973 6520 5479 7065 4572 726f 7228 0a20  ise TypeError(. 
+0000e090: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0000e0a0: 2245 7870 6563 7465 6420 7479 7065 2060  "Expected type `
+0000e0b0: 7374 7260 2c20 676f 7420 607b 7479 7065  str`, got `{type
+0000e0c0: 286e 616d 6529 7d60 2e20 220a 2020 2020  (name)}`. ".    
+0000e0d0: 2020 2020 2020 2020 2020 2020 2246 6561              "Fea
+0000e0e0: 7475 7265 7320 6172 6520 6163 6365 7373  tures are access
+0000e0f0: 6962 6c65 2062 7920 6e61 6d65 2e22 0a20  ible by name.". 
+0000e100: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0000e110: 2020 2020 2066 6561 7475 7265 203d 205b       feature = [
+0000e120: 6620 666f 7220 6620 696e 2073 656c 662e  f for f in self.
+0000e130: 5f5f 6765 7461 7474 7269 6275 7465 5f5f  __getattribute__
+0000e140: 2822 5f66 6561 7475 7265 7322 2920 6966  ("_features") if
+0000e150: 2066 2e6e 616d 6520 3d3d 206e 616d 655d   f.name == name]
+0000e160: 0a20 2020 2020 2020 2069 6620 6c65 6e28  .        if len(
+0000e170: 6665 6174 7572 6529 203d 3d20 313a 0a20  feature) == 1:. 
+0000e180: 2020 2020 2020 2020 2020 2072 6574 7572             retur
+0000e190: 6e20 6665 6174 7572 655b 305d 0a20 2020  n feature[0].   
+0000e1a0: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000e1b0: 2020 2020 2020 2072 6169 7365 204b 6579         raise Key
+0000e1c0: 4572 726f 7228 6622 2746 6561 7475 7265  Error(f"'Feature
+0000e1d0: 4772 6f75 7027 206f 626a 6563 7420 6861  Group' object ha
+0000e1e0: 7320 6e6f 2066 6561 7475 7265 2063 616c  s no feature cal
+0000e1f0: 6c65 6420 277b 6e61 6d65 7d27 2e22 290a  led '{name}'.").
+0000e200: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+0000e210: 2020 2064 6566 2073 7461 7469 7374 6963     def statistic
+0000e220: 735f 636f 6e66 6967 2873 656c 6629 3a0a  s_config(self):.
+0000e230: 2020 2020 2020 2020 2222 2253 7461 7469          """Stati
+0000e240: 7374 6963 7320 636f 6e66 6967 7572 6174  stics configurat
+0000e250: 696f 6e20 6f62 6a65 6374 2064 6566 696e  ion object defin
+0000e260: 696e 6720 7468 6520 7365 7474 696e 6773  ing the settings
+0000e270: 2066 6f72 2073 7461 7469 7374 6963 730a   for statistics.
+0000e280: 2020 2020 2020 2020 636f 6d70 7574 6174          computat
+0000e290: 696f 6e20 6f66 2074 6865 2066 6561 7475  ion of the featu
+0000e2a0: 7265 2067 726f 7570 2e0a 0a20 2020 2020  re group...     
+0000e2b0: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
+0000e2c0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
+0000e2d0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
+0000e2e0: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
+0000e2f0: 7074 696f 6e60 2e0a 2020 2020 2020 2020  ption`..        
+0000e300: 2222 220a 2020 2020 2020 2020 7365 6c66  """.        self
+0000e310: 2e5f 6368 6563 6b5f 7374 6174 6973 7469  ._check_statisti
+0000e320: 6373 5f73 7570 706f 7274 2829 2020 2320  cs_support()  # 
+0000e330: 7261 6973 6573 2061 6e20 6572 726f 7220  raises an error 
+0000e340: 6966 2073 7461 7473 206e 6f74 2073 7570  if stats not sup
+0000e350: 706f 7274 6564 0a20 2020 2020 2020 2072  ported.        r
+0000e360: 6574 7572 6e20 7365 6c66 2e5f 7374 6174  eturn self._stat
+0000e370: 6973 7469 6373 5f63 6f6e 6669 670a 0a20  istics_config.. 
+0000e380: 2020 2040 7374 6174 6973 7469 6373 5f63     @statistics_c
+0000e390: 6f6e 6669 672e 7365 7474 6572 0a20 2020  onfig.setter.   
+0000e3a0: 2064 6566 2073 7461 7469 7374 6963 735f   def statistics_
+0000e3b0: 636f 6e66 6967 2873 656c 662c 2073 7461  config(self, sta
+0000e3c0: 7469 7374 6963 735f 636f 6e66 6967 293a  tistics_config):
+0000e3d0: 0a20 2020 2020 2020 2073 656c 662e 5f63  .        self._c
+0000e3e0: 6865 636b 5f73 7461 7469 7374 6963 735f  heck_statistics_
+0000e3f0: 7375 7070 6f72 7428 2920 2023 2072 6169  support()  # rai
+0000e400: 7365 7320 616e 2065 7272 6f72 2069 6620  ses an error if 
+0000e410: 7374 6174 7320 6e6f 7420 7375 7070 6f72  stats not suppor
+0000e420: 7465 640a 2020 2020 2020 2020 6966 2069  ted.        if i
+0000e430: 7369 6e73 7461 6e63 6528 7374 6174 6973  sinstance(statis
+0000e440: 7469 6373 5f63 6f6e 6669 672c 2053 7461  tics_config, Sta
+0000e450: 7469 7374 6963 7343 6f6e 6669 6729 3a0a  tisticsConfig):.
+0000e460: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e470: 2e5f 7374 6174 6973 7469 6373 5f63 6f6e  ._statistics_con
+0000e480: 6669 6720 3d20 7374 6174 6973 7469 6373  fig = statistics
+0000e490: 5f63 6f6e 6669 670a 2020 2020 2020 2020  _config.        
+0000e4a0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+0000e4b0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+0000e4c0: 672c 2064 6963 7429 3a0a 2020 2020 2020  g, dict):.      
+0000e4d0: 2020 2020 2020 7365 6c66 2e5f 7374 6174        self._stat
+0000e4e0: 6973 7469 6373 5f63 6f6e 6669 6720 3d20  istics_config = 
+0000e4f0: 5374 6174 6973 7469 6373 436f 6e66 6967  StatisticsConfig
+0000e500: 282a 2a73 7461 7469 7374 6963 735f 636f  (**statistics_co
+0000e510: 6e66 6967 290a 2020 2020 2020 2020 656c  nfig).        el
+0000e520: 6966 2069 7369 6e73 7461 6e63 6528 7374  if isinstance(st
+0000e530: 6174 6973 7469 6373 5f63 6f6e 6669 672c  atistics_config,
+0000e540: 2062 6f6f 6c29 3a0a 2020 2020 2020 2020   bool):.        
+0000e550: 2020 2020 7365 6c66 2e5f 7374 6174 6973      self._statis
+0000e560: 7469 6373 5f63 6f6e 6669 6720 3d20 5374  tics_config = St
+0000e570: 6174 6973 7469 6373 436f 6e66 6967 2873  atisticsConfig(s
+0000e580: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
+0000e590: 290a 2020 2020 2020 2020 656c 6966 2073  ).        elif s
+0000e5a0: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
+0000e5b0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
+0000e5c0: 2020 2020 2020 7365 6c66 2e5f 7374 6174        self._stat
+0000e5d0: 6973 7469 6373 5f63 6f6e 6669 6720 3d20  istics_config = 
+0000e5e0: 5374 6174 6973 7469 6373 436f 6e66 6967  StatisticsConfig
+0000e5f0: 2829 0a20 2020 2020 2020 2065 6c73 653a  ().        else:
+0000e600: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000e610: 7365 2054 7970 6545 7272 6f72 280a 2020  se TypeError(.  
+0000e620: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+0000e630: 6865 2061 7267 756d 656e 7420 6073 7461  he argument `sta
+0000e640: 7469 7374 6963 735f 636f 6e66 6967 6020  tistics_config` 
+0000e650: 6861 7320 746f 2062 6520 604e 6f6e 6560  has to be `None`
+0000e660: 206f 6620 7479 7065 2060 5374 6174 6973   of type `Statis
+0000e670: 7469 6373 436f 6e66 6967 2c20 6062 6f6f  ticsConfig, `boo
+0000e680: 6c60 206f 7220 6064 6963 7460 2c20 6275  l` or `dict`, bu
+0000e690: 7420 6973 206f 6620 7479 7065 3a20 607b  t is of type: `{
+0000e6a0: 7d60 222e 666f 726d 6174 280a 2020 2020  }`".format(.    
+0000e6b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e6c0: 7479 7065 2873 7461 7469 7374 6963 735f  type(statistics_
+0000e6d0: 636f 6e66 6967 290a 2020 2020 2020 2020  config).        
+0000e6e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+0000e6f0: 2020 2020 2020 290a 0a20 2020 2040 7072        )..    @pr
+0000e700: 6f70 6572 7479 0a20 2020 2064 6566 2066  operty.    def f
+0000e710: 6561 7475 7265 5f73 746f 7265 5f69 6428  eature_store_id(
+0000e720: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+0000e730: 6574 7572 6e20 7365 6c66 2e5f 6665 6174  eturn self._feat
+0000e740: 7572 655f 7374 6f72 655f 6964 0a0a 2020  ure_store_id..  
+0000e750: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+0000e760: 6465 6620 6665 6174 7572 655f 7374 6f72  def feature_stor
+0000e770: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+0000e780: 2072 6574 7572 6e20 7365 6c66 2e5f 6665   return self._fe
+0000e790: 6174 7572 655f 7374 6f72 650a 0a20 2020  ature_store..   
+0000e7a0: 2040 6665 6174 7572 655f 7374 6f72 652e   @feature_store.
+0000e7b0: 7365 7474 6572 0a20 2020 2064 6566 2066  setter.    def f
+0000e7c0: 6561 7475 7265 5f73 746f 7265 2873 656c  eature_store(sel
+0000e7d0: 662c 2066 6561 7475 7265 5f73 746f 7265  f, feature_store
+0000e7e0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
+0000e7f0: 5f66 6561 7475 7265 5f73 746f 7265 203d  _feature_store =
+0000e800: 2066 6561 7475 7265 5f73 746f 7265 0a0a   feature_store..
+0000e810: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+0000e820: 2020 6465 6620 6e61 6d65 2873 656c 6629    def name(self)
+0000e830: 3a0a 2020 2020 2020 2020 2222 224e 616d  :.        """Nam
+0000e840: 6520 6f66 2074 6865 2066 6561 7475 7265  e of the feature
+0000e850: 2067 726f 7570 2e22 2222 0a20 2020 2020   group.""".     
+0000e860: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0000e870: 6e61 6d65 0a0a 2020 2020 4070 726f 7065  name..    @prope
+0000e880: 7274 790a 2020 2020 6465 6620 7665 7273  rty.    def vers
+0000e890: 696f 6e28 7365 6c66 293a 0a20 2020 2020  ion(self):.     
+0000e8a0: 2020 2022 2222 5665 7273 696f 6e20 6e75     """Version nu
+0000e8b0: 6d62 6572 206f 6620 7468 6520 6665 6174  mber of the feat
+0000e8c0: 7572 6520 6772 6f75 702e 2222 220a 2020  ure group.""".  
+0000e8d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000e8e0: 662e 5f76 6572 7369 6f6e 0a0a 2020 2020  f._version..    
+0000e8f0: 4076 6572 7369 6f6e 2e73 6574 7465 720a  @version.setter.
+0000e900: 2020 2020 6465 6620 7665 7273 696f 6e28      def version(
+0000e910: 7365 6c66 2c20 7665 7273 696f 6e29 3a0a  self, version):.
+0000e920: 2020 2020 2020 2020 7365 6c66 2e5f 7665          self._ve
+0000e930: 7273 696f 6e20 3d20 7665 7273 696f 6e0a  rsion = version.
+0000e940: 0a20 2020 2064 6566 2067 6574 5f66 675f  .    def get_fg_
+0000e950: 6e61 6d65 2873 656c 6629 3a0a 2020 2020  name(self):.    
+0000e960: 2020 2020 7265 7475 726e 2066 227b 7365      return f"{se
+0000e970: 6c66 2e6e 616d 657d 5f7b 7365 6c66 2e76  lf.name}_{self.v
+0000e980: 6572 7369 6f6e 7d22 0a0a 2020 2020 4070  ersion}"..    @p
+0000e990: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+0000e9a0: 7374 6174 6973 7469 6373 2873 656c 6629  statistics(self)
+0000e9b0: 3a0a 2020 2020 2020 2020 2222 2247 6574  :.        """Get
+0000e9c0: 2074 6865 206c 6174 6573 7420 636f 6d70   the latest comp
+0000e9d0: 7574 6564 2073 7461 7469 7374 6963 7320  uted statistics 
+0000e9e0: 666f 7220 7468 6520 7768 6f6c 6520 6665  for the whole fe
+0000e9f0: 6174 7572 6520 6772 6f75 702e 0a0a 2020  ature group...  
+0000ea00: 2020 2020 2020 2320 5261 6973 6573 0a20        # Raises. 
+0000ea10: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
+0000ea20: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
+0000ea30: 6e73 2e46 6561 7475 7265 5374 6f72 6545  ns.FeatureStoreE
+0000ea40: 7863 6570 7469 6f6e 602e 0a20 2020 2020  xception`..     
+0000ea50: 2020 2022 2222 0a20 2020 2020 2020 2073     """.        s
+0000ea60: 656c 662e 5f63 6865 636b 5f73 7461 7469  elf._check_stati
+0000ea70: 7374 6963 735f 7375 7070 6f72 7428 2920  stics_support() 
+0000ea80: 2023 2072 6169 7365 7320 616e 2065 7272   # raises an err
+0000ea90: 6f72 2069 6620 7374 6174 7320 6e6f 7420  or if stats not 
+0000eaa0: 7375 7070 6f72 7465 640a 2020 2020 2020  supported.      
+0000eab0: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
+0000eac0: 7461 7469 7374 6963 735f 656e 6769 6e65  tatistics_engine
+0000ead0: 2e67 6574 2873 656c 6629 0a0a 2020 2020  .get(self)..    
+0000eae0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+0000eaf0: 6620 7072 696d 6172 795f 6b65 7928 7365  f primary_key(se
+0000eb00: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+0000eb10: 4c69 7374 206f 6620 6665 6174 7572 6573  List of features
+0000eb20: 2062 7569 6c64 696e 6720 7468 6520 7072   building the pr
+0000eb30: 696d 6172 7920 6b65 792e 2222 220a 2020  imary key.""".  
+0000eb40: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000eb50: 662e 5f70 7269 6d61 7279 5f6b 6579 0a0a  f._primary_key..
+0000eb60: 2020 2020 4070 7269 6d61 7279 5f6b 6579      @primary_key
+0000eb70: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+0000eb80: 7072 696d 6172 795f 6b65 7928 7365 6c66  primary_key(self
+0000eb90: 2c20 6e65 775f 7072 696d 6172 795f 6b65  , new_primary_ke
+0000eba0: 793a 204c 6973 745b 7374 725d 2920 2d3e  y: List[str]) ->
+0000ebb0: 204e 6f6e 653a 0a20 2020 2020 2020 2073   None:.        s
+0000ebc0: 656c 662e 5f70 7269 6d61 7279 5f6b 6579  elf._primary_key
+0000ebd0: 203d 205b 7574 696c 2e61 7574 6f66 6978   = [util.autofix
+0000ebe0: 5f66 6561 7475 7265 5f6e 616d 6528 706b  _feature_name(pk
+0000ebf0: 2920 666f 7220 706b 2069 6e20 6e65 775f  ) for pk in new_
+0000ec00: 7072 696d 6172 795f 6b65 795d 0a0a 2020  primary_key]..  
+0000ec10: 2020 6465 6620 6765 745f 7374 6174 6973    def get_statis
+0000ec20: 7469 6373 280a 2020 2020 2020 2020 7365  tics(.        se
+0000ec30: 6c66 2c0a 2020 2020 2020 2020 636f 6d70  lf,.        comp
+0000ec40: 7574 6174 696f 6e5f 7469 6d65 3a20 4f70  utation_time: Op
+0000ec50: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
+0000ec60: 2c20 696e 742c 2066 6c6f 6174 2c20 6461  , int, float, da
+0000ec70: 7465 7469 6d65 2c20 6461 7465 5d5d 203d  tetime, date]] =
+0000ec80: 204e 6f6e 652c 0a20 2020 2020 2020 2066   None,.        f
+0000ec90: 6561 7475 7265 5f6e 616d 6573 3a20 4f70  eature_names: Op
+0000eca0: 7469 6f6e 616c 5b4c 6973 745b 7374 725d  tional[List[str]
+0000ecb0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2920  ] = None,.    ) 
+0000ecc0: 2d3e 204f 7074 696f 6e61 6c5b 5374 6174  -> Optional[Stat
+0000ecd0: 6973 7469 6373 5d3a 0a20 2020 2020 2020  istics]:.       
+0000ece0: 2022 2222 5265 7475 726e 7320 7468 6520   """Returns the 
+0000ecf0: 7374 6174 6973 7469 6373 2063 6f6d 7075  statistics compu
+0000ed00: 7465 6420 6174 2061 2073 7065 6369 6669  ted at a specifi
+0000ed10: 6320 7469 6d65 2066 6f72 2074 6865 2063  c time for the c
+0000ed20: 7572 7265 6e74 2066 6561 7475 7265 2067  urrent feature g
+0000ed30: 726f 7570 2e0a 0a20 2020 2020 2020 2049  roup...        I
+0000ed40: 6620 6063 6f6d 7075 7461 7469 6f6e 5f74  f `computation_t
+0000ed50: 696d 6560 2069 7320 604e 6f6e 6560 2c20  ime` is `None`, 
+0000ed60: 7468 6520 6d6f 7374 2072 6563 656e 7420  the most recent 
+0000ed70: 7374 6174 6973 7469 6373 2061 7265 2072  statistics are r
+0000ed80: 6574 7572 6e65 642e 0a0a 2020 2020 2020  eturned...      
+0000ed90: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
+0000eda0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+0000edb0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+0000edc0: 2320 636f 6e6e 6563 7420 746f 2074 6865  # connect to the
+0000edd0: 2046 6561 7475 7265 2053 746f 7265 0a20   Feature Store. 
+0000ede0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
+0000edf0: 2e2e 2e0a 0a20 2020 2020 2020 2020 2020  .....           
+0000ee00: 2023 2067 6574 2074 6865 2046 6561 7475   # get the Featu
+0000ee10: 7265 2047 726f 7570 2069 6e73 7461 6e63  re Group instanc
+0000ee20: 650a 2020 2020 2020 2020 2020 2020 6667  e.            fg
+0000ee30: 203d 2066 732e 6765 745f 6f72 5f63 7265   = fs.get_or_cre
+0000ee40: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
+0000ee50: 7028 2e2e 2e29 0a0a 2020 2020 2020 2020  p(...)..        
+0000ee60: 2020 2020 6667 5f73 7461 7469 7374 6963      fg_statistic
+0000ee70: 7320 3d20 6667 2e67 6574 5f73 7461 7469  s = fg.get_stati
+0000ee80: 7374 6963 7328 636f 6d70 7574 6174 696f  stics(computatio
+0000ee90: 6e5f 7469 6d65 3d4e 6f6e 6529 0a20 2020  n_time=None).   
+0000eea0: 2020 2020 2020 2020 2060 6060 0a0a 2020           ```..  
+0000eeb0: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+0000eec0: 730a 2020 2020 2020 2020 2020 2020 636f  s.            co
+0000eed0: 6d70 7574 6174 696f 6e5f 7469 6d65 3a20  mputation_time: 
+0000eee0: 4461 7465 2061 6e64 2074 696d 6520 7768  Date and time wh
+0000eef0: 656e 2073 7461 7469 7374 6963 7320 7765  en statistics we
+0000ef00: 7265 2063 6f6d 7075 7465 642e 2044 6566  re computed. Def
+0000ef10: 6175 6c74 7320 746f 2060 4e6f 6e65 602e  aults to `None`.
+0000ef20: 2053 7472 696e 6773 2073 686f 756c 640a   Strings should.
+0000ef30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000ef40: 6265 2066 6f72 6d61 7474 6564 2069 6e20  be formatted in 
+0000ef50: 6f6e 6520 6f66 2074 6865 2066 6f6c 6c6f  one of the follo
+0000ef60: 7769 6e67 2066 6f72 6d61 7473 2060 2559  wing formats `%Y
+0000ef70: 2d25 6d2d 2564 602c 2060 2559 2d25 6d2d  -%m-%d`, `%Y-%m-
+0000ef80: 2564 2025 4860 2c20 6025 592d 256d 2d25  %d %H`, `%Y-%m-%
+0000ef90: 6420 2548 3a25 4d60 2c20 6025 592d 256d  d %H:%M`, `%Y-%m
+0000efa0: 2d25 6420 2548 3a25 4d3a 2553 602c 0a20  -%d %H:%M:%S`,. 
+0000efb0: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+0000efc0: 7220 6025 592d 256d 2d25 6420 2548 3a25  r `%Y-%m-%d %H:%
+0000efd0: 4d3a 2553 2e25 6660 2e0a 2020 2020 2020  M:%S.%f`..      
+0000efe0: 2020 2020 2020 6665 6174 7572 655f 6e61        feature_na
+0000eff0: 6d65 733a 204c 6973 7420 6f66 2066 6561  mes: List of fea
+0000f000: 7475 7265 206e 616d 6573 206f 6620 7768  ture names of wh
+0000f010: 6963 6820 7374 6174 6973 7469 6373 2061  ich statistics a
+0000f020: 7265 2072 6574 7269 6576 6564 2e0a 2020  re retrieved..  
+0000f030: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
+0000f040: 2020 2020 2020 2020 2020 2020 6053 7461              `Sta
+0000f050: 7469 7374 6963 7360 2e20 5374 6174 6973  tistics`. Statis
+0000f060: 7469 6373 206f 626a 6563 742e 0a0a 2020  tics object...  
+0000f070: 2020 2020 2020 2320 5261 6973 6573 0a20        # Raises. 
+0000f080: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
+0000f090: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
+0000f0a0: 6e73 2e52 6573 7441 5049 4572 726f 7260  ns.RestAPIError`
+0000f0b0: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
+0000f0c0: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
+0000f0d0: 696f 6e73 2e46 6561 7475 7265 5374 6f72  ions.FeatureStor
+0000f0e0: 6545 7863 6570 7469 6f6e 602e 0a20 2020  eException`..   
+0000f0f0: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
+0000f100: 2073 656c 662e 5f63 6865 636b 5f73 7461   self._check_sta
+0000f110: 7469 7374 6963 735f 7375 7070 6f72 7428  tistics_support(
+0000f120: 2920 2023 2072 6169 7365 7320 616e 2065  )  # raises an e
+0000f130: 7272 6f72 2069 6620 7374 6174 7320 6e6f  rror if stats no
+0000f140: 7420 7375 7070 6f72 7465 640a 2020 2020  t supported.    
+0000f150: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+0000f160: 5f73 7461 7469 7374 6963 735f 656e 6769  _statistics_engi
+0000f170: 6e65 2e67 6574 280a 2020 2020 2020 2020  ne.get(.        
+0000f180: 2020 2020 7365 6c66 2c20 636f 6d70 7574      self, comput
+0000f190: 6174 696f 6e5f 7469 6d65 3d63 6f6d 7075  ation_time=compu
+0000f1a0: 7461 7469 6f6e 5f74 696d 652c 2066 6561  tation_time, fea
+0000f1b0: 7475 7265 5f6e 616d 6573 3d66 6561 7475  ture_names=featu
+0000f1c0: 7265 5f6e 616d 6573 0a20 2020 2020 2020  re_names.       
+0000f1d0: 2029 0a0a 2020 2020 6465 6620 6765 745f   )..    def get_
+0000f1e0: 616c 6c5f 7374 6174 6973 7469 6373 280a  all_statistics(.
+0000f1f0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+0000f200: 2020 2020 2020 636f 6d70 7574 6174 696f        computatio
+0000f210: 6e5f 7469 6d65 3a20 4f70 7469 6f6e 616c  n_time: Optional
+0000f220: 5b55 6e69 6f6e 5b73 7472 2c20 696e 742c  [Union[str, int,
+0000f230: 2066 6c6f 6174 2c20 6461 7465 7469 6d65   float, datetime
+0000f240: 2c20 6461 7465 5d5d 203d 204e 6f6e 652c  , date]] = None,
+0000f250: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+0000f260: 5f6e 616d 6573 3a20 4f70 7469 6f6e 616c  _names: Optional
+0000f270: 5b4c 6973 745b 7374 725d 5d20 3d20 4e6f  [List[str]] = No
+0000f280: 6e65 2c0a 2020 2020 2920 2d3e 204f 7074  ne,.    ) -> Opt
+0000f290: 696f 6e61 6c5b 4c69 7374 5b53 7461 7469  ional[List[Stati
+0000f2a0: 7374 6963 735d 5d3a 0a20 2020 2020 2020  stics]]:.       
+0000f2b0: 2022 2222 5265 7475 726e 7320 616c 6c20   """Returns all 
+0000f2c0: 7468 6520 7374 6174 6973 7469 6373 206d  the statistics m
+0000f2d0: 6574 6164 6174 6120 636f 6d70 7574 6564  etadata computed
+0000f2e0: 2062 6566 6f72 6520 6120 7370 6563 6966   before a specif
+0000f2f0: 6963 2074 696d 6520 666f 7220 7468 6520  ic time for the 
+0000f300: 6375 7272 656e 7420 6665 6174 7572 6520  current feature 
+0000f310: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+0000f320: 4966 2060 636f 6d70 7574 6174 696f 6e5f  If `computation_
+0000f330: 7469 6d65 6020 6973 2060 4e6f 6e65 602c  time` is `None`,
+0000f340: 2061 6c6c 2074 6865 2073 7461 7469 7374   all the statist
+0000f350: 6963 7320 6d65 7461 6461 7461 2061 7265  ics metadata are
+0000f360: 2072 6574 7572 6e65 642e 0a0a 2020 2020   returned...    
+0000f370: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
+0000f380: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
+0000f390: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
+0000f3a0: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
+0000f3b0: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
+0000f3c0: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
+0000f3d0: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
+0000f3e0: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
+0000f3f0: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
+0000f400: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
+0000f410: 6667 203d 2066 732e 6765 745f 6f72 5f63  fg = fs.get_or_c
+0000f420: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
+0000f430: 6f75 7028 2e2e 2e29 0a0a 2020 2020 2020  oup(...)..      
+0000f440: 2020 2020 2020 6667 5f73 7461 7469 7374        fg_statist
+0000f450: 6963 7320 3d20 6667 2e67 6574 5f73 7461  ics = fg.get_sta
+0000f460: 7469 7374 6963 7328 636f 6d70 7574 6174  tistics(computat
+0000f470: 696f 6e5f 7469 6d65 3d4e 6f6e 6529 0a20  ion_time=None). 
+0000f480: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+0000f490: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+0000f4a0: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+0000f4b0: 636f 6d70 7574 6174 696f 6e5f 7469 6d65  computation_time
+0000f4c0: 3a20 4461 7465 2061 6e64 2074 696d 6520  : Date and time 
+0000f4d0: 7768 656e 2073 7461 7469 7374 6963 7320  when statistics 
+0000f4e0: 7765 7265 2063 6f6d 7075 7465 642e 2044  were computed. D
+0000f4f0: 6566 6175 6c74 7320 746f 2060 4e6f 6e65  efaults to `None
+0000f500: 602e 2053 7472 696e 6773 2073 686f 756c  `. Strings shoul
+0000f510: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0000f520: 2020 6265 2066 6f72 6d61 7474 6564 2069    be formatted i
+0000f530: 6e20 6f6e 6520 6f66 2074 6865 2066 6f6c  n one of the fol
+0000f540: 6c6f 7769 6e67 2066 6f72 6d61 7473 2060  lowing formats `
+0000f550: 2559 2d25 6d2d 2564 602c 2060 2559 2d25  %Y-%m-%d`, `%Y-%
+0000f560: 6d2d 2564 2025 4860 2c20 6025 592d 256d  m-%d %H`, `%Y-%m
+0000f570: 2d25 6420 2548 3a25 4d60 2c20 6025 592d  -%d %H:%M`, `%Y-
+0000f580: 256d 2d25 6420 2548 3a25 4d3a 2553 602c  %m-%d %H:%M:%S`,
+0000f590: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000f5a0: 206f 7220 6025 592d 256d 2d25 6420 2548   or `%Y-%m-%d %H
+0000f5b0: 3a25 4d3a 2553 2e25 6660 2e0a 2020 2020  :%M:%S.%f`..    
+0000f5c0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+0000f5d0: 6e61 6d65 733a 204c 6973 7420 6f66 2066  names: List of f
+0000f5e0: 6561 7475 7265 206e 616d 6573 206f 6620  eature names of 
+0000f5f0: 7768 6963 6820 7374 6174 6973 7469 6373  which statistics
+0000f600: 2061 7265 2072 6574 7269 6576 6564 2e0a   are retrieved..
+0000f610: 2020 2020 2020 2020 2320 5265 7475 726e          # Return
+0000f620: 730a 2020 2020 2020 2020 2020 2020 6053  s.            `S
+0000f630: 7461 7469 7374 6963 7360 2e20 5374 6174  tatistics`. Stat
+0000f640: 6973 7469 6373 206f 626a 6563 742e 0a0a  istics object...
+0000f650: 2020 2020 2020 2020 2320 5261 6973 6573          # Raises
+0000f660: 0a20 2020 2020 2020 2020 2020 2060 6873  .            `hs
+0000f670: 6673 2e63 6c69 656e 742e 6578 6365 7074  fs.client.except
+0000f680: 696f 6e73 2e52 6573 7441 5049 4572 726f  ions.RestAPIErro
+0000f690: 7260 0a20 2020 2020 2020 2020 2020 2060  r`.            `
+0000f6a0: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
+0000f6b0: 7074 696f 6e73 2e46 6561 7475 7265 5374  ptions.FeatureSt
+0000f6c0: 6f72 6545 7863 6570 7469 6f6e 602e 0a20  oreException`.. 
+0000f6d0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+0000f6e0: 2020 2073 656c 662e 5f63 6865 636b 5f73     self._check_s
+0000f6f0: 7461 7469 7374 6963 735f 7375 7070 6f72  tatistics_suppor
+0000f700: 7428 2920 2023 2072 6169 7365 7320 616e  t()  # raises an
+0000f710: 2065 7272 6f72 2069 6620 7374 6174 7320   error if stats 
+0000f720: 6e6f 7420 7375 7070 6f72 7465 640a 2020  not supported.  
+0000f730: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+0000f740: 662e 5f73 7461 7469 7374 6963 735f 656e  f._statistics_en
+0000f750: 6769 6e65 2e67 6574 5f61 6c6c 280a 2020  gine.get_all(.  
+0000f760: 2020 2020 2020 2020 2020 7365 6c66 2c20            self, 
+0000f770: 636f 6d70 7574 6174 696f 6e5f 7469 6d65  computation_time
+0000f780: 3d63 6f6d 7075 7461 7469 6f6e 5f74 696d  =computation_tim
+0000f790: 652c 2066 6561 7475 7265 5f6e 616d 6573  e, feature_names
+0000f7a0: 3d66 6561 7475 7265 5f6e 616d 6573 0a20  =feature_names. 
+0000f7b0: 2020 2020 2020 2029 0a0a 2020 2020 6465         )..    de
+0000f7c0: 6620 636f 6d70 7574 655f 7374 6174 6973  f compute_statis
+0000f7d0: 7469 6373 2873 656c 6629 3a0a 2020 2020  tics(self):.    
+0000f7e0: 2020 2020 2222 2252 6563 6f6d 7075 7465      """Recompute
+0000f7f0: 2074 6865 2073 7461 7469 7374 6963 7320   the statistics 
+0000f800: 666f 7220 7468 6520 6665 6174 7572 6520  for the feature 
+0000f810: 6772 6f75 7020 616e 6420 7361 7665 2074  group and save t
+0000f820: 6865 6d20 746f 2074 6865 0a20 2020 2020  hem to the.     
+0000f830: 2020 2066 6561 7475 7265 2073 746f 7265     feature store
+0000f840: 2e0a 2020 2020 2020 2020 5374 6174 6973  ..        Statis
+0000f850: 7469 6373 2061 7265 206f 6e6c 7920 636f  tics are only co
+0000f860: 6d70 7574 6564 2066 6f72 2064 6174 6120  mputed for data 
+0000f870: 696e 2074 6865 206f 6666 6c69 6e65 2073  in the offline s
+0000f880: 746f 7261 6765 206f 6620 7468 6520 6665  torage of the fe
+0000f890: 6174 7572 650a 2020 2020 2020 2020 6772  ature.        gr
+0000f8a0: 6f75 702e 0a0a 2020 2020 2020 2020 2121  oup...        !!
+0000f8b0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
+0000f8c0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+0000f8d0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+0000f8e0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+0000f8f0: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+0000f900: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+0000f910: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+0000f920: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+0000f930: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+0000f940: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+0000f950: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+0000f960: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+0000f970: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
+0000f980: 7374 6174 6973 7469 6373 5f6d 6574 6164  statistics_metad
+0000f990: 6174 6120 3d20 6667 2e63 6f6d 7075 7465  ata = fg.compute
+0000f9a0: 5f73 7461 7469 7374 6963 7328 290a 2020  _statistics().  
+0000f9b0: 2020 2020 2020 2020 2020 6060 600a 0a20            ```.. 
+0000f9c0: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
+0000f9d0: 0a20 2020 2020 2020 2020 2020 2060 5374  .            `St
+0000f9e0: 6174 6973 7469 6373 602e 2054 6865 2073  atistics`. The s
+0000f9f0: 7461 7469 7374 6963 7320 6d65 7461 6461  tatistics metada
+0000fa00: 7461 206f 626a 6563 742e 0a0a 2020 2020  ta object...    
+0000fa10: 2020 2020 2320 5261 6973 6573 0a20 2020      # Raises.   
+0000fa20: 2020 2020 2020 2020 2060 6873 6673 2e63           `hsfs.c
+0000fa30: 6c69 656e 742e 6578 6365 7074 696f 6e73  lient.exceptions
+0000fa40: 2e52 6573 7441 5049 4572 726f 7260 2e20  .RestAPIError`. 
+0000fa50: 556e 6162 6c65 2074 6f20 7065 7273 6973  Unable to persis
+0000fa60: 7420 7468 6520 7374 6174 6973 7469 6373  t the statistics
+0000fa70: 2e0a 2020 2020 2020 2020 2020 2020 6068  ..            `h
+0000fa80: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+0000fa90: 7469 6f6e 732e 4665 6174 7572 6553 746f  tions.FeatureSto
+0000faa0: 7265 4578 6365 7074 696f 6e60 2e0a 2020  reException`..  
+0000fab0: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0000fac0: 2020 7365 6c66 2e5f 6368 6563 6b5f 7374    self._check_st
+0000fad0: 6174 6973 7469 6373 5f73 7570 706f 7274  atistics_support
+0000fae0: 2829 2020 2320 7261 6973 6573 2061 6e20  ()  # raises an 
+0000faf0: 6572 726f 7220 6966 2073 7461 7473 206e  error if stats n
+0000fb00: 6f74 2073 7570 706f 7274 6564 0a20 2020  ot supported.   
+0000fb10: 2020 2020 2069 6620 7365 6c66 2e73 7461       if self.sta
+0000fb20: 7469 7374 6963 735f 636f 6e66 6967 2e65  tistics_config.e
+0000fb30: 6e61 626c 6564 3a0a 2020 2020 2020 2020  nabled:.        
+0000fb40: 2020 2020 2320 446f 6e27 7420 7265 6164      # Don't read
+0000fb50: 2074 6865 2064 6174 6166 7261 6d65 2068   the dataframe h
+0000fb60: 6572 652c 2074 6f20 6176 6f69 6420 7472  ere, to avoid tr
+0000fb70: 6967 6765 7269 6e67 2061 2072 6561 6420  iggering a read 
+0000fb80: 6f70 6572 6174 696f 6e0a 2020 2020 2020  operation.      
+0000fb90: 2020 2020 2020 2320 666f 7220 7468 6520        # for the 
+0000fba0: 5079 7468 6f6e 2065 6e67 696e 652e 2054  Python engine. T
+0000fbb0: 6865 2050 7974 686f 6e20 656e 6769 6e65  he Python engine
+0000fbc0: 2069 7320 676f 696e 6720 746f 2073 6574   is going to set
+0000fbd0: 7570 2061 2053 7061 726b 204a 6f62 0a20  up a Spark Job. 
+0000fbe0: 2020 2020 2020 2020 2020 2023 2074 6f20             # to 
+0000fbf0: 7570 6461 7465 2074 6865 2073 7461 7469  update the stati
+0000fc00: 7374 6963 732e 0a20 2020 2020 2020 2020  stics..         
+0000fc10: 2020 2073 656c 662e 5f73 7461 7469 7374     self._statist
+0000fc20: 6963 735f 656e 6769 6e65 2e63 6f6d 7075  ics_engine.compu
+0000fc30: 7465 5f61 6e64 5f73 6176 655f 7374 6174  te_and_save_stat
+0000fc40: 6973 7469 6373 2873 656c 6629 0a20 2020  istics(self).   
+0000fc50: 2020 2020 2065 6c73 653a 0a20 2020 2020       else:.     
+0000fc60: 2020 2020 2020 2077 6172 6e69 6e67 732e         warnings.
+0000fc70: 7761 726e 280a 2020 2020 2020 2020 2020  warn(.          
+0000fc80: 2020 2020 2020 280a 2020 2020 2020 2020        (.        
+0000fc90: 2020 2020 2020 2020 2020 2020 2254 6865              "The
+0000fca0: 2073 7461 7469 7374 6963 7320 6172 6520   statistics are 
+0000fcb0: 6e6f 7420 656e 6162 6c65 6420 6f66 2066  not enabled of f
+0000fcc0: 6561 7475 7265 2067 726f 7570 2060 7b7d  eature group `{}
+0000fcd0: 602c 2077 6974 6820 7665 7273 696f 6e22  `, with version"
+0000fce0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000fcf0: 2020 2020 2022 2060 7b7d 602e 204e 6f20       " `{}`. No 
+0000fd00: 7374 6174 6973 7469 6373 2063 6f6d 7075  statistics compu
+0000fd10: 7465 642e 220a 2020 2020 2020 2020 2020  ted.".          
+0000fd20: 2020 2020 2020 292e 666f 726d 6174 2873        ).format(s
+0000fd30: 656c 662e 5f6e 616d 652c 2073 656c 662e  elf._name, self.
+0000fd40: 5f76 6572 7369 6f6e 292c 0a20 2020 2020  _version),.     
+0000fd50: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
+0000fd60: 5374 6f72 6167 6557 6172 6e69 6e67 2c0a  StorageWarning,.
+0000fd70: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+0000fd80: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+0000fd90: 2064 6566 2065 6d62 6564 6469 6e67 5f69   def embedding_i
+0000fda0: 6e64 6578 2873 656c 6629 3a0a 2020 2020  ndex(self):.    
+0000fdb0: 2020 2020 6966 2073 656c 662e 5f65 6d62      if self._emb
+0000fdc0: 6564 6469 6e67 5f69 6e64 6578 3a0a 2020  edding_index:.  
+0000fdd0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+0000fde0: 656d 6265 6464 696e 675f 696e 6465 782e  embedding_index.
+0000fdf0: 6665 6174 7572 655f 6772 6f75 7020 3d20  feature_group = 
+0000fe00: 7365 6c66 0a20 2020 2020 2020 2072 6574  self.        ret
+0000fe10: 7572 6e20 7365 6c66 2e5f 656d 6265 6464  urn self._embedd
+0000fe20: 696e 675f 696e 6465 780a 0a20 2020 2040  ing_index..    @
+0000fe30: 656d 6265 6464 696e 675f 696e 6465 782e  embedding_index.
+0000fe40: 7365 7474 6572 0a20 2020 2064 6566 2065  setter.    def e
+0000fe50: 6d62 6564 6469 6e67 5f69 6e64 6578 2873  mbedding_index(s
+0000fe60: 656c 662c 2065 6d62 6564 6469 6e67 5f69  elf, embedding_i
+0000fe70: 6e64 6578 293a 0a20 2020 2020 2020 2073  ndex):.        s
+0000fe80: 656c 662e 5f65 6d62 6564 6469 6e67 5f69  elf._embedding_i
+0000fe90: 6e64 6578 203d 2065 6d62 6564 6469 6e67  ndex = embedding
+0000fea0: 5f69 6e64 6578 0a0a 2020 2020 4070 726f  _index..    @pro
+0000feb0: 7065 7274 790a 2020 2020 6465 6620 6576  perty.    def ev
+0000fec0: 656e 745f 7469 6d65 2873 656c 6629 3a0a  ent_time(self):.
+0000fed0: 2020 2020 2020 2020 2222 2245 7665 6e74          """Event
+0000fee0: 2074 696d 6520 6665 6174 7572 6520 696e   time feature in
+0000fef0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+0000ff00: 7570 2e22 2222 0a20 2020 2020 2020 2072  up.""".        r
+0000ff10: 6574 7572 6e20 7365 6c66 2e5f 6576 656e  eturn self._even
+0000ff20: 745f 7469 6d65 0a0a 2020 2020 4065 7665  t_time..    @eve
+0000ff30: 6e74 5f74 696d 652e 7365 7474 6572 0a20  nt_time.setter. 
+0000ff40: 2020 2064 6566 2065 7665 6e74 5f74 696d     def event_tim
+0000ff50: 6528 7365 6c66 2c20 6665 6174 7572 655f  e(self, feature_
+0000ff60: 6e61 6d65 3a20 4f70 7469 6f6e 616c 5b73  name: Optional[s
+0000ff70: 7472 5d29 3a0a 2020 2020 2020 2020 6966  tr]):.        if
+0000ff80: 2066 6561 7475 7265 5f6e 616d 6520 6973   feature_name is
+0000ff90: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
+0000ffa0: 2020 2073 656c 662e 5f65 7665 6e74 5f74     self._event_t
+0000ffb0: 696d 6520 3d20 4e6f 6e65 0a20 2020 2020  ime = None.     
+0000ffc0: 2020 2020 2020 2072 6574 7572 6e0a 2020         return.  
+0000ffd0: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+0000ffe0: 7461 6e63 6528 6665 6174 7572 655f 6e61  tance(feature_na
+0000fff0: 6d65 2c20 7374 7229 3a0a 2020 2020 2020  me, str):.      
+00010000: 2020 2020 2020 7365 6c66 2e5f 6576 656e        self._even
+00010010: 745f 7469 6d65 203d 2066 6561 7475 7265  t_time = feature
+00010020: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
+00010030: 2020 7265 7475 726e 0a20 2020 2020 2020    return.       
+00010040: 2065 6c69 6620 6973 696e 7374 616e 6365   elif isinstance
+00010050: 2866 6561 7475 7265 5f6e 616d 652c 206c  (feature_name, l
+00010060: 6973 7429 2061 6e64 206c 656e 2866 6561  ist) and len(fea
+00010070: 7475 7265 5f6e 616d 6529 203d 3d20 313a  ture_name) == 1:
+00010080: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00010090: 6973 696e 7374 616e 6365 2866 6561 7475  isinstance(featu
+000100a0: 7265 5f6e 616d 655b 305d 2c20 7374 7229  re_name[0], str)
+000100b0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+000100c0: 2020 7761 726e 696e 6773 2e77 6172 6e28    warnings.warn(
+000100d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000100e0: 2020 2020 2022 5072 6f76 6964 696e 6720       "Providing 
+000100f0: 6576 656e 745f 7469 6d65 2061 7320 6120  event_time as a 
+00010100: 7369 6e67 6c65 2d65 6c65 6d65 6e74 206c  single-element l
+00010110: 6973 7420 6973 2064 6570 7265 6361 7465  ist is deprecate
+00010120: 6422 0a20 2020 2020 2020 2020 2020 2020  d".             
+00010130: 2020 2020 2020 202b 2022 2061 6e64 2077         + " and w
+00010140: 696c 6c20 6265 2064 726f 7070 6564 2069  ill be dropped i
+00010150: 6e20 6675 7475 7265 2076 6572 7369 6f6e  n future version
+00010160: 732e 2050 726f 7669 6465 2074 6865 2066  s. Provide the f
+00010170: 6561 7475 7265 5f6e 616d 6520 7374 7269  eature_name stri
+00010180: 6e67 2069 6e73 7465 6164 2e22 2c0a 2020  ng instead.",.  
+00010190: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000101a0: 2020 4465 7072 6563 6174 696f 6e57 6172    DeprecationWar
+000101b0: 6e69 6e67 2c0a 2020 2020 2020 2020 2020  ning,.          
+000101c0: 2020 2020 2020 2020 2020 7374 6163 6b6c            stackl
+000101d0: 6576 656c 3d32 2c0a 2020 2020 2020 2020  evel=2,.        
+000101e0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+000101f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00010200: 6576 656e 745f 7469 6d65 203d 2066 6561  event_time = fea
+00010210: 7475 7265 5f6e 616d 655b 305d 0a20 2020  ture_name[0].   
+00010220: 2020 2020 2020 2020 2020 2020 2072 6574               ret
+00010230: 7572 6e0a 0a20 2020 2020 2020 2072 6169  urn..        rai
+00010240: 7365 2056 616c 7565 4572 726f 7228 0a20  se ValueError(. 
+00010250: 2020 2020 2020 2020 2020 2022 6576 656e             "even
+00010260: 745f 7469 6d65 206d 7573 7420 6265 2061  t_time must be a
+00010270: 2073 7472 696e 6720 636f 7272 6573 706f   string correspo
+00010280: 6e64 696e 6720 746f 2061 6e20 6578 6973  nding to an exis
+00010290: 7469 6e67 2066 6561 7475 7265 206e 616d  ting feature nam
+000102a0: 6520 6f66 2074 6865 2046 6561 7475 7265  e of the Feature
+000102b0: 2047 726f 7570 2e22 0a20 2020 2020 2020   Group.".       
+000102c0: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
+000102d0: 790a 2020 2020 6465 6620 6c6f 6361 7469  y.    def locati
+000102e0: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
+000102f0: 2020 7265 7475 726e 2073 656c 662e 5f6c    return self._l
+00010300: 6f63 6174 696f 6e0a 0a20 2020 2040 7072  ocation..    @pr
+00010310: 6f70 6572 7479 0a20 2020 2064 6566 2065  operty.    def e
+00010320: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+00010330: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+00010340: 2020 2020 2920 2d3e 204f 7074 696f 6e61      ) -> Optiona
+00010350: 6c5b 4578 7065 6374 6174 696f 6e53 7569  l[ExpectationSui
+00010360: 7465 5d3a 0a20 2020 2020 2020 2022 2222  te]:.        """
+00010370: 4578 7065 6374 6174 696f 6e20 5375 6974  Expectation Suit
+00010380: 6520 636f 6e66 6967 7572 6174 696f 6e20  e configuration 
+00010390: 6f62 6a65 6374 2064 6566 696e 696e 6720  object defining 
+000103a0: 7468 6520 7365 7474 696e 6773 2066 6f72  the settings for
+000103b0: 0a20 2020 2020 2020 2064 6174 6120 7661  .        data va
+000103c0: 6c69 6461 7469 6f6e 206f 6620 7468 6520  lidation of the 
+000103d0: 6665 6174 7572 6520 6772 6f75 702e 2222  feature group.""
+000103e0: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+000103f0: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
+00010400: 6f6e 5f73 7569 7465 0a0a 2020 2020 4065  on_suite..    @e
+00010410: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+00010420: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+00010430: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00010440: 6528 0a20 2020 2020 2020 2073 656c 662c  e(.        self,
+00010450: 0a20 2020 2020 2020 2065 7870 6563 7461  .        expecta
+00010460: 7469 6f6e 5f73 7569 7465 3a20 556e 696f  tion_suite: Unio
+00010470: 6e5b 0a20 2020 2020 2020 2020 2020 2045  n[.            E
+00010480: 7870 6563 7461 7469 6f6e 5375 6974 652c  xpectationSuite,
+00010490: 2067 652e 636f 7265 2e45 7870 6563 7461   ge.core.Expecta
+000104a0: 7469 6f6e 5375 6974 652c 2064 6963 742c  tionSuite, dict,
+000104b0: 204e 6f6e 650a 2020 2020 2020 2020 5d2c   None.        ],
+000104c0: 0a20 2020 2029 3a0a 2020 2020 2020 2020  .    ):.        
+000104d0: 6966 2069 7369 6e73 7461 6e63 6528 6578  if isinstance(ex
+000104e0: 7065 6374 6174 696f 6e5f 7375 6974 652c  pectation_suite,
+000104f0: 2045 7870 6563 7461 7469 6f6e 5375 6974   ExpectationSuit
+00010500: 6529 3a0a 2020 2020 2020 2020 2020 2020  e):.            
+00010510: 746d 705f 6578 7065 6374 6174 696f 6e5f  tmp_expectation_
+00010520: 7375 6974 6520 3d20 6578 7065 6374 6174  suite = expectat
+00010530: 696f 6e5f 7375 6974 652e 746f 5f6a 736f  ion_suite.to_jso
+00010540: 6e5f 6469 6374 2864 6563 616d 656c 697a  n_dict(decameliz
+00010550: 653d 5472 7565 290a 2020 2020 2020 2020  e=True).        
+00010560: 2020 2020 746d 705f 6578 7065 6374 6174      tmp_expectat
+00010570: 696f 6e5f 7375 6974 655b 2266 6561 7475  ion_suite["featu
+00010580: 7265 5f67 726f 7570 5f69 6422 5d20 3d20  re_group_id"] = 
+00010590: 7365 6c66 2e5f 6964 0a20 2020 2020 2020  self._id.       
+000105a0: 2020 2020 2074 6d70 5f65 7870 6563 7461       tmp_expecta
+000105b0: 7469 6f6e 5f73 7569 7465 5b22 6665 6174  tion_suite["feat
+000105c0: 7572 655f 7374 6f72 655f 6964 225d 203d  ure_store_id"] =
+000105d0: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
+000105e0: 746f 7265 5f69 640a 2020 2020 2020 2020  tore_id.        
+000105f0: 2020 2020 7365 6c66 2e5f 6578 7065 6374      self._expect
+00010600: 6174 696f 6e5f 7375 6974 6520 3d20 4578  ation_suite = Ex
+00010610: 7065 6374 6174 696f 6e53 7569 7465 282a  pectationSuite(*
+00010620: 2a74 6d70 5f65 7870 6563 7461 7469 6f6e  *tmp_expectation
+00010630: 5f73 7569 7465 290a 2020 2020 2020 2020  _suite).        
+00010640: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00010650: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+00010660: 652c 2067 652e 636f 7265 2e65 7870 6563  e, ge.core.expec
+00010670: 7461 7469 6f6e 5f73 7569 7465 2e45 7870  tation_suite.Exp
+00010680: 6563 7461 7469 6f6e 5375 6974 6529 3a0a  ectationSuite):.
+00010690: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+000106a0: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
+000106b0: 6974 6520 3d20 4578 7065 6374 6174 696f  ite = Expectatio
+000106c0: 6e53 7569 7465 280a 2020 2020 2020 2020  nSuite(.        
+000106d0: 2020 2020 2020 2020 2a2a 6578 7065 6374          **expect
+000106e0: 6174 696f 6e5f 7375 6974 652e 746f 5f6a  ation_suite.to_j
+000106f0: 736f 6e5f 6469 6374 2829 2c0a 2020 2020  son_dict(),.    
+00010700: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00010710: 7572 655f 7374 6f72 655f 6964 3d73 656c  ure_store_id=sel
+00010720: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
+00010730: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+00010740: 2020 2020 2066 6561 7475 7265 5f67 726f       feature_gro
+00010750: 7570 5f69 643d 7365 6c66 2e5f 6964 2c0a  up_id=self._id,.
+00010760: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00010770: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
+00010780: 7461 6e63 6528 6578 7065 6374 6174 696f  tance(expectatio
+00010790: 6e5f 7375 6974 652c 2064 6963 7429 3a0a  n_suite, dict):.
+000107a0: 2020 2020 2020 2020 2020 2020 746d 705f              tmp_
+000107b0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+000107c0: 6520 3d20 6578 7065 6374 6174 696f 6e5f  e = expectation_
+000107d0: 7375 6974 652e 636f 7079 2829 0a20 2020  suite.copy().   
+000107e0: 2020 2020 2020 2020 2074 6d70 5f65 7870           tmp_exp
+000107f0: 6563 7461 7469 6f6e 5f73 7569 7465 5b22  ectation_suite["
+00010800: 6665 6174 7572 655f 7374 6f72 655f 6964  feature_store_id
+00010810: 225d 203d 2073 656c 662e 5f66 6561 7475  "] = self._featu
+00010820: 7265 5f73 746f 7265 5f69 640a 2020 2020  re_store_id.    
+00010830: 2020 2020 2020 2020 746d 705f 6578 7065          tmp_expe
+00010840: 6374 6174 696f 6e5f 7375 6974 655b 2266  ctation_suite["f
+00010850: 6561 7475 7265 5f67 726f 7570 5f69 6422  eature_group_id"
+00010860: 5d20 3d20 7365 6c66 2e5f 6964 0a20 2020  ] = self._id.   
+00010870: 2020 2020 2020 2020 2073 656c 662e 5f65           self._e
+00010880: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
+00010890: 203d 2045 7870 6563 7461 7469 6f6e 5375   = ExpectationSu
+000108a0: 6974 6528 2a2a 746d 705f 6578 7065 6374  ite(**tmp_expect
+000108b0: 6174 696f 6e5f 7375 6974 6529 0a20 2020  ation_suite).   
+000108c0: 2020 2020 2065 6c69 6620 6578 7065 6374       elif expect
+000108d0: 6174 696f 6e5f 7375 6974 6520 6973 204e  ation_suite is N
+000108e0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
+000108f0: 2073 656c 662e 5f65 7870 6563 7461 7469   self._expectati
+00010900: 6f6e 5f73 7569 7465 203d 204e 6f6e 650a  on_suite = None.
+00010910: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00010920: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00010930: 5479 7065 4572 726f 7228 0a20 2020 2020  TypeError(.     
+00010940: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+00010950: 6172 6775 6d65 6e74 2060 6578 7065 6374  argument `expect
+00010960: 6174 696f 6e5f 7375 6974 6560 2068 6173  ation_suite` has
+00010970: 2074 6f20 6265 2060 4e6f 6e65 6020 6f66   to be `None` of
+00010980: 2074 7970 6520 6045 7870 6563 7461 7469   type `Expectati
+00010990: 6f6e 5375 6974 6560 206f 7220 6064 6963  onSuite` or `dic
+000109a0: 7460 2c20 6275 7420 6973 206f 6620 7479  t`, but is of ty
+000109b0: 7065 3a20 607b 7d60 222e 666f 726d 6174  pe: `{}`".format
+000109c0: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+000109d0: 2020 2020 2020 7479 7065 2865 7870 6563        type(expec
+000109e0: 7461 7469 6f6e 5f73 7569 7465 290a 2020  tation_suite).  
+000109f0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
+00010a00: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00010a10: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00010a20: 2064 6566 206f 6e6c 696e 655f 656e 6162   def online_enab
+00010a30: 6c65 6428 7365 6c66 293a 0a20 2020 2020  led(self):.     
+00010a40: 2020 2022 2222 5365 7474 696e 6720 6966     """Setting if
+00010a50: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00010a60: 7570 2069 7320 6176 6169 6c61 626c 6520  up is available 
+00010a70: 696e 206f 6e6c 696e 6520 7374 6f72 6167  in online storag
+00010a80: 652e 2222 220a 2020 2020 2020 2020 7265  e.""".        re
+00010a90: 7475 726e 2073 656c 662e 5f6f 6e6c 696e  turn self._onlin
+00010aa0: 655f 656e 6162 6c65 640a 0a20 2020 2040  e_enabled..    @
+00010ab0: 6f6e 6c69 6e65 5f65 6e61 626c 6564 2e73  online_enabled.s
+00010ac0: 6574 7465 720a 2020 2020 6465 6620 6f6e  etter.    def on
+00010ad0: 6c69 6e65 5f65 6e61 626c 6564 2873 656c  line_enabled(sel
+00010ae0: 662c 206f 6e6c 696e 655f 656e 6162 6c65  f, online_enable
+00010af0: 6429 3a0a 2020 2020 2020 2020 7365 6c66  d):.        self
+00010b00: 2e5f 6f6e 6c69 6e65 5f65 6e61 626c 6564  ._online_enabled
+00010b10: 203d 206f 6e6c 696e 655f 656e 6162 6c65   = online_enable
+00010b20: 640a 0a20 2020 2040 7072 6f70 6572 7479  d..    @property
+00010b30: 0a20 2020 2064 6566 2074 6f70 6963 5f6e  .    def topic_n
+00010b40: 616d 6528 7365 6c66 293a 0a20 2020 2020  ame(self):.     
+00010b50: 2020 2022 2222 5468 6520 746f 7069 6320     """The topic 
+00010b60: 7573 6564 2066 6f72 2066 6561 7475 7265  used for feature
+00010b70: 2067 726f 7570 2064 6174 6120 696e 6765   group data inge
+00010b80: 7374 696f 6e2e 2222 220a 2020 2020 2020  stion.""".      
+00010b90: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
+00010ba0: 6f70 6963 5f6e 616d 650a 0a20 2020 2040  opic_name..    @
+00010bb0: 746f 7069 635f 6e61 6d65 2e73 6574 7465  topic_name.sette
+00010bc0: 720a 2020 2020 6465 6620 746f 7069 635f  r.    def topic_
+00010bd0: 6e61 6d65 2873 656c 662c 2074 6f70 6963  name(self, topic
+00010be0: 5f6e 616d 6529 3a0a 2020 2020 2020 2020  _name):.        
+00010bf0: 7365 6c66 2e5f 746f 7069 635f 6e61 6d65  self._topic_name
+00010c00: 203d 2074 6f70 6963 5f6e 616d 650a 0a20   = topic_name.. 
+00010c10: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00010c20: 2064 6566 206e 6f74 6966 6963 6174 696f   def notificatio
+00010c30: 6e5f 746f 7069 635f 6e61 6d65 2873 656c  n_topic_name(sel
+00010c40: 6629 3a0a 2020 2020 2020 2020 2222 2254  f):.        """T
+00010c50: 6865 2074 6f70 6963 2075 7365 6420 666f  he topic used fo
+00010c60: 7220 6665 6174 7572 6520 6772 6f75 7020  r feature group 
+00010c70: 6e6f 7469 6669 6361 7469 6f6e 732e 2222  notifications.""
+00010c80: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00010c90: 2073 656c 662e 5f6e 6f74 6966 6963 6174   self._notificat
+00010ca0: 696f 6e5f 746f 7069 635f 6e61 6d65 0a0a  ion_topic_name..
+00010cb0: 2020 2020 406e 6f74 6966 6963 6174 696f      @notificatio
+00010cc0: 6e5f 746f 7069 635f 6e61 6d65 2e73 6574  n_topic_name.set
+00010cd0: 7465 720a 2020 2020 6465 6620 6e6f 7469  ter.    def noti
+00010ce0: 6669 6361 7469 6f6e 5f74 6f70 6963 5f6e  fication_topic_n
+00010cf0: 616d 6528 7365 6c66 2c20 6e6f 7469 6669  ame(self, notifi
+00010d00: 6361 7469 6f6e 5f74 6f70 6963 5f6e 616d  cation_topic_nam
+00010d10: 6529 3a0a 2020 2020 2020 2020 7365 6c66  e):.        self
+00010d20: 2e5f 6e6f 7469 6669 6361 7469 6f6e 5f74  ._notification_t
+00010d30: 6f70 6963 5f6e 616d 6520 3d20 6e6f 7469  opic_name = noti
+00010d40: 6669 6361 7469 6f6e 5f74 6f70 6963 5f6e  fication_topic_n
+00010d50: 616d 650a 0a20 2020 2040 7072 6f70 6572  ame..    @proper
+00010d60: 7479 0a20 2020 2064 6566 2064 6570 7265  ty.    def depre
+00010d70: 6361 7465 6428 7365 6c66 293a 0a20 2020  cated(self):.   
+00010d80: 2020 2020 2022 2222 5365 7474 696e 6720       """Setting 
+00010d90: 6966 2074 6865 2066 6561 7475 7265 2067  if the feature g
+00010da0: 726f 7570 2069 7320 6465 7072 6563 6174  roup is deprecat
+00010db0: 6564 2e22 2222 0a20 2020 2020 2020 2072  ed.""".        r
+00010dc0: 6574 7572 6e20 7365 6c66 2e5f 6465 7072  eturn self._depr
+00010dd0: 6563 6174 6564 0a0a 2020 2020 4064 6570  ecated..    @dep
+00010de0: 7265 6361 7465 642e 7365 7474 6572 0a20  recated.setter. 
+00010df0: 2020 2064 6566 2064 6570 7265 6361 7465     def deprecate
+00010e00: 6428 7365 6c66 2c20 6465 7072 6563 6174  d(self, deprecat
+00010e10: 6564 293a 0a20 2020 2020 2020 2073 656c  ed):.        sel
+00010e20: 662e 5f64 6570 7265 6361 7465 6420 3d20  f._deprecated = 
+00010e30: 6465 7072 6563 6174 6564 0a0a 2020 2020  deprecated..    
+00010e40: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00010e50: 6620 7375 626a 6563 7428 7365 6c66 293a  f subject(self):
+00010e60: 0a20 2020 2020 2020 2022 2222 5375 626a  .        """Subj
+00010e70: 6563 7420 6f66 2074 6865 2066 6561 7475  ect of the featu
+00010e80: 7265 2067 726f 7570 2e22 2222 0a20 2020  re group.""".   
+00010e90: 2020 2020 2069 6620 7365 6c66 2e5f 7375       if self._su
+00010ea0: 626a 6563 7420 6973 204e 6f6e 653a 0a20  bject is None:. 
+00010eb0: 2020 2020 2020 2020 2020 2023 2063 6163             # cac
+00010ec0: 6865 2074 6865 2073 6368 656d 610a 2020  he the schema.  
+00010ed0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00010ee0: 7375 626a 6563 7420 3d20 7365 6c66 2e5f  subject = self._
+00010ef0: 6665 6174 7572 655f 6772 6f75 705f 656e  feature_group_en
+00010f00: 6769 6e65 2e67 6574 5f73 7562 6a65 6374  gine.get_subject
+00010f10: 2873 656c 6629 0a20 2020 2020 2020 2072  (self).        r
+00010f20: 6574 7572 6e20 7365 6c66 2e5f 7375 626a  eturn self._subj
+00010f30: 6563 740a 0a20 2020 2040 7072 6f70 6572  ect..    @proper
+00010f40: 7479 0a20 2020 2064 6566 2061 7672 6f5f  ty.    def avro_
+00010f50: 7363 6865 6d61 2873 656c 6629 3a0a 2020  schema(self):.  
+00010f60: 2020 2020 2020 2222 2241 7672 6f20 7363        """Avro sc
+00010f70: 6865 6d61 2072 6570 7265 7365 6e74 6174  hema representat
+00010f80: 696f 6e20 6f66 2074 6865 2066 6561 7475  ion of the featu
+00010f90: 7265 2067 726f 7570 2e22 2222 0a20 2020  re group.""".   
+00010fa0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00010fb0: 2e73 7562 6a65 6374 5b22 7363 6865 6d61  .subject["schema
+00010fc0: 225d 0a0a 2020 2020 6465 6620 6765 745f  "]..    def get_
+00010fd0: 636f 6d70 6c65 785f 6665 6174 7572 6573  complex_features
+00010fe0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00010ff0: 2222 2252 6574 7572 6e73 2074 6865 206e  """Returns the n
+00011000: 616d 6573 206f 6620 616c 6c20 6665 6174  ames of all feat
+00011010: 7572 6573 2077 6974 6820 6120 636f 6d70  ures with a comp
+00011020: 6c65 7820 6461 7461 2074 7970 6520 696e  lex data type in
+00011030: 2074 6869 730a 2020 2020 2020 2020 6665   this.        fe
+00011040: 6174 7572 6520 6772 6f75 702e 0a0a 2020  ature group...  
+00011050: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
+00011060: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+00011070: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+00011080: 2020 2020 636f 6d70 6c65 785f 6474 7970      complex_dtyp
+00011090: 655f 6665 6174 7572 6573 203d 2066 672e  e_features = fg.
+000110a0: 6765 745f 636f 6d70 6c65 785f 6665 6174  get_complex_feat
+000110b0: 7572 6573 2829 0a20 2020 2020 2020 2020  ures().         
+000110c0: 2020 2060 6060 0a20 2020 2020 2020 2022     ```.        "
+000110d0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000110e0: 6e20 5b66 2e6e 616d 6520 666f 7220 6620  n [f.name for f 
+000110f0: 696e 2073 656c 662e 6665 6174 7572 6573  in self.features
+00011100: 2069 6620 662e 6973 5f63 6f6d 706c 6578   if f.is_complex
+00011110: 2829 5d0a 0a20 2020 2064 6566 205f 6765  ()]..    def _ge
+00011120: 745f 656e 636f 6465 645f 6176 726f 5f73  t_encoded_avro_s
+00011130: 6368 656d 6128 7365 6c66 293a 0a20 2020  chema(self):.   
+00011140: 2020 2020 2063 6f6d 706c 6578 5f66 6561       complex_fea
+00011150: 7475 7265 7320 3d20 7365 6c66 2e67 6574  tures = self.get
+00011160: 5f63 6f6d 706c 6578 5f66 6561 7475 7265  _complex_feature
+00011170: 7328 290a 2020 2020 2020 2020 7363 6865  s().        sche
+00011180: 6d61 203d 206a 736f 6e2e 6c6f 6164 7328  ma = json.loads(
+00011190: 7365 6c66 2e61 7672 6f5f 7363 6865 6d61  self.avro_schema
+000111a0: 290a 0a20 2020 2020 2020 2066 6f72 2066  )..        for f
+000111b0: 6965 6c64 2069 6e20 7363 6865 6d61 5b22  ield in schema["
+000111c0: 6669 656c 6473 225d 3a0a 2020 2020 2020  fields"]:.      
+000111d0: 2020 2020 2020 6966 2066 6965 6c64 5b22        if field["
+000111e0: 6e61 6d65 225d 2069 6e20 636f 6d70 6c65  name"] in comple
+000111f0: 785f 6665 6174 7572 6573 3a0a 2020 2020  x_features:.    
+00011200: 2020 2020 2020 2020 2020 2020 6669 656c              fiel
+00011210: 645b 2274 7970 6522 5d20 3d20 5b22 6e75  d["type"] = ["nu
+00011220: 6c6c 222c 2022 6279 7465 7322 5d0a 0a20  ll", "bytes"].. 
+00011230: 2020 2020 2020 2073 6368 656d 615f 7320         schema_s 
+00011240: 3d20 6a73 6f6e 2e64 756d 7073 2873 6368  = json.dumps(sch
+00011250: 656d 6129 0a20 2020 2020 2020 2074 7279  ema).        try
+00011260: 3a0a 2020 2020 2020 2020 2020 2020 6176  :.            av
+00011270: 726f 2e73 6368 656d 612e 7061 7273 6528  ro.schema.parse(
+00011280: 7363 6865 6d61 5f73 290a 2020 2020 2020  schema_s).      
+00011290: 2020 6578 6365 7074 2061 7672 6f2e 7363    except avro.sc
+000112a0: 6865 6d61 2e53 6368 656d 6150 6172 7365  hema.SchemaParse
+000112b0: 4578 6365 7074 696f 6e20 6173 2065 3a0a  Exception as e:.
+000112c0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+000112d0: 6520 4665 6174 7572 6553 746f 7265 4578  e FeatureStoreEx
+000112e0: 6365 7074 696f 6e28 2246 6169 6c65 6420  ception("Failed 
+000112f0: 746f 2063 6f6e 7374 7275 6374 2041 7672  to construct Avr
+00011300: 6f20 5363 6865 6d61 3a20 7b7d 222e 666f  o Schema: {}".fo
+00011310: 726d 6174 2865 2929 0a20 2020 2020 2020  rmat(e)).       
+00011320: 2072 6574 7572 6e20 7363 6865 6d61 5f73   return schema_s
+00011330: 0a0a 2020 2020 6465 6620 5f67 6574 5f66  ..    def _get_f
+00011340: 6561 7475 7265 5f61 7672 6f5f 7363 6865  eature_avro_sche
+00011350: 6d61 2873 656c 662c 2066 6561 7475 7265  ma(self, feature
+00011360: 5f6e 616d 6529 3a0a 2020 2020 2020 2020  _name):.        
+00011370: 666f 7220 6669 656c 6420 696e 206a 736f  for field in jso
+00011380: 6e2e 6c6f 6164 7328 7365 6c66 2e61 7672  n.loads(self.avr
+00011390: 6f5f 7363 6865 6d61 295b 2266 6965 6c64  o_schema)["field
+000113a0: 7322 5d3a 0a20 2020 2020 2020 2020 2020  s"]:.           
+000113b0: 2069 6620 6669 656c 645b 226e 616d 6522   if field["name"
+000113c0: 5d20 3d3d 2066 6561 7475 7265 5f6e 616d  ] == feature_nam
+000113d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000113e0: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
+000113f0: 756d 7073 2866 6965 6c64 5b22 7479 7065  umps(field["type
+00011400: 225d 290a 0a20 2020 2040 7072 6f70 6572  "])..    @proper
+00011410: 7479 0a20 2020 2064 6566 2066 6561 7475  ty.    def featu
+00011420: 7265 7328 7365 6c66 293a 0a20 2020 2020  res(self):.     
+00011430: 2020 2022 2222 4665 6174 7572 6520 4772     """Feature Gr
+00011440: 6f75 7020 7363 6865 6d61 2028 616c 6961  oup schema (alia
+00011450: 7329 2222 220a 2020 2020 2020 2020 7265  s)""".        re
+00011460: 7475 726e 2073 656c 662e 5f66 6561 7475  turn self._featu
+00011470: 7265 730a 0a20 2020 2040 7072 6f70 6572  res..    @proper
+00011480: 7479 0a20 2020 2064 6566 2073 6368 656d  ty.    def schem
+00011490: 6128 7365 6c66 293a 0a20 2020 2020 2020  a(self):.       
+000114a0: 2022 2222 4665 6174 7572 6520 4772 6f75   """Feature Grou
+000114b0: 7020 7363 6865 6d61 2222 220a 2020 2020  p schema""".    
+000114c0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+000114d0: 5f66 6561 7475 7265 730a 0a20 2020 2064  _features..    d
+000114e0: 6566 205f 6172 655f 7374 6174 6973 7469  ef _are_statisti
+000114f0: 6373 5f6d 6973 7369 6e67 2873 656c 662c  cs_missing(self,
+00011500: 2073 7461 7469 7374 6963 733a 2053 7461   statistics: Sta
+00011510: 7469 7374 6963 7329 3a0a 2020 2020 2020  tistics):.      
+00011520: 2020 6966 206e 6f74 2073 656c 662e 7374    if not self.st
+00011530: 6174 6973 7469 6373 5f63 6f6e 6669 672e  atistics_config.
+00011540: 656e 6162 6c65 643a 0a20 2020 2020 2020  enabled:.       
+00011550: 2020 2020 2072 6574 7572 6e20 4661 6c73       return Fals
+00011560: 650a 2020 2020 2020 2020 656c 6966 2073  e.        elif s
+00011570: 7461 7469 7374 6963 7320 6973 204e 6f6e  tatistics is Non
+00011580: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00011590: 6574 7572 6e20 5472 7565 0a20 2020 2020  eturn True.     
+000115a0: 2020 2069 6620 280a 2020 2020 2020 2020     if (.        
+000115b0: 2020 2020 7365 6c66 2e73 7461 7469 7374      self.statist
+000115c0: 6963 735f 636f 6e66 6967 2e68 6973 746f  ics_config.histo
+000115d0: 6772 616d 730a 2020 2020 2020 2020 2020  grams.          
+000115e0: 2020 6f72 2073 656c 662e 7374 6174 6973    or self.statis
+000115f0: 7469 6373 5f63 6f6e 6669 672e 636f 7272  tics_config.corr
+00011600: 656c 6174 696f 6e73 0a20 2020 2020 2020  elations.       
+00011610: 2020 2020 206f 7220 7365 6c66 2e73 7461       or self.sta
+00011620: 7469 7374 6963 735f 636f 6e66 6967 2e65  tistics_config.e
+00011630: 7861 6374 5f75 6e69 7175 656e 6573 730a  xact_uniqueness.
+00011640: 2020 2020 2020 2020 293a 0a20 2020 2020          ):.     
+00011650: 2020 2020 2020 2023 2069 6620 7374 6174         # if stat
+00011660: 6973 7469 6373 2061 7265 206d 6973 7369  istics are missi
+00011670: 6e67 2c20 7265 636f 6d70 7574 6520 616e  ng, recompute an
+00011680: 6420 7570 6461 7465 2073 7461 7469 7374  d update statist
+00011690: 6963 732e 0a20 2020 2020 2020 2020 2020  ics..           
+000116a0: 2023 2057 6520 6e65 6564 2074 6f20 6368   # We need to ch
+000116b0: 6563 6b20 666f 7220 6d69 7373 696e 6720  eck for missing 
+000116c0: 7374 6174 6973 7469 6373 2062 6563 6175  statistics becau
+000116d0: 7365 2074 6865 2073 7461 7469 7374 6963  se the statistic
+000116e0: 7320 636f 6e66 6967 2063 616e 2068 6176  s config can hav
+000116f0: 6520 6265 656e 206d 6f64 6966 6965 640a  e been modified.
+00011700: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00011710: 6664 7320 696e 2073 7461 7469 7374 6963  fds in statistic
+00011720: 732e 6665 6174 7572 655f 6465 7363 7269  s.feature_descri
+00011730: 7074 6976 655f 7374 6174 6973 7469 6373  ptive_statistics
+00011740: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
+00011750: 2020 6966 2066 6473 2e66 6561 7475 7265    if fds.feature
+00011760: 5f74 7970 6520 696e 205b 2249 6e74 6567  _type in ["Integ
+00011770: 7261 6c22 2c20 2246 7261 6374 696f 6e61  ral", "Fractiona
+00011780: 6c22 5d3a 0a20 2020 2020 2020 2020 2020  l"]:.           
+00011790: 2020 2020 2020 2020 2069 6620 7365 6c66           if self
+000117a0: 2e73 7461 7469 7374 6963 735f 636f 6e66  .statistics_conf
+000117b0: 6967 2e68 6973 746f 6772 616d 7320 616e  ig.histograms an
+000117c0: 6420 280a 2020 2020 2020 2020 2020 2020  d (.            
+000117d0: 2020 2020 2020 2020 2020 2020 6664 732e              fds.
+000117e0: 6578 7465 6e64 6564 5f73 7461 7469 7374  extended_statist
+000117f0: 6963 7320 6973 204e 6f6e 650a 2020 2020  ics is None.    
+00011800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011810: 2020 2020 6f72 2022 6869 7374 6f67 7261      or "histogra
+00011820: 6d22 206e 6f74 2069 6e20 6664 732e 6578  m" not in fds.ex
+00011830: 7465 6e64 6564 5f73 7461 7469 7374 6963  tended_statistic
+00011840: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
+00011850: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
+00011860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011870: 2072 6574 7572 6e20 5472 7565 0a0a 2020   return True..  
+00011880: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011890: 2020 6966 2073 656c 662e 7374 6174 6973    if self.statis
+000118a0: 7469 6373 5f63 6f6e 6669 672e 636f 7272  tics_config.corr
+000118b0: 656c 6174 696f 6e73 2061 6e64 2028 0a20  elations and (. 
+000118c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000118d0: 2020 2020 2020 2066 6473 2e65 7874 656e         fds.exten
+000118e0: 6465 645f 7374 6174 6973 7469 6373 2069  ded_statistics i
+000118f0: 7320 4e6f 6e65 0a20 2020 2020 2020 2020  s None.         
+00011900: 2020 2020 2020 2020 2020 2020 2020 206f                 o
+00011910: 7220 2263 6f72 7265 6c61 7469 6f6e 7322  r "correlations"
+00011920: 206e 6f74 2069 6e20 6664 732e 6578 7465   not in fds.exte
+00011930: 6e64 6564 5f73 7461 7469 7374 6963 730a  nded_statistics.
 00011940: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011950: 2020 2072 6574 7572 6e20 5472 7565 0a0a     return True..
-00011960: 2020 2020 2020 2020 7265 7475 726e 2046          return F
-00011970: 616c 7365 0a0a 2020 2020 6465 6620 5f61  alse..    def _a
-00011980: 7265 5f73 7461 7469 7374 6963 735f 7375  re_statistics_su
-00011990: 7070 6f72 7465 6428 7365 6c66 293a 0a20  pported(self):. 
-000119a0: 2020 2020 2020 2022 2222 5768 6574 6865         """Whethe
-000119b0: 7220 7374 6174 6973 7469 6373 2061 7265  r statistics are
-000119c0: 2073 7570 706f 7274 6564 206f 7220 6e6f   supported or no
-000119d0: 7420 666f 7220 7468 6520 6375 7272 656e  t for the curren
-000119e0: 7420 4665 6174 7572 6520 4772 6f75 7020  t Feature Group 
-000119f0: 7479 7065 2222 220a 2020 2020 2020 2020  type""".        
-00011a00: 7265 7475 726e 206e 6f74 2069 7369 6e73  return not isins
-00011a10: 7461 6e63 6528 7365 6c66 2c20 5370 696e  tance(self, Spin
-00011a20: 6547 726f 7570 290a 0a20 2020 2064 6566  eGroup)..    def
-00011a30: 205f 6368 6563 6b5f 7374 6174 6973 7469   _check_statisti
-00011a40: 6373 5f73 7570 706f 7274 2873 656c 6629  cs_support(self)
-00011a50: 3a0a 2020 2020 2020 2020 2222 2243 6865  :.        """Che
-00011a60: 636b 2066 6f72 2073 7461 7469 7374 6963  ck for statistic
-00011a70: 7320 7375 7070 6f72 7420 6f6e 2074 6865  s support on the
-00011a80: 2063 7572 7265 6e74 2046 6561 7475 7265   current Feature
-00011a90: 2047 726f 7570 2074 7970 6522 2222 0a20   Group type""". 
-00011aa0: 2020 2020 2020 2069 6620 6e6f 7420 7365         if not se
-00011ab0: 6c66 2e5f 6172 655f 7374 6174 6973 7469  lf._are_statisti
-00011ac0: 6373 5f73 7570 706f 7274 6564 2829 3a0a  cs_supported():.
-00011ad0: 2020 2020 2020 2020 2020 2020 7261 6973              rais
-00011ae0: 6520 4665 6174 7572 6553 746f 7265 4578  e FeatureStoreEx
-00011af0: 6365 7074 696f 6e28 0a20 2020 2020 2020  ception(.       
-00011b00: 2020 2020 2020 2020 2022 5374 6174 6973           "Statis
-00011b10: 7469 6373 206e 6f74 2073 7570 706f 7274  tics not support
-00011b20: 6564 2066 6f72 2074 6869 7320 4665 6174  ed for this Feat
-00011b30: 7572 6520 4772 6f75 7020 7479 7065 220a  ure Group type".
-00011b40: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00011b50: 2020 2040 6665 6174 7572 6573 2e73 6574     @features.set
-00011b60: 7465 720a 2020 2020 6465 6620 6665 6174  ter.    def feat
-00011b70: 7572 6573 2873 656c 662c 206e 6577 5f66  ures(self, new_f
-00011b80: 6561 7475 7265 7329 3a0a 2020 2020 2020  eatures):.      
-00011b90: 2020 7365 6c66 2e5f 6665 6174 7572 6573    self._features
-00011ba0: 203d 206e 6577 5f66 6561 7475 7265 730a   = new_features.
-00011bb0: 0a20 2020 2064 6566 205f 6765 745f 7072  .    def _get_pr
-00011bc0: 6f6a 6563 745f 6e61 6d65 2873 656c 6629  oject_name(self)
-00011bd0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-00011be0: 2075 7469 6c2e 7374 7269 705f 6665 6174   util.strip_feat
-00011bf0: 7572 655f 7374 6f72 655f 7375 6666 6978  ure_store_suffix
-00011c00: 2873 656c 662e 6665 6174 7572 655f 7374  (self.feature_st
-00011c10: 6f72 655f 6e61 6d65 290a 0a0a 636c 6173  ore_name)...clas
-00011c20: 7320 4665 6174 7572 6547 726f 7570 2846  s FeatureGroup(F
-00011c30: 6561 7475 7265 4772 6f75 7042 6173 6529  eatureGroupBase)
-00011c40: 3a0a 2020 2020 4341 4348 4544 5f46 4541  :.    CACHED_FEA
-00011c50: 5455 5245 5f47 524f 5550 203d 2022 4341  TURE_GROUP = "CA
-00011c60: 4348 4544 5f46 4541 5455 5245 5f47 524f  CHED_FEATURE_GRO
-00011c70: 5550 220a 2020 2020 5354 5245 414d 5f46  UP".    STREAM_F
-00011c80: 4541 5455 5245 5f47 524f 5550 203d 2022  EATURE_GROUP = "
-00011c90: 5354 5245 414d 5f46 4541 5455 5245 5f47  STREAM_FEATURE_G
-00011ca0: 524f 5550 220a 2020 2020 454e 5449 5459  ROUP".    ENTITY
-00011cb0: 5f54 5950 4520 3d20 2266 6561 7475 7265  _TYPE = "feature
-00011cc0: 6772 6f75 7073 220a 0a20 2020 2064 6566  groups"..    def
-00011cd0: 205f 5f69 6e69 745f 5f28 0a20 2020 2020   __init__(.     
-00011ce0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00011cf0: 206e 616d 652c 0a20 2020 2020 2020 2076   name,.        v
-00011d00: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
-00011d10: 6665 6174 7572 6573 746f 7265 5f69 642c  featurestore_id,
-00011d20: 0a20 2020 2020 2020 2064 6573 6372 6970  .        descrip
-00011d30: 7469 6f6e 3d22 222c 0a20 2020 2020 2020  tion="",.       
-00011d40: 2070 6172 7469 7469 6f6e 5f6b 6579 3d4e   partition_key=N
-00011d50: 6f6e 652c 0a20 2020 2020 2020 2070 7269  one,.        pri
-00011d60: 6d61 7279 5f6b 6579 3d4e 6f6e 652c 0a20  mary_key=None,. 
-00011d70: 2020 2020 2020 2068 7564 695f 7072 6563         hudi_prec
-00011d80: 6f6d 6269 6e65 5f6b 6579 3d4e 6f6e 652c  ombine_key=None,
-00011d90: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00011da0: 7374 6f72 655f 6e61 6d65 3d4e 6f6e 652c  store_name=None,
-00011db0: 0a20 2020 2020 2020 2065 6d62 6564 6469  .        embeddi
-00011dc0: 6e67 5f69 6e64 6578 3d4e 6f6e 652c 0a20  ng_index=None,. 
-00011dd0: 2020 2020 2020 2063 7265 6174 6564 3d4e         created=N
-00011de0: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
-00011df0: 6174 6f72 3d4e 6f6e 652c 0a20 2020 2020  ator=None,.     
-00011e00: 2020 2069 643d 4e6f 6e65 2c0a 2020 2020     id=None,.    
-00011e10: 2020 2020 6665 6174 7572 6573 3d4e 6f6e      features=Non
-00011e20: 652c 0a20 2020 2020 2020 206c 6f63 6174  e,.        locat
-00011e30: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  ion=None,.      
-00011e40: 2020 6f6e 6c69 6e65 5f65 6e61 626c 6564    online_enabled
-00011e50: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-00011e60: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
-00011e70: 6174 3d4e 6f6e 652c 0a20 2020 2020 2020  at=None,.       
-00011e80: 2073 7461 7469 7374 6963 735f 636f 6e66   statistics_conf
-00011e90: 6967 3d4e 6f6e 652c 0a20 2020 2020 2020  ig=None,.       
-00011ea0: 206f 6e6c 696e 655f 746f 7069 635f 6e61   online_topic_na
-00011eb0: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-00011ec0: 2074 6f70 6963 5f6e 616d 653d 4e6f 6e65   topic_name=None
-00011ed0: 2c0a 2020 2020 2020 2020 6e6f 7469 6669  ,.        notifi
-00011ee0: 6361 7469 6f6e 5f74 6f70 6963 5f6e 616d  cation_topic_nam
-00011ef0: 653d 4e6f 6e65 2c0a 2020 2020 2020 2020  e=None,.        
-00011f00: 6576 656e 745f 7469 6d65 3d4e 6f6e 652c  event_time=None,
-00011f10: 0a20 2020 2020 2020 2073 7472 6561 6d3d  .        stream=
-00011f20: 4661 6c73 652c 0a20 2020 2020 2020 2065  False,.        e
-00011f30: 7870 6563 7461 7469 6f6e 5f73 7569 7465  xpectation_suite
-00011f40: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-00011f50: 6172 656e 7473 3d4e 6f6e 652c 0a20 2020  arents=None,.   
-00011f60: 2020 2020 2068 7265 663d 4e6f 6e65 2c0a       href=None,.
-00011f70: 2020 2020 2020 2020 6465 6c74 615f 7374          delta_st
-00011f80: 7265 616d 6572 5f6a 6f62 5f63 6f6e 663d  reamer_job_conf=
-00011f90: 4e6f 6e65 2c0a 2020 2020 2020 2020 6465  None,.        de
-00011fa0: 7072 6563 6174 6564 3d46 616c 7365 2c0a  precated=False,.
-00011fb0: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
-00011fc0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00011fd0: 2073 7570 6572 2829 2e5f 5f69 6e69 745f   super().__init_
-00011fe0: 5f28 0a20 2020 2020 2020 2020 2020 206e  _(.            n
-00011ff0: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00012000: 2076 6572 7369 6f6e 2c0a 2020 2020 2020   version,.      
-00012010: 2020 2020 2020 6665 6174 7572 6573 746f        featuresto
-00012020: 7265 5f69 642c 0a20 2020 2020 2020 2020  re_id,.         
-00012030: 2020 206c 6f63 6174 696f 6e2c 0a20 2020     location,.   
-00012040: 2020 2020 2020 2020 2065 7665 6e74 5f74           event_t
-00012050: 696d 653d 6576 656e 745f 7469 6d65 2c0a  ime=event_time,.
-00012060: 2020 2020 2020 2020 2020 2020 6f6e 6c69              onli
-00012070: 6e65 5f65 6e61 626c 6564 3d6f 6e6c 696e  ne_enabled=onlin
-00012080: 655f 656e 6162 6c65 642c 0a20 2020 2020  e_enabled,.     
-00012090: 2020 2020 2020 2065 6d62 6564 6469 6e67         embedding
-000120a0: 5f69 6e64 6578 3d65 6d62 6564 6469 6e67  _index=embedding
-000120b0: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
-000120c0: 2020 2020 6964 3d69 642c 0a20 2020 2020      id=id,.     
-000120d0: 2020 2020 2020 2065 7870 6563 7461 7469         expectati
-000120e0: 6f6e 5f73 7569 7465 3d65 7870 6563 7461  on_suite=expecta
-000120f0: 7469 6f6e 5f73 7569 7465 2c0a 2020 2020  tion_suite,.    
-00012100: 2020 2020 2020 2020 6f6e 6c69 6e65 5f74          online_t
-00012110: 6f70 6963 5f6e 616d 653d 6f6e 6c69 6e65  opic_name=online
-00012120: 5f74 6f70 6963 5f6e 616d 652c 0a20 2020  _topic_name,.   
-00012130: 2020 2020 2020 2020 2074 6f70 6963 5f6e           topic_n
-00012140: 616d 653d 746f 7069 635f 6e61 6d65 2c0a  ame=topic_name,.
-00012150: 2020 2020 2020 2020 2020 2020 6e6f 7469              noti
-00012160: 6669 6361 7469 6f6e 5f74 6f70 6963 5f6e  fication_topic_n
-00012170: 616d 653d 6e6f 7469 6669 6361 7469 6f6e  ame=notification
-00012180: 5f74 6f70 6963 5f6e 616d 652c 0a20 2020  _topic_name,.   
-00012190: 2020 2020 2020 2020 2064 6570 7265 6361           depreca
-000121a0: 7465 643d 6465 7072 6563 6174 6564 2c0a  ted=deprecated,.
-000121b0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000121c0: 2020 7365 6c66 2e5f 6665 6174 7572 655f    self._feature_
-000121d0: 7374 6f72 655f 6e61 6d65 203d 2066 6561  store_name = fea
-000121e0: 7475 7265 7374 6f72 655f 6e61 6d65 0a20  turestore_name. 
-000121f0: 2020 2020 2020 2073 656c 662e 5f64 6573         self._des
-00012200: 6372 6970 7469 6f6e 203d 2064 6573 6372  cription = descr
-00012210: 6970 7469 6f6e 0a20 2020 2020 2020 2073  iption.        s
-00012220: 656c 662e 5f63 7265 6174 6564 203d 2063  elf._created = c
-00012230: 7265 6174 6564 0a20 2020 2020 2020 2073  reated.        s
-00012240: 656c 662e 5f63 7265 6174 6f72 203d 2075  elf._creator = u
-00012250: 7365 722e 5573 6572 2e66 726f 6d5f 7265  ser.User.from_re
-00012260: 7370 6f6e 7365 5f6a 736f 6e28 6372 6561  sponse_json(crea
-00012270: 746f 7229 0a20 2020 2020 2020 2073 656c  tor).        sel
-00012280: 662e 5f66 6561 7475 7265 7320 3d20 5b0a  f._features = [.
-00012290: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-000122a0: 7572 652e 4665 6174 7572 652e 6672 6f6d  ure.Feature.from
-000122b0: 5f72 6573 706f 6e73 655f 6a73 6f6e 2866  _response_json(f
-000122c0: 6561 7429 2069 6620 6973 696e 7374 616e  eat) if isinstan
-000122d0: 6365 2866 6561 742c 2064 6963 7429 2065  ce(feat, dict) e
-000122e0: 6c73 6520 6665 6174 0a20 2020 2020 2020  lse feat.       
-000122f0: 2020 2020 2066 6f72 2066 6561 7420 696e       for feat in
-00012300: 2028 6665 6174 7572 6573 206f 7220 5b5d   (features or []
-00012310: 290a 2020 2020 2020 2020 5d0a 0a20 2020  ).        ]..   
-00012320: 2020 2020 2073 656c 662e 5f74 696d 655f       self._time_
-00012330: 7472 6176 656c 5f66 6f72 6d61 7420 3d20  travel_format = 
-00012340: 280a 2020 2020 2020 2020 2020 2020 7469  (.            ti
-00012350: 6d65 5f74 7261 7665 6c5f 666f 726d 6174  me_travel_format
-00012360: 2e75 7070 6572 2829 2069 6620 7469 6d65  .upper() if time
-00012370: 5f74 7261 7665 6c5f 666f 726d 6174 2069  _travel_format i
-00012380: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-00012390: 4e6f 6e65 0a20 2020 2020 2020 2029 0a0a  None.        )..
-000123a0: 2020 2020 2020 2020 7365 6c66 2e5f 7374          self._st
-000123b0: 7265 616d 203d 2073 7472 6561 6d0a 2020  ream = stream.  
-000123c0: 2020 2020 2020 7365 6c66 2e5f 7061 7265        self._pare
-000123d0: 6e74 7320 3d20 7061 7265 6e74 730a 2020  nts = parents.  
-000123e0: 2020 2020 2020 7365 6c66 2e5f 6465 6c74        self._delt
-000123f0: 6173 7472 6561 6d65 725f 6a6f 6263 6f6e  astreamer_jobcon
-00012400: 6620 3d20 6465 6c74 615f 7374 7265 616d  f = delta_stream
-00012410: 6572 5f6a 6f62 5f63 6f6e 660a 0a20 2020  er_job_conf..   
-00012420: 2020 2020 2073 656c 662e 5f6d 6174 6572       self._mater
-00012430: 6961 6c69 7a61 7469 6f6e 5f6a 6f62 203d  ialization_job =
-00012440: 204e 6f6e 650a 0a20 2020 2020 2020 2069   None..        i
-00012450: 6620 7365 6c66 2e5f 6964 3a0a 2020 2020  f self._id:.    
-00012460: 2020 2020 2020 2020 2320 696e 6974 6961          # initia
-00012470: 6c69 7a65 6420 6279 2062 6163 6b65 6e64  lized by backend
-00012480: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-00012490: 662e 7072 696d 6172 795f 6b65 7920 3d20  f.primary_key = 
-000124a0: 5b0a 2020 2020 2020 2020 2020 2020 2020  [.              
-000124b0: 2020 6665 6174 2e6e 616d 6520 666f 7220    feat.name for 
-000124c0: 6665 6174 2069 6e20 7365 6c66 2e5f 6665  feat in self._fe
-000124d0: 6174 7572 6573 2069 6620 6665 6174 2e70  atures if feat.p
-000124e0: 7269 6d61 7279 2069 7320 5472 7565 0a20  rimary is True. 
-000124f0: 2020 2020 2020 2020 2020 205d 0a20 2020             ].   
-00012500: 2020 2020 2020 2020 2073 656c 662e 5f70           self._p
-00012510: 6172 7469 7469 6f6e 5f6b 6579 203d 205b  artition_key = [
-00012520: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012530: 2066 6561 742e 6e61 6d65 2066 6f72 2066   feat.name for f
-00012540: 6561 7420 696e 2073 656c 662e 5f66 6561  eat in self._fea
-00012550: 7475 7265 7320 6966 2066 6561 742e 7061  tures if feat.pa
-00012560: 7274 6974 696f 6e20 6973 2054 7275 650a  rtition is True.
-00012570: 2020 2020 2020 2020 2020 2020 5d0a 2020              ].  
-00012580: 2020 2020 2020 2020 2020 6966 2028 0a20            if (. 
-00012590: 2020 2020 2020 2020 2020 2020 2020 2074                 t
-000125a0: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
-000125b0: 7420 6973 206e 6f74 204e 6f6e 650a 2020  t is not None.  
-000125c0: 2020 2020 2020 2020 2020 2020 2020 616e                an
-000125d0: 6420 7469 6d65 5f74 7261 7665 6c5f 666f  d time_travel_fo
-000125e0: 726d 6174 2e75 7070 6572 2829 203d 3d20  rmat.upper() == 
-000125f0: 2248 5544 4922 0a20 2020 2020 2020 2020  "HUDI".         
-00012600: 2020 2020 2020 2061 6e64 2073 656c 662e         and self.
-00012610: 5f66 6561 7475 7265 730a 2020 2020 2020  _features.      
-00012620: 2020 2020 2020 293a 0a20 2020 2020 2020        ):.       
-00012630: 2020 2020 2020 2020 2023 2068 7564 6920           # hudi 
-00012640: 7072 6563 6f6d 6269 6e65 206b 6579 2069  precombine key i
-00012650: 7320 616c 7761 7973 2061 2073 696e 676c  s always a singl
-00012660: 6520 6665 6174 7572 650a 2020 2020 2020  e feature.      
-00012670: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00012680: 6875 6469 5f70 7265 636f 6d62 696e 655f  hudi_precombine_
-00012690: 6b65 7920 3d20 5b0a 2020 2020 2020 2020  key = [.        
-000126a0: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-000126b0: 2e6e 616d 650a 2020 2020 2020 2020 2020  .name.          
-000126c0: 2020 2020 2020 2020 2020 666f 7220 6665            for fe
-000126d0: 6174 2069 6e20 7365 6c66 2e5f 6665 6174  at in self._feat
-000126e0: 7572 6573 0a20 2020 2020 2020 2020 2020  ures.           
-000126f0: 2020 2020 2020 2020 2069 6620 6665 6174           if feat
-00012700: 2e68 7564 695f 7072 6563 6f6d 6269 6e65  .hudi_precombine
-00012710: 5f6b 6579 2069 7320 5472 7565 0a20 2020  _key is True.   
-00012720: 2020 2020 2020 2020 2020 2020 205d 5b30               ][0
-00012730: 5d0a 2020 2020 2020 2020 2020 2020 656c  ].            el
-00012740: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00012750: 2020 2020 7365 6c66 2e5f 6875 6469 5f70      self._hudi_p
-00012760: 7265 636f 6d62 696e 655f 6b65 7920 3d20  recombine_key = 
-00012770: 4e6f 6e65 0a0a 2020 2020 2020 2020 2020  None..          
-00012780: 2020 7365 6c66 2e73 7461 7469 7374 6963    self.statistic
-00012790: 735f 636f 6e66 6967 203d 2073 7461 7469  s_config = stati
-000127a0: 7374 6963 735f 636f 6e66 6967 0a0a 2020  stics_config..  
-000127b0: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-000127c0: 2020 2020 2020 2020 2320 696e 6974 6961          # initia
-000127d0: 6c69 7a65 6420 6279 2075 7365 720a 2020  lized by user.  
-000127e0: 2020 2020 2020 2020 2020 2320 666f 7220            # for 
-000127f0: 7079 7468 6f6e 2065 6e67 696e 6520 7765  python engine we
-00012800: 2061 6c77 6179 7320 7573 6520 7374 7265   always use stre
-00012810: 616d 2066 6561 7475 7265 2067 726f 7570  am feature group
-00012820: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-00012830: 656e 6769 6e65 2e67 6574 5f74 7970 6528  engine.get_type(
-00012840: 2920 3d3d 2022 7079 7468 6f6e 223a 0a20  ) == "python":. 
-00012850: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00012860: 656c 662e 5f73 7472 6561 6d20 3d20 5472  elf._stream = Tr
-00012870: 7565 0a20 2020 2020 2020 2020 2020 2023  ue.            #
-00012880: 2066 6f72 2073 7472 6561 6d20 6665 6174   for stream feat
-00012890: 7572 6520 6772 6f75 7020 7469 6d65 2074  ure group time t
-000128a0: 7261 7665 6c20 666f 726d 6174 2069 7320  ravel format is 
-000128b0: 616c 7761 7973 2048 5544 490a 2020 2020  always HUDI.    
-000128c0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-000128d0: 5f73 7472 6561 6d3a 0a20 2020 2020 2020  _stream:.       
-000128e0: 2020 2020 2020 2020 2065 7870 6563 7465           expecte
-000128f0: 645f 666f 726d 6174 203d 2022 4855 4449  d_format = "HUDI
-00012900: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00012910: 2020 6966 2073 656c 662e 5f74 696d 655f    if self._time_
-00012920: 7472 6176 656c 5f66 6f72 6d61 7420 213d  travel_format !=
-00012930: 2065 7870 6563 7465 645f 666f 726d 6174   expected_format
-00012940: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00012950: 2020 2020 2020 7761 726e 696e 6773 2e77        warnings.w
-00012960: 6172 6e28 0a20 2020 2020 2020 2020 2020  arn(.           
-00012970: 2020 2020 2020 2020 2020 2020 2028 0a20               (. 
-00012980: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012990: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
-000129a0: 7072 6f76 6964 6564 2074 696d 6520 7472  provided time tr
-000129b0: 6176 656c 2066 6f72 6d61 7420 607b 7d60  avel format `{}`
-000129c0: 2068 6173 2062 6565 6e20 6f76 6572 7772   has been overwr
-000129d0: 6974 7465 6e20 220a 2020 2020 2020 2020  itten ".        
-000129e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000129f0: 2020 2020 2262 6563 6175 7365 2053 7472      "because Str
-00012a00: 6561 6d20 656e 6162 6c65 6420 6665 6174  eam enabled feat
-00012a10: 7572 6520 6772 6f75 7073 206f 6e6c 7920  ure groups only 
-00012a20: 7375 7070 6f72 7420 607b 7d60 220a 2020  support `{}`".  
-00012a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a40: 2020 2020 2020 292e 666f 726d 6174 2873        ).format(s
-00012a50: 656c 662e 5f74 696d 655f 7472 6176 656c  elf._time_travel
-00012a60: 5f66 6f72 6d61 742c 2065 7870 6563 7465  _format, expecte
-00012a70: 645f 666f 726d 6174 292c 0a20 2020 2020  d_format),.     
-00012a80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012a90: 2020 2075 7469 6c2e 4665 6174 7572 6547     util.FeatureG
-00012aa0: 726f 7570 5761 726e 696e 672c 0a20 2020  roupWarning,.   
-00012ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00012ac0: 2029 0a20 2020 2020 2020 2020 2020 2020   ).             
-00012ad0: 2020 2020 2020 2073 656c 662e 5f74 696d         self._tim
-00012ae0: 655f 7472 6176 656c 5f66 6f72 6d61 7420  e_travel_format 
-00012af0: 3d20 6578 7065 6374 6564 5f66 6f72 6d61  = expected_forma
-00012b00: 740a 0a20 2020 2020 2020 2020 2020 2073  t..            s
-00012b10: 656c 662e 7072 696d 6172 795f 6b65 7920  elf.primary_key 
-00012b20: 3d20 7072 696d 6172 795f 6b65 790a 2020  = primary_key.  
-00012b30: 2020 2020 2020 2020 2020 7365 6c66 2e70            self.p
-00012b40: 6172 7469 7469 6f6e 5f6b 6579 203d 2070  artition_key = p
-00012b50: 6172 7469 7469 6f6e 5f6b 6579 0a20 2020  artition_key.   
-00012b60: 2020 2020 2020 2020 2073 656c 662e 5f68           self._h
-00012b70: 7564 695f 7072 6563 6f6d 6269 6e65 5f6b  udi_precombine_k
-00012b80: 6579 203d 2028 0a20 2020 2020 2020 2020  ey = (.         
-00012b90: 2020 2020 2020 2068 7564 695f 7072 6563         hudi_prec
-00012ba0: 6f6d 6269 6e65 5f6b 6579 2e6c 6f77 6572  ombine_key.lower
-00012bb0: 2829 0a20 2020 2020 2020 2020 2020 2020  ().             
-00012bc0: 2020 2069 6620 6875 6469 5f70 7265 636f     if hudi_preco
-00012bd0: 6d62 696e 655f 6b65 7920 6973 206e 6f74  mbine_key is not
-00012be0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-00012bf0: 2020 2020 2020 616e 6420 7365 6c66 2e5f        and self._
-00012c00: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
-00012c10: 6174 2069 7320 6e6f 7420 4e6f 6e65 0a20  at is not None. 
-00012c20: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-00012c30: 6e64 2073 656c 662e 5f74 696d 655f 7472  nd self._time_tr
-00012c40: 6176 656c 5f66 6f72 6d61 7420 3d3d 2022  avel_format == "
-00012c50: 4855 4449 220a 2020 2020 2020 2020 2020  HUDI".          
-00012c60: 2020 2020 2020 656c 7365 204e 6f6e 650a        else None.
-00012c70: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-00012c80: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00012c90: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
-00012ca0: 203d 2073 7461 7469 7374 6963 735f 636f   = statistics_co
-00012cb0: 6e66 6967 0a0a 2020 2020 2020 2020 7365  nfig..        se
-00012cc0: 6c66 2e5f 6665 6174 7572 655f 6772 6f75  lf._feature_grou
-00012cd0: 705f 656e 6769 6e65 203d 2066 6561 7475  p_engine = featu
-00012ce0: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
-00012cf0: 4665 6174 7572 6547 726f 7570 456e 6769  FeatureGroupEngi
-00012d00: 6e65 280a 2020 2020 2020 2020 2020 2020  ne(.            
-00012d10: 6665 6174 7572 6573 746f 7265 5f69 640a  featurestore_id.
-00012d20: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00012d30: 2020 7365 6c66 2e5f 7665 6374 6f72 5f64    self._vector_d
-00012d40: 625f 636c 6965 6e74 203d 204e 6f6e 650a  b_client = None.
-00012d50: 2020 2020 2020 2020 7365 6c66 2e5f 6872          self._hr
-00012d60: 6566 203d 2068 7265 660a 0a20 2020 2020  ef = href..     
-00012d70: 2020 2023 2063 6163 6865 2066 6f72 206f     # cache for o
-00012d80: 7074 696d 697a 6564 2077 7269 7465 730a  ptimized writes.
-00012d90: 2020 2020 2020 2020 7365 6c66 2e5f 6b61          self._ka
-00012da0: 666b 615f 7072 6f64 7563 6572 203d 204e  fka_producer = N
-00012db0: 6f6e 650a 2020 2020 2020 2020 7365 6c66  one.        self
-00012dc0: 2e5f 6665 6174 7572 655f 7772 6974 6572  ._feature_writer
-00012dd0: 7320 3d20 4e6f 6e65 0a20 2020 2020 2020  s = None.       
-00012de0: 2073 656c 662e 5f77 7269 7465 7220 3d20   self._writer = 
-00012df0: 4e6f 6e65 0a0a 2020 2020 6465 6620 7265  None..    def re
-00012e00: 6164 280a 2020 2020 2020 2020 7365 6c66  ad(.        self
-00012e10: 2c0a 2020 2020 2020 2020 7761 6c6c 636c  ,.        wallcl
-00012e20: 6f63 6b5f 7469 6d65 3a20 4f70 7469 6f6e  ock_time: Option
-00012e30: 616c 5b55 6e69 6f6e 5b73 7472 2c20 696e  al[Union[str, in
-00012e40: 742c 2064 6174 6574 696d 652c 2064 6174  t, datetime, dat
-00012e50: 655d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  e]] = None,.    
-00012e60: 2020 2020 6f6e 6c69 6e65 3a20 4f70 7469      online: Opti
-00012e70: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
-00012e80: 7365 2c0a 2020 2020 2020 2020 6461 7461  se,.        data
-00012e90: 6672 616d 655f 7479 7065 3a20 4f70 7469  frame_type: Opti
-00012ea0: 6f6e 616c 5b73 7472 5d20 3d20 2264 6566  onal[str] = "def
-00012eb0: 6175 6c74 222c 0a20 2020 2020 2020 2072  ault",.        r
-00012ec0: 6561 645f 6f70 7469 6f6e 733a 204f 7074  ead_options: Opt
-00012ed0: 696f 6e61 6c5b 6469 6374 5d20 3d20 7b7d  ional[dict] = {}
-00012ee0: 2c0a 2020 2020 293a 0a20 2020 2020 2020  ,.    ):.       
-00012ef0: 2022 2222 0a20 2020 2020 2020 2052 6561   """.        Rea
-00012f00: 6420 7468 6520 6665 6174 7572 6520 6772  d the feature gr
-00012f10: 6f75 7020 696e 746f 2061 2064 6174 6166  oup into a dataf
-00012f20: 7261 6d65 2e0a 0a20 2020 2020 2020 2052  rame...        R
-00012f30: 6561 6473 2074 6865 2066 6561 7475 7265  eads the feature
-00012f40: 2067 726f 7570 2062 7920 6465 6661 756c   group by defaul
-00012f50: 7420 6672 6f6d 2074 6865 206f 6666 6c69  t from the offli
-00012f60: 6e65 2073 746f 7261 6765 2061 7320 5370  ne storage as Sp
-00012f70: 6172 6b20 4461 7461 4672 616d 650a 2020  ark DataFrame.  
-00012f80: 2020 2020 2020 6f6e 2048 6f70 7377 6f72        on Hopswor
-00012f90: 6b73 2061 6e64 2044 6174 6162 7269 636b  ks and Databrick
-00012fa0: 732c 2061 6e64 2061 7320 5061 6e64 6173  s, and as Pandas
-00012fb0: 2064 6174 6166 7261 6d65 206f 6e20 4157   dataframe on AW
-00012fc0: 5320 5361 6765 6d61 6b65 7220 616e 6420  S Sagemaker and 
-00012fd0: 7075 7265 0a20 2020 2020 2020 2050 7974  pure.        Pyt
-00012fe0: 686f 6e20 656e 7669 726f 6e6d 656e 7473  hon environments
-00012ff0: 2e0a 0a20 2020 2020 2020 2053 6574 2060  ...        Set `
-00013000: 6f6e 6c69 6e65 6020 746f 2060 5472 7565  online` to `True
-00013010: 6020 746f 2072 6561 6420 6672 6f6d 2074  ` to read from t
-00013020: 6865 206f 6e6c 696e 6520 7374 6f72 6167  he online storag
-00013030: 652c 206f 7220 6368 616e 6765 0a20 2020  e, or change.   
-00013040: 2020 2020 2060 6461 7461 6672 616d 655f       `dataframe_
-00013050: 7479 7065 6020 746f 2072 6561 6420 6173  type` to read as
-00013060: 2061 2064 6966 6665 7265 6e74 2066 6f72   a different for
-00013070: 6d61 742e 0a0a 2020 2020 2020 2020 2121  mat...        !!
-00013080: 2120 6578 616d 706c 6520 2252 6561 6420  ! example "Read 
-00013090: 6665 6174 7572 6520 6772 6f75 7020 6173  feature group as
-000130a0: 206f 6620 6c61 7465 7374 2073 7461 7465   of latest state
-000130b0: 3a22 0a20 2020 2020 2020 2020 2020 2060  :".            `
-000130c0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-000130d0: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
-000130e0: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
-000130f0: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
-00013100: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
-00013110: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
-00013120: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
-00013130: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
-00013140: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
-00013150: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
-00013160: 5f67 726f 7570 282e 2e2e 290a 2020 2020  _group(...).    
-00013170: 2020 2020 2020 2020 6667 2e72 6561 6428          fg.read(
-00013180: 290a 2020 2020 2020 2020 2020 2020 6060  ).            ``
-00013190: 600a 0a20 2020 2020 2020 2021 2121 2065  `..        !!! e
-000131a0: 7861 6d70 6c65 2022 5265 6164 2066 6561  xample "Read fea
-000131b0: 7475 7265 2067 726f 7570 2061 7320 6f66  ture group as of
-000131c0: 2073 7065 6369 6669 6320 706f 696e 7420   specific point 
-000131d0: 696e 2074 696d 653a 220a 2020 2020 2020  in time:".      
-000131e0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-000131f0: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
-00013200: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
-00013210: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
-00013220: 2e2e 2e29 0a20 2020 2020 2020 2020 2020  ...).           
-00013230: 2066 672e 7265 6164 2822 3230 3230 2d31   fg.read("2020-1
-00013240: 302d 3230 2030 373a 3334 3a31 3122 290a  0-20 07:34:11").
-00013250: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00013260: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
-00013270: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-00013280: 2077 616c 6c63 6c6f 636b 5f74 696d 653a   wallclock_time:
-00013290: 2049 6620 7370 6563 6966 6965 6420 7769   If specified wi
-000132a0: 6c6c 2072 6574 7269 6576 6520 6665 6174  ll retrieve feat
-000132b0: 7572 6520 6772 6f75 7020 6173 206f 6620  ure group as of 
-000132c0: 7370 6563 6966 6963 2070 6f69 6e74 2069  specific point i
-000132d0: 6e20 7469 6d65 2e20 4465 6661 756c 7473  n time. Defaults
-000132e0: 2074 6f20 604e 6f6e 6560 2e0a 2020 2020   to `None`..    
-000132f0: 2020 2020 2020 2020 2020 2020 4966 206e              If n
-00013300: 6f74 2073 7065 6369 6669 6564 2c20 7769  ot specified, wi
-00013310: 6c6c 2072 6574 7572 6e20 6173 206f 6620  ll return as of 
-00013320: 6d6f 7374 2072 6563 656e 7420 7469 6d65  most recent time
-00013330: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013340: 2020 5374 7269 6e67 7320 7368 6f75 6c64    Strings should
-00013350: 2062 6520 666f 726d 6174 7465 6420 696e   be formatted in
-00013360: 206f 6e65 206f 6620 7468 6520 666f 6c6c   one of the foll
-00013370: 6f77 696e 6720 666f 726d 6174 7320 6025  owing formats `%
-00013380: 592d 256d 2d25 6460 2c20 6025 592d 256d  Y-%m-%d`, `%Y-%m
-00013390: 2d25 6420 2548 602c 2060 2559 2d25 6d2d  -%d %H`, `%Y-%m-
-000133a0: 2564 2025 483a 254d 602c 2060 2559 2d25  %d %H:%M`, `%Y-%
-000133b0: 6d2d 2564 2025 483a 254d 3a25 5360 2c0a  m-%d %H:%M:%S`,.
-000133c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000133d0: 6f72 2060 2559 2d25 6d2d 2564 2025 483a  or `%Y-%m-%d %H:
-000133e0: 254d 3a25 532e 2566 602e 0a20 2020 2020  %M:%S.%f`..     
-000133f0: 2020 2020 2020 206f 6e6c 696e 653a 2062         online: b
-00013400: 6f6f 6c2c 206f 7074 696f 6e61 6c2e 2049  ool, optional. I
-00013410: 6620 6054 7275 6560 2072 6561 6420 6672  f `True` read fr
-00013420: 6f6d 206f 6e6c 696e 6520 6665 6174 7572  om online featur
-00013430: 6520 7374 6f72 652c 2064 6566 6175 6c74  e store, default
-00013440: 730a 2020 2020 2020 2020 2020 2020 2020  s.              
-00013450: 2020 746f 2060 4661 6c73 6560 2e0a 2020    to `False`..  
-00013460: 2020 2020 2020 2020 2020 6461 7461 6672            datafr
-00013470: 616d 655f 7479 7065 3a20 7374 722c 206f  ame_type: str, o
-00013480: 7074 696f 6e61 6c2e 2050 6f73 7369 626c  ptional. Possibl
-00013490: 6520 7661 6c75 6573 2061 7265 2060 2264  e values are `"d
-000134a0: 6566 6175 6c74 2260 2c20 6022 7370 6172  efault"`, `"spar
-000134b0: 6b22 602c 0a20 2020 2020 2020 2020 2020  k"`,.           
-000134c0: 2020 2020 2060 2270 616e 6461 7322 602c       `"pandas"`,
-000134d0: 2060 226e 756d 7079 2260 206f 7220 6022   `"numpy"` or `"
-000134e0: 7079 7468 6f6e 2260 2c20 6465 6661 756c  python"`, defaul
-000134f0: 7473 2074 6f20 6022 6465 6661 756c 7422  ts to `"default"
-00013500: 602e 0a20 2020 2020 2020 2020 2020 2072  `..            r
-00013510: 6561 645f 6f70 7469 6f6e 733a 2041 6464  ead_options: Add
-00013520: 6974 696f 6e61 6c20 6f70 7469 6f6e 7320  itional options 
-00013530: 6173 206b 6579 2f76 616c 7565 2070 6169  as key/value pai
-00013540: 7273 2074 6f20 7061 7373 2074 6f20 7468  rs to pass to th
-00013550: 6520 6578 6563 7574 696f 6e20 656e 6769  e execution engi
-00013560: 6e65 2e0a 2020 2020 2020 2020 2020 2020  ne..            
-00013570: 2020 2020 466f 7220 7370 6172 6b20 656e      For spark en
-00013580: 6769 6e65 3a20 4469 6374 696f 6e61 7279  gine: Dictionary
-00013590: 206f 6620 7265 6164 206f 7074 696f 6e73   of read options
-000135a0: 2066 6f72 2053 7061 726b 2e0a 2020 2020   for Spark..    
-000135b0: 2020 2020 2020 2020 2020 2020 466f 7220              For 
-000135c0: 7079 7468 6f6e 2065 6e67 696e 653a 0a20  python engine:. 
-000135d0: 2020 2020 2020 2020 2020 2020 2020 202a                 *
-000135e0: 206b 6579 2060 2275 7365 5f68 6976 6522   key `"use_hive"
-000135f0: 6020 616e 6420 7661 6c75 6520 6054 7275  ` and value `Tru
-00013600: 6560 2074 6f20 7265 6164 2066 6561 7475  e` to read featu
-00013610: 7265 2067 726f 7570 0a20 2020 2020 2020  re group.       
-00013620: 2020 2020 2020 2020 2020 2077 6974 6820             with 
-00013630: 4869 7665 2069 6e73 7465 6164 206f 6620  Hive instead of 
-00013640: 5b41 7272 6f77 466c 6967 6874 2053 6572  [ArrowFlight Ser
-00013650: 7665 725d 2868 7474 7073 3a2f 2f64 6f63  ver](https://doc
-00013660: 732e 686f 7073 776f 726b 732e 6169 2f6c  s.hopsworks.ai/l
-00013670: 6174 6573 742f 7365 7475 705f 696e 7374  atest/setup_inst
-00013680: 616c 6c61 7469 6f6e 2f63 6f6d 6d6f 6e2f  allation/common/
-00013690: 6172 726f 775f 666c 6967 6874 5f64 7563  arrow_flight_duc
-000136a0: 6b64 622f 292e 0a20 2020 2020 2020 2020  kdb/)..         
-000136b0: 2020 2020 2020 202a 206b 6579 2060 2261         * key `"a
-000136c0: 7272 6f77 5f66 6c69 6768 745f 636f 6e66  rrow_flight_conf
-000136d0: 6967 2260 2074 6f20 7061 7373 2061 2064  ig"` to pass a d
-000136e0: 6963 7469 6f6e 6172 7920 6f66 2061 7272  ictionary of arr
-000136f0: 6f77 2066 6c69 6768 7420 636f 6e66 6967  ow flight config
-00013700: 7572 6174 696f 6e73 2e0a 2020 2020 2020  urations..      
-00013710: 2020 2020 2020 2020 2020 2020 466f 7220              For 
-00013720: 6578 616d 706c 653a 2060 7b22 6172 726f  example: `{"arro
-00013730: 775f 666c 6967 6874 5f63 6f6e 6669 6722  w_flight_config"
-00013740: 3a20 7b22 7469 6d65 6f75 7422 3a20 3930  : {"timeout": 90
-00013750: 307d 7d60 0a20 2020 2020 2020 2020 2020  0}}`.           
-00013760: 2020 2020 202a 206b 6579 2060 2268 6976       * key `"hiv
-00013770: 655f 636f 6e66 6967 2260 2074 6f20 7061  e_config"` to pa
-00013780: 7373 2061 2064 6963 7469 6f6e 6172 7920  ss a dictionary 
-00013790: 6f66 2068 6976 6520 6f72 2074 657a 2063  of hive or tez c
-000137a0: 6f6e 6669 6775 7261 7469 6f6e 732e 0a20  onfigurations.. 
-000137b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000137c0: 2046 6f72 2065 7861 6d70 6c65 3a20 607b   For example: `{
-000137d0: 2268 6976 655f 636f 6e66 6967 223a 207b  "hive_config": {
-000137e0: 2268 6976 652e 7465 7a2e 6370 752e 7663  "hive.tez.cpu.vc
-000137f0: 6f72 6573 223a 2032 2c20 2274 657a 2e67  ores": 2, "tez.g
-00013800: 726f 7570 696e 672e 7370 6c69 742d 636f  rouping.split-co
-00013810: 756e 7422 3a20 2233 227d 7d60 0a20 2020  unt": "3"}}`.   
-00013820: 2020 2020 2020 2020 2020 2020 202a 206b               * k
-00013830: 6579 2060 2270 616e 6461 735f 7479 7065  ey `"pandas_type
-00013840: 7322 6020 616e 6420 7661 6c75 6520 6054  s"` and value `T
-00013850: 7275 6560 2074 6f20 7265 7472 6965 7665  rue` to retrieve
-00013860: 2063 6f6c 756d 6e73 2061 730a 2020 2020   columns as.    
-00013870: 2020 2020 2020 2020 2020 2020 2020 5b50                [P
-00013880: 616e 6461 7320 6e75 6c6c 6162 6c65 2074  andas nullable t
-00013890: 7970 6573 5d28 6874 7470 733a 2f2f 7061  ypes](https://pa
-000138a0: 6e64 6173 2e70 7964 6174 612e 6f72 672f  ndas.pydata.org/
-000138b0: 646f 6373 2f75 7365 725f 6775 6964 652f  docs/user_guide/
-000138c0: 696e 7465 6765 725f 6e61 2e68 746d 6c29  integer_na.html)
+00011950: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00011960: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+00011970: 6574 7572 6e20 5472 7565 0a0a 2020 2020  eturn True..    
+00011980: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00011990: 656c 662e 7374 6174 6973 7469 6373 5f63  elf.statistics_c
+000119a0: 6f6e 6669 672e 6578 6163 745f 756e 6971  onfig.exact_uniq
+000119b0: 7565 6e65 7373 2061 6e64 2066 6473 2e75  ueness and fds.u
+000119c0: 6e69 7175 656e 6573 7320 6973 204e 6f6e  niqueness is Non
+000119d0: 653a 0a20 2020 2020 2020 2020 2020 2020  e:.             
+000119e0: 2020 2020 2020 2072 6574 7572 6e20 5472         return Tr
+000119f0: 7565 0a0a 2020 2020 2020 2020 7265 7475  ue..        retu
+00011a00: 726e 2046 616c 7365 0a0a 2020 2020 6465  rn False..    de
+00011a10: 6620 5f61 7265 5f73 7461 7469 7374 6963  f _are_statistic
+00011a20: 735f 7375 7070 6f72 7465 6428 7365 6c66  s_supported(self
+00011a30: 293a 0a20 2020 2020 2020 2022 2222 5768  ):.        """Wh
+00011a40: 6574 6865 7220 7374 6174 6973 7469 6373  ether statistics
+00011a50: 2061 7265 2073 7570 706f 7274 6564 206f   are supported o
+00011a60: 7220 6e6f 7420 666f 7220 7468 6520 6375  r not for the cu
+00011a70: 7272 656e 7420 4665 6174 7572 6520 4772  rrent Feature Gr
+00011a80: 6f75 7020 7479 7065 2222 220a 2020 2020  oup type""".    
+00011a90: 2020 2020 7265 7475 726e 206e 6f74 2069      return not i
+00011aa0: 7369 6e73 7461 6e63 6528 7365 6c66 2c20  sinstance(self, 
+00011ab0: 5370 696e 6547 726f 7570 290a 0a20 2020  SpineGroup)..   
+00011ac0: 2064 6566 205f 6368 6563 6b5f 7374 6174   def _check_stat
+00011ad0: 6973 7469 6373 5f73 7570 706f 7274 2873  istics_support(s
+00011ae0: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00011af0: 2243 6865 636b 2066 6f72 2073 7461 7469  "Check for stati
+00011b00: 7374 6963 7320 7375 7070 6f72 7420 6f6e  stics support on
+00011b10: 2074 6865 2063 7572 7265 6e74 2046 6561   the current Fea
+00011b20: 7475 7265 2047 726f 7570 2074 7970 6522  ture Group type"
+00011b30: 2222 0a20 2020 2020 2020 2069 6620 6e6f  "".        if no
+00011b40: 7420 7365 6c66 2e5f 6172 655f 7374 6174  t self._are_stat
+00011b50: 6973 7469 6373 5f73 7570 706f 7274 6564  istics_supported
+00011b60: 2829 3a0a 2020 2020 2020 2020 2020 2020  ():.            
+00011b70: 7261 6973 6520 4665 6174 7572 6553 746f  raise FeatureSto
+00011b80: 7265 4578 6365 7074 696f 6e28 0a20 2020  reException(.   
+00011b90: 2020 2020 2020 2020 2020 2020 2022 5374               "St
+00011ba0: 6174 6973 7469 6373 206e 6f74 2073 7570  atistics not sup
+00011bb0: 706f 7274 6564 2066 6f72 2074 6869 7320  ported for this 
+00011bc0: 4665 6174 7572 6520 4772 6f75 7020 7479  Feature Group ty
+00011bd0: 7065 220a 2020 2020 2020 2020 2020 2020  pe".            
+00011be0: 290a 0a20 2020 2040 6665 6174 7572 6573  )..    @features
+00011bf0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+00011c00: 6665 6174 7572 6573 2873 656c 662c 206e  features(self, n
+00011c10: 6577 5f66 6561 7475 7265 7329 3a0a 2020  ew_features):.  
+00011c20: 2020 2020 2020 7365 6c66 2e5f 6665 6174        self._feat
+00011c30: 7572 6573 203d 206e 6577 5f66 6561 7475  ures = new_featu
+00011c40: 7265 730a 0a20 2020 2064 6566 205f 6765  res..    def _ge
+00011c50: 745f 7072 6f6a 6563 745f 6e61 6d65 2873  t_project_name(s
+00011c60: 656c 6629 3a0a 2020 2020 2020 2020 7265  elf):.        re
+00011c70: 7475 726e 2075 7469 6c2e 7374 7269 705f  turn util.strip_
+00011c80: 6665 6174 7572 655f 7374 6f72 655f 7375  feature_store_su
+00011c90: 6666 6978 2873 656c 662e 6665 6174 7572  ffix(self.featur
+00011ca0: 655f 7374 6f72 655f 6e61 6d65 290a 0a0a  e_store_name)...
+00011cb0: 636c 6173 7320 4665 6174 7572 6547 726f  class FeatureGro
+00011cc0: 7570 2846 6561 7475 7265 4772 6f75 7042  up(FeatureGroupB
+00011cd0: 6173 6529 3a0a 2020 2020 4341 4348 4544  ase):.    CACHED
+00011ce0: 5f46 4541 5455 5245 5f47 524f 5550 203d  _FEATURE_GROUP =
+00011cf0: 2022 4341 4348 4544 5f46 4541 5455 5245   "CACHED_FEATURE
+00011d00: 5f47 524f 5550 220a 2020 2020 5354 5245  _GROUP".    STRE
+00011d10: 414d 5f46 4541 5455 5245 5f47 524f 5550  AM_FEATURE_GROUP
+00011d20: 203d 2022 5354 5245 414d 5f46 4541 5455   = "STREAM_FEATU
+00011d30: 5245 5f47 524f 5550 220a 2020 2020 454e  RE_GROUP".    EN
+00011d40: 5449 5459 5f54 5950 4520 3d20 2266 6561  TITY_TYPE = "fea
+00011d50: 7475 7265 6772 6f75 7073 220a 0a20 2020  turegroups"..   
+00011d60: 2064 6566 205f 5f69 6e69 745f 5f28 0a20   def __init__(. 
+00011d70: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00011d80: 2020 2020 206e 616d 652c 0a20 2020 2020       name,.     
+00011d90: 2020 2076 6572 7369 6f6e 2c0a 2020 2020     version,.    
+00011da0: 2020 2020 6665 6174 7572 6573 746f 7265      featurestore
+00011db0: 5f69 642c 0a20 2020 2020 2020 2064 6573  _id,.        des
+00011dc0: 6372 6970 7469 6f6e 3d22 222c 0a20 2020  cription="",.   
+00011dd0: 2020 2020 2070 6172 7469 7469 6f6e 5f6b       partition_k
+00011de0: 6579 3d4e 6f6e 652c 0a20 2020 2020 2020  ey=None,.       
+00011df0: 2070 7269 6d61 7279 5f6b 6579 3d4e 6f6e   primary_key=Non
+00011e00: 652c 0a20 2020 2020 2020 2068 7564 695f  e,.        hudi_
+00011e10: 7072 6563 6f6d 6269 6e65 5f6b 6579 3d4e  precombine_key=N
+00011e20: 6f6e 652c 0a20 2020 2020 2020 2066 6561  one,.        fea
+00011e30: 7475 7265 7374 6f72 655f 6e61 6d65 3d4e  turestore_name=N
+00011e40: 6f6e 652c 0a20 2020 2020 2020 2065 6d62  one,.        emb
+00011e50: 6564 6469 6e67 5f69 6e64 6578 3d4e 6f6e  edding_index=Non
+00011e60: 652c 0a20 2020 2020 2020 2063 7265 6174  e,.        creat
+00011e70: 6564 3d4e 6f6e 652c 0a20 2020 2020 2020  ed=None,.       
+00011e80: 2063 7265 6174 6f72 3d4e 6f6e 652c 0a20   creator=None,. 
+00011e90: 2020 2020 2020 2069 643d 4e6f 6e65 2c0a         id=None,.
+00011ea0: 2020 2020 2020 2020 6665 6174 7572 6573          features
+00011eb0: 3d4e 6f6e 652c 0a20 2020 2020 2020 206c  =None,.        l
+00011ec0: 6f63 6174 696f 6e3d 4e6f 6e65 2c0a 2020  ocation=None,.  
+00011ed0: 2020 2020 2020 6f6e 6c69 6e65 5f65 6e61        online_ena
+00011ee0: 626c 6564 3d46 616c 7365 2c0a 2020 2020  bled=False,.    
+00011ef0: 2020 2020 7469 6d65 5f74 7261 7665 6c5f      time_travel_
+00011f00: 666f 726d 6174 3d4e 6f6e 652c 0a20 2020  format=None,.   
+00011f10: 2020 2020 2073 7461 7469 7374 6963 735f       statistics_
+00011f20: 636f 6e66 6967 3d4e 6f6e 652c 0a20 2020  config=None,.   
+00011f30: 2020 2020 206f 6e6c 696e 655f 746f 7069       online_topi
+00011f40: 635f 6e61 6d65 3d4e 6f6e 652c 0a20 2020  c_name=None,.   
+00011f50: 2020 2020 2074 6f70 6963 5f6e 616d 653d       topic_name=
+00011f60: 4e6f 6e65 2c0a 2020 2020 2020 2020 6e6f  None,.        no
+00011f70: 7469 6669 6361 7469 6f6e 5f74 6f70 6963  tification_topic
+00011f80: 5f6e 616d 653d 4e6f 6e65 2c0a 2020 2020  _name=None,.    
+00011f90: 2020 2020 6576 656e 745f 7469 6d65 3d4e      event_time=N
+00011fa0: 6f6e 652c 0a20 2020 2020 2020 2073 7472  one,.        str
+00011fb0: 6561 6d3d 4661 6c73 652c 0a20 2020 2020  eam=False,.     
+00011fc0: 2020 2065 7870 6563 7461 7469 6f6e 5f73     expectation_s
+00011fd0: 7569 7465 3d4e 6f6e 652c 0a20 2020 2020  uite=None,.     
+00011fe0: 2020 2070 6172 656e 7473 3d4e 6f6e 652c     parents=None,
+00011ff0: 0a20 2020 2020 2020 2068 7265 663d 4e6f  .        href=No
+00012000: 6e65 2c0a 2020 2020 2020 2020 6465 6c74  ne,.        delt
+00012010: 615f 7374 7265 616d 6572 5f6a 6f62 5f63  a_streamer_job_c
+00012020: 6f6e 663d 4e6f 6e65 2c0a 2020 2020 2020  onf=None,.      
+00012030: 2020 6465 7072 6563 6174 6564 3d46 616c    deprecated=Fal
+00012040: 7365 2c0a 2020 2020 2020 2020 2a2a 6b77  se,.        **kw
+00012050: 6172 6773 2c0a 2020 2020 293a 0a20 2020  args,.    ):.   
+00012060: 2020 2020 2073 7570 6572 2829 2e5f 5f69       super().__i
+00012070: 6e69 745f 5f28 0a20 2020 2020 2020 2020  nit__(.         
+00012080: 2020 206e 616d 652c 0a20 2020 2020 2020     name,.       
+00012090: 2020 2020 2076 6572 7369 6f6e 2c0a 2020       version,.  
+000120a0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+000120b0: 6573 746f 7265 5f69 642c 0a20 2020 2020  estore_id,.     
+000120c0: 2020 2020 2020 206c 6f63 6174 696f 6e2c         location,
+000120d0: 0a20 2020 2020 2020 2020 2020 2065 7665  .            eve
+000120e0: 6e74 5f74 696d 653d 6576 656e 745f 7469  nt_time=event_ti
+000120f0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+00012100: 6f6e 6c69 6e65 5f65 6e61 626c 6564 3d6f  online_enabled=o
+00012110: 6e6c 696e 655f 656e 6162 6c65 642c 0a20  nline_enabled,. 
+00012120: 2020 2020 2020 2020 2020 2065 6d62 6564             embed
+00012130: 6469 6e67 5f69 6e64 6578 3d65 6d62 6564  ding_index=embed
+00012140: 6469 6e67 5f69 6e64 6578 2c0a 2020 2020  ding_index,.    
+00012150: 2020 2020 2020 2020 6964 3d69 642c 0a20          id=id,. 
+00012160: 2020 2020 2020 2020 2020 2065 7870 6563             expec
+00012170: 7461 7469 6f6e 5f73 7569 7465 3d65 7870  tation_suite=exp
+00012180: 6563 7461 7469 6f6e 5f73 7569 7465 2c0a  ectation_suite,.
+00012190: 2020 2020 2020 2020 2020 2020 6f6e 6c69              onli
+000121a0: 6e65 5f74 6f70 6963 5f6e 616d 653d 6f6e  ne_topic_name=on
+000121b0: 6c69 6e65 5f74 6f70 6963 5f6e 616d 652c  line_topic_name,
+000121c0: 0a20 2020 2020 2020 2020 2020 2074 6f70  .            top
+000121d0: 6963 5f6e 616d 653d 746f 7069 635f 6e61  ic_name=topic_na
+000121e0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+000121f0: 6e6f 7469 6669 6361 7469 6f6e 5f74 6f70  notification_top
+00012200: 6963 5f6e 616d 653d 6e6f 7469 6669 6361  ic_name=notifica
+00012210: 7469 6f6e 5f74 6f70 6963 5f6e 616d 652c  tion_topic_name,
+00012220: 0a20 2020 2020 2020 2020 2020 2064 6570  .            dep
+00012230: 7265 6361 7465 643d 6465 7072 6563 6174  recated=deprecat
+00012240: 6564 2c0a 2020 2020 2020 2020 290a 2020  ed,.        ).  
+00012250: 2020 2020 2020 7365 6c66 2e5f 6665 6174        self._feat
+00012260: 7572 655f 7374 6f72 655f 6e61 6d65 203d  ure_store_name =
+00012270: 2066 6561 7475 7265 7374 6f72 655f 6e61   featurestore_na
+00012280: 6d65 0a20 2020 2020 2020 2073 656c 662e  me.        self.
+00012290: 5f64 6573 6372 6970 7469 6f6e 203d 2064  _description = d
+000122a0: 6573 6372 6970 7469 6f6e 0a20 2020 2020  escription.     
+000122b0: 2020 2073 656c 662e 5f63 7265 6174 6564     self._created
+000122c0: 203d 2063 7265 6174 6564 0a20 2020 2020   = created.     
+000122d0: 2020 2073 656c 662e 5f63 7265 6174 6f72     self._creator
+000122e0: 203d 2075 7365 722e 5573 6572 2e66 726f   = user.User.fro
+000122f0: 6d5f 7265 7370 6f6e 7365 5f6a 736f 6e28  m_response_json(
+00012300: 6372 6561 746f 7229 0a20 2020 2020 2020  creator).       
+00012310: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
+00012320: 3d20 5b0a 2020 2020 2020 2020 2020 2020  = [.            
+00012330: 6665 6174 7572 652e 4665 6174 7572 652e  feature.Feature.
+00012340: 6672 6f6d 5f72 6573 706f 6e73 655f 6a73  from_response_js
+00012350: 6f6e 2866 6561 7429 2069 6620 6973 696e  on(feat) if isin
+00012360: 7374 616e 6365 2866 6561 742c 2064 6963  stance(feat, dic
+00012370: 7429 2065 6c73 6520 6665 6174 0a20 2020  t) else feat.   
+00012380: 2020 2020 2020 2020 2066 6f72 2066 6561           for fea
+00012390: 7420 696e 2028 6665 6174 7572 6573 206f  t in (features o
+000123a0: 7220 5b5d 290a 2020 2020 2020 2020 5d0a  r []).        ].
+000123b0: 0a20 2020 2020 2020 2073 656c 662e 5f74  .        self._t
+000123c0: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
+000123d0: 7420 3d20 280a 2020 2020 2020 2020 2020  t = (.          
+000123e0: 2020 7469 6d65 5f74 7261 7665 6c5f 666f    time_travel_fo
+000123f0: 726d 6174 2e75 7070 6572 2829 2069 6620  rmat.upper() if 
+00012400: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
+00012410: 6174 2069 7320 6e6f 7420 4e6f 6e65 2065  at is not None e
+00012420: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
+00012430: 2029 0a0a 2020 2020 2020 2020 7365 6c66   )..        self
+00012440: 2e5f 7374 7265 616d 203d 2073 7472 6561  ._stream = strea
+00012450: 6d0a 2020 2020 2020 2020 7365 6c66 2e5f  m.        self._
+00012460: 7061 7265 6e74 7320 3d20 7061 7265 6e74  parents = parent
+00012470: 730a 2020 2020 2020 2020 7365 6c66 2e5f  s.        self._
+00012480: 6465 6c74 6173 7472 6561 6d65 725f 6a6f  deltastreamer_jo
+00012490: 6263 6f6e 6620 3d20 6465 6c74 615f 7374  bconf = delta_st
+000124a0: 7265 616d 6572 5f6a 6f62 5f63 6f6e 660a  reamer_job_conf.
+000124b0: 0a20 2020 2020 2020 2073 656c 662e 5f6d  .        self._m
+000124c0: 6174 6572 6961 6c69 7a61 7469 6f6e 5f6a  aterialization_j
+000124d0: 6f62 203d 204e 6f6e 650a 0a20 2020 2020  ob = None..     
+000124e0: 2020 2069 6620 7365 6c66 2e5f 6964 3a0a     if self._id:.
+000124f0: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00012500: 6974 6961 6c69 7a65 6420 6279 2062 6163  itialized by bac
+00012510: 6b65 6e64 0a20 2020 2020 2020 2020 2020  kend.           
+00012520: 2073 656c 662e 7072 696d 6172 795f 6b65   self.primary_ke
+00012530: 7920 3d20 5b0a 2020 2020 2020 2020 2020  y = [.          
+00012540: 2020 2020 2020 6665 6174 2e6e 616d 6520        feat.name 
+00012550: 666f 7220 6665 6174 2069 6e20 7365 6c66  for feat in self
+00012560: 2e5f 6665 6174 7572 6573 2069 6620 6665  ._features if fe
+00012570: 6174 2e70 7269 6d61 7279 2069 7320 5472  at.primary is Tr
+00012580: 7565 0a20 2020 2020 2020 2020 2020 205d  ue.            ]
+00012590: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000125a0: 662e 5f70 6172 7469 7469 6f6e 5f6b 6579  f._partition_key
+000125b0: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
+000125c0: 2020 2020 2066 6561 742e 6e61 6d65 2066       feat.name f
+000125d0: 6f72 2066 6561 7420 696e 2073 656c 662e  or feat in self.
+000125e0: 5f66 6561 7475 7265 7320 6966 2066 6561  _features if fea
+000125f0: 742e 7061 7274 6974 696f 6e20 6973 2054  t.partition is T
+00012600: 7275 650a 2020 2020 2020 2020 2020 2020  rue.            
+00012610: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00012620: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00012630: 2020 2074 696d 655f 7472 6176 656c 5f66     time_travel_f
+00012640: 6f72 6d61 7420 6973 206e 6f74 204e 6f6e  ormat is not Non
+00012650: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00012660: 2020 616e 6420 7469 6d65 5f74 7261 7665    and time_trave
+00012670: 6c5f 666f 726d 6174 2e75 7070 6572 2829  l_format.upper()
+00012680: 203d 3d20 2248 5544 4922 0a20 2020 2020   == "HUDI".     
+00012690: 2020 2020 2020 2020 2020 2061 6e64 2073             and s
+000126a0: 656c 662e 5f66 6561 7475 7265 730a 2020  elf._features.  
+000126b0: 2020 2020 2020 2020 2020 293a 0a20 2020            ):.   
+000126c0: 2020 2020 2020 2020 2020 2020 2023 2068               # h
+000126d0: 7564 6920 7072 6563 6f6d 6269 6e65 206b  udi precombine k
+000126e0: 6579 2069 7320 616c 7761 7973 2061 2073  ey is always a s
+000126f0: 696e 676c 6520 6665 6174 7572 650a 2020  ingle feature.  
+00012700: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00012710: 6c66 2e5f 6875 6469 5f70 7265 636f 6d62  lf._hudi_precomb
+00012720: 696e 655f 6b65 7920 3d20 5b0a 2020 2020  ine_key = [.    
+00012730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012740: 6665 6174 2e6e 616d 650a 2020 2020 2020  feat.name.      
+00012750: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+00012760: 7220 6665 6174 2069 6e20 7365 6c66 2e5f  r feat in self._
+00012770: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
+00012780: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00012790: 6665 6174 2e68 7564 695f 7072 6563 6f6d  feat.hudi_precom
+000127a0: 6269 6e65 5f6b 6579 2069 7320 5472 7565  bine_key is True
+000127b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000127c0: 205d 5b30 5d0a 2020 2020 2020 2020 2020   ][0].          
+000127d0: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+000127e0: 2020 2020 2020 2020 7365 6c66 2e5f 6875          self._hu
+000127f0: 6469 5f70 7265 636f 6d62 696e 655f 6b65  di_precombine_ke
+00012800: 7920 3d20 4e6f 6e65 0a0a 2020 2020 2020  y = None..      
+00012810: 2020 2020 2020 7365 6c66 2e73 7461 7469        self.stati
+00012820: 7374 6963 735f 636f 6e66 6967 203d 2073  stics_config = s
+00012830: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
+00012840: 0a0a 2020 2020 2020 2020 656c 7365 3a0a  ..        else:.
+00012850: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+00012860: 6974 6961 6c69 7a65 6420 6279 2075 7365  itialized by use
+00012870: 720a 2020 2020 2020 2020 2020 2020 2320  r.            # 
+00012880: 666f 7220 7079 7468 6f6e 2065 6e67 696e  for python engin
+00012890: 6520 7765 2061 6c77 6179 7320 7573 6520  e we always use 
+000128a0: 7374 7265 616d 2066 6561 7475 7265 2067  stream feature g
+000128b0: 726f 7570 0a20 2020 2020 2020 2020 2020  roup.           
+000128c0: 2069 6620 656e 6769 6e65 2e67 6574 5f74   if engine.get_t
+000128d0: 7970 6528 2920 3d3d 2022 7079 7468 6f6e  ype() == "python
+000128e0: 223a 0a20 2020 2020 2020 2020 2020 2020  ":.             
+000128f0: 2020 2073 656c 662e 5f73 7472 6561 6d20     self._stream 
+00012900: 3d20 5472 7565 0a20 2020 2020 2020 2020  = True.         
+00012910: 2020 2023 2066 6f72 2073 7472 6561 6d20     # for stream 
+00012920: 6665 6174 7572 6520 6772 6f75 7020 7469  feature group ti
+00012930: 6d65 2074 7261 7665 6c20 666f 726d 6174  me travel format
+00012940: 2069 7320 616c 7761 7973 2048 5544 490a   is always HUDI.
+00012950: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00012960: 656c 662e 5f73 7472 6561 6d3a 0a20 2020  elf._stream:.   
+00012970: 2020 2020 2020 2020 2020 2020 2065 7870               exp
+00012980: 6563 7465 645f 666f 726d 6174 203d 2022  ected_format = "
+00012990: 4855 4449 220a 2020 2020 2020 2020 2020  HUDI".          
+000129a0: 2020 2020 2020 6966 2073 656c 662e 5f74        if self._t
+000129b0: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
+000129c0: 7420 213d 2065 7870 6563 7465 645f 666f  t != expected_fo
+000129d0: 726d 6174 3a0a 2020 2020 2020 2020 2020  rmat:.          
+000129e0: 2020 2020 2020 2020 2020 7761 726e 696e            warnin
+000129f0: 6773 2e77 6172 6e28 0a20 2020 2020 2020  gs.warn(.       
+00012a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a10: 2028 0a20 2020 2020 2020 2020 2020 2020   (.             
+00012a20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+00012a30: 5468 6520 7072 6f76 6964 6564 2074 696d  The provided tim
+00012a40: 6520 7472 6176 656c 2066 6f72 6d61 7420  e travel format 
+00012a50: 607b 7d60 2068 6173 2062 6565 6e20 6f76  `{}` has been ov
+00012a60: 6572 7772 6974 7465 6e20 220a 2020 2020  erwritten ".    
+00012a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012a80: 2020 2020 2020 2020 2262 6563 6175 7365          "because
+00012a90: 2053 7472 6561 6d20 656e 6162 6c65 6420   Stream enabled 
+00012aa0: 6665 6174 7572 6520 6772 6f75 7073 206f  feature groups o
+00012ab0: 6e6c 7920 7375 7070 6f72 7420 607b 7d60  nly support `{}`
+00012ac0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
+00012ad0: 2020 2020 2020 2020 2020 292e 666f 726d            ).form
+00012ae0: 6174 2873 656c 662e 5f74 696d 655f 7472  at(self._time_tr
+00012af0: 6176 656c 5f66 6f72 6d61 742c 2065 7870  avel_format, exp
+00012b00: 6563 7465 645f 666f 726d 6174 292c 0a20  ected_format),. 
+00012b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012b20: 2020 2020 2020 2075 7469 6c2e 4665 6174         util.Feat
+00012b30: 7572 6547 726f 7570 5761 726e 696e 672c  ureGroupWarning,
+00012b40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012b50: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+00012b60: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00012b70: 5f74 696d 655f 7472 6176 656c 5f66 6f72  _time_travel_for
+00012b80: 6d61 7420 3d20 6578 7065 6374 6564 5f66  mat = expected_f
+00012b90: 6f72 6d61 740a 0a20 2020 2020 2020 2020  ormat..         
+00012ba0: 2020 2073 656c 662e 7072 696d 6172 795f     self.primary_
+00012bb0: 6b65 7920 3d20 7072 696d 6172 795f 6b65  key = primary_ke
+00012bc0: 790a 2020 2020 2020 2020 2020 2020 7365  y.            se
+00012bd0: 6c66 2e70 6172 7469 7469 6f6e 5f6b 6579  lf.partition_key
+00012be0: 203d 2070 6172 7469 7469 6f6e 5f6b 6579   = partition_key
+00012bf0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00012c00: 662e 5f68 7564 695f 7072 6563 6f6d 6269  f._hudi_precombi
+00012c10: 6e65 5f6b 6579 203d 2028 0a20 2020 2020  ne_key = (.     
+00012c20: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
+00012c30: 6175 746f 6669 785f 6665 6174 7572 655f  autofix_feature_
+00012c40: 6e61 6d65 2868 7564 695f 7072 6563 6f6d  name(hudi_precom
+00012c50: 6269 6e65 5f6b 6579 290a 2020 2020 2020  bine_key).      
+00012c60: 2020 2020 2020 2020 2020 6966 2068 7564            if hud
+00012c70: 695f 7072 6563 6f6d 6269 6e65 5f6b 6579  i_precombine_key
+00012c80: 2069 7320 6e6f 7420 4e6f 6e65 0a20 2020   is not None.   
+00012c90: 2020 2020 2020 2020 2020 2020 2061 6e64               and
+00012ca0: 2073 656c 662e 5f74 696d 655f 7472 6176   self._time_trav
+00012cb0: 656c 5f66 6f72 6d61 7420 6973 206e 6f74  el_format is not
+00012cc0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
+00012cd0: 2020 2020 2020 616e 6420 7365 6c66 2e5f        and self._
+00012ce0: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
+00012cf0: 6174 203d 3d20 2248 5544 4922 0a20 2020  at == "HUDI".   
+00012d00: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00012d10: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
+00012d20: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00012d30: 2073 656c 662e 7374 6174 6973 7469 6373   self.statistics
+00012d40: 5f63 6f6e 6669 6720 3d20 7374 6174 6973  _config = statis
+00012d50: 7469 6373 5f63 6f6e 6669 670a 0a20 2020  tics_config..   
+00012d60: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
+00012d70: 7265 5f67 726f 7570 5f65 6e67 696e 6520  re_group_engine 
+00012d80: 3d20 6665 6174 7572 655f 6772 6f75 705f  = feature_group_
+00012d90: 656e 6769 6e65 2e46 6561 7475 7265 4772  engine.FeatureGr
+00012da0: 6f75 7045 6e67 696e 6528 0a20 2020 2020  oupEngine(.     
+00012db0: 2020 2020 2020 2066 6561 7475 7265 7374         featurest
+00012dc0: 6f72 655f 6964 0a20 2020 2020 2020 2029  ore_id.        )
+00012dd0: 0a20 2020 2020 2020 2073 656c 662e 5f76  .        self._v
+00012de0: 6563 746f 725f 6462 5f63 6c69 656e 7420  ector_db_client 
+00012df0: 3d20 4e6f 6e65 0a20 2020 2020 2020 2073  = None.        s
+00012e00: 656c 662e 5f68 7265 6620 3d20 6872 6566  elf._href = href
+00012e10: 0a0a 2020 2020 2020 2020 2320 6361 6368  ..        # cach
+00012e20: 6520 666f 7220 6f70 7469 6d69 7a65 6420  e for optimized 
+00012e30: 7772 6974 6573 0a20 2020 2020 2020 2073  writes.        s
+00012e40: 656c 662e 5f6b 6166 6b61 5f70 726f 6475  elf._kafka_produ
+00012e50: 6365 7220 3d20 4e6f 6e65 0a20 2020 2020  cer = None.     
+00012e60: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
+00012e70: 5f77 7269 7465 7273 203d 204e 6f6e 650a  _writers = None.
+00012e80: 2020 2020 2020 2020 7365 6c66 2e5f 7772          self._wr
+00012e90: 6974 6572 203d 204e 6f6e 650a 0a20 2020  iter = None..   
+00012ea0: 2064 6566 2072 6561 6428 0a20 2020 2020   def read(.     
+00012eb0: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
+00012ec0: 2077 616c 6c63 6c6f 636b 5f74 696d 653a   wallclock_time:
+00012ed0: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
+00012ee0: 7374 722c 2069 6e74 2c20 6461 7465 7469  str, int, dateti
+00012ef0: 6d65 2c20 6461 7465 5d5d 203d 204e 6f6e  me, date]] = Non
+00012f00: 652c 0a20 2020 2020 2020 206f 6e6c 696e  e,.        onlin
+00012f10: 653a 204f 7074 696f 6e61 6c5b 626f 6f6c  e: Optional[bool
+00012f20: 5d20 3d20 4661 6c73 652c 0a20 2020 2020  ] = False,.     
+00012f30: 2020 2064 6174 6166 7261 6d65 5f74 7970     dataframe_typ
+00012f40: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
+00012f50: 203d 2022 6465 6661 756c 7422 2c0a 2020   = "default",.  
+00012f60: 2020 2020 2020 7265 6164 5f6f 7074 696f        read_optio
+00012f70: 6e73 3a20 4f70 7469 6f6e 616c 5b64 6963  ns: Optional[dic
+00012f80: 745d 203d 207b 7d2c 0a20 2020 2029 3a0a  t] = {},.    ):.
+00012f90: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00012fa0: 2020 2020 5265 6164 2074 6865 2066 6561      Read the fea
+00012fb0: 7475 7265 2067 726f 7570 2069 6e74 6f20  ture group into 
+00012fc0: 6120 6461 7461 6672 616d 652e 0a0a 2020  a dataframe...  
+00012fd0: 2020 2020 2020 5265 6164 7320 7468 6520        Reads the 
+00012fe0: 6665 6174 7572 6520 6772 6f75 7020 6279  feature group by
+00012ff0: 2064 6566 6175 6c74 2066 726f 6d20 7468   default from th
+00013000: 6520 6f66 666c 696e 6520 7374 6f72 6167  e offline storag
+00013010: 6520 6173 2053 7061 726b 2044 6174 6146  e as Spark DataF
+00013020: 7261 6d65 0a20 2020 2020 2020 206f 6e20  rame.        on 
+00013030: 486f 7073 776f 726b 7320 616e 6420 4461  Hopsworks and Da
+00013040: 7461 6272 6963 6b73 2c20 616e 6420 6173  tabricks, and as
+00013050: 2050 616e 6461 7320 6461 7461 6672 616d   Pandas datafram
+00013060: 6520 6f6e 2041 5753 2053 6167 656d 616b  e on AWS Sagemak
+00013070: 6572 2061 6e64 2070 7572 650a 2020 2020  er and pure.    
+00013080: 2020 2020 5079 7468 6f6e 2065 6e76 6972      Python envir
+00013090: 6f6e 6d65 6e74 732e 0a0a 2020 2020 2020  onments...      
+000130a0: 2020 5365 7420 606f 6e6c 696e 6560 2074    Set `online` t
+000130b0: 6f20 6054 7275 6560 2074 6f20 7265 6164  o `True` to read
+000130c0: 2066 726f 6d20 7468 6520 6f6e 6c69 6e65   from the online
+000130d0: 2073 746f 7261 6765 2c20 6f72 2063 6861   storage, or cha
+000130e0: 6e67 650a 2020 2020 2020 2020 6064 6174  nge.        `dat
+000130f0: 6166 7261 6d65 5f74 7970 6560 2074 6f20  aframe_type` to 
+00013100: 7265 6164 2061 7320 6120 6469 6666 6572  read as a differ
+00013110: 656e 7420 666f 726d 6174 2e0a 0a20 2020  ent format...   
+00013120: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
+00013130: 2022 5265 6164 2066 6561 7475 7265 2067   "Read feature g
+00013140: 726f 7570 2061 7320 6f66 206c 6174 6573  roup as of lates
+00013150: 7420 7374 6174 653a 220a 2020 2020 2020  t state:".      
+00013160: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00013170: 2020 2020 2020 2020 2020 2020 2320 636f              # co
+00013180: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
+00013190: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
+000131a0: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
+000131b0: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+000131c0: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+000131d0: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+000131e0: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+000131f0: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+00013200: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+00013210: 2e29 0a20 2020 2020 2020 2020 2020 2066  .).            f
+00013220: 672e 7265 6164 2829 0a20 2020 2020 2020  g.read().       
+00013230: 2020 2020 2060 6060 0a0a 2020 2020 2020       ```..      
+00013240: 2020 2121 2120 6578 616d 706c 6520 2252    !!! example "R
+00013250: 6561 6420 6665 6174 7572 6520 6772 6f75  ead feature grou
+00013260: 7020 6173 206f 6620 7370 6563 6966 6963  p as of specific
+00013270: 2070 6f69 6e74 2069 6e20 7469 6d65 3a22   point in time:"
+00013280: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00013290: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+000132a0: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
+000132b0: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+000132c0: 5f67 726f 7570 282e 2e2e 290a 2020 2020  _group(...).    
+000132d0: 2020 2020 2020 2020 6667 2e72 6561 6428          fg.read(
+000132e0: 2232 3032 302d 3130 2d32 3020 3037 3a33  "2020-10-20 07:3
+000132f0: 343a 3131 2229 0a20 2020 2020 2020 2020  4:11").         
+00013300: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
+00013310: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
+00013320: 2020 2020 2020 2020 7761 6c6c 636c 6f63          wallcloc
+00013330: 6b5f 7469 6d65 3a20 4966 2073 7065 6369  k_time: If speci
+00013340: 6669 6564 2077 696c 6c20 7265 7472 6965  fied will retrie
+00013350: 7665 2066 6561 7475 7265 2067 726f 7570  ve feature group
+00013360: 2061 7320 6f66 2073 7065 6369 6669 6320   as of specific 
+00013370: 706f 696e 7420 696e 2074 696d 652e 2044  point in time. D
+00013380: 6566 6175 6c74 7320 746f 2060 4e6f 6e65  efaults to `None
+00013390: 602e 0a20 2020 2020 2020 2020 2020 2020  `..             
+000133a0: 2020 2049 6620 6e6f 7420 7370 6563 6966     If not specif
+000133b0: 6965 642c 2077 696c 6c20 7265 7475 726e  ied, will return
+000133c0: 2061 7320 6f66 206d 6f73 7420 7265 6365   as of most rece
+000133d0: 6e74 2074 696d 652e 0a20 2020 2020 2020  nt time..       
+000133e0: 2020 2020 2020 2020 2053 7472 696e 6773           Strings
+000133f0: 2073 686f 756c 6420 6265 2066 6f72 6d61   should be forma
+00013400: 7474 6564 2069 6e20 6f6e 6520 6f66 2074  tted in one of t
+00013410: 6865 2066 6f6c 6c6f 7769 6e67 2066 6f72  he following for
+00013420: 6d61 7473 2060 2559 2d25 6d2d 2564 602c  mats `%Y-%m-%d`,
+00013430: 2060 2559 2d25 6d2d 2564 2025 4860 2c20   `%Y-%m-%d %H`, 
+00013440: 6025 592d 256d 2d25 6420 2548 3a25 4d60  `%Y-%m-%d %H:%M`
+00013450: 2c20 6025 592d 256d 2d25 6420 2548 3a25  , `%Y-%m-%d %H:%
+00013460: 4d3a 2553 602c 0a20 2020 2020 2020 2020  M:%S`,.         
+00013470: 2020 2020 2020 206f 7220 6025 592d 256d         or `%Y-%m
+00013480: 2d25 6420 2548 3a25 4d3a 2553 2e25 6660  -%d %H:%M:%S.%f`
+00013490: 2e0a 2020 2020 2020 2020 2020 2020 6f6e  ..            on
+000134a0: 6c69 6e65 3a20 626f 6f6c 2c20 6f70 7469  line: bool, opti
+000134b0: 6f6e 616c 2e20 4966 2060 5472 7565 6020  onal. If `True` 
+000134c0: 7265 6164 2066 726f 6d20 6f6e 6c69 6e65  read from online
+000134d0: 2066 6561 7475 7265 2073 746f 7265 2c20   feature store, 
+000134e0: 6465 6661 756c 7473 0a20 2020 2020 2020  defaults.       
+000134f0: 2020 2020 2020 2020 2074 6f20 6046 616c           to `Fal
+00013500: 7365 602e 0a20 2020 2020 2020 2020 2020  se`..           
+00013510: 2064 6174 6166 7261 6d65 5f74 7970 653a   dataframe_type:
+00013520: 2073 7472 2c20 6f70 7469 6f6e 616c 2e20   str, optional. 
+00013530: 506f 7373 6962 6c65 2076 616c 7565 7320  Possible values 
+00013540: 6172 6520 6022 6465 6661 756c 7422 602c  are `"default"`,
+00013550: 2060 2273 7061 726b 2260 2c0a 2020 2020   `"spark"`,.    
+00013560: 2020 2020 2020 2020 2020 2020 6022 7061              `"pa
+00013570: 6e64 6173 2260 2c20 6022 6e75 6d70 7922  ndas"`, `"numpy"
+00013580: 6020 6f72 2060 2270 7974 686f 6e22 602c  ` or `"python"`,
+00013590: 2064 6566 6175 6c74 7320 746f 2060 2264   defaults to `"d
+000135a0: 6566 6175 6c74 2260 2e0a 2020 2020 2020  efault"`..      
+000135b0: 2020 2020 2020 7265 6164 5f6f 7074 696f        read_optio
+000135c0: 6e73 3a20 4164 6469 7469 6f6e 616c 206f  ns: Additional o
+000135d0: 7074 696f 6e73 2061 7320 6b65 792f 7661  ptions as key/va
+000135e0: 6c75 6520 7061 6972 7320 746f 2070 6173  lue pairs to pas
+000135f0: 7320 746f 2074 6865 2065 7865 6375 7469  s to the executi
+00013600: 6f6e 2065 6e67 696e 652e 0a20 2020 2020  on engine..     
+00013610: 2020 2020 2020 2020 2020 2046 6f72 2073             For s
+00013620: 7061 726b 2065 6e67 696e 653a 2044 6963  park engine: Dic
+00013630: 7469 6f6e 6172 7920 6f66 2072 6561 6420  tionary of read 
+00013640: 6f70 7469 6f6e 7320 666f 7220 5370 6172  options for Spar
+00013650: 6b2e 0a20 2020 2020 2020 2020 2020 2020  k..             
+00013660: 2020 2046 6f72 2070 7974 686f 6e20 656e     For python en
+00013670: 6769 6e65 3a0a 2020 2020 2020 2020 2020  gine:.          
+00013680: 2020 2020 2020 2a20 6b65 7920 6022 7573        * key `"us
+00013690: 655f 6869 7665 2260 2061 6e64 2076 616c  e_hive"` and val
+000136a0: 7565 2060 5472 7565 6020 746f 2072 6561  ue `True` to rea
+000136b0: 6420 6665 6174 7572 6520 6772 6f75 700a  d feature group.
+000136c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000136d0: 2020 7769 7468 2048 6976 6520 696e 7374    with Hive inst
+000136e0: 6561 6420 6f66 205b 486f 7073 776f 726b  ead of [Hopswork
+000136f0: 7320 4665 6174 7572 6520 5175 6572 7920  s Feature Query 
+00013700: 5365 7276 6963 655d 2868 7474 7073 3a2f  Service](https:/
+00013710: 2f64 6f63 732e 686f 7073 776f 726b 732e  /docs.hopsworks.
+00013720: 6169 2f6c 6174 6573 742f 7365 7475 705f  ai/latest/setup_
+00013730: 696e 7374 616c 6c61 7469 6f6e 2f63 6f6d  installation/com
+00013740: 6d6f 6e2f 6172 726f 775f 666c 6967 6874  mon/arrow_flight
+00013750: 5f64 7563 6b64 622f 292e 0a20 2020 2020  _duckdb/)..     
+00013760: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+00013770: 2060 2261 7272 6f77 5f66 6c69 6768 745f   `"arrow_flight_
+00013780: 636f 6e66 6967 2260 2074 6f20 7061 7373  config"` to pass
+00013790: 2061 2064 6963 7469 6f6e 6172 7920 6f66   a dictionary of
+000137a0: 2061 7272 6f77 2066 6c69 6768 7420 636f   arrow flight co
+000137b0: 6e66 6967 7572 6174 696f 6e73 2e0a 2020  nfigurations..  
+000137c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000137d0: 466f 7220 6578 616d 706c 653a 2060 7b22  For example: `{"
+000137e0: 6172 726f 775f 666c 6967 6874 5f63 6f6e  arrow_flight_con
+000137f0: 6669 6722 3a20 7b22 7469 6d65 6f75 7422  fig": {"timeout"
+00013800: 3a20 3930 307d 7d60 0a20 2020 2020 2020  : 900}}`.       
+00013810: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
+00013820: 2268 6976 655f 636f 6e66 6967 2260 2074  "hive_config"` t
+00013830: 6f20 7061 7373 2061 2064 6963 7469 6f6e  o pass a diction
+00013840: 6172 7920 6f66 2068 6976 6520 6f72 2074  ary of hive or t
+00013850: 657a 2063 6f6e 6669 6775 7261 7469 6f6e  ez configuration
+00013860: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+00013870: 2020 2020 2046 6f72 2065 7861 6d70 6c65       For example
+00013880: 3a20 607b 2268 6976 655f 636f 6e66 6967  : `{"hive_config
+00013890: 223a 207b 2268 6976 652e 7465 7a2e 6370  ": {"hive.tez.cp
+000138a0: 752e 7663 6f72 6573 223a 2032 2c20 2274  u.vcores": 2, "t
+000138b0: 657a 2e67 726f 7570 696e 672e 7370 6c69  ez.grouping.spli
+000138c0: 742d 636f 756e 7422 3a20 2233 227d 7d60  t-count": "3"}}`
 000138d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000138e0: 2020 2072 6174 6865 7220 7468 616e 206e     rather than n
-000138f0: 756d 7079 2f6f 626a 6563 7428 7374 7269  umpy/object(stri
-00013900: 6e67 2920 7479 7065 7320 2865 7870 6572  ng) types (exper
-00013910: 696d 656e 7461 6c29 2e0a 2020 2020 2020  imental)..      
-00013920: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
-00013930: 7473 2074 6f20 607b 7d60 2e0a 0a20 2020  ts to `{}`...   
-00013940: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
-00013950: 2020 2020 2020 2020 2020 2060 4461 7461             `Data
-00013960: 4672 616d 6560 3a20 5468 6520 7370 6172  Frame`: The spar
-00013970: 6b20 6461 7461 6672 616d 6520 636f 6e74  k dataframe cont
-00013980: 6169 6e69 6e67 2074 6865 2066 6561 7475  aining the featu
-00013990: 7265 2064 6174 612e 0a20 2020 2020 2020  re data..       
-000139a0: 2020 2020 2060 7079 7370 6172 6b2e 4461       `pyspark.Da
-000139b0: 7461 4672 616d 6560 2e20 4120 5370 6172  taFrame`. A Spar
-000139c0: 6b20 4461 7461 4672 616d 652e 0a20 2020  k DataFrame..   
-000139d0: 2020 2020 2020 2020 2060 7061 6e64 6173           `pandas
-000139e0: 2e44 6174 6146 7261 6d65 602e 2041 2050  .DataFrame`. A P
-000139f0: 616e 6461 7320 4461 7461 4672 616d 652e  andas DataFrame.
-00013a00: 0a20 2020 2020 2020 2020 2020 2060 6e75  .            `nu
-00013a10: 6d70 792e 6e64 6172 7261 7960 2e20 4120  mpy.ndarray`. A 
-00013a20: 7477 6f2d 6469 6d65 6e73 696f 6e61 6c20  two-dimensional 
-00013a30: 4e75 6d70 7920 6172 7261 792e 0a20 2020  Numpy array..   
-00013a40: 2020 2020 2020 2020 2060 6c69 7374 602e           `list`.
-00013a50: 2041 2074 776f 2d64 696d 656e 7369 6f6e   A two-dimension
-00013a60: 616c 2050 7974 686f 6e20 6c69 7374 2e0a  al Python list..
-00013a70: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
-00013a80: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
-00013a90: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
-00013aa0: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
-00013ab0: 6f72 602e 204e 6f20 6461 7461 2069 7320  or`. No data is 
-00013ac0: 6176 6169 6c61 626c 6520 666f 7220 6665  available for fe
-00013ad0: 6174 7572 6520 6772 6f75 7020 7769 7468  ature group with
-00013ae0: 2074 6869 7320 636f 6d6d 6974 2064 6174   this commit dat
-00013af0: 652c 2049 6620 7469 6d65 2074 7261 7665  e, If time trave
-00013b00: 6c20 656e 6162 6c65 642e 0a20 2020 2020  l enabled..     
-00013b10: 2020 2022 2222 0a20 2020 2020 2020 2069     """.        i
-00013b20: 6620 7761 6c6c 636c 6f63 6b5f 7469 6d65  f wallclock_time
-00013b30: 2061 6e64 2073 656c 662e 5f74 696d 655f   and self._time_
-00013b40: 7472 6176 656c 5f66 6f72 6d61 7420 6973  travel_format is
-00013b50: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-00013b60: 2020 2072 6169 7365 2046 6561 7475 7265     raise Feature
-00013b70: 5374 6f72 6545 7863 6570 7469 6f6e 280a  StoreException(.
-00013b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013b90: 2254 696d 6520 7472 6176 656c 2066 6f72  "Time travel for
-00013ba0: 6d61 7420 6973 206e 6f74 2073 6574 2066  mat is not set f
-00013bb0: 6f72 2074 6865 2066 6561 7475 7265 2067  or the feature g
-00013bc0: 726f 7570 2c20 6361 6e6e 6f74 2072 6561  roup, cannot rea
-00013bd0: 6420 6173 206f 6620 7370 6563 6966 6963  d as of specific
-00013be0: 2070 6f69 6e74 2069 6e20 7469 6d65 2e22   point in time."
-00013bf0: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00013c00: 2020 2020 2020 2065 6c69 6620 7761 6c6c         elif wall
-00013c10: 636c 6f63 6b5f 7469 6d65 2061 6e64 2065  clock_time and e
-00013c20: 6e67 696e 652e 6765 745f 7479 7065 2829  ngine.get_type()
-00013c30: 203d 3d20 2270 7974 686f 6e22 3a0a 2020   == "python":.  
-00013c40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00013c50: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
-00013c60: 7074 696f 6e28 0a20 2020 2020 2020 2020  ption(.         
-00013c70: 2020 2020 2020 2022 5079 7468 6f6e 2065         "Python e
-00013c80: 6e76 6972 6f6e 6d65 6e74 7320 646f 6573  nvironments does
-00013c90: 206e 6f74 2073 7570 706f 7274 2069 6e63   not support inc
-00013ca0: 7265 6d65 6e74 616c 2071 7565 7269 6573  remental queries
-00013cb0: 2e20 220a 2020 2020 2020 2020 2020 2020  . ".            
-00013cc0: 2020 2020 2b20 2252 6561 6420 6665 6174      + "Read feat
-00013cd0: 7572 6520 6772 6f75 7020 7769 7468 6f75  ure group withou
-00013ce0: 7420 7469 6d65 7374 616d 7020 746f 2072  t timestamp to r
-00013cf0: 6574 7269 6576 6520 6c61 7465 7374 2073  etrieve latest s
-00013d00: 6e61 7073 686f 7420 6f72 2073 7769 7463  napshot or switc
-00013d10: 6820 746f 2022 0a20 2020 2020 2020 2020  h to ".         
-00013d20: 2020 2020 2020 202b 2022 656e 7669 726f         + "enviro
-00013d30: 6e6d 656e 7420 7769 7468 2053 7061 726b  nment with Spark
-00013d40: 2045 6e67 696e 652e 220a 2020 2020 2020   Engine.".      
-00013d50: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00013d60: 2065 6e67 696e 652e 6765 745f 696e 7374   engine.get_inst
-00013d70: 616e 6365 2829 2e73 6574 5f6a 6f62 5f67  ance().set_job_g
-00013d80: 726f 7570 280a 2020 2020 2020 2020 2020  roup(.          
-00013d90: 2020 2246 6574 6368 696e 6720 4665 6174    "Fetching Feat
-00013da0: 7572 6520 6772 6f75 7022 2c0a 2020 2020  ure group",.    
-00013db0: 2020 2020 2020 2020 2247 6574 7469 6e67          "Getting
-00013dc0: 2066 6561 7475 7265 2067 726f 7570 3a20   feature group: 
-00013dd0: 7b7d 2066 726f 6d20 7468 6520 6665 6174  {} from the feat
-00013de0: 7572 6573 746f 7265 207b 7d22 2e66 6f72  urestore {}".for
-00013df0: 6d61 7428 0a20 2020 2020 2020 2020 2020  mat(.           
-00013e00: 2020 2020 2073 656c 662e 5f6e 616d 652c       self._name,
-00013e10: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
-00013e20: 746f 7265 5f6e 616d 650a 2020 2020 2020  tore_name.      
-00013e30: 2020 2020 2020 292c 0a20 2020 2020 2020        ),.       
-00013e40: 2029 0a0a 2020 2020 2020 2020 6966 2077   )..        if w
-00013e50: 616c 6c63 6c6f 636b 5f74 696d 653a 0a20  allclock_time:. 
-00013e60: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-00013e70: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
-00013e80: 2020 2020 7365 6c66 2e73 656c 6563 745f      self.select_
-00013e90: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
-00013ea0: 2020 2020 2020 2e61 735f 6f66 2877 616c        .as_of(wal
-00013eb0: 6c63 6c6f 636b 5f74 696d 6529 0a20 2020  lclock_time).   
-00013ec0: 2020 2020 2020 2020 2020 2020 202e 7265               .re
-00013ed0: 6164 280a 2020 2020 2020 2020 2020 2020  ad(.            
-00013ee0: 2020 2020 2020 2020 6f6e 6c69 6e65 2c0a          online,.
-00013ef0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00013f00: 2020 2020 6461 7461 6672 616d 655f 7479      dataframe_ty
-00013f10: 7065 2c0a 2020 2020 2020 2020 2020 2020  pe,.            
-00013f20: 2020 2020 2020 2020 7265 6164 5f6f 7074          read_opt
-00013f30: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-00013f40: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00013f50: 2020 2020 290a 2020 2020 2020 2020 656c      ).        el
-00013f60: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-00013f70: 7265 7475 726e 2073 656c 662e 7365 6c65  return self.sele
-00013f80: 6374 5f61 6c6c 2829 2e72 6561 6428 0a20  ct_all().read(. 
-00013f90: 2020 2020 2020 2020 2020 2020 2020 206f                 o
-00013fa0: 6e6c 696e 652c 0a20 2020 2020 2020 2020  nline,.         
-00013fb0: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
-00013fc0: 5f74 7970 652c 0a20 2020 2020 2020 2020  _type,.         
-00013fd0: 2020 2020 2020 2072 6561 645f 6f70 7469         read_opti
-00013fe0: 6f6e 732c 0a20 2020 2020 2020 2020 2020  ons,.           
-00013ff0: 2029 0a0a 2020 2020 6465 6620 7265 6164   )..    def read
-00014000: 5f63 6861 6e67 6573 280a 2020 2020 2020  _changes(.      
-00014010: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
-00014020: 7374 6172 745f 7761 6c6c 636c 6f63 6b5f  start_wallclock_
-00014030: 7469 6d65 3a20 556e 696f 6e5b 7374 722c  time: Union[str,
-00014040: 2069 6e74 2c20 6461 7465 7469 6d65 2c20   int, datetime, 
-00014050: 6461 7465 5d2c 0a20 2020 2020 2020 2065  date],.        e
-00014060: 6e64 5f77 616c 6c63 6c6f 636b 5f74 696d  nd_wallclock_tim
-00014070: 653a 2055 6e69 6f6e 5b73 7472 2c20 696e  e: Union[str, in
-00014080: 742c 2064 6174 6574 696d 652c 2064 6174  t, datetime, dat
-00014090: 655d 2c0a 2020 2020 2020 2020 7265 6164  e],.        read
-000140a0: 5f6f 7074 696f 6e73 3a20 4f70 7469 6f6e  _options: Option
-000140b0: 616c 5b64 6963 745d 203d 207b 7d2c 0a20  al[dict] = {},. 
-000140c0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-000140d0: 2252 6561 6473 2075 7064 6174 6573 206f  "Reads updates o
-000140e0: 6620 7468 6973 2066 6561 7475 7265 2074  f this feature t
-000140f0: 6861 7420 6f63 6375 7272 6564 2062 6574  hat occurred bet
-00014100: 7765 656e 2073 7065 6369 6669 6564 2070  ween specified p
-00014110: 6f69 6e74 7320 696e 2074 696d 652e 0a0a  oints in time...
-00014120: 2020 2020 2020 2020 2121 2120 7761 726e          !!! warn
-00014130: 696e 6720 2244 6570 7265 6361 7465 6422  ing "Deprecated"
-00014140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014150: 2020 2020 2060 7265 6164 5f63 6861 6e67       `read_chang
-00014160: 6573 6020 6d65 7468 6f64 2069 7320 6465  es` method is de
-00014170: 7072 6563 6174 6564 2e20 5573 650a 2020  precated. Use.  
-00014180: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014190: 2020 6061 735f 6f66 2865 6e64 5f77 616c    `as_of(end_wal
-000141a0: 6c63 6c6f 636b 5f74 696d 652c 2065 7863  lclock_time, exc
-000141b0: 6c75 6465 5f75 6e74 696c 3d73 7461 7274  lude_until=start
-000141c0: 5f77 616c 6c63 6c6f 636b 5f74 696d 6529  _wallclock_time)
-000141d0: 2e72 6561 6428 7265 6164 5f6f 7074 696f  .read(read_optio
-000141e0: 6e73 3d72 6561 645f 6f70 7469 6f6e 7329  ns=read_options)
-000141f0: 600a 2020 2020 2020 2020 2020 2020 2020  `.              
-00014200: 2020 2020 2020 696e 7374 6561 642e 0a0a        instead...
-00014210: 2020 2020 2020 2020 5468 6973 2066 756e          This fun
-00014220: 6374 696f 6e20 6f6e 6c79 2077 6f72 6b73  ction only works
-00014230: 206f 6e20 6665 6174 7572 6520 6772 6f75   on feature grou
-00014240: 7073 2077 6974 6820 6048 5544 4960 2074  ps with `HUDI` t
-00014250: 696d 6520 7472 6176 656c 2066 6f72 6d61  ime travel forma
-00014260: 742e 0a0a 2020 2020 2020 2020 2320 4172  t...        # Ar
-00014270: 6775 6d65 6e74 730a 2020 2020 2020 2020  guments.        
-00014280: 2020 2020 7374 6172 745f 7761 6c6c 636c      start_wallcl
-00014290: 6f63 6b5f 7469 6d65 3a20 5374 6172 7420  ock_time: Start 
-000142a0: 7469 6d65 206f 6620 7468 6520 7469 6d65  time of the time
-000142b0: 2074 7261 7665 6c20 7175 6572 792e 2053   travel query. S
-000142c0: 7472 696e 6773 2073 686f 756c 6420 6265  trings should be
-000142d0: 2066 6f72 6d61 7474 6564 2069 6e20 6f6e   formatted in on
-000142e0: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
-000142f0: 6e67 2066 6f72 6d61 7473 2060 2559 2d25  ng formats `%Y-%
-00014300: 6d2d 2564 602c 2060 2559 2d25 6d2d 2564  m-%d`, `%Y-%m-%d
-00014310: 2025 4860 2c20 6025 592d 256d 2d25 6420   %H`, `%Y-%m-%d 
-00014320: 2548 3a25 4d60 2c0a 2020 2020 2020 2020  %H:%M`,.        
-00014330: 2020 2020 2020 2020 6025 592d 256d 2d25          `%Y-%m-%
-00014340: 6420 2548 3a25 4d3a 2553 602c 206f 7220  d %H:%M:%S`, or 
-00014350: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
-00014360: 2553 2e25 6660 2e0a 2020 2020 2020 2020  %S.%f`..        
-00014370: 2020 2020 656e 645f 7761 6c6c 636c 6f63      end_wallcloc
-00014380: 6b5f 7469 6d65 3a20 456e 6420 7469 6d65  k_time: End time
-00014390: 206f 6620 7468 6520 7469 6d65 2074 7261   of the time tra
-000143a0: 7665 6c20 7175 6572 792e 2053 7472 696e  vel query. Strin
-000143b0: 6773 2073 686f 756c 6420 6265 2066 6f72  gs should be for
-000143c0: 6d61 7474 6564 2069 6e20 6f6e 6520 6f66  matted in one of
-000143d0: 2074 6865 2066 6f6c 6c6f 7769 6e67 2066   the following f
-000143e0: 6f72 6d61 7473 2060 2559 2d25 6d2d 2564  ormats `%Y-%m-%d
-000143f0: 602c 2060 2559 2d25 6d2d 2564 2025 4860  `, `%Y-%m-%d %H`
-00014400: 2c20 6025 592d 256d 2d25 6420 2548 3a25  , `%Y-%m-%d %H:%
-00014410: 4d60 2c0a 2020 2020 2020 2020 2020 2020  M`,.            
-00014420: 2020 2020 6025 592d 256d 2d25 6420 2548      `%Y-%m-%d %H
-00014430: 3a25 4d3a 2553 602c 206f 7220 6025 592d  :%M:%S`, or `%Y-
-00014440: 256d 2d25 6420 2548 3a25 4d3a 2553 2e25  %m-%d %H:%M:%S.%
-00014450: 6660 2e0a 2020 2020 2020 2020 2020 2020  f`..            
-00014460: 7265 6164 5f6f 7074 696f 6e73 3a20 4164  read_options: Ad
-00014470: 6469 7469 6f6e 616c 206f 7074 696f 6e73  ditional options
-00014480: 2061 7320 6b65 792f 7661 6c75 6520 7061   as key/value pa
-00014490: 6972 7320 746f 2070 6173 7320 746f 2074  irs to pass to t
-000144a0: 6865 2065 7865 6375 7469 6f6e 2065 6e67  he execution eng
-000144b0: 696e 652e 0a20 2020 2020 2020 2020 2020  ine..           
-000144c0: 2020 2020 2046 6f72 2073 7061 726b 2065       For spark e
-000144d0: 6e67 696e 653a 2044 6963 7469 6f6e 6172  ngine: Dictionar
-000144e0: 7920 6f66 2072 6561 6420 6f70 7469 6f6e  y of read option
-000144f0: 7320 666f 7220 5370 6172 6b2e 0a20 2020  s for Spark..   
-00014500: 2020 2020 2020 2020 2020 2020 2046 6f72               For
-00014510: 2070 7974 686f 6e20 656e 6769 6e65 3a0a   python engine:.
-00014520: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014530: 2a20 6b65 7920 6022 6869 7665 5f63 6f6e  * key `"hive_con
-00014540: 6669 6722 6020 746f 2070 6173 7320 6120  fig"` to pass a 
-00014550: 6469 6374 696f 6e61 7279 206f 6620 6869  dictionary of hi
-00014560: 7665 206f 7220 7465 7a20 636f 6e66 6967  ve or tez config
-00014570: 7572 6174 696f 6e73 2e0a 2020 2020 2020  urations..      
-00014580: 2020 2020 2020 2020 2020 2020 466f 7220              For 
-00014590: 6578 616d 706c 653a 2060 7b22 6869 7665  example: `{"hive
-000145a0: 5f63 6f6e 6669 6722 3a20 7b22 6869 7665  _config": {"hive
-000145b0: 2e74 657a 2e63 7075 2e76 636f 7265 7322  .tez.cpu.vcores"
-000145c0: 3a20 322c 2022 7465 7a2e 6772 6f75 7069  : 2, "tez.groupi
-000145d0: 6e67 2e73 706c 6974 2d63 6f75 6e74 223a  ng.split-count":
-000145e0: 2022 3322 7d7d 600a 2020 2020 2020 2020   "3"}}`.        
-000145f0: 2020 2020 2020 2020 4465 6661 756c 7473          Defaults
-00014600: 2074 6f20 607b 7d60 2e0a 0a20 2020 2020   to `{}`...     
-00014610: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
-00014620: 2020 2020 2020 2020 2060 4461 7461 4672           `DataFr
-00014630: 616d 6560 2e20 5468 6520 7370 6172 6b20  ame`. The spark 
-00014640: 6461 7461 6672 616d 6520 636f 6e74 6169  dataframe contai
-00014650: 6e69 6e67 2074 6865 2069 6e63 7265 6d65  ning the increme
-00014660: 6e74 616c 2063 6861 6e67 6573 206f 660a  ntal changes of.
-00014670: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00014680: 7572 6520 6461 7461 2e0a 0a20 2020 2020  ure data...     
-00014690: 2020 2023 2052 6169 7365 730a 2020 2020     # Raises.    
-000146a0: 2020 2020 2020 2020 6068 7366 732e 636c          `hsfs.cl
-000146b0: 6965 6e74 2e65 7863 6570 7469 6f6e 732e  ient.exceptions.
-000146c0: 5265 7374 4150 4945 7272 6f72 602e 2020  RestAPIError`.  
-000146d0: 4e6f 2064 6174 6120 6973 2061 7661 696c  No data is avail
-000146e0: 6162 6c65 2066 6f72 2066 6561 7475 7265  able for feature
-000146f0: 2067 726f 7570 2077 6974 6820 7468 6973   group with this
-00014700: 2063 6f6d 6d69 7420 6461 7465 2e0a 2020   commit date..  
-00014710: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-00014720: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-00014730: 732e 4665 6174 7572 6553 746f 7265 4578  s.FeatureStoreEx
-00014740: 6365 7074 696f 6e60 2e20 4966 2074 6865  ception`. If the
-00014750: 2066 6561 7475 7265 2067 726f 7570 2064   feature group d
-00014760: 6f65 7320 6e6f 7420 6861 7665 2060 4855  oes not have `HU
-00014770: 4449 6020 7469 6d65 2074 7261 7665 6c20  DI` time travel 
-00014780: 666f 726d 6174 0a20 2020 2020 2020 2022  format.        "
-00014790: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
-000147a0: 6e20 280a 2020 2020 2020 2020 2020 2020  n (.            
-000147b0: 7365 6c66 2e73 656c 6563 745f 616c 6c28  self.select_all(
-000147c0: 290a 2020 2020 2020 2020 2020 2020 2e70  ).            .p
-000147d0: 756c 6c5f 6368 616e 6765 7328 7374 6172  ull_changes(star
-000147e0: 745f 7761 6c6c 636c 6f63 6b5f 7469 6d65  t_wallclock_time
-000147f0: 2c20 656e 645f 7761 6c6c 636c 6f63 6b5f  , end_wallclock_
-00014800: 7469 6d65 290a 2020 2020 2020 2020 2020  time).          
-00014810: 2020 2e72 6561 6428 4661 6c73 652c 2022    .read(False, "
-00014820: 6465 6661 756c 7422 2c20 7265 6164 5f6f  default", read_o
-00014830: 7074 696f 6e73 290a 2020 2020 2020 2020  ptions).        
-00014840: 290a 0a20 2020 2064 6566 2066 696e 645f  )..    def find_
-00014850: 6e65 6967 6862 6f72 7328 0a20 2020 2020  neighbors(.     
-00014860: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-00014870: 2065 6d62 6564 6469 6e67 3a20 4c69 7374   embedding: List
-00014880: 5b55 6e69 6f6e 5b69 6e74 2c20 666c 6f61  [Union[int, floa
-00014890: 745d 5d2c 0a20 2020 2020 2020 2063 6f6c  t]],.        col
-000148a0: 3a20 4f70 7469 6f6e 616c 5b73 7472 5d20  : Optional[str] 
-000148b0: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-000148c0: 6b3a 204f 7074 696f 6e61 6c5b 696e 745d  k: Optional[int]
-000148d0: 203d 2031 302c 0a20 2020 2020 2020 2066   = 10,.        f
-000148e0: 696c 7465 723a 204f 7074 696f 6e61 6c5b  ilter: Optional[
-000148f0: 556e 696f 6e5b 4669 6c74 6572 2c20 4c6f  Union[Filter, Lo
-00014900: 6769 635d 5d20 3d20 4e6f 6e65 2c0a 2020  gic]] = None,.  
-00014910: 2020 2020 2020 6d69 6e5f 7363 6f72 653a        min_score:
-00014920: 204f 7074 696f 6e61 6c5b 666c 6f61 745d   Optional[float]
-00014930: 203d 2030 2c0a 2020 2020 2920 2d3e 204c   = 0,.    ) -> L
-00014940: 6973 745b 5475 706c 655b 666c 6f61 742c  ist[Tuple[float,
-00014950: 204c 6973 745b 416e 795d 5d5d 3a0a 2020   List[Any]]]:.  
-00014960: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-00014970: 2020 4669 6e64 7320 7468 6520 6e65 6172    Finds the near
-00014980: 6573 7420 6e65 6967 6862 6f72 7320 666f  est neighbors fo
-00014990: 7220 6120 6769 7665 6e20 656d 6265 6464  r a given embedd
-000149a0: 696e 6720 696e 2074 6865 2076 6563 746f  ing in the vecto
-000149b0: 7220 6461 7461 6261 7365 2e0a 0a20 2020  r database...   
-000149c0: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
-000149d0: 0a20 2020 2020 2020 2020 2020 2065 6d62  .            emb
-000149e0: 6564 6469 6e67 3a20 5468 6520 7461 7267  edding: The targ
-000149f0: 6574 2065 6d62 6564 6469 6e67 2066 6f72  et embedding for
-00014a00: 2077 6869 6368 206e 6569 6768 626f 7273   which neighbors
-00014a10: 2061 7265 2074 6f20 6265 2066 6f75 6e64   are to be found
-00014a20: 2e0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-00014a30: 6c3a 2054 6865 2063 6f6c 756d 6e20 6e61  l: The column na
-00014a40: 6d65 2075 7365 6420 746f 2063 6f6d 7075  me used to compu
-00014a50: 7465 2073 696d 696c 6172 6974 7920 7363  te similarity sc
-00014a60: 6f72 652e 2052 6571 7569 7265 6420 6f6e  ore. Required on
-00014a70: 6c79 2069 6620 7468 6572 650a 2020 2020  ly if there.    
-00014a80: 2020 2020 2020 2020 6172 6520 6d75 6c74          are mult
-00014a90: 6970 6c65 2065 6d62 6564 6469 6e67 7320  iple embeddings 
-00014aa0: 286f 7074 696f 6e61 6c29 2e0a 2020 2020  (optional)..    
-00014ab0: 2020 2020 2020 2020 6b3a 2054 6865 206e          k: The n
-00014ac0: 756d 6265 7220 6f66 206e 6561 7265 7374  umber of nearest
-00014ad0: 206e 6569 6768 626f 7273 2074 6f20 7265   neighbors to re
-00014ae0: 7472 6965 7665 2028 6465 6661 756c 7420  trieve (default 
-00014af0: 6973 2031 3029 2e0a 2020 2020 2020 2020  is 10)..        
-00014b00: 2020 2020 6669 6c74 6572 3a20 4120 6669      filter: A fi
-00014b10: 6c74 6572 2065 7870 7265 7373 696f 6e20  lter expression 
-00014b20: 746f 2072 6573 7472 6963 7420 7468 6520  to restrict the 
-00014b30: 7365 6172 6368 2073 7061 6365 2028 6f70  search space (op
-00014b40: 7469 6f6e 616c 292e 0a20 2020 2020 2020  tional)..       
-00014b50: 2020 2020 206d 696e 5f73 636f 7265 3a20       min_score: 
-00014b60: 5468 6520 6d69 6e69 6d75 6d20 7369 6d69  The minimum simi
-00014b70: 6c61 7269 7479 2073 636f 7265 2066 6f72  larity score for
-00014b80: 206e 6569 6768 626f 7273 2074 6f20 6265   neighbors to be
-00014b90: 2063 6f6e 7369 6465 7265 6420 2864 6566   considered (def
-00014ba0: 6175 6c74 2069 7320 3029 2e0a 0a20 2020  ault is 0)...   
-00014bb0: 2020 2020 2023 2052 6574 7572 6e73 0a20       # Returns. 
-00014bc0: 2020 2020 2020 2020 2020 2041 206c 6973             A lis
-00014bd0: 7420 6f66 2074 7570 6c65 7320 7265 7072  t of tuples repr
-00014be0: 6573 656e 7469 6e67 2074 6865 206e 6561  esenting the nea
-00014bf0: 7265 7374 206e 6569 6768 626f 7273 2e0a  rest neighbors..
-00014c00: 2020 2020 2020 2020 2020 2020 4561 6368              Each
-00014c10: 2074 7570 6c65 2063 6f6e 7461 696e 733a   tuple contains:
-00014c20: 2060 2854 6865 2073 696d 696c 6172 6974   `(The similarit
-00014c30: 7920 7363 6f72 652c 2041 206c 6973 7420  y score, A list 
-00014c40: 6f66 2066 6561 7475 7265 2076 616c 7565  of feature value
-00014c50: 7329 600a 0a20 2020 2020 2020 2021 2121  s)`..        !!!
-00014c60: 2045 7861 6d70 6c65 0a20 2020 2020 2020   Example.       
-00014c70: 2020 2020 2060 6060 0a20 2020 2020 2020       ```.       
-00014c80: 2020 2020 2065 6d62 6564 6469 6e67 5f69       embedding_i
-00014c90: 6e64 6578 203d 2045 6d62 6564 6469 6e67  ndex = Embedding
-00014ca0: 496e 6465 7828 290a 2020 2020 2020 2020  Index().        
-00014cb0: 2020 2020 656d 6265 6464 696e 675f 696e      embedding_in
-00014cc0: 6465 782e 6164 645f 656d 6265 6464 696e  dex.add_embeddin
-00014cd0: 6728 6e61 6d65 3d22 7573 6572 5f76 6563  g(name="user_vec
-00014ce0: 746f 7222 2c20 6469 6d65 6e73 696f 6e3d  tor", dimension=
-00014cf0: 3329 0a20 2020 2020 2020 2020 2020 2066  3).            f
-00014d00: 6720 3d20 6673 2e63 7265 6174 655f 6665  g = fs.create_fe
-00014d10: 6174 7572 655f 6772 6f75 7028 0a20 2020  ature_group(.   
-00014d20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d30: 2020 2020 206e 616d 653d 2761 6972 5f71       name='air_q
-00014d40: 7561 6c69 7479 272c 0a20 2020 2020 2020  uality',.       
-00014d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00014d60: 2065 6d62 6564 6469 6e67 5f69 6e64 6578   embedding_index
-00014d70: 203d 2065 6d62 6564 6469 6e67 5f69 6e64   = embedding_ind
-00014d80: 6578 2c0a 2020 2020 2020 2020 2020 2020  ex,.            
-00014d90: 2020 2020 2020 2020 2020 2020 7665 7273              vers
-00014da0: 696f 6e3d 312c 0a20 2020 2020 2020 2020  ion=1,.         
-00014db0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00014dc0: 7269 6d61 7279 5f6b 6579 3d5b 2769 6431  rimary_key=['id1
-00014dd0: 275d 2c0a 2020 2020 2020 2020 2020 2020  '],.            
-00014de0: 2020 2020 2020 2020 2020 2020 6f6e 6c69              onli
-00014df0: 6e65 5f65 6e61 626c 6564 3d54 7275 652c  ne_enabled=True,
-00014e00: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014e10: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-00014e20: 2020 2066 672e 696e 7365 7274 2864 6174     fg.insert(dat
-00014e30: 6129 0a20 2020 2020 2020 2020 2020 2066  a).            f
-00014e40: 672e 6669 6e64 5f6e 6569 6768 626f 7273  g.find_neighbors
-00014e50: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00014e60: 2020 5b30 2e31 2c20 302e 322c 2030 2e33    [0.1, 0.2, 0.3
-00014e70: 5d2c 0a20 2020 2020 2020 2020 2020 2020  ],.             
-00014e80: 2020 206b 3d35 2c0a 2020 2020 2020 2020     k=5,.        
-00014e90: 2020 2020 290a 0a20 2020 2020 2020 2020      )..         
-00014ea0: 2020 2023 2061 7070 6c79 2066 696c 7465     # apply filte
-00014eb0: 720a 2020 2020 2020 2020 2020 2020 6667  r.            fg
-00014ec0: 2e66 696e 645f 6e65 6967 6862 6f72 7328  .find_neighbors(
-00014ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ee0: 205b 302e 312c 2030 2e32 2c20 302e 335d   [0.1, 0.2, 0.3]
-00014ef0: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
-00014f00: 2020 6b3d 352c 0a20 2020 2020 2020 2020    k=5,.         
-00014f10: 2020 2020 2020 2066 696c 7465 723d 2866         filter=(f
-00014f20: 672e 6964 3120 3e20 3130 2920 2620 2866  g.id1 > 10) & (f
-00014f30: 672e 6964 3120 3c20 3330 290a 2020 2020  g.id1 < 30).    
-00014f40: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00014f50: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-00014f60: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00014f70: 2073 656c 662e 5f76 6563 746f 725f 6462   self._vector_db
-00014f80: 5f63 6c69 656e 7420 6973 204e 6f6e 6520  _client is None 
-00014f90: 616e 6420 7365 6c66 2e5f 656d 6265 6464  and self._embedd
-00014fa0: 696e 675f 696e 6465 783a 0a20 2020 2020  ing_index:.     
-00014fb0: 2020 2020 2020 2073 656c 662e 5f76 6563         self._vec
-00014fc0: 746f 725f 6462 5f63 6c69 656e 7420 3d20  tor_db_client = 
-00014fd0: 5665 6374 6f72 4462 436c 6965 6e74 2873  VectorDbClient(s
-00014fe0: 656c 662e 7365 6c65 6374 5f61 6c6c 2829  elf.select_all()
-00014ff0: 290a 2020 2020 2020 2020 7265 7375 6c74  ).        result
-00015000: 7320 3d20 7365 6c66 2e5f 7665 6374 6f72  s = self._vector
-00015010: 5f64 625f 636c 6965 6e74 2e66 696e 645f  _db_client.find_
-00015020: 6e65 6967 6862 6f72 7328 0a20 2020 2020  neighbors(.     
-00015030: 2020 2020 2020 2065 6d62 6564 6469 6e67         embedding
-00015040: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-00015050: 6174 7572 653d 2873 656c 662e 5f5f 6765  ature=(self.__ge
-00015060: 7461 7474 725f 5f28 636f 6c29 2069 6620  tattr__(col) if 
-00015070: 636f 6c20 656c 7365 204e 6f6e 6529 2c0a  col else None),.
-00015080: 2020 2020 2020 2020 2020 2020 6b3d 6b2c              k=k,
-00015090: 0a20 2020 2020 2020 2020 2020 2066 696c  .            fil
-000150a0: 7465 723d 6669 6c74 6572 2c0a 2020 2020  ter=filter,.    
-000150b0: 2020 2020 2020 2020 6d69 6e5f 7363 6f72          min_scor
-000150c0: 653d 6d69 6e5f 7363 6f72 652c 0a20 2020  e=min_score,.   
-000150d0: 2020 2020 2029 0a20 2020 2020 2020 2072       ).        r
-000150e0: 6574 7572 6e20 5b0a 2020 2020 2020 2020  eturn [.        
-000150f0: 2020 2020 2872 6573 756c 745b 305d 2c20      (result[0], 
-00015100: 5b72 6573 756c 745b 315d 5b66 2e6e 616d  [result[1][f.nam
-00015110: 655d 2066 6f72 2066 2069 6e20 7365 6c66  e] for f in self
-00015120: 2e66 6561 7475 7265 735d 290a 2020 2020  .features]).    
-00015130: 2020 2020 2020 2020 666f 7220 7265 7375          for resu
-00015140: 6c74 2069 6e20 7265 7375 6c74 730a 2020  lt in results.  
-00015150: 2020 2020 2020 5d0a 0a20 2020 2064 6566        ]..    def
-00015160: 2073 686f 7728 7365 6c66 2c20 6e3a 2069   show(self, n: i
-00015170: 6e74 2c20 6f6e 6c69 6e65 3a20 4f70 7469  nt, online: Opti
-00015180: 6f6e 616c 5b62 6f6f 6c5d 203d 2046 616c  onal[bool] = Fal
-00015190: 7365 293a 0a20 2020 2020 2020 2022 2222  se):.        """
-000151a0: 5368 6f77 2074 6865 2066 6972 7374 2060  Show the first `
-000151b0: 6e60 2072 6f77 7320 6f66 2074 6865 2066  n` rows of the f
-000151c0: 6561 7475 7265 2067 726f 7570 2e0a 0a20  eature group... 
-000151d0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
-000151e0: 6c65 0a20 2020 2020 2020 2020 2020 2060  le.            `
-000151f0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-00015200: 2020 2020 2023 2063 6f6e 6e65 6374 2074       # connect t
-00015210: 6f20 7468 6520 4665 6174 7572 6520 5374  o the Feature St
-00015220: 6f72 650a 2020 2020 2020 2020 2020 2020  ore.            
-00015230: 6673 203d 202e 2e2e 0a0a 2020 2020 2020  fs = .....      
-00015240: 2020 2020 2020 2320 6765 7420 7468 6520        # get the 
-00015250: 4665 6174 7572 6520 4772 6f75 7020 696e  Feature Group in
-00015260: 7374 616e 6365 0a20 2020 2020 2020 2020  stance.         
-00015270: 2020 2066 6720 3d20 6673 2e67 6574 5f6f     fg = fs.get_o
-00015280: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
-00015290: 5f67 726f 7570 282e 2e2e 290a 0a20 2020  _group(...)..   
-000152a0: 2020 2020 2020 2020 2023 206d 616b 6520           # make 
-000152b0: 6120 7175 6572 7920 616e 6420 7368 6f77  a query and show
-000152c0: 2074 6f70 2035 2072 6f77 730a 2020 2020   top 5 rows.    
-000152d0: 2020 2020 2020 2020 6667 2e73 656c 6563          fg.selec
-000152e0: 7428 5b27 6461 7465 272c 2777 6565 6b6c  t(['date','weekl
-000152f0: 795f 7361 6c65 7327 2c27 6973 5f68 6f6c  y_sales','is_hol
-00015300: 6964 6179 275d 292e 7368 6f77 2835 290a  iday']).show(5).
-00015310: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-00015320: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
-00015330: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-00015340: 206e 3a20 696e 742e 204e 756d 6265 7220   n: int. Number 
-00015350: 6f66 2072 6f77 7320 746f 2073 686f 772e  of rows to show.
-00015360: 0a20 2020 2020 2020 2020 2020 206f 6e6c  .            onl
-00015370: 696e 653a 2062 6f6f 6c2c 206f 7074 696f  ine: bool, optio
-00015380: 6e61 6c2e 2049 6620 6054 7275 6560 2072  nal. If `True` r
-00015390: 6561 6420 6672 6f6d 206f 6e6c 696e 6520  ead from online 
-000153a0: 6665 6174 7572 6520 7374 6f72 652c 2064  feature store, d
-000153b0: 6566 6175 6c74 730a 2020 2020 2020 2020  efaults.        
-000153c0: 2020 2020 2020 2020 746f 2060 4661 6c73          to `Fals
-000153d0: 6560 2e0a 2020 2020 2020 2020 2222 220a  e`..        """.
-000153e0: 2020 2020 2020 2020 656e 6769 6e65 2e67          engine.g
-000153f0: 6574 5f69 6e73 7461 6e63 6528 292e 7365  et_instance().se
-00015400: 745f 6a6f 625f 6772 6f75 7028 0a20 2020  t_job_group(.   
-00015410: 2020 2020 2020 2020 2022 4665 7463 6869           "Fetchi
-00015420: 6e67 2046 6561 7475 7265 2067 726f 7570  ng Feature group
-00015430: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-00015440: 4765 7474 696e 6720 6665 6174 7572 6520  Getting feature 
-00015450: 6772 6f75 703a 207b 7d20 6672 6f6d 2074  group: {} from t
-00015460: 6865 2066 6561 7475 7265 7374 6f72 6520  he featurestore 
-00015470: 7b7d 222e 666f 726d 6174 280a 2020 2020  {}".format(.    
-00015480: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00015490: 2e5f 6e61 6d65 2c20 7365 6c66 2e5f 6665  ._name, self._fe
-000154a0: 6174 7572 655f 7374 6f72 655f 6e61 6d65  ature_store_name
-000154b0: 0a20 2020 2020 2020 2020 2020 2029 2c0a  .            ),.
-000154c0: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-000154d0: 2020 6966 206f 6e6c 696e 6520 616e 6420    if online and 
-000154e0: 7365 6c66 2e65 6d62 6564 6469 6e67 5f69  self.embedding_i
-000154f0: 6e64 6578 3a0a 2020 2020 2020 2020 2020  ndex:.          
-00015500: 2020 6966 2073 656c 662e 5f76 6563 746f    if self._vecto
-00015510: 725f 6462 5f63 6c69 656e 7420 6973 204e  r_db_client is N
-00015520: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00015530: 2020 2020 2073 656c 662e 5f76 6563 746f       self._vecto
-00015540: 725f 6462 5f63 6c69 656e 7420 3d20 5665  r_db_client = Ve
-00015550: 6374 6f72 4462 436c 6965 6e74 2873 656c  ctorDbClient(sel
-00015560: 662e 7365 6c65 6374 5f61 6c6c 2829 290a  f.select_all()).
-00015570: 2020 2020 2020 2020 2020 2020 7265 7375              resu
-00015580: 6c74 7320 3d20 7365 6c66 2e5f 7665 6374  lts = self._vect
-00015590: 6f72 5f64 625f 636c 6965 6e74 2e72 6561  or_db_client.rea
-000155a0: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
-000155b0: 2020 2073 656c 662e 6964 2c0a 2020 2020     self.id,.    
-000155c0: 2020 2020 2020 2020 2020 2020 7b7d 2c0a              {},.
-000155d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000155e0: 706b 3d73 656c 662e 656d 6265 6464 696e  pk=self.embeddin
-000155f0: 675f 696e 6465 782e 636f 6c5f 7072 6566  g_index.col_pref
-00015600: 6978 202b 2073 656c 662e 7072 696d 6172  ix + self.primar
-00015610: 795f 6b65 795b 305d 2c0a 2020 2020 2020  y_key[0],.      
-00015620: 2020 2020 2020 2020 2020 696e 6465 785f            index_
-00015630: 6e61 6d65 3d73 656c 662e 656d 6265 6464  name=self.embedd
-00015640: 696e 675f 696e 6465 782e 696e 6465 785f  ing_index.index_
-00015650: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00015660: 2020 2020 2020 6e3d 6e2c 0a20 2020 2020        n=n,.     
-00015670: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-00015680: 2020 2020 2072 6574 7572 6e20 5b5b 7265       return [[re
-00015690: 7375 6c74 5b66 2e6e 616d 655d 2066 6f72  sult[f.name] for
-000156a0: 2066 2069 6e20 7365 6c66 2e66 6561 7475   f in self.featu
-000156b0: 7265 735d 2066 6f72 2072 6573 756c 7420  res] for result 
-000156c0: 696e 2072 6573 756c 7473 5d0a 2020 2020  in results].    
-000156d0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-000156e0: 7365 6c65 6374 5f61 6c6c 2829 2e73 686f  select_all().sho
-000156f0: 7728 6e2c 206f 6e6c 696e 6529 0a0a 2020  w(n, online)..  
-00015700: 2020 6465 6620 7361 7665 280a 2020 2020    def save(.    
-00015710: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00015720: 2020 6665 6174 7572 6573 3a20 556e 696f    features: Unio
-00015730: 6e5b 0a20 2020 2020 2020 2020 2020 2070  n[.            p
-00015740: 642e 4461 7461 4672 616d 652c 0a20 2020  d.DataFrame,.   
-00015750: 2020 2020 2020 2020 2054 7970 6556 6172           TypeVar
-00015760: 2822 7079 7370 6172 6b2e 7371 6c2e 4461  ("pyspark.sql.Da
-00015770: 7461 4672 616d 6522 292c 2020 2320 6e6f  taFrame"),  # no
-00015780: 7161 3a20 4638 3231 0a20 2020 2020 2020  qa: F821.       
-00015790: 2020 2020 2054 7970 6556 6172 2822 7079       TypeVar("py
-000157a0: 7370 6172 6b2e 5244 4422 292c 2020 2320  spark.RDD"),  # 
-000157b0: 6e6f 7161 3a20 4638 3231 0a20 2020 2020  noqa: F821.     
-000157c0: 2020 2020 2020 206e 702e 6e64 6172 7261         np.ndarra
-000157d0: 792c 0a20 2020 2020 2020 2020 2020 204c  y,.            L
-000157e0: 6973 745b 6665 6174 7572 652e 4665 6174  ist[feature.Feat
-000157f0: 7572 655d 2c0a 2020 2020 2020 2020 5d20  ure],.        ] 
-00015800: 3d20 4e6f 6e65 2c0a 2020 2020 2020 2020  = None,.        
-00015810: 7772 6974 655f 6f70 7469 6f6e 733a 204f  write_options: O
-00015820: 7074 696f 6e61 6c5b 4469 6374 5b41 6e79  ptional[Dict[Any
-00015830: 2c20 416e 795d 5d20 3d20 7b7d 2c0a 2020  , Any]] = {},.  
-00015840: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
-00015850: 5f6f 7074 696f 6e73 3a20 4f70 7469 6f6e  _options: Option
-00015860: 616c 5b44 6963 745b 416e 792c 2041 6e79  al[Dict[Any, Any
-00015870: 5d5d 203d 207b 7d2c 0a20 2020 2020 2020  ]] = {},.       
-00015880: 2077 6169 743a 2062 6f6f 6c20 3d20 4661   wait: bool = Fa
-00015890: 6c73 652c 0a20 2020 2029 3a0a 2020 2020  lse,.    ):.    
-000158a0: 2020 2020 2222 2250 6572 7369 7374 2074      """Persist t
-000158b0: 6865 206d 6574 6164 6174 6120 616e 6420  he metadata and 
-000158c0: 6d61 7465 7269 616c 697a 6520 7468 6520  materialize the 
-000158d0: 6665 6174 7572 6520 6772 6f75 7020 746f  feature group to
-000158e0: 2074 6865 2066 6561 7475 7265 2073 746f   the feature sto
-000158f0: 7265 2e0a 0a20 2020 2020 2020 2021 2121  re...        !!!
-00015900: 2077 6172 6e69 6e67 2022 4368 616e 6765   warning "Change
-00015910: 6420 696e 2033 2e33 2e30 220a 2020 2020  d in 3.3.0".    
-00015920: 2020 2020 2020 2020 6069 6e73 6572 7460          `insert`
-00015930: 2061 6e64 2060 7361 7665 6020 6d65 7468   and `save` meth
-00015940: 6f64 7320 6172 6520 6e6f 7720 6173 796e  ods are now asyn
-00015950: 6320 6279 2064 6566 6175 6c74 2069 6e20  c by default in 
-00015960: 6e6f 6e2d 7370 6172 6b20 636c 6965 6e74  non-spark client
-00015970: 732e 0a20 2020 2020 2020 2020 2020 2054  s..            T
-00015980: 6f20 6163 6869 6576 6520 7468 6520 6f6c  o achieve the ol
-00015990: 6420 6265 6861 7669 6f75 722c 2073 6574  d behaviour, set
-000159a0: 2060 7761 6974 6020 6172 6775 6d65 6e74   `wait` argument
-000159b0: 2074 6f20 6054 7275 6560 2e0a 0a20 2020   to `True`...   
-000159c0: 2020 2020 2043 616c 6c69 6e67 2060 7361       Calling `sa
-000159d0: 7665 6020 6372 6561 7465 7320 7468 6520  ve` creates the 
-000159e0: 6d65 7461 6461 7461 2066 6f72 2074 6865  metadata for the
-000159f0: 2066 6561 7475 7265 2067 726f 7570 2069   feature group i
-00015a00: 6e20 7468 6520 6665 6174 7572 6520 7374  n the feature st
-00015a10: 6f72 652e 0a20 2020 2020 2020 2049 6620  ore..        If 
-00015a20: 6120 4461 7461 4672 616d 652c 2052 4444  a DataFrame, RDD
-00015a30: 206f 7220 4e64 6172 7261 7920 6973 2070   or Ndarray is p
-00015a40: 726f 7669 6465 642c 2074 6865 2064 6174  rovided, the dat
-00015a50: 6120 6973 2077 7269 7474 656e 2074 6f20  a is written to 
-00015a60: 7468 650a 2020 2020 2020 2020 6f6e 6c69  the.        onli
-00015a70: 6e65 2f6f 6666 6c69 6e65 2066 6561 7475  ne/offline featu
-00015a80: 7265 2073 746f 7265 2061 7320 7370 6563  re store as spec
-00015a90: 6966 6965 642e 0a20 2020 2020 2020 2042  ified..        B
-00015aa0: 7920 6465 6661 756c 742c 2074 6869 7320  y default, this 
-00015ab0: 7772 6974 6573 2074 6865 2066 6561 7475  writes the featu
-00015ac0: 7265 2067 726f 7570 2074 6f20 7468 6520  re group to the 
-00015ad0: 6f66 666c 696e 6520 7374 6f72 6167 652c  offline storage,
-00015ae0: 2061 6e64 2069 660a 2020 2020 2020 2020   and if.        
-00015af0: 606f 6e6c 696e 655f 656e 6162 6c65 6460  `online_enabled`
-00015b00: 2066 6f72 2074 6865 2066 6561 7475 7265   for the feature
-00015b10: 2067 726f 7570 2c20 616c 736f 2074 6f20   group, also to 
-00015b20: 7468 6520 6f6e 6c69 6e65 2066 6561 7475  the online featu
-00015b30: 7265 2073 746f 7265 2e0a 2020 2020 2020  re store..      
-00015b40: 2020 5468 6520 6066 6561 7475 7265 7360    The `features`
-00015b50: 2064 6174 6166 7261 6d65 2063 616e 2062   dataframe can b
-00015b60: 6520 6120 5370 6172 6b20 4461 7461 4672  e a Spark DataFr
-00015b70: 616d 6520 6f72 2052 4444 2c20 6120 5061  ame or RDD, a Pa
-00015b80: 6e64 6173 2044 6174 6146 7261 6d65 2c0a  ndas DataFrame,.
-00015b90: 2020 2020 2020 2020 6f72 2061 2074 776f          or a two
-00015ba0: 2d64 696d 656e 7369 6f6e 616c 204e 756d  -dimensional Num
-00015bb0: 7079 2061 7272 6179 206f 7220 6120 7477  py array or a tw
-00015bc0: 6f2d 6469 6d65 6e73 696f 6e61 6c20 5079  o-dimensional Py
-00015bd0: 7468 6f6e 206e 6573 7465 6420 6c69 7374  thon nested list
-00015be0: 2e0a 2020 2020 2020 2020 2320 4172 6775  ..        # Argu
-00015bf0: 6d65 6e74 730a 2020 2020 2020 2020 2020  ments.          
-00015c00: 2020 6665 6174 7572 6573 3a20 4461 7461    features: Data
-00015c10: 4672 616d 652c 2052 4444 2c20 4e64 6172  Frame, RDD, Ndar
-00015c20: 7261 7920 6f72 2061 206c 6973 7420 6f66  ray or a list of
-00015c30: 2066 6561 7475 7265 732e 2046 6561 7475   features. Featu
-00015c40: 7265 7320 746f 2062 6520 7361 7665 642e  res to be saved.
-00015c50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015c60: 2054 6869 7320 6172 6775 6d65 6e74 2069   This argument i
-00015c70: 7320 6f70 7469 6f6e 616c 2069 6620 7468  s optional if th
-00015c80: 6520 6665 6174 7572 6520 6c69 7374 2069  e feature list i
-00015c90: 7320 7072 6f76 6964 6564 2069 6e20 7468  s provided in th
-00015ca0: 6520 6372 6561 7465 5f66 6561 7475 7265  e create_feature
-00015cb0: 5f67 726f 7570 206f 720a 2020 2020 2020  _group or.      
-00015cc0: 2020 2020 2020 2020 2020 696e 2074 6865            in the
-00015cd0: 2067 6574 5f6f 725f 6372 6561 7465 5f66   get_or_create_f
-00015ce0: 6561 7475 7265 5f67 726f 7570 206d 6574  eature_group met
-00015cf0: 686f 6420 696e 766f 6b61 7469 6f6e 2e0a  hod invokation..
-00015d00: 2020 2020 2020 2020 2020 2020 7772 6974              writ
-00015d10: 655f 6f70 7469 6f6e 733a 2041 6464 6974  e_options: Addit
-00015d20: 696f 6e61 6c20 7772 6974 6520 6f70 7469  ional write opti
-00015d30: 6f6e 7320 6173 206b 6579 2d76 616c 7565  ons as key-value
-00015d40: 2070 6169 7273 2c20 6465 6661 756c 7473   pairs, defaults
-00015d50: 2074 6f20 607b 7d60 2e0a 2020 2020 2020   to `{}`..      
-00015d60: 2020 2020 2020 2020 2020 5768 656e 2075            When u
-00015d70: 7369 6e67 2074 6865 2060 7079 7468 6f6e  sing the `python
-00015d80: 6020 656e 6769 6e65 2c20 7772 6974 655f  ` engine, write_
-00015d90: 6f70 7469 6f6e 7320 6361 6e20 636f 6e74  options can cont
-00015da0: 6169 6e20 7468 650a 2020 2020 2020 2020  ain the.        
-00015db0: 2020 2020 2020 2020 666f 6c6c 6f77 696e          followin
-00015dc0: 6720 656e 7472 6965 733a 0a20 2020 2020  g entries:.     
-00015dd0: 2020 2020 2020 2020 2020 202a 206b 6579             * key
-00015de0: 2060 7370 6172 6b60 2061 6e64 2076 616c   `spark` and val
-00015df0: 7565 2061 6e20 6f62 6a65 6374 206f 6620  ue an object of 
-00015e00: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
-00015e10: 2020 2020 205b 6873 6673 2e63 6f72 652e       [hsfs.core.
-00015e20: 6a6f 625f 636f 6e66 6967 7572 6174 696f  job_configuratio
-00015e30: 6e2e 4a6f 6243 6f6e 6669 6775 7261 7469  n.JobConfigurati
-00015e40: 6f6e 5d28 2e2e 2f6a 6f62 5f63 6f6e 6669  on](../job_confi
-00015e50: 6775 7261 7469 6f6e 290a 2020 2020 2020  guration).      
-00015e60: 2020 2020 2020 2020 2020 2020 746f 2063              to c
-00015e70: 6f6e 6669 6775 7265 2074 6865 2048 6f70  onfigure the Hop
-00015e80: 7377 6f72 6b73 204a 6f62 2075 7365 6420  sworks Job used 
-00015e90: 746f 2077 7269 7465 2064 6174 6120 696e  to write data in
-00015ea0: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
-00015eb0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00015ec0: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
-00015ed0: 2020 2020 2020 2020 2a20 6b65 7920 6077          * key `w
-00015ee0: 6169 745f 666f 725f 6a6f 6260 2061 6e64  ait_for_job` and
-00015ef0: 2076 616c 7565 2060 5472 7565 6020 6f72   value `True` or
-00015f00: 2060 4661 6c73 6560 2074 6f20 636f 6e66   `False` to conf
-00015f10: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
-00015f20: 2020 2020 2020 2020 7768 6574 6865 7220          whether 
-00015f30: 6f72 206e 6f74 2074 6f20 7468 6520 7361  or not to the sa
-00015f40: 7665 2063 616c 6c20 7368 6f75 6c64 2072  ve call should r
-00015f50: 6574 7572 6e20 6f6e 6c79 0a20 2020 2020  eturn only.     
-00015f60: 2020 2020 2020 2020 2020 2020 2061 6674               aft
-00015f70: 6572 2074 6865 2048 6f70 7377 6f72 6b73  er the Hopsworks
-00015f80: 204a 6f62 2068 6173 2066 696e 6973 6865   Job has finishe
-00015f90: 642e 2042 7920 6465 6661 756c 7420 6974  d. By default it
-00015fa0: 2064 6f65 7320 6e6f 7420 7761 6974 2e0a   does not wait..
-00015fb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015fc0: 2a20 6b65 7920 6073 7461 7274 5f6f 6666  * key `start_off
-00015fd0: 6c69 6e65 5f62 6163 6b66 696c 6c60 2061  line_backfill` a
-00015fe0: 6e64 2076 616c 7565 2060 5472 7565 6020  nd value `True` 
-00015ff0: 6f72 2060 4661 6c73 6560 2074 6f20 636f  or `False` to co
-00016000: 6e66 6967 7572 650a 2020 2020 2020 2020  nfigure.        
-00016010: 2020 2020 2020 2020 2020 7768 6574 6865            whethe
-00016020: 7220 6f72 206e 6f74 2074 6f20 7374 6172  r or not to star
-00016030: 7420 7468 6520 6d61 7465 7269 616c 697a  t the materializ
-00016040: 6174 696f 6e20 6a6f 6220 746f 2077 7269  ation job to wri
-00016050: 7465 2064 6174 6120 746f 2074 6865 206f  te data to the o
-00016060: 6666 6c69 6e65 0a20 2020 2020 2020 2020  ffline.         
-00016070: 2020 2020 2020 2020 2073 746f 7261 6765           storage
-00016080: 2e20 6073 7461 7274 5f6f 6666 6c69 6e65  . `start_offline
-00016090: 5f62 6163 6b66 696c 6c60 2069 7320 6465  _backfill` is de
-000160a0: 7072 6563 6174 6564 2e20 5573 6520 6073  precated. Use `s
-000160b0: 7461 7274 5f6f 6666 6c69 6e65 5f6d 6174  tart_offline_mat
-000160c0: 6572 6961 6c69 7a61 7469 6f6e 6020 696e  erialization` in
-000160d0: 7374 6561 642e 0a20 2020 2020 2020 2020  stead..         
-000160e0: 2020 2020 2020 202a 206b 6579 2060 7374         * key `st
-000160f0: 6172 745f 6f66 666c 696e 655f 6d61 7465  art_offline_mate
-00016100: 7269 616c 697a 6174 696f 6e60 2061 6e64  rialization` and
-00016110: 2076 616c 7565 2060 5472 7565 6020 6f72   value `True` or
-00016120: 2060 4661 6c73 6560 2074 6f20 636f 6e66   `False` to conf
-00016130: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
-00016140: 2020 2020 2020 2020 7768 6574 6865 7220          whether 
-00016150: 6f72 206e 6f74 2074 6f20 7374 6172 7420  or not to start 
-00016160: 7468 6520 6d61 7465 7269 616c 697a 6174  the materializat
-00016170: 696f 6e20 6a6f 6220 746f 2077 7269 7465  ion job to write
-00016180: 2064 6174 6120 746f 2074 6865 206f 6666   data to the off
-00016190: 6c69 6e65 0a20 2020 2020 2020 2020 2020  line.           
-000161a0: 2020 2020 2020 2073 746f 7261 6765 2e20         storage. 
-000161b0: 4279 2064 6566 6175 6c74 2074 6865 206d  By default the m
-000161c0: 6174 6572 6961 6c69 7a61 7469 6f6e 206a  aterialization j
-000161d0: 6f62 2067 6574 7320 7374 6172 7465 6420  ob gets started 
-000161e0: 696d 6d65 6469 6174 656c 792e 0a20 2020  immediately..   
-000161f0: 2020 2020 2020 2020 2020 2020 202a 206b               * k
-00016200: 6579 2060 6b61 666b 615f 7072 6f64 7563  ey `kafka_produc
-00016210: 6572 5f63 6f6e 6669 6760 2061 6e64 2076  er_config` and v
-00016220: 616c 7565 2061 6e20 6f62 6a65 6374 206f  alue an object o
-00016230: 6620 7479 7065 205b 7072 6f70 6572 7469  f type [properti
-00016240: 6573 5d28 6874 7470 733a 2f2f 646f 6373  es](https://docs
-00016250: 2e63 6f6e 666c 7565 6e74 2e69 6f2f 706c  .confluent.io/pl
-00016260: 6174 666f 726d 2f63 7572 7265 6e74 2f63  atform/current/c
-00016270: 6c69 656e 7473 2f6c 6962 7264 6b61 666b  lients/librdkafk
-00016280: 612f 6874 6d6c 2f6d 645f 434f 4e46 4947  a/html/md_CONFIG
-00016290: 5552 4154 494f 4e2e 6874 6d6c 6e29 0a20  URATION.htmln). 
-000162a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000162b0: 2075 7365 6420 746f 2063 6f6e 6669 6775   used to configu
-000162c0: 7265 2074 6865 204b 6166 6b61 2063 6c69  re the Kafka cli
-000162d0: 656e 742e 2054 6f20 6f70 7469 6d69 7a65  ent. To optimize
-000162e0: 2066 6f72 2074 6872 6f75 6768 7075 7420   for throughput 
-000162f0: 696e 2068 6967 6820 6c61 7465 6e63 7920  in high latency 
-00016300: 636f 6e6e 6563 7469 6f6e 2c20 636f 6e73  connection, cons
-00016310: 6964 6572 0a20 2020 2020 2020 2020 2020  ider.           
-00016320: 2020 2020 2020 2063 6861 6e67 696e 6720         changing 
-00016330: 7468 6520 5b70 726f 6475 6365 7220 7072  the [producer pr
-00016340: 6f70 6572 7469 6573 5d28 6874 7470 733a  operties](https:
-00016350: 2f2f 646f 6373 2e63 6f6e 666c 7565 6e74  //docs.confluent
-00016360: 2e69 6f2f 636c 6f75 642f 6375 7272 656e  .io/cloud/curren
-00016370: 742f 636c 6965 6e74 2d61 7070 732f 6f70  t/client-apps/op
-00016380: 7469 6d69 7a69 6e67 2f74 6872 6f75 6768  timizing/through
-00016390: 7075 742e 6874 6d6c 2370 726f 6475 6365  put.html#produce
-000163a0: 7229 2e0a 2020 2020 2020 2020 2020 2020  r)..            
-000163b0: 2020 2020 2a20 6b65 7920 6069 6e74 6572      * key `inter
-000163c0: 6e61 6c5f 6b61 666b 6160 2061 6e64 2076  nal_kafka` and v
-000163d0: 616c 7565 2060 5472 7565 6020 6f72 2060  alue `True` or `
-000163e0: 4661 6c73 6560 2069 6e20 6361 7365 2079  False` in case y
-000163f0: 6f75 2065 7374 6162 6c69 7368 6564 0a20  ou established. 
-00016400: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016410: 2063 6f6e 6e65 6374 6976 6974 7920 6672   connectivity fr
-00016420: 6f6d 2079 6f75 2050 7974 686f 6e20 656e  om you Python en
-00016430: 7669 726f 6e6d 656e 7420 746f 2074 6865  vironment to the
-00016440: 2069 6e74 6572 6e61 6c20 6164 7665 7274   internal advert
-00016450: 6973 6564 0a20 2020 2020 2020 2020 2020  ised.           
-00016460: 2020 2020 2020 206c 6973 7465 6e65 7273         listeners
-00016470: 206f 6620 7468 6520 486f 7073 776f 726b   of the Hopswork
-00016480: 7320 4b61 666b 6120 436c 7573 7465 722e  s Kafka Cluster.
-00016490: 2044 6566 6175 6c74 7320 746f 2060 4661   Defaults to `Fa
-000164a0: 6c73 6560 2061 6e64 0a20 2020 2020 2020  lse` and.       
-000164b0: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
-000164c0: 7573 6520 6578 7465 726e 616c 206c 6973  use external lis
-000164d0: 7465 6e65 7273 2077 6865 6e20 636f 6e6e  teners when conn
-000164e0: 6563 7469 6e67 2066 726f 6d20 6f75 7473  ecting from outs
-000164f0: 6964 6520 6f66 2048 6f70 7377 6f72 6b73  ide of Hopsworks
-00016500: 2e0a 2020 2020 2020 2020 2020 2020 7661  ..            va
-00016510: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
-00016520: 3a20 4164 6469 7469 6f6e 616c 2076 616c  : Additional val
-00016530: 6964 6174 696f 6e20 6f70 7469 6f6e 7320  idation options 
-00016540: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
-00016550: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
-00016560: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
-00016570: 2020 2020 2020 2a20 6b65 7920 6072 756e        * key `run
-00016580: 5f76 616c 6964 6174 696f 6e60 2062 6f6f  _validation` boo
-00016590: 6c65 616e 2076 616c 7565 2c20 7365 7420  lean value, set 
-000165a0: 746f 2060 4661 6c73 6560 2074 6f20 736b  to `False` to sk
-000165b0: 6970 2076 616c 6964 6174 696f 6e20 7465  ip validation te
-000165c0: 6d70 6f72 6172 696c 7920 6f6e 2069 6e67  mporarily on ing
-000165d0: 6573 7469 6f6e 2e0a 2020 2020 2020 2020  estion..        
-000165e0: 2020 2020 2020 2020 2a20 6b65 7920 6073          * key `s
-000165f0: 6176 655f 7265 706f 7274 6020 626f 6f6c  ave_report` bool
-00016600: 6561 6e20 7661 6c75 652c 2073 6574 2074  ean value, set t
-00016610: 6f20 6046 616c 7365 6020 746f 2073 6b69  o `False` to ski
-00016620: 7020 7570 6c6f 6164 206f 6620 7468 6520  p upload of the 
-00016630: 7661 6c69 6461 7469 6f6e 2072 6570 6f72  validation repor
-00016640: 7420 746f 2048 6f70 7377 6f72 6b73 2e0a  t to Hopsworks..
-00016650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016660: 2a20 6b65 7920 6067 655f 7661 6c69 6461  * key `ge_valida
-00016670: 7465 5f6b 7761 7267 7360 2061 2064 6963  te_kwargs` a dic
-00016680: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-00016690: 6e67 206b 7761 7267 7320 666f 7220 7468  ng kwargs for th
-000166a0: 6520 7661 6c69 6461 7465 206d 6574 686f  e validate metho
-000166b0: 6420 6f66 2047 7265 6174 2045 7870 6563  d of Great Expec
-000166c0: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
-000166d0: 2020 2020 2077 6169 743a 2057 6169 7420       wait: Wait 
-000166e0: 666f 7220 6a6f 6220 746f 2066 696e 6973  for job to finis
-000166f0: 6820 6265 666f 7265 2072 6574 7572 6e69  h before returni
-00016700: 6e67 2c20 6465 6661 756c 7473 2074 6f20  ng, defaults to 
-00016710: 6046 616c 7365 602e 0a20 2020 2020 2020  `False`..       
-00016720: 2020 2020 2020 2020 2053 686f 7274 6375           Shortcu
-00016730: 7420 666f 7220 7265 6164 5f6f 7074 696f  t for read_optio
-00016740: 6e73 2060 7b22 7761 6974 5f66 6f72 5f6a  ns `{"wait_for_j
-00016750: 6f62 223a 2046 616c 7365 7d60 2e0a 0a20  ob": False}`... 
-00016760: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
-00016770: 0a20 2020 2020 2020 2020 2020 2060 4a6f  .            `Jo
-00016780: 6260 3a20 5768 656e 2075 7369 6e67 2074  b`: When using t
-00016790: 6865 2060 7079 7468 6f6e 6020 656e 6769  he `python` engi
-000167a0: 6e65 2c20 6974 2072 6574 7572 6e73 2074  ne, it returns t
-000167b0: 6865 2048 6f70 7377 6f72 6b73 204a 6f62  he Hopsworks Job
-000167c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000167d0: 2074 6861 7420 7761 7320 6c61 756e 6368   that was launch
-000167e0: 6564 2074 6f20 696e 6765 7374 2074 6865  ed to ingest the
-000167f0: 2066 6561 7475 7265 2067 726f 7570 2064   feature group d
-00016800: 6174 612e 0a0a 2020 2020 2020 2020 2320  ata...        # 
-00016810: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
-00016820: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
-00016830: 6578 6365 7074 696f 6e73 2e52 6573 7441  exceptions.RestA
-00016840: 5049 4572 726f 7260 2e20 556e 6162 6c65  PIError`. Unable
-00016850: 2074 6f20 6372 6561 7465 2066 6561 7475   to create featu
-00016860: 7265 2067 726f 7570 2e0a 2020 2020 2020  re group..      
-00016870: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-00016880: 2028 6665 6174 7572 6573 2069 7320 4e6f   (features is No
-00016890: 6e65 2061 6e64 206c 656e 2873 656c 662e  ne and len(self.
-000168a0: 5f66 6561 7475 7265 7329 203e 2030 2920  _features) > 0) 
-000168b0: 6f72 2028 0a20 2020 2020 2020 2020 2020  or (.           
-000168c0: 2069 7369 6e73 7461 6e63 6528 6665 6174   isinstance(feat
-000168d0: 7572 6573 2c20 4c69 7374 290a 2020 2020  ures, List).    
-000168e0: 2020 2020 2020 2020 616e 6420 6c65 6e28          and len(
-000168f0: 6665 6174 7572 6573 2920 3e20 300a 2020  features) > 0.  
-00016900: 2020 2020 2020 2020 2020 616e 6420 616c            and al
-00016910: 6c28 5b69 7369 6e73 7461 6e63 6528 662c  l([isinstance(f,
-00016920: 2066 6561 7475 7265 2e46 6561 7475 7265   feature.Feature
-00016930: 2920 666f 7220 6620 696e 2066 6561 7475  ) for f in featu
-00016940: 7265 735d 290a 2020 2020 2020 2020 293a  res]).        ):
-00016950: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
-00016960: 6869 7320 6973 2064 6f6e 6520 666f 7220  his is done for 
-00016970: 636f 6d70 6174 6962 696c 6974 792e 2055  compatibility. U
-00016980: 7365 7273 2063 616e 2073 7065 6369 6679  sers can specify
-00016990: 2074 6865 2066 6561 7475 7265 206c 6973   the feature lis
-000169a0: 7420 696e 2074 6865 0a20 2020 2020 2020  t in the.       
-000169b0: 2020 2020 2023 2028 6765 745f 6f72 5f29       # (get_or_)
-000169c0: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-000169d0: 726f 7570 2e20 5573 6572 7320 6361 6e20  roup. Users can 
-000169e0: 616c 736f 2070 726f 7669 6465 2074 6865  also provide the
-000169f0: 2066 6561 7475 7265 206c 6973 7420 696e   feature list in
-00016a00: 2074 6865 2073 6176 6528 292e 0a20 2020   the save()..   
-00016a10: 2020 2020 2020 2020 2023 2054 686f 7567           # Thoug
-00016a20: 6820 6974 2773 2061 6e20 6f70 7469 6f6e  h it's an option
-00016a30: 616c 2070 6172 616d 6574 6572 2e0a 2020  al parameter..  
-00016a40: 2020 2020 2020 2020 2020 2320 466f 7220            # For 
-00016a50: 636f 6e73 6973 7465 6e63 7920 7265 6173  consistency reas
-00016a60: 6f6e 7320 6966 2074 6865 2075 7365 7220  ons if the user 
-00016a70: 7370 6563 6966 7920 626f 7468 2074 6865  specify both the
-00016a80: 2066 6561 7475 7265 206c 6973 7420 696e   feature list in
-00016a90: 2074 6865 2028 6765 745f 6f72 5f29 6372   the (get_or_)cr
-00016aa0: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-00016ab0: 7570 0a20 2020 2020 2020 2020 2020 2023  up.            #
-00016ac0: 2061 6e64 2069 6e20 7468 6520 6073 6176   and in the `sav
-00016ad0: 6528 2960 2063 616c 6c2c 2074 6865 6e20  e()` call, then 
-00016ae0: 7468 6520 2867 6574 5f6f 725f 2963 7265  the (get_or_)cre
-00016af0: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
-00016b00: 7020 7769 6e73 2e0a 2020 2020 2020 2020  p wins..        
-00016b10: 2020 2020 2320 5468 6973 2069 7320 636f      # This is co
-00016b20: 6e73 6973 7465 6e74 2077 6974 6820 7468  nsistent with th
-00016b30: 6520 6265 6861 7669 6f72 206f 6620 7468  e behavior of th
-00016b40: 6520 696e 7365 7274 206d 6574 686f 6420  e insert method 
-00016b50: 7768 6572 6520 7468 6520 6665 6174 7572  where the featur
-00016b60: 6520 6c69 7374 2077 696e 7320 6f76 6572  e list wins over
-00016b70: 2074 6865 0a20 2020 2020 2020 2020 2020   the.           
-00016b80: 2023 2064 6174 6166 7261 6d65 2073 7472   # dataframe str
-00016b90: 7563 7475 7265 0a20 2020 2020 2020 2020  ucture.         
-00016ba0: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-00016bb0: 7320 3d20 7365 6c66 2e5f 6665 6174 7572  s = self._featur
-00016bc0: 6573 2069 6620 6c65 6e28 7365 6c66 2e5f  es if len(self._
-00016bd0: 6665 6174 7572 6573 2920 3e20 3020 656c  features) > 0 el
-00016be0: 7365 2066 6561 7475 7265 730a 2020 2020  se features.    
-00016bf0: 2020 2020 2020 2020 7365 6c66 2e5f 6665          self._fe
-00016c00: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
-00016c10: 6e65 2e73 6176 655f 6665 6174 7572 655f  ne.save_feature_
-00016c20: 6772 6f75 705f 6d65 7461 6461 7461 280a  group_metadata(.
-00016c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c40: 7365 6c66 2c20 4e6f 6e65 2c20 7772 6974  self, None, writ
-00016c50: 655f 6f70 7469 6f6e 730a 2020 2020 2020  e_options.      
-00016c60: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-00016c70: 2020 2020 2072 6574 7572 6e20 4e6f 6e65       return None
-00016c80: 2c20 4e6f 6e65 0a0a 2020 2020 2020 2020  , None..        
-00016c90: 6966 2066 6561 7475 7265 7320 6973 204e  if features is N
-00016ca0: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00016cb0: 2072 6169 7365 2046 6561 7475 7265 5374   raise FeatureSt
-00016cc0: 6f72 6545 7863 6570 7469 6f6e 280a 2020  oreException(.  
-00016cd0: 2020 2020 2020 2020 2020 2020 2020 2246                "F
-00016ce0: 6561 7475 7265 206c 6973 7420 6e6f 7420  eature list not 
-00016cf0: 7072 6f76 6964 6564 2069 6e20 7468 6520  provided in the 
-00016d00: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-00016d10: 726f 7570 206f 7220 6765 745f 6f72 5f63  roup or get_or_c
-00016d20: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
-00016d30: 6f75 7020 696e 766f 6b61 7469 6f6e 732e  oup invokations.
-00016d40: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-00016d50: 2020 2b20 2220 506c 6561 7365 2070 726f    + " Please pro
-00016d60: 7669 6465 2061 206c 6973 7420 6f66 2066  vide a list of f
-00016d70: 6561 7475 7265 7320 6f72 2061 2044 6174  eatures or a Dat
-00016d80: 6166 7261 6d65 220a 2020 2020 2020 2020  aframe".        
-00016d90: 2020 2020 290a 0a20 2020 2020 2020 2066      )..        f
-00016da0: 6561 7475 7265 5f64 6174 6166 7261 6d65  eature_dataframe
-00016db0: 203d 2065 6e67 696e 652e 6765 745f 696e   = engine.get_in
-00016dc0: 7374 616e 6365 2829 2e63 6f6e 7665 7274  stance().convert
-00016dd0: 5f74 6f5f 6465 6661 756c 745f 6461 7461  _to_default_data
-00016de0: 6672 616d 6528 6665 6174 7572 6573 290a  frame(features).
-00016df0: 0a20 2020 2020 2020 2075 7365 725f 7665  .        user_ve
-00016e00: 7273 696f 6e20 3d20 7365 6c66 2e5f 7665  rsion = self._ve
-00016e10: 7273 696f 6e0a 0a20 2020 2020 2020 2069  rsion..        i
-00016e20: 6620 7772 6974 655f 6f70 7469 6f6e 7320  f write_options 
-00016e30: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
-00016e40: 2020 2020 2077 7269 7465 5f6f 7074 696f       write_optio
-00016e50: 6e73 203d 207b 7d0a 2020 2020 2020 2020  ns = {}.        
-00016e60: 6966 2022 7761 6974 5f66 6f72 5f6a 6f62  if "wait_for_job
-00016e70: 2220 6e6f 7420 696e 2077 7269 7465 5f6f  " not in write_o
-00016e80: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
-00016e90: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
-00016ea0: 735b 2277 6169 745f 666f 725f 6a6f 6222  s["wait_for_job"
-00016eb0: 5d20 3d20 7761 6974 0a0a 2020 2020 2020  ] = wait..      
-00016ec0: 2020 2320 6667 5f6a 6f62 2069 7320 7573    # fg_job is us
-00016ed0: 6564 206f 6e6c 7920 6966 2074 6865 2070  ed only if the p
-00016ee0: 7974 686f 6e20 656e 6769 6e65 2069 7320  ython engine is 
-00016ef0: 7573 6564 0a20 2020 2020 2020 2066 675f  used.        fg_
-00016f00: 6a6f 622c 2067 655f 7265 706f 7274 203d  job, ge_report =
-00016f10: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
-00016f20: 726f 7570 5f65 6e67 696e 652e 7361 7665  roup_engine.save
-00016f30: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00016f40: 6c66 2c20 6665 6174 7572 655f 6461 7461  lf, feature_data
-00016f50: 6672 616d 652c 2077 7269 7465 5f6f 7074  frame, write_opt
-00016f60: 696f 6e73 2c20 7661 6c69 6461 7469 6f6e  ions, validation
-00016f70: 5f6f 7074 696f 6e73 0a20 2020 2020 2020  _options.       
-00016f80: 2029 0a20 2020 2020 2020 2069 6620 6765   ).        if ge
-00016f90: 5f72 6570 6f72 7420 6973 204e 6f6e 6520  _report is None 
-00016fa0: 6f72 2067 655f 7265 706f 7274 2e69 6e67  or ge_report.ing
-00016fb0: 6573 7469 6f6e 5f72 6573 756c 7420 3d3d  estion_result ==
-00016fc0: 2022 494e 4745 5354 4544 223a 0a20 2020   "INGESTED":.   
-00016fd0: 2020 2020 2020 2020 2073 656c 662e 5f63           self._c
-00016fe0: 6f64 655f 656e 6769 6e65 2e73 6176 655f  ode_engine.save_
-00016ff0: 636f 6465 2873 656c 6629 0a0a 2020 2020  code(self)..    
-00017000: 2020 2020 6966 2073 656c 662e 7374 6174      if self.stat
-00017010: 6973 7469 6373 5f63 6f6e 6669 672e 656e  istics_config.en
-00017020: 6162 6c65 6420 616e 6420 656e 6769 6e65  abled and engine
-00017030: 2e67 6574 5f74 7970 6528 292e 7374 6172  .get_type().star
-00017040: 7473 7769 7468 2822 7370 6172 6b22 293a  tswith("spark"):
-00017050: 0a20 2020 2020 2020 2020 2020 2023 204f  .            # O
-00017060: 6e6c 7920 636f 6d70 7574 6520 7374 6174  nly compute stat
-00017070: 6973 7469 6373 2069 6620 7468 6520 656e  istics if the en
-00017080: 6769 6e65 2069 7320 5370 6172 6b2e 0a20  gine is Spark.. 
-00017090: 2020 2020 2020 2020 2020 2023 2046 6f72             # For
-000170a0: 2050 7974 686f 6e20 656e 6769 6e65 2c20   Python engine, 
-000170b0: 7468 6520 636f 6d70 7574 6174 696f 6e20  the computation 
-000170c0: 6861 7070 656e 7320 696e 2074 6865 2048  happens in the H
-000170d0: 6f70 7377 6f72 6b73 2061 7070 6c69 6361  opsworks applica
-000170e0: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
-000170f0: 2073 656c 662e 5f73 7461 7469 7374 6963   self._statistic
-00017100: 735f 656e 6769 6e65 2e63 6f6d 7075 7465  s_engine.compute
-00017110: 5f61 6e64 5f73 6176 655f 7374 6174 6973  _and_save_statis
-00017120: 7469 6373 2873 656c 662c 2066 6561 7475  tics(self, featu
-00017130: 7265 5f64 6174 6166 7261 6d65 290a 2020  re_dataframe).  
-00017140: 2020 2020 2020 6966 2075 7365 725f 7665        if user_ve
-00017150: 7273 696f 6e20 6973 204e 6f6e 653a 0a20  rsion is None:. 
-00017160: 2020 2020 2020 2020 2020 2077 6172 6e69             warni
-00017170: 6e67 732e 7761 726e 280a 2020 2020 2020  ngs.warn(.      
-00017180: 2020 2020 2020 2020 2020 224e 6f20 7665            "No ve
-00017190: 7273 696f 6e20 7072 6f76 6964 6564 2066  rsion provided f
-000171a0: 6f72 2063 7265 6174 696e 6720 6665 6174  or creating feat
-000171b0: 7572 6520 6772 6f75 7020 607b 7d60 2c20  ure group `{}`, 
-000171c0: 696e 6372 656d 656e 7465 6420 7665 7273  incremented vers
-000171d0: 696f 6e20 746f 2060 7b7d 602e 222e 666f  ion to `{}`.".fo
-000171e0: 726d 6174 280a 2020 2020 2020 2020 2020  rmat(.          
-000171f0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00017200: 6e61 6d65 2c20 7365 6c66 2e5f 7665 7273  name, self._vers
-00017210: 696f 6e0a 2020 2020 2020 2020 2020 2020  ion.            
-00017220: 2020 2020 292c 0a20 2020 2020 2020 2020      ),.         
-00017230: 2020 2020 2020 2075 7469 6c2e 5665 7273         util.Vers
-00017240: 696f 6e57 6172 6e69 6e67 2c0a 2020 2020  ionWarning,.    
-00017250: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-00017260: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00017270: 2020 2020 2020 2066 675f 6a6f 622c 0a20         fg_job,. 
-00017280: 2020 2020 2020 2020 2020 2067 655f 7265             ge_re
-00017290: 706f 7274 2e74 6f5f 6765 5f74 7970 6528  port.to_ge_type(
-000172a0: 2920 6966 2067 655f 7265 706f 7274 2069  ) if ge_report i
-000172b0: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
-000172c0: 4e6f 6e65 2c0a 2020 2020 2020 2020 290a  None,.        ).
-000172d0: 0a20 2020 2064 6566 2069 6e73 6572 7428  .    def insert(
-000172e0: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-000172f0: 2020 2020 2020 2066 6561 7475 7265 733a         features:
-00017300: 2055 6e69 6f6e 5b0a 2020 2020 2020 2020   Union[.        
-00017310: 2020 2020 7064 2e44 6174 6146 7261 6d65      pd.DataFrame
-00017320: 2c0a 2020 2020 2020 2020 2020 2020 5479  ,.            Ty
-00017330: 7065 5661 7228 2270 7973 7061 726b 2e73  peVar("pyspark.s
-00017340: 716c 2e44 6174 6146 7261 6d65 2229 2c20  ql.DataFrame"), 
-00017350: 2023 206e 6f71 613a 2046 3832 310a 2020   # noqa: F821.  
-00017360: 2020 2020 2020 2020 2020 5479 7065 5661            TypeVa
-00017370: 7228 2270 7973 7061 726b 2e52 4444 2229  r("pyspark.RDD")
-00017380: 2c20 2023 206e 6f71 613a 2046 3832 310a  ,  # noqa: F821.
-00017390: 2020 2020 2020 2020 2020 2020 6e70 2e6e              np.n
-000173a0: 6461 7272 6179 2c0a 2020 2020 2020 2020  darray,.        
-000173b0: 2020 2020 4c69 7374 5b6c 6973 745d 2c0a      List[list],.
-000173c0: 2020 2020 2020 2020 5d2c 0a20 2020 2020          ],.     
-000173d0: 2020 206f 7665 7277 7269 7465 3a20 4f70     overwrite: Op
-000173e0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2046  tional[bool] = F
-000173f0: 616c 7365 2c0a 2020 2020 2020 2020 6f70  alse,.        op
-00017400: 6572 6174 696f 6e3a 204f 7074 696f 6e61  eration: Optiona
-00017410: 6c5b 7374 725d 203d 2022 7570 7365 7274  l[str] = "upsert
-00017420: 222c 0a20 2020 2020 2020 2073 746f 7261  ",.        stora
-00017430: 6765 3a20 4f70 7469 6f6e 616c 5b73 7472  ge: Optional[str
-00017440: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00017450: 2020 7772 6974 655f 6f70 7469 6f6e 733a    write_options:
-00017460: 204f 7074 696f 6e61 6c5b 4469 6374 5b73   Optional[Dict[s
-00017470: 7472 2c20 416e 795d 5d20 3d20 7b7d 2c0a  tr, Any]] = {},.
-00017480: 2020 2020 2020 2020 7661 6c69 6461 7469          validati
-00017490: 6f6e 5f6f 7074 696f 6e73 3a20 4f70 7469  on_options: Opti
-000174a0: 6f6e 616c 5b44 6963 745b 7374 722c 2041  onal[Dict[str, A
-000174b0: 6e79 5d5d 203d 207b 7d2c 0a20 2020 2020  ny]] = {},.     
-000174c0: 2020 2073 6176 655f 636f 6465 3a20 4f70     save_code: Op
-000174d0: 7469 6f6e 616c 5b62 6f6f 6c5d 203d 2054  tional[bool] = T
-000174e0: 7275 652c 0a20 2020 2020 2020 2077 6169  rue,.        wai
-000174f0: 743a 2062 6f6f 6c20 3d20 4661 6c73 652c  t: bool = False,
-00017500: 0a20 2020 2029 202d 3e20 5475 706c 655b  .    ) -> Tuple[
-00017510: 4f70 7469 6f6e 616c 5b4a 6f62 5d2c 204f  Optional[Job], O
-00017520: 7074 696f 6e61 6c5b 5661 6c69 6461 7469  ptional[Validati
-00017530: 6f6e 5265 706f 7274 5d5d 3a0a 2020 2020  onReport]]:.    
-00017540: 2020 2020 2222 2250 6572 7369 7374 2074      """Persist t
-00017550: 6865 206d 6574 6164 6174 6120 616e 6420  he metadata and 
-00017560: 6d61 7465 7269 616c 697a 6520 7468 6520  materialize the 
-00017570: 6665 6174 7572 6520 6772 6f75 7020 746f  feature group to
-00017580: 2074 6865 2066 6561 7475 7265 2073 746f   the feature sto
-00017590: 7265 0a20 2020 2020 2020 206f 7220 696e  re.        or in
-000175a0: 7365 7274 2064 6174 6120 6672 6f6d 2061  sert data from a
-000175b0: 2064 6174 6166 7261 6d65 2069 6e74 6f20   dataframe into 
-000175c0: 7468 6520 6578 6973 7469 6e67 2066 6561  the existing fea
-000175d0: 7475 7265 2067 726f 7570 2e0a 0a20 2020  ture group...   
-000175e0: 2020 2020 2049 6e63 7265 6d65 6e74 616c       Incremental
-000175f0: 6c79 2069 6e73 6572 7420 6461 7461 2074  ly insert data t
-00017600: 6f20 6120 6665 6174 7572 6520 6772 6f75  o a feature grou
-00017610: 7020 6f72 206f 7665 7277 7269 7465 2061  p or overwrite a
-00017620: 6c6c 2064 6174 6120 636f 6e74 6169 6e65  ll data containe
-00017630: 6420 696e 2074 6865 2066 6561 7475 7265  d in the feature
-00017640: 2067 726f 7570 2e20 4279 0a20 2020 2020   group. By.     
-00017650: 2020 2064 6566 6175 6c74 2c20 7468 6520     default, the 
-00017660: 6461 7461 2069 7320 696e 7365 7274 6564  data is inserted
-00017670: 2069 6e74 6f20 7468 6520 6f66 666c 696e   into the offlin
-00017680: 6520 7374 6f72 6167 6520 6173 2077 656c  e storage as wel
-00017690: 6c20 6173 2074 6865 206f 6e6c 696e 6520  l as the online 
-000176a0: 7374 6f72 6167 6520 6966 2074 6865 2066  storage if the f
-000176b0: 6561 7475 7265 2067 726f 7570 2069 730a  eature group is.
-000176c0: 2020 2020 2020 2020 606f 6e6c 696e 655f          `online_
-000176d0: 656e 6162 6c65 643d 5472 7565 602e 0a0a  enabled=True`...
-000176e0: 2020 2020 2020 2020 5468 6520 6066 6561          The `fea
-000176f0: 7475 7265 7360 2064 6174 6166 7261 6d65  tures` dataframe
-00017700: 2063 616e 2062 6520 6120 5370 6172 6b20   can be a Spark 
-00017710: 4461 7461 4672 616d 6520 6f72 2052 4444  DataFrame or RDD
-00017720: 2c20 6120 5061 6e64 6173 2044 6174 6146  , a Pandas DataF
-00017730: 7261 6d65 2c0a 2020 2020 2020 2020 6f72  rame,.        or
-00017740: 2061 2074 776f 2d64 696d 656e 7369 6f6e   a two-dimension
-00017750: 616c 204e 756d 7079 2061 7272 6179 206f  al Numpy array o
-00017760: 7220 6120 7477 6f2d 6469 6d65 6e73 696f  r a two-dimensio
-00017770: 6e61 6c20 5079 7468 6f6e 206e 6573 7465  nal Python neste
-00017780: 6420 6c69 7374 2e0a 2020 2020 2020 2020  d list..        
-00017790: 4966 2073 7461 7469 7374 6963 7320 6172  If statistics ar
-000177a0: 6520 656e 6162 6c65 642c 2073 7461 7469  e enabled, stati
-000177b0: 7374 6963 7320 6172 6520 7265 636f 6d70  stics are recomp
-000177c0: 7574 6564 2066 6f72 2074 6865 2065 6e74  uted for the ent
-000177d0: 6972 6520 6665 6174 7572 650a 2020 2020  ire feature.    
-000177e0: 2020 2020 6772 6f75 702e 0a20 2020 2020      group..     
-000177f0: 2020 2049 6620 6665 6174 7572 6520 6772     If feature gr
-00017800: 6f75 7027 7320 7469 6d65 2074 7261 7665  oup's time trave
-00017810: 6c20 666f 726d 6174 2069 7320 6048 5544  l format is `HUD
-00017820: 4960 2074 6865 6e20 606f 7065 7261 7469  I` then `operati
-00017830: 6f6e 6020 6172 6775 6d65 6e74 2063 616e  on` argument can
-00017840: 2062 650a 2020 2020 2020 2020 6569 7468   be.        eith
-00017850: 6572 2060 696e 7365 7274 6020 6f72 2060  er `insert` or `
-00017860: 7570 7365 7274 602e 0a0a 2020 2020 2020  upsert`...      
-00017870: 2020 4966 2066 6561 7475 7265 2067 726f    If feature gro
-00017880: 7570 2064 6f65 736e 2774 2065 7869 7374  up doesn't exist
-00017890: 2074 6865 2069 6e73 6572 7420 6d65 7468   the insert meth
-000178a0: 6f64 2077 696c 6c20 6372 6561 7465 2074  od will create t
-000178b0: 6865 206e 6563 6573 7361 7279 206d 6574  he necessary met
-000178c0: 6164 6174 6120 7468 6520 6669 7273 7420  adata the first 
-000178d0: 7469 6d65 2069 7420 6973 0a20 2020 2020  time it is.     
-000178e0: 2020 2069 6e76 6f6b 6564 2061 6e64 2077     invoked and w
-000178f0: 7269 7465 7320 7468 6520 7370 6563 6966  rites the specif
-00017900: 6965 6420 6066 6561 7475 7265 7360 2064  ied `features` d
-00017910: 6174 6166 7261 6d65 2061 7320 6665 6174  ataframe as feat
-00017920: 7572 6520 6772 6f75 7020 746f 2074 6865  ure group to the
-00017930: 206f 6e6c 696e 652f 6f66 666c 696e 6520   online/offline 
-00017940: 6665 6174 7572 6520 7374 6f72 652e 0a0a  feature store...
-00017950: 2020 2020 2020 2020 2121 2120 7761 726e          !!! warn
-00017960: 696e 6720 2243 6861 6e67 6564 2069 6e20  ing "Changed in 
-00017970: 332e 332e 3022 0a20 2020 2020 2020 2020  3.3.0".         
-00017980: 2020 2060 696e 7365 7274 6020 616e 6420     `insert` and 
-00017990: 6073 6176 6560 206d 6574 686f 6473 2061  `save` methods a
-000179a0: 7265 206e 6f77 2061 7379 6e63 2062 7920  re now async by 
-000179b0: 6465 6661 756c 7420 696e 206e 6f6e 2d73  default in non-s
-000179c0: 7061 726b 2063 6c69 656e 7473 2e0a 2020  park clients..  
-000179d0: 2020 2020 2020 2020 2020 546f 2061 6368            To ach
-000179e0: 6965 7665 2074 6865 206f 6c64 2062 6568  ieve the old beh
-000179f0: 6176 696f 7572 2c20 7365 7420 6077 6169  aviour, set `wai
-00017a00: 7460 2061 7267 756d 656e 7420 746f 2060  t` argument to `
-00017a10: 5472 7565 602e 0a0a 2020 2020 2020 2020  True`...        
-00017a20: 2121 2120 6578 616d 706c 6520 2255 7073  !!! example "Ups
-00017a30: 6572 7420 6e65 7720 6665 6174 7572 6520  ert new feature 
-00017a40: 6461 7461 2077 6974 6820 7469 6d65 2074  data with time t
-00017a50: 7261 7665 6c20 666f 726d 6174 2060 4855  ravel format `HU
-00017a60: 4449 6022 0a20 2020 2020 2020 2020 2020  DI`".           
-00017a70: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
-00017a80: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
-00017a90: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
-00017aa0: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
-00017ab0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
-00017ac0: 2020 2020 2020 2020 6667 203d 2066 732e          fg = fs.
-00017ad0: 6765 745f 6f72 5f63 7265 6174 655f 6665  get_or_create_fe
-00017ae0: 6174 7572 655f 6772 6f75 7028 0a20 2020  ature_group(.   
-00017af0: 2020 2020 2020 2020 2020 2020 206e 616d               nam
-00017b00: 653d 2762 6974 636f 696e 5f70 7269 6365  e='bitcoin_price
-00017b10: 272c 0a20 2020 2020 2020 2020 2020 2020  ',.             
-00017b20: 2020 2064 6573 6372 6970 7469 6f6e 3d27     description='
-00017b30: 4269 7463 6f69 6e20 7072 6963 6520 6167  Bitcoin price ag
-00017b40: 6772 6567 6174 6564 2066 6f72 2064 6179  gregated for day
-00017b50: 7327 2c0a 2020 2020 2020 2020 2020 2020  s',.            
-00017b60: 2020 2020 7665 7273 696f 6e3d 312c 0a20      version=1,. 
-00017b70: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-00017b80: 7269 6d61 7279 5f6b 6579 3d5b 2775 6e69  rimary_key=['uni
-00017b90: 7827 5d2c 0a20 2020 2020 2020 2020 2020  x'],.           
-00017ba0: 2020 2020 206f 6e6c 696e 655f 656e 6162       online_enab
-00017bb0: 6c65 643d 5472 7565 2c0a 2020 2020 2020  led=True,.      
-00017bc0: 2020 2020 2020 2020 2020 6576 656e 745f            event_
-00017bd0: 7469 6d65 3d27 756e 6978 270a 2020 2020  time='unix'.    
-00017be0: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
-00017bf0: 2020 2020 2020 2066 672e 696e 7365 7274         fg.insert
-00017c00: 2864 665f 6269 7463 6f69 6e5f 7072 6f63  (df_bitcoin_proc
-00017c10: 6573 7365 6429 0a20 2020 2020 2020 2020  essed).         
-00017c20: 2020 2060 6060 0a0a 2020 2020 2020 2020     ```..        
-00017c30: 2121 2120 6578 616d 706c 6520 2241 7379  !!! example "Asy
-00017c40: 6e63 2069 6e73 6572 7422 0a20 2020 2020  nc insert".     
-00017c50: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-00017c60: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
-00017c70: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
-00017c80: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
-00017c90: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
-00017ca0: 0a0a 2020 2020 2020 2020 2020 2020 6667  ..            fg
-00017cb0: 3120 3d20 6673 2e67 6574 5f6f 725f 6372  1 = fs.get_or_cr
-00017cc0: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-00017cd0: 7570 280a 2020 2020 2020 2020 2020 2020  up(.            
-00017ce0: 2020 2020 6e61 6d65 3d27 6665 6174 7572      name='featur
-00017cf0: 655f 6772 6f75 705f 6e61 6d65 3127 2c0a  e_group_name1',.
-00017d00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017d10: 6465 7363 7269 7074 696f 6e3d 2744 6573  description='Des
-00017d20: 6372 6970 7469 6f6e 206f 6620 7468 6520  cription of the 
-00017d30: 6669 7273 7420 4647 272c 0a20 2020 2020  first FG',.     
-00017d40: 2020 2020 2020 2020 2020 2076 6572 7369             versi
-00017d50: 6f6e 3d31 2c0a 2020 2020 2020 2020 2020  on=1,.          
-00017d60: 2020 2020 2020 7072 696d 6172 795f 6b65        primary_ke
-00017d70: 793d 5b27 756e 6978 275d 2c0a 2020 2020  y=['unix'],.    
-00017d80: 2020 2020 2020 2020 2020 2020 6f6e 6c69              onli
-00017d90: 6e65 5f65 6e61 626c 6564 3d54 7275 652c  ne_enabled=True,
-00017da0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017db0: 2065 7665 6e74 5f74 696d 653d 2775 6e69   event_time='uni
-00017dc0: 7827 0a20 2020 2020 2020 2020 2020 2029  x'.            )
-00017dd0: 0a20 2020 2020 2020 2020 2020 2023 2061  .            # a
-00017de0: 7379 6e63 2069 6e73 6572 7469 6f6e 2069  sync insertion i
-00017df0: 6e20 6f72 6465 7220 6e6f 7420 746f 2077  n order not to w
-00017e00: 6169 7420 7469 6c6c 2066 696e 6973 6820  ait till finish 
-00017e10: 6f66 2074 6865 206a 6f62 0a20 2020 2020  of the job.     
-00017e20: 2020 2020 2020 2066 672e 696e 7365 7274         fg.insert
-00017e30: 2864 665f 666f 725f 6667 312c 2077 7269  (df_for_fg1, wri
-00017e40: 7465 5f6f 7074 696f 6e73 3d7b 2277 6169  te_options={"wai
-00017e50: 745f 666f 725f 6a6f 6222 203a 2046 616c  t_for_job" : Fal
-00017e60: 7365 7d29 0a0a 2020 2020 2020 2020 2020  se})..          
-00017e70: 2020 6667 3220 3d20 6673 2e67 6574 5f6f    fg2 = fs.get_o
-00017e80: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
-00017e90: 5f67 726f 7570 280a 2020 2020 2020 2020  _group(.        
-00017ea0: 2020 2020 2020 2020 6e61 6d65 3d27 6665          name='fe
-00017eb0: 6174 7572 655f 6772 6f75 705f 6e61 6d65  ature_group_name
-00017ec0: 3227 2c0a 2020 2020 2020 2020 2020 2020  2',.            
-00017ed0: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
-00017ee0: 2744 6573 6372 6970 7469 6f6e 206f 6620  'Description of 
-00017ef0: 7468 6520 7365 636f 6e64 2046 4727 2c0a  the second FG',.
-00017f00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00017f10: 7665 7273 696f 6e3d 312c 0a20 2020 2020  version=1,.     
-00017f20: 2020 2020 2020 2020 2020 2070 7269 6d61             prima
-00017f30: 7279 5f6b 6579 3d5b 2775 6e69 7827 5d2c  ry_key=['unix'],
-00017f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017f50: 206f 6e6c 696e 655f 656e 6162 6c65 643d   online_enabled=
-00017f60: 5472 7565 2c0a 2020 2020 2020 2020 2020  True,.          
-00017f70: 2020 2020 2020 6576 656e 745f 7469 6d65        event_time
-00017f80: 3d27 756e 6978 270a 2020 2020 2020 2020  ='unix'.        
-00017f90: 2020 2020 290a 2020 2020 2020 2020 2020      ).          
-00017fa0: 2020 6667 2e69 6e73 6572 7428 6466 5f66    fg.insert(df_f
-00017fb0: 6f72 5f66 6732 290a 2020 2020 2020 2020  or_fg2).        
-00017fc0: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-00017fd0: 2023 2041 7267 756d 656e 7473 0a20 2020   # Arguments.   
-00017fe0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-00017ff0: 733a 2044 6174 6146 7261 6d65 2c20 5244  s: DataFrame, RD
-00018000: 442c 204e 6461 7272 6179 2c20 6c69 7374  D, Ndarray, list
-00018010: 2e20 4665 6174 7572 6573 2074 6f20 6265  . Features to be
-00018020: 2073 6176 6564 2e0a 2020 2020 2020 2020   saved..        
-00018030: 2020 2020 6f76 6572 7772 6974 653a 2044      overwrite: D
-00018040: 726f 7020 616c 6c20 6461 7461 2069 6e20  rop all data in 
-00018050: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00018060: 7020 6265 666f 7265 0a20 2020 2020 2020  p before.       
-00018070: 2020 2020 2020 2020 2069 6e73 6572 7469           inserti
-00018080: 6e67 206e 6577 2064 6174 612e 2054 6869  ng new data. Thi
-00018090: 7320 646f 6573 206e 6f74 2061 6666 6563  s does not affec
-000180a0: 7420 6d65 7461 6461 7461 2c20 6465 6661  t metadata, defa
-000180b0: 756c 7473 2074 6f20 4661 6c73 652e 0a20  ults to False.. 
-000180c0: 2020 2020 2020 2020 2020 206f 7065 7261             opera
-000180d0: 7469 6f6e 3a20 4170 6163 6865 2048 7564  tion: Apache Hud
-000180e0: 6920 6f70 6572 6174 696f 6e20 7479 7065  i operation type
-000180f0: 2060 2269 6e73 6572 7422 6020 6f72 2060   `"insert"` or `
-00018100: 2275 7073 6572 7422 602e 0a20 2020 2020  "upsert"`..     
-00018110: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00018120: 6c74 7320 746f 2060 2275 7073 6572 7422  lts to `"upsert"
-00018130: 602e 0a20 2020 2020 2020 2020 2020 2073  `..            s
-00018140: 746f 7261 6765 3a20 4f76 6572 7772 6974  torage: Overwrit
-00018150: 6520 6465 6661 756c 7420 6265 6861 7669  e default behavi
-00018160: 6f75 722c 2077 7269 7465 2074 6f20 6f66  our, write to of
-00018170: 666c 696e 650a 2020 2020 2020 2020 2020  fline.          
-00018180: 2020 2020 2020 7374 6f72 6167 6520 6f6e        storage on
-00018190: 6c79 2077 6974 6820 6022 6f66 666c 696e  ly with `"offlin
-000181a0: 6522 6020 6f72 206f 6e6c 696e 6520 6f6e  e"` or online on
-000181b0: 6c79 2077 6974 6820 6022 6f6e 6c69 6e65  ly with `"online
-000181c0: 2260 2c20 6465 6661 756c 7473 0a20 2020  "`, defaults.   
-000181d0: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
-000181e0: 604e 6f6e 6560 2028 4966 2074 6865 2073  `None` (If the s
-000181f0: 7472 6561 6d69 6e67 2041 5049 7320 6172  treaming APIs ar
-00018200: 6520 656e 6162 6c65 642c 2073 7065 6369  e enabled, speci
-00018210: 6679 696e 6720 7468 6520 7374 6f72 6167  fying the storag
-00018220: 6520 6f70 7469 6f6e 2069 7320 6e6f 7420  e option is not 
-00018230: 7375 7070 6f72 7465 6429 2e0a 2020 2020  supported)..    
-00018240: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
-00018250: 7469 6f6e 733a 2041 6464 6974 696f 6e61  tions: Additiona
-00018260: 6c20 7772 6974 6520 6f70 7469 6f6e 7320  l write options 
-00018270: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
-00018280: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
-00018290: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
-000182a0: 2020 2020 2020 5768 656e 2075 7369 6e67        When using
-000182b0: 2074 6865 2060 7079 7468 6f6e 6020 656e   the `python` en
-000182c0: 6769 6e65 2c20 7772 6974 655f 6f70 7469  gine, write_opti
-000182d0: 6f6e 7320 6361 6e20 636f 6e74 6169 6e20  ons can contain 
-000182e0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
-000182f0: 2020 2020 666f 6c6c 6f77 696e 6720 656e      following en
-00018300: 7472 6965 733a 0a20 2020 2020 2020 2020  tries:.         
-00018310: 2020 2020 2020 202a 206b 6579 2060 7370         * key `sp
-00018320: 6172 6b60 2061 6e64 2076 616c 7565 2061  ark` and value a
-00018330: 6e20 6f62 6a65 6374 206f 6620 7479 7065  n object of type
-00018340: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018350: 205b 6873 6673 2e63 6f72 652e 6a6f 625f   [hsfs.core.job_
-00018360: 636f 6e66 6967 7572 6174 696f 6e2e 4a6f  configuration.Jo
-00018370: 6243 6f6e 6669 6775 7261 7469 6f6e 5d28  bConfiguration](
-00018380: 2e2e 2f6a 6f62 5f63 6f6e 6669 6775 7261  ../job_configura
-00018390: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
-000183a0: 2020 2020 2020 2020 746f 2063 6f6e 6669          to confi
-000183b0: 6775 7265 2074 6865 2048 6f70 7377 6f72  gure the Hopswor
-000183c0: 6b73 204a 6f62 2075 7365 6420 746f 2077  ks Job used to w
-000183d0: 7269 7465 2064 6174 6120 696e 746f 2074  rite data into t
-000183e0: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
-000183f0: 2020 2020 2066 6561 7475 7265 2067 726f       feature gro
-00018400: 7570 2e0a 2020 2020 2020 2020 2020 2020  up..            
-00018410: 2020 2020 2a20 6b65 7920 6077 6169 745f      * key `wait_
-00018420: 666f 725f 6a6f 6260 2061 6e64 2076 616c  for_job` and val
-00018430: 7565 2060 5472 7565 6020 6f72 2060 4661  ue `True` or `Fa
-00018440: 6c73 6560 2074 6f20 636f 6e66 6967 7572  lse` to configur
-00018450: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00018460: 2020 2020 7768 6574 6865 7220 6f72 206e      whether or n
-00018470: 6f74 2074 6f20 7468 6520 696e 7365 7274  ot to the insert
-00018480: 2063 616c 6c20 7368 6f75 6c64 2072 6574   call should ret
-00018490: 7572 6e20 6f6e 6c79 0a20 2020 2020 2020  urn only.       
-000184a0: 2020 2020 2020 2020 2020 2061 6674 6572             after
-000184b0: 2074 6865 2048 6f70 7377 6f72 6b73 204a   the Hopsworks J
-000184c0: 6f62 2068 6173 2066 696e 6973 6865 642e  ob has finished.
-000184d0: 2042 7920 6465 6661 756c 7420 6974 2077   By default it w
-000184e0: 6169 7473 2e0a 2020 2020 2020 2020 2020  aits..          
-000184f0: 2020 2020 2020 2a20 6b65 7920 6073 7461        * key `sta
-00018500: 7274 5f6f 6666 6c69 6e65 5f62 6163 6b66  rt_offline_backf
-00018510: 696c 6c60 2061 6e64 2076 616c 7565 2060  ill` and value `
-00018520: 5472 7565 6020 6f72 2060 4661 6c73 6560  True` or `False`
-00018530: 2074 6f20 636f 6e66 6967 7572 650a 2020   to configure.  
-00018540: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018550: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
-00018560: 6f20 7374 6172 7420 7468 6520 6d61 7465  o start the mate
-00018570: 7269 616c 697a 6174 696f 6e20 6a6f 6220  rialization job 
-00018580: 746f 2077 7269 7465 2064 6174 6120 746f  to write data to
-00018590: 2074 6865 206f 6666 6c69 6e65 0a20 2020   the offline.   
-000185a0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-000185b0: 746f 7261 6765 2e20 6073 7461 7274 5f6f  torage. `start_o
-000185c0: 6666 6c69 6e65 5f62 6163 6b66 696c 6c60  ffline_backfill`
-000185d0: 2069 7320 6465 7072 6563 6174 6564 2e20   is deprecated. 
-000185e0: 5573 6520 6073 7461 7274 5f6f 6666 6c69  Use `start_offli
-000185f0: 6e65 5f6d 6174 6572 6961 6c69 7a61 7469  ne_materializati
-00018600: 6f6e 6020 696e 7374 6561 642e 0a20 2020  on` instead..   
-00018610: 2020 2020 2020 2020 2020 2020 202a 206b               * k
-00018620: 6579 2060 7374 6172 745f 6f66 666c 696e  ey `start_offlin
-00018630: 655f 6d61 7465 7269 616c 697a 6174 696f  e_materializatio
-00018640: 6e60 2061 6e64 2076 616c 7565 2060 5472  n` and value `Tr
-00018650: 7565 6020 6f72 2060 4661 6c73 6560 2074  ue` or `False` t
-00018660: 6f20 636f 6e66 6967 7572 650a 2020 2020  o configure.    
-00018670: 2020 2020 2020 2020 2020 2020 2020 7768                wh
-00018680: 6574 6865 7220 6f72 206e 6f74 2074 6f20  ether or not to 
-00018690: 7374 6172 7420 7468 6520 6d61 7465 7269  start the materi
-000186a0: 616c 697a 6174 696f 6e20 6a6f 6220 746f  alization job to
-000186b0: 2077 7269 7465 2064 6174 6120 746f 2074   write data to t
-000186c0: 6865 206f 6666 6c69 6e65 0a20 2020 2020  he offline.     
-000186d0: 2020 2020 2020 2020 2020 2020 2073 746f               sto
-000186e0: 7261 6765 2e20 4279 2064 6566 6175 6c74  rage. By default
-000186f0: 2074 6865 206d 6174 6572 6961 6c69 7a61   the materializa
-00018700: 7469 6f6e 206a 6f62 2067 6574 7320 7374  tion job gets st
-00018710: 6172 7465 6420 696d 6d65 6469 6174 656c  arted immediatel
-00018720: 792e 0a20 2020 2020 2020 2020 2020 2020  y..             
-00018730: 2020 202a 206b 6579 2060 6b61 666b 615f     * key `kafka_
-00018740: 7072 6f64 7563 6572 5f63 6f6e 6669 6760  producer_config`
-00018750: 2061 6e64 2076 616c 7565 2061 6e20 6f62   and value an ob
-00018760: 6a65 6374 206f 6620 7479 7065 205b 7072  ject of type [pr
-00018770: 6f70 6572 7469 6573 5d28 6874 7470 733a  operties](https:
-00018780: 2f2f 646f 6373 2e63 6f6e 666c 7565 6e74  //docs.confluent
-00018790: 2e69 6f2f 706c 6174 666f 726d 2f63 7572  .io/platform/cur
-000187a0: 7265 6e74 2f63 6c69 656e 7473 2f6c 6962  rent/clients/lib
-000187b0: 7264 6b61 666b 612f 6874 6d6c 2f6d 645f  rdkafka/html/md_
-000187c0: 434f 4e46 4947 5552 4154 494f 4e2e 6874  CONFIGURATION.ht
-000187d0: 6d6c 6e29 0a20 2020 2020 2020 2020 2020  mln).           
-000187e0: 2020 2020 2020 2075 7365 6420 746f 2063         used to c
-000187f0: 6f6e 6669 6775 7265 2074 6865 204b 6166  onfigure the Kaf
-00018800: 6b61 2063 6c69 656e 742e 2054 6f20 6f70  ka client. To op
-00018810: 7469 6d69 7a65 2066 6f72 2074 6872 6f75  timize for throu
-00018820: 6768 7075 7420 696e 2068 6967 6820 6c61  ghput in high la
-00018830: 7465 6e63 7920 636f 6e6e 6563 7469 6f6e  tency connection
-00018840: 2063 6f6e 7369 6465 720a 2020 2020 2020   consider.      
-00018850: 2020 2020 2020 2020 2020 2020 6368 616e              chan
-00018860: 6769 6e67 205b 7072 6f64 7563 6572 2070  ging [producer p
-00018870: 726f 7065 7274 6965 735d 2868 7474 7073  roperties](https
-00018880: 3a2f 2f64 6f63 732e 636f 6e66 6c75 656e  ://docs.confluen
-00018890: 742e 696f 2f63 6c6f 7564 2f63 7572 7265  t.io/cloud/curre
-000188a0: 6e74 2f63 6c69 656e 742d 6170 7073 2f6f  nt/client-apps/o
-000188b0: 7074 696d 697a 696e 672f 7468 726f 7567  ptimizing/throug
-000188c0: 6870 7574 2e68 746d 6c23 7072 6f64 7563  hput.html#produc
-000188d0: 6572 292e 0a20 2020 2020 2020 2020 2020  er)..           
-000188e0: 2020 2020 202a 206b 6579 2060 696e 7465       * key `inte
-000188f0: 726e 616c 5f6b 6166 6b61 6020 616e 6420  rnal_kafka` and 
-00018900: 7661 6c75 6520 6054 7275 6560 206f 7220  value `True` or 
-00018910: 6046 616c 7365 6020 696e 2063 6173 6520  `False` in case 
-00018920: 796f 7520 6573 7461 626c 6973 6865 640a  you established.
-00018930: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018940: 2020 636f 6e6e 6563 7469 7669 7479 2066    connectivity f
-00018950: 726f 6d20 796f 7520 5079 7468 6f6e 2065  rom you Python e
-00018960: 6e76 6972 6f6e 6d65 6e74 2074 6f20 7468  nvironment to th
-00018970: 6520 696e 7465 726e 616c 2061 6476 6572  e internal adver
-00018980: 7469 7365 640a 2020 2020 2020 2020 2020  tised.          
-00018990: 2020 2020 2020 2020 6c69 7374 656e 6572          listener
-000189a0: 7320 6f66 2074 6865 2048 6f70 7377 6f72  s of the Hopswor
-000189b0: 6b73 204b 6166 6b61 2043 6c75 7374 6572  ks Kafka Cluster
-000189c0: 2e20 4465 6661 756c 7473 2074 6f20 6046  . Defaults to `F
-000189d0: 616c 7365 6020 616e 640a 2020 2020 2020  alse` and.      
-000189e0: 2020 2020 2020 2020 2020 2020 7769 6c6c              will
-000189f0: 2075 7365 2065 7874 6572 6e61 6c20 6c69   use external li
-00018a00: 7374 656e 6572 7320 7768 656e 2063 6f6e  steners when con
-00018a10: 6e65 6374 696e 6720 6672 6f6d 206f 7574  necting from out
-00018a20: 7369 6465 206f 6620 486f 7073 776f 726b  side of Hopswork
-00018a30: 732e 0a20 2020 2020 2020 2020 2020 2076  s..            v
-00018a40: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
-00018a50: 733a 2041 6464 6974 696f 6e61 6c20 7661  s: Additional va
-00018a60: 6c69 6461 7469 6f6e 206f 7074 696f 6e73  lidation options
-00018a70: 2061 7320 6b65 792d 7661 6c75 6520 7061   as key-value pa
-00018a80: 6972 732c 2064 6566 6175 6c74 7320 746f  irs, defaults to
-00018a90: 2060 7b7d 602e 0a20 2020 2020 2020 2020   `{}`..         
-00018aa0: 2020 2020 2020 202a 206b 6579 2060 7275         * key `ru
-00018ab0: 6e5f 7661 6c69 6461 7469 6f6e 6020 626f  n_validation` bo
-00018ac0: 6f6c 6561 6e20 7661 6c75 652c 2073 6574  olean value, set
-00018ad0: 2074 6f20 6046 616c 7365 6020 746f 2073   to `False` to s
-00018ae0: 6b69 7020 7661 6c69 6461 7469 6f6e 2074  kip validation t
-00018af0: 656d 706f 7261 7269 6c79 206f 6e20 696e  emporarily on in
-00018b00: 6765 7374 696f 6e2e 0a20 2020 2020 2020  gestion..       
-00018b10: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
-00018b20: 7361 7665 5f72 6570 6f72 7460 2062 6f6f  save_report` boo
-00018b30: 6c65 616e 2076 616c 7565 2c20 7365 7420  lean value, set 
-00018b40: 746f 2060 4661 6c73 6560 2074 6f20 736b  to `False` to sk
-00018b50: 6970 2075 706c 6f61 6420 6f66 2074 6865  ip upload of the
-00018b60: 2076 616c 6964 6174 696f 6e20 7265 706f   validation repo
-00018b70: 7274 2074 6f20 486f 7073 776f 726b 732e  rt to Hopsworks.
-00018b80: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018b90: 202a 206b 6579 2060 6765 5f76 616c 6964   * key `ge_valid
-00018ba0: 6174 655f 6b77 6172 6773 6020 6120 6469  ate_kwargs` a di
-00018bb0: 6374 696f 6e61 7279 2063 6f6e 7461 696e  ctionary contain
-00018bc0: 696e 6720 6b77 6172 6773 2066 6f72 2074  ing kwargs for t
-00018bd0: 6865 2076 616c 6964 6174 6520 6d65 7468  he validate meth
-00018be0: 6f64 206f 6620 4772 6561 7420 4578 7065  od of Great Expe
-00018bf0: 6374 6174 696f 6e73 2e0a 2020 2020 2020  ctations..      
-00018c00: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
-00018c10: 6066 6574 6368 5f65 7870 6563 7461 7469  `fetch_expectati
-00018c20: 6f6e 5f73 7569 7465 6020 6120 626f 6f6c  on_suite` a bool
-00018c30: 6561 6e20 7661 6c75 652c 2062 7920 6465  ean value, by de
-00018c40: 6661 756c 7420 6054 7275 6560 2c20 746f  fault `True`, to
-00018c50: 2063 6f6e 7472 6f6c 2077 6865 7468 6572   control whether
-00018c60: 2074 6865 2065 7870 6563 7461 7469 6f6e   the expectation
-00018c70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018c80: 2020 2020 7375 6974 6520 6f66 2074 6865      suite of the
-00018c90: 2066 6561 7475 7265 2067 726f 7570 2073   feature group s
-00018ca0: 686f 756c 6420 6265 2066 6574 6368 6564  hould be fetched
-00018cb0: 2062 6566 6f72 6520 6576 6572 7920 696e   before every in
-00018cc0: 7365 7274 2e0a 2020 2020 2020 2020 2020  sert..          
-00018cd0: 2020 7361 7665 5f63 6f64 653a 2057 6865    save_code: Whe
-00018ce0: 6e20 7275 6e6e 696e 6720 4853 4653 206f  n running HSFS o
-00018cf0: 6e20 486f 7073 776f 726b 7320 6f72 2044  n Hopsworks or D
-00018d00: 6174 6162 7269 636b 732c 2048 5346 5320  atabricks, HSFS 
-00018d10: 6361 6e20 7361 7665 2074 6865 2063 6f64  can save the cod
-00018d20: 652f 6e6f 7465 626f 6f6b 2075 7365 6420  e/notebook used 
-00018d30: 746f 2063 7265 6174 650a 2020 2020 2020  to create.      
-00018d40: 2020 2020 2020 2020 2020 7468 6520 6665            the fe
-00018d50: 6174 7572 6520 6772 6f75 7020 6f72 2075  ature group or u
-00018d60: 7365 6420 746f 2069 6e73 6572 7420 6461  sed to insert da
-00018d70: 7461 2074 6f20 6974 2e20 5768 656e 2063  ta to it. When c
-00018d80: 616c 6c69 6e67 2074 6865 2060 696e 7365  alling the `inse
-00018d90: 7274 6020 6d65 7468 6f64 2072 6570 6561  rt` method repea
-00018da0: 7465 646c 790a 2020 2020 2020 2020 2020  tedly.          
-00018db0: 2020 2020 2020 7769 7468 2073 6d61 6c6c        with small
-00018dc0: 2062 6174 6368 6573 206f 6620 6461 7461   batches of data
-00018dd0: 2c20 7468 6973 2063 616e 2073 6c6f 7720  , this can slow 
-00018de0: 646f 776e 2074 6865 2077 7269 7465 732e  down the writes.
-00018df0: 2055 7365 2074 6869 7320 6f70 7469 6f6e   Use this option
-00018e00: 2074 6f20 7475 726e 206f 6666 2073 6176   to turn off sav
-00018e10: 696e 670a 2020 2020 2020 2020 2020 2020  ing.            
-00018e20: 2020 2020 636f 6465 2e20 4465 6661 756c      code. Defaul
-00018e30: 7473 2074 6f20 6054 7275 6560 2e0a 2020  ts to `True`..  
-00018e40: 2020 2020 2020 2020 2020 7761 6974 3a20            wait: 
-00018e50: 5761 6974 2066 6f72 206a 6f62 2074 6f20  Wait for job to 
-00018e60: 6669 6e69 7368 2062 6566 6f72 6520 7265  finish before re
-00018e70: 7475 726e 696e 672c 2064 6566 6175 6c74  turning, default
-00018e80: 7320 746f 2060 4661 6c73 6560 2e0a 2020  s to `False`..  
-00018e90: 2020 2020 2020 2020 2020 2020 2020 5368                Sh
-00018ea0: 6f72 7463 7574 2066 6f72 2072 6561 645f  ortcut for read_
-00018eb0: 6f70 7469 6f6e 7320 607b 2277 6169 745f  options `{"wait_
-00018ec0: 666f 725f 6a6f 6222 3a20 4661 6c73 657d  for_job": False}
-00018ed0: 602e 0a0a 2020 2020 2020 2020 2320 5265  `...        # Re
-00018ee0: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
-00018ef0: 2020 2860 4a6f 6260 2c20 6056 616c 6964    (`Job`, `Valid
-00018f00: 6174 696f 6e52 6570 6f72 7460 2920 4120  ationReport`) A 
-00018f10: 7475 706c 6520 7769 7468 206a 6f62 2069  tuple with job i
-00018f20: 6e66 6f72 6d61 7469 6f6e 2069 6620 7079  nformation if py
-00018f30: 7468 6f6e 2065 6e67 696e 6520 6973 2075  thon engine is u
-00018f40: 7365 6420 616e 6420 7468 6520 7661 6c69  sed and the vali
-00018f50: 6461 7469 6f6e 2072 6570 6f72 7420 6966  dation report if
-00018f60: 2076 616c 6964 6174 696f 6e20 6973 2065   validation is e
-00018f70: 6e61 626c 6564 2e0a 0a20 2020 2020 2020  nabled...       
-00018f80: 2023 2052 6169 7365 730a 2020 2020 2020   # Raises.      
-00018f90: 2020 2020 2020 6068 7366 732e 636c 6965        `hsfs.clie
-00018fa0: 6e74 2e65 7863 6570 7469 6f6e 732e 5265  nt.exceptions.Re
-00018fb0: 7374 4150 4945 7272 6f72 602e 2065 2e67  stAPIError`. e.g
-00018fc0: 2066 6169 6c20 746f 2063 7265 6174 6520   fail to create 
-00018fd0: 6665 6174 7572 6520 6772 6f75 702c 2064  feature group, d
-00018fe0: 6174 6166 7261 6d65 2073 6368 656d 6120  ataframe schema 
-00018ff0: 646f 6573 206e 6f74 206d 6174 6368 0a20  does not match. 
-00019000: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00019010: 7869 7374 696e 6720 6665 6174 7572 6520  xisting feature 
-00019020: 6772 6f75 7020 7363 6865 6d61 2c20 6574  group schema, et
-00019030: 632e 0a20 2020 2020 2020 2020 2020 2060  c..            `
-00019040: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
-00019050: 7074 696f 6e73 2e44 6174 6156 616c 6964  ptions.DataValid
-00019060: 6174 696f 6e45 7863 6570 7469 6f6e 602e  ationException`.
-00019070: 2049 6620 6461 7461 2076 616c 6964 6174   If data validat
-00019080: 696f 6e20 6661 696c 7320 616e 6420 7468  ion fails and th
-00019090: 6520 6578 7065 6374 6174 696f 6e0a 2020  e expectation.  
-000190a0: 2020 2020 2020 2020 2020 2020 2020 7375                su
-000190b0: 6974 6520 6076 616c 6964 6174 696f 6e5f  ite `validation_
-000190c0: 696e 6765 7374 696f 6e5f 706f 6c69 6379  ingestion_policy
-000190d0: 6020 6973 2073 6574 2074 6f20 6053 5452  ` is set to `STR
-000190e0: 4943 5460 2e20 4461 7461 2069 7320 4e4f  ICT`. Data is NO
-000190f0: 5420 696e 6765 7374 6564 2e0a 2020 2020  T ingested..    
-00019100: 2020 2020 2222 220a 2020 2020 2020 2020      """.        
-00019110: 6966 2073 746f 7261 6765 2061 6e64 2073  if storage and s
-00019120: 656c 662e 7374 7265 616d 3a0a 2020 2020  elf.stream:.    
-00019130: 2020 2020 2020 2020 7761 726e 696e 6773          warnings
-00019140: 2e77 6172 6e28 0a20 2020 2020 2020 2020  .warn(.         
-00019150: 2020 2020 2020 2022 5370 6563 6966 7969         "Specifyi
-00019160: 6e67 2074 6865 2073 746f 7261 6765 206f  ng the storage o
-00019170: 7074 696f 6e20 6973 206e 6f74 2073 7570  ption is not sup
-00019180: 706f 7274 6564 2069 6620 7468 6520 7374  ported if the st
-00019190: 7265 616d 696e 6720 4150 4973 2061 7265  reaming APIs are
-000191a0: 2065 6e61 626c 6564 220a 2020 2020 2020   enabled".      
-000191b0: 2020 2020 2020 290a 0a20 2020 2020 2020        )..       
-000191c0: 2066 6561 7475 7265 5f64 6174 6166 7261   feature_datafra
-000191d0: 6d65 203d 2065 6e67 696e 652e 6765 745f  me = engine.get_
-000191e0: 696e 7374 616e 6365 2829 2e63 6f6e 7665  instance().conve
-000191f0: 7274 5f74 6f5f 6465 6661 756c 745f 6461  rt_to_default_da
-00019200: 7461 6672 616d 6528 6665 6174 7572 6573  taframe(features
-00019210: 290a 0a20 2020 2020 2020 2069 6620 7772  )..        if wr
-00019220: 6974 655f 6f70 7469 6f6e 7320 6973 204e  ite_options is N
-00019230: 6f6e 653a 0a20 2020 2020 2020 2020 2020  one:.           
-00019240: 2077 7269 7465 5f6f 7074 696f 6e73 203d   write_options =
-00019250: 207b 7d0a 2020 2020 2020 2020 6966 2022   {}.        if "
-00019260: 7761 6974 5f66 6f72 5f6a 6f62 2220 6e6f  wait_for_job" no
-00019270: 7420 696e 2077 7269 7465 5f6f 7074 696f  t in write_optio
-00019280: 6e73 3a0a 2020 2020 2020 2020 2020 2020  ns:.            
-00019290: 7772 6974 655f 6f70 7469 6f6e 735b 2277  write_options["w
-000192a0: 6169 745f 666f 725f 6a6f 6222 5d20 3d20  ait_for_job"] = 
-000192b0: 7761 6974 0a0a 2020 2020 2020 2020 6a6f  wait..        jo
-000192c0: 622c 2067 655f 7265 706f 7274 203d 2073  b, ge_report = s
-000192d0: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
-000192e0: 7570 5f65 6e67 696e 652e 696e 7365 7274  up_engine.insert
-000192f0: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-00019300: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-00019310: 6665 6174 7572 655f 6461 7461 6672 616d  feature_datafram
-00019320: 653d 6665 6174 7572 655f 6461 7461 6672  e=feature_datafr
-00019330: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00019340: 206f 7665 7277 7269 7465 3d6f 7665 7277   overwrite=overw
-00019350: 7269 7465 2c0a 2020 2020 2020 2020 2020  rite,.          
-00019360: 2020 6f70 6572 6174 696f 6e3d 6f70 6572    operation=oper
-00019370: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-00019380: 2020 2073 746f 7261 6765 3d73 746f 7261     storage=stora
-00019390: 6765 2e6c 6f77 6572 2829 2069 6620 7374  ge.lower() if st
-000193a0: 6f72 6167 6520 6973 206e 6f74 204e 6f6e  orage is not Non
-000193b0: 6520 656c 7365 204e 6f6e 652c 0a20 2020  e else None,.   
-000193c0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
-000193d0: 7074 696f 6e73 3d77 7269 7465 5f6f 7074  ptions=write_opt
-000193e0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-000193f0: 2020 7661 6c69 6461 7469 6f6e 5f6f 7074    validation_opt
-00019400: 696f 6e73 3d7b 2273 6176 655f 7265 706f  ions={"save_repo
-00019410: 7274 223a 2054 7275 652c 202a 2a76 616c  rt": True, **val
-00019420: 6964 6174 696f 6e5f 6f70 7469 6f6e 737d  idation_options}
-00019430: 2c0a 2020 2020 2020 2020 290a 2020 2020  ,.        ).    
-00019440: 2020 2020 6966 2073 6176 655f 636f 6465      if save_code
-00019450: 2061 6e64 2028 0a20 2020 2020 2020 2020   and (.         
-00019460: 2020 2067 655f 7265 706f 7274 2069 7320     ge_report is 
-00019470: 4e6f 6e65 206f 7220 6765 5f72 6570 6f72  None or ge_repor
-00019480: 742e 696e 6765 7374 696f 6e5f 7265 7375  t.ingestion_resu
-00019490: 6c74 203d 3d20 2249 4e47 4553 5445 4422  lt == "INGESTED"
-000194a0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-000194b0: 2020 2020 2020 2020 7365 6c66 2e5f 636f          self._co
-000194c0: 6465 5f65 6e67 696e 652e 7361 7665 5f63  de_engine.save_c
-000194d0: 6f64 6528 7365 6c66 290a 0a20 2020 2020  ode(self)..     
-000194e0: 2020 2069 6620 656e 6769 6e65 2e67 6574     if engine.get
-000194f0: 5f74 7970 6528 292e 7374 6172 7473 7769  _type().startswi
-00019500: 7468 2822 7370 6172 6b22 2920 616e 6420  th("spark") and 
-00019510: 6e6f 7420 7365 6c66 2e73 7472 6561 6d3a  not self.stream:
-00019520: 0a20 2020 2020 2020 2020 2020 2023 2041  .            # A
-00019530: 6c73 6f2c 206f 6e6c 7920 636f 6d70 7574  lso, only comput
-00019540: 6520 7374 6174 6973 7469 6373 2069 6620  e statistics if 
-00019550: 7374 7265 616d 2069 7320 4661 6c73 652e  stream is False.
-00019560: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-00019570: 6620 5472 7565 2c20 7468 6520 6261 636b  f True, the back
-00019580: 6669 6c6c 206a 6f62 2068 6173 206e 6f74  fill job has not
-00019590: 2062 6565 6e20 7472 6967 6765 7265 6420   been triggered 
-000195a0: 616e 6420 7468 6520 6461 7461 2068 6173  and the data has
-000195b0: 206e 6f74 2062 6565 6e20 696e 7365 7274   not been insert
-000195c0: 6564 2028 6974 2773 2069 6e20 4b61 666b  ed (it's in Kafk
-000195d0: 6129 0a20 2020 2020 2020 2020 2020 2073  a).            s
-000195e0: 656c 662e 636f 6d70 7574 655f 7374 6174  elf.compute_stat
-000195f0: 6973 7469 6373 2829 0a0a 2020 2020 2020  istics()..      
-00019600: 2020 7265 7475 726e 2028 0a20 2020 2020    return (.     
-00019610: 2020 2020 2020 206a 6f62 2c0a 2020 2020         job,.    
-00019620: 2020 2020 2020 2020 6765 5f72 6570 6f72          ge_repor
-00019630: 742e 746f 5f67 655f 7479 7065 2829 2069  t.to_ge_type() i
-00019640: 6620 6765 5f72 6570 6f72 7420 6973 206e  f ge_report is n
-00019650: 6f74 204e 6f6e 6520 656c 7365 204e 6f6e  ot None else Non
-00019660: 652c 0a20 2020 2020 2020 2029 0a0a 2020  e,.        )..  
-00019670: 2020 6465 6620 6d75 6c74 695f 7061 7274    def multi_part
-00019680: 5f69 6e73 6572 7428 0a20 2020 2020 2020  _insert(.       
-00019690: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-000196a0: 6561 7475 7265 733a 2055 6e69 6f6e 5b0a  eatures: Union[.
-000196b0: 2020 2020 2020 2020 2020 2020 7064 2e44              pd.D
-000196c0: 6174 6146 7261 6d65 2c0a 2020 2020 2020  ataFrame,.      
-000196d0: 2020 2020 2020 5479 7065 5661 7228 2270        TypeVar("p
-000196e0: 7973 7061 726b 2e73 716c 2e44 6174 6146  yspark.sql.DataF
-000196f0: 7261 6d65 2229 2c20 2023 206e 6f71 613a  rame"),  # noqa:
-00019700: 2046 3832 310a 2020 2020 2020 2020 2020   F821.          
-00019710: 2020 5479 7065 5661 7228 2270 7973 7061    TypeVar("pyspa
-00019720: 726b 2e52 4444 2229 2c20 2023 206e 6f71  rk.RDD"),  # noq
-00019730: 613a 2046 3832 310a 2020 2020 2020 2020  a: F821.        
-00019740: 2020 2020 6e70 2e6e 6461 7272 6179 2c0a      np.ndarray,.
-00019750: 2020 2020 2020 2020 2020 2020 4c69 7374              List
-00019760: 5b6c 6973 745d 2c0a 2020 2020 2020 2020  [list],.        
-00019770: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-00019780: 2020 6f76 6572 7772 6974 653a 204f 7074    overwrite: Opt
-00019790: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
-000197a0: 6c73 652c 0a20 2020 2020 2020 206f 7065  lse,.        ope
-000197b0: 7261 7469 6f6e 3a20 4f70 7469 6f6e 616c  ration: Optional
-000197c0: 5b73 7472 5d20 3d20 2275 7073 6572 7422  [str] = "upsert"
-000197d0: 2c0a 2020 2020 2020 2020 7374 6f72 6167  ,.        storag
-000197e0: 653a 204f 7074 696f 6e61 6c5b 7374 725d  e: Optional[str]
-000197f0: 203d 204e 6f6e 652c 0a20 2020 2020 2020   = None,.       
-00019800: 2077 7269 7465 5f6f 7074 696f 6e73 3a20   write_options: 
-00019810: 4f70 7469 6f6e 616c 5b44 6963 745b 7374  Optional[Dict[st
-00019820: 722c 2041 6e79 5d5d 203d 207b 7d2c 0a20  r, Any]] = {},. 
-00019830: 2020 2020 2020 2076 616c 6964 6174 696f         validatio
-00019840: 6e5f 6f70 7469 6f6e 733a 204f 7074 696f  n_options: Optio
-00019850: 6e61 6c5b 4469 6374 5b73 7472 2c20 416e  nal[Dict[str, An
-00019860: 795d 5d20 3d20 7b7d 2c0a 2020 2020 2920  y]] = {},.    ) 
-00019870: 2d3e 2055 6e69 6f6e 5b0a 2020 2020 2020  -> Union[.      
-00019880: 2020 5475 706c 655b 4f70 7469 6f6e 616c    Tuple[Optional
-00019890: 5b4a 6f62 5d2c 204f 7074 696f 6e61 6c5b  [Job], Optional[
-000198a0: 5661 6c69 6461 7469 6f6e 5265 706f 7274  ValidationReport
-000198b0: 5d5d 2c0a 2020 2020 2020 2020 6665 6174  ]],.        feat
-000198c0: 7572 655f 6772 6f75 705f 7772 6974 6572  ure_group_writer
-000198d0: 2e46 6561 7475 7265 4772 6f75 7057 7269  .FeatureGroupWri
-000198e0: 7465 722c 0a20 2020 205d 3a0a 2020 2020  ter,.    ]:.    
-000198f0: 2020 2020 2222 2247 6574 2046 6561 7475      """Get Featu
-00019900: 7265 4772 6f75 7057 7269 7465 7220 666f  reGroupWriter fo
-00019910: 7220 6f70 7469 6d69 7a65 6420 6d75 6c74  r optimized mult
-00019920: 6920 7061 7274 2069 6e73 6572 7473 206f  i part inserts o
-00019930: 7220 6361 6c6c 2074 6869 7320 6d65 7468  r call this meth
-00019940: 6f64 0a20 2020 2020 2020 2074 6f20 7374  od.        to st
-00019950: 6172 7420 6d61 6e75 616c 206d 756c 7469  art manual multi
-00019960: 2070 6172 7420 6f70 7469 6d69 7a65 6420   part optimized 
-00019970: 696e 7365 7274 732e 0a0a 2020 2020 2020  inserts...      
-00019980: 2020 496e 2075 7365 2063 6173 6573 2077    In use cases w
-00019990: 6865 7265 2076 6572 7920 736d 616c 6c20  here very small 
-000199a0: 6261 7463 6865 7320 2831 2074 6f20 3130  batches (1 to 10
-000199b0: 3030 2920 726f 7773 2070 6572 2044 6174  00) rows per Dat
-000199c0: 6166 7261 6d65 206e 6565 640a 2020 2020  aframe need.    
-000199d0: 2020 2020 746f 2062 6520 7772 6974 7465      to be writte
-000199e0: 6e20 746f 2074 6865 2066 6561 7475 7265  n to the feature
-000199f0: 2073 746f 7265 2072 6570 6561 7465 646c   store repeatedl
-00019a00: 792c 2069 7420 6d69 6768 7420 6265 2069  y, it might be i
-00019a10: 6e65 6666 6963 6965 6e74 2074 6f20 7573  nefficient to us
-00019a20: 650a 2020 2020 2020 2020 7468 6520 7374  e.        the st
-00019a30: 616e 6461 7264 2060 6665 6174 7572 655f  andard `feature_
-00019a40: 6772 6f75 702e 696e 7365 7274 2829 6020  group.insert()` 
-00019a50: 6d65 7468 6f64 2061 7320 6974 2070 6572  method as it per
-00019a60: 666f 726d 7320 736f 6d65 2062 6163 6b67  forms some backg
-00019a70: 726f 756e 640a 2020 2020 2020 2020 6163  round.        ac
-00019a80: 7469 6f6e 7320 746f 2075 7064 6174 6520  tions to update 
-00019a90: 7468 6520 6d65 7461 6461 7461 206f 6620  the metadata of 
-00019aa0: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-00019ab0: 7020 6f62 6a65 6374 2066 6972 7374 2e0a  p object first..
-00019ac0: 0a20 2020 2020 2020 2046 6f72 2074 6865  .        For the
-00019ad0: 7365 2063 6173 6573 2c20 7468 6520 6665  se cases, the fe
-00019ae0: 6174 7572 6520 6772 6f75 7020 7072 6f76  ature group prov
-00019af0: 6964 6573 2074 6865 2060 6d75 6c74 695f  ides the `multi_
-00019b00: 7061 7274 5f69 6e73 6572 7460 2041 5049  part_insert` API
-00019b10: 2c0a 2020 2020 2020 2020 7768 6963 6820  ,.        which 
-00019b20: 6973 206f 7074 696d 697a 6564 2066 6f72  is optimized for
-00019b30: 2077 7269 7469 6e67 206d 616e 7920 736d   writing many sm
-00019b40: 616c 6c20 4461 7461 6672 616d 6573 2061  all Dataframes a
-00019b50: 6674 6572 2061 6e6f 7468 6572 2e0a 0a20  fter another... 
-00019b60: 2020 2020 2020 2054 6865 7265 2061 7265         There are
-00019b70: 2074 776f 2077 6179 7320 746f 2075 7365   two ways to use
-00019b80: 2074 6869 7320 4150 493a 0a20 2020 2020   this API:.     
-00019b90: 2020 2021 2121 2065 7861 6d70 6c65 2022     !!! example "
-00019ba0: 5079 7468 6f6e 2043 6f6e 7465 7874 204d  Python Context M
-00019bb0: 616e 6167 6572 220a 2020 2020 2020 2020  anager".        
-00019bc0: 2020 2020 5573 696e 6720 7468 6520 5079      Using the Py
-00019bd0: 7468 6f6e 2060 7769 7468 6020 7379 6e74  thon `with` synt
-00019be0: 6178 2079 6f75 2063 616e 2061 6371 7569  ax you can acqui
-00019bf0: 7265 2061 2046 6561 7475 7265 4772 6f75  re a FeatureGrou
-00019c00: 7057 7269 7465 720a 2020 2020 2020 2020  pWriter.        
-00019c10: 2020 2020 6f62 6a65 6374 2074 6861 7420      object that 
-00019c20: 696d 706c 656d 656e 7473 2074 6865 2073  implements the s
-00019c30: 616d 6520 606d 756c 7469 5f70 6172 745f  ame `multi_part_
-00019c40: 696e 7365 7274 6020 4150 492e 0a20 2020  insert` API..   
-00019c50: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-00019c60: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
-00019c70: 6561 7475 7265 5f67 726f 7570 203d 2066  eature_group = f
-00019c80: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
-00019c90: 6665 6174 7572 655f 6772 6f75 7028 2266  feature_group("f
-00019ca0: 675f 6e61 6d65 222c 2076 6572 7369 6f6e  g_name", version
-00019cb0: 3d31 290a 0a20 2020 2020 2020 2020 2020  =1)..           
-00019cc0: 2077 6974 6820 6665 6174 7572 655f 6772   with feature_gr
-00019cd0: 6f75 702e 6d75 6c74 695f 7061 7274 5f69  oup.multi_part_i
-00019ce0: 6e73 6572 7428 2920 6173 2077 7269 7465  nsert() as write
-00019cf0: 723a 0a20 2020 2020 2020 2020 2020 2020  r:.             
-00019d00: 2020 2023 2072 756e 2069 6e73 6572 7473     # run inserts
-00019d10: 2069 6e20 6120 6c6f 6f70 3a0a 2020 2020   in a loop:.    
-00019d20: 2020 2020 2020 2020 2020 2020 7768 696c              whil
-00019d30: 6520 6c6f 6f70 3a0a 2020 2020 2020 2020  e loop:.        
-00019d40: 2020 2020 2020 2020 2020 2020 736d 616c              smal
-00019d50: 6c5f 6261 7463 685f 6466 203d 202e 2e2e  l_batch_df = ...
-00019d60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00019d70: 2020 2020 2077 7269 7465 722e 696e 7365       writer.inse
-00019d80: 7274 2873 6d61 6c6c 5f62 6174 6368 5f64  rt(small_batch_d
-00019d90: 6629 0a20 2020 2020 2020 2020 2020 2060  f).            `
-00019da0: 6060 0a20 2020 2020 2020 2020 2020 2054  ``.            T
-00019db0: 6865 2077 7269 7465 7220 6261 7463 6865  he writer batche
-00019dc0: 7320 7468 6520 736d 616c 6c20 4461 7461  s the small Data
-00019dd0: 6672 616d 6573 2061 6e64 2074 7261 6e73  frames and trans
-00019de0: 6d69 7473 2074 6865 6d20 746f 2048 6f70  mits them to Hop
-00019df0: 7377 6f72 6b73 0a20 2020 2020 2020 2020  sworks.         
-00019e00: 2020 2065 6666 6963 6965 6e74 6c79 2e0a     efficiently..
-00019e10: 2020 2020 2020 2020 2020 2020 5768 656e              When
-00019e20: 2065 7869 7469 6e67 2074 6865 2063 6f6e   exiting the con
-00019e30: 7465 7874 2c20 7468 6520 6665 6174 7572  text, the featur
-00019e40: 6520 6772 6f75 7020 7772 6974 6572 2069  e group writer i
-00019e50: 7320 7375 7265 2074 6f20 6578 6974 0a20  s sure to exit. 
-00019e60: 2020 2020 2020 2020 2020 206f 6e6c 7920             only 
-00019e70: 6f6e 6365 2061 6c6c 2074 6865 2072 6f77  once all the row
-00019e80: 7320 6861 7665 2062 6565 6e20 7472 616e  s have been tran
-00019e90: 736d 6974 7465 642e 0a0a 2020 2020 2020  smitted...      
-00019ea0: 2020 2121 2120 6578 616d 706c 6520 224d    !!! example "M
-00019eb0: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
-00019ec0: 2077 6974 6820 6d61 6e75 616c 2063 6f6e   with manual con
-00019ed0: 7465 7874 206d 616e 6167 656d 656e 7422  text management"
-00019ee0: 0a20 2020 2020 2020 2020 2020 2049 6e73  .            Ins
-00019ef0: 7465 6164 206f 6620 6c65 7474 696e 6720  tead of letting 
-00019f00: 5079 7468 6f6e 2068 616e 646c 6520 7468  Python handle th
-00019f10: 6520 656e 7465 7269 6e67 2061 6e64 2065  e entering and e
-00019f20: 7869 7469 6e67 206f 6620 7468 650a 2020  xiting of the.  
-00019f30: 2020 2020 2020 2020 2020 6d75 6c74 6920            multi 
-00019f40: 7061 7274 2069 6e73 6572 7420 636f 6e74  part insert cont
-00019f50: 6578 742c 2079 6f75 2063 616e 2073 7461  ext, you can sta
-00019f60: 7274 2061 6e64 2066 696e 616c 697a 6520  rt and finalize 
-00019f70: 7468 6520 636f 6e74 6578 740a 2020 2020  the context.    
-00019f80: 2020 2020 2020 2020 6d61 6e75 616c 6c79          manually
-00019f90: 2e0a 2020 2020 2020 2020 2020 2020 6060  ..            ``
-00019fa0: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-00019fb0: 2020 2020 6665 6174 7572 655f 6772 6f75      feature_grou
-00019fc0: 7020 3d20 6673 2e67 6574 5f6f 725f 6372  p = fs.get_or_cr
-00019fd0: 6561 7465 5f66 6561 7475 7265 5f67 726f  eate_feature_gro
-00019fe0: 7570 2822 6667 5f6e 616d 6522 2c20 7665  up("fg_name", ve
-00019ff0: 7273 696f 6e3d 3129 0a0a 2020 2020 2020  rsion=1)..      
-0001a000: 2020 2020 2020 7768 696c 6520 6c6f 6f70        while loop
-0001a010: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-0001a020: 2020 736d 616c 6c5f 6261 7463 685f 6466    small_batch_df
-0001a030: 203d 202e 2e2e 0a20 2020 2020 2020 2020   = ....         
-0001a040: 2020 2020 2020 2066 6561 7475 7265 5f67         feature_g
-0001a050: 726f 7570 2e6d 756c 7469 5f70 6172 745f  roup.multi_part_
-0001a060: 696e 7365 7274 2873 6d61 6c6c 5f62 6174  insert(small_bat
-0001a070: 6368 5f64 6629 0a0a 2020 2020 2020 2020  ch_df)..        
-0001a080: 2020 2020 2320 494d 504f 5254 414e 543a      # IMPORTANT:
-0001a090: 2066 696e 616c 697a 6520 7468 6520 6d75   finalize the mu
-0001a0a0: 6c74 6920 7061 7274 2069 6e73 6572 7420  lti part insert 
-0001a0b0: 746f 206d 616b 6520 7375 7265 2061 6c6c  to make sure all
-0001a0c0: 2072 6f77 730a 2020 2020 2020 2020 2020   rows.          
-0001a0d0: 2020 2320 6861 7665 2062 6565 6e20 7472    # have been tr
-0001a0e0: 616e 736d 6974 7465 640a 2020 2020 2020  ansmitted.      
-0001a0f0: 2020 2020 2020 6665 6174 7572 655f 6772        feature_gr
-0001a100: 6f75 702e 6669 6e61 6c69 7a65 5f6d 756c  oup.finalize_mul
-0001a110: 7469 5f70 6172 745f 696e 7365 7274 2829  ti_part_insert()
-0001a120: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-0001a130: 0a20 2020 2020 2020 2020 2020 204e 6f74  .            Not
-0001a140: 6520 7468 6174 2074 6865 2066 6972 7374  e that the first
-0001a150: 2063 616c 6c20 746f 2060 6d75 6c74 695f   call to `multi_
-0001a160: 7061 7274 5f69 6e73 6572 7460 2069 6e69  part_insert` ini
-0001a170: 7469 6174 6573 2074 6865 2063 6f6e 7465  tiates the conte
-0001a180: 7874 0a20 2020 2020 2020 2020 2020 2061  xt.            a
-0001a190: 6e64 2062 6520 7375 7265 2074 6f20 6669  nd be sure to fi
-0001a1a0: 6e61 6c69 7a65 2069 742e 2054 6865 2060  nalize it. The `
-0001a1b0: 6669 6e61 6c69 7a65 5f6d 756c 7469 5f70  finalize_multi_p
-0001a1c0: 6172 745f 696e 7365 7274 6020 6973 2061  art_insert` is a
-0001a1d0: 0a20 2020 2020 2020 2020 2020 2062 6c6f  .            blo
-0001a1e0: 636b 696e 6720 6361 6c6c 2074 6861 7420  cking call that 
-0001a1f0: 7265 7475 726e 7320 6f6e 6365 2061 6c6c  returns once all
-0001a200: 2072 6f77 7320 6861 7665 2062 6565 6e20   rows have been 
-0001a210: 7472 616e 736d 6974 7465 642e 0a0a 2020  transmitted...  
-0001a220: 2020 2020 2020 2020 2020 4f6e 6365 2079            Once y
-0001a230: 6f75 2061 7265 2064 6f6e 6520 7769 7468  ou are done with
-0001a240: 2074 6865 206d 756c 7469 2070 6172 7420   the multi part 
-0001a250: 696e 7365 7274 2c20 6974 2069 7320 676f  insert, it is go
-0001a260: 6f64 2070 7261 6374 6963 6520 746f 0a20  od practice to. 
-0001a270: 2020 2020 2020 2020 2020 2073 7461 7274             start
-0001a280: 2074 6865 206d 6174 6572 6961 6c69 7a61   the materializa
-0001a290: 7469 6f6e 206a 6f62 2069 6e20 6f72 6465  tion job in orde
-0001a2a0: 7220 746f 2077 7269 7465 2074 6865 2064  r to write the d
-0001a2b0: 6174 6120 746f 2074 6865 206f 6666 6c69  ata to the offli
-0001a2c0: 6e65 0a20 2020 2020 2020 2020 2020 2073  ne.            s
-0001a2d0: 746f 7261 6765 3a0a 2020 2020 2020 2020  torage:.        
-0001a2e0: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-0001a2f0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-0001a300: 655f 6772 6f75 702e 6d61 7465 7269 616c  e_group.material
-0001a310: 697a 6174 696f 6e5f 6a6f 622e 7275 6e28  ization_job.run(
-0001a320: 6177 6169 745f 7465 726d 696e 6174 696f  await_terminatio
-0001a330: 6e3d 5472 7565 290a 2020 2020 2020 2020  n=True).        
-0001a340: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-0001a350: 2023 2041 7267 756d 656e 7473 0a20 2020   # Arguments.   
-0001a360: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0001a370: 733a 2044 6174 6146 7261 6d65 2c20 5244  s: DataFrame, RD
-0001a380: 442c 204e 6461 7272 6179 2c20 6c69 7374  D, Ndarray, list
-0001a390: 2e20 4665 6174 7572 6573 2074 6f20 6265  . Features to be
-0001a3a0: 2073 6176 6564 2e0a 2020 2020 2020 2020   saved..        
-0001a3b0: 2020 2020 6f76 6572 7772 6974 653a 2044      overwrite: D
-0001a3c0: 726f 7020 616c 6c20 6461 7461 2069 6e20  rop all data in 
-0001a3d0: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-0001a3e0: 7020 6265 666f 7265 0a20 2020 2020 2020  p before.       
-0001a3f0: 2020 2020 2020 2020 2069 6e73 6572 7469           inserti
-0001a400: 6e67 206e 6577 2064 6174 612e 2054 6869  ng new data. Thi
-0001a410: 7320 646f 6573 206e 6f74 2061 6666 6563  s does not affec
-0001a420: 7420 6d65 7461 6461 7461 2c20 6465 6661  t metadata, defa
-0001a430: 756c 7473 2074 6f20 4661 6c73 652e 0a20  ults to False.. 
-0001a440: 2020 2020 2020 2020 2020 206f 7065 7261             opera
-0001a450: 7469 6f6e 3a20 4170 6163 6865 2048 7564  tion: Apache Hud
-0001a460: 6920 6f70 6572 6174 696f 6e20 7479 7065  i operation type
-0001a470: 2060 2269 6e73 6572 7422 6020 6f72 2060   `"insert"` or `
-0001a480: 2275 7073 6572 7422 602e 0a20 2020 2020  "upsert"`..     
-0001a490: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-0001a4a0: 6c74 7320 746f 2060 2275 7073 6572 7422  lts to `"upsert"
-0001a4b0: 602e 0a20 2020 2020 2020 2020 2020 2073  `..            s
-0001a4c0: 746f 7261 6765 3a20 4f76 6572 7772 6974  torage: Overwrit
-0001a4d0: 6520 6465 6661 756c 7420 6265 6861 7669  e default behavi
-0001a4e0: 6f75 722c 2077 7269 7465 2074 6f20 6f66  our, write to of
-0001a4f0: 666c 696e 650a 2020 2020 2020 2020 2020  fline.          
-0001a500: 2020 2020 2020 7374 6f72 6167 6520 6f6e        storage on
-0001a510: 6c79 2077 6974 6820 6022 6f66 666c 696e  ly with `"offlin
-0001a520: 6522 6020 6f72 206f 6e6c 696e 6520 6f6e  e"` or online on
-0001a530: 6c79 2077 6974 6820 6022 6f6e 6c69 6e65  ly with `"online
-0001a540: 2260 2c20 6465 6661 756c 7473 0a20 2020  "`, defaults.   
-0001a550: 2020 2020 2020 2020 2020 2020 2074 6f20               to 
-0001a560: 604e 6f6e 6560 2e0a 2020 2020 2020 2020  `None`..        
-0001a570: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
-0001a580: 733a 2041 6464 6974 696f 6e61 6c20 7772  s: Additional wr
-0001a590: 6974 6520 6f70 7469 6f6e 7320 6173 206b  ite options as k
-0001a5a0: 6579 2d76 616c 7565 2070 6169 7273 2c20  ey-value pairs, 
-0001a5b0: 6465 6661 756c 7473 2074 6f20 607b 7d60  defaults to `{}`
-0001a5c0: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a5d0: 2020 5768 656e 2075 7369 6e67 2074 6865    When using the
-0001a5e0: 2060 7079 7468 6f6e 6020 656e 6769 6e65   `python` engine
-0001a5f0: 2c20 7772 6974 655f 6f70 7469 6f6e 7320  , write_options 
-0001a600: 6361 6e20 636f 6e74 6169 6e20 7468 650a  can contain the.
-0001a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a620: 666f 6c6c 6f77 696e 6720 656e 7472 6965  following entrie
-0001a630: 733a 0a20 2020 2020 2020 2020 2020 2020  s:.             
-0001a640: 2020 202a 206b 6579 2060 7370 6172 6b60     * key `spark`
-0001a650: 2061 6e64 2076 616c 7565 2061 6e20 6f62   and value an ob
-0001a660: 6a65 6374 206f 6620 7479 7065 0a20 2020  ject of type.   
-0001a670: 2020 2020 2020 2020 2020 2020 205b 6873               [hs
-0001a680: 6673 2e63 6f72 652e 6a6f 625f 636f 6e66  fs.core.job_conf
-0001a690: 6967 7572 6174 696f 6e2e 4a6f 6243 6f6e  iguration.JobCon
-0001a6a0: 6669 6775 7261 7469 6f6e 5d28 2e2e 2f6a  figuration](../j
-0001a6b0: 6f62 5f63 6f6e 6669 6775 7261 7469 6f6e  ob_configuration
-0001a6c0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
-0001a6d0: 2020 2020 746f 2063 6f6e 6669 6775 7265      to configure
-0001a6e0: 2074 6865 2048 6f70 7377 6f72 6b73 204a   the Hopsworks J
-0001a6f0: 6f62 2075 7365 6420 746f 2077 7269 7465  ob used to write
-0001a700: 2064 6174 6120 696e 746f 2074 6865 0a20   data into the. 
-0001a710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a720: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
-0001a730: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a740: 2a20 6b65 7920 6077 6169 745f 666f 725f  * key `wait_for_
-0001a750: 6a6f 6260 2061 6e64 2076 616c 7565 2060  job` and value `
-0001a760: 5472 7565 6020 6f72 2060 4661 6c73 6560  True` or `False`
-0001a770: 2074 6f20 636f 6e66 6967 7572 650a 2020   to configure.  
-0001a780: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001a790: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
-0001a7a0: 6f20 7468 6520 696e 7365 7274 2063 616c  o the insert cal
-0001a7b0: 6c20 7368 6f75 6c64 2072 6574 7572 6e20  l should return 
-0001a7c0: 6f6e 6c79 0a20 2020 2020 2020 2020 2020  only.           
-0001a7d0: 2020 2020 2020 2061 6674 6572 2074 6865         after the
-0001a7e0: 2048 6f70 7377 6f72 6b73 204a 6f62 2068   Hopsworks Job h
-0001a7f0: 6173 2066 696e 6973 6865 642e 2042 7920  as finished. By 
-0001a800: 6465 6661 756c 7420 6974 2077 6169 7473  default it waits
-0001a810: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a820: 2020 2a20 6b65 7920 6073 7461 7274 5f6f    * key `start_o
-0001a830: 6666 6c69 6e65 5f62 6163 6b66 696c 6c60  ffline_backfill`
-0001a840: 2061 6e64 2076 616c 7565 2060 5472 7565   and value `True
-0001a850: 6020 6f72 2060 4661 6c73 6560 2074 6f20  ` or `False` to 
-0001a860: 636f 6e66 6967 7572 650a 2020 2020 2020  configure.      
-0001a870: 2020 2020 2020 2020 2020 2020 7768 6574              whet
-0001a880: 6865 7220 6f72 206e 6f74 2074 6f20 7374  her or not to st
-0001a890: 6172 7420 7468 6520 6d61 7465 7269 616c  art the material
-0001a8a0: 697a 6174 696f 6e20 6a6f 6220 746f 2077  ization job to w
-0001a8b0: 7269 7465 2064 6174 6120 746f 2074 6865  rite data to the
-0001a8c0: 206f 6666 6c69 6e65 0a20 2020 2020 2020   offline.       
-0001a8d0: 2020 2020 2020 2020 2020 2073 746f 7261             stora
-0001a8e0: 6765 2e20 6073 7461 7274 5f6f 6666 6c69  ge. `start_offli
-0001a8f0: 6e65 5f62 6163 6b66 696c 6c60 2069 7320  ne_backfill` is 
-0001a900: 6465 7072 6563 6174 6564 2e20 5573 6520  deprecated. Use 
-0001a910: 6073 7461 7274 5f6f 6666 6c69 6e65 5f6d  `start_offline_m
-0001a920: 6174 6572 6961 6c69 7a61 7469 6f6e 6020  aterialization` 
-0001a930: 696e 7374 6561 642e 0a20 2020 2020 2020  instead..       
-0001a940: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
-0001a950: 7374 6172 745f 6f66 666c 696e 655f 6d61  start_offline_ma
-0001a960: 7465 7269 616c 697a 6174 696f 6e60 2061  terialization` a
-0001a970: 6e64 2076 616c 7565 2060 5472 7565 6020  nd value `True` 
-0001a980: 6f72 2060 4661 6c73 6560 2074 6f20 636f  or `False` to co
-0001a990: 6e66 6967 7572 650a 2020 2020 2020 2020  nfigure.        
-0001a9a0: 2020 2020 2020 2020 2020 7768 6574 6865            whethe
-0001a9b0: 7220 6f72 206e 6f74 2074 6f20 7374 6172  r or not to star
-0001a9c0: 7420 7468 6520 6d61 7465 7269 616c 697a  t the materializ
-0001a9d0: 6174 696f 6e20 6a6f 6220 746f 2077 7269  ation job to wri
-0001a9e0: 7465 2064 6174 6120 746f 2074 6865 206f  te data to the o
-0001a9f0: 6666 6c69 6e65 0a20 2020 2020 2020 2020  ffline.         
-0001aa00: 2020 2020 2020 2020 2073 746f 7261 6765           storage
-0001aa10: 2e20 4279 2064 6566 6175 6c74 2074 6865  . By default the
-0001aa20: 206d 6174 6572 6961 6c69 7a61 7469 6f6e   materialization
-0001aa30: 206a 6f62 2064 6f65 7320 6e6f 7420 6765   job does not ge
-0001aa40: 7420 7374 6172 7465 6420 6175 746f 6d61  t started automa
-0001aa50: 7469 6361 6c6c 790a 2020 2020 2020 2020  tically.        
-0001aa60: 2020 2020 2020 2020 2020 666f 7220 6d75            for mu
-0001aa70: 6c74 6920 7061 7274 2069 6e73 6572 7473  lti part inserts
-0001aa80: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001aa90: 2020 2a20 6b65 7920 606b 6166 6b61 5f70    * key `kafka_p
-0001aaa0: 726f 6475 6365 725f 636f 6e66 6967 6020  roducer_config` 
-0001aab0: 616e 6420 7661 6c75 6520 616e 206f 626a  and value an obj
-0001aac0: 6563 7420 6f66 2074 7970 6520 5b70 726f  ect of type [pro
-0001aad0: 7065 7274 6965 735d 2868 7474 7073 3a2f  perties](https:/
-0001aae0: 2f64 6f63 732e 636f 6e66 6c75 656e 742e  /docs.confluent.
-0001aaf0: 696f 2f70 6c61 7466 6f72 6d2f 6375 7272  io/platform/curr
-0001ab00: 656e 742f 636c 6965 6e74 732f 6c69 6272  ent/clients/libr
-0001ab10: 646b 6166 6b61 2f68 746d 6c2f 6d64 5f43  dkafka/html/md_C
-0001ab20: 4f4e 4649 4755 5241 5449 4f4e 2e68 746d  ONFIGURATION.htm
-0001ab30: 6c6e 290a 2020 2020 2020 2020 2020 2020  ln).            
-0001ab40: 2020 2020 2020 7573 6564 2074 6f20 636f        used to co
-0001ab50: 6e66 6967 7572 6520 7468 6520 4b61 666b  nfigure the Kafk
-0001ab60: 6120 636c 6965 6e74 2e20 546f 206f 7074  a client. To opt
-0001ab70: 696d 697a 6520 666f 7220 7468 726f 7567  imize for throug
-0001ab80: 6870 7574 2069 6e20 6869 6768 206c 6174  hput in high lat
-0001ab90: 656e 6379 2063 6f6e 6e65 6374 696f 6e20  ency connection 
-0001aba0: 636f 6e73 6964 6572 0a20 2020 2020 2020  consider.       
-0001abb0: 2020 2020 2020 2020 2020 2063 6861 6e67             chang
-0001abc0: 696e 6720 5b70 726f 6475 6365 7220 7072  ing [producer pr
-0001abd0: 6f70 6572 7469 6573 5d28 6874 7470 733a  operties](https:
-0001abe0: 2f2f 646f 6373 2e63 6f6e 666c 7565 6e74  //docs.confluent
-0001abf0: 2e69 6f2f 636c 6f75 642f 6375 7272 656e  .io/cloud/curren
-0001ac00: 742f 636c 6965 6e74 2d61 7070 732f 6f70  t/client-apps/op
-0001ac10: 7469 6d69 7a69 6e67 2f74 6872 6f75 6768  timizing/through
-0001ac20: 7075 742e 6874 6d6c 2370 726f 6475 6365  put.html#produce
-0001ac30: 7229 2e0a 2020 2020 2020 2020 2020 2020  r)..            
-0001ac40: 2020 2020 2a20 6b65 7920 6069 6e74 6572      * key `inter
-0001ac50: 6e61 6c5f 6b61 666b 6160 2061 6e64 2076  nal_kafka` and v
-0001ac60: 616c 7565 2060 5472 7565 6020 6f72 2060  alue `True` or `
-0001ac70: 4661 6c73 6560 2069 6e20 6361 7365 2079  False` in case y
-0001ac80: 6f75 2065 7374 6162 6c69 7368 6564 0a20  ou established. 
-0001ac90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aca0: 2063 6f6e 6e65 6374 6976 6974 7920 6672   connectivity fr
-0001acb0: 6f6d 2079 6f75 2050 7974 686f 6e20 656e  om you Python en
-0001acc0: 7669 726f 6e6d 656e 7420 746f 2074 6865  vironment to the
-0001acd0: 2069 6e74 6572 6e61 6c20 6164 7665 7274   internal advert
-0001ace0: 6973 6564 0a20 2020 2020 2020 2020 2020  ised.           
-0001acf0: 2020 2020 2020 206c 6973 7465 6e65 7273         listeners
-0001ad00: 206f 6620 7468 6520 486f 7073 776f 726b   of the Hopswork
-0001ad10: 7320 4b61 666b 6120 436c 7573 7465 722e  s Kafka Cluster.
-0001ad20: 2044 6566 6175 6c74 7320 746f 2060 4661   Defaults to `Fa
-0001ad30: 6c73 6560 2061 6e64 0a20 2020 2020 2020  lse` and.       
-0001ad40: 2020 2020 2020 2020 2020 2077 696c 6c20             will 
-0001ad50: 7573 6520 6578 7465 726e 616c 206c 6973  use external lis
-0001ad60: 7465 6e65 7273 2077 6865 6e20 636f 6e6e  teners when conn
-0001ad70: 6563 7469 6e67 2066 726f 6d20 6f75 7473  ecting from outs
-0001ad80: 6964 6520 6f66 2048 6f70 7377 6f72 6b73  ide of Hopsworks
-0001ad90: 2e0a 2020 2020 2020 2020 2020 2020 7661  ..            va
-0001ada0: 6c69 6461 7469 6f6e 5f6f 7074 696f 6e73  lidation_options
-0001adb0: 3a20 4164 6469 7469 6f6e 616c 2076 616c  : Additional val
-0001adc0: 6964 6174 696f 6e20 6f70 7469 6f6e 7320  idation options 
-0001add0: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
-0001ade0: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
-0001adf0: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
-0001ae00: 2020 2020 2020 2a20 6b65 7920 6072 756e        * key `run
-0001ae10: 5f76 616c 6964 6174 696f 6e60 2062 6f6f  _validation` boo
-0001ae20: 6c65 616e 2076 616c 7565 2c20 7365 7420  lean value, set 
-0001ae30: 746f 2060 4661 6c73 6560 2074 6f20 736b  to `False` to sk
-0001ae40: 6970 2076 616c 6964 6174 696f 6e20 7465  ip validation te
-0001ae50: 6d70 6f72 6172 696c 7920 6f6e 2069 6e67  mporarily on ing
-0001ae60: 6573 7469 6f6e 2e0a 2020 2020 2020 2020  estion..        
-0001ae70: 2020 2020 2020 2020 2a20 6b65 7920 6073          * key `s
-0001ae80: 6176 655f 7265 706f 7274 6020 626f 6f6c  ave_report` bool
-0001ae90: 6561 6e20 7661 6c75 652c 2073 6574 2074  ean value, set t
-0001aea0: 6f20 6046 616c 7365 6020 746f 2073 6b69  o `False` to ski
-0001aeb0: 7020 7570 6c6f 6164 206f 6620 7468 6520  p upload of the 
-0001aec0: 7661 6c69 6461 7469 6f6e 2072 6570 6f72  validation repor
-0001aed0: 7420 746f 2048 6f70 7377 6f72 6b73 2e0a  t to Hopsworks..
-0001aee0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001aef0: 2a20 6b65 7920 6067 655f 7661 6c69 6461  * key `ge_valida
-0001af00: 7465 5f6b 7761 7267 7360 2061 2064 6963  te_kwargs` a dic
-0001af10: 7469 6f6e 6172 7920 636f 6e74 6169 6e69  tionary containi
-0001af20: 6e67 206b 7761 7267 7320 666f 7220 7468  ng kwargs for th
-0001af30: 6520 7661 6c69 6461 7465 206d 6574 686f  e validate metho
-0001af40: 6420 6f66 2047 7265 6174 2045 7870 6563  d of Great Expec
-0001af50: 7461 7469 6f6e 732e 0a20 2020 2020 2020  tations..       
-0001af60: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
-0001af70: 6665 7463 685f 6578 7065 6374 6174 696f  fetch_expectatio
-0001af80: 6e5f 7375 6974 6560 2061 2062 6f6f 6c65  n_suite` a boole
-0001af90: 616e 2076 616c 7565 2c20 6279 2064 6566  an value, by def
-0001afa0: 6175 6c74 2060 4661 6c73 6560 2066 6f72  ault `False` for
-0001afb0: 206d 756c 7469 2070 6172 7420 696e 7365   multi part inse
-0001afc0: 7274 732c 0a20 2020 2020 2020 2020 2020  rts,.           
-0001afd0: 2020 2020 2020 2020 746f 2063 6f6e 7472          to contr
-0001afe0: 6f6c 2077 6865 7468 6572 2074 6865 2065  ol whether the e
-0001aff0: 7870 6563 7461 7469 6f6e 2073 7569 7465  xpectation suite
-0001b000: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
-0001b010: 6772 6f75 7020 7368 6f75 6c64 2062 6520  group should be 
-0001b020: 6665 7463 6865 6420 6265 666f 7265 2065  fetched before e
-0001b030: 7665 7279 2069 6e73 6572 742e 0a0a 2020  very insert...  
-0001b040: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-0001b050: 2020 2020 2020 2020 2020 2020 2860 4a6f              (`Jo
-0001b060: 6260 2c20 6056 616c 6964 6174 696f 6e52  b`, `ValidationR
-0001b070: 6570 6f72 7460 2920 4120 7475 706c 6520  eport`) A tuple 
-0001b080: 7769 7468 206a 6f62 2069 6e66 6f72 6d61  with job informa
-0001b090: 7469 6f6e 2069 6620 7079 7468 6f6e 2065  tion if python e
-0001b0a0: 6e67 696e 6520 6973 2075 7365 6420 616e  ngine is used an
-0001b0b0: 6420 7468 6520 7661 6c69 6461 7469 6f6e  d the validation
-0001b0c0: 2072 6570 6f72 7420 6966 2076 616c 6964   report if valid
-0001b0d0: 6174 696f 6e20 6973 2065 6e61 626c 6564  ation is enabled
-0001b0e0: 2e0a 2020 2020 2020 2020 2020 2020 6046  ..            `F
-0001b0f0: 6561 7475 7265 4772 6f75 7057 7269 7465  eatureGroupWrite
-0001b100: 7260 2057 6865 6e20 7573 6564 2061 7320  r` When used as 
-0001b110: 6120 636f 6e74 6578 7420 6d61 6e61 6765  a context manage
-0001b120: 7220 7769 7468 2050 7974 686f 6e20 6077  r with Python `w
-0001b130: 6974 6860 2073 7461 7465 6d65 6e74 2e0a  ith` statement..
-0001b140: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001b150: 2020 2020 7365 6c66 2e5f 6d75 6c74 695f      self._multi_
-0001b160: 7061 7274 5f69 6e73 6572 7420 3d20 5472  part_insert = Tr
-0001b170: 7565 0a20 2020 2020 2020 206d 756c 7469  ue.        multi
-0001b180: 5f70 6172 745f 7772 6974 6572 203d 2066  _part_writer = f
-0001b190: 6561 7475 7265 5f67 726f 7570 5f77 7269  eature_group_wri
-0001b1a0: 7465 722e 4665 6174 7572 6547 726f 7570  ter.FeatureGroup
-0001b1b0: 5772 6974 6572 2873 656c 6629 0a20 2020  Writer(self).   
-0001b1c0: 2020 2020 2069 6620 6665 6174 7572 6573       if features
-0001b1d0: 2069 7320 4e6f 6e65 3a0a 2020 2020 2020   is None:.      
-0001b1e0: 2020 2020 2020 7265 7475 726e 206d 756c        return mul
-0001b1f0: 7469 5f70 6172 745f 7772 6974 6572 0a20  ti_part_writer. 
-0001b200: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-0001b210: 2020 2020 2020 2020 2023 2067 6f20 7468           # go th
-0001b220: 726f 7567 6820 7772 6974 6572 2074 6f20  rough writer to 
-0001b230: 6176 6f69 6420 7365 7474 696e 6720 6d75  avoid setting mu
-0001b240: 6c74 6920 696e 7365 7274 2064 6566 6175  lti insert defau
-0001b250: 6c74 7320 6167 6169 6e0a 2020 2020 2020  lts again.      
-0001b260: 2020 2020 2020 7265 7475 726e 206d 756c        return mul
-0001b270: 7469 5f70 6172 745f 7772 6974 6572 2e69  ti_part_writer.i
-0001b280: 6e73 6572 7428 0a20 2020 2020 2020 2020  nsert(.         
-0001b290: 2020 2020 2020 2066 6561 7475 7265 732c         features,
-0001b2a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001b2b0: 206f 7665 7277 7269 7465 2c0a 2020 2020   overwrite,.    
-0001b2c0: 2020 2020 2020 2020 2020 2020 6f70 6572              oper
-0001b2d0: 6174 696f 6e2c 0a20 2020 2020 2020 2020  ation,.         
-0001b2e0: 2020 2020 2020 2073 746f 7261 6765 2c0a         storage,.
-0001b2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b300: 7772 6974 655f 6f70 7469 6f6e 732c 0a20  write_options,. 
-0001b310: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0001b320: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
-0001b330: 732c 0a20 2020 2020 2020 2020 2020 2029  s,.            )
-0001b340: 0a0a 2020 2020 6465 6620 6669 6e61 6c69  ..    def finali
-0001b350: 7a65 5f6d 756c 7469 5f70 6172 745f 696e  ze_multi_part_in
-0001b360: 7365 7274 2873 656c 6629 3a0a 2020 2020  sert(self):.    
-0001b370: 2020 2020 2222 2246 696e 616c 697a 6573      """Finalizes
-0001b380: 2061 6e64 2065 7869 7473 2074 6865 206d   and exits the m
-0001b390: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
-0001b3a0: 2063 6f6e 7465 7874 206f 7065 6e65 6420   context opened 
-0001b3b0: 6279 2060 6d75 6c74 695f 7061 7274 5f69  by `multi_part_i
-0001b3c0: 6e73 6572 7460 0a20 2020 2020 2020 2069  nsert`.        i
-0001b3d0: 6e20 6120 626c 6f63 6b69 6e67 2066 6173  n a blocking fas
-0001b3e0: 6869 6f6e 206f 6e63 6520 616c 6c20 726f  hion once all ro
-0001b3f0: 7773 2068 6176 6520 6265 656e 2074 7261  ws have been tra
-0001b400: 6e73 6d69 7474 6564 2e0a 0a20 2020 2020  nsmitted...     
-0001b410: 2020 2021 2121 2065 7861 6d70 6c65 2022     !!! example "
-0001b420: 4d75 6c74 6920 7061 7274 2069 6e73 6572  Multi part inser
-0001b430: 7420 7769 7468 206d 616e 7561 6c20 636f  t with manual co
-0001b440: 6e74 6578 7420 6d61 6e61 6765 6d65 6e74  ntext management
-0001b450: 220a 2020 2020 2020 2020 2020 2020 496e  ".            In
-0001b460: 7374 6561 6420 6f66 206c 6574 7469 6e67  stead of letting
-0001b470: 2050 7974 686f 6e20 6861 6e64 6c65 2074   Python handle t
-0001b480: 6865 2065 6e74 6572 696e 6720 616e 6420  he entering and 
-0001b490: 6578 6974 696e 6720 6f66 2074 6865 0a20  exiting of the. 
-0001b4a0: 2020 2020 2020 2020 2020 206d 756c 7469             multi
-0001b4b0: 2070 6172 7420 696e 7365 7274 2063 6f6e   part insert con
-0001b4c0: 7465 7874 2c20 796f 7520 6361 6e20 7374  text, you can st
-0001b4d0: 6172 7420 616e 6420 6669 6e61 6c69 7a65  art and finalize
-0001b4e0: 2074 6865 2063 6f6e 7465 7874 0a20 2020   the context.   
-0001b4f0: 2020 2020 2020 2020 206d 616e 7561 6c6c           manuall
-0001b500: 792e 0a20 2020 2020 2020 2020 2020 2060  y..            `
-0001b510: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
-0001b520: 2020 2020 2066 6561 7475 7265 5f67 726f       feature_gro
-0001b530: 7570 203d 2066 732e 6765 745f 6f72 5f63  up = fs.get_or_c
-0001b540: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
-0001b550: 6f75 7028 2266 675f 6e61 6d65 222c 2076  oup("fg_name", v
-0001b560: 6572 7369 6f6e 3d31 290a 0a20 2020 2020  ersion=1)..     
-0001b570: 2020 2020 2020 2077 6869 6c65 206c 6f6f         while loo
-0001b580: 703a 0a20 2020 2020 2020 2020 2020 2020  p:.             
-0001b590: 2020 2073 6d61 6c6c 5f62 6174 6368 5f64     small_batch_d
-0001b5a0: 6620 3d20 2e2e 2e0a 2020 2020 2020 2020  f = ....        
-0001b5b0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-0001b5c0: 6772 6f75 702e 6d75 6c74 695f 7061 7274  group.multi_part
-0001b5d0: 5f69 6e73 6572 7428 736d 616c 6c5f 6261  _insert(small_ba
-0001b5e0: 7463 685f 6466 290a 0a20 2020 2020 2020  tch_df)..       
-0001b5f0: 2020 2020 2023 2049 4d50 4f52 5441 4e54       # IMPORTANT
-0001b600: 3a20 6669 6e61 6c69 7a65 2074 6865 206d  : finalize the m
-0001b610: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
-0001b620: 2074 6f20 6d61 6b65 2073 7572 6520 616c   to make sure al
-0001b630: 6c20 726f 7773 0a20 2020 2020 2020 2020  l rows.         
-0001b640: 2020 2023 2068 6176 6520 6265 656e 2074     # have been t
-0001b650: 7261 6e73 6d69 7474 6564 0a20 2020 2020  ransmitted.     
-0001b660: 2020 2020 2020 2066 6561 7475 7265 5f67         feature_g
-0001b670: 726f 7570 2e66 696e 616c 697a 655f 6d75  roup.finalize_mu
-0001b680: 6c74 695f 7061 7274 5f69 6e73 6572 7428  lti_part_insert(
-0001b690: 290a 2020 2020 2020 2020 2020 2020 6060  ).            ``
-0001b6a0: 600a 2020 2020 2020 2020 2020 2020 4e6f  `.            No
-0001b6b0: 7465 2074 6861 7420 7468 6520 6669 7273  te that the firs
-0001b6c0: 7420 6361 6c6c 2074 6f20 606d 756c 7469  t call to `multi
-0001b6d0: 5f70 6172 745f 696e 7365 7274 6020 696e  _part_insert` in
-0001b6e0: 6974 6961 7465 7320 7468 6520 636f 6e74  itiates the cont
-0001b6f0: 6578 740a 2020 2020 2020 2020 2020 2020  ext.            
-0001b700: 616e 6420 6265 2073 7572 6520 746f 2066  and be sure to f
-0001b710: 696e 616c 697a 6520 6974 2e20 5468 6520  inalize it. The 
-0001b720: 6066 696e 616c 697a 655f 6d75 6c74 695f  `finalize_multi_
-0001b730: 7061 7274 5f69 6e73 6572 7460 2069 7320  part_insert` is 
-0001b740: 610a 2020 2020 2020 2020 2020 2020 626c  a.            bl
-0001b750: 6f63 6b69 6e67 2063 616c 6c20 7468 6174  ocking call that
-0001b760: 2072 6574 7572 6e73 206f 6e63 6520 616c   returns once al
-0001b770: 6c20 726f 7773 2068 6176 6520 6265 656e  l rows have been
-0001b780: 2074 7261 6e73 6d69 7474 6564 2e0a 2020   transmitted..  
-0001b790: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
-0001b7a0: 2020 6966 2073 656c 662e 5f6b 6166 6b61    if self._kafka
-0001b7b0: 5f70 726f 6475 6365 7220 6973 206e 6f74  _producer is not
-0001b7c0: 204e 6f6e 653a 0a20 2020 2020 2020 2020   None:.         
-0001b7d0: 2020 2073 656c 662e 5f6b 6166 6b61 5f70     self._kafka_p
-0001b7e0: 726f 6475 6365 722e 666c 7573 6828 290a  roducer.flush().
-0001b7f0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001b800: 2e5f 6b61 666b 615f 7072 6f64 7563 6572  ._kafka_producer
-0001b810: 203d 204e 6f6e 650a 2020 2020 2020 2020   = None.        
-0001b820: 7365 6c66 2e5f 6665 6174 7572 655f 7772  self._feature_wr
-0001b830: 6974 6572 7320 3d20 4e6f 6e65 0a20 2020  iters = None.   
-0001b840: 2020 2020 2073 656c 662e 5f77 7269 7465       self._write
-0001b850: 7220 3d20 4e6f 6e65 0a20 2020 2020 2020  r = None.       
-0001b860: 2073 656c 662e 5f6d 756c 7469 5f70 6172   self._multi_par
-0001b870: 745f 696e 7365 7274 203d 2046 616c 7365  t_insert = False
-0001b880: 0a0a 2020 2020 6465 6620 696e 7365 7274  ..    def insert
-0001b890: 5f73 7472 6561 6d28 0a20 2020 2020 2020  _stream(.       
-0001b8a0: 2073 656c 662c 0a20 2020 2020 2020 2066   self,.        f
-0001b8b0: 6561 7475 7265 733a 2054 7970 6556 6172  eatures: TypeVar
-0001b8c0: 2822 7079 7370 6172 6b2e 7371 6c2e 4461  ("pyspark.sql.Da
-0001b8d0: 7461 4672 616d 6522 292c 2020 2320 6e6f  taFrame"),  # no
-0001b8e0: 7161 3a20 4638 3231 0a20 2020 2020 2020  qa: F821.       
-0001b8f0: 2071 7565 7279 5f6e 616d 653a 204f 7074   query_name: Opt
-0001b900: 696f 6e61 6c5b 7374 725d 203d 204e 6f6e  ional[str] = Non
-0001b910: 652c 0a20 2020 2020 2020 206f 7574 7075  e,.        outpu
-0001b920: 745f 6d6f 6465 3a20 4f70 7469 6f6e 616c  t_mode: Optional
-0001b930: 5b73 7472 5d20 3d20 2261 7070 656e 6422  [str] = "append"
-0001b940: 2c0a 2020 2020 2020 2020 6177 6169 745f  ,.        await_
-0001b950: 7465 726d 696e 6174 696f 6e3a 204f 7074  termination: Opt
-0001b960: 696f 6e61 6c5b 626f 6f6c 5d20 3d20 4661  ional[bool] = Fa
-0001b970: 6c73 652c 0a20 2020 2020 2020 2074 696d  lse,.        tim
-0001b980: 656f 7574 3a20 4f70 7469 6f6e 616c 5b69  eout: Optional[i
-0001b990: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-0001b9a0: 2020 2020 6368 6563 6b70 6f69 6e74 5f64      checkpoint_d
-0001b9b0: 6972 3a20 4f70 7469 6f6e 616c 5b73 7472  ir: Optional[str
-0001b9c0: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
-0001b9d0: 2020 7772 6974 655f 6f70 7469 6f6e 733a    write_options:
-0001b9e0: 204f 7074 696f 6e61 6c5b 4469 6374 5b41   Optional[Dict[A
-0001b9f0: 6e79 2c20 416e 795d 5d20 3d20 7b7d 2c0a  ny, Any]] = {},.
-0001ba00: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
-0001ba10: 2222 496e 6765 7374 2061 2053 7061 726b  ""Ingest a Spark
-0001ba20: 2053 7472 7563 7475 7265 6420 5374 7265   Structured Stre
-0001ba30: 616d 696e 6720 4461 7461 6672 616d 6520  aming Dataframe 
-0001ba40: 746f 2074 6865 206f 6e6c 696e 6520 6665  to the online fe
-0001ba50: 6174 7572 6520 7374 6f72 652e 0a0a 2020  ature store...  
-0001ba60: 2020 2020 2020 5468 6973 206d 6574 686f        This metho
-0001ba70: 6420 6372 6561 7465 7320 6120 6c6f 6e67  d creates a long
-0001ba80: 2072 756e 6e69 6e67 2053 7061 726b 2053   running Spark S
-0001ba90: 7472 6561 6d69 6e67 2051 7565 7279 2c20  treaming Query, 
-0001baa0: 796f 7520 6361 6e20 636f 6e74 726f 6c20  you can control 
-0001bab0: 7468 650a 2020 2020 2020 2020 7465 726d  the.        term
-0001bac0: 696e 6174 696f 6e20 6f66 2074 6865 2071  ination of the q
-0001bad0: 7565 7279 2074 6872 6f75 6768 2074 6865  uery through the
-0001bae0: 2061 7267 756d 656e 7473 2e0a 0a20 2020   arguments...   
-0001baf0: 2020 2020 2049 7420 6973 2070 6f73 7369       It is possi
-0001bb00: 626c 6520 746f 2073 746f 7020 7468 6520  ble to stop the 
-0001bb10: 7265 7475 726e 6564 2071 7565 7279 2077  returned query w
-0001bb20: 6974 6820 7468 6520 602e 7374 6f70 2829  ith the `.stop()
-0001bb30: 6020 616e 6420 6368 6563 6b20 6974 730a  ` and check its.
-0001bb40: 2020 2020 2020 2020 7374 6174 7573 2077          status w
-0001bb50: 6974 6820 602e 6973 4163 7469 7665 602e  ith `.isActive`.
-0001bb60: 0a0a 2020 2020 2020 2020 546f 2067 6574  ..        To get
-0001bb70: 2061 206c 6973 7420 6f66 2061 6c6c 2061   a list of all a
-0001bb80: 6374 6976 6520 7175 6572 6965 732c 2075  ctive queries, u
-0001bb90: 7365 3a0a 0a20 2020 2020 2020 2060 6060  se:..        ```
-0001bba0: 7079 7468 6f6e 0a20 2020 2020 2020 2073  python.        s
-0001bbb0: 716d 203d 2073 7061 726b 2e73 7472 6561  qm = spark.strea
-0001bbc0: 6d73 0a0a 2020 2020 2020 2020 2320 6765  ms..        # ge
-0001bbd0: 7420 7468 6520 6c69 7374 206f 6620 6163  t the list of ac
-0001bbe0: 7469 7665 2073 7472 6561 6d69 6e67 2071  tive streaming q
-0001bbf0: 7565 7269 6573 0a20 2020 2020 2020 205b  ueries.        [
-0001bc00: 712e 6e61 6d65 2066 6f72 2071 2069 6e20  q.name for q in 
-0001bc10: 7371 6d2e 6163 7469 7665 5d0a 2020 2020  sqm.active].    
-0001bc20: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
-0001bc30: 2021 2121 2077 6172 6e69 6e67 2022 456e   !!! warning "En
-0001bc40: 6769 6e65 2053 7570 706f 7274 220a 2020  gine Support".  
-0001bc50: 2020 2020 2020 2020 2020 2a2a 5370 6172            **Spar
-0001bc60: 6b20 6f6e 6c79 2a2a 0a0a 2020 2020 2020  k only**..      
-0001bc70: 2020 2020 2020 5374 7265 616d 2069 6e67        Stream ing
-0001bc80: 6573 7469 6f6e 2075 7369 6e67 2050 616e  estion using Pan
-0001bc90: 6461 732f 5079 7468 6f6e 2061 7320 656e  das/Python as en
-0001bca0: 6769 6e65 2069 7320 6375 7272 656e 746c  gine is currentl
-0001bcb0: 7920 6e6f 7420 7375 7070 6f72 7465 642e  y not supported.
-0001bcc0: 0a20 2020 2020 2020 2020 2020 2050 7974  .            Pyt
-0001bcd0: 686f 6e2f 5061 6e64 6173 2068 6173 206e  hon/Pandas has n
-0001bce0: 6f20 6e6f 7469 6f6e 206f 6620 7374 7265  o notion of stre
-0001bcf0: 616d 696e 672e 0a0a 2020 2020 2020 2020  aming...        
-0001bd00: 2121 2120 7761 726e 696e 6720 2244 6174  !!! warning "Dat
-0001bd10: 6120 5661 6c69 6461 7469 6f6e 2053 7570  a Validation Sup
-0001bd20: 706f 7274 220a 2020 2020 2020 2020 2020  port".          
-0001bd30: 2020 6069 6e73 6572 745f 7374 7265 616d    `insert_stream
-0001bd40: 6020 646f 6573 206e 6f74 2070 6572 666f  ` does not perfo
-0001bd50: 726d 2061 6e79 2064 6174 6120 7661 6c69  rm any data vali
-0001bd60: 6461 7469 6f6e 2075 7369 6e67 2047 7265  dation using Gre
-0001bd70: 6174 2045 7870 6563 7461 7469 6f6e 730a  at Expectations.
-0001bd80: 2020 2020 2020 2020 2020 2020 6576 656e              even
-0001bd90: 2077 6865 6e20 6120 6578 7065 6374 6174   when a expectat
-0001bda0: 696f 6e20 7375 6974 6520 6973 2061 7474  ion suite is att
-0001bdb0: 6163 6865 642e 0a0a 2020 2020 2020 2020  ached...        
-0001bdc0: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
-0001bdd0: 2020 2020 2020 2020 6665 6174 7572 6573          features
-0001bde0: 3a20 4665 6174 7572 6573 2069 6e20 5374  : Features in St
-0001bdf0: 7265 616d 696e 6720 4461 7461 6672 616d  reaming Datafram
-0001be00: 6520 746f 2062 6520 7361 7665 642e 0a20  e to be saved.. 
-0001be10: 2020 2020 2020 2020 2020 2071 7565 7279             query
-0001be20: 5f6e 616d 653a 2049 7420 6973 2070 6f73  _name: It is pos
-0001be30: 7369 626c 6520 746f 206f 7074 696f 6e61  sible to optiona
-0001be40: 6c6c 7920 7370 6563 6966 7920 6120 6e61  lly specify a na
-0001be50: 6d65 2066 6f72 2074 6865 2071 7565 7279  me for the query
-0001be60: 2074 6f0a 2020 2020 2020 2020 2020 2020   to.            
-0001be70: 2020 2020 6d61 6b65 2069 7420 6561 7369      make it easi
-0001be80: 6572 2074 6f20 7265 636f 676e 6973 6520  er to recognise 
-0001be90: 696e 2074 6865 2053 7061 726b 2055 492e  in the Spark UI.
-0001bea0: 2044 6566 6175 6c74 7320 746f 2060 4e6f   Defaults to `No
-0001beb0: 6e65 602e 0a20 2020 2020 2020 2020 2020  ne`..           
-0001bec0: 206f 7574 7075 745f 6d6f 6465 3a20 5370   output_mode: Sp
-0001bed0: 6563 6966 6965 7320 686f 7720 6461 7461  ecifies how data
-0001bee0: 206f 6620 6120 7374 7265 616d 696e 6720   of a streaming 
-0001bef0: 4461 7461 4672 616d 652f 4461 7461 7365  DataFrame/Datase
-0001bf00: 7420 6973 0a20 2020 2020 2020 2020 2020  t is.           
-0001bf10: 2020 2020 2077 7269 7474 656e 2074 6f20       written to 
-0001bf20: 6120 7374 7265 616d 696e 6720 7369 6e6b  a streaming sink
-0001bf30: 2e20 2831 2920 6022 6170 7065 6e64 2260  . (1) `"append"`
-0001bf40: 3a20 4f6e 6c79 2074 6865 206e 6577 2072  : Only the new r
-0001bf50: 6f77 7320 696e 2074 6865 0a20 2020 2020  ows in the.     
-0001bf60: 2020 2020 2020 2020 2020 2073 7472 6561             strea
-0001bf70: 6d69 6e67 2044 6174 6146 7261 6d65 2f44  ming DataFrame/D
-0001bf80: 6174 6173 6574 2077 696c 6c20 6265 2077  ataset will be w
-0001bf90: 7269 7474 656e 2074 6f20 7468 6520 7369  ritten to the si
-0001bfa0: 6e6b 2e20 2832 290a 2020 2020 2020 2020  nk. (2).        
-0001bfb0: 2020 2020 2020 2020 6022 636f 6d70 6c65          `"comple
-0001bfc0: 7465 2260 3a20 416c 6c20 7468 6520 726f  te"`: All the ro
-0001bfd0: 7773 2069 6e20 7468 6520 7374 7265 616d  ws in the stream
-0001bfe0: 696e 6720 4461 7461 4672 616d 652f 4461  ing DataFrame/Da
-0001bff0: 7461 7365 7420 7769 6c6c 2062 650a 2020  taset will be.  
-0001c000: 2020 2020 2020 2020 2020 2020 2020 7772                wr
-0001c010: 6974 7465 6e20 746f 2074 6865 2073 696e  itten to the sin
-0001c020: 6b20 6576 6572 7920 7469 6d65 2074 6865  k every time the
-0001c030: 7265 2069 7320 736f 6d65 2075 7064 6174  re is some updat
-0001c040: 652e 2028 3329 2060 2275 7064 6174 6522  e. (3) `"update"
-0001c050: 603a 0a20 2020 2020 2020 2020 2020 2020  `:.             
-0001c060: 2020 206f 6e6c 7920 7468 6520 726f 7773     only the rows
-0001c070: 2074 6861 7420 7765 7265 2075 7064 6174   that were updat
-0001c080: 6564 2069 6e20 7468 6520 7374 7265 616d  ed in the stream
-0001c090: 696e 6720 4461 7461 4672 616d 652f 4461  ing DataFrame/Da
-0001c0a0: 7461 7365 7420 7769 6c6c 0a20 2020 2020  taset will.     
-0001c0b0: 2020 2020 2020 2020 2020 2062 6520 7772             be wr
-0001c0c0: 6974 7465 6e20 746f 2074 6865 2073 696e  itten to the sin
-0001c0d0: 6b20 6576 6572 7920 7469 6d65 2074 6865  k every time the
-0001c0e0: 7265 2061 7265 2073 6f6d 6520 7570 6461  re are some upda
-0001c0f0: 7465 732e 0a20 2020 2020 2020 2020 2020  tes..           
-0001c100: 2020 2020 2049 6620 7468 6520 7175 6572       If the quer
-0001c110: 7920 646f 6573 6ee2 8099 7420 636f 6e74  y doesn...t cont
-0001c120: 6169 6e20 6167 6772 6567 6174 696f 6e73  ain aggregations
-0001c130: 2c20 6974 2077 696c 6c20 6265 2065 7175  , it will be equ
-0001c140: 6976 616c 656e 7420 746f 0a20 2020 2020  ivalent to.     
-0001c150: 2020 2020 2020 2020 2020 2061 7070 656e             appen
-0001c160: 6420 6d6f 6465 2e20 4465 6661 756c 7473  d mode. Defaults
-0001c170: 2074 6f20 6022 6170 7065 6e64 2260 2e0a   to `"append"`..
-0001c180: 2020 2020 2020 2020 2020 2020 6177 6169              awai
-0001c190: 745f 7465 726d 696e 6174 696f 6e3a 2057  t_termination: W
-0001c1a0: 6169 7473 2066 6f72 2074 6865 2074 6572  aits for the ter
-0001c1b0: 6d69 6e61 7469 6f6e 206f 6620 7468 6973  mination of this
-0001c1c0: 2071 7565 7279 2c20 6569 7468 6572 2062   query, either b
-0001c1d0: 790a 2020 2020 2020 2020 2020 2020 2020  y.              
-0001c1e0: 2020 7175 6572 792e 7374 6f70 2829 206f    query.stop() o
-0001c1f0: 7220 6279 2061 6e20 6578 6365 7074 696f  r by an exceptio
-0001c200: 6e2e 2049 6620 7468 6520 7175 6572 7920  n. If the query 
-0001c210: 6861 7320 7465 726d 696e 6174 6564 2077  has terminated w
-0001c220: 6974 6820 616e 0a20 2020 2020 2020 2020  ith an.         
-0001c230: 2020 2020 2020 2065 7863 6570 7469 6f6e         exception
-0001c240: 2c20 7468 656e 2074 6865 2065 7863 6570  , then the excep
-0001c250: 7469 6f6e 2077 696c 6c20 6265 2074 6872  tion will be thr
-0001c260: 6f77 6e2e 2049 6620 7469 6d65 6f75 7420  own. If timeout 
-0001c270: 6973 2073 6574 2c20 6974 0a20 2020 2020  is set, it.     
-0001c280: 2020 2020 2020 2020 2020 2072 6574 7572             retur
-0001c290: 6e73 2077 6865 7468 6572 2074 6865 2071  ns whether the q
-0001c2a0: 7565 7279 2068 6173 2074 6572 6d69 6e61  uery has termina
-0001c2b0: 7465 6420 6f72 206e 6f74 2077 6974 6869  ted or not withi
-0001c2c0: 6e20 7468 6520 7469 6d65 6f75 740a 2020  n the timeout.  
-0001c2d0: 2020 2020 2020 2020 2020 2020 2020 7365                se
-0001c2e0: 636f 6e64 732e 2044 6566 6175 6c74 7320  conds. Defaults 
-0001c2f0: 746f 2060 4661 6c73 6560 2e0a 2020 2020  to `False`..    
-0001c300: 2020 2020 2020 2020 7469 6d65 6f75 743a          timeout:
-0001c310: 204f 6e6c 7920 7265 6c65 7661 6e74 2069   Only relevant i
-0001c320: 6e20 636f 6d62 696e 6174 696f 6e20 7769  n combination wi
-0001c330: 7468 2060 6177 6169 745f 7465 726d 696e  th `await_termin
-0001c340: 6174 696f 6e3d 5472 7565 602e 0a20 2020  ation=True`..   
-0001c350: 2020 2020 2020 2020 2020 2020 2044 6566               Def
-0001c360: 6175 6c74 7320 746f 2060 4e6f 6e65 602e  aults to `None`.
-0001c370: 0a20 2020 2020 2020 2020 2020 2063 6865  .            che
-0001c380: 636b 706f 696e 745f 6469 723a 2043 6865  ckpoint_dir: Che
-0001c390: 636b 706f 696e 7420 6469 7265 6374 6f72  ckpoint director
-0001c3a0: 7920 6c6f 6361 7469 6f6e 2e20 5468 6973  y location. This
-0001c3b0: 2077 696c 6c20 6265 2075 7365 6420 746f   will be used to
-0001c3c0: 2061 7320 6120 7265 6665 7265 6e63 6520   as a reference 
-0001c3d0: 746f 0a20 2020 2020 2020 2020 2020 2020  to.             
-0001c3e0: 2020 2066 726f 6d20 7768 6572 6520 746f     from where to
-0001c3f0: 2072 6573 756d 6520 7468 6520 7374 7265   resume the stre
-0001c400: 616d 696e 6720 6a6f 622e 2049 6620 604e  aming job. If `N
-0001c410: 6f6e 6560 2074 6865 6e20 6873 6673 2077  one` then hsfs w
-0001c420: 696c 6c20 636f 6e73 7472 7563 7420 6173  ill construct as
-0001c430: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c440: 2022 696e 7365 7274 5f73 7472 6561 6d5f   "insert_stream_
-0001c450: 2220 2b20 6f6e 6c69 6e65 5f74 6f70 6963  " + online_topic
-0001c460: 5f6e 616d 652e 2044 6566 6175 6c74 7320  _name. Defaults 
-0001c470: 746f 2060 4e6f 6e65 602e 0a20 2020 2020  to `None`..     
-0001c480: 2020 2020 2020 2020 2020 2077 7269 7465             write
-0001c490: 5f6f 7074 696f 6e73 3a20 4164 6469 7469  _options: Additi
-0001c4a0: 6f6e 616c 2077 7269 7465 206f 7074 696f  onal write optio
-0001c4b0: 6e73 2066 6f72 2053 7061 726b 2061 7320  ns for Spark as 
-0001c4c0: 6b65 792d 7661 6c75 6520 7061 6972 732e  key-value pairs.
-0001c4d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c4e0: 2044 6566 6175 6c74 7320 746f 2060 7b7d   Defaults to `{}
-0001c4f0: 602e 0a0a 2020 2020 2020 2020 2320 5265  `...        # Re
-0001c500: 7475 726e 730a 2020 2020 2020 2020 2020  turns.          
-0001c510: 2020 6053 7472 6561 6d69 6e67 5175 6572    `StreamingQuer
-0001c520: 7960 3a20 5370 6172 6b20 5374 7275 6374  y`: Spark Struct
-0001c530: 7572 6564 2053 7472 6561 6d69 6e67 2051  ured Streaming Q
-0001c540: 7565 7279 206f 626a 6563 742e 0a20 2020  uery object..   
-0001c550: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001c560: 2069 6620 280a 2020 2020 2020 2020 2020   if (.          
-0001c570: 2020 6e6f 7420 656e 6769 6e65 2e67 6574    not engine.get
-0001c580: 5f69 6e73 7461 6e63 6528 292e 6973 5f73  _instance().is_s
-0001c590: 7061 726b 5f64 6174 6166 7261 6d65 2866  park_dataframe(f
-0001c5a0: 6561 7475 7265 7329 0a20 2020 2020 2020  eatures).       
-0001c5b0: 2020 2020 206f 7220 6e6f 7420 6665 6174       or not feat
-0001c5c0: 7572 6573 2e69 7353 7472 6561 6d69 6e67  ures.isStreaming
-0001c5d0: 0a20 2020 2020 2020 2029 3a0a 2020 2020  .        ):.    
-0001c5e0: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0001c5f0: 7065 4572 726f 7228 0a20 2020 2020 2020  peError(.       
-0001c600: 2020 2020 2020 2020 2022 4665 6174 7572           "Featur
-0001c610: 6573 2068 6176 6520 746f 2062 6520 6120  es have to be a 
-0001c620: 7374 7265 616d 696e 6720 7479 7065 2073  streaming type s
-0001c630: 7061 726b 2064 6174 6166 7261 6d65 2e20  park dataframe. 
-0001c640: 5573 6520 6069 6e73 6572 7428 2960 206d  Use `insert()` m
-0001c650: 6574 686f 6420 696e 7374 6561 642e 220a  ethod instead.".
-0001c660: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
-0001c670: 2020 2020 2020 656c 7365 3a0a 2020 2020        else:.    
-0001c680: 2020 2020 2020 2020 2320 6c6f 7765 7220          # lower 
-0001c690: 6361 7369 6e67 2066 6561 7475 7265 206e  casing feature n
-0001c6a0: 616d 6573 0a20 2020 2020 2020 2020 2020  ames.           
-0001c6b0: 2066 6561 7475 7265 5f64 6174 6166 7261   feature_datafra
-0001c6c0: 6d65 203d 2065 6e67 696e 652e 6765 745f  me = engine.get_
-0001c6d0: 696e 7374 616e 6365 2829 2e63 6f6e 7665  instance().conve
-0001c6e0: 7274 5f74 6f5f 6465 6661 756c 745f 6461  rt_to_default_da
-0001c6f0: 7461 6672 616d 6528 0a20 2020 2020 2020  taframe(.       
-0001c700: 2020 2020 2020 2020 2066 6561 7475 7265           feature
-0001c710: 730a 2020 2020 2020 2020 2020 2020 290a  s.            ).
-0001c720: 2020 2020 2020 2020 2020 2020 7761 726e              warn
-0001c730: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
-0001c740: 2020 2020 2020 2020 2020 2028 0a20 2020             (.   
-0001c750: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c760: 2022 5374 7265 616d 2069 6e67 6573 7469   "Stream ingesti
-0001c770: 6f6e 2066 6f72 2066 6561 7475 7265 2067  on for feature g
-0001c780: 726f 7570 2060 7b7d 602c 2077 6974 6820  roup `{}`, with 
-0001c790: 7665 7273 696f 6e22 0a20 2020 2020 2020  version".       
-0001c7a0: 2020 2020 2020 2020 2020 2020 2022 2060               " `
-0001c7b0: 7b7d 6020 7769 6c6c 206e 6f74 2063 6f6d  {}` will not com
-0001c7c0: 7075 7465 2073 7461 7469 7374 6963 732e  pute statistics.
-0001c7d0: 220a 2020 2020 2020 2020 2020 2020 2020  ".              
-0001c7e0: 2020 292e 666f 726d 6174 2873 656c 662e    ).format(self.
-0001c7f0: 5f6e 616d 652c 2073 656c 662e 5f76 6572  _name, self._ver
-0001c800: 7369 6f6e 292c 0a20 2020 2020 2020 2020  sion),.         
-0001c810: 2020 2020 2020 2075 7469 6c2e 5374 6174         util.Stat
-0001c820: 6973 7469 6373 5761 726e 696e 672c 0a20  isticsWarning,. 
-0001c830: 2020 2020 2020 2020 2020 2029 0a0a 2020             )..  
-0001c840: 2020 2020 2020 2020 2020 7265 7475 726e            return
-0001c850: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
-0001c860: 726f 7570 5f65 6e67 696e 652e 696e 7365  roup_engine.inse
-0001c870: 7274 5f73 7472 6561 6d28 0a20 2020 2020  rt_stream(.     
-0001c880: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0001c890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001c8a0: 2066 6561 7475 7265 5f64 6174 6166 7261   feature_datafra
-0001c8b0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-0001c8c0: 2020 2020 7175 6572 795f 6e61 6d65 2c0a      query_name,.
-0001c8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c8e0: 6f75 7470 7574 5f6d 6f64 652c 0a20 2020  output_mode,.   
-0001c8f0: 2020 2020 2020 2020 2020 2020 2061 7761               awa
-0001c900: 6974 5f74 6572 6d69 6e61 7469 6f6e 2c0a  it_termination,.
-0001c910: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c920: 7469 6d65 6f75 742c 0a20 2020 2020 2020  timeout,.       
-0001c930: 2020 2020 2020 2020 2063 6865 636b 706f           checkpo
-0001c940: 696e 745f 6469 722c 0a20 2020 2020 2020  int_dir,.       
-0001c950: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
-0001c960: 7074 696f 6e73 2c0a 2020 2020 2020 2020  ptions,.        
-0001c970: 2020 2020 290a 0a20 2020 2064 6566 2063      )..    def c
-0001c980: 6f6d 6d69 745f 6465 7461 696c 7328 0a20  ommit_details(. 
-0001c990: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
-0001c9a0: 2020 2020 2077 616c 6c63 6c6f 636b 5f74       wallclock_t
-0001c9b0: 696d 653a 204f 7074 696f 6e61 6c5b 556e  ime: Optional[Un
-0001c9c0: 696f 6e5b 7374 722c 2069 6e74 2c20 6461  ion[str, int, da
-0001c9d0: 7465 7469 6d65 2c20 6461 7465 5d5d 203d  tetime, date]] =
-0001c9e0: 204e 6f6e 652c 0a20 2020 2020 2020 206c   None,.        l
-0001c9f0: 696d 6974 3a20 4f70 7469 6f6e 616c 5b69  imit: Optional[i
-0001ca00: 6e74 5d20 3d20 4e6f 6e65 2c0a 2020 2020  nt] = None,.    
-0001ca10: 293a 0a20 2020 2020 2020 2022 2222 5265  ):.        """Re
-0001ca20: 7472 6965 7665 7320 636f 6d6d 6974 2074  trieves commit t
-0001ca30: 696d 656c 696e 6520 666f 7220 7468 6973  imeline for this
-0001ca40: 2066 6561 7475 7265 2067 726f 7570 2e20   feature group. 
-0001ca50: 5468 6973 206d 6574 686f 6420 6361 6e20  This method can 
-0001ca60: 6f6e 6c79 2062 6520 7573 6564 0a20 2020  only be used.   
-0001ca70: 2020 2020 206f 6e20 7469 6d65 2074 7261       on time tra
-0001ca80: 7665 6c20 656e 6162 6c65 6420 6665 6174  vel enabled feat
-0001ca90: 7572 6520 6772 6f75 7073 0a0a 2020 2020  ure groups..    
-0001caa0: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
-0001cab0: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-0001cac0: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-0001cad0: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
-0001cae0: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
-0001caf0: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
-0001cb00: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
-0001cb10: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
-0001cb20: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
-0001cb30: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
-0001cb40: 6667 203d 2066 732e 6765 745f 6f72 5f63  fg = fs.get_or_c
-0001cb50: 7265 6174 655f 6665 6174 7572 655f 6772  reate_feature_gr
-0001cb60: 6f75 7028 2e2e 2e29 0a0a 2020 2020 2020  oup(...)..      
-0001cb70: 2020 2020 2020 636f 6d6d 6974 5f64 6574        commit_det
-0001cb80: 6169 6c73 203d 2066 672e 636f 6d6d 6974  ails = fg.commit
-0001cb90: 5f64 6574 6169 6c73 2829 0a20 2020 2020  _details().     
-0001cba0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-0001cbb0: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
-0001cbc0: 2020 2020 2020 2020 2020 2020 7761 6c6c              wall
-0001cbd0: 636c 6f63 6b5f 7469 6d65 3a20 436f 6d6d  clock_time: Comm
-0001cbe0: 6974 2064 6574 6169 6c73 2061 7320 6f66  it details as of
-0001cbf0: 2073 7065 6369 6669 6320 706f 696e 7420   specific point 
-0001cc00: 696e 2074 696d 652e 2044 6566 6175 6c74  in time. Default
-0001cc10: 7320 746f 2060 4e6f 6e65 602e 0a20 2020  s to `None`..   
-0001cc20: 2020 2020 2020 2020 2020 2020 2020 5374                St
-0001cc30: 7269 6e67 7320 7368 6f75 6c64 2062 6520  rings should be 
-0001cc40: 666f 726d 6174 7465 6420 696e 206f 6e65  formatted in one
-0001cc50: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
-0001cc60: 6720 666f 726d 6174 7320 6025 592d 256d  g formats `%Y-%m
-0001cc70: 2d25 6460 2c20 6025 592d 256d 2d25 6420  -%d`, `%Y-%m-%d 
-0001cc80: 2548 602c 2060 2559 2d25 6d2d 2564 2025  %H`, `%Y-%m-%d %
-0001cc90: 483a 254d 602c 0a20 2020 2020 2020 2020  H:%M`,.         
-0001cca0: 2020 2020 2020 2060 2559 2d25 6d2d 2564         `%Y-%m-%d
-0001ccb0: 2025 483a 254d 3a25 5360 2c20 6f72 2060   %H:%M:%S`, or `
-0001ccc0: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
-0001ccd0: 532e 2566 602e 0a20 2020 2020 2020 2020  S.%f`..         
-0001cce0: 2020 206c 696d 6974 3a20 4e75 6d62 6572     limit: Number
-0001ccf0: 206f 6620 636f 6d6d 6974 7320 746f 2072   of commits to r
-0001cd00: 6574 7269 6576 652e 2044 6566 6175 6c74  etrieve. Default
-0001cd10: 7320 746f 2060 4e6f 6e65 602e 0a0a 2020  s to `None`...  
-0001cd20: 2020 2020 2020 2320 5265 7475 726e 730a        # Returns.
-0001cd30: 2020 2020 2020 2020 2020 2020 6044 6963              `Dic
-0001cd40: 745b 7374 722c 2044 6963 745b 7374 722c  t[str, Dict[str,
-0001cd50: 2073 7472 5d5d 602e 2044 6963 7469 6f6e   str]]`. Diction
-0001cd60: 6172 7920 6f62 6a65 6374 206f 6620 636f  ary object of co
-0001cd70: 6d6d 6974 206d 6574 6164 6174 6120 7469  mmit metadata ti
-0001cd80: 6d65 6c69 6e65 2c20 7768 6572 6520 4b65  meline, where Ke
-0001cd90: 7920 6973 2063 6f6d 6d69 7420 6964 2061  y is commit id a
-0001cda0: 6e64 2076 616c 7565 0a20 2020 2020 2020  nd value.       
-0001cdb0: 2020 2020 2069 7320 6044 6963 745b 7374       is `Dict[st
-0001cdc0: 722c 2073 7472 5d60 2077 6974 6820 6b65  r, str]` with ke
-0001cdd0: 7920 7661 6c75 6520 7061 6972 7320 6f66  y value pairs of
-0001cde0: 2064 6174 6520 636f 6d6d 6974 7465 6420   date committed 
-0001cdf0: 6f6e 2c20 6e75 6d62 6572 206f 6620 726f  on, number of ro
-0001ce00: 7773 2075 7064 6174 6564 2c20 696e 7365  ws updated, inse
-0001ce10: 7274 6564 2061 6e64 2064 656c 6574 6564  rted and deleted
-0001ce20: 2e0a 0a20 2020 2020 2020 2023 2052 6169  ...        # Rai
-0001ce30: 7365 730a 2020 2020 2020 2020 2020 2020  ses.            
-0001ce40: 6068 7366 732e 636c 6965 6e74 2e65 7863  `hsfs.client.exc
-0001ce50: 6570 7469 6f6e 732e 5265 7374 4150 4945  eptions.RestAPIE
-0001ce60: 7272 6f72 602e 0a20 2020 2020 2020 2020  rror`..         
-0001ce70: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
-0001ce80: 6578 6365 7074 696f 6e73 2e46 6561 7475  exceptions.Featu
-0001ce90: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
-0001cea0: 602e 2049 6620 7468 6520 6665 6174 7572  `. If the featur
-0001ceb0: 6520 6772 6f75 7020 646f 6573 206e 6f74  e group does not
-0001cec0: 2068 6176 6520 6048 5544 4960 2074 696d   have `HUDI` tim
-0001ced0: 6520 7472 6176 656c 2066 6f72 6d61 740a  e travel format.
-0001cee0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-0001cef0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001cf00: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
-0001cf10: 6e67 696e 652e 636f 6d6d 6974 5f64 6574  ngine.commit_det
-0001cf20: 6169 6c73 2873 656c 662c 2077 616c 6c63  ails(self, wallc
-0001cf30: 6c6f 636b 5f74 696d 652c 206c 696d 6974  lock_time, limit
-0001cf40: 290a 0a20 2020 2064 6566 2063 6f6d 6d69  )..    def commi
-0001cf50: 745f 6465 6c65 7465 5f72 6563 6f72 6428  t_delete_record(
-0001cf60: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-0001cf70: 2020 2020 2020 2064 656c 6574 655f 6466         delete_df
-0001cf80: 3a20 5479 7065 5661 7228 2270 7973 7061  : TypeVar("pyspa
-0001cf90: 726b 2e73 716c 2e44 6174 6146 7261 6d65  rk.sql.DataFrame
-0001cfa0: 2229 2c20 2023 206e 6f71 613a 2046 3832  "),  # noqa: F82
-0001cfb0: 310a 2020 2020 2020 2020 7772 6974 655f  1.        write_
-0001cfc0: 6f70 7469 6f6e 733a 204f 7074 696f 6e61  options: Optiona
-0001cfd0: 6c5b 4469 6374 5b41 6e79 2c20 416e 795d  l[Dict[Any, Any]
-0001cfe0: 5d20 3d20 7b7d 2c0a 2020 2020 293a 0a20  ] = {},.    ):. 
-0001cff0: 2020 2020 2020 2022 2222 4472 6f70 7320         """Drops 
-0001d000: 7265 636f 7264 7320 7072 6573 656e 7420  records present 
-0001d010: 696e 2074 6865 2070 726f 7669 6465 6420  in the provided 
-0001d020: 4461 7461 4672 616d 6520 616e 6420 636f  DataFrame and co
-0001d030: 6d6d 6974 7320 6974 2061 7320 7570 6461  mmits it as upda
-0001d040: 7465 2074 6f20 7468 6973 0a20 2020 2020  te to this.     
-0001d050: 2020 2046 6561 7475 7265 2067 726f 7570     Feature group
-0001d060: 2e20 5468 6973 206d 6574 686f 6420 6361  . This method ca
-0001d070: 6e20 6f6e 6c79 2062 6520 7573 6564 206f  n only be used o
-0001d080: 6e20 6665 6174 7572 6520 6772 6f75 7073  n feature groups
-0001d090: 2073 746f 7265 6420 6173 2048 5544 4920   stored as HUDI 
-0001d0a0: 6f72 2044 454c 5441 2e0a 0a20 2020 2020  or DELTA...     
-0001d0b0: 2020 2023 2041 7267 756d 656e 7473 0a20     # Arguments. 
-0001d0c0: 2020 2020 2020 2020 2020 2064 656c 6574             delet
-0001d0d0: 655f 6466 3a20 6461 7461 4672 616d 6520  e_df: dataFrame 
-0001d0e0: 636f 6e74 6169 6e69 6e67 2072 6563 6f72  containing recor
-0001d0f0: 6473 2074 6f20 6265 2064 656c 6574 6564  ds to be deleted
-0001d100: 2e0a 2020 2020 2020 2020 2020 2020 7772  ..            wr
-0001d110: 6974 655f 6f70 7469 6f6e 733a 2055 7365  ite_options: Use
-0001d120: 7220 7072 6f76 6964 6564 2077 7269 7465  r provided write
-0001d130: 206f 7074 696f 6e73 2e20 4465 6661 756c   options. Defaul
-0001d140: 7473 2074 6f20 607b 7d60 2e0a 0a20 2020  ts to `{}`...   
-0001d150: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
-0001d160: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
-0001d170: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
-0001d180: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
-0001d190: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
-0001d1a0: 2020 2020 2073 656c 662e 5f66 6561 7475       self._featu
-0001d1b0: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
-0001d1c0: 636f 6d6d 6974 5f64 656c 6574 6528 7365  commit_delete(se
-0001d1d0: 6c66 2c20 6465 6c65 7465 5f64 662c 2077  lf, delete_df, w
-0001d1e0: 7269 7465 5f6f 7074 696f 6e73 290a 0a20  rite_options).. 
-0001d1f0: 2020 2064 6566 2061 735f 6f66 280a 2020     def as_of(.  
-0001d200: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-0001d210: 2020 2020 7761 6c6c 636c 6f63 6b5f 7469      wallclock_ti
-0001d220: 6d65 3a20 4f70 7469 6f6e 616c 5b55 6e69  me: Optional[Uni
-0001d230: 6f6e 5b73 7472 2c20 696e 742c 2064 6174  on[str, int, dat
-0001d240: 6574 696d 652c 2064 6174 655d 5d20 3d20  etime, date]] = 
-0001d250: 4e6f 6e65 2c0a 2020 2020 2020 2020 6578  None,.        ex
-0001d260: 636c 7564 655f 756e 7469 6c3a 204f 7074  clude_until: Opt
-0001d270: 696f 6e61 6c5b 556e 696f 6e5b 7374 722c  ional[Union[str,
-0001d280: 2069 6e74 2c20 6461 7465 7469 6d65 2c20   int, datetime, 
-0001d290: 6461 7465 5d5d 203d 204e 6f6e 652c 0a20  date]] = None,. 
-0001d2a0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0001d2b0: 2247 6574 2051 7565 7279 206f 626a 6563  "Get Query objec
-0001d2c0: 7420 746f 2072 6574 7269 6576 6520 616c  t to retrieve al
-0001d2d0: 6c20 6665 6174 7572 6573 206f 6620 7468  l features of th
-0001d2e0: 6520 6772 6f75 7020 6174 2061 2070 6f69  e group at a poi
-0001d2f0: 6e74 2069 6e20 7468 6520 7061 7374 2e0a  nt in the past..
-0001d300: 0a20 2020 2020 2020 2054 6869 7320 6d65  .        This me
-0001d310: 7468 6f64 2073 656c 6563 7473 2061 6c6c  thod selects all
-0001d320: 2066 6561 7475 7265 7320 696e 2074 6865   features in the
-0001d330: 2066 6561 7475 7265 2067 726f 7570 2061   feature group a
-0001d340: 6e64 2072 6574 7572 6e73 2061 2051 7565  nd returns a Que
-0001d350: 7279 206f 626a 6563 740a 2020 2020 2020  ry object.      
-0001d360: 2020 6174 2074 6865 2073 7065 6369 6669    at the specifi
-0001d370: 6564 2070 6f69 6e74 2069 6e20 7469 6d65  ed point in time
-0001d380: 2e20 4f70 7469 6f6e 616c 6c79 2c20 636f  . Optionally, co
-0001d390: 6d6d 6974 7320 6265 666f 7265 2061 2073  mmits before a s
-0001d3a0: 7065 6369 6669 6564 2070 6f69 6e74 2069  pecified point i
-0001d3b0: 6e20 7469 6d65 2063 616e 2062 650a 2020  n time can be.  
-0001d3c0: 2020 2020 2020 6578 636c 7564 6564 2066        excluded f
-0001d3d0: 726f 6d20 7468 6520 7175 6572 792e 2054  rom the query. T
-0001d3e0: 6865 2051 7565 7279 2063 616e 2074 6865  he Query can the
-0001d3f0: 6e20 6569 7468 6572 2062 6520 7265 6164  n either be read
-0001d400: 2069 6e74 6f20 6120 4461 7461 6672 616d   into a Datafram
-0001d410: 650a 2020 2020 2020 2020 6f72 2075 7365  e.        or use
-0001d420: 6420 6675 7274 6865 7220 746f 2070 6572  d further to per
-0001d430: 666f 726d 206a 6f69 6e73 206f 7220 636f  form joins or co
-0001d440: 6e73 7472 7563 7420 6120 7472 6169 6e69  nstruct a traini
-0001d450: 6e67 2064 6174 6173 6574 2e0a 0a20 2020  ng dataset...   
-0001d460: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
-0001d470: 2022 5265 6164 696e 6720 6665 6174 7572   "Reading featur
-0001d480: 6573 2061 7420 6120 7370 6563 6966 6963  es at a specific
-0001d490: 2070 6f69 6e74 2069 6e20 7469 6d65 3a22   point in time:"
-0001d4a0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-0001d4b0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-0001d4c0: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
-0001d4d0: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
-0001d4e0: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
-0001d4f0: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
-0001d500: 2020 2020 2320 6765 7420 7468 6520 4665      # get the Fe
-0001d510: 6174 7572 6520 4772 6f75 7020 696e 7374  ature Group inst
-0001d520: 616e 6365 0a20 2020 2020 2020 2020 2020  ance.           
-0001d530: 2066 6720 3d20 6673 2e67 6574 5f6f 725f   fg = fs.get_or_
-0001d540: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-0001d550: 726f 7570 282e 2e2e 290a 0a20 2020 2020  roup(...)..     
-0001d560: 2020 2020 2020 2023 2067 6574 2064 6174         # get dat
-0001d570: 6120 6174 2061 2073 7065 6369 6669 6320  a at a specific 
-0001d580: 706f 696e 7420 696e 2074 696d 6520 616e  point in time an
-0001d590: 6420 7368 6f77 2069 740a 2020 2020 2020  d show it.      
-0001d5a0: 2020 2020 2020 6667 2e61 735f 6f66 2822        fg.as_of("
-0001d5b0: 3230 3230 2d31 302d 3230 2030 373a 3334  2020-10-20 07:34
-0001d5c0: 3a31 3122 292e 7265 6164 2829 2e73 686f  :11").read().sho
-0001d5d0: 7728 290a 2020 2020 2020 2020 2020 2020  w().            
-0001d5e0: 6060 600a 0a20 2020 2020 2020 2021 2121  ```..        !!!
-0001d5f0: 2065 7861 6d70 6c65 2022 5265 6164 696e   example "Readin
-0001d600: 6720 636f 6d6d 6974 7320 696e 6372 656d  g commits increm
-0001d610: 656e 7461 6c6c 7920 6265 7477 6565 6e20  entally between 
-0001d620: 7370 6563 6966 6965 6420 706f 696e 7473  specified points
-0001d630: 2069 6e20 7469 6d65 3a22 0a20 2020 2020   in time:".     
-0001d640: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
-0001d650: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
-0001d660: 6173 5f6f 6628 2232 3032 302d 3130 2d32  as_of("2020-10-2
-0001d670: 3020 3037 3a33 343a 3131 222c 2065 7863  0 07:34:11", exc
-0001d680: 6c75 6465 5f75 6e74 696c 3d22 3230 3230  lude_until="2020
-0001d690: 2d31 302d 3139 2030 373a 3334 3a31 3122  -10-19 07:34:11"
-0001d6a0: 292e 7265 6164 2829 2e73 686f 7728 290a  ).read().show().
-0001d6b0: 2020 2020 2020 2020 2020 2020 6060 600a              ```.
-0001d6c0: 0a20 2020 2020 2020 2054 6865 2066 6972  .        The fir
-0001d6d0: 7374 2070 6172 616d 6574 6572 2069 7320  st parameter is 
-0001d6e0: 696e 636c 7573 6976 6520 7768 696c 6520  inclusive while 
-0001d6f0: 7468 6520 6c61 7474 6572 2069 7320 6578  the latter is ex
-0001d700: 636c 7573 6976 652e 0a20 2020 2020 2020  clusive..       
-0001d710: 2054 6861 7420 6d65 616e 732c 2069 6e20   That means, in 
-0001d720: 6f72 6465 7220 746f 2071 7565 7279 2061  order to query a
-0001d730: 2073 696e 676c 6520 636f 6d6d 6974 2c20   single commit, 
-0001d740: 796f 7520 6e65 6564 2074 6f20 7175 6572  you need to quer
-0001d750: 7920 7468 6174 2063 6f6d 6d69 7420 7469  y that commit ti
-0001d760: 6d65 0a20 2020 2020 2020 2061 6e64 2065  me.        and e
-0001d770: 7863 6c75 6465 2065 7665 7279 7468 696e  xclude everythin
-0001d780: 6720 6a75 7374 2062 6566 6f72 6520 7468  g just before th
-0001d790: 6520 636f 6d6d 6974 2e0a 0a20 2020 2020  e commit...     
-0001d7a0: 2020 2021 2121 2065 7861 6d70 6c65 2022     !!! example "
-0001d7b0: 5265 6164 696e 6720 6f6e 6c79 2074 6865  Reading only the
-0001d7c0: 2063 6861 6e67 6573 2066 726f 6d20 6120   changes from a 
-0001d7d0: 7369 6e67 6c65 2063 6f6d 6d69 7422 0a20  single commit". 
-0001d7e0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
-0001d7f0: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
-0001d800: 2066 672e 6173 5f6f 6628 2232 3032 302d   fg.as_of("2020-
-0001d810: 3130 2d32 3020 3037 3a33 313a 3338 222c  10-20 07:31:38",
-0001d820: 2065 7863 6c75 6465 5f75 6e74 696c 3d22   exclude_until="
-0001d830: 3230 3230 2d31 302d 3230 2030 373a 3331  2020-10-20 07:31
-0001d840: 3a33 3722 292e 7265 6164 2829 2e73 686f  :37").read().sho
-0001d850: 7728 290a 2020 2020 2020 2020 2020 2020  w().            
-0001d860: 6060 600a 0a20 2020 2020 2020 2057 6865  ```..        Whe
-0001d870: 6e20 6e6f 2077 616c 6c63 6c6f 636b 5f74  n no wallclock_t
-0001d880: 696d 6520 6973 2067 6976 656e 2c20 7468  ime is given, th
-0001d890: 6520 6c61 7465 7374 2073 7461 7465 206f  e latest state o
-0001d8a0: 6620 6665 6174 7572 6573 2069 7320 7265  f features is re
-0001d8b0: 7475 726e 6564 2e20 4f70 7469 6f6e 616c  turned. Optional
-0001d8c0: 6c79 2c20 636f 6d6d 6974 7320 6265 666f  ly, commits befo
-0001d8d0: 7265 0a20 2020 2020 2020 2061 2073 7065  re.        a spe
-0001d8e0: 6369 6669 6564 2070 6f69 6e74 2069 6e20  cified point in 
-0001d8f0: 7469 6d65 2063 616e 2073 7469 6c6c 2062  time can still b
-0001d900: 6520 6578 636c 7564 6564 2e0a 0a20 2020  e excluded...   
-0001d910: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
-0001d920: 2022 5265 6164 696e 6720 7468 6520 6c61   "Reading the la
-0001d930: 7465 7374 2073 7461 7465 206f 6620 6665  test state of fe
-0001d940: 6174 7572 6573 2c20 6578 636c 7564 696e  atures, excludin
-0001d950: 6720 636f 6d6d 6974 7320 6265 666f 7265  g commits before
-0001d960: 2061 2073 7065 6369 6669 6564 2070 6f69   a specified poi
-0001d970: 6e74 2069 6e20 7469 6d65 3a22 0a20 2020  nt in time:".   
-0001d980: 2020 2020 2020 2020 2060 6060 7079 7468           ```pyth
-0001d990: 6f6e 0a20 2020 2020 2020 2020 2020 2066  on.            f
-0001d9a0: 672e 6173 5f6f 6628 4e6f 6e65 2c20 6578  g.as_of(None, ex
-0001d9b0: 636c 7564 655f 756e 7469 6c3d 2232 3032  clude_until="202
-0001d9c0: 302d 3130 2d32 3020 3037 3a33 313a 3338  0-10-20 07:31:38
-0001d9d0: 2229 2e72 6561 6428 292e 7368 6f77 2829  ").read().show()
-0001d9e0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-0001d9f0: 0a0a 2020 2020 2020 2020 4e6f 7465 2074  ..        Note t
-0001da00: 6861 7420 7468 6520 696e 7465 7276 616c  hat the interval
-0001da10: 2077 696c 6c20 6265 2061 7070 6c69 6564   will be applied
-0001da20: 2074 6f20 616c 6c20 6a6f 696e 7320 696e   to all joins in
-0001da30: 2074 6865 2071 7565 7279 2e0a 2020 2020   the query..    
-0001da40: 2020 2020 4966 2079 6f75 2077 616e 7420      If you want 
-0001da50: 746f 2071 7565 7279 2064 6966 6665 7265  to query differe
-0001da60: 6e74 2069 6e74 6572 7661 6c73 2066 6f72  nt intervals for
-0001da70: 2064 6966 6665 7265 6e74 2066 6561 7475   different featu
-0001da80: 7265 2067 726f 7570 7320 696e 0a20 2020  re groups in.   
-0001da90: 2020 2020 2074 6865 2071 7565 7279 2c20       the query, 
-0001daa0: 796f 7520 6861 7665 2074 6f20 6170 706c  you have to appl
-0001dab0: 7920 7468 656d 2069 6e20 6120 6e65 7374  y them in a nest
-0001dac0: 6564 2066 6173 6869 6f6e 3a0a 2020 2020  ed fashion:.    
-0001dad0: 2020 2020 2121 2120 6578 616d 706c 650a      !!! example.
-0001dae0: 2020 2020 2020 2020 2020 2020 6060 6070              ```p
-0001daf0: 7974 686f 6e0a 2020 2020 2020 2020 2020  ython.          
-0001db00: 2020 2320 636f 6e6e 6563 7420 746f 2074    # connect to t
-0001db10: 6865 2046 6561 7475 7265 2053 746f 7265  he Feature Store
-0001db20: 0a20 2020 2020 2020 2020 2020 2066 7320  .            fs 
-0001db30: 3d20 2e2e 2e0a 0a20 2020 2020 2020 2020  = .....         
-0001db40: 2020 2023 2067 6574 2074 6865 2046 6561     # get the Fea
-0001db50: 7475 7265 2047 726f 7570 2069 6e73 7461  ture Group insta
-0001db60: 6e63 650a 2020 2020 2020 2020 2020 2020  nce.            
-0001db70: 6667 3120 3d20 6673 2e67 6574 5f6f 725f  fg1 = fs.get_or_
-0001db80: 6372 6561 7465 5f66 6561 7475 7265 5f67  create_feature_g
-0001db90: 726f 7570 282e 2e2e 290a 2020 2020 2020  roup(...).      
-0001dba0: 2020 2020 2020 6667 3220 3d20 6673 2e67        fg2 = fs.g
-0001dbb0: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
-0001dbc0: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
-0001dbd0: 0a20 2020 2020 2020 2020 2020 2066 6731  .            fg1
-0001dbe0: 2e73 656c 6563 745f 616c 6c28 292e 6173  .select_all().as
-0001dbf0: 5f6f 6628 2232 3032 302d 3130 2d32 3022  _of("2020-10-20"
-0001dc00: 2c20 6578 636c 7564 655f 756e 7469 6c3d  , exclude_until=
-0001dc10: 2232 3032 302d 3130 2d31 3922 290a 2020  "2020-10-19").  
-0001dc20: 2020 2020 2020 2020 2020 2020 2020 2e6a                .j
-0001dc30: 6f69 6e28 6667 322e 7365 6c65 6374 5f61  oin(fg2.select_a
-0001dc40: 6c6c 2829 2e61 735f 6f66 2822 3230 3230  ll().as_of("2020
-0001dc50: 2d31 302d 3230 222c 2065 7863 6c75 6465  -10-20", exclude
-0001dc60: 5f75 6e74 696c 3d22 3230 3230 2d31 302d  _until="2020-10-
-0001dc70: 3139 2229 290a 2020 2020 2020 2020 2020  19")).          
-0001dc80: 2020 6060 600a 0a20 2020 2020 2020 2049    ```..        I
-0001dc90: 6620 696e 7374 6561 6420 796f 7520 6170  f instead you ap
-0001dca0: 706c 7920 616e 6f74 6865 7220 6061 735f  ply another `as_
-0001dcb0: 6f66 6020 7365 6c65 6374 696f 6e20 6166  of` selection af
-0001dcc0: 7465 7220 7468 6520 6a6f 696e 2c20 616c  ter the join, al
-0001dcd0: 6c0a 2020 2020 2020 2020 6a6f 696e 6564  l.        joined
-0001dce0: 2066 6561 7475 7265 2067 726f 7570 7320   feature groups 
-0001dcf0: 7769 6c6c 2062 6520 7175 6572 6965 6420  will be queried 
-0001dd00: 7769 7468 2074 6869 7320 696e 7465 7276  with this interv
-0001dd10: 616c 3a0a 2020 2020 2020 2020 2121 2120  al:.        !!! 
-0001dd20: 6578 616d 706c 650a 2020 2020 2020 2020  example.        
-0001dd30: 2020 2020 6060 6070 7974 686f 6e0a 2020      ```python.  
-0001dd40: 2020 2020 2020 2020 2020 6667 312e 7365            fg1.se
-0001dd50: 6c65 6374 5f61 6c6c 2829 2e61 735f 6f66  lect_all().as_of
-0001dd60: 2822 3230 3230 2d31 302d 3230 222c 2065  ("2020-10-20", e
-0001dd70: 7863 6c75 6465 5f75 6e74 696c 3d22 3230  xclude_until="20
-0001dd80: 3230 2d31 302d 3139 2229 2020 2320 6173  20-10-19")  # as
-0001dd90: 5f6f 6620 6973 206e 6f74 2061 7070 6c69  _of is not appli
-0001dda0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-0001ddb0: 2020 202e 6a6f 696e 2866 6732 2e73 656c     .join(fg2.sel
-0001ddc0: 6563 745f 616c 6c28 292e 6173 5f6f 6628  ect_all().as_of(
-0001ddd0: 2232 3032 302d 3130 2d32 3022 2c20 6578  "2020-10-20", ex
-0001dde0: 636c 7564 655f 756e 7469 6c3d 2232 3032  clude_until="202
-0001ddf0: 302d 3130 2d31 3522 2929 2020 2320 6173  0-10-15"))  # as
-0001de00: 5f6f 6620 6973 206e 6f74 2061 7070 6c69  _of is not appli
-0001de10: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
-0001de20: 2020 202e 6173 5f6f 6628 2232 3032 302d     .as_of("2020-
-0001de30: 3130 2d32 3022 2c20 6578 636c 7564 655f  10-20", exclude_
-0001de40: 756e 7469 6c3d 2232 3032 302d 3130 2d31  until="2020-10-1
-0001de50: 3922 290a 2020 2020 2020 2020 2020 2020  9").            
-0001de60: 6060 600a 0a20 2020 2020 2020 2021 2121  ```..        !!!
-0001de70: 2077 6172 6e69 6e67 0a20 2020 2020 2020   warning.       
-0001de80: 2020 2020 2054 6869 7320 6675 6e63 7469       This functi
-0001de90: 6f6e 206f 6e6c 7920 776f 726b 7320 666f  on only works fo
-0001dea0: 7220 6665 6174 7572 6520 6772 6f75 7073  r feature groups
-0001deb0: 2077 6974 6820 7469 6d65 5f74 7261 7665   with time_trave
-0001dec0: 6c5f 666f 726d 6174 3d27 4855 4449 272e  l_format='HUDI'.
-0001ded0: 0a0a 2020 2020 2020 2020 2121 2120 7761  ..        !!! wa
-0001dee0: 726e 696e 670a 2020 2020 2020 2020 2020  rning.          
-0001def0: 2020 4578 636c 7564 696e 6720 636f 6d6d    Excluding comm
-0001df00: 6974 7320 7669 6120 6578 636c 7564 655f  its via exclude_
-0001df10: 756e 7469 6c20 6973 206f 6e6c 7920 706f  until is only po
-0001df20: 7373 6962 6c65 2077 6974 6869 6e20 7468  ssible within th
-0001df30: 6520 7261 6e67 6520 6f66 2074 6865 2048  e range of the H
-0001df40: 7564 6920 6163 7469 7665 2074 696d 656c  udi active timel
-0001df50: 696e 652e 0a20 2020 2020 2020 2020 2020  ine..           
-0001df60: 2042 7920 6465 6661 756c 742c 2048 7564   By default, Hud
-0001df70: 6920 6b65 6570 7320 7468 6520 6c61 7374  i keeps the last
-0001df80: 2032 3020 746f 2033 3020 636f 6d6d 6974   20 to 30 commit
-0001df90: 7320 696e 2074 6865 2061 6374 6976 6520  s in the active 
-0001dfa0: 7469 6d65 6c69 6e65 2e0a 2020 2020 2020  timeline..      
-0001dfb0: 2020 2020 2020 4966 2079 6f75 206e 6565        If you nee
-0001dfc0: 6420 746f 206b 6565 7020 6120 6c6f 6e67  d to keep a long
-0001dfd0: 6572 2061 6374 6976 6520 7469 6d65 6c69  er active timeli
-0001dfe0: 6e65 2c20 796f 7520 6361 6e20 6f76 6572  ne, you can over
-0001dff0: 7772 6974 6520 7468 6520 6f70 7469 6f6e  write the option
-0001e000: 733a 0a20 2020 2020 2020 2020 2020 2060  s:.            `
-0001e010: 686f 6f64 6965 2e6b 6565 702e 6d69 6e2e  hoodie.keep.min.
-0001e020: 636f 6d6d 6974 7360 2061 6e64 2060 686f  commits` and `ho
-0001e030: 6f64 6965 2e6b 6565 702e 6d61 782e 636f  odie.keep.max.co
-0001e040: 6d6d 6974 7360 0a20 2020 2020 2020 2020  mmits`.         
-0001e050: 2020 2077 6865 6e20 6361 6c6c 696e 6720     when calling 
-0001e060: 7468 6520 6069 6e73 6572 7428 2960 206d  the `insert()` m
-0001e070: 6574 686f 642e 0a0a 2020 2020 2020 2020  ethod...        
-0001e080: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
-0001e090: 2020 2020 2020 2020 7761 6c6c 636c 6f63          wallcloc
-0001e0a0: 6b5f 7469 6d65 3a20 5265 6164 2064 6174  k_time: Read dat
-0001e0b0: 6120 6173 206f 6620 7468 6973 2070 6f69  a as of this poi
-0001e0c0: 6e74 2069 6e20 7469 6d65 2e20 5374 7269  nt in time. Stri
-0001e0d0: 6e67 7320 7368 6f75 6c64 2062 6520 666f  ngs should be fo
-0001e0e0: 726d 6174 7465 6420 696e 206f 6e65 206f  rmatted in one o
-0001e0f0: 6620 7468 650a 2020 2020 2020 2020 2020  f the.          
-0001e100: 2020 2020 2020 666f 6c6c 6f77 696e 6720        following 
-0001e110: 666f 726d 6174 7320 6025 592d 256d 2d25  formats `%Y-%m-%
-0001e120: 6460 2c20 6025 592d 256d 2d25 6420 2548  d`, `%Y-%m-%d %H
-0001e130: 602c 2060 2559 2d25 6d2d 2564 2025 483a  `, `%Y-%m-%d %H:
-0001e140: 254d 602c 206f 7220 6025 592d 256d 2d25  %M`, or `%Y-%m-%
-0001e150: 6420 2548 3a25 4d3a 2553 602e 0a20 2020  d %H:%M:%S`..   
-0001e160: 2020 2020 2020 2020 2065 7863 6c75 6465           exclude
-0001e170: 5f75 6e74 696c 3a20 4578 636c 7564 6520  _until: Exclude 
-0001e180: 636f 6d6d 6974 7320 756e 7469 6c20 7468  commits until th
-0001e190: 6973 2070 6f69 6e74 2069 6e20 7469 6d65  is point in time
-0001e1a0: 2e20 5374 7269 6e67 2073 686f 756c 6420  . String should 
-0001e1b0: 6265 2066 6f72 6d61 7474 6564 2069 6e20  be formatted in 
-0001e1c0: 6f6e 6520 6f66 2074 6865 0a20 2020 2020  one of the.     
-0001e1d0: 2020 2020 2020 2020 2020 2066 6f6c 6c6f             follo
-0001e1e0: 7769 6e67 2066 6f72 6d61 7473 2060 2559  wing formats `%Y
-0001e1f0: 2d25 6d2d 2564 602c 2060 2559 2d25 6d2d  -%m-%d`, `%Y-%m-
-0001e200: 2564 2025 4860 2c20 6025 592d 256d 2d25  %d %H`, `%Y-%m-%
-0001e210: 6420 2548 3a25 4d60 2c20 6f72 2060 2559  d %H:%M`, or `%Y
-0001e220: 2d25 6d2d 2564 2025 483a 254d 3a25 5360  -%m-%d %H:%M:%S`
-0001e230: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
-0001e240: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
-0001e250: 2060 5175 6572 7960 2e20 5468 6520 7175   `Query`. The qu
-0001e260: 6572 7920 6f62 6a65 6374 2077 6974 6820  ery object with 
-0001e270: 7468 6520 6170 706c 6965 6420 7469 6d65  the applied time
-0001e280: 2074 7261 7665 6c20 636f 6e64 6974 696f   travel conditio
-0001e290: 6e2e 0a20 2020 2020 2020 2022 2222 0a20  n..        """. 
-0001e2a0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001e2b0: 6c66 2e73 656c 6563 745f 616c 6c28 292e  lf.select_all().
-0001e2c0: 6173 5f6f 6628 0a20 2020 2020 2020 2020  as_of(.         
-0001e2d0: 2020 2077 616c 6c63 6c6f 636b 5f74 696d     wallclock_tim
-0001e2e0: 653d 7761 6c6c 636c 6f63 6b5f 7469 6d65  e=wallclock_time
-0001e2f0: 2c20 6578 636c 7564 655f 756e 7469 6c3d  , exclude_until=
-0001e300: 6578 636c 7564 655f 756e 7469 6c0a 2020  exclude_until.  
-0001e310: 2020 2020 2020 290a 0a20 2020 2064 6566        )..    def
-0001e320: 2067 6574 5f73 7461 7469 7374 6963 735f   get_statistics_
-0001e330: 6279 5f63 6f6d 6d69 745f 7769 6e64 6f77  by_commit_window
-0001e340: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
-0001e350: 2020 2020 2020 2020 6672 6f6d 5f63 6f6d          from_com
-0001e360: 6d69 745f 7469 6d65 3a20 4f70 7469 6f6e  mit_time: Option
-0001e370: 616c 5b55 6e69 6f6e 5b73 7472 2c20 696e  al[Union[str, in
-0001e380: 742c 2064 6174 6574 696d 652c 2064 6174  t, datetime, dat
-0001e390: 655d 5d20 3d20 4e6f 6e65 2c0a 2020 2020  e]] = None,.    
-0001e3a0: 2020 2020 746f 5f63 6f6d 6d69 745f 7469      to_commit_ti
-0001e3b0: 6d65 3a20 4f70 7469 6f6e 616c 5b55 6e69  me: Optional[Uni
-0001e3c0: 6f6e 5b73 7472 2c20 696e 742c 2064 6174  on[str, int, dat
-0001e3d0: 6574 696d 652c 2064 6174 655d 5d20 3d20  etime, date]] = 
-0001e3e0: 4e6f 6e65 2c0a 2020 2020 2020 2020 6665  None,.        fe
-0001e3f0: 6174 7572 655f 6e61 6d65 733a 204f 7074  ature_names: Opt
-0001e400: 696f 6e61 6c5b 4c69 7374 5b73 7472 5d5d  ional[List[str]]
-0001e410: 203d 204e 6f6e 652c 0a20 2020 2029 3a0a   = None,.    ):.
-0001e420: 2020 2020 2020 2020 2222 2252 6574 7572          """Retur
-0001e430: 6e73 2074 6865 2073 7461 7469 7374 6963  ns the statistic
-0001e440: 7320 636f 6d70 7574 6564 206f 6e20 6120  s computed on a 
-0001e450: 7370 6563 6966 6963 2063 6f6d 6d69 7420  specific commit 
-0001e460: 7769 6e64 6f77 2066 6f72 2074 6869 7320  window for this 
-0001e470: 6665 6174 7572 6520 6772 6f75 702e 2049  feature group. I
-0001e480: 6620 7469 6d65 2074 7261 7665 6c20 6973  f time travel is
-0001e490: 206e 6f74 2065 6e61 626c 6564 2c20 6974   not enabled, it
-0001e4a0: 2072 6169 7365 7320 616e 2065 7863 6570   raises an excep
-0001e4b0: 7469 6f6e 2e0a 0a20 2020 2020 2020 2049  tion...        I
-0001e4c0: 6620 6066 726f 6d5f 636f 6d6d 6974 5f74  f `from_commit_t
-0001e4d0: 696d 6560 2069 7320 604e 6f6e 6560 2c20  ime` is `None`, 
-0001e4e0: 7468 6520 636f 6d6d 6974 2077 696e 646f  the commit windo
-0001e4f0: 7720 7374 6172 7473 2066 726f 6d20 7468  w starts from th
-0001e500: 6520 6669 7273 7420 636f 6d6d 6974 2e0a  e first commit..
-0001e510: 2020 2020 2020 2020 4966 2060 746f 5f63          If `to_c
-0001e520: 6f6d 6d69 745f 7469 6d65 6020 6973 2060  ommit_time` is `
-0001e530: 4e6f 6e65 602c 2074 6865 2063 6f6d 6d69  None`, the commi
-0001e540: 7420 7769 6e64 6f77 2065 6e64 7320 6174  t window ends at
-0001e550: 2074 6865 206c 6173 7420 636f 6d6d 6974   the last commit
-0001e560: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
-0001e570: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
-0001e580: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-0001e590: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
-0001e5a0: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
-0001e5b0: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
-0001e5c0: 2020 2020 6673 203d 202e 2e2e 0a20 2020      fs = ....   
-0001e5d0: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-0001e5e0: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-0001e5f0: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-0001e600: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
-0001e610: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
-0001e620: 7572 655f 6772 6f75 7028 2e2e 2e29 0a20  ure_group(...). 
-0001e630: 2020 2020 2020 2020 2020 2066 675f 7374             fg_st
-0001e640: 6174 6973 7469 6373 203d 2066 672e 6765  atistics = fg.ge
-0001e650: 745f 7374 6174 6973 7469 6373 5f62 795f  t_statistics_by_
-0001e660: 636f 6d6d 6974 5f77 696e 646f 7728 6672  commit_window(fr
-0001e670: 6f6d 5f63 6f6d 6d69 745f 7469 6d65 3d4e  om_commit_time=N
-0001e680: 6f6e 652c 2074 6f5f 636f 6d6d 6974 5f74  one, to_commit_t
-0001e690: 696d 653d 4e6f 6e65 290a 2020 2020 2020  ime=None).      
-0001e6a0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-0001e6b0: 2020 2320 4172 6775 6d65 6e74 730a 2020    # Arguments.  
-0001e6c0: 2020 2020 2020 2020 2020 746f 5f63 6f6d            to_com
-0001e6d0: 6d69 745f 7469 6d65 3a20 4461 7465 2061  mit_time: Date a
-0001e6e0: 6e64 2074 696d 6520 6f66 2074 6865 206c  nd time of the l
-0001e6f0: 6173 7420 636f 6d6d 6974 206f 6620 7468  ast commit of th
-0001e700: 6520 7769 6e64 6f77 2e20 4465 6661 756c  e window. Defaul
-0001e710: 7473 2074 6f20 604e 6f6e 6560 2e20 5374  ts to `None`. St
-0001e720: 7269 6e67 7320 7368 6f75 6c64 0a20 2020  rings should.   
-0001e730: 2020 2020 2020 2020 2020 2020 2062 6520               be 
-0001e740: 666f 726d 6174 7465 6420 696e 206f 6e65  formatted in one
-0001e750: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
-0001e760: 6720 666f 726d 6174 7320 6025 592d 256d  g formats `%Y-%m
-0001e770: 2d25 6460 2c20 6025 592d 256d 2d25 6420  -%d`, `%Y-%m-%d 
-0001e780: 2548 602c 2060 2559 2d25 6d2d 2564 2025  %H`, `%Y-%m-%d %
-0001e790: 483a 254d 602c 2060 2559 2d25 6d2d 2564  H:%M`, `%Y-%m-%d
-0001e7a0: 2025 483a 254d 3a25 5360 2c0a 2020 2020   %H:%M:%S`,.    
-0001e7b0: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
-0001e7c0: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
-0001e7d0: 532e 2566 602e 0a20 2020 2020 2020 2020  S.%f`..         
-0001e7e0: 2020 2066 726f 6d5f 636f 6d6d 6974 5f74     from_commit_t
-0001e7f0: 696d 653a 2044 6174 6520 616e 6420 7469  ime: Date and ti
-0001e800: 6d65 206f 6620 7468 6520 6669 7273 7420  me of the first 
-0001e810: 636f 6d6d 6974 206f 6620 7468 6520 7769  commit of the wi
-0001e820: 6e64 6f77 2e20 4465 6661 756c 7473 2074  ndow. Defaults t
-0001e830: 6f20 604e 6f6e 6560 2e20 5374 7269 6e67  o `None`. String
-0001e840: 7320 7368 6f75 6c64 0a20 2020 2020 2020  s should.       
-0001e850: 2020 2020 2020 2020 2062 6520 666f 726d           be form
-0001e860: 6174 7465 6420 696e 206f 6e65 206f 6620  atted in one of 
-0001e870: 7468 6520 666f 6c6c 6f77 696e 6720 666f  the following fo
-0001e880: 726d 6174 7320 6025 592d 256d 2d25 6460  rmats `%Y-%m-%d`
-0001e890: 2c20 6025 592d 256d 2d25 6420 2548 602c  , `%Y-%m-%d %H`,
-0001e8a0: 2060 2559 2d25 6d2d 2564 2025 483a 254d   `%Y-%m-%d %H:%M
-0001e8b0: 602c 2060 2559 2d25 6d2d 2564 2025 483a  `, `%Y-%m-%d %H:
-0001e8c0: 254d 3a25 5360 2c0a 2020 2020 2020 2020  %M:%S`,.        
-0001e8d0: 2020 2020 2020 2020 6f72 2060 2559 2d25          or `%Y-%
-0001e8e0: 6d2d 2564 2025 483a 254d 3a25 532e 2566  m-%d %H:%M:%S.%f
-0001e8f0: 602e 0a20 2020 2020 2020 2020 2020 2066  `..            f
-0001e900: 6561 7475 7265 5f6e 616d 6573 3a20 4c69  eature_names: Li
-0001e910: 7374 206f 6620 6665 6174 7572 6520 6e61  st of feature na
-0001e920: 6d65 7320 6f66 2077 6869 6368 2073 7461  mes of which sta
-0001e930: 7469 7374 6963 7320 6172 6520 7265 7472  tistics are retr
-0001e940: 6965 7665 642e 0a20 2020 2020 2020 2023  ieved..        #
-0001e950: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
-0001e960: 2020 2020 2060 5374 6174 6973 7469 6373       `Statistics
-0001e970: 602e 2053 7461 7469 7374 6963 7320 6f62  `. Statistics ob
-0001e980: 6a65 6374 2e0a 2020 2020 2020 2020 2320  ject..        # 
-0001e990: 5261 6973 6573 0a20 2020 2020 2020 2020  Raises.         
-0001e9a0: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
-0001e9b0: 6578 6365 7074 696f 6e73 2e52 6573 7441  exceptions.RestA
-0001e9c0: 5049 4572 726f 7260 2e0a 2020 2020 2020  PIError`..      
-0001e9d0: 2020 2222 220a 2020 2020 2020 2020 6966    """.        if
-0001e9e0: 206e 6f74 2073 656c 662e 5f69 735f 7469   not self._is_ti
-0001e9f0: 6d65 5f74 7261 7665 6c5f 656e 6162 6c65  me_travel_enable
-0001ea00: 6428 293a 0a20 2020 2020 2020 2020 2020  d():.           
-0001ea10: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-0001ea20: 7228 2254 696d 6520 7472 6176 656c 2069  r("Time travel i
-0001ea30: 7320 6e6f 7420 656e 6162 6c65 6420 666f  s not enabled fo
-0001ea40: 7220 7468 6973 2066 6561 7475 7265 2067  r this feature g
-0001ea50: 726f 7570 2229 0a20 2020 2020 2020 2072  roup").        r
-0001ea60: 6574 7572 6e20 7365 6c66 2e5f 7374 6174  eturn self._stat
-0001ea70: 6973 7469 6373 5f65 6e67 696e 652e 6765  istics_engine.ge
-0001ea80: 745f 6279 5f74 696d 655f 7769 6e64 6f77  t_by_time_window
-0001ea90: 280a 2020 2020 2020 2020 2020 2020 7365  (.            se
-0001eaa0: 6c66 2c0a 2020 2020 2020 2020 2020 2020  lf,.            
-0001eab0: 7374 6172 745f 636f 6d6d 6974 5f74 696d  start_commit_tim
-0001eac0: 653d 6672 6f6d 5f63 6f6d 6d69 745f 7469  e=from_commit_ti
-0001ead0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
-0001eae0: 656e 645f 636f 6d6d 6974 5f74 696d 653d  end_commit_time=
-0001eaf0: 746f 5f63 6f6d 6d69 745f 7469 6d65 2c0a  to_commit_time,.
-0001eb00: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-0001eb10: 7572 655f 6e61 6d65 733d 6665 6174 7572  ure_names=featur
-0001eb20: 655f 6e61 6d65 732c 0a20 2020 2020 2020  e_names,.       
-0001eb30: 2029 0a0a 2020 2020 6465 6620 636f 6d70   )..    def comp
-0001eb40: 7574 655f 7374 6174 6973 7469 6373 280a  ute_statistics(.
-0001eb50: 2020 2020 2020 2020 7365 6c66 2c20 7761          self, wa
-0001eb60: 6c6c 636c 6f63 6b5f 7469 6d65 3a20 4f70  llclock_time: Op
-0001eb70: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
-0001eb80: 2c20 696e 742c 2064 6174 6574 696d 652c  , int, datetime,
-0001eb90: 2064 6174 655d 5d20 3d20 4e6f 6e65 0a20   date]] = None. 
-0001eba0: 2020 2029 3a0a 2020 2020 2020 2020 2222     ):.        ""
-0001ebb0: 2252 6563 6f6d 7075 7465 2074 6865 2073  "Recompute the s
-0001ebc0: 7461 7469 7374 6963 7320 666f 7220 7468  tatistics for th
-0001ebd0: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
-0001ebe0: 616e 6420 7361 7665 2074 6865 6d20 746f  and save them to
-0001ebf0: 2074 6865 0a20 2020 2020 2020 2066 6561   the.        fea
-0001ec00: 7475 7265 2073 746f 7265 2e0a 0a20 2020  ture store...   
-0001ec10: 2020 2020 2053 7461 7469 7374 6963 7320       Statistics 
-0001ec20: 6172 6520 6f6e 6c79 2063 6f6d 7075 7465  are only compute
-0001ec30: 6420 666f 7220 6461 7461 2069 6e20 7468  d for data in th
-0001ec40: 6520 6f66 666c 696e 6520 7374 6f72 6167  e offline storag
-0001ec50: 6520 6f66 2074 6865 2066 6561 7475 7265  e of the feature
-0001ec60: 0a20 2020 2020 2020 2067 726f 7570 2e0a  .        group..
-0001ec70: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
-0001ec80: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
-0001ec90: 2077 616c 6c63 6c6f 636b 5f74 696d 653a   wallclock_time:
-0001eca0: 2049 6620 7370 6563 6966 6965 6420 7769   If specified wi
-0001ecb0: 6c6c 2072 6563 6f6d 7075 7465 2073 7461  ll recompute sta
-0001ecc0: 7469 7374 6963 7320 6f6e 0a20 2020 2020  tistics on.     
-0001ecd0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-0001ece0: 7265 2067 726f 7570 2061 7320 6f66 2073  re group as of s
-0001ecf0: 7065 6369 6669 6320 706f 696e 7420 696e  pecific point in
-0001ed00: 2074 696d 652e 2049 6620 6e6f 7420 7370   time. If not sp
-0001ed10: 6563 6966 6965 6420 7468 656e 2077 696c  ecified then wil
-0001ed20: 6c20 636f 6d70 7574 6520 7374 6174 6973  l compute statis
-0001ed30: 7469 6373 0a20 2020 2020 2020 2020 2020  tics.           
-0001ed40: 2020 2020 2061 7320 6f66 206d 6f73 7420       as of most 
-0001ed50: 7265 6365 6e74 2074 696d 6520 6f66 2074  recent time of t
-0001ed60: 6869 7320 6665 6174 7572 6520 6772 6f75  his feature grou
-0001ed70: 702e 2044 6566 6175 6c74 7320 746f 2060  p. Defaults to `
-0001ed80: 4e6f 6e65 602e 2053 7472 696e 6773 2073  None`. Strings s
-0001ed90: 686f 756c 640a 2020 2020 2020 2020 2020  hould.          
-0001eda0: 2020 2020 2020 6265 2066 6f72 6d61 7474        be formatt
-0001edb0: 6564 2069 6e20 6f6e 6520 6f66 2074 6865  ed in one of the
-0001edc0: 2066 6f6c 6c6f 7769 6e67 2066 6f72 6d61   following forma
-0001edd0: 7473 2060 2559 2d25 6d2d 2564 602c 2060  ts `%Y-%m-%d`, `
-0001ede0: 2559 2d25 6d2d 2564 2025 4860 2c20 6025  %Y-%m-%d %H`, `%
-0001edf0: 592d 256d 2d25 6420 2548 3a25 4d60 2c20  Y-%m-%d %H:%M`, 
-0001ee00: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
-0001ee10: 2553 602c 0a20 2020 2020 2020 2020 2020  %S`,.           
-0001ee20: 2020 2020 206f 7220 6025 592d 256d 2d25       or `%Y-%m-%
-0001ee30: 6420 2548 3a25 4d3a 2553 2e25 6660 2e0a  d %H:%M:%S.%f`..
-0001ee40: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-0001ee50: 6e73 0a20 2020 2020 2020 2020 2020 2060  ns.            `
-0001ee60: 5374 6174 6973 7469 6373 602e 2054 6865  Statistics`. The
-0001ee70: 2073 7461 7469 7374 6963 7320 6d65 7461   statistics meta
-0001ee80: 6461 7461 206f 626a 6563 742e 0a0a 2020  data object...  
-0001ee90: 2020 2020 2020 2320 5261 6973 6573 0a20        # Raises. 
-0001eea0: 2020 2020 2020 2020 2020 2060 6873 6673             `hsfs
-0001eeb0: 2e63 6c69 656e 742e 6578 6365 7074 696f  .client.exceptio
-0001eec0: 6e73 2e52 6573 7441 5049 4572 726f 7260  ns.RestAPIError`
-0001eed0: 2e20 556e 6162 6c65 2074 6f20 7065 7273  . Unable to pers
-0001eee0: 6973 7420 7468 6520 7374 6174 6973 7469  ist the statisti
-0001eef0: 6373 2e0a 2020 2020 2020 2020 2222 220a  cs..        """.
-0001ef00: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-0001ef10: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-0001ef20: 672e 656e 6162 6c65 643a 0a20 2020 2020  g.enabled:.     
-0001ef30: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-0001ef40: 6973 5f74 696d 655f 7472 6176 656c 5f65  is_time_travel_e
-0001ef50: 6e61 626c 6564 2829 206f 7220 7761 6c6c  nabled() or wall
-0001ef60: 636c 6f63 6b5f 7469 6d65 2069 7320 6e6f  clock_time is no
-0001ef70: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
-0001ef80: 2020 2020 2020 2020 7761 6c6c 636c 6f63          wallcloc
-0001ef90: 6b5f 7469 6d65 203d 2077 616c 6c63 6c6f  k_time = wallclo
-0001efa0: 636b 5f74 696d 6520 6f72 2064 6174 6574  ck_time or datet
-0001efb0: 696d 652e 6e6f 7728 290a 2020 2020 2020  ime.now().      
-0001efc0: 2020 2020 2020 2020 2020 2320 5265 7472            # Retr
-0001efd0: 6965 7665 2066 6720 636f 6d6d 6974 2069  ieve fg commit i
-0001efe0: 6420 7265 6c61 7465 6420 746f 2074 6869  d related to thi
-0001eff0: 7320 7761 6c6c 2063 6c6f 636b 2074 696d  s wall clock tim
-0001f000: 6520 616e 6420 7265 636f 6d70 7574 6520  e and recompute 
-0001f010: 7374 6174 6973 7469 6373 2e20 4974 2077  statistics. It w
-0001f020: 696c 6c20 7468 726f 770a 2020 2020 2020  ill throw.      
-0001f030: 2020 2020 2020 2020 2020 2320 6578 6365            # exce
-0001f040: 7074 696f 6e20 6966 2069 7473 206e 6f74  ption if its not
-0001f050: 2074 696d 6520 7472 6176 656c 2065 6e61   time travel ena
-0001f060: 626c 6564 2066 6561 7475 7265 2067 726f  bled feature gro
-0001f070: 7570 2e0a 2020 2020 2020 2020 2020 2020  up..            
-0001f080: 2020 2020 6667 5f63 6f6d 6d69 745f 6964      fg_commit_id
-0001f090: 203d 205b 0a20 2020 2020 2020 2020 2020   = [.           
-0001f0a0: 2020 2020 2020 2020 2063 6f6d 6d69 745f           commit_
-0001f0b0: 6964 0a20 2020 2020 2020 2020 2020 2020  id.             
-0001f0c0: 2020 2020 2020 2066 6f72 2063 6f6d 6d69         for commi
-0001f0d0: 745f 6964 2069 6e20 7365 6c66 2e5f 6665  t_id in self._fe
-0001f0e0: 6174 7572 655f 6772 6f75 705f 656e 6769  ature_group_engi
-0001f0f0: 6e65 2e63 6f6d 6d69 745f 6465 7461 696c  ne.commit_detail
-0001f100: 7328 0a20 2020 2020 2020 2020 2020 2020  s(.             
-0001f110: 2020 2020 2020 2020 2020 2073 656c 662c             self,
-0001f120: 2077 616c 6c63 6c6f 636b 5f74 696d 652c   wallclock_time,
-0001f130: 2031 0a20 2020 2020 2020 2020 2020 2020   1.             
-0001f140: 2020 2020 2020 2029 2e6b 6579 7328 290a         ).keys().
-0001f150: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f160: 5d5b 305d 0a20 2020 2020 2020 2020 2020  ][0].           
-0001f170: 2020 2020 2072 6567 6973 7465 7265 645f       registered_
-0001f180: 7374 6174 7320 3d20 7365 6c66 2e67 6574  stats = self.get
-0001f190: 5f73 7461 7469 7374 6963 735f 6279 5f63  _statistics_by_c
-0001f1a0: 6f6d 6d69 745f 7769 6e64 6f77 280a 2020  ommit_window(.  
-0001f1b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f1c0: 2020 746f 5f63 6f6d 6d69 745f 7469 6d65    to_commit_time
-0001f1d0: 3d66 675f 636f 6d6d 6974 5f69 640a 2020  =fg_commit_id.  
-0001f1e0: 2020 2020 2020 2020 2020 2020 2020 290a                ).
-0001f1f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f200: 6966 2072 6567 6973 7465 7265 645f 7374  if registered_st
-0001f210: 6174 7320 6973 206e 6f74 204e 6f6e 6520  ats is not None 
-0001f220: 616e 6420 7365 6c66 2e5f 6172 655f 7374  and self._are_st
-0001f230: 6174 6973 7469 6373 5f6d 6973 7369 6e67  atistics_missing
-0001f240: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-0001f250: 2020 2020 2020 7265 6769 7374 6572 6564        registered
-0001f260: 5f73 7461 7473 0a20 2020 2020 2020 2020  _stats.         
-0001f270: 2020 2020 2020 2029 3a0a 2020 2020 2020         ):.      
-0001f280: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001f290: 6769 7374 6572 6564 5f73 7461 7473 203d  gistered_stats =
-0001f2a0: 204e 6f6e 650a 2020 2020 2020 2020 2020   None.          
-0001f2b0: 2020 2020 2020 2320 446f 6e27 7420 7265        # Don't re
-0001f2c0: 6164 2074 6865 2064 6174 6166 7261 6d65  ad the dataframe
-0001f2d0: 2068 6572 652c 2074 6f20 6176 6f69 6420   here, to avoid 
-0001f2e0: 7472 6967 6765 7269 6e67 2061 2072 6561  triggering a rea
-0001f2f0: 6420 6f70 6572 6174 696f 6e0a 2020 2020  d operation.    
-0001f300: 2020 2020 2020 2020 2020 2020 2320 666f              # fo
-0001f310: 7220 7468 6520 5079 7468 6f6e 2065 6e67  r the Python eng
-0001f320: 696e 652e 2054 6865 2050 7974 686f 6e20  ine. The Python 
-0001f330: 656e 6769 6e65 2069 7320 676f 696e 6720  engine is going 
-0001f340: 746f 2073 6574 7570 2061 2053 7061 726b  to setup a Spark
-0001f350: 204a 6f62 0a20 2020 2020 2020 2020 2020   Job.           
-0001f360: 2020 2020 2023 2074 6f20 7570 6461 7465       # to update
-0001f370: 2074 6865 2073 7461 7469 7374 6963 732e   the statistics.
-0001f380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f390: 2072 6574 7572 6e20 280a 2020 2020 2020   return (.      
-0001f3a0: 2020 2020 2020 2020 2020 2020 2020 7265                re
-0001f3b0: 6769 7374 6572 6564 5f73 7461 7473 0a20  gistered_stats. 
-0001f3c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f3d0: 2020 206f 7220 7365 6c66 2e5f 7374 6174     or self._stat
-0001f3e0: 6973 7469 6373 5f65 6e67 696e 652e 636f  istics_engine.co
-0001f3f0: 6d70 7574 655f 616e 645f 7361 7665 5f73  mpute_and_save_s
-0001f400: 7461 7469 7374 6963 7328 0a20 2020 2020  tatistics(.     
-0001f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f420: 2020 2073 656c 662c 0a20 2020 2020 2020     self,.       
-0001f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f440: 2066 6561 7475 7265 5f67 726f 7570 5f63   feature_group_c
-0001f450: 6f6d 6d69 745f 6964 3d66 675f 636f 6d6d  ommit_id=fg_comm
-0001f460: 6974 5f69 642c 0a20 2020 2020 2020 2020  it_id,.         
-0001f470: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
-0001f480: 2020 2020 2020 2020 2020 2020 2029 0a20               ). 
-0001f490: 2020 2020 2020 2072 6574 7572 6e20 7375         return su
-0001f4a0: 7065 7228 292e 636f 6d70 7574 655f 7374  per().compute_st
-0001f4b0: 6174 6973 7469 6373 2829 0a0a 2020 2020  atistics()..    
-0001f4c0: 4063 6c61 7373 6d65 7468 6f64 0a20 2020  @classmethod.   
-0001f4d0: 2064 6566 2066 726f 6d5f 7265 7370 6f6e   def from_respon
-0001f4e0: 7365 5f6a 736f 6e28 636c 732c 206a 736f  se_json(cls, jso
-0001f4f0: 6e5f 6469 6374 293a 0a20 2020 2020 2020  n_dict):.       
-0001f500: 206a 736f 6e5f 6465 6361 6d65 6c69 7a65   json_decamelize
-0001f510: 6420 3d20 6875 6d70 732e 6465 6361 6d65  d = humps.decame
-0001f520: 6c69 7a65 286a 736f 6e5f 6469 6374 290a  lize(json_dict).
-0001f530: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0001f540: 7461 6e63 6528 6a73 6f6e 5f64 6563 616d  tance(json_decam
-0001f550: 656c 697a 6564 2c20 6469 6374 293a 0a20  elized, dict):. 
-0001f560: 2020 2020 2020 2020 2020 2069 6620 2274             if "t
-0001f570: 7970 6522 2069 6e20 6a73 6f6e 5f64 6563  ype" in json_dec
-0001f580: 616d 656c 697a 6564 3a0a 2020 2020 2020  amelized:.      
-0001f590: 2020 2020 2020 2020 2020 6a73 6f6e 5f64            json_d
-0001f5a0: 6563 616d 656c 697a 6564 5b22 7374 7265  ecamelized["stre
-0001f5b0: 616d 225d 203d 2028 0a20 2020 2020 2020  am"] = (.       
-0001f5c0: 2020 2020 2020 2020 2020 2020 206a 736f               jso
-0001f5d0: 6e5f 6465 6361 6d65 6c69 7a65 645b 2274  n_decamelized["t
-0001f5e0: 7970 6522 5d20 3d3d 2022 7374 7265 616d  ype"] == "stream
-0001f5f0: 4665 6174 7572 6547 726f 7570 4454 4f22  FeatureGroupDTO"
-0001f600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001f610: 2029 0a20 2020 2020 2020 2020 2020 205f   ).            _
-0001f620: 203d 206a 736f 6e5f 6465 6361 6d65 6c69   = json_decameli
-0001f630: 7a65 642e 706f 7028 2274 7970 6522 2c20  zed.pop("type", 
-0001f640: 4e6f 6e65 290a 2020 2020 2020 2020 2020  None).          
-0001f650: 2020 6a73 6f6e 5f64 6563 616d 656c 697a    json_decameliz
-0001f660: 6564 2e70 6f70 2822 7661 6c69 6461 7469  ed.pop("validati
-0001f670: 6f6e 5f74 7970 6522 2c20 4e6f 6e65 290a  on_type", None).
-0001f680: 2020 2020 2020 2020 2020 2020 6966 2022              if "
-0001f690: 656d 6265 6464 696e 675f 696e 6465 7822  embedding_index"
-0001f6a0: 2069 6e20 6a73 6f6e 5f64 6563 616d 656c   in json_decamel
-0001f6b0: 697a 6564 3a0a 2020 2020 2020 2020 2020  ized:.          
-0001f6c0: 2020 2020 2020 6a73 6f6e 5f64 6563 616d        json_decam
-0001f6d0: 656c 697a 6564 5b22 656d 6265 6464 696e  elized["embeddin
-0001f6e0: 675f 696e 6465 7822 5d20 3d20 456d 6265  g_index"] = Embe
-0001f6f0: 6464 696e 6749 6e64 6578 2e66 726f 6d5f  ddingIndex.from_
-0001f700: 6a73 6f6e 5f72 6573 706f 6e73 6528 0a20  json_response(. 
-0001f710: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f720: 2020 206a 736f 6e5f 6465 6361 6d65 6c69     json_decameli
-0001f730: 7a65 645b 2265 6d62 6564 6469 6e67 5f69  zed["embedding_i
-0001f740: 6e64 6578 225d 0a20 2020 2020 2020 2020  ndex"].         
-0001f750: 2020 2020 2020 2029 0a20 2020 2020 2020         ).       
-0001f760: 2020 2020 2072 6574 7572 6e20 636c 7328       return cls(
-0001f770: 2a2a 6a73 6f6e 5f64 6563 616d 656c 697a  **json_decameliz
-0001f780: 6564 290a 2020 2020 2020 2020 666f 7220  ed).        for 
-0001f790: 6667 2069 6e20 6a73 6f6e 5f64 6563 616d  fg in json_decam
-0001f7a0: 656c 697a 6564 3a0a 2020 2020 2020 2020  elized:.        
-0001f7b0: 2020 2020 6966 2022 7479 7065 2220 696e      if "type" in
-0001f7c0: 2066 673a 0a20 2020 2020 2020 2020 2020   fg:.           
-0001f7d0: 2020 2020 2066 675b 2273 7472 6561 6d22       fg["stream"
-0001f7e0: 5d20 3d20 6667 5b22 7479 7065 225d 203d  ] = fg["type"] =
-0001f7f0: 3d20 2273 7472 6561 6d46 6561 7475 7265  = "streamFeature
-0001f800: 4772 6f75 7044 544f 220a 2020 2020 2020  GroupDTO".      
-0001f810: 2020 2020 2020 5f20 3d20 6667 2e70 6f70        _ = fg.pop
-0001f820: 2822 7479 7065 222c 204e 6f6e 6529 0a20  ("type", None). 
-0001f830: 2020 2020 2020 2020 2020 2066 672e 706f             fg.po
-0001f840: 7028 2276 616c 6964 6174 696f 6e5f 7479  p("validation_ty
-0001f850: 7065 222c 204e 6f6e 6529 0a20 2020 2020  pe", None).     
-0001f860: 2020 2020 2020 2069 6620 2265 6d62 6564         if "embed
-0001f870: 6469 6e67 5f69 6e64 6578 2220 696e 2066  ding_index" in f
-0001f880: 673a 0a20 2020 2020 2020 2020 2020 2020  g:.             
-0001f890: 2020 2066 675b 2265 6d62 6564 6469 6e67     fg["embedding
-0001f8a0: 5f69 6e64 6578 225d 203d 2045 6d62 6564  _index"] = Embed
-0001f8b0: 6469 6e67 496e 6465 782e 6672 6f6d 5f6a  dingIndex.from_j
-0001f8c0: 736f 6e5f 7265 7370 6f6e 7365 280a 2020  son_response(.  
-0001f8d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f8e0: 2020 6667 5b22 656d 6265 6464 696e 675f    fg["embedding_
-0001f8f0: 696e 6465 7822 5d0a 2020 2020 2020 2020  index"].        
-0001f900: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
-0001f910: 2020 7265 7475 726e 205b 636c 7328 2a2a    return [cls(**
-0001f920: 6667 2920 666f 7220 6667 2069 6e20 6a73  fg) for fg in js
-0001f930: 6f6e 5f64 6563 616d 656c 697a 6564 5d0a  on_decamelized].
-0001f940: 0a20 2020 2064 6566 2075 7064 6174 655f  .    def update_
-0001f950: 6672 6f6d 5f72 6573 706f 6e73 655f 6a73  from_response_js
-0001f960: 6f6e 2873 656c 662c 206a 736f 6e5f 6469  on(self, json_di
-0001f970: 6374 293a 0a20 2020 2020 2020 206a 736f  ct):.        jso
-0001f980: 6e5f 6465 6361 6d65 6c69 7a65 6420 3d20  n_decamelized = 
-0001f990: 6875 6d70 732e 6465 6361 6d65 6c69 7a65  humps.decamelize
-0001f9a0: 286a 736f 6e5f 6469 6374 290a 2020 2020  (json_dict).    
-0001f9b0: 2020 2020 6a73 6f6e 5f64 6563 616d 656c      json_decamel
-0001f9c0: 697a 6564 5b22 7374 7265 616d 225d 203d  ized["stream"] =
-0001f9d0: 206a 736f 6e5f 6465 6361 6d65 6c69 7a65   json_decamelize
-0001f9e0: 645b 2274 7970 6522 5d20 3d3d 2022 7374  d["type"] == "st
-0001f9f0: 7265 616d 4665 6174 7572 6547 726f 7570  reamFeatureGroup
-0001fa00: 4454 4f22 0a20 2020 2020 2020 205f 203d  DTO".        _ =
-0001fa10: 206a 736f 6e5f 6465 6361 6d65 6c69 7a65   json_decamelize
-0001fa20: 642e 706f 7028 2274 7970 6522 290a 2020  d.pop("type").  
-0001fa30: 2020 2020 2020 6966 2022 656d 6265 6464        if "embedd
-0001fa40: 696e 675f 696e 6465 7822 2069 6e20 6a73  ing_index" in js
-0001fa50: 6f6e 5f64 6563 616d 656c 697a 6564 3a0a  on_decamelized:.
-0001fa60: 2020 2020 2020 2020 2020 2020 6a73 6f6e              json
-0001fa70: 5f64 6563 616d 656c 697a 6564 5b22 656d  _decamelized["em
-0001fa80: 6265 6464 696e 675f 696e 6465 7822 5d20  bedding_index"] 
-0001fa90: 3d20 456d 6265 6464 696e 6749 6e64 6578  = EmbeddingIndex
-0001faa0: 2e66 726f 6d5f 6a73 6f6e 5f72 6573 706f  .from_json_respo
-0001fab0: 6e73 6528 0a20 2020 2020 2020 2020 2020  nse(.           
-0001fac0: 2020 2020 206a 736f 6e5f 6465 6361 6d65       json_decame
-0001fad0: 6c69 7a65 645b 2265 6d62 6564 6469 6e67  lized["embedding
-0001fae0: 5f69 6e64 6578 225d 0a20 2020 2020 2020  _index"].       
-0001faf0: 2020 2020 2029 0a20 2020 2020 2020 2073       ).        s
-0001fb00: 656c 662e 5f5f 696e 6974 5f5f 282a 2a6a  elf.__init__(**j
-0001fb10: 736f 6e5f 6465 6361 6d65 6c69 7a65 6429  son_decamelized)
-0001fb20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001fb30: 7365 6c66 0a0a 2020 2020 6465 6620 6a73  self..    def js
-0001fb40: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
-0001fb50: 2020 2222 2247 6574 2073 7065 6369 6669    """Get specifi
-0001fb60: 6320 4665 6174 7572 6520 4772 6f75 7020  c Feature Group 
-0001fb70: 6d65 7461 6461 7461 2069 6e20 6a73 6f6e  metadata in json
-0001fb80: 2066 6f72 6d61 742e 0a0a 2020 2020 2020   format...      
-0001fb90: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
-0001fba0: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
-0001fbb0: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
-0001fbc0: 6667 2e6a 736f 6e28 290a 2020 2020 2020  fg.json().      
-0001fbd0: 2020 2020 2020 6060 600a 2020 2020 2020        ```.      
-0001fbe0: 2020 2222 220a 2020 2020 2020 2020 7265    """.        re
-0001fbf0: 7475 726e 206a 736f 6e2e 6475 6d70 7328  turn json.dumps(
-0001fc00: 7365 6c66 2c20 636c 733d 7574 696c 2e46  self, cls=util.F
-0001fc10: 6561 7475 7265 5374 6f72 6545 6e63 6f64  eatureStoreEncod
-0001fc20: 6572 290a 0a20 2020 2064 6566 2074 6f5f  er)..    def to_
-0001fc30: 6469 6374 2873 656c 6629 3a0a 2020 2020  dict(self):.    
-0001fc40: 2020 2020 2222 2247 6574 2073 7472 7563      """Get struc
-0001fc50: 7475 7265 6420 696e 666f 2061 626f 7574  tured info about
-0001fc60: 2073 7065 6369 6669 6320 4665 6174 7572   specific Featur
-0001fc70: 6520 4772 6f75 7020 696e 2070 7974 686f  e Group in pytho
-0001fc80: 6e20 6469 6374 696f 6e61 7279 2066 6f72  n dictionary for
-0001fc90: 6d61 742e 0a0a 2020 2020 2020 2020 2121  mat...        !!
-0001fca0: 2120 6578 616d 706c 650a 2020 2020 2020  ! example.      
-0001fcb0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-0001fcc0: 2020 2020 2020 2020 2020 2020 2320 636f              # co
-0001fcd0: 6e6e 6563 7420 746f 2074 6865 2046 6561  nnect to the Fea
-0001fce0: 7475 7265 2053 746f 7265 0a20 2020 2020  ture Store.     
-0001fcf0: 2020 2020 2020 2066 7320 3d20 2e2e 2e0a         fs = ....
-0001fd00: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
-0001fd10: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
-0001fd20: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
-0001fd30: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
-0001fd40: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
-0001fd50: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
-0001fd60: 2e29 0a0a 2020 2020 2020 2020 2020 2020  .)..            
-0001fd70: 6667 2e74 6f5f 6469 6374 2829 0a20 2020  fg.to_dict().   
-0001fd80: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
-0001fd90: 2020 2020 2022 2222 0a20 2020 2020 2020       """.       
-0001fda0: 2066 675f 6d65 7461 5f64 6963 7420 3d20   fg_meta_dict = 
-0001fdb0: 7b0a 2020 2020 2020 2020 2020 2020 2269  {.            "i
-0001fdc0: 6422 3a20 7365 6c66 2e5f 6964 2c0a 2020  d": self._id,.  
-0001fdd0: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-0001fde0: 3a20 7365 6c66 2e5f 6e61 6d65 2c0a 2020  : self._name,.  
-0001fdf0: 2020 2020 2020 2020 2020 2276 6572 7369            "versi
-0001fe00: 6f6e 223a 2073 656c 662e 5f76 6572 7369  on": self._versi
-0001fe10: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
-0001fe20: 2264 6573 6372 6970 7469 6f6e 223a 2073  "description": s
-0001fe30: 656c 662e 5f64 6573 6372 6970 7469 6f6e  elf._description
-0001fe40: 2c0a 2020 2020 2020 2020 2020 2020 226f  ,.            "o
-0001fe50: 6e6c 696e 6545 6e61 626c 6564 223a 2073  nlineEnabled": s
-0001fe60: 656c 662e 5f6f 6e6c 696e 655f 656e 6162  elf._online_enab
-0001fe70: 6c65 642c 0a20 2020 2020 2020 2020 2020  led,.           
-0001fe80: 2022 7469 6d65 5472 6176 656c 466f 726d   "timeTravelForm
-0001fe90: 6174 223a 2073 656c 662e 5f74 696d 655f  at": self._time_
-0001fea0: 7472 6176 656c 5f66 6f72 6d61 742c 0a20  travel_format,. 
-0001feb0: 2020 2020 2020 2020 2020 2022 6665 6174             "feat
-0001fec0: 7572 6573 223a 2073 656c 662e 5f66 6561  ures": self._fea
-0001fed0: 7475 7265 732c 0a20 2020 2020 2020 2020  tures,.         
-0001fee0: 2020 2022 6665 6174 7572 6573 746f 7265     "featurestore
-0001fef0: 4964 223a 2073 656c 662e 5f66 6561 7475  Id": self._featu
-0001ff00: 7265 5f73 746f 7265 5f69 642c 0a20 2020  re_store_id,.   
-0001ff10: 2020 2020 2020 2020 2022 7479 7065 223a           "type":
-0001ff20: 2022 6361 6368 6564 4665 6174 7572 6567   "cachedFeatureg
-0001ff30: 726f 7570 4454 4f22 0a20 2020 2020 2020  roupDTO".       
-0001ff40: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
-0001ff50: 2e5f 7374 7265 616d 0a20 2020 2020 2020  ._stream.       
-0001ff60: 2020 2020 2065 6c73 6520 2273 7472 6561       else "strea
-0001ff70: 6d46 6561 7475 7265 4772 6f75 7044 544f  mFeatureGroupDTO
-0001ff80: 222c 0a20 2020 2020 2020 2020 2020 2022  ",.            "
-0001ff90: 7374 6174 6973 7469 6373 436f 6e66 6967  statisticsConfig
-0001ffa0: 223a 2073 656c 662e 5f73 7461 7469 7374  ": self._statist
-0001ffb0: 6963 735f 636f 6e66 6967 2c0a 2020 2020  ics_config,.    
-0001ffc0: 2020 2020 2020 2020 2265 7665 6e74 5469          "eventTi
-0001ffd0: 6d65 223a 2073 656c 662e 6576 656e 745f  me": self.event_
-0001ffe0: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
-0001fff0: 2020 2265 7870 6563 7461 7469 6f6e 5375    "expectationSu
-00020000: 6974 6522 3a20 7365 6c66 2e5f 6578 7065  ite": self._expe
-00020010: 6374 6174 696f 6e5f 7375 6974 652c 0a20  ctation_suite,. 
-00020020: 2020 2020 2020 2020 2020 2022 7061 7265             "pare
-00020030: 6e74 7322 3a20 7365 6c66 2e5f 7061 7265  nts": self._pare
-00020040: 6e74 732c 0a20 2020 2020 2020 2020 2020  nts,.           
-00020050: 2022 746f 7069 634e 616d 6522 3a20 7365   "topicName": se
-00020060: 6c66 2e74 6f70 6963 5f6e 616d 652c 0a20  lf.topic_name,. 
-00020070: 2020 2020 2020 2020 2020 2022 6e6f 7469             "noti
-00020080: 6669 6361 7469 6f6e 546f 7069 634e 616d  ficationTopicNam
-00020090: 6522 3a20 7365 6c66 2e6e 6f74 6966 6963  e": self.notific
-000200a0: 6174 696f 6e5f 746f 7069 635f 6e61 6d65  ation_topic_name
-000200b0: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
-000200c0: 6570 7265 6361 7465 6422 3a20 7365 6c66  eprecated": self
-000200d0: 2e64 6570 7265 6361 7465 642c 0a20 2020  .deprecated,.   
-000200e0: 2020 2020 207d 0a20 2020 2020 2020 2069       }.        i
-000200f0: 6620 7365 6c66 2e65 6d62 6564 6469 6e67  f self.embedding
-00020100: 5f69 6e64 6578 3a0a 2020 2020 2020 2020  _index:.        
-00020110: 2020 2020 6667 5f6d 6574 615f 6469 6374      fg_meta_dict
-00020120: 5b22 656d 6265 6464 696e 6749 6e64 6578  ["embeddingIndex
-00020130: 225d 203d 2073 656c 662e 656d 6265 6464  "] = self.embedd
-00020140: 696e 675f 696e 6465 780a 2020 2020 2020  ing_index.      
-00020150: 2020 6966 2073 656c 662e 5f73 7472 6561    if self._strea
-00020160: 6d3a 0a20 2020 2020 2020 2020 2020 2066  m:.            f
-00020170: 675f 6d65 7461 5f64 6963 745b 2264 656c  g_meta_dict["del
-00020180: 7461 5374 7265 616d 6572 4a6f 6243 6f6e  taStreamerJobCon
-00020190: 6622 5d20 3d20 7365 6c66 2e5f 6465 6c74  f"] = self._delt
-000201a0: 6173 7472 6561 6d65 725f 6a6f 6263 6f6e  astreamer_jobcon
-000201b0: 660a 2020 2020 2020 2020 7265 7475 726e  f.        return
-000201c0: 2066 675f 6d65 7461 5f64 6963 740a 0a20   fg_meta_dict.. 
-000201d0: 2020 2064 6566 205f 6765 745f 7461 626c     def _get_tabl
-000201e0: 655f 6e61 6d65 2873 656c 6629 3a0a 2020  e_name(self):.  
-000201f0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00020200: 662e 6665 6174 7572 655f 7374 6f72 655f  f.feature_store_
-00020210: 6e61 6d65 202b 2022 2e22 202b 2073 656c  name + "." + sel
-00020220: 662e 6765 745f 6667 5f6e 616d 6528 290a  f.get_fg_name().
-00020230: 0a20 2020 2064 6566 205f 6973 5f74 696d  .    def _is_tim
-00020240: 655f 7472 6176 656c 5f65 6e61 626c 6564  e_travel_enabled
-00020250: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00020260: 2222 2257 6865 7468 6572 2074 696d 652d  """Whether time-
-00020270: 7472 6176 656c 2069 7320 656e 6162 6c65  travel is enable
-00020280: 6420 6f72 206e 6f74 2222 220a 2020 2020  d or not""".    
-00020290: 2020 2020 7265 7475 726e 2028 0a20 2020      return (.   
-000202a0: 2020 2020 2020 2020 2073 656c 662e 5f74           self._t
-000202b0: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
-000202c0: 7420 6973 206e 6f74 204e 6f6e 650a 2020  t is not None.  
-000202d0: 2020 2020 2020 2020 2020 616e 6420 7365            and se
-000202e0: 6c66 2e5f 7469 6d65 5f74 7261 7665 6c5f  lf._time_travel_
-000202f0: 666f 726d 6174 2e75 7070 6572 2829 203d  format.upper() =
-00020300: 3d20 2248 5544 4922 0a20 2020 2020 2020  = "HUDI".       
-00020310: 2029 0a0a 2020 2020 4070 726f 7065 7274   )..    @propert
-00020320: 790a 2020 2020 6465 6620 6964 2873 656c  y.    def id(sel
-00020330: 6629 3a0a 2020 2020 2020 2020 2222 2246  f):.        """F
-00020340: 6561 7475 7265 2067 726f 7570 2069 642e  eature group id.
-00020350: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
-00020360: 726e 2073 656c 662e 5f69 640a 0a20 2020  rn self._id..   
-00020370: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
-00020380: 6566 2064 6573 6372 6970 7469 6f6e 2873  ef description(s
-00020390: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-000203a0: 2244 6573 6372 6970 7469 6f6e 206f 6620  "Description of 
-000203b0: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
-000203c0: 7020 636f 6e74 656e 7473 2e22 2222 0a20  p contents.""". 
-000203d0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-000203e0: 6c66 2e5f 6465 7363 7269 7074 696f 6e0a  lf._description.
-000203f0: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
-00020400: 2020 2064 6566 2074 696d 655f 7472 6176     def time_trav
-00020410: 656c 5f66 6f72 6d61 7428 7365 6c66 293a  el_format(self):
-00020420: 0a20 2020 2020 2020 2022 2222 5365 7474  .        """Sett
-00020430: 696e 6720 6f66 2074 6865 2066 6561 7475  ing of the featu
-00020440: 7265 2067 726f 7570 2074 696d 6520 7472  re group time tr
-00020450: 6176 656c 2066 6f72 6d61 742e 2222 220a  avel format.""".
-00020460: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00020470: 656c 662e 5f74 696d 655f 7472 6176 656c  elf._time_travel
-00020480: 5f66 6f72 6d61 740a 0a20 2020 2040 7072  _format..    @pr
-00020490: 6f70 6572 7479 0a20 2020 2064 6566 2070  operty.    def p
-000204a0: 6172 7469 7469 6f6e 5f6b 6579 2873 656c  artition_key(sel
-000204b0: 6629 3a0a 2020 2020 2020 2020 2222 224c  f):.        """L
-000204c0: 6973 7420 6f66 2066 6561 7475 7265 7320  ist of features 
-000204d0: 6275 696c 6469 6e67 2074 6865 2070 6172  building the par
-000204e0: 7469 7469 6f6e 206b 6579 2e22 2222 0a20  tition key.""". 
-000204f0: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00020500: 6c66 2e5f 7061 7274 6974 696f 6e5f 6b65  lf._partition_ke
-00020510: 790a 0a20 2020 2040 7072 6f70 6572 7479  y..    @property
-00020520: 0a20 2020 2064 6566 2068 7564 695f 7072  .    def hudi_pr
-00020530: 6563 6f6d 6269 6e65 5f6b 6579 2873 656c  ecombine_key(sel
-00020540: 6629 3a0a 2020 2020 2020 2020 2222 2246  f):.        """F
-00020550: 6561 7475 7265 206e 616d 6520 7468 6174  eature name that
-00020560: 2069 7320 7468 6520 6875 6469 2070 7265   is the hudi pre
-00020570: 636f 6d62 696e 6520 6b65 792e 2222 220a  combine key.""".
-00020580: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00020590: 656c 662e 5f68 7564 695f 7072 6563 6f6d  elf._hudi_precom
-000205a0: 6269 6e65 5f6b 6579 0a0a 2020 2020 4070  bine_key..    @p
-000205b0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000205c0: 6665 6174 7572 655f 7374 6f72 655f 6e61  feature_store_na
-000205d0: 6d65 2873 656c 6629 3a0a 2020 2020 2020  me(self):.      
-000205e0: 2020 2222 224e 616d 6520 6f66 2074 6865    """Name of the
-000205f0: 2066 6561 7475 7265 2073 746f 7265 2069   feature store i
-00020600: 6e20 7768 6963 6820 7468 6520 6665 6174  n which the feat
-00020610: 7572 6520 6772 6f75 7020 6973 206c 6f63  ure group is loc
-00020620: 6174 6564 2e22 2222 0a20 2020 2020 2020  ated.""".       
-00020630: 2072 6574 7572 6e20 7365 6c66 2e5f 6665   return self._fe
-00020640: 6174 7572 655f 7374 6f72 655f 6e61 6d65  ature_store_name
-00020650: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00020660: 2020 2020 6465 6620 6372 6561 746f 7228      def creator(
-00020670: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
-00020680: 2222 5573 6572 6e61 6d65 206f 6620 7468  ""Username of th
-00020690: 6520 6372 6561 746f 722e 2222 220a 2020  e creator.""".  
-000206a0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000206b0: 662e 5f63 7265 6174 6f72 0a0a 2020 2020  f._creator..    
-000206c0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-000206d0: 6620 6372 6561 7465 6428 7365 6c66 293a  f created(self):
-000206e0: 0a20 2020 2020 2020 2022 2222 5469 6d65  .        """Time
-000206f0: 7374 616d 7020 7768 656e 2074 6865 2066  stamp when the f
-00020700: 6561 7475 7265 2067 726f 7570 2077 6173  eature group was
-00020710: 2063 7265 6174 6564 2e22 2222 0a20 2020   created.""".   
-00020720: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
-00020730: 2e5f 6372 6561 7465 640a 0a20 2020 2040  ._created..    @
-00020740: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00020750: 2073 7472 6561 6d28 7365 6c66 293a 0a20   stream(self):. 
-00020760: 2020 2020 2020 2022 2222 5768 6574 6865         """Whethe
-00020770: 7220 746f 2065 6e61 626c 6520 7265 616c  r to enable real
-00020780: 2074 696d 6520 7374 7265 616d 2077 7269   time stream wri
-00020790: 7469 6e67 2063 6170 6162 696c 6974 6965  ting capabilitie
-000207a0: 732e 2222 220a 2020 2020 2020 2020 7265  s.""".        re
-000207b0: 7475 726e 2073 656c 662e 5f73 7472 6561  turn self._strea
-000207c0: 6d0a 0a20 2020 2040 7072 6f70 6572 7479  m..    @property
-000207d0: 0a20 2020 2064 6566 2070 6172 656e 7473  .    def parents
-000207e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-000207f0: 2222 2250 6172 656e 7420 6665 6174 7572  """Parent featur
-00020800: 6520 6772 6f75 7073 2061 7320 6f72 6967  e groups as orig
-00020810: 696e 206f 6620 7468 6520 6461 7461 2069  in of the data i
-00020820: 6e20 7468 6520 6375 7272 656e 7420 6665  n the current fe
-00020830: 6174 7572 6520 6772 6f75 702e 0a20 2020  ature group..   
-00020840: 2020 2020 2054 6869 7320 6973 2070 6172       This is par
-00020850: 7420 6f66 2065 7870 6c69 6369 7420 7072  t of explicit pr
-00020860: 6f76 656e 616e 6365 2222 220a 2020 2020  ovenance""".    
-00020870: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-00020880: 5f70 6172 656e 7473 0a0a 2020 2020 4070  _parents..    @p
-00020890: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-000208a0: 6d61 7465 7269 616c 697a 6174 696f 6e5f  materialization_
-000208b0: 6a6f 6228 7365 6c66 293a 0a20 2020 2020  job(self):.     
-000208c0: 2020 2022 2222 4765 7420 7468 6520 4a6f     """Get the Jo
-000208d0: 6220 6f62 6a65 6374 2072 6566 6572 656e  b object referen
-000208e0: 6365 2066 6f72 2074 6865 206d 6174 6572  ce for the mater
-000208f0: 6961 6c69 7a61 7469 6f6e 206a 6f62 2066  ialization job f
-00020900: 6f72 2074 6869 730a 2020 2020 2020 2020  or this.        
-00020910: 4665 6174 7572 6520 4772 6f75 702e 2222  Feature Group.""
-00020920: 220a 2020 2020 2020 2020 6966 2073 656c  ".        if sel
-00020930: 662e 5f6d 6174 6572 6961 6c69 7a61 7469  f._materializati
-00020940: 6f6e 5f6a 6f62 2069 7320 6e6f 7420 4e6f  on_job is not No
-00020950: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
-00020960: 7265 7475 726e 2073 656c 662e 5f6d 6174  return self._mat
-00020970: 6572 6961 6c69 7a61 7469 6f6e 5f6a 6f62  erialization_job
-00020980: 0a20 2020 2020 2020 2065 6c73 653a 0a20  .        else:. 
-00020990: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-000209a0: 7265 5f67 726f 7570 5f6e 616d 6520 3d20  re_group_name = 
-000209b0: 7574 696c 2e66 6561 7475 7265 5f67 726f  util.feature_gro
-000209c0: 7570 5f6e 616d 6528 7365 6c66 290a 2020  up_name(self).  
-000209d0: 2020 2020 2020 2020 2020 6a6f 625f 7375            job_su
-000209e0: 6666 6978 5f6c 6973 7420 3d20 5b22 6d61  ffix_list = ["ma
-000209f0: 7465 7269 616c 697a 6174 696f 6e22 2c20  terialization", 
-00020a00: 2262 6163 6b66 696c 6c22 5d0a 2020 2020  "backfill"].    
-00020a10: 2020 2020 2020 2020 666f 7220 6a6f 625f          for job_
-00020a20: 7375 6666 6978 2069 6e20 6a6f 625f 7375  suffix in job_su
-00020a30: 6666 6978 5f6c 6973 743a 0a20 2020 2020  ffix_list:.     
-00020a40: 2020 2020 2020 2020 2020 206a 6f62 5f6e             job_n
-00020a50: 616d 6520 3d20 227b 7d5f 6f66 666c 696e  ame = "{}_offlin
-00020a60: 655f 6667 5f7b 7d22 2e66 6f72 6d61 7428  e_fg_{}".format(
-00020a70: 6665 6174 7572 655f 6772 6f75 705f 6e61  feature_group_na
-00020a80: 6d65 2c20 6a6f 625f 7375 6666 6978 290a  me, job_suffix).
-00020a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020aa0: 666f 7220 5f20 696e 2072 616e 6765 2833  for _ in range(3
-00020ab0: 293a 2020 2320 7265 7472 7920 7374 6172  ):  # retry star
-00020ac0: 7469 6e67 206a 6f62 0a20 2020 2020 2020  ting job.       
-00020ad0: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00020ae0: 3a0a 2020 2020 2020 2020 2020 2020 2020  :.              
-00020af0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00020b00: 6d61 7465 7269 616c 697a 6174 696f 6e5f  materialization_
-00020b10: 6a6f 6220 3d20 6a6f 625f 6170 692e 4a6f  job = job_api.Jo
-00020b20: 6241 7069 2829 2e67 6574 286a 6f62 5f6e  bApi().get(job_n
-00020b30: 616d 6529 0a20 2020 2020 2020 2020 2020  ame).           
-00020b40: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00020b50: 7572 6e20 7365 6c66 2e5f 6d61 7465 7269  urn self._materi
-00020b60: 616c 697a 6174 696f 6e5f 6a6f 620a 2020  alization_job.  
-00020b70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020b80: 2020 6578 6365 7074 2052 6573 7441 5049    except RestAPI
-00020b90: 4572 726f 7220 6173 2065 3a0a 2020 2020  Error as e:.    
-00020ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bb0: 2020 2020 6966 2065 2e72 6573 706f 6e73      if e.respons
-00020bc0: 652e 7374 6174 7573 5f63 6f64 6520 3d3d  e.status_code ==
-00020bd0: 2034 3034 3a0a 2020 2020 2020 2020 2020   404:.          
-00020be0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020bf0: 2020 6966 2065 2e72 6573 706f 6e73 652e    if e.response.
-00020c00: 6a73 6f6e 2829 2e67 6574 2822 6572 726f  json().get("erro
-00020c10: 7243 6f64 6522 2c20 2222 2920 3d3d 2031  rCode", "") == 1
-00020c20: 3330 3030 393a 0a20 2020 2020 2020 2020  30009:.         
-00020c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c40: 2020 2020 2020 2062 7265 616b 2020 2320         break  # 
-00020c50: 6e6f 206e 6565 6420 746f 2072 6574 7279  no need to retry
-00020c60: 2c20 7369 6e63 6520 6e6f 2073 7563 6820  , since no such 
-00020c70: 6a6f 6220 6578 6973 7473 0a20 2020 2020  job exists.     
-00020c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020c90: 2020 2020 2020 2065 6c73 653a 0a20 2020         else:.   
-00020ca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020cb0: 2020 2020 2020 2020 2020 2020 2074 696d               tim
-00020cc0: 652e 736c 6565 7028 3129 2020 2320 6261  e.sleep(1)  # ba
-00020cd0: 636b 6f66 6620 616e 6420 7468 656e 2072  ckoff and then r
-00020ce0: 6574 7279 0a20 2020 2020 2020 2020 2020  etry.           
-00020cf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020d00: 2020 2020 2063 6f6e 7469 6e75 650a 2020       continue.  
-00020d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020d20: 2020 2020 2020 7261 6973 6520 650a 2020        raise e.  
-00020d30: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00020d40: 4665 6174 7572 6553 746f 7265 4578 6365  FeatureStoreExce
-00020d50: 7074 696f 6e28 224e 6f20 6d61 7465 7269  ption("No materi
-00020d60: 616c 697a 6174 696f 6e20 6a6f 6220 7761  alization job wa
-00020d70: 7320 666f 756e 6422 290a 0a20 2020 2040  s found")..    @
-00020d80: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00020d90: 2073 7461 7469 7374 6963 7328 7365 6c66   statistics(self
-00020da0: 293a 0a20 2020 2020 2020 2022 2222 4765  ):.        """Ge
-00020db0: 7420 7468 6520 6c61 7465 7374 2063 6f6d  t the latest com
-00020dc0: 7075 7465 6420 7374 6174 6973 7469 6373  puted statistics
-00020dd0: 2066 6f72 2074 6865 2077 686f 6c65 2066   for the whole f
-00020de0: 6561 7475 7265 2067 726f 7570 2e22 2222  eature group."""
-00020df0: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00020e00: 2e5f 6973 5f74 696d 655f 7472 6176 656c  ._is_time_travel
-00020e10: 5f65 6e61 626c 6564 2829 3a0a 2020 2020  _enabled():.    
-00020e20: 2020 2020 2020 2020 2320 7265 7472 6965          # retrie
-00020e30: 7665 2074 6865 206c 6174 6573 7473 2073  ve the latests s
-00020e40: 7461 7469 7374 6963 7320 636f 6d70 7574  tatistics comput
-00020e50: 6564 206f 6e20 7468 6520 7768 6f6c 6520  ed on the whole 
-00020e60: 4665 6174 7572 6520 4772 6f75 702c 2069  Feature Group, i
-00020e70: 6e63 6c75 6469 6e67 2061 6c6c 2074 6865  ncluding all the
-00020e80: 2063 6f6d 6d69 7473 2e0a 2020 2020 2020   commits..      
-00020e90: 2020 2020 2020 6e6f 7720 3d20 7574 696c        now = util
-00020ea0: 2e63 6f6e 7665 7274 5f65 7665 6e74 5f74  .convert_event_t
-00020eb0: 696d 655f 746f 5f74 696d 6573 7461 6d70  ime_to_timestamp
-00020ec0: 2864 6174 6574 696d 652e 6e6f 7728 2929  (datetime.now())
-00020ed0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
-00020ee0: 7572 6e20 7365 6c66 2e5f 7374 6174 6973  urn self._statis
-00020ef0: 7469 6373 5f65 6e67 696e 652e 6765 745f  tics_engine.get_
-00020f00: 6279 5f74 696d 655f 7769 6e64 6f77 280a  by_time_window(.
-00020f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00020f20: 7365 6c66 2c0a 2020 2020 2020 2020 2020  self,.          
-00020f30: 2020 2020 2020 7374 6172 745f 636f 6d6d        start_comm
-00020f40: 6974 5f74 696d 653d 4e6f 6e65 2c0a 2020  it_time=None,.  
-00020f50: 2020 2020 2020 2020 2020 2020 2020 656e                en
-00020f60: 645f 636f 6d6d 6974 5f74 696d 653d 6e6f  d_commit_time=no
-00020f70: 772c 0a20 2020 2020 2020 2020 2020 2029  w,.            )
-00020f80: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00020f90: 7375 7065 7228 292e 7374 6174 6973 7469  super().statisti
-00020fa0: 6373 0a0a 2020 2020 4064 6573 6372 6970  cs..    @descrip
-00020fb0: 7469 6f6e 2e73 6574 7465 720a 2020 2020  tion.setter.    
-00020fc0: 6465 6620 6465 7363 7269 7074 696f 6e28  def description(
-00020fd0: 7365 6c66 2c20 6e65 775f 6465 7363 7269  self, new_descri
-00020fe0: 7074 696f 6e29 3a0a 2020 2020 2020 2020  ption):.        
-00020ff0: 7365 6c66 2e5f 6465 7363 7269 7074 696f  self._descriptio
-00021000: 6e20 3d20 6e65 775f 6465 7363 7269 7074  n = new_descript
-00021010: 696f 6e0a 0a20 2020 2040 7469 6d65 5f74  ion..    @time_t
-00021020: 7261 7665 6c5f 666f 726d 6174 2e73 6574  ravel_format.set
-00021030: 7465 720a 2020 2020 6465 6620 7469 6d65  ter.    def time
-00021040: 5f74 7261 7665 6c5f 666f 726d 6174 2873  _travel_format(s
-00021050: 656c 662c 206e 6577 5f74 696d 655f 7472  elf, new_time_tr
-00021060: 6176 656c 5f66 6f72 6d61 7429 3a0a 2020  avel_format):.  
-00021070: 2020 2020 2020 7365 6c66 2e5f 7469 6d65        self._time
-00021080: 5f74 7261 7665 6c5f 666f 726d 6174 203d  _travel_format =
-00021090: 206e 6577 5f74 696d 655f 7472 6176 656c   new_time_travel
-000210a0: 5f66 6f72 6d61 740a 0a20 2020 2040 7061  _format..    @pa
-000210b0: 7274 6974 696f 6e5f 6b65 792e 7365 7474  rtition_key.sett
-000210c0: 6572 0a20 2020 2064 6566 2070 6172 7469  er.    def parti
-000210d0: 7469 6f6e 5f6b 6579 2873 656c 662c 206e  tion_key(self, n
-000210e0: 6577 5f70 6172 7469 7469 6f6e 5f6b 6579  ew_partition_key
-000210f0: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-00021100: 5f70 6172 7469 7469 6f6e 5f6b 6579 203d  _partition_key =
-00021110: 205b 706b 2e6c 6f77 6572 2829 2066 6f72   [pk.lower() for
-00021120: 2070 6b20 696e 206e 6577 5f70 6172 7469   pk in new_parti
-00021130: 7469 6f6e 5f6b 6579 5d0a 0a20 2020 2040  tion_key]..    @
-00021140: 6875 6469 5f70 7265 636f 6d62 696e 655f  hudi_precombine_
-00021150: 6b65 792e 7365 7474 6572 0a20 2020 2064  key.setter.    d
-00021160: 6566 2068 7564 695f 7072 6563 6f6d 6269  ef hudi_precombi
-00021170: 6e65 5f6b 6579 2873 656c 662c 2068 7564  ne_key(self, hud
-00021180: 695f 7072 6563 6f6d 6269 6e65 5f6b 6579  i_precombine_key
-00021190: 293a 0a20 2020 2020 2020 2073 656c 662e  ):.        self.
-000211a0: 5f68 7564 695f 7072 6563 6f6d 6269 6e65  _hudi_precombine
-000211b0: 5f6b 6579 203d 2068 7564 695f 7072 6563  _key = hudi_prec
-000211c0: 6f6d 6269 6e65 5f6b 6579 2e6c 6f77 6572  ombine_key.lower
-000211d0: 2829 0a0a 2020 2020 4073 7472 6561 6d2e  ()..    @stream.
-000211e0: 7365 7474 6572 0a20 2020 2064 6566 2073  setter.    def s
-000211f0: 7472 6561 6d28 7365 6c66 2c20 7374 7265  tream(self, stre
-00021200: 616d 293a 0a20 2020 2020 2020 2073 656c  am):.        sel
-00021210: 662e 5f73 7472 6561 6d20 3d20 7374 7265  f._stream = stre
-00021220: 616d 0a0a 2020 2020 4070 6172 656e 7473  am..    @parents
-00021230: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
-00021240: 7061 7265 6e74 7328 7365 6c66 2c20 6e65  parents(self, ne
-00021250: 775f 7061 7265 6e74 7329 3a0a 2020 2020  w_parents):.    
-00021260: 2020 2020 7365 6c66 2e5f 7061 7265 6e74      self._parent
-00021270: 7320 3d20 6e65 775f 7061 7265 6e74 730a  s = new_parents.
-00021280: 0a0a 636c 6173 7320 4578 7465 726e 616c  ..class External
-00021290: 4665 6174 7572 6547 726f 7570 2846 6561  FeatureGroup(Fea
-000212a0: 7475 7265 4772 6f75 7042 6173 6529 3a0a  tureGroupBase):.
-000212b0: 2020 2020 4558 5445 524e 414c 5f46 4541      EXTERNAL_FEA
-000212c0: 5455 5245 5f47 524f 5550 203d 2022 4f4e  TURE_GROUP = "ON
-000212d0: 5f44 454d 414e 445f 4645 4154 5552 455f  _DEMAND_FEATURE_
-000212e0: 4752 4f55 5022 0a20 2020 2045 4e54 4954  GROUP".    ENTIT
-000212f0: 595f 5459 5045 203d 2022 6665 6174 7572  Y_TYPE = "featur
-00021300: 6567 726f 7570 7322 0a0a 2020 2020 6465  egroups"..    de
-00021310: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
-00021320: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
-00021330: 2020 7374 6f72 6167 655f 636f 6e6e 6563    storage_connec
-00021340: 746f 722c 0a20 2020 2020 2020 2071 7565  tor,.        que
-00021350: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
-00021360: 2064 6174 615f 666f 726d 6174 3d4e 6f6e   data_format=Non
-00021370: 652c 0a20 2020 2020 2020 2070 6174 683d  e,.        path=
-00021380: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f70  None,.        op
-00021390: 7469 6f6e 733d 7b7d 2c0a 2020 2020 2020  tions={},.      
-000213a0: 2020 6e61 6d65 3d4e 6f6e 652c 0a20 2020    name=None,.   
-000213b0: 2020 2020 2076 6572 7369 6f6e 3d4e 6f6e       version=Non
-000213c0: 652c 0a20 2020 2020 2020 2064 6573 6372  e,.        descr
-000213d0: 6970 7469 6f6e 3d4e 6f6e 652c 0a20 2020  iption=None,.   
-000213e0: 2020 2020 2070 7269 6d61 7279 5f6b 6579       primary_key
-000213f0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2066  =None,.        f
-00021400: 6561 7475 7265 7374 6f72 655f 6964 3d4e  eaturestore_id=N
-00021410: 6f6e 652c 0a20 2020 2020 2020 2066 6561  one,.        fea
-00021420: 7475 7265 7374 6f72 655f 6e61 6d65 3d4e  turestore_name=N
-00021430: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
-00021440: 6174 6564 3d4e 6f6e 652c 0a20 2020 2020  ated=None,.     
-00021450: 2020 2063 7265 6174 6f72 3d4e 6f6e 652c     creator=None,
-00021460: 0a20 2020 2020 2020 2069 643d 4e6f 6e65  .        id=None
-00021470: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
-00021480: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
-00021490: 206c 6f63 6174 696f 6e3d 4e6f 6e65 2c0a   location=None,.
-000214a0: 2020 2020 2020 2020 7374 6174 6973 7469          statisti
-000214b0: 6373 5f63 6f6e 6669 673d 4e6f 6e65 2c0a  cs_config=None,.
-000214c0: 2020 2020 2020 2020 6576 656e 745f 7469          event_ti
-000214d0: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-000214e0: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
-000214f0: 7465 3d4e 6f6e 652c 0a20 2020 2020 2020  te=None,.       
-00021500: 206f 6e6c 696e 655f 656e 6162 6c65 643d   online_enabled=
-00021510: 4661 6c73 652c 0a20 2020 2020 2020 2068  False,.        h
-00021520: 7265 663d 4e6f 6e65 2c0a 2020 2020 2020  ref=None,.      
-00021530: 2020 6f6e 6c69 6e65 5f74 6f70 6963 5f6e    online_topic_n
-00021540: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
-00021550: 2020 746f 7069 635f 6e61 6d65 3d4e 6f6e    topic_name=Non
-00021560: 652c 0a20 2020 2020 2020 206e 6f74 6966  e,.        notif
-00021570: 6963 6174 696f 6e5f 746f 7069 635f 6e61  ication_topic_na
-00021580: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
-00021590: 2073 7069 6e65 3d46 616c 7365 2c0a 2020   spine=False,.  
-000215a0: 2020 2020 2020 6465 7072 6563 6174 6564        deprecated
-000215b0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
-000215c0: 2a2a 6b77 6172 6773 2c0a 2020 2020 293a  **kwargs,.    ):
-000215d0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
-000215e0: 2e5f 5f69 6e69 745f 5f28 0a20 2020 2020  .__init__(.     
-000215f0: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
-00021600: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
-00021610: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
-00021620: 6174 7572 6573 746f 7265 5f69 642c 0a20  aturestore_id,. 
-00021630: 2020 2020 2020 2020 2020 206c 6f63 6174             locat
-00021640: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
-00021650: 2065 7665 6e74 5f74 696d 653d 6576 656e   event_time=even
-00021660: 745f 7469 6d65 2c0a 2020 2020 2020 2020  t_time,.        
-00021670: 2020 2020 6f6e 6c69 6e65 5f65 6e61 626c      online_enabl
-00021680: 6564 3d6f 6e6c 696e 655f 656e 6162 6c65  ed=online_enable
-00021690: 642c 0a20 2020 2020 2020 2020 2020 2069  d,.            i
-000216a0: 643d 6964 2c0a 2020 2020 2020 2020 2020  d=id,.          
-000216b0: 2020 6578 7065 6374 6174 696f 6e5f 7375    expectation_su
-000216c0: 6974 653d 6578 7065 6374 6174 696f 6e5f  ite=expectation_
-000216d0: 7375 6974 652c 0a20 2020 2020 2020 2020  suite,.         
-000216e0: 2020 206f 6e6c 696e 655f 746f 7069 635f     online_topic_
-000216f0: 6e61 6d65 3d6f 6e6c 696e 655f 746f 7069  name=online_topi
-00021700: 635f 6e61 6d65 2c0a 2020 2020 2020 2020  c_name,.        
-00021710: 2020 2020 746f 7069 635f 6e61 6d65 3d74      topic_name=t
-00021720: 6f70 6963 5f6e 616d 652c 0a20 2020 2020  opic_name,.     
-00021730: 2020 2020 2020 206e 6f74 6966 6963 6174         notificat
-00021740: 696f 6e5f 746f 7069 635f 6e61 6d65 3d6e  ion_topic_name=n
-00021750: 6f74 6966 6963 6174 696f 6e5f 746f 7069  otification_topi
-00021760: 635f 6e61 6d65 2c0a 2020 2020 2020 2020  c_name,.        
-00021770: 2020 2020 6465 7072 6563 6174 6564 3d64      deprecated=d
-00021780: 6570 7265 6361 7465 642c 0a20 2020 2020  eprecated,.     
-00021790: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
-000217a0: 6c66 2e5f 6665 6174 7572 655f 7374 6f72  lf._feature_stor
-000217b0: 655f 6e61 6d65 203d 2066 6561 7475 7265  e_name = feature
-000217c0: 7374 6f72 655f 6e61 6d65 0a20 2020 2020  store_name.     
-000217d0: 2020 2073 656c 662e 5f64 6573 6372 6970     self._descrip
-000217e0: 7469 6f6e 203d 2064 6573 6372 6970 7469  tion = descripti
-000217f0: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
-00021800: 5f63 7265 6174 6564 203d 2063 7265 6174  _created = creat
-00021810: 6564 0a20 2020 2020 2020 2073 656c 662e  ed.        self.
-00021820: 5f63 7265 6174 6f72 203d 2075 7365 722e  _creator = user.
-00021830: 5573 6572 2e66 726f 6d5f 7265 7370 6f6e  User.from_respon
-00021840: 7365 5f6a 736f 6e28 6372 6561 746f 7229  se_json(creator)
-00021850: 0a20 2020 2020 2020 2073 656c 662e 5f71  .        self._q
-00021860: 7565 7279 203d 2071 7565 7279 0a20 2020  uery = query.   
-00021870: 2020 2020 2073 656c 662e 5f64 6174 615f       self._data_
-00021880: 666f 726d 6174 203d 2064 6174 615f 666f  format = data_fo
-00021890: 726d 6174 2e75 7070 6572 2829 2069 6620  rmat.upper() if 
-000218a0: 6461 7461 5f66 6f72 6d61 7420 656c 7365  data_format else
-000218b0: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
-000218c0: 6c66 2e5f 7061 7468 203d 2070 6174 680a  lf._path = path.
-000218d0: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
-000218e0: 6561 7475 7265 7320 3d20 5b0a 2020 2020  eatures = [.    
-000218f0: 2020 2020 2020 2020 6665 6174 7572 652e          feature.
-00021900: 4665 6174 7572 652e 6672 6f6d 5f72 6573  Feature.from_res
-00021910: 706f 6e73 655f 6a73 6f6e 2866 6561 7429  ponse_json(feat)
-00021920: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
-00021930: 6561 742c 2064 6963 7429 2065 6c73 6520  eat, dict) else 
-00021940: 6665 6174 0a20 2020 2020 2020 2020 2020  feat.           
-00021950: 2066 6f72 2066 6561 7420 696e 2028 6665   for feat in (fe
-00021960: 6174 7572 6573 206f 7220 5b5d 290a 2020  atures or []).  
-00021970: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
-00021980: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
-00021990: 726f 7570 5f65 6e67 696e 6520 3d20 280a  roup_engine = (.
-000219a0: 2020 2020 2020 2020 2020 2020 6578 7465              exte
-000219b0: 726e 616c 5f66 6561 7475 7265 5f67 726f  rnal_feature_gro
-000219c0: 7570 5f65 6e67 696e 652e 4578 7465 726e  up_engine.Extern
-000219d0: 616c 4665 6174 7572 6547 726f 7570 456e  alFeatureGroupEn
-000219e0: 6769 6e65 2866 6561 7475 7265 7374 6f72  gine(featurestor
-000219f0: 655f 6964 290a 2020 2020 2020 2020 290a  e_id).        ).
-00021a00: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
-00021a10: 2e5f 6964 3a0a 2020 2020 2020 2020 2020  ._id:.          
-00021a20: 2020 2320 476f 7420 6672 6f6d 2048 6f70    # Got from Hop
-00021a30: 7377 6f72 6b73 2c20 6465 7365 7269 616c  sworks, deserial
-00021a40: 697a 6520 6665 6174 7572 6573 2061 6e64  ize features and
-00021a50: 2073 746f 7261 6765 2063 6f6e 6e65 6374   storage connect
-00021a60: 6f72 0a20 2020 2020 2020 2020 2020 2073  or.            s
-00021a70: 656c 662e 5f66 6561 7475 7265 7320 3d20  elf._features = 
-00021a80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00021a90: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
-00021aa0: 2020 2020 2020 2020 6665 6174 7572 652e          feature.
-00021ab0: 4665 6174 7572 652e 6672 6f6d 5f72 6573  Feature.from_res
-00021ac0: 706f 6e73 655f 6a73 6f6e 2866 6561 7429  ponse_json(feat)
-00021ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021ae0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00021af0: 6365 2866 6561 742c 2064 6963 7429 0a20  ce(feat, dict). 
-00021b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b10: 2020 2065 6c73 6520 6665 6174 0a20 2020     else feat.   
-00021b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b30: 2066 6f72 2066 6561 7420 696e 2066 6561   for feat in fea
-00021b40: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
-00021b50: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
-00021b60: 2020 2020 2020 2020 6966 2066 6561 7475          if featu
-00021b70: 7265 730a 2020 2020 2020 2020 2020 2020  res.            
-00021b80: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
-00021b90: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
-00021ba0: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
-00021bb0: 6d61 7279 5f6b 6579 203d 2028 0a20 2020  mary_key = (.   
-00021bc0: 2020 2020 2020 2020 2020 2020 205b 6665               [fe
-00021bd0: 6174 2e6e 616d 6520 666f 7220 6665 6174  at.name for feat
-00021be0: 2069 6e20 7365 6c66 2e5f 6665 6174 7572   in self._featur
-00021bf0: 6573 2069 6620 6665 6174 2e70 7269 6d61  es if feat.prima
-00021c00: 7279 2069 7320 5472 7565 5d0a 2020 2020  ry is True].    
-00021c10: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00021c20: 656c 662e 5f66 6561 7475 7265 730a 2020  elf._features.  
-00021c30: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00021c40: 7365 205b 5d0a 2020 2020 2020 2020 2020  se [].          
-00021c50: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
-00021c60: 7365 6c66 2e73 7461 7469 7374 6963 735f  self.statistics_
-00021c70: 636f 6e66 6967 203d 2073 7461 7469 7374  config = statist
-00021c80: 6963 735f 636f 6e66 6967 0a0a 2020 2020  ics_config..    
-00021c90: 2020 2020 2020 2020 7365 6c66 2e5f 6f70          self._op
-00021ca0: 7469 6f6e 7320 3d20 280a 2020 2020 2020  tions = (.      
-00021cb0: 2020 2020 2020 2020 2020 7b6f 7074 696f            {optio
-00021cc0: 6e5b 226e 616d 6522 5d3a 206f 7074 696f  n["name"]: optio
-00021cd0: 6e5b 2276 616c 7565 225d 2066 6f72 206f  n["value"] for o
-00021ce0: 7074 696f 6e20 696e 206f 7074 696f 6e73  ption in options
-00021cf0: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
-00021d00: 2020 6966 206f 7074 696f 6e73 0a20 2020    if options.   
-00021d10: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00021d20: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
-00021d30: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
-00021d40: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
-00021d50: 656c 662e 7072 696d 6172 795f 6b65 7920  elf.primary_key 
-00021d60: 3d20 7072 696d 6172 795f 6b65 790a 2020  = primary_key.  
-00021d70: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
-00021d80: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
-00021d90: 203d 2073 7461 7469 7374 6963 735f 636f   = statistics_co
-00021da0: 6e66 6967 0a20 2020 2020 2020 2020 2020  nfig.           
-00021db0: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
-00021dc0: 3d20 6665 6174 7572 6573 0a20 2020 2020  = features.     
-00021dd0: 2020 2020 2020 2073 656c 662e 5f6f 7074         self._opt
-00021de0: 696f 6e73 203d 206f 7074 696f 6e73 0a0a  ions = options..
-00021df0: 2020 2020 2020 2020 6966 2073 746f 7261          if stora
-00021e00: 6765 5f63 6f6e 6e65 6374 6f72 2069 7320  ge_connector is 
-00021e10: 6e6f 7420 4e6f 6e65 2061 6e64 2069 7369  not None and isi
-00021e20: 6e73 7461 6e63 6528 7374 6f72 6167 655f  nstance(storage_
-00021e30: 636f 6e6e 6563 746f 722c 2064 6963 7429  connector, dict)
-00021e40: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
-00021e50: 6c66 2e5f 7374 6f72 6167 655f 636f 6e6e  lf._storage_conn
-00021e60: 6563 746f 7220 3d20 7363 2e53 746f 7261  ector = sc.Stora
-00021e70: 6765 436f 6e6e 6563 746f 722e 6672 6f6d  geConnector.from
-00021e80: 5f72 6573 706f 6e73 655f 6a73 6f6e 280a  _response_json(.
-00021e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021ea0: 7374 6f72 6167 655f 636f 6e6e 6563 746f  storage_connecto
-00021eb0: 720a 2020 2020 2020 2020 2020 2020 290a  r.            ).
-00021ec0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
-00021ed0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00021ee0: 7374 6f72 6167 655f 636f 6e6e 6563 746f  storage_connecto
-00021ef0: 7220 3d20 7374 6f72 6167 655f 636f 6e6e  r = storage_conn
-00021f00: 6563 746f 720a 0a20 2020 2020 2020 2073  ector..        s
-00021f10: 656c 662e 5f68 7265 6620 3d20 6872 6566  elf._href = href
-00021f20: 0a0a 2020 2020 6465 6620 7361 7665 2873  ..    def save(s
-00021f30: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
-00021f40: 2250 6572 7369 7374 2074 6865 206d 6574  "Persist the met
-00021f50: 6164 6174 6120 666f 7220 7468 6973 2065  adata for this e
-00021f60: 7874 6572 6e61 6c20 6665 6174 7572 6520  xternal feature 
-00021f70: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
-00021f80: 5769 7468 6f75 7420 6361 6c6c 696e 6720  Without calling 
-00021f90: 7468 6973 206d 6574 686f 642c 2079 6f75  this method, you
-00021fa0: 7220 6665 6174 7572 6520 6772 6f75 7020  r feature group 
-00021fb0: 7769 6c6c 206f 6e6c 7920 6578 6973 740a  will only exist.
-00021fc0: 2020 2020 2020 2020 696e 2079 6f75 7220          in your 
-00021fd0: 5079 7468 6f6e 204b 6572 6e65 6c2c 2062  Python Kernel, b
-00021fe0: 7574 206e 6f74 2069 6e20 486f 7073 776f  ut not in Hopswo
-00021ff0: 726b 732e 0a0a 2020 2020 2020 2020 6060  rks...        ``
-00022000: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
-00022010: 7175 6572 7920 3d20 2253 454c 4543 5420  query = "SELECT 
-00022020: 2a20 4652 4f4d 2073 616c 6573 220a 0a20  * FROM sales".. 
-00022030: 2020 2020 2020 2066 6720 3d20 6665 6174         fg = feat
-00022040: 7572 655f 7374 6f72 652e 6372 6561 7465  ure_store.create
-00022050: 5f65 7874 6572 6e61 6c5f 6665 6174 7572  _external_featur
-00022060: 655f 6772 6f75 7028 6e61 6d65 3d22 7361  e_group(name="sa
-00022070: 6c65 7322 2c0a 2020 2020 2020 2020 2020  les",.          
-00022080: 2020 7665 7273 696f 6e3d 312c 0a20 2020    version=1,.   
-00022090: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
-000220a0: 7469 6f6e 3d22 5068 7973 6963 616c 2073  tion="Physical s
-000220b0: 686f 7020 7361 6c65 7320 6665 6174 7572  hop sales featur
-000220c0: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
-000220d0: 2071 7565 7279 3d71 7565 7279 2c0a 2020   query=query,.  
-000220e0: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
-000220f0: 655f 636f 6e6e 6563 746f 723d 636f 6e6e  e_connector=conn
-00022100: 6563 746f 722c 0a20 2020 2020 2020 2020  ector,.         
-00022110: 2020 2070 7269 6d61 7279 5f6b 6579 3d5b     primary_key=[
-00022120: 2773 735f 7374 6f72 655f 736b 275d 2c0a  'ss_store_sk'],.
-00022130: 2020 2020 2020 2020 2020 2020 6576 656e              even
-00022140: 745f 7469 6d65 3d27 7361 6c65 5f64 6174  t_time='sale_dat
-00022150: 6527 0a20 2020 2020 2020 2029 0a0a 2020  e'.        )..  
-00022160: 2020 2020 2020 6667 2e73 6176 6528 290a        fg.save().
-00022170: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
-00022180: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
-00022190: 655f 6772 6f75 705f 656e 6769 6e65 2e73  e_group_engine.s
-000221a0: 6176 6528 7365 6c66 290a 2020 2020 2020  ave(self).      
-000221b0: 2020 7365 6c66 2e5f 636f 6465 5f65 6e67    self._code_eng
-000221c0: 696e 652e 7361 7665 5f63 6f64 6528 7365  ine.save_code(se
-000221d0: 6c66 290a 0a20 2020 2020 2020 2069 6620  lf)..        if 
-000221e0: 7365 6c66 2e73 7461 7469 7374 6963 735f  self.statistics_
-000221f0: 636f 6e66 6967 2e65 6e61 626c 6564 3a0a  config.enabled:.
-00022200: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00022210: 2e5f 7374 6174 6973 7469 6373 5f65 6e67  ._statistics_eng
-00022220: 696e 652e 636f 6d70 7574 655f 616e 645f  ine.compute_and_
-00022230: 7361 7665 5f73 7461 7469 7374 6963 7328  save_statistics(
-00022240: 7365 6c66 290a 0a20 2020 2064 6566 2069  self)..    def i
-00022250: 6e73 6572 7428 0a20 2020 2020 2020 2073  nsert(.        s
-00022260: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
-00022270: 7475 7265 733a 2055 6e69 6f6e 5b0a 2020  tures: Union[.  
-00022280: 2020 2020 2020 2020 2020 7064 2e44 6174            pd.Dat
-00022290: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
-000222a0: 2020 2020 5479 7065 5661 7228 2270 7973      TypeVar("pys
-000222b0: 7061 726b 2e73 716c 2e44 6174 6146 7261  park.sql.DataFra
-000222c0: 6d65 2229 2c20 2023 206e 6f71 613a 2046  me"),  # noqa: F
-000222d0: 3832 310a 2020 2020 2020 2020 2020 2020  821.            
-000222e0: 5479 7065 5661 7228 2270 7973 7061 726b  TypeVar("pyspark
-000222f0: 2e52 4444 2229 2c20 2023 206e 6f71 613a  .RDD"),  # noqa:
-00022300: 2046 3832 310a 2020 2020 2020 2020 2020   F821.          
-00022310: 2020 6e70 2e6e 6461 7272 6179 2c0a 2020    np.ndarray,.  
-00022320: 2020 2020 2020 2020 2020 4c69 7374 5b6c            List[l
-00022330: 6973 745d 2c0a 2020 2020 2020 2020 5d2c  ist],.        ],
-00022340: 0a20 2020 2020 2020 2077 7269 7465 5f6f  .        write_o
-00022350: 7074 696f 6e73 3a20 4f70 7469 6f6e 616c  ptions: Optional
-00022360: 5b44 6963 745b 7374 722c 2041 6e79 5d5d  [Dict[str, Any]]
-00022370: 203d 207b 7d2c 0a20 2020 2020 2020 2076   = {},.        v
-00022380: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
-00022390: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
-000223a0: 5b73 7472 2c20 416e 795d 5d20 3d20 7b7d  [str, Any]] = {}
-000223b0: 2c0a 2020 2020 2020 2020 7361 7665 5f63  ,.        save_c
-000223c0: 6f64 653a 204f 7074 696f 6e61 6c5b 626f  ode: Optional[bo
-000223d0: 6f6c 5d20 3d20 5472 7565 2c0a 2020 2020  ol] = True,.    
-000223e0: 2020 2020 7761 6974 3a20 626f 6f6c 203d      wait: bool =
-000223f0: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
-00022400: 2054 7570 6c65 5b4f 7074 696f 6e61 6c5b   Tuple[Optional[
-00022410: 4a6f 625d 2c20 4f70 7469 6f6e 616c 5b56  Job], Optional[V
-00022420: 616c 6964 6174 696f 6e52 6570 6f72 745d  alidationReport]
-00022430: 5d3a 0a20 2020 2020 2020 2022 2222 496e  ]:.        """In
-00022440: 7365 7274 2074 6865 2064 6174 6166 7261  sert the datafra
-00022450: 6d65 2066 6561 7475 7265 2076 616c 7565  me feature value
-00022460: 7320 4f4e 4c59 2069 6e20 7468 6520 6f6e  s ONLY in the on
-00022470: 6c69 6e65 2066 6561 7475 7265 2073 746f  line feature sto
-00022480: 7265 2e0a 0a20 2020 2020 2020 2045 7874  re...        Ext
-00022490: 6572 6e61 6c20 4665 6174 7572 6520 4772  ernal Feature Gr
-000224a0: 6f75 7073 2063 6f6e 7461 696e 7320 6d65  oups contains me
-000224b0: 7461 6461 7461 2061 626f 7574 2066 6561  tadata about fea
-000224c0: 7475 7265 2064 6174 6120 696e 2061 6e20  ture data in an 
-000224d0: 6578 7465 726e 616c 2073 746f 7261 6765  external storage
-000224e0: 2073 7973 7465 6d2e 0a20 2020 2020 2020   system..       
-000224f0: 2045 7874 6572 6e61 6c20 7374 6f72 6167   External storag
-00022500: 6520 7379 7374 656d 2061 7265 2075 7375  e system are usu
-00022510: 616c 6c79 206f 6666 6c69 6e65 2c20 6d65  ally offline, me
-00022520: 616e 696e 6720 6665 6174 7572 6520 7661  aning feature va
-00022530: 6c75 6573 2063 616e 6e6f 7420 6265 2072  lues cannot be r
-00022540: 6574 7269 6576 6564 2069 6e20 7265 616c  etrieved in real
-00022550: 2d74 696d 652e 0a20 2020 2020 2020 2049  -time..        I
-00022560: 6e20 6f72 6465 7220 746f 2075 7365 2074  n order to use t
-00022570: 6865 2066 6561 7475 7265 2076 616c 7565  he feature value
-00022580: 7320 666f 7220 7265 616c 2d74 696d 6520  s for real-time 
-00022590: 7573 652d 6361 7365 732c 2079 6f75 2063  use-cases, you c
-000225a0: 616e 2069 6e73 6572 7420 7468 656d 0a20  an insert them. 
-000225b0: 2020 2020 2020 2069 6e20 486f 7073 6f77         in Hopsow
-000225c0: 6f72 6b73 204f 6e6c 696e 6520 4665 6174  orks Online Feat
-000225d0: 7572 6520 5374 6f72 6520 7669 6120 7468  ure Store via th
-000225e0: 6973 206d 6574 686f 642e 0a0a 2020 2020  is method...    
-000225f0: 2020 2020 5468 6520 4f6e 6c69 6e65 2046      The Online F
-00022600: 6561 7475 7265 2053 746f 7265 2068 6173  eature Store has
-00022610: 2061 2073 696e 676c 652d 656e 7472 7920   a single-entry 
-00022620: 7065 7220 7072 696d 6172 7920 6b65 7920  per primary key 
-00022630: 7661 6c75 652c 206d 6561 696e 696e 6720  value, meaining 
-00022640: 7468 6174 2070 726f 7669 6469 6e67 2061  that providing a
-00022650: 206e 6577 2076 616c 7565 2077 6974 680a   new value with.
-00022660: 2020 2020 2020 2020 666f 7220 6120 6769          for a gi
-00022670: 7665 6e20 7072 696d 6172 7920 6b65 7920  ven primary key 
-00022680: 7769 6c6c 206f 7665 7277 7269 7465 2074  will overwrite t
-00022690: 6865 2065 7869 7374 696e 6720 7661 6c75  he existing valu
-000226a0: 652e 204e 6f20 7265 636f 7264 206f 6620  e. No record of 
-000226b0: 7468 6520 7072 6576 696f 7573 2076 616c  the previous val
-000226c0: 7565 2069 7320 6b65 7074 2e0a 0a20 2020  ue is kept...   
-000226d0: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
-000226e0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
-000226f0: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
-00022700: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
-00022710: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
-00022720: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
-00022730: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
-00022740: 2020 2020 2320 6765 7420 7468 6520 4578      # get the Ex
-00022750: 7465 726e 616c 2046 6561 7475 7265 2047  ternal Feature G
-00022760: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
-00022770: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
-00022780: 732e 6765 745f 6665 6174 7572 655f 6772  s.get_feature_gr
-00022790: 6f75 7028 6e61 6d65 3d22 6578 7465 726e  oup(name="extern
-000227a0: 616c 5f73 616c 6573 5f72 6563 6f72 6473  al_sales_records
-000227b0: 222c 2076 6572 7369 6f6e 3d31 290a 0a20  ", version=1).. 
-000227c0: 2020 2020 2020 2020 2020 2023 2067 6574             # get
-000227d0: 2074 6865 2066 6561 7475 7265 2076 616c   the feature val
-000227e0: 7565 732c 2065 2e67 2072 6561 6469 6e67  ues, e.g reading
-000227f0: 2066 726f 6d20 6373 7620 6669 6c65 7320   from csv files 
-00022800: 696e 2061 2053 3320 6275 636b 6574 0a20  in a S3 bucket. 
-00022810: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00022820: 7265 5f76 616c 7565 7320 3d20 2e2e 2e0a  re_values = ....
-00022830: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
-00022840: 6e73 6572 7420 7468 6520 6665 6174 7572  nsert the featur
-00022850: 6520 7661 6c75 6573 2069 6e20 7468 6520  e values in the 
-00022860: 6f6e 6c69 6e65 2066 6561 7475 7265 2073  online feature s
-00022870: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
-00022880: 2066 672e 696e 7365 7274 2866 6561 7475   fg.insert(featu
-00022890: 7265 5f76 616c 7565 7329 0a20 2020 2020  re_values).     
-000228a0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-000228b0: 2020 2020 2121 2120 4e6f 7465 0a20 2020      !!! Note.   
-000228c0: 2020 2020 2020 2020 2044 6174 6120 5661           Data Va
-000228d0: 6c69 6461 7469 6f6e 2076 6961 2047 7265  lidation via Gre
-000228e0: 6174 2045 7870 6563 7461 7469 6f6e 2069  at Expectation i
-000228f0: 7320 7375 7070 6f72 7465 6420 6966 2079  s supported if y
-00022900: 6f75 2068 6176 6520 6174 7461 6368 6564  ou have attached
-00022910: 2061 6e20 6578 7065 6374 6174 696f 6e20   an expectation 
-00022920: 7375 6974 6520 746f 0a20 2020 2020 2020  suite to.       
-00022930: 2020 2020 2079 6f75 7220 4578 7465 726e       your Extern
-00022940: 616c 2046 6561 7475 7265 2047 726f 7570  al Feature Group
-00022950: 2e20 486f 7765 7665 722c 2061 7320 6f70  . However, as op
-00022960: 706f 7365 6420 746f 2072 6567 756c 6172  posed to regular
-00022970: 2046 6561 7475 7265 2047 726f 7570 732c   Feature Groups,
-00022980: 2074 6869 7320 6361 6e20 6c65 6164 2074   this can lead t
-00022990: 6f0a 2020 2020 2020 2020 2020 2020 6469  o.            di
-000229a0: 7363 7265 7061 6e63 6965 7320 6265 7477  screpancies betw
-000229b0: 6565 6e20 7468 6520 6461 7461 2069 6e20  een the data in 
-000229c0: 7468 6520 6578 7465 726e 616c 2073 746f  the external sto
-000229d0: 7261 6765 2073 7973 7465 6d20 616e 6420  rage system and 
-000229e0: 7468 6520 6f6e 6c69 6e65 2066 6561 7475  the online featu
-000229f0: 7265 2073 746f 7265 2e0a 0a20 2020 2020  re store...     
-00022a00: 2020 2023 2041 7267 756d 656e 7473 0a20     # Arguments. 
-00022a10: 2020 2020 2020 2020 2020 2066 6561 7475             featu
-00022a20: 7265 733a 2044 6174 6146 7261 6d65 2c20  res: DataFrame, 
-00022a30: 5244 442c 204e 6461 7272 6179 2c20 6c69  RDD, Ndarray, li
-00022a40: 7374 2e20 4665 6174 7572 6573 2074 6f20  st. Features to 
-00022a50: 6265 2073 6176 6564 2e0a 2020 2020 2020  be saved..      
-00022a60: 2020 2020 2020 7772 6974 655f 6f70 7469        write_opti
-00022a70: 6f6e 733a 2041 6464 6974 696f 6e61 6c20  ons: Additional 
-00022a80: 7772 6974 6520 6f70 7469 6f6e 7320 6173  write options as
-00022a90: 206b 6579 2d76 616c 7565 2070 6169 7273   key-value pairs
-00022aa0: 2c20 6465 6661 756c 7473 2074 6f20 607b  , defaults to `{
-00022ab0: 7d60 2e0a 2020 2020 2020 2020 2020 2020  }`..            
-00022ac0: 2020 2020 5768 656e 2075 7369 6e67 2074      When using t
-00022ad0: 6865 2060 7079 7468 6f6e 6020 656e 6769  he `python` engi
-00022ae0: 6e65 2c20 7772 6974 655f 6f70 7469 6f6e  ne, write_option
-00022af0: 7320 6361 6e20 636f 6e74 6169 6e20 7468  s can contain th
-00022b00: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
-00022b10: 2020 666f 6c6c 6f77 696e 6720 656e 7472    following entr
-00022b20: 6965 733a 0a20 2020 2020 2020 2020 2020  ies:.           
-00022b30: 2020 2020 202a 206b 6579 2060 6b61 666b       * key `kafk
-00022b40: 615f 7072 6f64 7563 6572 5f63 6f6e 6669  a_producer_confi
-00022b50: 6760 2061 6e64 2076 616c 7565 2061 6e20  g` and value an 
-00022b60: 6f62 6a65 6374 206f 6620 7479 7065 205b  object of type [
-00022b70: 7072 6f70 6572 7469 6573 5d28 6874 7470  properties](http
-00022b80: 733a 2f2f 646f 6373 2e63 6f6e 666c 7565  s://docs.conflue
-00022b90: 6e74 2e69 6f2f 706c 6174 666f 726d 2f63  nt.io/platform/c
-00022ba0: 7572 7265 6e74 2f63 6c69 656e 7473 2f6c  urrent/clients/l
-00022bb0: 6962 7264 6b61 666b 612f 6874 6d6c 2f6d  ibrdkafka/html/m
-00022bc0: 645f 434f 4e46 4947 5552 4154 494f 4e2e  d_CONFIGURATION.
-00022bd0: 6874 6d6c 6e29 0a20 2020 2020 2020 2020  htmln).         
-00022be0: 2020 2020 2020 2020 2075 7365 6420 746f           used to
-00022bf0: 2063 6f6e 6669 6775 7265 2074 6865 204b   configure the K
-00022c00: 6166 6b61 2063 6c69 656e 742e 2054 6f20  afka client. To 
-00022c10: 6f70 7469 6d69 7a65 2066 6f72 2074 6872  optimize for thr
-00022c20: 6f75 6768 7075 7420 696e 2068 6967 6820  oughput in high 
-00022c30: 6c61 7465 6e63 7920 636f 6e6e 6563 7469  latency connecti
-00022c40: 6f6e 2063 6f6e 7369 6465 720a 2020 2020  on consider.    
-00022c50: 2020 2020 2020 2020 2020 2020 2020 6368                ch
-00022c60: 616e 6769 6e67 205b 7072 6f64 7563 6572  anging [producer
-00022c70: 2070 726f 7065 7274 6965 735d 2868 7474   properties](htt
-00022c80: 7073 3a2f 2f64 6f63 732e 636f 6e66 6c75  ps://docs.conflu
-00022c90: 656e 742e 696f 2f63 6c6f 7564 2f63 7572  ent.io/cloud/cur
-00022ca0: 7265 6e74 2f63 6c69 656e 742d 6170 7073  rent/client-apps
-00022cb0: 2f6f 7074 696d 697a 696e 672f 7468 726f  /optimizing/thro
-00022cc0: 7567 6870 7574 2e68 746d 6c23 7072 6f64  ughput.html#prod
-00022cd0: 7563 6572 292e 0a20 2020 2020 2020 2020  ucer)..         
-00022ce0: 2020 2020 2020 202a 206b 6579 2060 696e         * key `in
-00022cf0: 7465 726e 616c 5f6b 6166 6b61 6020 616e  ternal_kafka` an
-00022d00: 6420 7661 6c75 6520 6054 7275 6560 206f  d value `True` o
-00022d10: 7220 6046 616c 7365 6020 696e 2063 6173  r `False` in cas
-00022d20: 6520 796f 7520 6573 7461 626c 6973 6865  e you establishe
-00022d30: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
-00022d40: 2020 2020 636f 6e6e 6563 7469 7669 7479      connectivity
-00022d50: 2066 726f 6d20 796f 7520 5079 7468 6f6e   from you Python
-00022d60: 2065 6e76 6972 6f6e 6d65 6e74 2074 6f20   environment to 
-00022d70: 7468 6520 696e 7465 726e 616c 2061 6476  the internal adv
-00022d80: 6572 7469 7365 640a 2020 2020 2020 2020  ertised.        
-00022d90: 2020 2020 2020 2020 2020 6c69 7374 656e            listen
-00022da0: 6572 7320 6f66 2074 6865 2048 6f70 7377  ers of the Hopsw
-00022db0: 6f72 6b73 204b 6166 6b61 2043 6c75 7374  orks Kafka Clust
-00022dc0: 6572 2e20 4465 6661 756c 7473 2074 6f20  er. Defaults to 
-00022dd0: 6046 616c 7365 6020 616e 640a 2020 2020  `False` and.    
-00022de0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
-00022df0: 6c6c 2075 7365 2065 7874 6572 6e61 6c20  ll use external 
-00022e00: 6c69 7374 656e 6572 7320 7768 656e 2063  listeners when c
-00022e10: 6f6e 6e65 6374 696e 6720 6672 6f6d 206f  onnecting from o
-00022e20: 7574 7369 6465 206f 6620 486f 7073 776f  utside of Hopswo
-00022e30: 726b 732e 0a20 2020 2020 2020 2020 2020  rks..           
-00022e40: 2076 616c 6964 6174 696f 6e5f 6f70 7469   validation_opti
-00022e50: 6f6e 733a 2041 6464 6974 696f 6e61 6c20  ons: Additional 
-00022e60: 7661 6c69 6461 7469 6f6e 206f 7074 696f  validation optio
-00022e70: 6e73 2061 7320 6b65 792d 7661 6c75 6520  ns as key-value 
-00022e80: 7061 6972 732c 2064 6566 6175 6c74 7320  pairs, defaults 
-00022e90: 746f 2060 7b7d 602e 0a20 2020 2020 2020  to `{}`..       
-00022ea0: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
-00022eb0: 7275 6e5f 7661 6c69 6461 7469 6f6e 6020  run_validation` 
-00022ec0: 626f 6f6c 6561 6e20 7661 6c75 652c 2073  boolean value, s
-00022ed0: 6574 2074 6f20 6046 616c 7365 6020 746f  et to `False` to
-00022ee0: 2073 6b69 7020 7661 6c69 6461 7469 6f6e   skip validation
-00022ef0: 2074 656d 706f 7261 7269 6c79 206f 6e20   temporarily on 
-00022f00: 696e 6765 7374 696f 6e2e 0a20 2020 2020  ingestion..     
-00022f10: 2020 2020 2020 2020 2020 202a 206b 6579             * key
-00022f20: 2060 7361 7665 5f72 6570 6f72 7460 2062   `save_report` b
-00022f30: 6f6f 6c65 616e 2076 616c 7565 2c20 7365  oolean value, se
-00022f40: 7420 746f 2060 4661 6c73 6560 2074 6f20  t to `False` to 
-00022f50: 736b 6970 2075 706c 6f61 6420 6f66 2074  skip upload of t
-00022f60: 6865 2076 616c 6964 6174 696f 6e20 7265  he validation re
-00022f70: 706f 7274 2074 6f20 486f 7073 776f 726b  port to Hopswork
-00022f80: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
-00022f90: 2020 202a 206b 6579 2060 6765 5f76 616c     * key `ge_val
-00022fa0: 6964 6174 655f 6b77 6172 6773 6020 6120  idate_kwargs` a 
-00022fb0: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
-00022fc0: 696e 696e 6720 6b77 6172 6773 2066 6f72  ining kwargs for
-00022fd0: 2074 6865 2076 616c 6964 6174 6520 6d65   the validate me
-00022fe0: 7468 6f64 206f 6620 4772 6561 7420 4578  thod of Great Ex
-00022ff0: 7065 6374 6174 696f 6e73 2e0a 2020 2020  pectations..    
-00023000: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
-00023010: 7920 6066 6574 6368 5f65 7870 6563 7461  y `fetch_expecta
-00023020: 7469 6f6e 5f73 7569 7465 6020 6120 626f  tion_suite` a bo
-00023030: 6f6c 6561 6e20 7661 6c75 652c 2062 7920  olean value, by 
-00023040: 6465 6661 756c 7420 6054 7275 6560 2c20  default `True`, 
-00023050: 746f 2063 6f6e 7472 6f6c 2077 6865 7468  to control wheth
-00023060: 6572 2074 6865 2065 7870 6563 7461 7469  er the expectati
-00023070: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
-00023080: 2020 2020 2020 7375 6974 6520 6f66 2074        suite of t
-00023090: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-000230a0: 2073 686f 756c 6420 6265 2066 6574 6368   should be fetch
-000230b0: 6564 2062 6566 6f72 6520 6576 6572 7920  ed before every 
-000230c0: 696e 7365 7274 2e0a 2020 2020 2020 2020  insert..        
-000230d0: 2020 2020 7361 7665 5f63 6f64 653a 2057      save_code: W
-000230e0: 6865 6e20 7275 6e6e 696e 6720 4853 4653  hen running HSFS
-000230f0: 206f 6e20 486f 7073 776f 726b 7320 6f72   on Hopsworks or
-00023100: 2044 6174 6162 7269 636b 732c 2048 5346   Databricks, HSF
-00023110: 5320 6361 6e20 7361 7665 2074 6865 2063  S can save the c
-00023120: 6f64 652f 6e6f 7465 626f 6f6b 2075 7365  ode/notebook use
-00023130: 6420 746f 2063 7265 6174 650a 2020 2020  d to create.    
-00023140: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00023150: 6665 6174 7572 6520 6772 6f75 7020 6f72  feature group or
-00023160: 2075 7365 6420 746f 2069 6e73 6572 7420   used to insert 
-00023170: 6461 7461 2074 6f20 6974 2e20 5768 656e  data to it. When
-00023180: 2063 616c 6c69 6e67 2074 6865 2060 696e   calling the `in
-00023190: 7365 7274 6020 6d65 7468 6f64 2072 6570  sert` method rep
-000231a0: 6561 7465 646c 790a 2020 2020 2020 2020  eatedly.        
-000231b0: 2020 2020 2020 2020 7769 7468 2073 6d61          with sma
-000231c0: 6c6c 2062 6174 6368 6573 206f 6620 6461  ll batches of da
-000231d0: 7461 2c20 7468 6973 2063 616e 2073 6c6f  ta, this can slo
-000231e0: 7720 646f 776e 2074 6865 2077 7269 7465  w down the write
-000231f0: 732e 2055 7365 2074 6869 7320 6f70 7469  s. Use this opti
-00023200: 6f6e 2074 6f20 7475 726e 206f 6666 2073  on to turn off s
-00023210: 6176 696e 670a 2020 2020 2020 2020 2020  aving.          
-00023220: 2020 2020 2020 636f 6465 2e20 4465 6661        code. Defa
-00023230: 756c 7473 2074 6f20 6054 7275 6560 2e0a  ults to `True`..
-00023240: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
-00023250: 6e73 0a20 2020 2020 2020 2020 2020 2054  ns.            T
-00023260: 7570 6c65 2860 4a6f 6260 2c20 6056 616c  uple(`Job`, `Val
-00023270: 6964 6174 696f 6e52 6570 6f72 7460 2920  idationReport`) 
-00023280: 5468 6520 7661 6c69 6461 7469 6f6e 2072  The validation r
-00023290: 6570 6f72 7420 6966 2076 616c 6964 6174  eport if validat
-000232a0: 696f 6e20 6973 2065 6e61 626c 6564 2e0a  ion is enabled..
-000232b0: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
-000232c0: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
-000232d0: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
-000232e0: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
-000232f0: 6f72 602e 2065 2e67 2066 6169 6c20 746f  or`. e.g fail to
-00023300: 2063 7265 6174 6520 6665 6174 7572 6520   create feature 
-00023310: 6772 6f75 702c 2064 6174 6166 7261 6d65  group, dataframe
-00023320: 2073 6368 656d 6120 646f 6573 206e 6f74   schema does not
-00023330: 206d 6174 6368 0a20 2020 2020 2020 2020   match.         
-00023340: 2020 2020 2020 2065 7869 7374 696e 6720         existing 
-00023350: 6665 6174 7572 6520 6772 6f75 7020 7363  feature group sc
-00023360: 6865 6d61 2c20 6574 632e 0a20 2020 2020  hema, etc..     
-00023370: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
-00023380: 656e 742e 6578 6365 7074 696f 6e73 2e44  ent.exceptions.D
-00023390: 6174 6156 616c 6964 6174 696f 6e45 7863  ataValidationExc
-000233a0: 6570 7469 6f6e 602e 2049 6620 6461 7461  eption`. If data
-000233b0: 2076 616c 6964 6174 696f 6e20 6661 696c   validation fail
-000233c0: 7320 616e 6420 7468 6520 6578 7065 6374  s and the expect
-000233d0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
-000233e0: 2020 2020 2020 7375 6974 6520 6076 616c        suite `val
-000233f0: 6964 6174 696f 6e5f 696e 6765 7374 696f  idation_ingestio
-00023400: 6e5f 706f 6c69 6379 6020 6973 2073 6574  n_policy` is set
-00023410: 2074 6f20 6053 5452 4943 5460 2e20 4461   to `STRICT`. Da
-00023420: 7461 2069 7320 4e4f 5420 696e 6765 7374  ta is NOT ingest
-00023430: 6564 2e0a 0a20 2020 2020 2020 2022 2222  ed...        """
-00023440: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00023450: 5f64 6174 6166 7261 6d65 203d 2065 6e67  _dataframe = eng
-00023460: 696e 652e 6765 745f 696e 7374 616e 6365  ine.get_instance
-00023470: 2829 2e63 6f6e 7665 7274 5f74 6f5f 6465  ().convert_to_de
-00023480: 6661 756c 745f 6461 7461 6672 616d 6528  fault_dataframe(
-00023490: 6665 6174 7572 6573 290a 0a20 2020 2020  features)..     
-000234a0: 2020 2069 6620 7772 6974 655f 6f70 7469     if write_opti
-000234b0: 6f6e 7320 6973 204e 6f6e 653a 0a20 2020  ons is None:.   
-000234c0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
-000234d0: 7074 696f 6e73 203d 207b 7d0a 2020 2020  ptions = {}.    
-000234e0: 2020 2020 6966 2022 7761 6974 5f66 6f72      if "wait_for
-000234f0: 5f6a 6f62 2220 6e6f 7420 696e 2077 7269  _job" not in wri
-00023500: 7465 5f6f 7074 696f 6e73 3a0a 2020 2020  te_options:.    
-00023510: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
-00023520: 7469 6f6e 735b 2277 6169 745f 666f 725f  tions["wait_for_
-00023530: 6a6f 6222 5d20 3d20 7761 6974 0a0a 2020  job"] = wait..  
-00023540: 2020 2020 2020 6a6f 622c 2067 655f 7265        job, ge_re
-00023550: 706f 7274 203d 2073 656c 662e 5f66 6561  port = self._fea
-00023560: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
-00023570: 652e 696e 7365 7274 280a 2020 2020 2020  e.insert(.      
-00023580: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
-00023590: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
-000235a0: 6461 7461 6672 616d 653d 6665 6174 7572  dataframe=featur
-000235b0: 655f 6461 7461 6672 616d 652c 0a20 2020  e_dataframe,.   
-000235c0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
-000235d0: 7074 696f 6e73 3d77 7269 7465 5f6f 7074  ptions=write_opt
-000235e0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
-000235f0: 2020 7661 6c69 6461 7469 6f6e 5f6f 7074    validation_opt
-00023600: 696f 6e73 3d7b 2273 6176 655f 7265 706f  ions={"save_repo
-00023610: 7274 223a 2054 7275 652c 202a 2a76 616c  rt": True, **val
-00023620: 6964 6174 696f 6e5f 6f70 7469 6f6e 737d  idation_options}
-00023630: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
-00023640: 2020 2020 2069 6620 7361 7665 5f63 6f64       if save_cod
-00023650: 6520 616e 6420 280a 2020 2020 2020 2020  e and (.        
-00023660: 2020 2020 6765 5f72 6570 6f72 7420 6973      ge_report is
-00023670: 204e 6f6e 6520 6f72 2067 655f 7265 706f   None or ge_repo
-00023680: 7274 2e69 6e67 6573 7469 6f6e 5f72 6573  rt.ingestion_res
-00023690: 756c 7420 3d3d 2022 494e 4745 5354 4544  ult == "INGESTED
-000236a0: 220a 2020 2020 2020 2020 293a 0a20 2020  ".        ):.   
-000236b0: 2020 2020 2020 2020 2073 656c 662e 5f63           self._c
-000236c0: 6f64 655f 656e 6769 6e65 2e73 6176 655f  ode_engine.save_
-000236d0: 636f 6465 2873 656c 6629 0a0a 2020 2020  code(self)..    
-000236e0: 2020 2020 6966 2073 656c 662e 7374 6174      if self.stat
-000236f0: 6973 7469 6373 5f63 6f6e 6669 672e 656e  istics_config.en
-00023700: 6162 6c65 643a 0a20 2020 2020 2020 2020  abled:.         
-00023710: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
-00023720: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
-00023730: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
-00023740: 2020 2020 2020 2020 2253 7461 7469 7374          "Statist
-00023750: 6963 7320 6172 6520 6e6f 7420 636f 6d70  ics are not comp
-00023760: 7574 6564 2066 6f72 2069 6e73 6572 7469  uted for inserti
-00023770: 6f6e 2074 6f20 6f6e 6c69 6e65 2065 6e61  on to online ena
-00023780: 626c 6564 2065 7874 6572 6e61 6c20 6665  bled external fe
-00023790: 6174 7572 6520 6772 6f75 7020 607b 7d60  ature group `{}`
-000237a0: 2c20 7769 7468 2076 6572 7369 6f6e 220a  , with version".
-000237b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000237c0: 2020 2020 2220 607b 7d60 2e20 4361 6c6c      " `{}`. Call
-000237d0: 2060 636f 6d70 7574 655f 7374 6174 6973   `compute_statis
-000237e0: 7469 6373 6020 6578 706c 6963 6974 6c79  tics` explicitly
-000237f0: 2074 6f20 636f 6d70 7574 6520 7374 6174   to compute stat
-00023800: 6973 7469 6373 206f 7665 7220 7468 6520  istics over the 
-00023810: 6461 7461 2069 6e20 7468 6520 6578 7465  data in the exte
-00023820: 726e 616c 2073 746f 7261 6765 2073 7973  rnal storage sys
-00023830: 7465 6d2e 220a 2020 2020 2020 2020 2020  tem.".          
-00023840: 2020 2020 2020 292e 666f 726d 6174 2873        ).format(s
-00023850: 656c 662e 5f6e 616d 652c 2073 656c 662e  elf._name, self.
-00023860: 5f76 6572 7369 6f6e 292c 0a20 2020 2020  _version),.     
-00023870: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
-00023880: 5374 6f72 6167 6557 6172 6e69 6e67 2c0a  StorageWarning,.
-00023890: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-000238a0: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
-000238b0: 2020 2020 2020 2020 2020 2020 6a6f 622c              job,
-000238c0: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
-000238d0: 7265 706f 7274 2e74 6f5f 6765 5f74 7970  report.to_ge_typ
-000238e0: 6528 2920 6966 2067 655f 7265 706f 7274  e() if ge_report
-000238f0: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
-00023900: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
-00023910: 290a 0a20 2020 2064 6566 2072 6561 6428  )..    def read(
-00023920: 0a20 2020 2020 2020 2073 656c 662c 2064  .        self, d
-00023930: 6174 6166 7261 6d65 5f74 7970 653a 204f  ataframe_type: O
-00023940: 7074 696f 6e61 6c5b 7374 725d 203d 2022  ptional[str] = "
-00023950: 6465 6661 756c 7422 2c20 6f6e 6c69 6e65  default", online
-00023960: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
-00023970: 203d 2046 616c 7365 0a20 2020 2029 3a0a   = False.    ):.
-00023980: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
-00023990: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-000239a0: 2061 7320 6120 4461 7461 4672 616d 652e   as a DataFrame.
-000239b0: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
-000239c0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
-000239d0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
-000239e0: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
-000239f0: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
-00023a00: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
-00023a10: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
-00023a20: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-00023a30: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
-00023a40: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
-00023a50: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
-00023a60: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
-00023a70: 7572 655f 6772 6f75 7028 2e2e 2e29 0a0a  ure_group(...)..
-00023a80: 2020 2020 2020 2020 2020 2020 6466 203d              df =
-00023a90: 2066 672e 7265 6164 2829 0a20 2020 2020   fg.read().     
-00023aa0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
-00023ab0: 2020 2020 2121 2120 7761 726e 696e 6720      !!! warning 
-00023ac0: 2245 6e67 696e 6520 5375 7070 6f72 7422  "Engine Support"
-00023ad0: 0a20 2020 2020 2020 2020 2020 202a 2a53  .            **S
-00023ae0: 7061 726b 206f 6e6c 792a 2a0a 0a20 2020  park only**..   
-00023af0: 2020 2020 2020 2020 2052 6561 6469 6e67           Reading
-00023b00: 2061 6e20 4578 7465 726e 616c 2046 6561   an External Fea
-00023b10: 7475 7265 2047 726f 7570 2064 6972 6563  ture Group direc
-00023b20: 746c 7920 696e 746f 2061 2050 616e 6461  tly into a Panda
-00023b30: 7320 4461 7461 6672 616d 6520 7573 696e  s Dataframe usin
-00023b40: 670a 2020 2020 2020 2020 2020 2020 5079  g.            Py
-00023b50: 7468 6f6e 2f50 616e 6461 7320 6173 2045  thon/Pandas as E
-00023b60: 6e67 696e 6520 6973 206e 6f74 2073 7570  ngine is not sup
-00023b70: 706f 7274 6564 2c20 686f 7765 7665 722c  ported, however,
-00023b80: 2079 6f75 2063 616e 2075 7365 2074 6865   you can use the
-00023b90: 0a20 2020 2020 2020 2020 2020 2051 7565  .            Que
-00023ba0: 7279 2041 5049 2074 6f20 6372 6561 7465  ry API to create
-00023bb0: 2046 6561 7475 7265 2056 6965 7773 2f54   Feature Views/T
-00023bc0: 7261 696e 696e 6720 4461 7461 2063 6f6e  raining Data con
-00023bd0: 7461 696e 696e 6720 4578 7465 726e 616c  taining External
-00023be0: 0a20 2020 2020 2020 2020 2020 2046 6561  .            Fea
-00023bf0: 7475 7265 2047 726f 7570 732e 0a0a 2020  ture Groups...  
-00023c00: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
-00023c10: 730a 2020 2020 2020 2020 2020 2020 6461  s.            da
-00023c20: 7461 6672 616d 655f 7479 7065 3a20 7374  taframe_type: st
-00023c30: 722c 206f 7074 696f 6e61 6c2e 2050 6f73  r, optional. Pos
-00023c40: 7369 626c 6520 7661 6c75 6573 2061 7265  sible values are
-00023c50: 2060 2264 6566 6175 6c74 2260 2c20 6022   `"default"`, `"
-00023c60: 7370 6172 6b22 602c 0a20 2020 2020 2020  spark"`,.       
-00023c70: 2020 2020 2020 2020 2060 2270 616e 6461           `"panda
-00023c80: 7322 602c 2060 226e 756d 7079 2260 206f  s"`, `"numpy"` o
-00023c90: 7220 6022 7079 7468 6f6e 2260 2c20 6465  r `"python"`, de
-00023ca0: 6661 756c 7473 2074 6f20 6022 6465 6661  faults to `"defa
-00023cb0: 756c 7422 602e 0a20 2020 2020 2020 2020  ult"`..         
-00023cc0: 2020 206f 6e6c 696e 653a 2062 6f6f 6c2c     online: bool,
-00023cd0: 206f 7074 696f 6e61 6c2e 2049 6620 6054   optional. If `T
-00023ce0: 7275 6560 2072 6561 6420 6672 6f6d 206f  rue` read from o
-00023cf0: 6e6c 696e 6520 6665 6174 7572 6520 7374  nline feature st
-00023d00: 6f72 652c 2064 6566 6175 6c74 730a 2020  ore, defaults.  
-00023d10: 2020 2020 2020 2020 2020 2020 2020 746f                to
-00023d20: 2060 4661 6c73 6560 2e0a 0a20 2020 2020   `False`...     
-00023d30: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
-00023d40: 2020 2020 2020 2020 2060 4461 7461 4672           `DataFr
-00023d50: 616d 6560 3a20 5468 6520 7370 6172 6b20  ame`: The spark 
-00023d60: 6461 7461 6672 616d 6520 636f 6e74 6169  dataframe contai
-00023d70: 6e69 6e67 2074 6865 2066 6561 7475 7265  ning the feature
-00023d80: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
-00023d90: 2020 2060 7079 7370 6172 6b2e 4461 7461     `pyspark.Data
-00023da0: 4672 616d 6560 2e20 4120 5370 6172 6b20  Frame`. A Spark 
-00023db0: 4461 7461 4672 616d 652e 0a20 2020 2020  DataFrame..     
-00023dc0: 2020 2020 2020 2060 7061 6e64 6173 2e44         `pandas.D
-00023dd0: 6174 6146 7261 6d65 602e 2041 2050 616e  ataFrame`. A Pan
-00023de0: 6461 7320 4461 7461 4672 616d 652e 0a20  das DataFrame.. 
-00023df0: 2020 2020 2020 2020 2020 2060 6e75 6d70             `nump
-00023e00: 792e 6e64 6172 7261 7960 2e20 4120 7477  y.ndarray`. A tw
-00023e10: 6f2d 6469 6d65 6e73 696f 6e61 6c20 4e75  o-dimensional Nu
-00023e20: 6d70 7920 6172 7261 792e 0a20 2020 2020  mpy array..     
-00023e30: 2020 2020 2020 2060 6c69 7374 602e 2041         `list`. A
-00023e40: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
-00023e50: 2050 7974 686f 6e20 6c69 7374 2e0a 0a20   Python list... 
-00023e60: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
-00023e70: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
-00023e80: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
-00023e90: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
-00023ea0: 602e 0a20 2020 2020 2020 2022 2222 0a0a  `..        """..
-00023eb0: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
-00023ec0: 2020 2020 2020 2020 2065 6e67 696e 652e           engine.
-00023ed0: 6765 745f 7479 7065 2829 203d 3d20 2270  get_type() == "p
-00023ee0: 7974 686f 6e22 0a20 2020 2020 2020 2020  ython".         
-00023ef0: 2020 2061 6e64 206e 6f74 206f 6e6c 696e     and not onlin
-00023f00: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
-00023f10: 6420 6e6f 7420 656e 6769 6e65 2e67 6574  d not engine.get
-00023f20: 5f69 6e73 7461 6e63 6528 292e 6973 5f66  _instance().is_f
-00023f30: 6c79 696e 6764 7563 6b5f 7175 6572 795f  lyingduck_query_
-00023f40: 7375 7070 6f72 7465 6428 0a20 2020 2020  supported(.     
-00023f50: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00023f60: 7365 6c65 6374 5f61 6c6c 2829 0a20 2020  select_all().   
-00023f70: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
-00023f80: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
-00023f90: 2020 7261 6973 6520 4665 6174 7572 6553    raise FeatureS
-00023fa0: 746f 7265 4578 6365 7074 696f 6e28 0a20  toreException(. 
-00023fb0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00023fc0: 5265 6164 696e 6720 616e 2045 7874 6572  Reading an Exter
-00023fd0: 6e61 6c20 4665 6174 7572 6520 4772 6f75  nal Feature Grou
-00023fe0: 7020 6469 7265 6374 6c79 2069 6e74 6f20  p directly into 
-00023ff0: 6120 5061 6e64 6173 2044 6174 6166 7261  a Pandas Datafra
-00024000: 6d65 2075 7369 6e67 2022 0a20 2020 2020  me using ".     
-00024010: 2020 2020 2020 2020 2020 202b 2022 5079             + "Py
-00024020: 7468 6f6e 2f50 616e 6461 7320 6173 2045  thon/Pandas as E
-00024030: 6e67 696e 6520 6672 6f6d 2074 6865 2065  ngine from the e
-00024040: 7874 6572 6e61 6c20 7374 6f72 6167 6520  xternal storage 
-00024050: 7379 7374 656d 2022 0a20 2020 2020 2020  system ".       
-00024060: 2020 2020 2020 2020 202b 2022 6973 206e           + "is n
-00024070: 6f74 2073 7570 706f 7274 6564 2c20 686f  ot supported, ho
-00024080: 7765 7665 722c 2069 6620 7468 6520 6665  wever, if the fe
-00024090: 6174 7572 6520 6772 6f75 7020 6973 206f  ature group is o
-000240a0: 6e6c 696e 6520 656e 6162 6c65 642c 2079  nline enabled, y
-000240b0: 6f75 2063 616e 2072 6561 6420 220a 2020  ou can read ".  
-000240c0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
-000240d0: 2266 726f 6d20 6f6e 6c69 6e65 2073 746f  "from online sto
-000240e0: 7261 6765 206f 7220 796f 7520 6361 6e20  rage or you can 
-000240f0: 7573 6520 7468 6520 220a 2020 2020 2020  use the ".      
-00024100: 2020 2020 2020 2020 2020 2b20 2251 7565            + "Que
-00024110: 7279 2041 5049 2074 6f20 6372 6561 7465  ry API to create
-00024120: 2046 6561 7475 7265 2056 6965 7773 2f54   Feature Views/T
-00024130: 7261 696e 696e 6720 4461 7461 2063 6f6e  raining Data con
-00024140: 7461 696e 696e 6720 4578 7465 726e 616c  taining External
-00024150: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
-00024160: 2020 202b 2022 4665 6174 7572 6520 4772     + "Feature Gr
-00024170: 6f75 7073 2e22 0a20 2020 2020 2020 2020  oups.".         
-00024180: 2020 2029 0a20 2020 2020 2020 2065 6e67     ).        eng
-00024190: 696e 652e 6765 745f 696e 7374 616e 6365  ine.get_instance
-000241a0: 2829 2e73 6574 5f6a 6f62 5f67 726f 7570  ().set_job_group
-000241b0: 280a 2020 2020 2020 2020 2020 2020 2246  (.            "F
-000241c0: 6574 6368 696e 6720 4665 6174 7572 6520  etching Feature 
-000241d0: 6772 6f75 7022 2c0a 2020 2020 2020 2020  group",.        
-000241e0: 2020 2020 2247 6574 7469 6e67 2066 6561      "Getting fea
-000241f0: 7475 7265 2067 726f 7570 3a20 7b7d 2066  ture group: {} f
-00024200: 726f 6d20 7468 6520 6665 6174 7572 6573  rom the features
-00024210: 746f 7265 207b 7d22 2e66 6f72 6d61 7428  tore {}".format(
-00024220: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00024230: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
-00024240: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
-00024250: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
-00024260: 2020 292c 0a20 2020 2020 2020 2029 0a20    ),.        ). 
-00024270: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-00024280: 6c66 2e73 656c 6563 745f 616c 6c28 292e  lf.select_all().
-00024290: 7265 6164 2864 6174 6166 7261 6d65 5f74  read(dataframe_t
-000242a0: 7970 653d 6461 7461 6672 616d 655f 7479  ype=dataframe_ty
-000242b0: 7065 2c20 6f6e 6c69 6e65 3d6f 6e6c 696e  pe, online=onlin
-000242c0: 6529 0a0a 2020 2020 6465 6620 7368 6f77  e)..    def show
-000242d0: 2873 656c 662c 206e 293a 0a20 2020 2020  (self, n):.     
-000242e0: 2020 2022 2222 5368 6f77 2074 6865 2066     """Show the f
-000242f0: 6972 7374 206e 2072 6f77 7320 6f66 2074  irst n rows of t
-00024300: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
-00024310: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
-00024320: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
-00024330: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
-00024340: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
-00024350: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
-00024360: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
-00024370: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
-00024380: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-00024390: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
-000243a0: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
-000243b0: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
-000243c0: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
-000243d0: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
-000243e0: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
-000243f0: 7368 6f77 2835 290a 2020 2020 2020 2020  show(5).        
-00024400: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
-00024410: 2222 220a 2020 2020 2020 2020 656e 6769  """.        engi
-00024420: 6e65 2e67 6574 5f69 6e73 7461 6e63 6528  ne.get_instance(
-00024430: 292e 7365 745f 6a6f 625f 6772 6f75 7028  ).set_job_group(
-00024440: 0a20 2020 2020 2020 2020 2020 2022 4665  .            "Fe
-00024450: 7463 6869 6e67 2046 6561 7475 7265 2067  tching Feature g
-00024460: 726f 7570 222c 0a20 2020 2020 2020 2020  roup",.         
-00024470: 2020 2022 4765 7474 696e 6720 6665 6174     "Getting feat
-00024480: 7572 6520 6772 6f75 703a 207b 7d20 6672  ure group: {} fr
-00024490: 6f6d 2074 6865 2066 6561 7475 7265 7374  om the featurest
-000244a0: 6f72 6520 7b7d 222e 666f 726d 6174 280a  ore {}".format(.
-000244b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000244c0: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
-000244d0: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
-000244e0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
-000244f0: 2029 2c0a 2020 2020 2020 2020 290a 2020   ),.        ).  
-00024500: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00024510: 662e 7365 6c65 6374 5f61 6c6c 2829 2e73  f.select_all().s
-00024520: 686f 7728 6e29 0a0a 2020 2020 4063 6c61  how(n)..    @cla
-00024530: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
-00024540: 2066 726f 6d5f 7265 7370 6f6e 7365 5f6a   from_response_j
-00024550: 736f 6e28 636c 732c 206a 736f 6e5f 6469  son(cls, json_di
-00024560: 6374 293a 0a20 2020 2020 2020 206a 736f  ct):.        jso
-00024570: 6e5f 6465 6361 6d65 6c69 7a65 6420 3d20  n_decamelized = 
-00024580: 6875 6d70 732e 6465 6361 6d65 6c69 7a65  humps.decamelize
-00024590: 286a 736f 6e5f 6469 6374 290a 2020 2020  (json_dict).    
-000245a0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
-000245b0: 6528 6a73 6f6e 5f64 6563 616d 656c 697a  e(json_decameliz
-000245c0: 6564 2c20 6469 6374 293a 0a20 2020 2020  ed, dict):.     
-000245d0: 2020 2020 2020 205f 203d 206a 736f 6e5f         _ = json_
-000245e0: 6465 6361 6d65 6c69 7a65 642e 706f 7028  decamelized.pop(
-000245f0: 2274 7970 6522 2c20 4e6f 6e65 290a 2020  "type", None).  
-00024600: 2020 2020 2020 2020 2020 7265 7475 726e            return
-00024610: 2063 6c73 282a 2a6a 736f 6e5f 6465 6361   cls(**json_deca
-00024620: 6d65 6c69 7a65 6429 0a20 2020 2020 2020  melized).       
-00024630: 2066 6f72 2066 6720 696e 206a 736f 6e5f   for fg in json_
-00024640: 6465 6361 6d65 6c69 7a65 643a 0a20 2020  decamelized:.   
-00024650: 2020 2020 2020 2020 205f 203d 2066 672e           _ = fg.
-00024660: 706f 7028 2274 7970 6522 2c20 4e6f 6e65  pop("type", None
-00024670: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-00024680: 205b 636c 7328 2a2a 6667 2920 666f 7220   [cls(**fg) for 
-00024690: 6667 2069 6e20 6a73 6f6e 5f64 6563 616d  fg in json_decam
-000246a0: 656c 697a 6564 5d0a 0a20 2020 2064 6566  elized]..    def
-000246b0: 2075 7064 6174 655f 6672 6f6d 5f72 6573   update_from_res
-000246c0: 706f 6e73 655f 6a73 6f6e 2873 656c 662c  ponse_json(self,
-000246d0: 206a 736f 6e5f 6469 6374 293a 0a20 2020   json_dict):.   
-000246e0: 2020 2020 206a 736f 6e5f 6465 6361 6d65       json_decame
-000246f0: 6c69 7a65 6420 3d20 6875 6d70 732e 6465  lized = humps.de
-00024700: 6361 6d65 6c69 7a65 286a 736f 6e5f 6469  camelize(json_di
-00024710: 6374 290a 2020 2020 2020 2020 6966 2022  ct).        if "
-00024720: 7479 7065 2220 696e 206a 736f 6e5f 6465  type" in json_de
-00024730: 6361 6d65 6c69 7a65 643a 0a20 2020 2020  camelized:.     
-00024740: 2020 2020 2020 205f 203d 206a 736f 6e5f         _ = json_
-00024750: 6465 6361 6d65 6c69 7a65 642e 706f 7028  decamelized.pop(
-00024760: 2274 7970 6522 290a 2020 2020 2020 2020  "type").        
-00024770: 7365 6c66 2e5f 5f69 6e69 745f 5f28 2a2a  self.__init__(**
-00024780: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-00024790: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
-000247a0: 2073 656c 660a 0a20 2020 2064 6566 206a   self..    def j
-000247b0: 736f 6e28 7365 6c66 293a 0a20 2020 2020  son(self):.     
-000247c0: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
-000247d0: 756d 7073 2873 656c 662c 2063 6c73 3d75  umps(self, cls=u
-000247e0: 7469 6c2e 4665 6174 7572 6553 746f 7265  til.FeatureStore
-000247f0: 456e 636f 6465 7229 0a0a 2020 2020 6465  Encoder)..    de
-00024800: 6620 746f 5f64 6963 7428 7365 6c66 293a  f to_dict(self):
-00024810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00024820: 7b0a 2020 2020 2020 2020 2020 2020 2269  {.            "i
-00024830: 6422 3a20 7365 6c66 2e5f 6964 2c0a 2020  d": self._id,.  
-00024840: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
-00024850: 3a20 7365 6c66 2e5f 6e61 6d65 2c0a 2020  : self._name,.  
-00024860: 2020 2020 2020 2020 2020 2264 6573 6372            "descr
-00024870: 6970 7469 6f6e 223a 2073 656c 662e 5f64  iption": self._d
-00024880: 6573 6372 6970 7469 6f6e 2c0a 2020 2020  escription,.    
-00024890: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
-000248a0: 223a 2073 656c 662e 5f76 6572 7369 6f6e  ": self._version
-000248b0: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
-000248c0: 6561 7475 7265 7322 3a20 7365 6c66 2e5f  eatures": self._
-000248d0: 6665 6174 7572 6573 2c0a 2020 2020 2020  features,.      
-000248e0: 2020 2020 2020 2266 6561 7475 7265 7374        "featurest
-000248f0: 6f72 6549 6422 3a20 7365 6c66 2e5f 6665  oreId": self._fe
-00024900: 6174 7572 655f 7374 6f72 655f 6964 2c0a  ature_store_id,.
-00024910: 2020 2020 2020 2020 2020 2020 2271 7565              "que
-00024920: 7279 223a 2073 656c 662e 5f71 7565 7279  ry": self._query
-00024930: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
-00024940: 6174 6146 6f72 6d61 7422 3a20 7365 6c66  ataFormat": self
-00024950: 2e5f 6461 7461 5f66 6f72 6d61 742c 0a20  ._data_format,. 
-00024960: 2020 2020 2020 2020 2020 2022 7061 7468             "path
-00024970: 223a 2073 656c 662e 5f70 6174 682c 0a20  ": self._path,. 
-00024980: 2020 2020 2020 2020 2020 2022 6f70 7469             "opti
-00024990: 6f6e 7322 3a20 5b7b 226e 616d 6522 3a20  ons": [{"name": 
-000249a0: 6b2c 2022 7661 6c75 6522 3a20 767d 2066  k, "value": v} f
-000249b0: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
-000249c0: 5f6f 7074 696f 6e73 2e69 7465 6d73 2829  _options.items()
-000249d0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
-000249e0: 2073 656c 662e 5f6f 7074 696f 6e73 0a20   self._options. 
-000249f0: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
-00024a00: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
-00024a10: 2020 2273 746f 7261 6765 436f 6e6e 6563    "storageConnec
-00024a20: 746f 7222 3a20 7365 6c66 2e5f 7374 6f72  tor": self._stor
-00024a30: 6167 655f 636f 6e6e 6563 746f 722e 746f  age_connector.to
-00024a40: 5f64 6963 7428 292c 0a20 2020 2020 2020  _dict(),.       
-00024a50: 2020 2020 2022 7479 7065 223a 2022 6f6e       "type": "on
-00024a60: 4465 6d61 6e64 4665 6174 7572 6567 726f  DemandFeaturegro
-00024a70: 7570 4454 4f22 2c0a 2020 2020 2020 2020  upDTO",.        
-00024a80: 2020 2020 2273 7461 7469 7374 6963 7343      "statisticsC
-00024a90: 6f6e 6669 6722 3a20 7365 6c66 2e5f 7374  onfig": self._st
-00024aa0: 6174 6973 7469 6373 5f63 6f6e 6669 672c  atistics_config,
-00024ab0: 0a20 2020 2020 2020 2020 2020 2022 6576  .            "ev
-00024ac0: 656e 7454 696d 6522 3a20 7365 6c66 2e5f  entTime": self._
-00024ad0: 6576 656e 745f 7469 6d65 2c0a 2020 2020  event_time,.    
-00024ae0: 2020 2020 2020 2020 2265 7870 6563 7461          "expecta
-00024af0: 7469 6f6e 5375 6974 6522 3a20 7365 6c66  tionSuite": self
-00024b00: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
-00024b10: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
-00024b20: 2022 6f6e 6c69 6e65 456e 6162 6c65 6422   "onlineEnabled"
-00024b30: 3a20 7365 6c66 2e5f 6f6e 6c69 6e65 5f65  : self._online_e
-00024b40: 6e61 626c 6564 2c0a 2020 2020 2020 2020  nabled,.        
-00024b50: 2020 2020 2273 7069 6e65 223a 2046 616c      "spine": Fal
-00024b60: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
-00024b70: 2274 6f70 6963 4e61 6d65 223a 2073 656c  "topicName": sel
-00024b80: 662e 746f 7069 635f 6e61 6d65 2c0a 2020  f.topic_name,.  
-00024b90: 2020 2020 2020 2020 2020 226e 6f74 6966            "notif
-00024ba0: 6963 6174 696f 6e54 6f70 6963 4e61 6d65  icationTopicName
-00024bb0: 223a 2073 656c 662e 6e6f 7469 6669 6361  ": self.notifica
-00024bc0: 7469 6f6e 5f74 6f70 6963 5f6e 616d 652c  tion_topic_name,
-00024bd0: 0a20 2020 2020 2020 2020 2020 2022 6465  .            "de
-00024be0: 7072 6563 6174 6564 223a 2073 656c 662e  precated": self.
-00024bf0: 6465 7072 6563 6174 6564 2c0a 2020 2020  deprecated,.    
-00024c00: 2020 2020 7d0a 0a20 2020 2040 7072 6f70      }..    @prop
-00024c10: 6572 7479 0a20 2020 2064 6566 2069 6428  erty.    def id(
-00024c20: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00024c30: 6574 7572 6e20 7365 6c66 2e5f 6964 0a0a  eturn self._id..
-00024c40: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
-00024c50: 2020 6465 6620 6465 7363 7269 7074 696f    def descriptio
-00024c60: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
-00024c70: 2072 6574 7572 6e20 7365 6c66 2e5f 6465   return self._de
-00024c80: 7363 7269 7074 696f 6e0a 0a20 2020 2040  scription..    @
-00024c90: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
-00024ca0: 2071 7565 7279 2873 656c 6629 3a0a 2020   query(self):.  
-00024cb0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-00024cc0: 662e 5f71 7565 7279 0a0a 2020 2020 4070  f._query..    @p
-00024cd0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
-00024ce0: 6461 7461 5f66 6f72 6d61 7428 7365 6c66  data_format(self
-00024cf0: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
-00024d00: 6e20 7365 6c66 2e5f 6461 7461 5f66 6f72  n self._data_for
-00024d10: 6d61 740a 0a20 2020 2040 7072 6f70 6572  mat..    @proper
-00024d20: 7479 0a20 2020 2064 6566 2070 6174 6828  ty.    def path(
+000138e0: 202a 206b 6579 2060 2270 616e 6461 735f   * key `"pandas_
+000138f0: 7479 7065 7322 6020 616e 6420 7661 6c75  types"` and valu
+00013900: 6520 6054 7275 6560 2074 6f20 7265 7472  e `True` to retr
+00013910: 6965 7665 2063 6f6c 756d 6e73 2061 730a  ieve columns as.
+00013920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00013930: 2020 5b50 616e 6461 7320 6e75 6c6c 6162    [Pandas nullab
+00013940: 6c65 2074 7970 6573 5d28 6874 7470 733a  le types](https:
+00013950: 2f2f 7061 6e64 6173 2e70 7964 6174 612e  //pandas.pydata.
+00013960: 6f72 672f 646f 6373 2f75 7365 725f 6775  org/docs/user_gu
+00013970: 6964 652f 696e 7465 6765 725f 6e61 2e68  ide/integer_na.h
+00013980: 746d 6c29 0a20 2020 2020 2020 2020 2020  tml).           
+00013990: 2020 2020 2020 2072 6174 6865 7220 7468         rather th
+000139a0: 616e 206e 756d 7079 2f6f 626a 6563 7428  an numpy/object(
+000139b0: 7374 7269 6e67 2920 7479 7065 7320 2865  string) types (e
+000139c0: 7870 6572 696d 656e 7461 6c29 2e0a 2020  xperimental)..  
+000139d0: 2020 2020 2020 2020 2020 2020 2020 4465                De
+000139e0: 6661 756c 7473 2074 6f20 607b 7d60 2e0a  faults to `{}`..
+000139f0: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
+00013a00: 6e73 0a20 2020 2020 2020 2020 2020 2060  ns.            `
+00013a10: 4461 7461 4672 616d 6560 3a20 5468 6520  DataFrame`: The 
+00013a20: 7370 6172 6b20 6461 7461 6672 616d 6520  spark dataframe 
+00013a30: 636f 6e74 6169 6e69 6e67 2074 6865 2066  containing the f
+00013a40: 6561 7475 7265 2064 6174 612e 0a20 2020  eature data..   
+00013a50: 2020 2020 2020 2020 2060 7079 7370 6172           `pyspar
+00013a60: 6b2e 4461 7461 4672 616d 6560 2e20 4120  k.DataFrame`. A 
+00013a70: 5370 6172 6b20 4461 7461 4672 616d 652e  Spark DataFrame.
+00013a80: 0a20 2020 2020 2020 2020 2020 2060 7061  .            `pa
+00013a90: 6e64 6173 2e44 6174 6146 7261 6d65 602e  ndas.DataFrame`.
+00013aa0: 2041 2050 616e 6461 7320 4461 7461 4672   A Pandas DataFr
+00013ab0: 616d 652e 0a20 2020 2020 2020 2020 2020  ame..           
+00013ac0: 2060 6e75 6d70 792e 6e64 6172 7261 7960   `numpy.ndarray`
+00013ad0: 2e20 4120 7477 6f2d 6469 6d65 6e73 696f  . A two-dimensio
+00013ae0: 6e61 6c20 4e75 6d70 7920 6172 7261 792e  nal Numpy array.
+00013af0: 0a20 2020 2020 2020 2020 2020 2060 6c69  .            `li
+00013b00: 7374 602e 2041 2074 776f 2d64 696d 656e  st`. A two-dimen
+00013b10: 7369 6f6e 616c 2050 7974 686f 6e20 6c69  sional Python li
+00013b20: 7374 2e0a 0a20 2020 2020 2020 2023 2052  st...        # R
+00013b30: 6169 7365 730a 2020 2020 2020 2020 2020  aises.          
+00013b40: 2020 6068 7366 732e 636c 6965 6e74 2e65    `hsfs.client.e
+00013b50: 7863 6570 7469 6f6e 732e 5265 7374 4150  xceptions.RestAP
+00013b60: 4945 7272 6f72 602e 204e 6f20 6461 7461  IError`. No data
+00013b70: 2069 7320 6176 6169 6c61 626c 6520 666f   is available fo
+00013b80: 7220 6665 6174 7572 6520 6772 6f75 7020  r feature group 
+00013b90: 7769 7468 2074 6869 7320 636f 6d6d 6974  with this commit
+00013ba0: 2064 6174 652c 2049 6620 7469 6d65 2074   date, If time t
+00013bb0: 7261 7665 6c20 656e 6162 6c65 642e 0a20  ravel enabled.. 
+00013bc0: 2020 2020 2020 2022 2222 0a20 2020 2020         """.     
+00013bd0: 2020 2069 6620 7761 6c6c 636c 6f63 6b5f     if wallclock_
+00013be0: 7469 6d65 2061 6e64 2073 656c 662e 5f74  time and self._t
+00013bf0: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
+00013c00: 7420 6973 204e 6f6e 653a 0a20 2020 2020  t is None:.     
+00013c10: 2020 2020 2020 2072 6169 7365 2046 6561         raise Fea
+00013c20: 7475 7265 5374 6f72 6545 7863 6570 7469  tureStoreExcepti
+00013c30: 6f6e 280a 2020 2020 2020 2020 2020 2020  on(.            
+00013c40: 2020 2020 2254 696d 6520 7472 6176 656c      "Time travel
+00013c50: 2066 6f72 6d61 7420 6973 206e 6f74 2073   format is not s
+00013c60: 6574 2066 6f72 2074 6865 2066 6561 7475  et for the featu
+00013c70: 7265 2067 726f 7570 2c20 6361 6e6e 6f74  re group, cannot
+00013c80: 2072 6561 6420 6173 206f 6620 7370 6563   read as of spec
+00013c90: 6966 6963 2070 6f69 6e74 2069 6e20 7469  ific point in ti
+00013ca0: 6d65 2e22 0a20 2020 2020 2020 2020 2020  me.".           
+00013cb0: 2029 0a20 2020 2020 2020 2065 6c69 6620   ).        elif 
+00013cc0: 7761 6c6c 636c 6f63 6b5f 7469 6d65 2061  wallclock_time a
+00013cd0: 6e64 2065 6e67 696e 652e 6765 745f 7479  nd engine.get_ty
+00013ce0: 7065 2829 203d 3d20 2270 7974 686f 6e22  pe() == "python"
+00013cf0: 3a0a 2020 2020 2020 2020 2020 2020 7261  :.            ra
+00013d00: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
+00013d10: 4578 6365 7074 696f 6e28 0a20 2020 2020  Exception(.     
+00013d20: 2020 2020 2020 2020 2020 2022 5079 7468             "Pyth
+00013d30: 6f6e 2065 6e76 6972 6f6e 6d65 6e74 7320  on environments 
+00013d40: 646f 6573 206e 6f74 2073 7570 706f 7274  does not support
+00013d50: 2069 6e63 7265 6d65 6e74 616c 2071 7565   incremental que
+00013d60: 7269 6573 2e20 220a 2020 2020 2020 2020  ries. ".        
+00013d70: 2020 2020 2020 2020 2b20 2252 6561 6420          + "Read 
+00013d80: 6665 6174 7572 6520 6772 6f75 7020 7769  feature group wi
+00013d90: 7468 6f75 7420 7469 6d65 7374 616d 7020  thout timestamp 
+00013da0: 746f 2072 6574 7269 6576 6520 6c61 7465  to retrieve late
+00013db0: 7374 2073 6e61 7073 686f 7420 6f72 2073  st snapshot or s
+00013dc0: 7769 7463 6820 746f 2022 0a20 2020 2020  witch to ".     
+00013dd0: 2020 2020 2020 2020 2020 202b 2022 656e             + "en
+00013de0: 7669 726f 6e6d 656e 7420 7769 7468 2053  vironment with S
+00013df0: 7061 726b 2045 6e67 696e 652e 220a 2020  park Engine.".  
+00013e00: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00013e10: 2020 2020 2065 6e67 696e 652e 6765 745f       engine.get_
+00013e20: 696e 7374 616e 6365 2829 2e73 6574 5f6a  instance().set_j
+00013e30: 6f62 5f67 726f 7570 280a 2020 2020 2020  ob_group(.      
+00013e40: 2020 2020 2020 2246 6574 6368 696e 6720        "Fetching 
+00013e50: 4665 6174 7572 6520 6772 6f75 7022 2c0a  Feature group",.
+00013e60: 2020 2020 2020 2020 2020 2020 2247 6574              "Get
+00013e70: 7469 6e67 2066 6561 7475 7265 2067 726f  ting feature gro
+00013e80: 7570 3a20 7b7d 2066 726f 6d20 7468 6520  up: {} from the 
+00013e90: 6665 6174 7572 6573 746f 7265 207b 7d22  featurestore {}"
+00013ea0: 2e66 6f72 6d61 7428 0a20 2020 2020 2020  .format(.       
+00013eb0: 2020 2020 2020 2020 2073 656c 662e 5f6e           self._n
+00013ec0: 616d 652c 2073 656c 662e 5f66 6561 7475  ame, self._featu
+00013ed0: 7265 5f73 746f 7265 5f6e 616d 650a 2020  re_store_name.  
+00013ee0: 2020 2020 2020 2020 2020 292c 0a20 2020            ),.   
+00013ef0: 2020 2020 2029 0a0a 2020 2020 2020 2020       )..        
+00013f00: 6966 2077 616c 6c63 6c6f 636b 5f74 696d  if wallclock_tim
+00013f10: 653a 0a20 2020 2020 2020 2020 2020 2072  e:.            r
+00013f20: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
+00013f30: 2020 2020 2020 2020 7365 6c66 2e73 656c          self.sel
+00013f40: 6563 745f 616c 6c28 290a 2020 2020 2020  ect_all().      
+00013f50: 2020 2020 2020 2020 2020 2e61 735f 6f66            .as_of
+00013f60: 2877 616c 6c63 6c6f 636b 5f74 696d 6529  (wallclock_time)
+00013f70: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00013f80: 202e 7265 6164 280a 2020 2020 2020 2020   .read(.        
+00013f90: 2020 2020 2020 2020 2020 2020 6f6e 6c69              onli
+00013fa0: 6e65 2c0a 2020 2020 2020 2020 2020 2020  ne,.            
+00013fb0: 2020 2020 2020 2020 6461 7461 6672 616d          datafram
+00013fc0: 655f 7479 7065 2c0a 2020 2020 2020 2020  e_type,.        
+00013fd0: 2020 2020 2020 2020 2020 2020 7265 6164              read
+00013fe0: 5f6f 7074 696f 6e73 2c0a 2020 2020 2020  _options,.      
+00013ff0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00014000: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00014010: 2020 656c 7365 3a0a 2020 2020 2020 2020    else:.        
+00014020: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00014030: 7365 6c65 6374 5f61 6c6c 2829 2e72 6561  select_all().rea
+00014040: 6428 0a20 2020 2020 2020 2020 2020 2020  d(.             
+00014050: 2020 206f 6e6c 696e 652c 0a20 2020 2020     online,.     
+00014060: 2020 2020 2020 2020 2020 2064 6174 6166             dataf
+00014070: 7261 6d65 5f74 7970 652c 0a20 2020 2020  rame_type,.     
+00014080: 2020 2020 2020 2020 2020 2072 6561 645f             read_
+00014090: 6f70 7469 6f6e 732c 0a20 2020 2020 2020  options,.       
+000140a0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+000140b0: 7265 6164 5f63 6861 6e67 6573 280a 2020  read_changes(.  
+000140c0: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+000140d0: 2020 2020 7374 6172 745f 7761 6c6c 636c      start_wallcl
+000140e0: 6f63 6b5f 7469 6d65 3a20 556e 696f 6e5b  ock_time: Union[
+000140f0: 7374 722c 2069 6e74 2c20 6461 7465 7469  str, int, dateti
+00014100: 6d65 2c20 6461 7465 5d2c 0a20 2020 2020  me, date],.     
+00014110: 2020 2065 6e64 5f77 616c 6c63 6c6f 636b     end_wallclock
+00014120: 5f74 696d 653a 2055 6e69 6f6e 5b73 7472  _time: Union[str
+00014130: 2c20 696e 742c 2064 6174 6574 696d 652c  , int, datetime,
+00014140: 2064 6174 655d 2c0a 2020 2020 2020 2020   date],.        
+00014150: 7265 6164 5f6f 7074 696f 6e73 3a20 4f70  read_options: Op
+00014160: 7469 6f6e 616c 5b64 6963 745d 203d 207b  tional[dict] = {
+00014170: 7d2c 0a20 2020 2029 3a0a 2020 2020 2020  },.    ):.      
+00014180: 2020 2222 2252 6561 6473 2075 7064 6174    """Reads updat
+00014190: 6573 206f 6620 7468 6973 2066 6561 7475  es of this featu
+000141a0: 7265 2074 6861 7420 6f63 6375 7272 6564  re that occurred
+000141b0: 2062 6574 7765 656e 2073 7065 6369 6669   between specifi
+000141c0: 6564 2070 6f69 6e74 7320 696e 2074 696d  ed points in tim
+000141d0: 652e 0a0a 2020 2020 2020 2020 2121 2120  e...        !!! 
+000141e0: 7761 726e 696e 6720 2244 6570 7265 6361  warning "Depreca
+000141f0: 7465 6422 0a20 2020 2020 2020 2020 2020  ted".           
+00014200: 2020 2020 2020 2020 2060 7265 6164 5f63           `read_c
+00014210: 6861 6e67 6573 6020 6d65 7468 6f64 2069  hanges` method i
+00014220: 7320 6465 7072 6563 6174 6564 2e20 5573  s deprecated. Us
+00014230: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00014240: 2020 2020 2020 6061 735f 6f66 2865 6e64        `as_of(end
+00014250: 5f77 616c 6c63 6c6f 636b 5f74 696d 652c  _wallclock_time,
+00014260: 2065 7863 6c75 6465 5f75 6e74 696c 3d73   exclude_until=s
+00014270: 7461 7274 5f77 616c 6c63 6c6f 636b 5f74  tart_wallclock_t
+00014280: 696d 6529 2e72 6561 6428 7265 6164 5f6f  ime).read(read_o
+00014290: 7074 696f 6e73 3d72 6561 645f 6f70 7469  ptions=read_opti
+000142a0: 6f6e 7329 600a 2020 2020 2020 2020 2020  ons)`.          
+000142b0: 2020 2020 2020 2020 2020 696e 7374 6561            instea
+000142c0: 642e 0a0a 2020 2020 2020 2020 5468 6973  d...        This
+000142d0: 2066 756e 6374 696f 6e20 6f6e 6c79 2077   function only w
+000142e0: 6f72 6b73 206f 6e20 6665 6174 7572 6520  orks on feature 
+000142f0: 6772 6f75 7073 2077 6974 6820 6048 5544  groups with `HUD
+00014300: 4960 2074 696d 6520 7472 6176 656c 2066  I` time travel f
+00014310: 6f72 6d61 742e 0a0a 2020 2020 2020 2020  ormat...        
+00014320: 2320 4172 6775 6d65 6e74 730a 2020 2020  # Arguments.    
+00014330: 2020 2020 2020 2020 7374 6172 745f 7761          start_wa
+00014340: 6c6c 636c 6f63 6b5f 7469 6d65 3a20 5374  llclock_time: St
+00014350: 6172 7420 7469 6d65 206f 6620 7468 6520  art time of the 
+00014360: 7469 6d65 2074 7261 7665 6c20 7175 6572  time travel quer
+00014370: 792e 2053 7472 696e 6773 2073 686f 756c  y. Strings shoul
+00014380: 6420 6265 2066 6f72 6d61 7474 6564 2069  d be formatted i
+00014390: 6e20 6f6e 6520 6f66 2074 6865 2066 6f6c  n one of the fol
+000143a0: 6c6f 7769 6e67 2066 6f72 6d61 7473 2060  lowing formats `
+000143b0: 2559 2d25 6d2d 2564 602c 2060 2559 2d25  %Y-%m-%d`, `%Y-%
+000143c0: 6d2d 2564 2025 4860 2c20 6025 592d 256d  m-%d %H`, `%Y-%m
+000143d0: 2d25 6420 2548 3a25 4d60 2c0a 2020 2020  -%d %H:%M`,.    
+000143e0: 2020 2020 2020 2020 2020 2020 6025 592d              `%Y-
+000143f0: 256d 2d25 6420 2548 3a25 4d3a 2553 602c  %m-%d %H:%M:%S`,
+00014400: 206f 7220 6025 592d 256d 2d25 6420 2548   or `%Y-%m-%d %H
+00014410: 3a25 4d3a 2553 2e25 6660 2e0a 2020 2020  :%M:%S.%f`..    
+00014420: 2020 2020 2020 2020 656e 645f 7761 6c6c          end_wall
+00014430: 636c 6f63 6b5f 7469 6d65 3a20 456e 6420  clock_time: End 
+00014440: 7469 6d65 206f 6620 7468 6520 7469 6d65  time of the time
+00014450: 2074 7261 7665 6c20 7175 6572 792e 2053   travel query. S
+00014460: 7472 696e 6773 2073 686f 756c 6420 6265  trings should be
+00014470: 2066 6f72 6d61 7474 6564 2069 6e20 6f6e   formatted in on
+00014480: 6520 6f66 2074 6865 2066 6f6c 6c6f 7769  e of the followi
+00014490: 6e67 2066 6f72 6d61 7473 2060 2559 2d25  ng formats `%Y-%
+000144a0: 6d2d 2564 602c 2060 2559 2d25 6d2d 2564  m-%d`, `%Y-%m-%d
+000144b0: 2025 4860 2c20 6025 592d 256d 2d25 6420   %H`, `%Y-%m-%d 
+000144c0: 2548 3a25 4d60 2c0a 2020 2020 2020 2020  %H:%M`,.        
+000144d0: 2020 2020 2020 2020 6025 592d 256d 2d25          `%Y-%m-%
+000144e0: 6420 2548 3a25 4d3a 2553 602c 206f 7220  d %H:%M:%S`, or 
+000144f0: 6025 592d 256d 2d25 6420 2548 3a25 4d3a  `%Y-%m-%d %H:%M:
+00014500: 2553 2e25 6660 2e0a 2020 2020 2020 2020  %S.%f`..        
+00014510: 2020 2020 7265 6164 5f6f 7074 696f 6e73      read_options
+00014520: 3a20 4164 6469 7469 6f6e 616c 206f 7074  : Additional opt
+00014530: 696f 6e73 2061 7320 6b65 792f 7661 6c75  ions as key/valu
+00014540: 6520 7061 6972 7320 746f 2070 6173 7320  e pairs to pass 
+00014550: 746f 2074 6865 2065 7865 6375 7469 6f6e  to the execution
+00014560: 2065 6e67 696e 652e 0a20 2020 2020 2020   engine..       
+00014570: 2020 2020 2020 2020 2046 6f72 2073 7061           For spa
+00014580: 726b 2065 6e67 696e 653a 2044 6963 7469  rk engine: Dicti
+00014590: 6f6e 6172 7920 6f66 2072 6561 6420 6f70  onary of read op
+000145a0: 7469 6f6e 7320 666f 7220 5370 6172 6b2e  tions for Spark.
+000145b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000145c0: 2046 6f72 2070 7974 686f 6e20 656e 6769   For python engi
+000145d0: 6e65 3a0a 2020 2020 2020 2020 2020 2020  ne:.            
+000145e0: 2020 2020 2a20 6b65 7920 6022 6869 7665      * key `"hive
+000145f0: 5f63 6f6e 6669 6722 6020 746f 2070 6173  _config"` to pas
+00014600: 7320 6120 6469 6374 696f 6e61 7279 206f  s a dictionary o
+00014610: 6620 6869 7665 206f 7220 7465 7a20 636f  f hive or tez co
+00014620: 6e66 6967 7572 6174 696f 6e73 2e0a 2020  nfigurations..  
+00014630: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014640: 466f 7220 6578 616d 706c 653a 2060 7b22  For example: `{"
+00014650: 6869 7665 5f63 6f6e 6669 6722 3a20 7b22  hive_config": {"
+00014660: 6869 7665 2e74 657a 2e63 7075 2e76 636f  hive.tez.cpu.vco
+00014670: 7265 7322 3a20 322c 2022 7465 7a2e 6772  res": 2, "tez.gr
+00014680: 6f75 7069 6e67 2e73 706c 6974 2d63 6f75  ouping.split-cou
+00014690: 6e74 223a 2022 3322 7d7d 600a 2020 2020  nt": "3"}}`.    
+000146a0: 2020 2020 2020 2020 2020 2020 4465 6661              Defa
+000146b0: 756c 7473 2074 6f20 607b 7d60 2e0a 0a20  ults to `{}`... 
+000146c0: 2020 2020 2020 2023 2052 6574 7572 6e73         # Returns
+000146d0: 0a20 2020 2020 2020 2020 2020 2060 4461  .            `Da
+000146e0: 7461 4672 616d 6560 2e20 5468 6520 7370  taFrame`. The sp
+000146f0: 6172 6b20 6461 7461 6672 616d 6520 636f  ark dataframe co
+00014700: 6e74 6169 6e69 6e67 2074 6865 2069 6e63  ntaining the inc
+00014710: 7265 6d65 6e74 616c 2063 6861 6e67 6573  remental changes
+00014720: 206f 660a 2020 2020 2020 2020 2020 2020   of.            
+00014730: 6665 6174 7572 6520 6461 7461 2e0a 0a20  feature data... 
+00014740: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
+00014750: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
+00014760: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
+00014770: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
+00014780: 602e 2020 4e6f 2064 6174 6120 6973 2061  `.  No data is a
+00014790: 7661 696c 6162 6c65 2066 6f72 2066 6561  vailable for fea
+000147a0: 7475 7265 2067 726f 7570 2077 6974 6820  ture group with 
+000147b0: 7468 6973 2063 6f6d 6d69 7420 6461 7465  this commit date
+000147c0: 2e0a 2020 2020 2020 2020 2020 2020 6068  ..            `h
+000147d0: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+000147e0: 7469 6f6e 732e 4665 6174 7572 6553 746f  tions.FeatureSto
+000147f0: 7265 4578 6365 7074 696f 6e60 2e20 4966  reException`. If
+00014800: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00014810: 7570 2064 6f65 7320 6e6f 7420 6861 7665  up does not have
+00014820: 2060 4855 4449 6020 7469 6d65 2074 7261   `HUDI` time tra
+00014830: 7665 6c20 666f 726d 6174 0a20 2020 2020  vel format.     
+00014840: 2020 2022 2222 0a20 2020 2020 2020 2072     """.        r
+00014850: 6574 7572 6e20 280a 2020 2020 2020 2020  eturn (.        
+00014860: 2020 2020 7365 6c66 2e73 656c 6563 745f      self.select_
+00014870: 616c 6c28 290a 2020 2020 2020 2020 2020  all().          
+00014880: 2020 2e70 756c 6c5f 6368 616e 6765 7328    .pull_changes(
+00014890: 7374 6172 745f 7761 6c6c 636c 6f63 6b5f  start_wallclock_
+000148a0: 7469 6d65 2c20 656e 645f 7761 6c6c 636c  time, end_wallcl
+000148b0: 6f63 6b5f 7469 6d65 290a 2020 2020 2020  ock_time).      
+000148c0: 2020 2020 2020 2e72 6561 6428 4661 6c73        .read(Fals
+000148d0: 652c 2022 6465 6661 756c 7422 2c20 7265  e, "default", re
+000148e0: 6164 5f6f 7074 696f 6e73 290a 2020 2020  ad_options).    
+000148f0: 2020 2020 290a 0a20 2020 2064 6566 2066      )..    def f
+00014900: 696e 645f 6e65 6967 6862 6f72 7328 0a20  ind_neighbors(. 
+00014910: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+00014920: 2020 2020 2065 6d62 6564 6469 6e67 3a20       embedding: 
+00014930: 4c69 7374 5b55 6e69 6f6e 5b69 6e74 2c20  List[Union[int, 
+00014940: 666c 6f61 745d 5d2c 0a20 2020 2020 2020  float]],.       
+00014950: 2063 6f6c 3a20 4f70 7469 6f6e 616c 5b73   col: Optional[s
+00014960: 7472 5d20 3d20 4e6f 6e65 2c0a 2020 2020  tr] = None,.    
+00014970: 2020 2020 6b3a 204f 7074 696f 6e61 6c5b      k: Optional[
+00014980: 696e 745d 203d 2031 302c 0a20 2020 2020  int] = 10,.     
+00014990: 2020 2066 696c 7465 723a 204f 7074 696f     filter: Optio
+000149a0: 6e61 6c5b 556e 696f 6e5b 4669 6c74 6572  nal[Union[Filter
+000149b0: 2c20 4c6f 6769 635d 5d20 3d20 4e6f 6e65  , Logic]] = None
+000149c0: 2c0a 2020 2020 2020 2020 6d69 6e5f 7363  ,.        min_sc
+000149d0: 6f72 653a 204f 7074 696f 6e61 6c5b 666c  ore: Optional[fl
+000149e0: 6f61 745d 203d 2030 2c0a 2020 2020 2920  oat] = 0,.    ) 
+000149f0: 2d3e 204c 6973 745b 5475 706c 655b 666c  -> List[Tuple[fl
+00014a00: 6f61 742c 204c 6973 745b 416e 795d 5d5d  oat, List[Any]]]
+00014a10: 3a0a 2020 2020 2020 2020 2222 220a 2020  :.        """.  
+00014a20: 2020 2020 2020 4669 6e64 7320 7468 6520        Finds the 
+00014a30: 6e65 6172 6573 7420 6e65 6967 6862 6f72  nearest neighbor
+00014a40: 7320 666f 7220 6120 6769 7665 6e20 656d  s for a given em
+00014a50: 6265 6464 696e 6720 696e 2074 6865 2076  bedding in the v
+00014a60: 6563 746f 7220 6461 7461 6261 7365 2e0a  ector database..
+00014a70: 0a20 2020 2020 2020 2023 2041 7267 756d  .        # Argum
+00014a80: 656e 7473 0a20 2020 2020 2020 2020 2020  ents.           
+00014a90: 2065 6d62 6564 6469 6e67 3a20 5468 6520   embedding: The 
+00014aa0: 7461 7267 6574 2065 6d62 6564 6469 6e67  target embedding
+00014ab0: 2066 6f72 2077 6869 6368 206e 6569 6768   for which neigh
+00014ac0: 626f 7273 2061 7265 2074 6f20 6265 2066  bors are to be f
+00014ad0: 6f75 6e64 2e0a 2020 2020 2020 2020 2020  ound..          
+00014ae0: 2020 636f 6c3a 2054 6865 2063 6f6c 756d    col: The colum
+00014af0: 6e20 6e61 6d65 2075 7365 6420 746f 2063  n name used to c
+00014b00: 6f6d 7075 7465 2073 696d 696c 6172 6974  ompute similarit
+00014b10: 7920 7363 6f72 652e 2052 6571 7569 7265  y score. Require
+00014b20: 6420 6f6e 6c79 2069 6620 7468 6572 650a  d only if there.
+00014b30: 2020 2020 2020 2020 2020 2020 6172 6520              are 
+00014b40: 6d75 6c74 6970 6c65 2065 6d62 6564 6469  multiple embeddi
+00014b50: 6e67 7320 286f 7074 696f 6e61 6c29 2e0a  ngs (optional)..
+00014b60: 2020 2020 2020 2020 2020 2020 6b3a 2054              k: T
+00014b70: 6865 206e 756d 6265 7220 6f66 206e 6561  he number of nea
+00014b80: 7265 7374 206e 6569 6768 626f 7273 2074  rest neighbors t
+00014b90: 6f20 7265 7472 6965 7665 2028 6465 6661  o retrieve (defa
+00014ba0: 756c 7420 6973 2031 3029 2e0a 2020 2020  ult is 10)..    
+00014bb0: 2020 2020 2020 2020 6669 6c74 6572 3a20          filter: 
+00014bc0: 4120 6669 6c74 6572 2065 7870 7265 7373  A filter express
+00014bd0: 696f 6e20 746f 2072 6573 7472 6963 7420  ion to restrict 
+00014be0: 7468 6520 7365 6172 6368 2073 7061 6365  the search space
+00014bf0: 2028 6f70 7469 6f6e 616c 292e 0a20 2020   (optional)..   
+00014c00: 2020 2020 2020 2020 206d 696e 5f73 636f           min_sco
+00014c10: 7265 3a20 5468 6520 6d69 6e69 6d75 6d20  re: The minimum 
+00014c20: 7369 6d69 6c61 7269 7479 2073 636f 7265  similarity score
+00014c30: 2066 6f72 206e 6569 6768 626f 7273 2074   for neighbors t
+00014c40: 6f20 6265 2063 6f6e 7369 6465 7265 6420  o be considered 
+00014c50: 2864 6566 6175 6c74 2069 7320 3029 2e0a  (default is 0)..
+00014c60: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
+00014c70: 6e73 0a20 2020 2020 2020 2020 2020 2041  ns.            A
+00014c80: 206c 6973 7420 6f66 2074 7570 6c65 7320   list of tuples 
+00014c90: 7265 7072 6573 656e 7469 6e67 2074 6865  representing the
+00014ca0: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
+00014cb0: 7273 2e0a 2020 2020 2020 2020 2020 2020  rs..            
+00014cc0: 4561 6368 2074 7570 6c65 2063 6f6e 7461  Each tuple conta
+00014cd0: 696e 733a 2060 2854 6865 2073 696d 696c  ins: `(The simil
+00014ce0: 6172 6974 7920 7363 6f72 652c 2041 206c  arity score, A l
+00014cf0: 6973 7420 6f66 2066 6561 7475 7265 2076  ist of feature v
+00014d00: 616c 7565 7329 600a 0a20 2020 2020 2020  alues)`..       
+00014d10: 2021 2121 2045 7861 6d70 6c65 0a20 2020   !!! Example.   
+00014d20: 2020 2020 2020 2020 2060 6060 0a20 2020           ```.   
+00014d30: 2020 2020 2020 2020 2065 6d62 6564 6469           embeddi
+00014d40: 6e67 5f69 6e64 6578 203d 2045 6d62 6564  ng_index = Embed
+00014d50: 6469 6e67 496e 6465 7828 290a 2020 2020  dingIndex().    
+00014d60: 2020 2020 2020 2020 656d 6265 6464 696e          embeddin
+00014d70: 675f 696e 6465 782e 6164 645f 656d 6265  g_index.add_embe
+00014d80: 6464 696e 6728 6e61 6d65 3d22 7573 6572  dding(name="user
+00014d90: 5f76 6563 746f 7222 2c20 6469 6d65 6e73  _vector", dimens
+00014da0: 696f 6e3d 3329 0a20 2020 2020 2020 2020  ion=3).         
+00014db0: 2020 2066 6720 3d20 6673 2e63 7265 6174     fg = fs.creat
+00014dc0: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
+00014dd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00014de0: 2020 2020 2020 2020 206e 616d 653d 2761           name='a
+00014df0: 6972 5f71 7561 6c69 7479 272c 0a20 2020  ir_quality',.   
+00014e00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e10: 2020 2020 2065 6d62 6564 6469 6e67 5f69       embedding_i
+00014e20: 6e64 6578 203d 2065 6d62 6564 6469 6e67  ndex = embedding
+00014e30: 5f69 6e64 6578 2c0a 2020 2020 2020 2020  _index,.        
+00014e40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e50: 7665 7273 696f 6e3d 312c 0a20 2020 2020  version=1,.     
+00014e60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014e70: 2020 2070 7269 6d61 7279 5f6b 6579 3d5b     primary_key=[
+00014e80: 2769 6431 275d 2c0a 2020 2020 2020 2020  'id1'],.        
+00014e90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014ea0: 6f6e 6c69 6e65 5f65 6e61 626c 6564 3d54  online_enabled=T
+00014eb0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+00014ec0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00014ed0: 2020 2020 2020 2066 672e 696e 7365 7274         fg.insert
+00014ee0: 2864 6174 6129 0a20 2020 2020 2020 2020  (data).         
+00014ef0: 2020 2066 672e 6669 6e64 5f6e 6569 6768     fg.find_neigh
+00014f00: 626f 7273 280a 2020 2020 2020 2020 2020  bors(.          
+00014f10: 2020 2020 2020 5b30 2e31 2c20 302e 322c        [0.1, 0.2,
+00014f20: 2030 2e33 5d2c 0a20 2020 2020 2020 2020   0.3],.         
+00014f30: 2020 2020 2020 206b 3d35 2c0a 2020 2020         k=5,.    
+00014f40: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00014f50: 2020 2020 2020 2023 2061 7070 6c79 2066         # apply f
+00014f60: 696c 7465 720a 2020 2020 2020 2020 2020  ilter.          
+00014f70: 2020 6667 2e66 696e 645f 6e65 6967 6862    fg.find_neighb
+00014f80: 6f72 7328 0a20 2020 2020 2020 2020 2020  ors(.           
+00014f90: 2020 2020 205b 302e 312c 2030 2e32 2c20       [0.1, 0.2, 
+00014fa0: 302e 335d 2c0a 2020 2020 2020 2020 2020  0.3],.          
+00014fb0: 2020 2020 2020 6b3d 352c 0a20 2020 2020        k=5,.     
+00014fc0: 2020 2020 2020 2020 2020 2066 696c 7465             filte
+00014fd0: 723d 2866 672e 6964 3120 3e20 3130 2920  r=(fg.id1 > 10) 
+00014fe0: 2620 2866 672e 6964 3120 3c20 3330 290a  & (fg.id1 < 30).
+00014ff0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00015000: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+00015010: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00015020: 2020 6966 2073 656c 662e 5f76 6563 746f    if self._vecto
+00015030: 725f 6462 5f63 6c69 656e 7420 6973 204e  r_db_client is N
+00015040: 6f6e 6520 616e 6420 7365 6c66 2e5f 656d  one and self._em
+00015050: 6265 6464 696e 675f 696e 6465 783a 0a20  bedding_index:. 
+00015060: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00015070: 5f76 6563 746f 725f 6462 5f63 6c69 656e  _vector_db_clien
+00015080: 7420 3d20 5665 6374 6f72 4462 436c 6965  t = VectorDbClie
+00015090: 6e74 2873 656c 662e 7365 6c65 6374 5f61  nt(self.select_a
+000150a0: 6c6c 2829 290a 2020 2020 2020 2020 7265  ll()).        re
+000150b0: 7375 6c74 7320 3d20 7365 6c66 2e5f 7665  sults = self._ve
+000150c0: 6374 6f72 5f64 625f 636c 6965 6e74 2e66  ctor_db_client.f
+000150d0: 696e 645f 6e65 6967 6862 6f72 7328 0a20  ind_neighbors(. 
+000150e0: 2020 2020 2020 2020 2020 2065 6d62 6564             embed
+000150f0: 6469 6e67 2c0a 2020 2020 2020 2020 2020  ding,.          
+00015100: 2020 6665 6174 7572 653d 2873 656c 662e    feature=(self.
+00015110: 5f5f 6765 7461 7474 725f 5f28 636f 6c29  __getattr__(col)
+00015120: 2069 6620 636f 6c20 656c 7365 204e 6f6e   if col else Non
+00015130: 6529 2c0a 2020 2020 2020 2020 2020 2020  e),.            
+00015140: 6b3d 6b2c 0a20 2020 2020 2020 2020 2020  k=k,.           
+00015150: 2066 696c 7465 723d 6669 6c74 6572 2c0a   filter=filter,.
+00015160: 2020 2020 2020 2020 2020 2020 6d69 6e5f              min_
+00015170: 7363 6f72 653d 6d69 6e5f 7363 6f72 652c  score=min_score,
+00015180: 0a20 2020 2020 2020 2029 0a20 2020 2020  .        ).     
+00015190: 2020 2072 6574 7572 6e20 5b0a 2020 2020     return [.    
+000151a0: 2020 2020 2020 2020 2872 6573 756c 745b          (result[
+000151b0: 305d 2c20 5b72 6573 756c 745b 315d 5b66  0], [result[1][f
+000151c0: 2e6e 616d 655d 2066 6f72 2066 2069 6e20  .name] for f in 
+000151d0: 7365 6c66 2e66 6561 7475 7265 735d 290a  self.features]).
+000151e0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+000151f0: 7265 7375 6c74 2069 6e20 7265 7375 6c74  result in result
+00015200: 730a 2020 2020 2020 2020 5d0a 0a20 2020  s.        ]..   
+00015210: 2064 6566 2073 686f 7728 7365 6c66 2c20   def show(self, 
+00015220: 6e3a 2069 6e74 2c20 6f6e 6c69 6e65 3a20  n: int, online: 
+00015230: 4f70 7469 6f6e 616c 5b62 6f6f 6c5d 203d  Optional[bool] =
+00015240: 2046 616c 7365 293a 0a20 2020 2020 2020   False):.       
+00015250: 2022 2222 5368 6f77 2074 6865 2066 6972   """Show the fir
+00015260: 7374 2060 6e60 2072 6f77 7320 6f66 2074  st `n` rows of t
+00015270: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00015280: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+00015290: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+000152a0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+000152b0: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
+000152c0: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
+000152d0: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
+000152e0: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
+000152f0: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+00015300: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+00015310: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
+00015320: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
+00015330: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+00015340: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
+00015350: 0a20 2020 2020 2020 2020 2020 2023 206d  .            # m
+00015360: 616b 6520 6120 7175 6572 7920 616e 6420  ake a query and 
+00015370: 7368 6f77 2074 6f70 2035 2072 6f77 730a  show top 5 rows.
+00015380: 2020 2020 2020 2020 2020 2020 6667 2e73              fg.s
+00015390: 656c 6563 7428 5b27 6461 7465 272c 2777  elect(['date','w
+000153a0: 6565 6b6c 795f 7361 6c65 7327 2c27 6973  eekly_sales','is
+000153b0: 5f68 6f6c 6964 6179 275d 292e 7368 6f77  _holiday']).show
+000153c0: 2835 290a 2020 2020 2020 2020 2020 2020  (5).            
+000153d0: 6060 600a 0a20 2020 2020 2020 2023 2041  ```..        # A
+000153e0: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+000153f0: 2020 2020 206e 3a20 696e 742e 204e 756d       n: int. Num
+00015400: 6265 7220 6f66 2072 6f77 7320 746f 2073  ber of rows to s
+00015410: 686f 772e 0a20 2020 2020 2020 2020 2020  how..           
+00015420: 206f 6e6c 696e 653a 2062 6f6f 6c2c 206f   online: bool, o
+00015430: 7074 696f 6e61 6c2e 2049 6620 6054 7275  ptional. If `Tru
+00015440: 6560 2072 6561 6420 6672 6f6d 206f 6e6c  e` read from onl
+00015450: 696e 6520 6665 6174 7572 6520 7374 6f72  ine feature stor
+00015460: 652c 2064 6566 6175 6c74 730a 2020 2020  e, defaults.    
+00015470: 2020 2020 2020 2020 2020 2020 746f 2060              to `
+00015480: 4661 6c73 6560 2e0a 2020 2020 2020 2020  False`..        
+00015490: 2222 220a 2020 2020 2020 2020 656e 6769  """.        engi
+000154a0: 6e65 2e67 6574 5f69 6e73 7461 6e63 6528  ne.get_instance(
+000154b0: 292e 7365 745f 6a6f 625f 6772 6f75 7028  ).set_job_group(
+000154c0: 0a20 2020 2020 2020 2020 2020 2022 4665  .            "Fe
+000154d0: 7463 6869 6e67 2046 6561 7475 7265 2067  tching Feature g
+000154e0: 726f 7570 222c 0a20 2020 2020 2020 2020  roup",.         
+000154f0: 2020 2022 4765 7474 696e 6720 6665 6174     "Getting feat
+00015500: 7572 6520 6772 6f75 703a 207b 7d20 6672  ure group: {} fr
+00015510: 6f6d 2074 6865 2066 6561 7475 7265 7374  om the featurest
+00015520: 6f72 6520 7b7d 222e 666f 726d 6174 280a  ore {}".format(.
+00015530: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015540: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+00015550: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
+00015560: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+00015570: 2029 2c0a 2020 2020 2020 2020 290a 2020   ),.        ).  
+00015580: 2020 2020 2020 6966 206f 6e6c 696e 6520        if online 
+00015590: 616e 6420 7365 6c66 2e65 6d62 6564 6469  and self.embeddi
+000155a0: 6e67 5f69 6e64 6578 3a0a 2020 2020 2020  ng_index:.      
+000155b0: 2020 2020 2020 6966 2073 656c 662e 5f76        if self._v
+000155c0: 6563 746f 725f 6462 5f63 6c69 656e 7420  ector_db_client 
+000155d0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000155e0: 2020 2020 2020 2020 2073 656c 662e 5f76           self._v
+000155f0: 6563 746f 725f 6462 5f63 6c69 656e 7420  ector_db_client 
+00015600: 3d20 5665 6374 6f72 4462 436c 6965 6e74  = VectorDbClient
+00015610: 2873 656c 662e 7365 6c65 6374 5f61 6c6c  (self.select_all
+00015620: 2829 290a 2020 2020 2020 2020 2020 2020  ()).            
+00015630: 7265 7375 6c74 7320 3d20 7365 6c66 2e5f  results = self._
+00015640: 7665 6374 6f72 5f64 625f 636c 6965 6e74  vector_db_client
+00015650: 2e72 6561 6428 0a20 2020 2020 2020 2020  .read(.         
+00015660: 2020 2020 2020 2073 656c 662e 6964 2c0a         self.id,.
+00015670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015680: 7b7d 2c0a 2020 2020 2020 2020 2020 2020  {},.            
+00015690: 2020 2020 706b 3d73 656c 662e 656d 6265      pk=self.embe
+000156a0: 6464 696e 675f 696e 6465 782e 636f 6c5f  dding_index.col_
+000156b0: 7072 6566 6978 202b 2073 656c 662e 7072  prefix + self.pr
+000156c0: 696d 6172 795f 6b65 795b 305d 2c0a 2020  imary_key[0],.  
+000156d0: 2020 2020 2020 2020 2020 2020 2020 696e                in
+000156e0: 6465 785f 6e61 6d65 3d73 656c 662e 656d  dex_name=self.em
+000156f0: 6265 6464 696e 675f 696e 6465 782e 696e  bedding_index.in
+00015700: 6465 785f 6e61 6d65 2c0a 2020 2020 2020  dex_name,.      
+00015710: 2020 2020 2020 2020 2020 6e3d 6e2c 0a20            n=n,. 
+00015720: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+00015730: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00015740: 5b5b 7265 7375 6c74 5b66 2e6e 616d 655d  [[result[f.name]
+00015750: 2066 6f72 2066 2069 6e20 7365 6c66 2e66   for f in self.f
+00015760: 6561 7475 7265 735d 2066 6f72 2072 6573  eatures] for res
+00015770: 756c 7420 696e 2072 6573 756c 7473 5d0a  ult in results].
+00015780: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00015790: 656c 662e 7365 6c65 6374 5f61 6c6c 2829  elf.select_all()
+000157a0: 2e73 686f 7728 6e2c 206f 6e6c 696e 6529  .show(n, online)
+000157b0: 0a0a 2020 2020 6465 6620 7361 7665 280a  ..    def save(.
+000157c0: 2020 2020 2020 2020 7365 6c66 2c0a 2020          self,.  
+000157d0: 2020 2020 2020 6665 6174 7572 6573 3a20        features: 
+000157e0: 556e 696f 6e5b 0a20 2020 2020 2020 2020  Union[.         
+000157f0: 2020 2070 642e 4461 7461 4672 616d 652c     pd.DataFrame,
+00015800: 0a20 2020 2020 2020 2020 2020 2054 7970  .            Typ
+00015810: 6556 6172 2822 7079 7370 6172 6b2e 7371  eVar("pyspark.sq
+00015820: 6c2e 4461 7461 4672 616d 6522 292c 2020  l.DataFrame"),  
+00015830: 2320 6e6f 7161 3a20 4638 3231 0a20 2020  # noqa: F821.   
+00015840: 2020 2020 2020 2020 2054 7970 6556 6172           TypeVar
+00015850: 2822 7079 7370 6172 6b2e 5244 4422 292c  ("pyspark.RDD"),
+00015860: 2020 2320 6e6f 7161 3a20 4638 3231 0a20    # noqa: F821. 
+00015870: 2020 2020 2020 2020 2020 206e 702e 6e64             np.nd
+00015880: 6172 7261 792c 0a20 2020 2020 2020 2020  array,.         
+00015890: 2020 204c 6973 745b 6665 6174 7572 652e     List[feature.
+000158a0: 4665 6174 7572 655d 2c0a 2020 2020 2020  Feature],.      
+000158b0: 2020 5d20 3d20 4e6f 6e65 2c0a 2020 2020    ] = None,.    
+000158c0: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
+000158d0: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
+000158e0: 5b41 6e79 2c20 416e 795d 5d20 3d20 7b7d  [Any, Any]] = {}
+000158f0: 2c0a 2020 2020 2020 2020 7661 6c69 6461  ,.        valida
+00015900: 7469 6f6e 5f6f 7074 696f 6e73 3a20 4f70  tion_options: Op
+00015910: 7469 6f6e 616c 5b44 6963 745b 416e 792c  tional[Dict[Any,
+00015920: 2041 6e79 5d5d 203d 207b 7d2c 0a20 2020   Any]] = {},.   
+00015930: 2020 2020 2077 6169 743a 2062 6f6f 6c20       wait: bool 
+00015940: 3d20 4661 6c73 652c 0a20 2020 2029 3a0a  = False,.    ):.
+00015950: 2020 2020 2020 2020 2222 2250 6572 7369          """Persi
+00015960: 7374 2074 6865 206d 6574 6164 6174 6120  st the metadata 
+00015970: 616e 6420 6d61 7465 7269 616c 697a 6520  and materialize 
+00015980: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+00015990: 7020 746f 2074 6865 2066 6561 7475 7265  p to the feature
+000159a0: 2073 746f 7265 2e0a 0a20 2020 2020 2020   store...       
+000159b0: 2021 2121 2077 6172 6e69 6e67 2022 4368   !!! warning "Ch
+000159c0: 616e 6765 6420 696e 2033 2e33 2e30 220a  anged in 3.3.0".
+000159d0: 2020 2020 2020 2020 2020 2020 6069 6e73              `ins
+000159e0: 6572 7460 2061 6e64 2060 7361 7665 6020  ert` and `save` 
+000159f0: 6d65 7468 6f64 7320 6172 6520 6e6f 7720  methods are now 
+00015a00: 6173 796e 6320 6279 2064 6566 6175 6c74  async by default
+00015a10: 2069 6e20 6e6f 6e2d 7370 6172 6b20 636c   in non-spark cl
+00015a20: 6965 6e74 732e 0a20 2020 2020 2020 2020  ients..         
+00015a30: 2020 2054 6f20 6163 6869 6576 6520 7468     To achieve th
+00015a40: 6520 6f6c 6420 6265 6861 7669 6f75 722c  e old behaviour,
+00015a50: 2073 6574 2060 7761 6974 6020 6172 6775   set `wait` argu
+00015a60: 6d65 6e74 2074 6f20 6054 7275 6560 2e0a  ment to `True`..
+00015a70: 0a20 2020 2020 2020 2043 616c 6c69 6e67  .        Calling
+00015a80: 2060 7361 7665 6020 6372 6561 7465 7320   `save` creates 
+00015a90: 7468 6520 6d65 7461 6461 7461 2066 6f72  the metadata for
+00015aa0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00015ab0: 7570 2069 6e20 7468 6520 6665 6174 7572  up in the featur
+00015ac0: 6520 7374 6f72 652e 0a20 2020 2020 2020  e store..       
+00015ad0: 2049 6620 6120 4461 7461 4672 616d 652c   If a DataFrame,
+00015ae0: 2052 4444 206f 7220 4e64 6172 7261 7920   RDD or Ndarray 
+00015af0: 6973 2070 726f 7669 6465 642c 2074 6865  is provided, the
+00015b00: 2064 6174 6120 6973 2077 7269 7474 656e   data is written
+00015b10: 2074 6f20 7468 650a 2020 2020 2020 2020   to the.        
+00015b20: 6f6e 6c69 6e65 2f6f 6666 6c69 6e65 2066  online/offline f
+00015b30: 6561 7475 7265 2073 746f 7265 2061 7320  eature store as 
+00015b40: 7370 6563 6966 6965 642e 0a20 2020 2020  specified..     
+00015b50: 2020 2042 7920 6465 6661 756c 742c 2074     By default, t
+00015b60: 6869 7320 7772 6974 6573 2074 6865 2066  his writes the f
+00015b70: 6561 7475 7265 2067 726f 7570 2074 6f20  eature group to 
+00015b80: 7468 6520 6f66 666c 696e 6520 7374 6f72  the offline stor
+00015b90: 6167 652c 2061 6e64 2069 660a 2020 2020  age, and if.    
+00015ba0: 2020 2020 606f 6e6c 696e 655f 656e 6162      `online_enab
+00015bb0: 6c65 6460 2066 6f72 2074 6865 2066 6561  led` for the fea
+00015bc0: 7475 7265 2067 726f 7570 2c20 616c 736f  ture group, also
+00015bd0: 2074 6f20 7468 6520 6f6e 6c69 6e65 2066   to the online f
+00015be0: 6561 7475 7265 2073 746f 7265 2e0a 2020  eature store..  
+00015bf0: 2020 2020 2020 5468 6520 6066 6561 7475        The `featu
+00015c00: 7265 7360 2064 6174 6166 7261 6d65 2063  res` dataframe c
+00015c10: 616e 2062 6520 6120 5370 6172 6b20 4461  an be a Spark Da
+00015c20: 7461 4672 616d 6520 6f72 2052 4444 2c20  taFrame or RDD, 
+00015c30: 6120 5061 6e64 6173 2044 6174 6146 7261  a Pandas DataFra
+00015c40: 6d65 2c0a 2020 2020 2020 2020 6f72 2061  me,.        or a
+00015c50: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
+00015c60: 204e 756d 7079 2061 7272 6179 206f 7220   Numpy array or 
+00015c70: 6120 7477 6f2d 6469 6d65 6e73 696f 6e61  a two-dimensiona
+00015c80: 6c20 5079 7468 6f6e 206e 6573 7465 6420  l Python nested 
+00015c90: 6c69 7374 2e0a 2020 2020 2020 2020 2320  list..        # 
+00015ca0: 4172 6775 6d65 6e74 730a 2020 2020 2020  Arguments.      
+00015cb0: 2020 2020 2020 6665 6174 7572 6573 3a20        features: 
+00015cc0: 4461 7461 4672 616d 652c 2052 4444 2c20  DataFrame, RDD, 
+00015cd0: 4e64 6172 7261 7920 6f72 2061 206c 6973  Ndarray or a lis
+00015ce0: 7420 6f66 2066 6561 7475 7265 732e 2046  t of features. F
+00015cf0: 6561 7475 7265 7320 746f 2062 6520 7361  eatures to be sa
+00015d00: 7665 642e 0a20 2020 2020 2020 2020 2020  ved..           
+00015d10: 2020 2020 2054 6869 7320 6172 6775 6d65       This argume
+00015d20: 6e74 2069 7320 6f70 7469 6f6e 616c 2069  nt is optional i
+00015d30: 6620 7468 6520 6665 6174 7572 6520 6c69  f the feature li
+00015d40: 7374 2069 7320 7072 6f76 6964 6564 2069  st is provided i
+00015d50: 6e20 7468 6520 6372 6561 7465 5f66 6561  n the create_fea
+00015d60: 7475 7265 5f67 726f 7570 206f 720a 2020  ture_group or.  
+00015d70: 2020 2020 2020 2020 2020 2020 2020 696e                in
+00015d80: 2074 6865 2067 6574 5f6f 725f 6372 6561   the get_or_crea
+00015d90: 7465 5f66 6561 7475 7265 5f67 726f 7570  te_feature_group
+00015da0: 206d 6574 686f 6420 696e 766f 6b61 7469   method invokati
+00015db0: 6f6e 2e0a 2020 2020 2020 2020 2020 2020  on..            
+00015dc0: 7772 6974 655f 6f70 7469 6f6e 733a 2041  write_options: A
+00015dd0: 6464 6974 696f 6e61 6c20 7772 6974 6520  dditional write 
+00015de0: 6f70 7469 6f6e 7320 6173 206b 6579 2d76  options as key-v
+00015df0: 616c 7565 2070 6169 7273 2c20 6465 6661  alue pairs, defa
+00015e00: 756c 7473 2074 6f20 607b 7d60 2e0a 2020  ults to `{}`..  
+00015e10: 2020 2020 2020 2020 2020 2020 2020 5768                Wh
+00015e20: 656e 2075 7369 6e67 2074 6865 2060 7079  en using the `py
+00015e30: 7468 6f6e 6020 656e 6769 6e65 2c20 7772  thon` engine, wr
+00015e40: 6974 655f 6f70 7469 6f6e 7320 6361 6e20  ite_options can 
+00015e50: 636f 6e74 6169 6e20 7468 650a 2020 2020  contain the.    
+00015e60: 2020 2020 2020 2020 2020 2020 666f 6c6c              foll
+00015e70: 6f77 696e 6720 656e 7472 6965 733a 0a20  owing entries:. 
+00015e80: 2020 2020 2020 2020 2020 2020 2020 202a                 *
+00015e90: 206b 6579 2060 7370 6172 6b60 2061 6e64   key `spark` and
+00015ea0: 2076 616c 7565 2061 6e20 6f62 6a65 6374   value an object
+00015eb0: 206f 6620 7479 7065 0a20 2020 2020 2020   of type.       
+00015ec0: 2020 2020 2020 2020 205b 6873 6673 2e63           [hsfs.c
+00015ed0: 6f72 652e 6a6f 625f 636f 6e66 6967 7572  ore.job_configur
+00015ee0: 6174 696f 6e2e 4a6f 6243 6f6e 6669 6775  ation.JobConfigu
+00015ef0: 7261 7469 6f6e 5d28 2e2e 2f6a 6f62 5f63  ration](../job_c
+00015f00: 6f6e 6669 6775 7261 7469 6f6e 290a 2020  onfiguration).  
+00015f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015f20: 746f 2063 6f6e 6669 6775 7265 2074 6865  to configure the
+00015f30: 2048 6f70 7377 6f72 6b73 204a 6f62 2075   Hopsworks Job u
+00015f40: 7365 6420 746f 2077 7269 7465 2064 6174  sed to write dat
+00015f50: 6120 696e 746f 2074 6865 0a20 2020 2020  a into the.     
+00015f60: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+00015f70: 7475 7265 2067 726f 7570 2e0a 2020 2020  ture group..    
+00015f80: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
+00015f90: 7920 6077 6169 745f 666f 725f 6a6f 6260  y `wait_for_job`
+00015fa0: 2061 6e64 2076 616c 7565 2060 5472 7565   and value `True
+00015fb0: 6020 6f72 2060 4661 6c73 6560 2074 6f20  ` or `False` to 
+00015fc0: 636f 6e66 6967 7572 650a 2020 2020 2020  configure.      
+00015fd0: 2020 2020 2020 2020 2020 2020 7768 6574              whet
+00015fe0: 6865 7220 6f72 206e 6f74 2074 6f20 7468  her or not to th
+00015ff0: 6520 7361 7665 2063 616c 6c20 7368 6f75  e save call shou
+00016000: 6c64 2072 6574 7572 6e20 6f6e 6c79 0a20  ld return only. 
+00016010: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016020: 2061 6674 6572 2074 6865 2048 6f70 7377   after the Hopsw
+00016030: 6f72 6b73 204a 6f62 2068 6173 2066 696e  orks Job has fin
+00016040: 6973 6865 642e 2042 7920 6465 6661 756c  ished. By defaul
+00016050: 7420 6974 2064 6f65 7320 6e6f 7420 7761  t it does not wa
+00016060: 6974 2e0a 2020 2020 2020 2020 2020 2020  it..            
+00016070: 2020 2020 2a20 6b65 7920 6073 7461 7274      * key `start
+00016080: 5f6f 6666 6c69 6e65 5f62 6163 6b66 696c  _offline_backfil
+00016090: 6c60 2061 6e64 2076 616c 7565 2060 5472  l` and value `Tr
+000160a0: 7565 6020 6f72 2060 4661 6c73 6560 2074  ue` or `False` t
+000160b0: 6f20 636f 6e66 6967 7572 650a 2020 2020  o configure.    
+000160c0: 2020 2020 2020 2020 2020 2020 2020 7768                wh
+000160d0: 6574 6865 7220 6f72 206e 6f74 2074 6f20  ether or not to 
+000160e0: 7374 6172 7420 7468 6520 6d61 7465 7269  start the materi
+000160f0: 616c 697a 6174 696f 6e20 6a6f 6220 746f  alization job to
+00016100: 2077 7269 7465 2064 6174 6120 746f 2074   write data to t
+00016110: 6865 206f 6666 6c69 6e65 0a20 2020 2020  he offline.     
+00016120: 2020 2020 2020 2020 2020 2020 2073 746f               sto
+00016130: 7261 6765 2e20 6073 7461 7274 5f6f 6666  rage. `start_off
+00016140: 6c69 6e65 5f62 6163 6b66 696c 6c60 2069  line_backfill` i
+00016150: 7320 6465 7072 6563 6174 6564 2e20 5573  s deprecated. Us
+00016160: 6520 6073 7461 7274 5f6f 6666 6c69 6e65  e `start_offline
+00016170: 5f6d 6174 6572 6961 6c69 7a61 7469 6f6e  _materialization
+00016180: 6020 696e 7374 6561 642e 0a20 2020 2020  ` instead..     
+00016190: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+000161a0: 2060 7374 6172 745f 6f66 666c 696e 655f   `start_offline_
+000161b0: 6d61 7465 7269 616c 697a 6174 696f 6e60  materialization`
+000161c0: 2061 6e64 2076 616c 7565 2060 5472 7565   and value `True
+000161d0: 6020 6f72 2060 4661 6c73 6560 2074 6f20  ` or `False` to 
+000161e0: 636f 6e66 6967 7572 650a 2020 2020 2020  configure.      
+000161f0: 2020 2020 2020 2020 2020 2020 7768 6574              whet
+00016200: 6865 7220 6f72 206e 6f74 2074 6f20 7374  her or not to st
+00016210: 6172 7420 7468 6520 6d61 7465 7269 616c  art the material
+00016220: 697a 6174 696f 6e20 6a6f 6220 746f 2077  ization job to w
+00016230: 7269 7465 2064 6174 6120 746f 2074 6865  rite data to the
+00016240: 206f 6666 6c69 6e65 0a20 2020 2020 2020   offline.       
+00016250: 2020 2020 2020 2020 2020 2073 746f 7261             stora
+00016260: 6765 2e20 4279 2064 6566 6175 6c74 2074  ge. By default t
+00016270: 6865 206d 6174 6572 6961 6c69 7a61 7469  he materializati
+00016280: 6f6e 206a 6f62 2067 6574 7320 7374 6172  on job gets star
+00016290: 7465 6420 696d 6d65 6469 6174 656c 792e  ted immediately.
+000162a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000162b0: 202a 206b 6579 2060 6b61 666b 615f 7072   * key `kafka_pr
+000162c0: 6f64 7563 6572 5f63 6f6e 6669 6760 2061  oducer_config` a
+000162d0: 6e64 2076 616c 7565 2061 6e20 6f62 6a65  nd value an obje
+000162e0: 6374 206f 6620 7479 7065 205b 7072 6f70  ct of type [prop
+000162f0: 6572 7469 6573 5d28 6874 7470 733a 2f2f  erties](https://
+00016300: 646f 6373 2e63 6f6e 666c 7565 6e74 2e69  docs.confluent.i
+00016310: 6f2f 706c 6174 666f 726d 2f63 7572 7265  o/platform/curre
+00016320: 6e74 2f63 6c69 656e 7473 2f6c 6962 7264  nt/clients/librd
+00016330: 6b61 666b 612f 6874 6d6c 2f6d 645f 434f  kafka/html/md_CO
+00016340: 4e46 4947 5552 4154 494f 4e2e 6874 6d6c  NFIGURATION.html
+00016350: 6e29 0a20 2020 2020 2020 2020 2020 2020  n).             
+00016360: 2020 2020 2075 7365 6420 746f 2063 6f6e       used to con
+00016370: 6669 6775 7265 2074 6865 204b 6166 6b61  figure the Kafka
+00016380: 2063 6c69 656e 742e 2054 6f20 6f70 7469   client. To opti
+00016390: 6d69 7a65 2066 6f72 2074 6872 6f75 6768  mize for through
+000163a0: 7075 7420 696e 2068 6967 6820 6c61 7465  put in high late
+000163b0: 6e63 7920 636f 6e6e 6563 7469 6f6e 2c20  ncy connection, 
+000163c0: 636f 6e73 6964 6572 0a20 2020 2020 2020  consider.       
+000163d0: 2020 2020 2020 2020 2020 2063 6861 6e67             chang
+000163e0: 696e 6720 7468 6520 5b70 726f 6475 6365  ing the [produce
+000163f0: 7220 7072 6f70 6572 7469 6573 5d28 6874  r properties](ht
+00016400: 7470 733a 2f2f 646f 6373 2e63 6f6e 666c  tps://docs.confl
+00016410: 7565 6e74 2e69 6f2f 636c 6f75 642f 6375  uent.io/cloud/cu
+00016420: 7272 656e 742f 636c 6965 6e74 2d61 7070  rrent/client-app
+00016430: 732f 6f70 7469 6d69 7a69 6e67 2f74 6872  s/optimizing/thr
+00016440: 6f75 6768 7075 742e 6874 6d6c 2370 726f  oughput.html#pro
+00016450: 6475 6365 7229 2e0a 2020 2020 2020 2020  ducer)..        
+00016460: 2020 2020 2020 2020 2a20 6b65 7920 6069          * key `i
+00016470: 6e74 6572 6e61 6c5f 6b61 666b 6160 2061  nternal_kafka` a
+00016480: 6e64 2076 616c 7565 2060 5472 7565 6020  nd value `True` 
+00016490: 6f72 2060 4661 6c73 6560 2069 6e20 6361  or `False` in ca
+000164a0: 7365 2079 6f75 2065 7374 6162 6c69 7368  se you establish
+000164b0: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+000164c0: 2020 2020 2063 6f6e 6e65 6374 6976 6974       connectivit
+000164d0: 7920 6672 6f6d 2079 6f75 2050 7974 686f  y from you Pytho
+000164e0: 6e20 656e 7669 726f 6e6d 656e 7420 746f  n environment to
+000164f0: 2074 6865 2069 6e74 6572 6e61 6c20 6164   the internal ad
+00016500: 7665 7274 6973 6564 0a20 2020 2020 2020  vertised.       
+00016510: 2020 2020 2020 2020 2020 206c 6973 7465             liste
+00016520: 6e65 7273 206f 6620 7468 6520 486f 7073  ners of the Hops
+00016530: 776f 726b 7320 4b61 666b 6120 436c 7573  works Kafka Clus
+00016540: 7465 722e 2044 6566 6175 6c74 7320 746f  ter. Defaults to
+00016550: 2060 4661 6c73 6560 2061 6e64 0a20 2020   `False` and.   
+00016560: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+00016570: 696c 6c20 7573 6520 6578 7465 726e 616c  ill use external
+00016580: 206c 6973 7465 6e65 7273 2077 6865 6e20   listeners when 
+00016590: 636f 6e6e 6563 7469 6e67 2066 726f 6d20  connecting from 
+000165a0: 6f75 7473 6964 6520 6f66 2048 6f70 7377  outside of Hopsw
+000165b0: 6f72 6b73 2e0a 2020 2020 2020 2020 2020  orks..          
+000165c0: 2020 7661 6c69 6461 7469 6f6e 5f6f 7074    validation_opt
+000165d0: 696f 6e73 3a20 4164 6469 7469 6f6e 616c  ions: Additional
+000165e0: 2076 616c 6964 6174 696f 6e20 6f70 7469   validation opti
+000165f0: 6f6e 7320 6173 206b 6579 2d76 616c 7565  ons as key-value
+00016600: 2070 6169 7273 2c20 6465 6661 756c 7473   pairs, defaults
+00016610: 2074 6f20 607b 7d60 2e0a 2020 2020 2020   to `{}`..      
+00016620: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
+00016630: 6072 756e 5f76 616c 6964 6174 696f 6e60  `run_validation`
+00016640: 2062 6f6f 6c65 616e 2076 616c 7565 2c20   boolean value, 
+00016650: 7365 7420 746f 2060 4661 6c73 6560 2074  set to `False` t
+00016660: 6f20 736b 6970 2076 616c 6964 6174 696f  o skip validatio
+00016670: 6e20 7465 6d70 6f72 6172 696c 7920 6f6e  n temporarily on
+00016680: 2069 6e67 6573 7469 6f6e 2e0a 2020 2020   ingestion..    
+00016690: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
+000166a0: 7920 6073 6176 655f 7265 706f 7274 6020  y `save_report` 
+000166b0: 626f 6f6c 6561 6e20 7661 6c75 652c 2073  boolean value, s
+000166c0: 6574 2074 6f20 6046 616c 7365 6020 746f  et to `False` to
+000166d0: 2073 6b69 7020 7570 6c6f 6164 206f 6620   skip upload of 
+000166e0: 7468 6520 7661 6c69 6461 7469 6f6e 2072  the validation r
+000166f0: 6570 6f72 7420 746f 2048 6f70 7377 6f72  eport to Hopswor
+00016700: 6b73 2e0a 2020 2020 2020 2020 2020 2020  ks..            
+00016710: 2020 2020 2a20 6b65 7920 6067 655f 7661      * key `ge_va
+00016720: 6c69 6461 7465 5f6b 7761 7267 7360 2061  lidate_kwargs` a
+00016730: 2064 6963 7469 6f6e 6172 7920 636f 6e74   dictionary cont
+00016740: 6169 6e69 6e67 206b 7761 7267 7320 666f  aining kwargs fo
+00016750: 7220 7468 6520 7661 6c69 6461 7465 206d  r the validate m
+00016760: 6574 686f 6420 6f66 2047 7265 6174 2045  ethod of Great E
+00016770: 7870 6563 7461 7469 6f6e 732e 0a20 2020  xpectations..   
+00016780: 2020 2020 2020 2020 2077 6169 743a 2057           wait: W
+00016790: 6169 7420 666f 7220 6a6f 6220 746f 2066  ait for job to f
+000167a0: 696e 6973 6820 6265 666f 7265 2072 6574  inish before ret
+000167b0: 7572 6e69 6e67 2c20 6465 6661 756c 7473  urning, defaults
+000167c0: 2074 6f20 6046 616c 7365 602e 0a20 2020   to `False`..   
+000167d0: 2020 2020 2020 2020 2020 2020 2053 686f               Sho
+000167e0: 7274 6375 7420 666f 7220 7265 6164 5f6f  rtcut for read_o
+000167f0: 7074 696f 6e73 2060 7b22 7761 6974 5f66  ptions `{"wait_f
+00016800: 6f72 5f6a 6f62 223a 2046 616c 7365 7d60  or_job": False}`
+00016810: 2e0a 0a20 2020 2020 2020 2023 2052 6574  ...        # Ret
+00016820: 7572 6e73 0a20 2020 2020 2020 2020 2020  urns.           
+00016830: 2060 4a6f 6260 3a20 5768 656e 2075 7369   `Job`: When usi
+00016840: 6e67 2074 6865 2060 7079 7468 6f6e 6020  ng the `python` 
+00016850: 656e 6769 6e65 2c20 6974 2072 6574 7572  engine, it retur
+00016860: 6e73 2074 6865 2048 6f70 7377 6f72 6b73  ns the Hopsworks
+00016870: 204a 6f62 0a20 2020 2020 2020 2020 2020   Job.           
+00016880: 2020 2020 2074 6861 7420 7761 7320 6c61       that was la
+00016890: 756e 6368 6564 2074 6f20 696e 6765 7374  unched to ingest
+000168a0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+000168b0: 7570 2064 6174 612e 0a0a 2020 2020 2020  up data...      
+000168c0: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
+000168d0: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
+000168e0: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
+000168f0: 6573 7441 5049 4572 726f 7260 2e20 556e  estAPIError`. Un
+00016900: 6162 6c65 2074 6f20 6372 6561 7465 2066  able to create f
+00016910: 6561 7475 7265 2067 726f 7570 2e0a 2020  eature group..  
+00016920: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+00016930: 2020 6966 2028 6665 6174 7572 6573 2069    if (features i
+00016940: 7320 4e6f 6e65 2061 6e64 206c 656e 2873  s None and len(s
+00016950: 656c 662e 5f66 6561 7475 7265 7329 203e  elf._features) >
+00016960: 2030 2920 6f72 2028 0a20 2020 2020 2020   0) or (.       
+00016970: 2020 2020 2069 7369 6e73 7461 6e63 6528       isinstance(
+00016980: 6665 6174 7572 6573 2c20 4c69 7374 290a  features, List).
+00016990: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000169a0: 6c65 6e28 6665 6174 7572 6573 2920 3e20  len(features) > 
+000169b0: 300a 2020 2020 2020 2020 2020 2020 616e  0.            an
+000169c0: 6420 616c 6c28 5b69 7369 6e73 7461 6e63  d all([isinstanc
+000169d0: 6528 662c 2066 6561 7475 7265 2e46 6561  e(f, feature.Fea
+000169e0: 7475 7265 2920 666f 7220 6620 696e 2066  ture) for f in f
+000169f0: 6561 7475 7265 735d 290a 2020 2020 2020  eatures]).      
+00016a00: 2020 293a 0a20 2020 2020 2020 2020 2020    ):.           
+00016a10: 2023 2054 6869 7320 6973 2064 6f6e 6520   # This is done 
+00016a20: 666f 7220 636f 6d70 6174 6962 696c 6974  for compatibilit
+00016a30: 792e 2055 7365 7273 2063 616e 2073 7065  y. Users can spe
+00016a40: 6369 6679 2074 6865 2066 6561 7475 7265  cify the feature
+00016a50: 206c 6973 7420 696e 2074 6865 0a20 2020   list in the.   
+00016a60: 2020 2020 2020 2020 2023 2028 6765 745f           # (get_
+00016a70: 6f72 5f29 6372 6561 7465 5f66 6561 7475  or_)create_featu
+00016a80: 7265 5f67 726f 7570 2e20 5573 6572 7320  re_group. Users 
+00016a90: 6361 6e20 616c 736f 2070 726f 7669 6465  can also provide
+00016aa0: 2074 6865 2066 6561 7475 7265 206c 6973   the feature lis
+00016ab0: 7420 696e 2074 6865 2073 6176 6528 292e  t in the save().
+00016ac0: 0a20 2020 2020 2020 2020 2020 2023 2054  .            # T
+00016ad0: 686f 7567 6820 6974 2773 2061 6e20 6f70  hough it's an op
+00016ae0: 7469 6f6e 616c 2070 6172 616d 6574 6572  tional parameter
+00016af0: 2e0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+00016b00: 466f 7220 636f 6e73 6973 7465 6e63 7920  For consistency 
+00016b10: 7265 6173 6f6e 7320 6966 2074 6865 2075  reasons if the u
+00016b20: 7365 7220 7370 6563 6966 7920 626f 7468  ser specify both
+00016b30: 2074 6865 2066 6561 7475 7265 206c 6973   the feature lis
+00016b40: 7420 696e 2074 6865 2028 6765 745f 6f72  t in the (get_or
+00016b50: 5f29 6372 6561 7465 5f66 6561 7475 7265  _)create_feature
+00016b60: 5f67 726f 7570 0a20 2020 2020 2020 2020  _group.         
+00016b70: 2020 2023 2061 6e64 2069 6e20 7468 6520     # and in the 
+00016b80: 6073 6176 6528 2960 2063 616c 6c2c 2074  `save()` call, t
+00016b90: 6865 6e20 7468 6520 2867 6574 5f6f 725f  hen the (get_or_
+00016ba0: 2963 7265 6174 655f 6665 6174 7572 655f  )create_feature_
+00016bb0: 6772 6f75 7020 7769 6e73 2e0a 2020 2020  group wins..    
+00016bc0: 2020 2020 2020 2020 2320 5468 6973 2069          # This i
+00016bd0: 7320 636f 6e73 6973 7465 6e74 2077 6974  s consistent wit
+00016be0: 6820 7468 6520 6265 6861 7669 6f72 206f  h the behavior o
+00016bf0: 6620 7468 6520 696e 7365 7274 206d 6574  f the insert met
+00016c00: 686f 6420 7768 6572 6520 7468 6520 6665  hod where the fe
+00016c10: 6174 7572 6520 6c69 7374 2077 696e 7320  ature list wins 
+00016c20: 6f76 6572 2074 6865 0a20 2020 2020 2020  over the.       
+00016c30: 2020 2020 2023 2064 6174 6166 7261 6d65       # dataframe
+00016c40: 2073 7472 7563 7475 7265 0a20 2020 2020   structure.     
+00016c50: 2020 2020 2020 2073 656c 662e 5f66 6561         self._fea
+00016c60: 7475 7265 7320 3d20 7365 6c66 2e5f 6665  tures = self._fe
+00016c70: 6174 7572 6573 2069 6620 6c65 6e28 7365  atures if len(se
+00016c80: 6c66 2e5f 6665 6174 7572 6573 2920 3e20  lf._features) > 
+00016c90: 3020 656c 7365 2066 6561 7475 7265 730a  0 else features.
+00016ca0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00016cb0: 2e5f 6665 6174 7572 655f 6772 6f75 705f  ._feature_group_
+00016cc0: 656e 6769 6e65 2e73 6176 655f 6665 6174  engine.save_feat
+00016cd0: 7572 655f 6772 6f75 705f 6d65 7461 6461  ure_group_metada
+00016ce0: 7461 280a 2020 2020 2020 2020 2020 2020  ta(.            
+00016cf0: 2020 2020 7365 6c66 2c20 4e6f 6e65 2c20      self, None, 
+00016d00: 7772 6974 655f 6f70 7469 6f6e 730a 2020  write_options.  
+00016d10: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00016d20: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+00016d30: 4e6f 6e65 2c20 4e6f 6e65 0a0a 2020 2020  None, None..    
+00016d40: 2020 2020 6966 2066 6561 7475 7265 7320      if features 
+00016d50: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+00016d60: 2020 2020 2072 6169 7365 2046 6561 7475       raise Featu
+00016d70: 7265 5374 6f72 6545 7863 6570 7469 6f6e  reStoreException
+00016d80: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00016d90: 2020 2246 6561 7475 7265 206c 6973 7420    "Feature list 
+00016da0: 6e6f 7420 7072 6f76 6964 6564 2069 6e20  not provided in 
+00016db0: 7468 6520 6372 6561 7465 5f66 6561 7475  the create_featu
+00016dc0: 7265 5f67 726f 7570 206f 7220 6765 745f  re_group or get_
+00016dd0: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
+00016de0: 655f 6772 6f75 7020 696e 766f 6b61 7469  e_group invokati
+00016df0: 6f6e 732e 220a 2020 2020 2020 2020 2020  ons.".          
+00016e00: 2020 2020 2020 2b20 2220 506c 6561 7365        + " Please
+00016e10: 2070 726f 7669 6465 2061 206c 6973 7420   provide a list 
+00016e20: 6f66 2066 6561 7475 7265 7320 6f72 2061  of features or a
+00016e30: 2044 6174 6166 7261 6d65 220a 2020 2020   Dataframe".    
+00016e40: 2020 2020 2020 2020 290a 0a20 2020 2020          )..     
+00016e50: 2020 2066 6561 7475 7265 5f64 6174 6166     feature_dataf
+00016e60: 7261 6d65 203d 2065 6e67 696e 652e 6765  rame = engine.ge
+00016e70: 745f 696e 7374 616e 6365 2829 2e63 6f6e  t_instance().con
+00016e80: 7665 7274 5f74 6f5f 6465 6661 756c 745f  vert_to_default_
+00016e90: 6461 7461 6672 616d 6528 6665 6174 7572  dataframe(featur
+00016ea0: 6573 290a 0a20 2020 2020 2020 2075 7365  es)..        use
+00016eb0: 725f 7665 7273 696f 6e20 3d20 7365 6c66  r_version = self
+00016ec0: 2e5f 7665 7273 696f 6e0a 0a20 2020 2020  ._version..     
+00016ed0: 2020 2069 6620 7772 6974 655f 6f70 7469     if write_opti
+00016ee0: 6f6e 7320 6973 204e 6f6e 653a 0a20 2020  ons is None:.   
+00016ef0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
+00016f00: 7074 696f 6e73 203d 207b 7d0a 2020 2020  ptions = {}.    
+00016f10: 2020 2020 6966 2022 7761 6974 5f66 6f72      if "wait_for
+00016f20: 5f6a 6f62 2220 6e6f 7420 696e 2077 7269  _job" not in wri
+00016f30: 7465 5f6f 7074 696f 6e73 3a0a 2020 2020  te_options:.    
+00016f40: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
+00016f50: 7469 6f6e 735b 2277 6169 745f 666f 725f  tions["wait_for_
+00016f60: 6a6f 6222 5d20 3d20 7761 6974 0a0a 2020  job"] = wait..  
+00016f70: 2020 2020 2020 2320 6667 5f6a 6f62 2069        # fg_job i
+00016f80: 7320 7573 6564 206f 6e6c 7920 6966 2074  s used only if t
+00016f90: 6865 2070 7974 686f 6e20 656e 6769 6e65  he python engine
+00016fa0: 2069 7320 7573 6564 0a20 2020 2020 2020   is used.       
+00016fb0: 2066 675f 6a6f 622c 2067 655f 7265 706f   fg_job, ge_repo
+00016fc0: 7274 203d 2073 656c 662e 5f66 6561 7475  rt = self._featu
+00016fd0: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
+00016fe0: 7361 7665 280a 2020 2020 2020 2020 2020  save(.          
+00016ff0: 2020 7365 6c66 2c20 6665 6174 7572 655f    self, feature_
+00017000: 6461 7461 6672 616d 652c 2077 7269 7465  dataframe, write
+00017010: 5f6f 7074 696f 6e73 2c20 7661 6c69 6461  _options, valida
+00017020: 7469 6f6e 5f6f 7074 696f 6e73 0a20 2020  tion_options.   
+00017030: 2020 2020 2029 0a20 2020 2020 2020 2069       ).        i
+00017040: 6620 6765 5f72 6570 6f72 7420 6973 204e  f ge_report is N
+00017050: 6f6e 6520 6f72 2067 655f 7265 706f 7274  one or ge_report
+00017060: 2e69 6e67 6573 7469 6f6e 5f72 6573 756c  .ingestion_resul
+00017070: 7420 3d3d 2022 494e 4745 5354 4544 223a  t == "INGESTED":
+00017080: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00017090: 662e 5f63 6f64 655f 656e 6769 6e65 2e73  f._code_engine.s
+000170a0: 6176 655f 636f 6465 2873 656c 6629 0a0a  ave_code(self)..
+000170b0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000170c0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+000170d0: 672e 656e 6162 6c65 6420 616e 6420 656e  g.enabled and en
+000170e0: 6769 6e65 2e67 6574 5f74 7970 6528 292e  gine.get_type().
+000170f0: 7374 6172 7473 7769 7468 2822 7370 6172  startswith("spar
+00017100: 6b22 293a 0a20 2020 2020 2020 2020 2020  k"):.           
+00017110: 2023 204f 6e6c 7920 636f 6d70 7574 6520   # Only compute 
+00017120: 7374 6174 6973 7469 6373 2069 6620 7468  statistics if th
+00017130: 6520 656e 6769 6e65 2069 7320 5370 6172  e engine is Spar
+00017140: 6b2e 0a20 2020 2020 2020 2020 2020 2023  k..            #
+00017150: 2046 6f72 2050 7974 686f 6e20 656e 6769   For Python engi
+00017160: 6e65 2c20 7468 6520 636f 6d70 7574 6174  ne, the computat
+00017170: 696f 6e20 6861 7070 656e 7320 696e 2074  ion happens in t
+00017180: 6865 2048 6f70 7377 6f72 6b73 2061 7070  he Hopsworks app
+00017190: 6c69 6361 7469 6f6e 0a20 2020 2020 2020  lication.       
+000171a0: 2020 2020 2073 656c 662e 5f73 7461 7469       self._stati
+000171b0: 7374 6963 735f 656e 6769 6e65 2e63 6f6d  stics_engine.com
+000171c0: 7075 7465 5f61 6e64 5f73 6176 655f 7374  pute_and_save_st
+000171d0: 6174 6973 7469 6373 2873 656c 662c 2066  atistics(self, f
+000171e0: 6561 7475 7265 5f64 6174 6166 7261 6d65  eature_dataframe
+000171f0: 290a 2020 2020 2020 2020 6966 2075 7365  ).        if use
+00017200: 725f 7665 7273 696f 6e20 6973 204e 6f6e  r_version is Non
+00017210: 653a 0a20 2020 2020 2020 2020 2020 2077  e:.            w
+00017220: 6172 6e69 6e67 732e 7761 726e 280a 2020  arnings.warn(.  
+00017230: 2020 2020 2020 2020 2020 2020 2020 224e                "N
+00017240: 6f20 7665 7273 696f 6e20 7072 6f76 6964  o version provid
+00017250: 6564 2066 6f72 2063 7265 6174 696e 6720  ed for creating 
+00017260: 6665 6174 7572 6520 6772 6f75 7020 607b  feature group `{
+00017270: 7d60 2c20 696e 6372 656d 656e 7465 6420  }`, incremented 
+00017280: 7665 7273 696f 6e20 746f 2060 7b7d 602e  version to `{}`.
+00017290: 222e 666f 726d 6174 280a 2020 2020 2020  ".format(.      
+000172a0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+000172b0: 6c66 2e5f 6e61 6d65 2c20 7365 6c66 2e5f  lf._name, self._
+000172c0: 7665 7273 696f 6e0a 2020 2020 2020 2020  version.        
+000172d0: 2020 2020 2020 2020 292c 0a20 2020 2020          ),.     
+000172e0: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
+000172f0: 5665 7273 696f 6e57 6172 6e69 6e67 2c0a  VersionWarning,.
+00017300: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+00017310: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
+00017320: 2020 2020 2020 2020 2020 2066 675f 6a6f             fg_jo
+00017330: 622c 0a20 2020 2020 2020 2020 2020 2067  b,.            g
+00017340: 655f 7265 706f 7274 2e74 6f5f 6765 5f74  e_report.to_ge_t
+00017350: 7970 6528 2920 6966 2067 655f 7265 706f  ype() if ge_repo
+00017360: 7274 2069 7320 6e6f 7420 4e6f 6e65 2065  rt is not None e
+00017370: 6c73 6520 4e6f 6e65 2c0a 2020 2020 2020  lse None,.      
+00017380: 2020 290a 0a20 2020 2064 6566 2069 6e73    )..    def ins
+00017390: 6572 7428 0a20 2020 2020 2020 2073 656c  ert(.        sel
+000173a0: 662c 0a20 2020 2020 2020 2066 6561 7475  f,.        featu
+000173b0: 7265 733a 2055 6e69 6f6e 5b0a 2020 2020  res: Union[.    
+000173c0: 2020 2020 2020 2020 7064 2e44 6174 6146          pd.DataF
+000173d0: 7261 6d65 2c0a 2020 2020 2020 2020 2020  rame,.          
+000173e0: 2020 5479 7065 5661 7228 2270 7973 7061    TypeVar("pyspa
+000173f0: 726b 2e73 716c 2e44 6174 6146 7261 6d65  rk.sql.DataFrame
+00017400: 2229 2c20 2023 206e 6f71 613a 2046 3832  "),  # noqa: F82
+00017410: 310a 2020 2020 2020 2020 2020 2020 5479  1.            Ty
+00017420: 7065 5661 7228 2270 7973 7061 726b 2e52  peVar("pyspark.R
+00017430: 4444 2229 2c20 2023 206e 6f71 613a 2046  DD"),  # noqa: F
+00017440: 3832 310a 2020 2020 2020 2020 2020 2020  821.            
+00017450: 6e70 2e6e 6461 7272 6179 2c0a 2020 2020  np.ndarray,.    
+00017460: 2020 2020 2020 2020 4c69 7374 5b6c 6973          List[lis
+00017470: 745d 2c0a 2020 2020 2020 2020 5d2c 0a20  t],.        ],. 
+00017480: 2020 2020 2020 206f 7665 7277 7269 7465         overwrite
+00017490: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+000174a0: 203d 2046 616c 7365 2c0a 2020 2020 2020   = False,.      
+000174b0: 2020 6f70 6572 6174 696f 6e3a 204f 7074    operation: Opt
+000174c0: 696f 6e61 6c5b 7374 725d 203d 2022 7570  ional[str] = "up
+000174d0: 7365 7274 222c 0a20 2020 2020 2020 2073  sert",.        s
+000174e0: 746f 7261 6765 3a20 4f70 7469 6f6e 616c  torage: Optional
+000174f0: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+00017500: 2020 2020 2020 7772 6974 655f 6f70 7469        write_opti
+00017510: 6f6e 733a 204f 7074 696f 6e61 6c5b 4469  ons: Optional[Di
+00017520: 6374 5b73 7472 2c20 416e 795d 5d20 3d20  ct[str, Any]] = 
+00017530: 7b7d 2c0a 2020 2020 2020 2020 7661 6c69  {},.        vali
+00017540: 6461 7469 6f6e 5f6f 7074 696f 6e73 3a20  dation_options: 
+00017550: 4f70 7469 6f6e 616c 5b44 6963 745b 7374  Optional[Dict[st
+00017560: 722c 2041 6e79 5d5d 203d 207b 7d2c 0a20  r, Any]] = {},. 
+00017570: 2020 2020 2020 2073 6176 655f 636f 6465         save_code
+00017580: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00017590: 203d 2054 7275 652c 0a20 2020 2020 2020   = True,.       
+000175a0: 2077 6169 743a 2062 6f6f 6c20 3d20 4661   wait: bool = Fa
+000175b0: 6c73 652c 0a20 2020 2029 202d 3e20 5475  lse,.    ) -> Tu
+000175c0: 706c 655b 4f70 7469 6f6e 616c 5b4a 6f62  ple[Optional[Job
+000175d0: 5d2c 204f 7074 696f 6e61 6c5b 5661 6c69  ], Optional[Vali
+000175e0: 6461 7469 6f6e 5265 706f 7274 5d5d 3a0a  dationReport]]:.
+000175f0: 2020 2020 2020 2020 2222 2250 6572 7369          """Persi
+00017600: 7374 2074 6865 206d 6574 6164 6174 6120  st the metadata 
+00017610: 616e 6420 6d61 7465 7269 616c 697a 6520  and materialize 
+00017620: 7468 6520 6665 6174 7572 6520 6772 6f75  the feature grou
+00017630: 7020 746f 2074 6865 2066 6561 7475 7265  p to the feature
+00017640: 2073 746f 7265 0a20 2020 2020 2020 206f   store.        o
+00017650: 7220 696e 7365 7274 2064 6174 6120 6672  r insert data fr
+00017660: 6f6d 2061 2064 6174 6166 7261 6d65 2069  om a dataframe i
+00017670: 6e74 6f20 7468 6520 6578 6973 7469 6e67  nto the existing
+00017680: 2066 6561 7475 7265 2067 726f 7570 2e0a   feature group..
+00017690: 0a20 2020 2020 2020 2049 6e63 7265 6d65  .        Increme
+000176a0: 6e74 616c 6c79 2069 6e73 6572 7420 6461  ntally insert da
+000176b0: 7461 2074 6f20 6120 6665 6174 7572 6520  ta to a feature 
+000176c0: 6772 6f75 7020 6f72 206f 7665 7277 7269  group or overwri
+000176d0: 7465 2061 6c6c 2064 6174 6120 636f 6e74  te all data cont
+000176e0: 6169 6e65 6420 696e 2074 6865 2066 6561  ained in the fea
+000176f0: 7475 7265 2067 726f 7570 2e20 4279 0a20  ture group. By. 
+00017700: 2020 2020 2020 2064 6566 6175 6c74 2c20         default, 
+00017710: 7468 6520 6461 7461 2069 7320 696e 7365  the data is inse
+00017720: 7274 6564 2069 6e74 6f20 7468 6520 6f66  rted into the of
+00017730: 666c 696e 6520 7374 6f72 6167 6520 6173  fline storage as
+00017740: 2077 656c 6c20 6173 2074 6865 206f 6e6c   well as the onl
+00017750: 696e 6520 7374 6f72 6167 6520 6966 2074  ine storage if t
+00017760: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00017770: 2069 730a 2020 2020 2020 2020 606f 6e6c   is.        `onl
+00017780: 696e 655f 656e 6162 6c65 643d 5472 7565  ine_enabled=True
+00017790: 602e 0a0a 2020 2020 2020 2020 5468 6520  `...        The 
+000177a0: 6066 6561 7475 7265 7360 2064 6174 6166  `features` dataf
+000177b0: 7261 6d65 2063 616e 2062 6520 6120 5370  rame can be a Sp
+000177c0: 6172 6b20 4461 7461 4672 616d 6520 6f72  ark DataFrame or
+000177d0: 2052 4444 2c20 6120 5061 6e64 6173 2044   RDD, a Pandas D
+000177e0: 6174 6146 7261 6d65 2c0a 2020 2020 2020  ataFrame,.      
+000177f0: 2020 6f72 2061 2074 776f 2d64 696d 656e    or a two-dimen
+00017800: 7369 6f6e 616c 204e 756d 7079 2061 7272  sional Numpy arr
+00017810: 6179 206f 7220 6120 7477 6f2d 6469 6d65  ay or a two-dime
+00017820: 6e73 696f 6e61 6c20 5079 7468 6f6e 206e  nsional Python n
+00017830: 6573 7465 6420 6c69 7374 2e0a 2020 2020  ested list..    
+00017840: 2020 2020 4966 2073 7461 7469 7374 6963      If statistic
+00017850: 7320 6172 6520 656e 6162 6c65 642c 2073  s are enabled, s
+00017860: 7461 7469 7374 6963 7320 6172 6520 7265  tatistics are re
+00017870: 636f 6d70 7574 6564 2066 6f72 2074 6865  computed for the
+00017880: 2065 6e74 6972 6520 6665 6174 7572 650a   entire feature.
+00017890: 2020 2020 2020 2020 6772 6f75 702e 0a20          group.. 
+000178a0: 2020 2020 2020 2049 6620 6665 6174 7572         If featur
+000178b0: 6520 6772 6f75 7027 7320 7469 6d65 2074  e group's time t
+000178c0: 7261 7665 6c20 666f 726d 6174 2069 7320  ravel format is 
+000178d0: 6048 5544 4960 2074 6865 6e20 606f 7065  `HUDI` then `ope
+000178e0: 7261 7469 6f6e 6020 6172 6775 6d65 6e74  ration` argument
+000178f0: 2063 616e 2062 650a 2020 2020 2020 2020   can be.        
+00017900: 6569 7468 6572 2060 696e 7365 7274 6020  either `insert` 
+00017910: 6f72 2060 7570 7365 7274 602e 0a0a 2020  or `upsert`...  
+00017920: 2020 2020 2020 4966 2066 6561 7475 7265        If feature
+00017930: 2067 726f 7570 2064 6f65 736e 2774 2065   group doesn't e
+00017940: 7869 7374 2074 6865 2069 6e73 6572 7420  xist the insert 
+00017950: 6d65 7468 6f64 2077 696c 6c20 6372 6561  method will crea
+00017960: 7465 2074 6865 206e 6563 6573 7361 7279  te the necessary
+00017970: 206d 6574 6164 6174 6120 7468 6520 6669   metadata the fi
+00017980: 7273 7420 7469 6d65 2069 7420 6973 0a20  rst time it is. 
+00017990: 2020 2020 2020 2069 6e76 6f6b 6564 2061         invoked a
+000179a0: 6e64 2077 7269 7465 7320 7468 6520 7370  nd writes the sp
+000179b0: 6563 6966 6965 6420 6066 6561 7475 7265  ecified `feature
+000179c0: 7360 2064 6174 6166 7261 6d65 2061 7320  s` dataframe as 
+000179d0: 6665 6174 7572 6520 6772 6f75 7020 746f  feature group to
+000179e0: 2074 6865 206f 6e6c 696e 652f 6f66 666c   the online/offl
+000179f0: 696e 6520 6665 6174 7572 6520 7374 6f72  ine feature stor
+00017a00: 652e 0a0a 2020 2020 2020 2020 2121 2120  e...        !!! 
+00017a10: 7761 726e 696e 6720 2243 6861 6e67 6564  warning "Changed
+00017a20: 2069 6e20 332e 332e 3022 0a20 2020 2020   in 3.3.0".     
+00017a30: 2020 2020 2020 2060 696e 7365 7274 6020         `insert` 
+00017a40: 616e 6420 6073 6176 6560 206d 6574 686f  and `save` metho
+00017a50: 6473 2061 7265 206e 6f77 2061 7379 6e63  ds are now async
+00017a60: 2062 7920 6465 6661 756c 7420 696e 206e   by default in n
+00017a70: 6f6e 2d73 7061 726b 2063 6c69 656e 7473  on-spark clients
+00017a80: 2e0a 2020 2020 2020 2020 2020 2020 546f  ..            To
+00017a90: 2061 6368 6965 7665 2074 6865 206f 6c64   achieve the old
+00017aa0: 2062 6568 6176 696f 7572 2c20 7365 7420   behaviour, set 
+00017ab0: 6077 6169 7460 2061 7267 756d 656e 7420  `wait` argument 
+00017ac0: 746f 2060 5472 7565 602e 0a0a 2020 2020  to `True`...    
+00017ad0: 2020 2020 2121 2120 6578 616d 706c 6520      !!! example 
+00017ae0: 2255 7073 6572 7420 6e65 7720 6665 6174  "Upsert new feat
+00017af0: 7572 6520 6461 7461 2077 6974 6820 7469  ure data with ti
+00017b00: 6d65 2074 7261 7665 6c20 666f 726d 6174  me travel format
+00017b10: 2060 4855 4449 6022 0a20 2020 2020 2020   `HUDI`".       
+00017b20: 2020 2020 2060 6060 7079 7468 6f6e 0a20       ```python. 
+00017b30: 2020 2020 2020 2020 2020 2023 2063 6f6e             # con
+00017b40: 6e65 6374 2074 6f20 7468 6520 4665 6174  nect to the Feat
+00017b50: 7572 6520 5374 6f72 650a 2020 2020 2020  ure Store.      
+00017b60: 2020 2020 2020 6673 203d 202e 2e2e 0a0a        fs = .....
+00017b70: 2020 2020 2020 2020 2020 2020 6667 203d              fg =
+00017b80: 2066 732e 6765 745f 6f72 5f63 7265 6174   fs.get_or_creat
+00017b90: 655f 6665 6174 7572 655f 6772 6f75 7028  e_feature_group(
+00017ba0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00017bb0: 206e 616d 653d 2762 6974 636f 696e 5f70   name='bitcoin_p
+00017bc0: 7269 6365 272c 0a20 2020 2020 2020 2020  rice',.         
+00017bd0: 2020 2020 2020 2064 6573 6372 6970 7469         descripti
+00017be0: 6f6e 3d27 4269 7463 6f69 6e20 7072 6963  on='Bitcoin pric
+00017bf0: 6520 6167 6772 6567 6174 6564 2066 6f72  e aggregated for
+00017c00: 2064 6179 7327 2c0a 2020 2020 2020 2020   days',.        
+00017c10: 2020 2020 2020 2020 7665 7273 696f 6e3d          version=
+00017c20: 312c 0a20 2020 2020 2020 2020 2020 2020  1,.             
+00017c30: 2020 2070 7269 6d61 7279 5f6b 6579 3d5b     primary_key=[
+00017c40: 2775 6e69 7827 5d2c 0a20 2020 2020 2020  'unix'],.       
+00017c50: 2020 2020 2020 2020 206f 6e6c 696e 655f           online_
+00017c60: 656e 6162 6c65 643d 5472 7565 2c0a 2020  enabled=True,.  
+00017c70: 2020 2020 2020 2020 2020 2020 2020 6576                ev
+00017c80: 656e 745f 7469 6d65 3d27 756e 6978 270a  ent_time='unix'.
+00017c90: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00017ca0: 2020 2020 2020 2020 2020 2066 672e 696e             fg.in
+00017cb0: 7365 7274 2864 665f 6269 7463 6f69 6e5f  sert(df_bitcoin_
+00017cc0: 7072 6f63 6573 7365 6429 0a20 2020 2020  processed).     
+00017cd0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
+00017ce0: 2020 2020 2121 2120 6578 616d 706c 6520      !!! example 
+00017cf0: 2241 7379 6e63 2069 6e73 6572 7422 0a20  "Async insert". 
+00017d00: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+00017d10: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+00017d20: 2023 2063 6f6e 6e65 6374 2074 6f20 7468   # connect to th
+00017d30: 6520 4665 6174 7572 6520 5374 6f72 650a  e Feature Store.
+00017d40: 2020 2020 2020 2020 2020 2020 6673 203d              fs =
+00017d50: 202e 2e2e 0a0a 2020 2020 2020 2020 2020   .....          
+00017d60: 2020 6667 3120 3d20 6673 2e67 6574 5f6f    fg1 = fs.get_o
+00017d70: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+00017d80: 5f67 726f 7570 280a 2020 2020 2020 2020  _group(.        
+00017d90: 2020 2020 2020 2020 6e61 6d65 3d27 6665          name='fe
+00017da0: 6174 7572 655f 6772 6f75 705f 6e61 6d65  ature_group_name
+00017db0: 3127 2c0a 2020 2020 2020 2020 2020 2020  1',.            
+00017dc0: 2020 2020 6465 7363 7269 7074 696f 6e3d      description=
+00017dd0: 2744 6573 6372 6970 7469 6f6e 206f 6620  'Description of 
+00017de0: 7468 6520 6669 7273 7420 4647 272c 0a20  the first FG',. 
+00017df0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00017e00: 6572 7369 6f6e 3d31 2c0a 2020 2020 2020  ersion=1,.      
+00017e10: 2020 2020 2020 2020 2020 7072 696d 6172            primar
+00017e20: 795f 6b65 793d 5b27 756e 6978 275d 2c0a  y_key=['unix'],.
+00017e30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017e40: 6f6e 6c69 6e65 5f65 6e61 626c 6564 3d54  online_enabled=T
+00017e50: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+00017e60: 2020 2020 2065 7665 6e74 5f74 696d 653d       event_time=
+00017e70: 2775 6e69 7827 0a20 2020 2020 2020 2020  'unix'.         
+00017e80: 2020 2029 0a20 2020 2020 2020 2020 2020     ).           
+00017e90: 2023 2061 7379 6e63 2069 6e73 6572 7469   # async inserti
+00017ea0: 6f6e 2069 6e20 6f72 6465 7220 6e6f 7420  on in order not 
+00017eb0: 746f 2077 6169 7420 7469 6c6c 2066 696e  to wait till fin
+00017ec0: 6973 6820 6f66 2074 6865 206a 6f62 0a20  ish of the job. 
+00017ed0: 2020 2020 2020 2020 2020 2066 672e 696e             fg.in
+00017ee0: 7365 7274 2864 665f 666f 725f 6667 312c  sert(df_for_fg1,
+00017ef0: 2077 7269 7465 5f6f 7074 696f 6e73 3d7b   write_options={
+00017f00: 2277 6169 745f 666f 725f 6a6f 6222 203a  "wait_for_job" :
+00017f10: 2046 616c 7365 7d29 0a0a 2020 2020 2020   False})..      
+00017f20: 2020 2020 2020 6667 3220 3d20 6673 2e67        fg2 = fs.g
+00017f30: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+00017f40: 7475 7265 5f67 726f 7570 280a 2020 2020  ture_group(.    
+00017f50: 2020 2020 2020 2020 2020 2020 6e61 6d65              name
+00017f60: 3d27 6665 6174 7572 655f 6772 6f75 705f  ='feature_group_
+00017f70: 6e61 6d65 3227 2c0a 2020 2020 2020 2020  name2',.        
+00017f80: 2020 2020 2020 2020 6465 7363 7269 7074          descript
+00017f90: 696f 6e3d 2744 6573 6372 6970 7469 6f6e  ion='Description
+00017fa0: 206f 6620 7468 6520 7365 636f 6e64 2046   of the second F
+00017fb0: 4727 2c0a 2020 2020 2020 2020 2020 2020  G',.            
+00017fc0: 2020 2020 7665 7273 696f 6e3d 312c 0a20      version=1,. 
+00017fd0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+00017fe0: 7269 6d61 7279 5f6b 6579 3d5b 2775 6e69  rimary_key=['uni
+00017ff0: 7827 5d2c 0a20 2020 2020 2020 2020 2020  x'],.           
+00018000: 2020 2020 206f 6e6c 696e 655f 656e 6162       online_enab
+00018010: 6c65 643d 5472 7565 2c0a 2020 2020 2020  led=True,.      
+00018020: 2020 2020 2020 2020 2020 6576 656e 745f            event_
+00018030: 7469 6d65 3d27 756e 6978 270a 2020 2020  time='unix'.    
+00018040: 2020 2020 2020 2020 290a 2020 2020 2020          ).      
+00018050: 2020 2020 2020 6667 2e69 6e73 6572 7428        fg.insert(
+00018060: 6466 5f66 6f72 5f66 6732 290a 2020 2020  df_for_fg2).    
+00018070: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+00018080: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+00018090: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+000180a0: 7475 7265 733a 2044 6174 6146 7261 6d65  tures: DataFrame
+000180b0: 2c20 5244 442c 204e 6461 7272 6179 2c20  , RDD, Ndarray, 
+000180c0: 6c69 7374 2e20 4665 6174 7572 6573 2074  list. Features t
+000180d0: 6f20 6265 2073 6176 6564 2e0a 2020 2020  o be saved..    
+000180e0: 2020 2020 2020 2020 6f76 6572 7772 6974          overwrit
+000180f0: 653a 2044 726f 7020 616c 6c20 6461 7461  e: Drop all data
+00018100: 2069 6e20 7468 6520 6665 6174 7572 6520   in the feature 
+00018110: 6772 6f75 7020 6265 666f 7265 0a20 2020  group before.   
+00018120: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+00018130: 6572 7469 6e67 206e 6577 2064 6174 612e  erting new data.
+00018140: 2054 6869 7320 646f 6573 206e 6f74 2061   This does not a
+00018150: 6666 6563 7420 6d65 7461 6461 7461 2c20  ffect metadata, 
+00018160: 6465 6661 756c 7473 2074 6f20 4661 6c73  defaults to Fals
+00018170: 652e 0a20 2020 2020 2020 2020 2020 206f  e..            o
+00018180: 7065 7261 7469 6f6e 3a20 4170 6163 6865  peration: Apache
+00018190: 2048 7564 6920 6f70 6572 6174 696f 6e20   Hudi operation 
+000181a0: 7479 7065 2060 2269 6e73 6572 7422 6020  type `"insert"` 
+000181b0: 6f72 2060 2275 7073 6572 7422 602e 0a20  or `"upsert"`.. 
+000181c0: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+000181d0: 6566 6175 6c74 7320 746f 2060 2275 7073  efaults to `"ups
+000181e0: 6572 7422 602e 0a20 2020 2020 2020 2020  ert"`..         
+000181f0: 2020 2073 746f 7261 6765 3a20 4f76 6572     storage: Over
+00018200: 7772 6974 6520 6465 6661 756c 7420 6265  write default be
+00018210: 6861 7669 6f75 722c 2077 7269 7465 2074  haviour, write t
+00018220: 6f20 6f66 666c 696e 650a 2020 2020 2020  o offline.      
+00018230: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
+00018240: 6520 6f6e 6c79 2077 6974 6820 6022 6f66  e only with `"of
+00018250: 666c 696e 6522 6020 6f72 206f 6e6c 696e  fline"` or onlin
+00018260: 6520 6f6e 6c79 2077 6974 6820 6022 6f6e  e only with `"on
+00018270: 6c69 6e65 2260 2c20 6465 6661 756c 7473  line"`, defaults
+00018280: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018290: 2074 6f20 604e 6f6e 6560 2028 4966 2074   to `None` (If t
+000182a0: 6865 2073 7472 6561 6d69 6e67 2041 5049  he streaming API
+000182b0: 7320 6172 6520 656e 6162 6c65 642c 2073  s are enabled, s
+000182c0: 7065 6369 6679 696e 6720 7468 6520 7374  pecifying the st
+000182d0: 6f72 6167 6520 6f70 7469 6f6e 2069 7320  orage option is 
+000182e0: 6e6f 7420 7375 7070 6f72 7465 6429 2e0a  not supported)..
+000182f0: 2020 2020 2020 2020 2020 2020 7772 6974              writ
+00018300: 655f 6f70 7469 6f6e 733a 2041 6464 6974  e_options: Addit
+00018310: 696f 6e61 6c20 7772 6974 6520 6f70 7469  ional write opti
+00018320: 6f6e 7320 6173 206b 6579 2d76 616c 7565  ons as key-value
+00018330: 2070 6169 7273 2c20 6465 6661 756c 7473   pairs, defaults
+00018340: 2074 6f20 607b 7d60 2e0a 2020 2020 2020   to `{}`..      
+00018350: 2020 2020 2020 2020 2020 5768 656e 2075            When u
+00018360: 7369 6e67 2074 6865 2060 7079 7468 6f6e  sing the `python
+00018370: 6020 656e 6769 6e65 2c20 7772 6974 655f  ` engine, write_
+00018380: 6f70 7469 6f6e 7320 6361 6e20 636f 6e74  options can cont
+00018390: 6169 6e20 7468 650a 2020 2020 2020 2020  ain the.        
+000183a0: 2020 2020 2020 2020 666f 6c6c 6f77 696e          followin
+000183b0: 6720 656e 7472 6965 733a 0a20 2020 2020  g entries:.     
+000183c0: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+000183d0: 2060 7370 6172 6b60 2061 6e64 2076 616c   `spark` and val
+000183e0: 7565 2061 6e20 6f62 6a65 6374 206f 6620  ue an object of 
+000183f0: 7479 7065 0a20 2020 2020 2020 2020 2020  type.           
+00018400: 2020 2020 205b 6873 6673 2e63 6f72 652e       [hsfs.core.
+00018410: 6a6f 625f 636f 6e66 6967 7572 6174 696f  job_configuratio
+00018420: 6e2e 4a6f 6243 6f6e 6669 6775 7261 7469  n.JobConfigurati
+00018430: 6f6e 5d28 2e2e 2f6a 6f62 5f63 6f6e 6669  on](../job_confi
+00018440: 6775 7261 7469 6f6e 290a 2020 2020 2020  guration).      
+00018450: 2020 2020 2020 2020 2020 2020 746f 2063              to c
+00018460: 6f6e 6669 6775 7265 2074 6865 2048 6f70  onfigure the Hop
+00018470: 7377 6f72 6b73 204a 6f62 2075 7365 6420  sworks Job used 
+00018480: 746f 2077 7269 7465 2064 6174 6120 696e  to write data in
+00018490: 746f 2074 6865 0a20 2020 2020 2020 2020  to the.         
+000184a0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+000184b0: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
+000184c0: 2020 2020 2020 2020 2a20 6b65 7920 6077          * key `w
+000184d0: 6169 745f 666f 725f 6a6f 6260 2061 6e64  ait_for_job` and
+000184e0: 2076 616c 7565 2060 5472 7565 6020 6f72   value `True` or
+000184f0: 2060 4661 6c73 6560 2074 6f20 636f 6e66   `False` to conf
+00018500: 6967 7572 650a 2020 2020 2020 2020 2020  igure.          
+00018510: 2020 2020 2020 2020 7768 6574 6865 7220          whether 
+00018520: 6f72 206e 6f74 2074 6f20 7468 6520 696e  or not to the in
+00018530: 7365 7274 2063 616c 6c20 7368 6f75 6c64  sert call should
+00018540: 2072 6574 7572 6e20 6f6e 6c79 0a20 2020   return only.   
+00018550: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018560: 6674 6572 2074 6865 2048 6f70 7377 6f72  fter the Hopswor
+00018570: 6b73 204a 6f62 2068 6173 2066 696e 6973  ks Job has finis
+00018580: 6865 642e 2042 7920 6465 6661 756c 7420  hed. By default 
+00018590: 6974 2077 6169 7473 2e0a 2020 2020 2020  it waits..      
+000185a0: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
+000185b0: 6073 7461 7274 5f6f 6666 6c69 6e65 5f62  `start_offline_b
+000185c0: 6163 6b66 696c 6c60 2061 6e64 2076 616c  ackfill` and val
+000185d0: 7565 2060 5472 7565 6020 6f72 2060 4661  ue `True` or `Fa
+000185e0: 6c73 6560 2074 6f20 636f 6e66 6967 7572  lse` to configur
+000185f0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00018600: 2020 2020 7768 6574 6865 7220 6f72 206e      whether or n
+00018610: 6f74 2074 6f20 7374 6172 7420 7468 6520  ot to start the 
+00018620: 6d61 7465 7269 616c 697a 6174 696f 6e20  materialization 
+00018630: 6a6f 6220 746f 2077 7269 7465 2064 6174  job to write dat
+00018640: 6120 746f 2074 6865 206f 6666 6c69 6e65  a to the offline
+00018650: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018660: 2020 2073 746f 7261 6765 2e20 6073 7461     storage. `sta
+00018670: 7274 5f6f 6666 6c69 6e65 5f62 6163 6b66  rt_offline_backf
+00018680: 696c 6c60 2069 7320 6465 7072 6563 6174  ill` is deprecat
+00018690: 6564 2e20 5573 6520 6073 7461 7274 5f6f  ed. Use `start_o
+000186a0: 6666 6c69 6e65 5f6d 6174 6572 6961 6c69  ffline_materiali
+000186b0: 7a61 7469 6f6e 6020 696e 7374 6561 642e  zation` instead.
+000186c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000186d0: 202a 206b 6579 2060 7374 6172 745f 6f66   * key `start_of
+000186e0: 666c 696e 655f 6d61 7465 7269 616c 697a  fline_materializ
+000186f0: 6174 696f 6e60 2061 6e64 2076 616c 7565  ation` and value
+00018700: 2060 5472 7565 6020 6f72 2060 4661 6c73   `True` or `Fals
+00018710: 6560 2074 6f20 636f 6e66 6967 7572 650a  e` to configure.
+00018720: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018730: 2020 7768 6574 6865 7220 6f72 206e 6f74    whether or not
+00018740: 2074 6f20 7374 6172 7420 7468 6520 6d61   to start the ma
+00018750: 7465 7269 616c 697a 6174 696f 6e20 6a6f  terialization jo
+00018760: 6220 746f 2077 7269 7465 2064 6174 6120  b to write data 
+00018770: 746f 2074 6865 206f 6666 6c69 6e65 0a20  to the offline. 
+00018780: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018790: 2073 746f 7261 6765 2e20 4279 2064 6566   storage. By def
+000187a0: 6175 6c74 2074 6865 206d 6174 6572 6961  ault the materia
+000187b0: 6c69 7a61 7469 6f6e 206a 6f62 2067 6574  lization job get
+000187c0: 7320 7374 6172 7465 6420 696d 6d65 6469  s started immedi
+000187d0: 6174 656c 792e 0a20 2020 2020 2020 2020  ately..         
+000187e0: 2020 2020 2020 202a 206b 6579 2060 6b61         * key `ka
+000187f0: 666b 615f 7072 6f64 7563 6572 5f63 6f6e  fka_producer_con
+00018800: 6669 6760 2061 6e64 2076 616c 7565 2061  fig` and value a
+00018810: 6e20 6f62 6a65 6374 206f 6620 7479 7065  n object of type
+00018820: 205b 7072 6f70 6572 7469 6573 5d28 6874   [properties](ht
+00018830: 7470 733a 2f2f 646f 6373 2e63 6f6e 666c  tps://docs.confl
+00018840: 7565 6e74 2e69 6f2f 706c 6174 666f 726d  uent.io/platform
+00018850: 2f63 7572 7265 6e74 2f63 6c69 656e 7473  /current/clients
+00018860: 2f6c 6962 7264 6b61 666b 612f 6874 6d6c  /librdkafka/html
+00018870: 2f6d 645f 434f 4e46 4947 5552 4154 494f  /md_CONFIGURATIO
+00018880: 4e2e 6874 6d6c 6e29 0a20 2020 2020 2020  N.htmln).       
+00018890: 2020 2020 2020 2020 2020 2075 7365 6420             used 
+000188a0: 746f 2063 6f6e 6669 6775 7265 2074 6865  to configure the
+000188b0: 204b 6166 6b61 2063 6c69 656e 742e 2054   Kafka client. T
+000188c0: 6f20 6f70 7469 6d69 7a65 2066 6f72 2074  o optimize for t
+000188d0: 6872 6f75 6768 7075 7420 696e 2068 6967  hroughput in hig
+000188e0: 6820 6c61 7465 6e63 7920 636f 6e6e 6563  h latency connec
+000188f0: 7469 6f6e 2063 6f6e 7369 6465 720a 2020  tion consider.  
+00018900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018910: 6368 616e 6769 6e67 205b 7072 6f64 7563  changing [produc
+00018920: 6572 2070 726f 7065 7274 6965 735d 2868  er properties](h
+00018930: 7474 7073 3a2f 2f64 6f63 732e 636f 6e66  ttps://docs.conf
+00018940: 6c75 656e 742e 696f 2f63 6c6f 7564 2f63  luent.io/cloud/c
+00018950: 7572 7265 6e74 2f63 6c69 656e 742d 6170  urrent/client-ap
+00018960: 7073 2f6f 7074 696d 697a 696e 672f 7468  ps/optimizing/th
+00018970: 726f 7567 6870 7574 2e68 746d 6c23 7072  roughput.html#pr
+00018980: 6f64 7563 6572 292e 0a20 2020 2020 2020  oducer)..       
+00018990: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
+000189a0: 696e 7465 726e 616c 5f6b 6166 6b61 6020  internal_kafka` 
+000189b0: 616e 6420 7661 6c75 6520 6054 7275 6560  and value `True`
+000189c0: 206f 7220 6046 616c 7365 6020 696e 2063   or `False` in c
+000189d0: 6173 6520 796f 7520 6573 7461 626c 6973  ase you establis
+000189e0: 6865 640a 2020 2020 2020 2020 2020 2020  hed.            
+000189f0: 2020 2020 2020 636f 6e6e 6563 7469 7669        connectivi
+00018a00: 7479 2066 726f 6d20 796f 7520 5079 7468  ty from you Pyth
+00018a10: 6f6e 2065 6e76 6972 6f6e 6d65 6e74 2074  on environment t
+00018a20: 6f20 7468 6520 696e 7465 726e 616c 2061  o the internal a
+00018a30: 6476 6572 7469 7365 640a 2020 2020 2020  dvertised.      
+00018a40: 2020 2020 2020 2020 2020 2020 6c69 7374              list
+00018a50: 656e 6572 7320 6f66 2074 6865 2048 6f70  eners of the Hop
+00018a60: 7377 6f72 6b73 204b 6166 6b61 2043 6c75  sworks Kafka Clu
+00018a70: 7374 6572 2e20 4465 6661 756c 7473 2074  ster. Defaults t
+00018a80: 6f20 6046 616c 7365 6020 616e 640a 2020  o `False` and.  
+00018a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018aa0: 7769 6c6c 2075 7365 2065 7874 6572 6e61  will use externa
+00018ab0: 6c20 6c69 7374 656e 6572 7320 7768 656e  l listeners when
+00018ac0: 2063 6f6e 6e65 6374 696e 6720 6672 6f6d   connecting from
+00018ad0: 206f 7574 7369 6465 206f 6620 486f 7073   outside of Hops
+00018ae0: 776f 726b 732e 0a20 2020 2020 2020 2020  works..         
+00018af0: 2020 2076 616c 6964 6174 696f 6e5f 6f70     validation_op
+00018b00: 7469 6f6e 733a 2041 6464 6974 696f 6e61  tions: Additiona
+00018b10: 6c20 7661 6c69 6461 7469 6f6e 206f 7074  l validation opt
+00018b20: 696f 6e73 2061 7320 6b65 792d 7661 6c75  ions as key-valu
+00018b30: 6520 7061 6972 732c 2064 6566 6175 6c74  e pairs, default
+00018b40: 7320 746f 2060 7b7d 602e 0a20 2020 2020  s to `{}`..     
+00018b50: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+00018b60: 2060 7275 6e5f 7661 6c69 6461 7469 6f6e   `run_validation
+00018b70: 6020 626f 6f6c 6561 6e20 7661 6c75 652c  ` boolean value,
+00018b80: 2073 6574 2074 6f20 6046 616c 7365 6020   set to `False` 
+00018b90: 746f 2073 6b69 7020 7661 6c69 6461 7469  to skip validati
+00018ba0: 6f6e 2074 656d 706f 7261 7269 6c79 206f  on temporarily o
+00018bb0: 6e20 696e 6765 7374 696f 6e2e 0a20 2020  n ingestion..   
+00018bc0: 2020 2020 2020 2020 2020 2020 202a 206b               * k
+00018bd0: 6579 2060 7361 7665 5f72 6570 6f72 7460  ey `save_report`
+00018be0: 2062 6f6f 6c65 616e 2076 616c 7565 2c20   boolean value, 
+00018bf0: 7365 7420 746f 2060 4661 6c73 6560 2074  set to `False` t
+00018c00: 6f20 736b 6970 2075 706c 6f61 6420 6f66  o skip upload of
+00018c10: 2074 6865 2076 616c 6964 6174 696f 6e20   the validation 
+00018c20: 7265 706f 7274 2074 6f20 486f 7073 776f  report to Hopswo
+00018c30: 726b 732e 0a20 2020 2020 2020 2020 2020  rks..           
+00018c40: 2020 2020 202a 206b 6579 2060 6765 5f76       * key `ge_v
+00018c50: 616c 6964 6174 655f 6b77 6172 6773 6020  alidate_kwargs` 
+00018c60: 6120 6469 6374 696f 6e61 7279 2063 6f6e  a dictionary con
+00018c70: 7461 696e 696e 6720 6b77 6172 6773 2066  taining kwargs f
+00018c80: 6f72 2074 6865 2076 616c 6964 6174 6520  or the validate 
+00018c90: 6d65 7468 6f64 206f 6620 4772 6561 7420  method of Great 
+00018ca0: 4578 7065 6374 6174 696f 6e73 2e0a 2020  Expectations..  
+00018cb0: 2020 2020 2020 2020 2020 2020 2020 2a20                * 
+00018cc0: 6b65 7920 6066 6574 6368 5f65 7870 6563  key `fetch_expec
+00018cd0: 7461 7469 6f6e 5f73 7569 7465 6020 6120  tation_suite` a 
+00018ce0: 626f 6f6c 6561 6e20 7661 6c75 652c 2062  boolean value, b
+00018cf0: 7920 6465 6661 756c 7420 6054 7275 6560  y default `True`
+00018d00: 2c20 746f 2063 6f6e 7472 6f6c 2077 6865  , to control whe
+00018d10: 7468 6572 2074 6865 2065 7870 6563 7461  ther the expecta
+00018d20: 7469 6f6e 0a20 2020 2020 2020 2020 2020  tion.           
+00018d30: 2020 2020 2020 2020 7375 6974 6520 6f66          suite of
+00018d40: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00018d50: 7570 2073 686f 756c 6420 6265 2066 6574  up should be fet
+00018d60: 6368 6564 2062 6566 6f72 6520 6576 6572  ched before ever
+00018d70: 7920 696e 7365 7274 2e0a 2020 2020 2020  y insert..      
+00018d80: 2020 2020 2020 7361 7665 5f63 6f64 653a        save_code:
+00018d90: 2057 6865 6e20 7275 6e6e 696e 6720 4853   When running HS
+00018da0: 4653 206f 6e20 486f 7073 776f 726b 7320  FS on Hopsworks 
+00018db0: 6f72 2044 6174 6162 7269 636b 732c 2048  or Databricks, H
+00018dc0: 5346 5320 6361 6e20 7361 7665 2074 6865  SFS can save the
+00018dd0: 2063 6f64 652f 6e6f 7465 626f 6f6b 2075   code/notebook u
+00018de0: 7365 6420 746f 2063 7265 6174 650a 2020  sed to create.  
+00018df0: 2020 2020 2020 2020 2020 2020 2020 7468                th
+00018e00: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
+00018e10: 6f72 2075 7365 6420 746f 2069 6e73 6572  or used to inser
+00018e20: 7420 6461 7461 2074 6f20 6974 2e20 5768  t data to it. Wh
+00018e30: 656e 2063 616c 6c69 6e67 2074 6865 2060  en calling the `
+00018e40: 696e 7365 7274 6020 6d65 7468 6f64 2072  insert` method r
+00018e50: 6570 6561 7465 646c 790a 2020 2020 2020  epeatedly.      
+00018e60: 2020 2020 2020 2020 2020 7769 7468 2073            with s
+00018e70: 6d61 6c6c 2062 6174 6368 6573 206f 6620  mall batches of 
+00018e80: 6461 7461 2c20 7468 6973 2063 616e 2073  data, this can s
+00018e90: 6c6f 7720 646f 776e 2074 6865 2077 7269  low down the wri
+00018ea0: 7465 732e 2055 7365 2074 6869 7320 6f70  tes. Use this op
+00018eb0: 7469 6f6e 2074 6f20 7475 726e 206f 6666  tion to turn off
+00018ec0: 2073 6176 696e 670a 2020 2020 2020 2020   saving.        
+00018ed0: 2020 2020 2020 2020 636f 6465 2e20 4465          code. De
+00018ee0: 6661 756c 7473 2074 6f20 6054 7275 6560  faults to `True`
+00018ef0: 2e0a 2020 2020 2020 2020 2020 2020 7761  ..            wa
+00018f00: 6974 3a20 5761 6974 2066 6f72 206a 6f62  it: Wait for job
+00018f10: 2074 6f20 6669 6e69 7368 2062 6566 6f72   to finish befor
+00018f20: 6520 7265 7475 726e 696e 672c 2064 6566  e returning, def
+00018f30: 6175 6c74 7320 746f 2060 4661 6c73 6560  aults to `False`
+00018f40: 2e0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00018f50: 2020 5368 6f72 7463 7574 2066 6f72 2072    Shortcut for r
+00018f60: 6561 645f 6f70 7469 6f6e 7320 607b 2277  ead_options `{"w
+00018f70: 6169 745f 666f 725f 6a6f 6222 3a20 4661  ait_for_job": Fa
+00018f80: 6c73 657d 602e 0a0a 2020 2020 2020 2020  lse}`...        
+00018f90: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
+00018fa0: 2020 2020 2020 2860 4a6f 6260 2c20 6056        (`Job`, `V
+00018fb0: 616c 6964 6174 696f 6e52 6570 6f72 7460  alidationReport`
+00018fc0: 2920 4120 7475 706c 6520 7769 7468 206a  ) A tuple with j
+00018fd0: 6f62 2069 6e66 6f72 6d61 7469 6f6e 2069  ob information i
+00018fe0: 6620 7079 7468 6f6e 2065 6e67 696e 6520  f python engine 
+00018ff0: 6973 2075 7365 6420 616e 6420 7468 6520  is used and the 
+00019000: 7661 6c69 6461 7469 6f6e 2072 6570 6f72  validation repor
+00019010: 7420 6966 2076 616c 6964 6174 696f 6e20  t if validation 
+00019020: 6973 2065 6e61 626c 6564 2e0a 0a20 2020  is enabled...   
+00019030: 2020 2020 2023 2052 6169 7365 730a 2020       # Raises.  
+00019040: 2020 2020 2020 2020 2020 6068 7366 732e            `hsfs.
+00019050: 636c 6965 6e74 2e65 7863 6570 7469 6f6e  client.exception
+00019060: 732e 5265 7374 4150 4945 7272 6f72 602e  s.RestAPIError`.
+00019070: 2065 2e67 2066 6169 6c20 746f 2063 7265   e.g fail to cre
+00019080: 6174 6520 6665 6174 7572 6520 6772 6f75  ate feature grou
+00019090: 702c 2064 6174 6166 7261 6d65 2073 6368  p, dataframe sch
+000190a0: 656d 6120 646f 6573 206e 6f74 206d 6174  ema does not mat
+000190b0: 6368 0a20 2020 2020 2020 2020 2020 2020  ch.             
+000190c0: 2020 2065 7869 7374 696e 6720 6665 6174     existing feat
+000190d0: 7572 6520 6772 6f75 7020 7363 6865 6d61  ure group schema
+000190e0: 2c20 6574 632e 0a20 2020 2020 2020 2020  , etc..         
+000190f0: 2020 2060 6873 6673 2e63 6c69 656e 742e     `hsfs.client.
+00019100: 6578 6365 7074 696f 6e73 2e44 6174 6156  exceptions.DataV
+00019110: 616c 6964 6174 696f 6e45 7863 6570 7469  alidationExcepti
+00019120: 6f6e 602e 2049 6620 6461 7461 2076 616c  on`. If data val
+00019130: 6964 6174 696f 6e20 6661 696c 7320 616e  idation fails an
+00019140: 6420 7468 6520 6578 7065 6374 6174 696f  d the expectatio
+00019150: 6e0a 2020 2020 2020 2020 2020 2020 2020  n.              
+00019160: 2020 7375 6974 6520 6076 616c 6964 6174    suite `validat
+00019170: 696f 6e5f 696e 6765 7374 696f 6e5f 706f  ion_ingestion_po
+00019180: 6c69 6379 6020 6973 2073 6574 2074 6f20  licy` is set to 
+00019190: 6053 5452 4943 5460 2e20 4461 7461 2069  `STRICT`. Data i
+000191a0: 7320 4e4f 5420 696e 6765 7374 6564 2e0a  s NOT ingested..
+000191b0: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+000191c0: 2020 2020 6966 2073 746f 7261 6765 2061      if storage a
+000191d0: 6e64 2073 656c 662e 7374 7265 616d 3a0a  nd self.stream:.
+000191e0: 2020 2020 2020 2020 2020 2020 7761 726e              warn
+000191f0: 696e 6773 2e77 6172 6e28 0a20 2020 2020  ings.warn(.     
+00019200: 2020 2020 2020 2020 2020 2022 5370 6563             "Spec
+00019210: 6966 7969 6e67 2074 6865 2073 746f 7261  ifying the stora
+00019220: 6765 206f 7074 696f 6e20 6973 206e 6f74  ge option is not
+00019230: 2073 7570 706f 7274 6564 2069 6620 7468   supported if th
+00019240: 6520 7374 7265 616d 696e 6720 4150 4973  e streaming APIs
+00019250: 2061 7265 2065 6e61 626c 6564 220a 2020   are enabled".  
+00019260: 2020 2020 2020 2020 2020 290a 0a20 2020            )..   
+00019270: 2020 2020 2066 6561 7475 7265 5f64 6174       feature_dat
+00019280: 6166 7261 6d65 203d 2065 6e67 696e 652e  aframe = engine.
+00019290: 6765 745f 696e 7374 616e 6365 2829 2e63  get_instance().c
+000192a0: 6f6e 7665 7274 5f74 6f5f 6465 6661 756c  onvert_to_defaul
+000192b0: 745f 6461 7461 6672 616d 6528 6665 6174  t_dataframe(feat
+000192c0: 7572 6573 290a 0a20 2020 2020 2020 2069  ures)..        i
+000192d0: 6620 7772 6974 655f 6f70 7469 6f6e 7320  f write_options 
+000192e0: 6973 204e 6f6e 653a 0a20 2020 2020 2020  is None:.       
+000192f0: 2020 2020 2077 7269 7465 5f6f 7074 696f       write_optio
+00019300: 6e73 203d 207b 7d0a 2020 2020 2020 2020  ns = {}.        
+00019310: 6966 2022 7761 6974 5f66 6f72 5f6a 6f62  if "wait_for_job
+00019320: 2220 6e6f 7420 696e 2077 7269 7465 5f6f  " not in write_o
+00019330: 7074 696f 6e73 3a0a 2020 2020 2020 2020  ptions:.        
+00019340: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
+00019350: 735b 2277 6169 745f 666f 725f 6a6f 6222  s["wait_for_job"
+00019360: 5d20 3d20 7761 6974 0a0a 2020 2020 2020  ] = wait..      
+00019370: 2020 6a6f 622c 2067 655f 7265 706f 7274    job, ge_report
+00019380: 203d 2073 656c 662e 5f66 6561 7475 7265   = self._feature
+00019390: 5f67 726f 7570 5f65 6e67 696e 652e 696e  _group_engine.in
+000193a0: 7365 7274 280a 2020 2020 2020 2020 2020  sert(.          
+000193b0: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+000193c0: 2020 2020 6665 6174 7572 655f 6461 7461      feature_data
+000193d0: 6672 616d 653d 6665 6174 7572 655f 6461  frame=feature_da
+000193e0: 7461 6672 616d 652c 0a20 2020 2020 2020  taframe,.       
+000193f0: 2020 2020 206f 7665 7277 7269 7465 3d6f       overwrite=o
+00019400: 7665 7277 7269 7465 2c0a 2020 2020 2020  verwrite,.      
+00019410: 2020 2020 2020 6f70 6572 6174 696f 6e3d        operation=
+00019420: 6f70 6572 6174 696f 6e2c 0a20 2020 2020  operation,.     
+00019430: 2020 2020 2020 2073 746f 7261 6765 3d73         storage=s
+00019440: 746f 7261 6765 2e6c 6f77 6572 2829 2069  torage.lower() i
+00019450: 6620 7374 6f72 6167 6520 6973 206e 6f74  f storage is not
+00019460: 204e 6f6e 6520 656c 7365 204e 6f6e 652c   None else None,
+00019470: 0a20 2020 2020 2020 2020 2020 2077 7269  .            wri
+00019480: 7465 5f6f 7074 696f 6e73 3d77 7269 7465  te_options=write
+00019490: 5f6f 7074 696f 6e73 2c0a 2020 2020 2020  _options,.      
+000194a0: 2020 2020 2020 7661 6c69 6461 7469 6f6e        validation
+000194b0: 5f6f 7074 696f 6e73 3d7b 2273 6176 655f  _options={"save_
+000194c0: 7265 706f 7274 223a 2054 7275 652c 202a  report": True, *
+000194d0: 2a76 616c 6964 6174 696f 6e5f 6f70 7469  *validation_opti
+000194e0: 6f6e 737d 2c0a 2020 2020 2020 2020 290a  ons},.        ).
+000194f0: 2020 2020 2020 2020 6966 2073 6176 655f          if save_
+00019500: 636f 6465 2061 6e64 2028 0a20 2020 2020  code and (.     
+00019510: 2020 2020 2020 2067 655f 7265 706f 7274         ge_report
+00019520: 2069 7320 4e6f 6e65 206f 7220 6765 5f72   is None or ge_r
+00019530: 6570 6f72 742e 696e 6765 7374 696f 6e5f  eport.ingestion_
+00019540: 7265 7375 6c74 203d 3d20 2249 4e47 4553  result == "INGES
+00019550: 5445 4422 0a20 2020 2020 2020 2029 3a0a  TED".        ):.
+00019560: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00019570: 2e5f 636f 6465 5f65 6e67 696e 652e 7361  ._code_engine.sa
+00019580: 7665 5f63 6f64 6528 7365 6c66 290a 0a20  ve_code(self).. 
+00019590: 2020 2020 2020 2069 6620 656e 6769 6e65         if engine
+000195a0: 2e67 6574 5f74 7970 6528 292e 7374 6172  .get_type().star
+000195b0: 7473 7769 7468 2822 7370 6172 6b22 2920  tswith("spark") 
+000195c0: 616e 6420 6e6f 7420 7365 6c66 2e73 7472  and not self.str
+000195d0: 6561 6d3a 0a20 2020 2020 2020 2020 2020  eam:.           
+000195e0: 2023 2041 6c73 6f2c 206f 6e6c 7920 636f   # Also, only co
+000195f0: 6d70 7574 6520 7374 6174 6973 7469 6373  mpute statistics
+00019600: 2069 6620 7374 7265 616d 2069 7320 4661   if stream is Fa
+00019610: 6c73 652e 0a20 2020 2020 2020 2020 2020  lse..           
+00019620: 2023 2069 6620 5472 7565 2c20 7468 6520   # if True, the 
+00019630: 6261 636b 6669 6c6c 206a 6f62 2068 6173  backfill job has
+00019640: 206e 6f74 2062 6565 6e20 7472 6967 6765   not been trigge
+00019650: 7265 6420 616e 6420 7468 6520 6461 7461  red and the data
+00019660: 2068 6173 206e 6f74 2062 6565 6e20 696e   has not been in
+00019670: 7365 7274 6564 2028 6974 2773 2069 6e20  serted (it's in 
+00019680: 4b61 666b 6129 0a20 2020 2020 2020 2020  Kafka).         
+00019690: 2020 2073 656c 662e 636f 6d70 7574 655f     self.compute_
+000196a0: 7374 6174 6973 7469 6373 2829 0a0a 2020  statistics()..  
+000196b0: 2020 2020 2020 7265 7475 726e 2028 0a20        return (. 
+000196c0: 2020 2020 2020 2020 2020 206a 6f62 2c0a             job,.
+000196d0: 2020 2020 2020 2020 2020 2020 6765 5f72              ge_r
+000196e0: 6570 6f72 742e 746f 5f67 655f 7479 7065  eport.to_ge_type
+000196f0: 2829 2069 6620 6765 5f72 6570 6f72 7420  () if ge_report 
+00019700: 6973 206e 6f74 204e 6f6e 6520 656c 7365  is not None else
+00019710: 204e 6f6e 652c 0a20 2020 2020 2020 2029   None,.        )
+00019720: 0a0a 2020 2020 6465 6620 6d75 6c74 695f  ..    def multi_
+00019730: 7061 7274 5f69 6e73 6572 7428 0a20 2020  part_insert(.   
+00019740: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+00019750: 2020 2066 6561 7475 7265 733a 2055 6e69     features: Uni
+00019760: 6f6e 5b0a 2020 2020 2020 2020 2020 2020  on[.            
+00019770: 7064 2e44 6174 6146 7261 6d65 2c0a 2020  pd.DataFrame,.  
+00019780: 2020 2020 2020 2020 2020 5479 7065 5661            TypeVa
+00019790: 7228 2270 7973 7061 726b 2e73 716c 2e44  r("pyspark.sql.D
+000197a0: 6174 6146 7261 6d65 2229 2c20 2023 206e  ataFrame"),  # n
+000197b0: 6f71 613a 2046 3832 310a 2020 2020 2020  oqa: F821.      
+000197c0: 2020 2020 2020 5479 7065 5661 7228 2270        TypeVar("p
+000197d0: 7973 7061 726b 2e52 4444 2229 2c20 2023  yspark.RDD"),  #
+000197e0: 206e 6f71 613a 2046 3832 310a 2020 2020   noqa: F821.    
+000197f0: 2020 2020 2020 2020 6e70 2e6e 6461 7272          np.ndarr
+00019800: 6179 2c0a 2020 2020 2020 2020 2020 2020  ay,.            
+00019810: 4c69 7374 5b6c 6973 745d 2c0a 2020 2020  List[list],.    
+00019820: 2020 2020 5d20 3d20 4e6f 6e65 2c0a 2020      ] = None,.  
+00019830: 2020 2020 2020 6f76 6572 7772 6974 653a        overwrite:
+00019840: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+00019850: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+00019860: 206f 7065 7261 7469 6f6e 3a20 4f70 7469   operation: Opti
+00019870: 6f6e 616c 5b73 7472 5d20 3d20 2275 7073  onal[str] = "ups
+00019880: 6572 7422 2c0a 2020 2020 2020 2020 7374  ert",.        st
+00019890: 6f72 6167 653a 204f 7074 696f 6e61 6c5b  orage: Optional[
+000198a0: 7374 725d 203d 204e 6f6e 652c 0a20 2020  str] = None,.   
+000198b0: 2020 2020 2077 7269 7465 5f6f 7074 696f       write_optio
+000198c0: 6e73 3a20 4f70 7469 6f6e 616c 5b44 6963  ns: Optional[Dic
+000198d0: 745b 7374 722c 2041 6e79 5d5d 203d 207b  t[str, Any]] = {
+000198e0: 7d2c 0a20 2020 2020 2020 2076 616c 6964  },.        valid
+000198f0: 6174 696f 6e5f 6f70 7469 6f6e 733a 204f  ation_options: O
+00019900: 7074 696f 6e61 6c5b 4469 6374 5b73 7472  ptional[Dict[str
+00019910: 2c20 416e 795d 5d20 3d20 7b7d 2c0a 2020  , Any]] = {},.  
+00019920: 2020 2920 2d3e 2055 6e69 6f6e 5b0a 2020    ) -> Union[.  
+00019930: 2020 2020 2020 5475 706c 655b 4f70 7469        Tuple[Opti
+00019940: 6f6e 616c 5b4a 6f62 5d2c 204f 7074 696f  onal[Job], Optio
+00019950: 6e61 6c5b 5661 6c69 6461 7469 6f6e 5265  nal[ValidationRe
+00019960: 706f 7274 5d5d 2c0a 2020 2020 2020 2020  port]],.        
+00019970: 6665 6174 7572 655f 6772 6f75 705f 7772  feature_group_wr
+00019980: 6974 6572 2e46 6561 7475 7265 4772 6f75  iter.FeatureGrou
+00019990: 7057 7269 7465 722c 0a20 2020 205d 3a0a  pWriter,.    ]:.
+000199a0: 2020 2020 2020 2020 2222 2247 6574 2046          """Get F
+000199b0: 6561 7475 7265 4772 6f75 7057 7269 7465  eatureGroupWrite
+000199c0: 7220 666f 7220 6f70 7469 6d69 7a65 6420  r for optimized 
+000199d0: 6d75 6c74 6920 7061 7274 2069 6e73 6572  multi part inser
+000199e0: 7473 206f 7220 6361 6c6c 2074 6869 7320  ts or call this 
+000199f0: 6d65 7468 6f64 0a20 2020 2020 2020 2074  method.        t
+00019a00: 6f20 7374 6172 7420 6d61 6e75 616c 206d  o start manual m
+00019a10: 756c 7469 2070 6172 7420 6f70 7469 6d69  ulti part optimi
+00019a20: 7a65 6420 696e 7365 7274 732e 0a0a 2020  zed inserts...  
+00019a30: 2020 2020 2020 496e 2075 7365 2063 6173        In use cas
+00019a40: 6573 2077 6865 7265 2076 6572 7920 736d  es where very sm
+00019a50: 616c 6c20 6261 7463 6865 7320 2831 2074  all batches (1 t
+00019a60: 6f20 3130 3030 2920 726f 7773 2070 6572  o 1000) rows per
+00019a70: 2044 6174 6166 7261 6d65 206e 6565 640a   Dataframe need.
+00019a80: 2020 2020 2020 2020 746f 2062 6520 7772          to be wr
+00019a90: 6974 7465 6e20 746f 2074 6865 2066 6561  itten to the fea
+00019aa0: 7475 7265 2073 746f 7265 2072 6570 6561  ture store repea
+00019ab0: 7465 646c 792c 2069 7420 6d69 6768 7420  tedly, it might 
+00019ac0: 6265 2069 6e65 6666 6963 6965 6e74 2074  be inefficient t
+00019ad0: 6f20 7573 650a 2020 2020 2020 2020 7468  o use.        th
+00019ae0: 6520 7374 616e 6461 7264 2060 6665 6174  e standard `feat
+00019af0: 7572 655f 6772 6f75 702e 696e 7365 7274  ure_group.insert
+00019b00: 2829 6020 6d65 7468 6f64 2061 7320 6974  ()` method as it
+00019b10: 2070 6572 666f 726d 7320 736f 6d65 2062   performs some b
+00019b20: 6163 6b67 726f 756e 640a 2020 2020 2020  ackground.      
+00019b30: 2020 6163 7469 6f6e 7320 746f 2075 7064    actions to upd
+00019b40: 6174 6520 7468 6520 6d65 7461 6461 7461  ate the metadata
+00019b50: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+00019b60: 6772 6f75 7020 6f62 6a65 6374 2066 6972  group object fir
+00019b70: 7374 2e0a 0a20 2020 2020 2020 2046 6f72  st...        For
+00019b80: 2074 6865 7365 2063 6173 6573 2c20 7468   these cases, th
+00019b90: 6520 6665 6174 7572 6520 6772 6f75 7020  e feature group 
+00019ba0: 7072 6f76 6964 6573 2074 6865 2060 6d75  provides the `mu
+00019bb0: 6c74 695f 7061 7274 5f69 6e73 6572 7460  lti_part_insert`
+00019bc0: 2041 5049 2c0a 2020 2020 2020 2020 7768   API,.        wh
+00019bd0: 6963 6820 6973 206f 7074 696d 697a 6564  ich is optimized
+00019be0: 2066 6f72 2077 7269 7469 6e67 206d 616e   for writing man
+00019bf0: 7920 736d 616c 6c20 4461 7461 6672 616d  y small Datafram
+00019c00: 6573 2061 6674 6572 2061 6e6f 7468 6572  es after another
+00019c10: 2e0a 0a20 2020 2020 2020 2054 6865 7265  ...        There
+00019c20: 2061 7265 2074 776f 2077 6179 7320 746f   are two ways to
+00019c30: 2075 7365 2074 6869 7320 4150 493a 0a20   use this API:. 
+00019c40: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+00019c50: 6c65 2022 5079 7468 6f6e 2043 6f6e 7465  le "Python Conte
+00019c60: 7874 204d 616e 6167 6572 220a 2020 2020  xt Manager".    
+00019c70: 2020 2020 2020 2020 5573 696e 6720 7468          Using th
+00019c80: 6520 5079 7468 6f6e 2060 7769 7468 6020  e Python `with` 
+00019c90: 7379 6e74 6178 2079 6f75 2063 616e 2061  syntax you can a
+00019ca0: 6371 7569 7265 2061 2046 6561 7475 7265  cquire a Feature
+00019cb0: 4772 6f75 7057 7269 7465 720a 2020 2020  GroupWriter.    
+00019cc0: 2020 2020 2020 2020 6f62 6a65 6374 2074          object t
+00019cd0: 6861 7420 696d 706c 656d 656e 7473 2074  hat implements t
+00019ce0: 6865 2073 616d 6520 606d 756c 7469 5f70  he same `multi_p
+00019cf0: 6172 745f 696e 7365 7274 6020 4150 492e  art_insert` API.
+00019d00: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00019d10: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+00019d20: 2020 2066 6561 7475 7265 5f67 726f 7570     feature_group
+00019d30: 203d 2066 732e 6765 745f 6f72 5f63 7265   = fs.get_or_cre
+00019d40: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
+00019d50: 7028 2266 675f 6e61 6d65 222c 2076 6572  p("fg_name", ver
+00019d60: 7369 6f6e 3d31 290a 0a20 2020 2020 2020  sion=1)..       
+00019d70: 2020 2020 2077 6974 6820 6665 6174 7572       with featur
+00019d80: 655f 6772 6f75 702e 6d75 6c74 695f 7061  e_group.multi_pa
+00019d90: 7274 5f69 6e73 6572 7428 2920 6173 2077  rt_insert() as w
+00019da0: 7269 7465 723a 0a20 2020 2020 2020 2020  riter:.         
+00019db0: 2020 2020 2020 2023 2072 756e 2069 6e73         # run ins
+00019dc0: 6572 7473 2069 6e20 6120 6c6f 6f70 3a0a  erts in a loop:.
+00019dd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019de0: 7768 696c 6520 6c6f 6f70 3a0a 2020 2020  while loop:.    
+00019df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019e00: 736d 616c 6c5f 6261 7463 685f 6466 203d  small_batch_df =
+00019e10: 202e 2e2e 0a20 2020 2020 2020 2020 2020   ....           
+00019e20: 2020 2020 2020 2020 2077 7269 7465 722e           writer.
+00019e30: 696e 7365 7274 2873 6d61 6c6c 5f62 6174  insert(small_bat
+00019e40: 6368 5f64 6629 0a20 2020 2020 2020 2020  ch_df).         
+00019e50: 2020 2060 6060 0a20 2020 2020 2020 2020     ```.         
+00019e60: 2020 2054 6865 2077 7269 7465 7220 6261     The writer ba
+00019e70: 7463 6865 7320 7468 6520 736d 616c 6c20  tches the small 
+00019e80: 4461 7461 6672 616d 6573 2061 6e64 2074  Dataframes and t
+00019e90: 7261 6e73 6d69 7473 2074 6865 6d20 746f  ransmits them to
+00019ea0: 2048 6f70 7377 6f72 6b73 0a20 2020 2020   Hopsworks.     
+00019eb0: 2020 2020 2020 2065 6666 6963 6965 6e74         efficient
+00019ec0: 6c79 2e0a 2020 2020 2020 2020 2020 2020  ly..            
+00019ed0: 5768 656e 2065 7869 7469 6e67 2074 6865  When exiting the
+00019ee0: 2063 6f6e 7465 7874 2c20 7468 6520 6665   context, the fe
+00019ef0: 6174 7572 6520 6772 6f75 7020 7772 6974  ature group writ
+00019f00: 6572 2069 7320 7375 7265 2074 6f20 6578  er is sure to ex
+00019f10: 6974 0a20 2020 2020 2020 2020 2020 206f  it.            o
+00019f20: 6e6c 7920 6f6e 6365 2061 6c6c 2074 6865  nly once all the
+00019f30: 2072 6f77 7320 6861 7665 2062 6565 6e20   rows have been 
+00019f40: 7472 616e 736d 6974 7465 642e 0a0a 2020  transmitted...  
+00019f50: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
+00019f60: 6520 224d 756c 7469 2070 6172 7420 696e  e "Multi part in
+00019f70: 7365 7274 2077 6974 6820 6d61 6e75 616c  sert with manual
+00019f80: 2063 6f6e 7465 7874 206d 616e 6167 656d   context managem
+00019f90: 656e 7422 0a20 2020 2020 2020 2020 2020  ent".           
+00019fa0: 2049 6e73 7465 6164 206f 6620 6c65 7474   Instead of lett
+00019fb0: 696e 6720 5079 7468 6f6e 2068 616e 646c  ing Python handl
+00019fc0: 6520 7468 6520 656e 7465 7269 6e67 2061  e the entering a
+00019fd0: 6e64 2065 7869 7469 6e67 206f 6620 7468  nd exiting of th
+00019fe0: 650a 2020 2020 2020 2020 2020 2020 6d75  e.            mu
+00019ff0: 6c74 6920 7061 7274 2069 6e73 6572 7420  lti part insert 
+0001a000: 636f 6e74 6578 742c 2079 6f75 2063 616e  context, you can
+0001a010: 2073 7461 7274 2061 6e64 2066 696e 616c   start and final
+0001a020: 697a 6520 7468 6520 636f 6e74 6578 740a  ize the context.
+0001a030: 2020 2020 2020 2020 2020 2020 6d61 6e75              manu
+0001a040: 616c 6c79 2e0a 2020 2020 2020 2020 2020  ally..          
+0001a050: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+0001a060: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+0001a070: 6772 6f75 7020 3d20 6673 2e67 6574 5f6f  group = fs.get_o
+0001a080: 725f 6372 6561 7465 5f66 6561 7475 7265  r_create_feature
+0001a090: 5f67 726f 7570 2822 6667 5f6e 616d 6522  _group("fg_name"
+0001a0a0: 2c20 7665 7273 696f 6e3d 3129 0a0a 2020  , version=1)..  
+0001a0b0: 2020 2020 2020 2020 2020 7768 696c 6520            while 
+0001a0c0: 6c6f 6f70 3a0a 2020 2020 2020 2020 2020  loop:.          
+0001a0d0: 2020 2020 2020 736d 616c 6c5f 6261 7463        small_batc
+0001a0e0: 685f 6466 203d 202e 2e2e 0a20 2020 2020  h_df = ....     
+0001a0f0: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+0001a100: 7265 5f67 726f 7570 2e6d 756c 7469 5f70  re_group.multi_p
+0001a110: 6172 745f 696e 7365 7274 2873 6d61 6c6c  art_insert(small
+0001a120: 5f62 6174 6368 5f64 6629 0a0a 2020 2020  _batch_df)..    
+0001a130: 2020 2020 2020 2020 2320 494d 504f 5254          # IMPORT
+0001a140: 414e 543a 2066 696e 616c 697a 6520 7468  ANT: finalize th
+0001a150: 6520 6d75 6c74 6920 7061 7274 2069 6e73  e multi part ins
+0001a160: 6572 7420 746f 206d 616b 6520 7375 7265  ert to make sure
+0001a170: 2061 6c6c 2072 6f77 730a 2020 2020 2020   all rows.      
+0001a180: 2020 2020 2020 2320 6861 7665 2062 6565        # have bee
+0001a190: 6e20 7472 616e 736d 6974 7465 640a 2020  n transmitted.  
+0001a1a0: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+0001a1b0: 655f 6772 6f75 702e 6669 6e61 6c69 7a65  e_group.finalize
+0001a1c0: 5f6d 756c 7469 5f70 6172 745f 696e 7365  _multi_part_inse
+0001a1d0: 7274 2829 0a20 2020 2020 2020 2020 2020  rt().           
+0001a1e0: 2060 6060 0a20 2020 2020 2020 2020 2020   ```.           
+0001a1f0: 204e 6f74 6520 7468 6174 2074 6865 2066   Note that the f
+0001a200: 6972 7374 2063 616c 6c20 746f 2060 6d75  irst call to `mu
+0001a210: 6c74 695f 7061 7274 5f69 6e73 6572 7460  lti_part_insert`
+0001a220: 2069 6e69 7469 6174 6573 2074 6865 2063   initiates the c
+0001a230: 6f6e 7465 7874 0a20 2020 2020 2020 2020  ontext.         
+0001a240: 2020 2061 6e64 2062 6520 7375 7265 2074     and be sure t
+0001a250: 6f20 6669 6e61 6c69 7a65 2069 742e 2054  o finalize it. T
+0001a260: 6865 2060 6669 6e61 6c69 7a65 5f6d 756c  he `finalize_mul
+0001a270: 7469 5f70 6172 745f 696e 7365 7274 6020  ti_part_insert` 
+0001a280: 6973 2061 0a20 2020 2020 2020 2020 2020  is a.           
+0001a290: 2062 6c6f 636b 696e 6720 6361 6c6c 2074   blocking call t
+0001a2a0: 6861 7420 7265 7475 726e 7320 6f6e 6365  hat returns once
+0001a2b0: 2061 6c6c 2072 6f77 7320 6861 7665 2062   all rows have b
+0001a2c0: 6565 6e20 7472 616e 736d 6974 7465 642e  een transmitted.
+0001a2d0: 0a0a 2020 2020 2020 2020 2020 2020 4f6e  ..            On
+0001a2e0: 6365 2079 6f75 2061 7265 2064 6f6e 6520  ce you are done 
+0001a2f0: 7769 7468 2074 6865 206d 756c 7469 2070  with the multi p
+0001a300: 6172 7420 696e 7365 7274 2c20 6974 2069  art insert, it i
+0001a310: 7320 676f 6f64 2070 7261 6374 6963 6520  s good practice 
+0001a320: 746f 0a20 2020 2020 2020 2020 2020 2073  to.            s
+0001a330: 7461 7274 2074 6865 206d 6174 6572 6961  tart the materia
+0001a340: 6c69 7a61 7469 6f6e 206a 6f62 2069 6e20  lization job in 
+0001a350: 6f72 6465 7220 746f 2077 7269 7465 2074  order to write t
+0001a360: 6865 2064 6174 6120 746f 2074 6865 206f  he data to the o
+0001a370: 6666 6c69 6e65 0a20 2020 2020 2020 2020  ffline.         
+0001a380: 2020 2073 746f 7261 6765 3a0a 2020 2020     storage:.    
+0001a390: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+0001a3a0: 6e0a 2020 2020 2020 2020 2020 2020 6665  n.            fe
+0001a3b0: 6174 7572 655f 6772 6f75 702e 6d61 7465  ature_group.mate
+0001a3c0: 7269 616c 697a 6174 696f 6e5f 6a6f 622e  rialization_job.
+0001a3d0: 7275 6e28 6177 6169 745f 7465 726d 696e  run(await_termin
+0001a3e0: 6174 696f 6e3d 5472 7565 290a 2020 2020  ation=True).    
+0001a3f0: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+0001a400: 2020 2020 2023 2041 7267 756d 656e 7473       # Arguments
+0001a410: 0a20 2020 2020 2020 2020 2020 2066 6561  .            fea
+0001a420: 7475 7265 733a 2044 6174 6146 7261 6d65  tures: DataFrame
+0001a430: 2c20 5244 442c 204e 6461 7272 6179 2c20  , RDD, Ndarray, 
+0001a440: 6c69 7374 2e20 4665 6174 7572 6573 2074  list. Features t
+0001a450: 6f20 6265 2073 6176 6564 2e0a 2020 2020  o be saved..    
+0001a460: 2020 2020 2020 2020 6f76 6572 7772 6974          overwrit
+0001a470: 653a 2044 726f 7020 616c 6c20 6461 7461  e: Drop all data
+0001a480: 2069 6e20 7468 6520 6665 6174 7572 6520   in the feature 
+0001a490: 6772 6f75 7020 6265 666f 7265 0a20 2020  group before.   
+0001a4a0: 2020 2020 2020 2020 2020 2020 2069 6e73               ins
+0001a4b0: 6572 7469 6e67 206e 6577 2064 6174 612e  erting new data.
+0001a4c0: 2054 6869 7320 646f 6573 206e 6f74 2061   This does not a
+0001a4d0: 6666 6563 7420 6d65 7461 6461 7461 2c20  ffect metadata, 
+0001a4e0: 6465 6661 756c 7473 2074 6f20 4661 6c73  defaults to Fals
+0001a4f0: 652e 0a20 2020 2020 2020 2020 2020 206f  e..            o
+0001a500: 7065 7261 7469 6f6e 3a20 4170 6163 6865  peration: Apache
+0001a510: 2048 7564 6920 6f70 6572 6174 696f 6e20   Hudi operation 
+0001a520: 7479 7065 2060 2269 6e73 6572 7422 6020  type `"insert"` 
+0001a530: 6f72 2060 2275 7073 6572 7422 602e 0a20  or `"upsert"`.. 
+0001a540: 2020 2020 2020 2020 2020 2020 2020 2044                 D
+0001a550: 6566 6175 6c74 7320 746f 2060 2275 7073  efaults to `"ups
+0001a560: 6572 7422 602e 0a20 2020 2020 2020 2020  ert"`..         
+0001a570: 2020 2073 746f 7261 6765 3a20 4f76 6572     storage: Over
+0001a580: 7772 6974 6520 6465 6661 756c 7420 6265  write default be
+0001a590: 6861 7669 6f75 722c 2077 7269 7465 2074  haviour, write t
+0001a5a0: 6f20 6f66 666c 696e 650a 2020 2020 2020  o offline.      
+0001a5b0: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
+0001a5c0: 6520 6f6e 6c79 2077 6974 6820 6022 6f66  e only with `"of
+0001a5d0: 666c 696e 6522 6020 6f72 206f 6e6c 696e  fline"` or onlin
+0001a5e0: 6520 6f6e 6c79 2077 6974 6820 6022 6f6e  e only with `"on
+0001a5f0: 6c69 6e65 2260 2c20 6465 6661 756c 7473  line"`, defaults
+0001a600: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a610: 2074 6f20 604e 6f6e 6560 2e0a 2020 2020   to `None`..    
+0001a620: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
+0001a630: 7469 6f6e 733a 2041 6464 6974 696f 6e61  tions: Additiona
+0001a640: 6c20 7772 6974 6520 6f70 7469 6f6e 7320  l write options 
+0001a650: 6173 206b 6579 2d76 616c 7565 2070 6169  as key-value pai
+0001a660: 7273 2c20 6465 6661 756c 7473 2074 6f20  rs, defaults to 
+0001a670: 607b 7d60 2e0a 2020 2020 2020 2020 2020  `{}`..          
+0001a680: 2020 2020 2020 5768 656e 2075 7369 6e67        When using
+0001a690: 2074 6865 2060 7079 7468 6f6e 6020 656e   the `python` en
+0001a6a0: 6769 6e65 2c20 7772 6974 655f 6f70 7469  gine, write_opti
+0001a6b0: 6f6e 7320 6361 6e20 636f 6e74 6169 6e20  ons can contain 
+0001a6c0: 7468 650a 2020 2020 2020 2020 2020 2020  the.            
+0001a6d0: 2020 2020 666f 6c6c 6f77 696e 6720 656e      following en
+0001a6e0: 7472 6965 733a 0a20 2020 2020 2020 2020  tries:.         
+0001a6f0: 2020 2020 2020 202a 206b 6579 2060 7370         * key `sp
+0001a700: 6172 6b60 2061 6e64 2076 616c 7565 2061  ark` and value a
+0001a710: 6e20 6f62 6a65 6374 206f 6620 7479 7065  n object of type
+0001a720: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001a730: 205b 6873 6673 2e63 6f72 652e 6a6f 625f   [hsfs.core.job_
+0001a740: 636f 6e66 6967 7572 6174 696f 6e2e 4a6f  configuration.Jo
+0001a750: 6243 6f6e 6669 6775 7261 7469 6f6e 5d28  bConfiguration](
+0001a760: 2e2e 2f6a 6f62 5f63 6f6e 6669 6775 7261  ../job_configura
+0001a770: 7469 6f6e 290a 2020 2020 2020 2020 2020  tion).          
+0001a780: 2020 2020 2020 2020 746f 2063 6f6e 6669          to confi
+0001a790: 6775 7265 2074 6865 2048 6f70 7377 6f72  gure the Hopswor
+0001a7a0: 6b73 204a 6f62 2075 7365 6420 746f 2077  ks Job used to w
+0001a7b0: 7269 7465 2064 6174 6120 696e 746f 2074  rite data into t
+0001a7c0: 6865 0a20 2020 2020 2020 2020 2020 2020  he.             
+0001a7d0: 2020 2020 2066 6561 7475 7265 2067 726f       feature gro
+0001a7e0: 7570 2e0a 2020 2020 2020 2020 2020 2020  up..            
+0001a7f0: 2020 2020 2a20 6b65 7920 6077 6169 745f      * key `wait_
+0001a800: 666f 725f 6a6f 6260 2061 6e64 2076 616c  for_job` and val
+0001a810: 7565 2060 5472 7565 6020 6f72 2060 4661  ue `True` or `Fa
+0001a820: 6c73 6560 2074 6f20 636f 6e66 6967 7572  lse` to configur
+0001a830: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001a840: 2020 2020 7768 6574 6865 7220 6f72 206e      whether or n
+0001a850: 6f74 2074 6f20 7468 6520 696e 7365 7274  ot to the insert
+0001a860: 2063 616c 6c20 7368 6f75 6c64 2072 6574   call should ret
+0001a870: 7572 6e20 6f6e 6c79 0a20 2020 2020 2020  urn only.       
+0001a880: 2020 2020 2020 2020 2020 2061 6674 6572             after
+0001a890: 2074 6865 2048 6f70 7377 6f72 6b73 204a   the Hopsworks J
+0001a8a0: 6f62 2068 6173 2066 696e 6973 6865 642e  ob has finished.
+0001a8b0: 2042 7920 6465 6661 756c 7420 6974 2077   By default it w
+0001a8c0: 6169 7473 2e0a 2020 2020 2020 2020 2020  aits..          
+0001a8d0: 2020 2020 2020 2a20 6b65 7920 6073 7461        * key `sta
+0001a8e0: 7274 5f6f 6666 6c69 6e65 5f62 6163 6b66  rt_offline_backf
+0001a8f0: 696c 6c60 2061 6e64 2076 616c 7565 2060  ill` and value `
+0001a900: 5472 7565 6020 6f72 2060 4661 6c73 6560  True` or `False`
+0001a910: 2074 6f20 636f 6e66 6967 7572 650a 2020   to configure.  
+0001a920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001a930: 7768 6574 6865 7220 6f72 206e 6f74 2074  whether or not t
+0001a940: 6f20 7374 6172 7420 7468 6520 6d61 7465  o start the mate
+0001a950: 7269 616c 697a 6174 696f 6e20 6a6f 6220  rialization job 
+0001a960: 746f 2077 7269 7465 2064 6174 6120 746f  to write data to
+0001a970: 2074 6865 206f 6666 6c69 6e65 0a20 2020   the offline.   
+0001a980: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001a990: 746f 7261 6765 2e20 6073 7461 7274 5f6f  torage. `start_o
+0001a9a0: 6666 6c69 6e65 5f62 6163 6b66 696c 6c60  ffline_backfill`
+0001a9b0: 2069 7320 6465 7072 6563 6174 6564 2e20   is deprecated. 
+0001a9c0: 5573 6520 6073 7461 7274 5f6f 6666 6c69  Use `start_offli
+0001a9d0: 6e65 5f6d 6174 6572 6961 6c69 7a61 7469  ne_materializati
+0001a9e0: 6f6e 6020 696e 7374 6561 642e 0a20 2020  on` instead..   
+0001a9f0: 2020 2020 2020 2020 2020 2020 202a 206b               * k
+0001aa00: 6579 2060 7374 6172 745f 6f66 666c 696e  ey `start_offlin
+0001aa10: 655f 6d61 7465 7269 616c 697a 6174 696f  e_materializatio
+0001aa20: 6e60 2061 6e64 2076 616c 7565 2060 5472  n` and value `Tr
+0001aa30: 7565 6020 6f72 2060 4661 6c73 6560 2074  ue` or `False` t
+0001aa40: 6f20 636f 6e66 6967 7572 650a 2020 2020  o configure.    
+0001aa50: 2020 2020 2020 2020 2020 2020 2020 7768                wh
+0001aa60: 6574 6865 7220 6f72 206e 6f74 2074 6f20  ether or not to 
+0001aa70: 7374 6172 7420 7468 6520 6d61 7465 7269  start the materi
+0001aa80: 616c 697a 6174 696f 6e20 6a6f 6220 746f  alization job to
+0001aa90: 2077 7269 7465 2064 6174 6120 746f 2074   write data to t
+0001aaa0: 6865 206f 6666 6c69 6e65 0a20 2020 2020  he offline.     
+0001aab0: 2020 2020 2020 2020 2020 2020 2073 746f               sto
+0001aac0: 7261 6765 2e20 4279 2064 6566 6175 6c74  rage. By default
+0001aad0: 2074 6865 206d 6174 6572 6961 6c69 7a61   the materializa
+0001aae0: 7469 6f6e 206a 6f62 2064 6f65 7320 6e6f  tion job does no
+0001aaf0: 7420 6765 7420 7374 6172 7465 6420 6175  t get started au
+0001ab00: 746f 6d61 7469 6361 6c6c 790a 2020 2020  tomatically.    
+0001ab10: 2020 2020 2020 2020 2020 2020 2020 666f                fo
+0001ab20: 7220 6d75 6c74 6920 7061 7274 2069 6e73  r multi part ins
+0001ab30: 6572 7473 2e0a 2020 2020 2020 2020 2020  erts..          
+0001ab40: 2020 2020 2020 2a20 6b65 7920 606b 6166        * key `kaf
+0001ab50: 6b61 5f70 726f 6475 6365 725f 636f 6e66  ka_producer_conf
+0001ab60: 6967 6020 616e 6420 7661 6c75 6520 616e  ig` and value an
+0001ab70: 206f 626a 6563 7420 6f66 2074 7970 6520   object of type 
+0001ab80: 5b70 726f 7065 7274 6965 735d 2868 7474  [properties](htt
+0001ab90: 7073 3a2f 2f64 6f63 732e 636f 6e66 6c75  ps://docs.conflu
+0001aba0: 656e 742e 696f 2f70 6c61 7466 6f72 6d2f  ent.io/platform/
+0001abb0: 6375 7272 656e 742f 636c 6965 6e74 732f  current/clients/
+0001abc0: 6c69 6272 646b 6166 6b61 2f68 746d 6c2f  librdkafka/html/
+0001abd0: 6d64 5f43 4f4e 4649 4755 5241 5449 4f4e  md_CONFIGURATION
+0001abe0: 2e68 746d 6c6e 290a 2020 2020 2020 2020  .htmln).        
+0001abf0: 2020 2020 2020 2020 2020 7573 6564 2074            used t
+0001ac00: 6f20 636f 6e66 6967 7572 6520 7468 6520  o configure the 
+0001ac10: 4b61 666b 6120 636c 6965 6e74 2e20 546f  Kafka client. To
+0001ac20: 206f 7074 696d 697a 6520 666f 7220 7468   optimize for th
+0001ac30: 726f 7567 6870 7574 2069 6e20 6869 6768  roughput in high
+0001ac40: 206c 6174 656e 6379 2063 6f6e 6e65 6374   latency connect
+0001ac50: 696f 6e20 636f 6e73 6964 6572 0a20 2020  ion consider.   
+0001ac60: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0001ac70: 6861 6e67 696e 6720 5b70 726f 6475 6365  hanging [produce
+0001ac80: 7220 7072 6f70 6572 7469 6573 5d28 6874  r properties](ht
+0001ac90: 7470 733a 2f2f 646f 6373 2e63 6f6e 666c  tps://docs.confl
+0001aca0: 7565 6e74 2e69 6f2f 636c 6f75 642f 6375  uent.io/cloud/cu
+0001acb0: 7272 656e 742f 636c 6965 6e74 2d61 7070  rrent/client-app
+0001acc0: 732f 6f70 7469 6d69 7a69 6e67 2f74 6872  s/optimizing/thr
+0001acd0: 6f75 6768 7075 742e 6874 6d6c 2370 726f  oughput.html#pro
+0001ace0: 6475 6365 7229 2e0a 2020 2020 2020 2020  ducer)..        
+0001acf0: 2020 2020 2020 2020 2a20 6b65 7920 6069          * key `i
+0001ad00: 6e74 6572 6e61 6c5f 6b61 666b 6160 2061  nternal_kafka` a
+0001ad10: 6e64 2076 616c 7565 2060 5472 7565 6020  nd value `True` 
+0001ad20: 6f72 2060 4661 6c73 6560 2069 6e20 6361  or `False` in ca
+0001ad30: 7365 2079 6f75 2065 7374 6162 6c69 7368  se you establish
+0001ad40: 6564 0a20 2020 2020 2020 2020 2020 2020  ed.             
+0001ad50: 2020 2020 2063 6f6e 6e65 6374 6976 6974       connectivit
+0001ad60: 7920 6672 6f6d 2079 6f75 2050 7974 686f  y from you Pytho
+0001ad70: 6e20 656e 7669 726f 6e6d 656e 7420 746f  n environment to
+0001ad80: 2074 6865 2069 6e74 6572 6e61 6c20 6164   the internal ad
+0001ad90: 7665 7274 6973 6564 0a20 2020 2020 2020  vertised.       
+0001ada0: 2020 2020 2020 2020 2020 206c 6973 7465             liste
+0001adb0: 6e65 7273 206f 6620 7468 6520 486f 7073  ners of the Hops
+0001adc0: 776f 726b 7320 4b61 666b 6120 436c 7573  works Kafka Clus
+0001add0: 7465 722e 2044 6566 6175 6c74 7320 746f  ter. Defaults to
+0001ade0: 2060 4661 6c73 6560 2061 6e64 0a20 2020   `False` and.   
+0001adf0: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0001ae00: 696c 6c20 7573 6520 6578 7465 726e 616c  ill use external
+0001ae10: 206c 6973 7465 6e65 7273 2077 6865 6e20   listeners when 
+0001ae20: 636f 6e6e 6563 7469 6e67 2066 726f 6d20  connecting from 
+0001ae30: 6f75 7473 6964 6520 6f66 2048 6f70 7377  outside of Hopsw
+0001ae40: 6f72 6b73 2e0a 2020 2020 2020 2020 2020  orks..          
+0001ae50: 2020 7661 6c69 6461 7469 6f6e 5f6f 7074    validation_opt
+0001ae60: 696f 6e73 3a20 4164 6469 7469 6f6e 616c  ions: Additional
+0001ae70: 2076 616c 6964 6174 696f 6e20 6f70 7469   validation opti
+0001ae80: 6f6e 7320 6173 206b 6579 2d76 616c 7565  ons as key-value
+0001ae90: 2070 6169 7273 2c20 6465 6661 756c 7473   pairs, defaults
+0001aea0: 2074 6f20 607b 7d60 2e0a 2020 2020 2020   to `{}`..      
+0001aeb0: 2020 2020 2020 2020 2020 2a20 6b65 7920            * key 
+0001aec0: 6072 756e 5f76 616c 6964 6174 696f 6e60  `run_validation`
+0001aed0: 2062 6f6f 6c65 616e 2076 616c 7565 2c20   boolean value, 
+0001aee0: 7365 7420 746f 2060 4661 6c73 6560 2074  set to `False` t
+0001aef0: 6f20 736b 6970 2076 616c 6964 6174 696f  o skip validatio
+0001af00: 6e20 7465 6d70 6f72 6172 696c 7920 6f6e  n temporarily on
+0001af10: 2069 6e67 6573 7469 6f6e 2e0a 2020 2020   ingestion..    
+0001af20: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
+0001af30: 7920 6073 6176 655f 7265 706f 7274 6020  y `save_report` 
+0001af40: 626f 6f6c 6561 6e20 7661 6c75 652c 2073  boolean value, s
+0001af50: 6574 2074 6f20 6046 616c 7365 6020 746f  et to `False` to
+0001af60: 2073 6b69 7020 7570 6c6f 6164 206f 6620   skip upload of 
+0001af70: 7468 6520 7661 6c69 6461 7469 6f6e 2072  the validation r
+0001af80: 6570 6f72 7420 746f 2048 6f70 7377 6f72  eport to Hopswor
+0001af90: 6b73 2e0a 2020 2020 2020 2020 2020 2020  ks..            
+0001afa0: 2020 2020 2a20 6b65 7920 6067 655f 7661      * key `ge_va
+0001afb0: 6c69 6461 7465 5f6b 7761 7267 7360 2061  lidate_kwargs` a
+0001afc0: 2064 6963 7469 6f6e 6172 7920 636f 6e74   dictionary cont
+0001afd0: 6169 6e69 6e67 206b 7761 7267 7320 666f  aining kwargs fo
+0001afe0: 7220 7468 6520 7661 6c69 6461 7465 206d  r the validate m
+0001aff0: 6574 686f 6420 6f66 2047 7265 6174 2045  ethod of Great E
+0001b000: 7870 6563 7461 7469 6f6e 732e 0a20 2020  xpectations..   
+0001b010: 2020 2020 2020 2020 2020 2020 202a 206b               * k
+0001b020: 6579 2060 6665 7463 685f 6578 7065 6374  ey `fetch_expect
+0001b030: 6174 696f 6e5f 7375 6974 6560 2061 2062  ation_suite` a b
+0001b040: 6f6f 6c65 616e 2076 616c 7565 2c20 6279  oolean value, by
+0001b050: 2064 6566 6175 6c74 2060 4661 6c73 6560   default `False`
+0001b060: 2066 6f72 206d 756c 7469 2070 6172 7420   for multi part 
+0001b070: 696e 7365 7274 732c 0a20 2020 2020 2020  inserts,.       
+0001b080: 2020 2020 2020 2020 2020 2020 746f 2063              to c
+0001b090: 6f6e 7472 6f6c 2077 6865 7468 6572 2074  ontrol whether t
+0001b0a0: 6865 2065 7870 6563 7461 7469 6f6e 2073  he expectation s
+0001b0b0: 7569 7465 206f 6620 7468 6520 6665 6174  uite of the feat
+0001b0c0: 7572 6520 6772 6f75 7020 7368 6f75 6c64  ure group should
+0001b0d0: 2062 6520 6665 7463 6865 6420 6265 666f   be fetched befo
+0001b0e0: 7265 2065 7665 7279 2069 6e73 6572 742e  re every insert.
+0001b0f0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
+0001b100: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
+0001b110: 2860 4a6f 6260 2c20 6056 616c 6964 6174  (`Job`, `Validat
+0001b120: 696f 6e52 6570 6f72 7460 2920 4120 7475  ionReport`) A tu
+0001b130: 706c 6520 7769 7468 206a 6f62 2069 6e66  ple with job inf
+0001b140: 6f72 6d61 7469 6f6e 2069 6620 7079 7468  ormation if pyth
+0001b150: 6f6e 2065 6e67 696e 6520 6973 2075 7365  on engine is use
+0001b160: 6420 616e 6420 7468 6520 7661 6c69 6461  d and the valida
+0001b170: 7469 6f6e 2072 6570 6f72 7420 6966 2076  tion report if v
+0001b180: 616c 6964 6174 696f 6e20 6973 2065 6e61  alidation is ena
+0001b190: 626c 6564 2e0a 2020 2020 2020 2020 2020  bled..          
+0001b1a0: 2020 6046 6561 7475 7265 4772 6f75 7057    `FeatureGroupW
+0001b1b0: 7269 7465 7260 2057 6865 6e20 7573 6564  riter` When used
+0001b1c0: 2061 7320 6120 636f 6e74 6578 7420 6d61   as a context ma
+0001b1d0: 6e61 6765 7220 7769 7468 2050 7974 686f  nager with Pytho
+0001b1e0: 6e20 6077 6974 6860 2073 7461 7465 6d65  n `with` stateme
+0001b1f0: 6e74 2e0a 2020 2020 2020 2020 2222 220a  nt..        """.
+0001b200: 2020 2020 2020 2020 7365 6c66 2e5f 6d75          self._mu
+0001b210: 6c74 695f 7061 7274 5f69 6e73 6572 7420  lti_part_insert 
+0001b220: 3d20 5472 7565 0a20 2020 2020 2020 206d  = True.        m
+0001b230: 756c 7469 5f70 6172 745f 7772 6974 6572  ulti_part_writer
+0001b240: 203d 2066 6561 7475 7265 5f67 726f 7570   = feature_group
+0001b250: 5f77 7269 7465 722e 4665 6174 7572 6547  _writer.FeatureG
+0001b260: 726f 7570 5772 6974 6572 2873 656c 6629  roupWriter(self)
+0001b270: 0a20 2020 2020 2020 2069 6620 6665 6174  .        if feat
+0001b280: 7572 6573 2069 7320 4e6f 6e65 3a0a 2020  ures is None:.  
+0001b290: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001b2a0: 206d 756c 7469 5f70 6172 745f 7772 6974   multi_part_writ
+0001b2b0: 6572 0a20 2020 2020 2020 2065 6c73 653a  er.        else:
+0001b2c0: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+0001b2d0: 6f20 7468 726f 7567 6820 7772 6974 6572  o through writer
+0001b2e0: 2074 6f20 6176 6f69 6420 7365 7474 696e   to avoid settin
+0001b2f0: 6720 6d75 6c74 6920 696e 7365 7274 2064  g multi insert d
+0001b300: 6566 6175 6c74 7320 6167 6169 6e0a 2020  efaults again.  
+0001b310: 2020 2020 2020 2020 2020 7265 7475 726e            return
+0001b320: 206d 756c 7469 5f70 6172 745f 7772 6974   multi_part_writ
+0001b330: 6572 2e69 6e73 6572 7428 0a20 2020 2020  er.insert(.     
+0001b340: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+0001b350: 7265 732c 0a20 2020 2020 2020 2020 2020  res,.           
+0001b360: 2020 2020 206f 7665 7277 7269 7465 2c0a       overwrite,.
+0001b370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001b380: 6f70 6572 6174 696f 6e2c 0a20 2020 2020  operation,.     
+0001b390: 2020 2020 2020 2020 2020 2073 746f 7261             stora
+0001b3a0: 6765 2c0a 2020 2020 2020 2020 2020 2020  ge,.            
+0001b3b0: 2020 2020 7772 6974 655f 6f70 7469 6f6e      write_option
+0001b3c0: 732c 0a20 2020 2020 2020 2020 2020 2020  s,.             
+0001b3d0: 2020 2076 616c 6964 6174 696f 6e5f 6f70     validation_op
+0001b3e0: 7469 6f6e 732c 0a20 2020 2020 2020 2020  tions,.         
+0001b3f0: 2020 2029 0a0a 2020 2020 6465 6620 6669     )..    def fi
+0001b400: 6e61 6c69 7a65 5f6d 756c 7469 5f70 6172  nalize_multi_par
+0001b410: 745f 696e 7365 7274 2873 656c 6629 3a0a  t_insert(self):.
+0001b420: 2020 2020 2020 2020 2222 2246 696e 616c          """Final
+0001b430: 697a 6573 2061 6e64 2065 7869 7473 2074  izes and exits t
+0001b440: 6865 206d 756c 7469 2070 6172 7420 696e  he multi part in
+0001b450: 7365 7274 2063 6f6e 7465 7874 206f 7065  sert context ope
+0001b460: 6e65 6420 6279 2060 6d75 6c74 695f 7061  ned by `multi_pa
+0001b470: 7274 5f69 6e73 6572 7460 0a20 2020 2020  rt_insert`.     
+0001b480: 2020 2069 6e20 6120 626c 6f63 6b69 6e67     in a blocking
+0001b490: 2066 6173 6869 6f6e 206f 6e63 6520 616c   fashion once al
+0001b4a0: 6c20 726f 7773 2068 6176 6520 6265 656e  l rows have been
+0001b4b0: 2074 7261 6e73 6d69 7474 6564 2e0a 0a20   transmitted... 
+0001b4c0: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+0001b4d0: 6c65 2022 4d75 6c74 6920 7061 7274 2069  le "Multi part i
+0001b4e0: 6e73 6572 7420 7769 7468 206d 616e 7561  nsert with manua
+0001b4f0: 6c20 636f 6e74 6578 7420 6d61 6e61 6765  l context manage
+0001b500: 6d65 6e74 220a 2020 2020 2020 2020 2020  ment".          
+0001b510: 2020 496e 7374 6561 6420 6f66 206c 6574    Instead of let
+0001b520: 7469 6e67 2050 7974 686f 6e20 6861 6e64  ting Python hand
+0001b530: 6c65 2074 6865 2065 6e74 6572 696e 6720  le the entering 
+0001b540: 616e 6420 6578 6974 696e 6720 6f66 2074  and exiting of t
+0001b550: 6865 0a20 2020 2020 2020 2020 2020 206d  he.            m
+0001b560: 756c 7469 2070 6172 7420 696e 7365 7274  ulti part insert
+0001b570: 2063 6f6e 7465 7874 2c20 796f 7520 6361   context, you ca
+0001b580: 6e20 7374 6172 7420 616e 6420 6669 6e61  n start and fina
+0001b590: 6c69 7a65 2074 6865 2063 6f6e 7465 7874  lize the context
+0001b5a0: 0a20 2020 2020 2020 2020 2020 206d 616e  .            man
+0001b5b0: 7561 6c6c 792e 0a20 2020 2020 2020 2020  ually..         
+0001b5c0: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+0001b5d0: 2020 2020 2020 2020 2066 6561 7475 7265           feature
+0001b5e0: 5f67 726f 7570 203d 2066 732e 6765 745f  _group = fs.get_
+0001b5f0: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
+0001b600: 655f 6772 6f75 7028 2266 675f 6e61 6d65  e_group("fg_name
+0001b610: 222c 2076 6572 7369 6f6e 3d31 290a 0a20  ", version=1).. 
+0001b620: 2020 2020 2020 2020 2020 2077 6869 6c65             while
+0001b630: 206c 6f6f 703a 0a20 2020 2020 2020 2020   loop:.         
+0001b640: 2020 2020 2020 2073 6d61 6c6c 5f62 6174         small_bat
+0001b650: 6368 5f64 6620 3d20 2e2e 2e0a 2020 2020  ch_df = ....    
+0001b660: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+0001b670: 7572 655f 6772 6f75 702e 6d75 6c74 695f  ure_group.multi_
+0001b680: 7061 7274 5f69 6e73 6572 7428 736d 616c  part_insert(smal
+0001b690: 6c5f 6261 7463 685f 6466 290a 0a20 2020  l_batch_df)..   
+0001b6a0: 2020 2020 2020 2020 2023 2049 4d50 4f52           # IMPOR
+0001b6b0: 5441 4e54 3a20 6669 6e61 6c69 7a65 2074  TANT: finalize t
+0001b6c0: 6865 206d 756c 7469 2070 6172 7420 696e  he multi part in
+0001b6d0: 7365 7274 2074 6f20 6d61 6b65 2073 7572  sert to make sur
+0001b6e0: 6520 616c 6c20 726f 7773 0a20 2020 2020  e all rows.     
+0001b6f0: 2020 2020 2020 2023 2068 6176 6520 6265         # have be
+0001b700: 656e 2074 7261 6e73 6d69 7474 6564 0a20  en transmitted. 
+0001b710: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+0001b720: 7265 5f67 726f 7570 2e66 696e 616c 697a  re_group.finaliz
+0001b730: 655f 6d75 6c74 695f 7061 7274 5f69 6e73  e_multi_part_ins
+0001b740: 6572 7428 290a 2020 2020 2020 2020 2020  ert().          
+0001b750: 2020 6060 600a 2020 2020 2020 2020 2020    ```.          
+0001b760: 2020 4e6f 7465 2074 6861 7420 7468 6520    Note that the 
+0001b770: 6669 7273 7420 6361 6c6c 2074 6f20 606d  first call to `m
+0001b780: 756c 7469 5f70 6172 745f 696e 7365 7274  ulti_part_insert
+0001b790: 6020 696e 6974 6961 7465 7320 7468 6520  ` initiates the 
+0001b7a0: 636f 6e74 6578 740a 2020 2020 2020 2020  context.        
+0001b7b0: 2020 2020 616e 6420 6265 2073 7572 6520      and be sure 
+0001b7c0: 746f 2066 696e 616c 697a 6520 6974 2e20  to finalize it. 
+0001b7d0: 5468 6520 6066 696e 616c 697a 655f 6d75  The `finalize_mu
+0001b7e0: 6c74 695f 7061 7274 5f69 6e73 6572 7460  lti_part_insert`
+0001b7f0: 2069 7320 610a 2020 2020 2020 2020 2020   is a.          
+0001b800: 2020 626c 6f63 6b69 6e67 2063 616c 6c20    blocking call 
+0001b810: 7468 6174 2072 6574 7572 6e73 206f 6e63  that returns onc
+0001b820: 6520 616c 6c20 726f 7773 2068 6176 6520  e all rows have 
+0001b830: 6265 656e 2074 7261 6e73 6d69 7474 6564  been transmitted
+0001b840: 2e0a 2020 2020 2020 2020 2222 220a 2020  ..        """.  
+0001b850: 2020 2020 2020 6966 2073 656c 662e 5f6b        if self._k
+0001b860: 6166 6b61 5f70 726f 6475 6365 7220 6973  afka_producer is
+0001b870: 206e 6f74 204e 6f6e 653a 0a20 2020 2020   not None:.     
+0001b880: 2020 2020 2020 2073 656c 662e 5f6b 6166         self._kaf
+0001b890: 6b61 5f70 726f 6475 6365 722e 666c 7573  ka_producer.flus
+0001b8a0: 6828 290a 2020 2020 2020 2020 2020 2020  h().            
+0001b8b0: 7365 6c66 2e5f 6b61 666b 615f 7072 6f64  self._kafka_prod
+0001b8c0: 7563 6572 203d 204e 6f6e 650a 2020 2020  ucer = None.    
+0001b8d0: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
+0001b8e0: 655f 7772 6974 6572 7320 3d20 4e6f 6e65  e_writers = None
+0001b8f0: 0a20 2020 2020 2020 2073 656c 662e 5f77  .        self._w
+0001b900: 7269 7465 7220 3d20 4e6f 6e65 0a20 2020  riter = None.   
+0001b910: 2020 2020 2073 656c 662e 5f6d 756c 7469       self._multi
+0001b920: 5f70 6172 745f 696e 7365 7274 203d 2046  _part_insert = F
+0001b930: 616c 7365 0a0a 2020 2020 6465 6620 696e  alse..    def in
+0001b940: 7365 7274 5f73 7472 6561 6d28 0a20 2020  sert_stream(.   
+0001b950: 2020 2020 2073 656c 662c 0a20 2020 2020       self,.     
+0001b960: 2020 2066 6561 7475 7265 733a 2054 7970     features: Typ
+0001b970: 6556 6172 2822 7079 7370 6172 6b2e 7371  eVar("pyspark.sq
+0001b980: 6c2e 4461 7461 4672 616d 6522 292c 2020  l.DataFrame"),  
+0001b990: 2320 6e6f 7161 3a20 4638 3231 0a20 2020  # noqa: F821.   
+0001b9a0: 2020 2020 2071 7565 7279 5f6e 616d 653a       query_name:
+0001b9b0: 204f 7074 696f 6e61 6c5b 7374 725d 203d   Optional[str] =
+0001b9c0: 204e 6f6e 652c 0a20 2020 2020 2020 206f   None,.        o
+0001b9d0: 7574 7075 745f 6d6f 6465 3a20 4f70 7469  utput_mode: Opti
+0001b9e0: 6f6e 616c 5b73 7472 5d20 3d20 2261 7070  onal[str] = "app
+0001b9f0: 656e 6422 2c0a 2020 2020 2020 2020 6177  end",.        aw
+0001ba00: 6169 745f 7465 726d 696e 6174 696f 6e3a  ait_termination:
+0001ba10: 204f 7074 696f 6e61 6c5b 626f 6f6c 5d20   Optional[bool] 
+0001ba20: 3d20 4661 6c73 652c 0a20 2020 2020 2020  = False,.       
+0001ba30: 2074 696d 656f 7574 3a20 4f70 7469 6f6e   timeout: Option
+0001ba40: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+0001ba50: 2020 2020 2020 2020 6368 6563 6b70 6f69          checkpoi
+0001ba60: 6e74 5f64 6972 3a20 4f70 7469 6f6e 616c  nt_dir: Optional
+0001ba70: 5b73 7472 5d20 3d20 4e6f 6e65 2c0a 2020  [str] = None,.  
+0001ba80: 2020 2020 2020 7772 6974 655f 6f70 7469        write_opti
+0001ba90: 6f6e 733a 204f 7074 696f 6e61 6c5b 4469  ons: Optional[Di
+0001baa0: 6374 5b41 6e79 2c20 416e 795d 5d20 3d20  ct[Any, Any]] = 
+0001bab0: 7b7d 2c0a 2020 2020 293a 0a20 2020 2020  {},.    ):.     
+0001bac0: 2020 2022 2222 496e 6765 7374 2061 2053     """Ingest a S
+0001bad0: 7061 726b 2053 7472 7563 7475 7265 6420  park Structured 
+0001bae0: 5374 7265 616d 696e 6720 4461 7461 6672  Streaming Datafr
+0001baf0: 616d 6520 746f 2074 6865 206f 6e6c 696e  ame to the onlin
+0001bb00: 6520 6665 6174 7572 6520 7374 6f72 652e  e feature store.
+0001bb10: 0a0a 2020 2020 2020 2020 5468 6973 206d  ..        This m
+0001bb20: 6574 686f 6420 6372 6561 7465 7320 6120  ethod creates a 
+0001bb30: 6c6f 6e67 2072 756e 6e69 6e67 2053 7061  long running Spa
+0001bb40: 726b 2053 7472 6561 6d69 6e67 2051 7565  rk Streaming Que
+0001bb50: 7279 2c20 796f 7520 6361 6e20 636f 6e74  ry, you can cont
+0001bb60: 726f 6c20 7468 650a 2020 2020 2020 2020  rol the.        
+0001bb70: 7465 726d 696e 6174 696f 6e20 6f66 2074  termination of t
+0001bb80: 6865 2071 7565 7279 2074 6872 6f75 6768  he query through
+0001bb90: 2074 6865 2061 7267 756d 656e 7473 2e0a   the arguments..
+0001bba0: 0a20 2020 2020 2020 2049 7420 6973 2070  .        It is p
+0001bbb0: 6f73 7369 626c 6520 746f 2073 746f 7020  ossible to stop 
+0001bbc0: 7468 6520 7265 7475 726e 6564 2071 7565  the returned que
+0001bbd0: 7279 2077 6974 6820 7468 6520 602e 7374  ry with the `.st
+0001bbe0: 6f70 2829 6020 616e 6420 6368 6563 6b20  op()` and check 
+0001bbf0: 6974 730a 2020 2020 2020 2020 7374 6174  its.        stat
+0001bc00: 7573 2077 6974 6820 602e 6973 4163 7469  us with `.isActi
+0001bc10: 7665 602e 0a0a 2020 2020 2020 2020 546f  ve`...        To
+0001bc20: 2067 6574 2061 206c 6973 7420 6f66 2061   get a list of a
+0001bc30: 6c6c 2061 6374 6976 6520 7175 6572 6965  ll active querie
+0001bc40: 732c 2075 7365 3a0a 0a20 2020 2020 2020  s, use:..       
+0001bc50: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+0001bc60: 2020 2073 716d 203d 2073 7061 726b 2e73     sqm = spark.s
+0001bc70: 7472 6561 6d73 0a0a 2020 2020 2020 2020  treams..        
+0001bc80: 2320 6765 7420 7468 6520 6c69 7374 206f  # get the list o
+0001bc90: 6620 6163 7469 7665 2073 7472 6561 6d69  f active streami
+0001bca0: 6e67 2071 7565 7269 6573 0a20 2020 2020  ng queries.     
+0001bcb0: 2020 205b 712e 6e61 6d65 2066 6f72 2071     [q.name for q
+0001bcc0: 2069 6e20 7371 6d2e 6163 7469 7665 5d0a   in sqm.active].
+0001bcd0: 2020 2020 2020 2020 6060 600a 0a20 2020          ```..   
+0001bce0: 2020 2020 2021 2121 2077 6172 6e69 6e67       !!! warning
+0001bcf0: 2022 456e 6769 6e65 2053 7570 706f 7274   "Engine Support
+0001bd00: 220a 2020 2020 2020 2020 2020 2020 2a2a  ".            **
+0001bd10: 5370 6172 6b20 6f6e 6c79 2a2a 0a0a 2020  Spark only**..  
+0001bd20: 2020 2020 2020 2020 2020 5374 7265 616d            Stream
+0001bd30: 2069 6e67 6573 7469 6f6e 2075 7369 6e67   ingestion using
+0001bd40: 2050 616e 6461 732f 5079 7468 6f6e 2061   Pandas/Python a
+0001bd50: 7320 656e 6769 6e65 2069 7320 6375 7272  s engine is curr
+0001bd60: 656e 746c 7920 6e6f 7420 7375 7070 6f72  ently not suppor
+0001bd70: 7465 642e 0a20 2020 2020 2020 2020 2020  ted..           
+0001bd80: 2050 7974 686f 6e2f 5061 6e64 6173 2068   Python/Pandas h
+0001bd90: 6173 206e 6f20 6e6f 7469 6f6e 206f 6620  as no notion of 
+0001bda0: 7374 7265 616d 696e 672e 0a0a 2020 2020  streaming...    
+0001bdb0: 2020 2020 2121 2120 7761 726e 696e 6720      !!! warning 
+0001bdc0: 2244 6174 6120 5661 6c69 6461 7469 6f6e  "Data Validation
+0001bdd0: 2053 7570 706f 7274 220a 2020 2020 2020   Support".      
+0001bde0: 2020 2020 2020 6069 6e73 6572 745f 7374        `insert_st
+0001bdf0: 7265 616d 6020 646f 6573 206e 6f74 2070  ream` does not p
+0001be00: 6572 666f 726d 2061 6e79 2064 6174 6120  erform any data 
+0001be10: 7661 6c69 6461 7469 6f6e 2075 7369 6e67  validation using
+0001be20: 2047 7265 6174 2045 7870 6563 7461 7469   Great Expectati
+0001be30: 6f6e 730a 2020 2020 2020 2020 2020 2020  ons.            
+0001be40: 6576 656e 2077 6865 6e20 6120 6578 7065  even when a expe
+0001be50: 6374 6174 696f 6e20 7375 6974 6520 6973  ctation suite is
+0001be60: 2061 7474 6163 6865 642e 0a0a 2020 2020   attached...    
+0001be70: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
+0001be80: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+0001be90: 7572 6573 3a20 4665 6174 7572 6573 2069  ures: Features i
+0001bea0: 6e20 5374 7265 616d 696e 6720 4461 7461  n Streaming Data
+0001beb0: 6672 616d 6520 746f 2062 6520 7361 7665  frame to be save
+0001bec0: 642e 0a20 2020 2020 2020 2020 2020 2071  d..            q
+0001bed0: 7565 7279 5f6e 616d 653a 2049 7420 6973  uery_name: It is
+0001bee0: 2070 6f73 7369 626c 6520 746f 206f 7074   possible to opt
+0001bef0: 696f 6e61 6c6c 7920 7370 6563 6966 7920  ionally specify 
+0001bf00: 6120 6e61 6d65 2066 6f72 2074 6865 2071  a name for the q
+0001bf10: 7565 7279 2074 6f0a 2020 2020 2020 2020  uery to.        
+0001bf20: 2020 2020 2020 2020 6d61 6b65 2069 7420          make it 
+0001bf30: 6561 7369 6572 2074 6f20 7265 636f 676e  easier to recogn
+0001bf40: 6973 6520 696e 2074 6865 2053 7061 726b  ise in the Spark
+0001bf50: 2055 492e 2044 6566 6175 6c74 7320 746f   UI. Defaults to
+0001bf60: 2060 4e6f 6e65 602e 0a20 2020 2020 2020   `None`..       
+0001bf70: 2020 2020 206f 7574 7075 745f 6d6f 6465       output_mode
+0001bf80: 3a20 5370 6563 6966 6965 7320 686f 7720  : Specifies how 
+0001bf90: 6461 7461 206f 6620 6120 7374 7265 616d  data of a stream
+0001bfa0: 696e 6720 4461 7461 4672 616d 652f 4461  ing DataFrame/Da
+0001bfb0: 7461 7365 7420 6973 0a20 2020 2020 2020  taset is.       
+0001bfc0: 2020 2020 2020 2020 2077 7269 7474 656e           written
+0001bfd0: 2074 6f20 6120 7374 7265 616d 696e 6720   to a streaming 
+0001bfe0: 7369 6e6b 2e20 2831 2920 6022 6170 7065  sink. (1) `"appe
+0001bff0: 6e64 2260 3a20 4f6e 6c79 2074 6865 206e  nd"`: Only the n
+0001c000: 6577 2072 6f77 7320 696e 2074 6865 0a20  ew rows in the. 
+0001c010: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001c020: 7472 6561 6d69 6e67 2044 6174 6146 7261  treaming DataFra
+0001c030: 6d65 2f44 6174 6173 6574 2077 696c 6c20  me/Dataset will 
+0001c040: 6265 2077 7269 7474 656e 2074 6f20 7468  be written to th
+0001c050: 6520 7369 6e6b 2e20 2832 290a 2020 2020  e sink. (2).    
+0001c060: 2020 2020 2020 2020 2020 2020 6022 636f              `"co
+0001c070: 6d70 6c65 7465 2260 3a20 416c 6c20 7468  mplete"`: All th
+0001c080: 6520 726f 7773 2069 6e20 7468 6520 7374  e rows in the st
+0001c090: 7265 616d 696e 6720 4461 7461 4672 616d  reaming DataFram
+0001c0a0: 652f 4461 7461 7365 7420 7769 6c6c 2062  e/Dataset will b
+0001c0b0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+0001c0c0: 2020 7772 6974 7465 6e20 746f 2074 6865    written to the
+0001c0d0: 2073 696e 6b20 6576 6572 7920 7469 6d65   sink every time
+0001c0e0: 2074 6865 7265 2069 7320 736f 6d65 2075   there is some u
+0001c0f0: 7064 6174 652e 2028 3329 2060 2275 7064  pdate. (3) `"upd
+0001c100: 6174 6522 603a 0a20 2020 2020 2020 2020  ate"`:.         
+0001c110: 2020 2020 2020 206f 6e6c 7920 7468 6520         only the 
+0001c120: 726f 7773 2074 6861 7420 7765 7265 2075  rows that were u
+0001c130: 7064 6174 6564 2069 6e20 7468 6520 7374  pdated in the st
+0001c140: 7265 616d 696e 6720 4461 7461 4672 616d  reaming DataFram
+0001c150: 652f 4461 7461 7365 7420 7769 6c6c 0a20  e/Dataset will. 
+0001c160: 2020 2020 2020 2020 2020 2020 2020 2062                 b
+0001c170: 6520 7772 6974 7465 6e20 746f 2074 6865  e written to the
+0001c180: 2073 696e 6b20 6576 6572 7920 7469 6d65   sink every time
+0001c190: 2074 6865 7265 2061 7265 2073 6f6d 6520   there are some 
+0001c1a0: 7570 6461 7465 732e 0a20 2020 2020 2020  updates..       
+0001c1b0: 2020 2020 2020 2020 2049 6620 7468 6520           If the 
+0001c1c0: 7175 6572 7920 646f 6573 6ee2 8099 7420  query doesn...t 
+0001c1d0: 636f 6e74 6169 6e20 6167 6772 6567 6174  contain aggregat
+0001c1e0: 696f 6e73 2c20 6974 2077 696c 6c20 6265  ions, it will be
+0001c1f0: 2065 7175 6976 616c 656e 7420 746f 0a20   equivalent to. 
+0001c200: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+0001c210: 7070 656e 6420 6d6f 6465 2e20 4465 6661  ppend mode. Defa
+0001c220: 756c 7473 2074 6f20 6022 6170 7065 6e64  ults to `"append
+0001c230: 2260 2e0a 2020 2020 2020 2020 2020 2020  "`..            
+0001c240: 6177 6169 745f 7465 726d 696e 6174 696f  await_terminatio
+0001c250: 6e3a 2057 6169 7473 2066 6f72 2074 6865  n: Waits for the
+0001c260: 2074 6572 6d69 6e61 7469 6f6e 206f 6620   termination of 
+0001c270: 7468 6973 2071 7565 7279 2c20 6569 7468  this query, eith
+0001c280: 6572 2062 790a 2020 2020 2020 2020 2020  er by.          
+0001c290: 2020 2020 2020 7175 6572 792e 7374 6f70        query.stop
+0001c2a0: 2829 206f 7220 6279 2061 6e20 6578 6365  () or by an exce
+0001c2b0: 7074 696f 6e2e 2049 6620 7468 6520 7175  ption. If the qu
+0001c2c0: 6572 7920 6861 7320 7465 726d 696e 6174  ery has terminat
+0001c2d0: 6564 2077 6974 6820 616e 0a20 2020 2020  ed with an.     
+0001c2e0: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0001c2f0: 7469 6f6e 2c20 7468 656e 2074 6865 2065  tion, then the e
+0001c300: 7863 6570 7469 6f6e 2077 696c 6c20 6265  xception will be
+0001c310: 2074 6872 6f77 6e2e 2049 6620 7469 6d65   thrown. If time
+0001c320: 6f75 7420 6973 2073 6574 2c20 6974 0a20  out is set, it. 
+0001c330: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001c340: 6574 7572 6e73 2077 6865 7468 6572 2074  eturns whether t
+0001c350: 6865 2071 7565 7279 2068 6173 2074 6572  he query has ter
+0001c360: 6d69 6e61 7465 6420 6f72 206e 6f74 2077  minated or not w
+0001c370: 6974 6869 6e20 7468 6520 7469 6d65 6f75  ithin the timeou
+0001c380: 740a 2020 2020 2020 2020 2020 2020 2020  t.              
+0001c390: 2020 7365 636f 6e64 732e 2044 6566 6175    seconds. Defau
+0001c3a0: 6c74 7320 746f 2060 4661 6c73 6560 2e0a  lts to `False`..
+0001c3b0: 2020 2020 2020 2020 2020 2020 7469 6d65              time
+0001c3c0: 6f75 743a 204f 6e6c 7920 7265 6c65 7661  out: Only releva
+0001c3d0: 6e74 2069 6e20 636f 6d62 696e 6174 696f  nt in combinatio
+0001c3e0: 6e20 7769 7468 2060 6177 6169 745f 7465  n with `await_te
+0001c3f0: 726d 696e 6174 696f 6e3d 5472 7565 602e  rmination=True`.
+0001c400: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c410: 2044 6566 6175 6c74 7320 746f 2060 4e6f   Defaults to `No
+0001c420: 6e65 602e 0a20 2020 2020 2020 2020 2020  ne`..           
+0001c430: 2063 6865 636b 706f 696e 745f 6469 723a   checkpoint_dir:
+0001c440: 2043 6865 636b 706f 696e 7420 6469 7265   Checkpoint dire
+0001c450: 6374 6f72 7920 6c6f 6361 7469 6f6e 2e20  ctory location. 
+0001c460: 5468 6973 2077 696c 6c20 6265 2075 7365  This will be use
+0001c470: 6420 746f 2061 7320 6120 7265 6665 7265  d to as a refere
+0001c480: 6e63 6520 746f 0a20 2020 2020 2020 2020  nce to.         
+0001c490: 2020 2020 2020 2066 726f 6d20 7768 6572         from wher
+0001c4a0: 6520 746f 2072 6573 756d 6520 7468 6520  e to resume the 
+0001c4b0: 7374 7265 616d 696e 6720 6a6f 622e 2049  streaming job. I
+0001c4c0: 6620 604e 6f6e 6560 2074 6865 6e20 6873  f `None` then hs
+0001c4d0: 6673 2077 696c 6c20 636f 6e73 7472 7563  fs will construc
+0001c4e0: 7420 6173 0a20 2020 2020 2020 2020 2020  t as.           
+0001c4f0: 2020 2020 2022 696e 7365 7274 5f73 7472       "insert_str
+0001c500: 6561 6d5f 2220 2b20 6f6e 6c69 6e65 5f74  eam_" + online_t
+0001c510: 6f70 6963 5f6e 616d 652e 2044 6566 6175  opic_name. Defau
+0001c520: 6c74 7320 746f 2060 4e6f 6e65 602e 0a20  lts to `None`.. 
+0001c530: 2020 2020 2020 2020 2020 2020 2020 2077                 w
+0001c540: 7269 7465 5f6f 7074 696f 6e73 3a20 4164  rite_options: Ad
+0001c550: 6469 7469 6f6e 616c 2077 7269 7465 206f  ditional write o
+0001c560: 7074 696f 6e73 2066 6f72 2053 7061 726b  ptions for Spark
+0001c570: 2061 7320 6b65 792d 7661 6c75 6520 7061   as key-value pa
+0001c580: 6972 732e 0a20 2020 2020 2020 2020 2020  irs..           
+0001c590: 2020 2020 2044 6566 6175 6c74 7320 746f       Defaults to
+0001c5a0: 2060 7b7d 602e 0a0a 2020 2020 2020 2020   `{}`...        
+0001c5b0: 2320 5265 7475 726e 730a 2020 2020 2020  # Returns.      
+0001c5c0: 2020 2020 2020 6053 7472 6561 6d69 6e67        `Streaming
+0001c5d0: 5175 6572 7960 3a20 5370 6172 6b20 5374  Query`: Spark St
+0001c5e0: 7275 6374 7572 6564 2053 7472 6561 6d69  ructured Streami
+0001c5f0: 6e67 2051 7565 7279 206f 626a 6563 742e  ng Query object.
+0001c600: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001c610: 2020 2020 2069 6620 280a 2020 2020 2020       if (.      
+0001c620: 2020 2020 2020 6e6f 7420 656e 6769 6e65        not engine
+0001c630: 2e67 6574 5f69 6e73 7461 6e63 6528 292e  .get_instance().
+0001c640: 6973 5f73 7061 726b 5f64 6174 6166 7261  is_spark_datafra
+0001c650: 6d65 2866 6561 7475 7265 7329 0a20 2020  me(features).   
+0001c660: 2020 2020 2020 2020 206f 7220 6e6f 7420           or not 
+0001c670: 6665 6174 7572 6573 2e69 7353 7472 6561  features.isStrea
+0001c680: 6d69 6e67 0a20 2020 2020 2020 2029 3a0a  ming.        ):.
+0001c690: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+0001c6a0: 6520 5479 7065 4572 726f 7228 0a20 2020  e TypeError(.   
+0001c6b0: 2020 2020 2020 2020 2020 2020 2022 4665               "Fe
+0001c6c0: 6174 7572 6573 2068 6176 6520 746f 2062  atures have to b
+0001c6d0: 6520 6120 7374 7265 616d 696e 6720 7479  e a streaming ty
+0001c6e0: 7065 2073 7061 726b 2064 6174 6166 7261  pe spark datafra
+0001c6f0: 6d65 2e20 5573 6520 6069 6e73 6572 7428  me. Use `insert(
+0001c700: 2960 206d 6574 686f 6420 696e 7374 6561  )` method instea
+0001c710: 642e 220a 2020 2020 2020 2020 2020 2020  d.".            
+0001c720: 290a 2020 2020 2020 2020 656c 7365 3a0a  ).        else:.
+0001c730: 2020 2020 2020 2020 2020 2020 2320 6c6f              # lo
+0001c740: 7765 7220 6361 7369 6e67 2066 6561 7475  wer casing featu
+0001c750: 7265 206e 616d 6573 0a20 2020 2020 2020  re names.       
+0001c760: 2020 2020 2066 6561 7475 7265 5f64 6174       feature_dat
+0001c770: 6166 7261 6d65 203d 2065 6e67 696e 652e  aframe = engine.
+0001c780: 6765 745f 696e 7374 616e 6365 2829 2e63  get_instance().c
+0001c790: 6f6e 7665 7274 5f74 6f5f 6465 6661 756c  onvert_to_defaul
+0001c7a0: 745f 6461 7461 6672 616d 6528 0a20 2020  t_dataframe(.   
+0001c7b0: 2020 2020 2020 2020 2020 2020 2066 6561               fea
+0001c7c0: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
+0001c7d0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001c7e0: 7761 726e 696e 6773 2e77 6172 6e28 0a20  warnings.warn(. 
+0001c7f0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
+0001c800: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c810: 2020 2020 2022 5374 7265 616d 2069 6e67       "Stream ing
+0001c820: 6573 7469 6f6e 2066 6f72 2066 6561 7475  estion for featu
+0001c830: 7265 2067 726f 7570 2060 7b7d 602c 2077  re group `{}`, w
+0001c840: 6974 6820 7665 7273 696f 6e22 0a20 2020  ith version".   
+0001c850: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c860: 2022 2060 7b7d 6020 7769 6c6c 206e 6f74   " `{}` will not
+0001c870: 2063 6f6d 7075 7465 2073 7461 7469 7374   compute statist
+0001c880: 6963 732e 220a 2020 2020 2020 2020 2020  ics.".          
+0001c890: 2020 2020 2020 292e 666f 726d 6174 2873        ).format(s
+0001c8a0: 656c 662e 5f6e 616d 652c 2073 656c 662e  elf._name, self.
+0001c8b0: 5f76 6572 7369 6f6e 292c 0a20 2020 2020  _version),.     
+0001c8c0: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
+0001c8d0: 5374 6174 6973 7469 6373 5761 726e 696e  StatisticsWarnin
+0001c8e0: 672c 0a20 2020 2020 2020 2020 2020 2029  g,.            )
+0001c8f0: 0a0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0001c900: 7475 726e 2073 656c 662e 5f66 6561 7475  turn self._featu
+0001c910: 7265 5f67 726f 7570 5f65 6e67 696e 652e  re_group_engine.
+0001c920: 696e 7365 7274 5f73 7472 6561 6d28 0a20  insert_stream(. 
+0001c930: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001c940: 656c 662c 0a20 2020 2020 2020 2020 2020  elf,.           
+0001c950: 2020 2020 2066 6561 7475 7265 5f64 6174       feature_dat
+0001c960: 6166 7261 6d65 2c0a 2020 2020 2020 2020  aframe,.        
+0001c970: 2020 2020 2020 2020 7175 6572 795f 6e61          query_na
+0001c980: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0001c990: 2020 2020 6f75 7470 7574 5f6d 6f64 652c      output_mode,
+0001c9a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c9b0: 2061 7761 6974 5f74 6572 6d69 6e61 7469   await_terminati
+0001c9c0: 6f6e 2c0a 2020 2020 2020 2020 2020 2020  on,.            
+0001c9d0: 2020 2020 7469 6d65 6f75 742c 0a20 2020      timeout,.   
+0001c9e0: 2020 2020 2020 2020 2020 2020 2063 6865               che
+0001c9f0: 636b 706f 696e 745f 6469 722c 0a20 2020  ckpoint_dir,.   
+0001ca00: 2020 2020 2020 2020 2020 2020 2077 7269               wri
+0001ca10: 7465 5f6f 7074 696f 6e73 2c0a 2020 2020  te_options,.    
+0001ca20: 2020 2020 2020 2020 290a 0a20 2020 2064          )..    d
+0001ca30: 6566 2063 6f6d 6d69 745f 6465 7461 696c  ef commit_detail
+0001ca40: 7328 0a20 2020 2020 2020 2073 656c 662c  s(.        self,
+0001ca50: 0a20 2020 2020 2020 2077 616c 6c63 6c6f  .        wallclo
+0001ca60: 636b 5f74 696d 653a 204f 7074 696f 6e61  ck_time: Optiona
+0001ca70: 6c5b 556e 696f 6e5b 7374 722c 2069 6e74  l[Union[str, int
+0001ca80: 2c20 6461 7465 7469 6d65 2c20 6461 7465  , datetime, date
+0001ca90: 5d5d 203d 204e 6f6e 652c 0a20 2020 2020  ]] = None,.     
+0001caa0: 2020 206c 696d 6974 3a20 4f70 7469 6f6e     limit: Option
+0001cab0: 616c 5b69 6e74 5d20 3d20 4e6f 6e65 2c0a  al[int] = None,.
+0001cac0: 2020 2020 293a 0a20 2020 2020 2020 2022      ):.        "
+0001cad0: 2222 5265 7472 6965 7665 7320 636f 6d6d  ""Retrieves comm
+0001cae0: 6974 2074 696d 656c 696e 6520 666f 7220  it timeline for 
+0001caf0: 7468 6973 2066 6561 7475 7265 2067 726f  this feature gro
+0001cb00: 7570 2e20 5468 6973 206d 6574 686f 6420  up. This method 
+0001cb10: 6361 6e20 6f6e 6c79 2062 6520 7573 6564  can only be used
+0001cb20: 0a20 2020 2020 2020 206f 6e20 7469 6d65  .        on time
+0001cb30: 2074 7261 7665 6c20 656e 6162 6c65 6420   travel enabled 
+0001cb40: 6665 6174 7572 6520 6772 6f75 7073 0a0a  feature groups..
+0001cb50: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
+0001cb60: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
+0001cb70: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+0001cb80: 2020 2020 2020 2320 636f 6e6e 6563 7420        # connect 
+0001cb90: 746f 2074 6865 2046 6561 7475 7265 2053  to the Feature S
+0001cba0: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
+0001cbb0: 2066 7320 3d20 2e2e 2e0a 0a20 2020 2020   fs = .....     
+0001cbc0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
+0001cbd0: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
+0001cbe0: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
+0001cbf0: 2020 2020 6667 203d 2066 732e 6765 745f      fg = fs.get_
+0001cc00: 6f72 5f63 7265 6174 655f 6665 6174 7572  or_create_featur
+0001cc10: 655f 6772 6f75 7028 2e2e 2e29 0a0a 2020  e_group(...)..  
+0001cc20: 2020 2020 2020 2020 2020 636f 6d6d 6974            commit
+0001cc30: 5f64 6574 6169 6c73 203d 2066 672e 636f  _details = fg.co
+0001cc40: 6d6d 6974 5f64 6574 6169 6c73 2829 0a20  mmit_details(). 
+0001cc50: 2020 2020 2020 2020 2020 2060 6060 0a0a             ```..
+0001cc60: 2020 2020 2020 2020 2320 4172 6775 6d65          # Argume
+0001cc70: 6e74 730a 2020 2020 2020 2020 2020 2020  nts.            
+0001cc80: 7761 6c6c 636c 6f63 6b5f 7469 6d65 3a20  wallclock_time: 
+0001cc90: 436f 6d6d 6974 2064 6574 6169 6c73 2061  Commit details a
+0001cca0: 7320 6f66 2073 7065 6369 6669 6320 706f  s of specific po
+0001ccb0: 696e 7420 696e 2074 696d 652e 2044 6566  int in time. Def
+0001ccc0: 6175 6c74 7320 746f 2060 4e6f 6e65 602e  aults to `None`.
+0001ccd0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001cce0: 2020 5374 7269 6e67 7320 7368 6f75 6c64    Strings should
+0001ccf0: 2062 6520 666f 726d 6174 7465 6420 696e   be formatted in
+0001cd00: 206f 6e65 206f 6620 7468 6520 666f 6c6c   one of the foll
+0001cd10: 6f77 696e 6720 666f 726d 6174 7320 6025  owing formats `%
+0001cd20: 592d 256d 2d25 6460 2c20 6025 592d 256d  Y-%m-%d`, `%Y-%m
+0001cd30: 2d25 6420 2548 602c 2060 2559 2d25 6d2d  -%d %H`, `%Y-%m-
+0001cd40: 2564 2025 483a 254d 602c 0a20 2020 2020  %d %H:%M`,.     
+0001cd50: 2020 2020 2020 2020 2020 2060 2559 2d25             `%Y-%
+0001cd60: 6d2d 2564 2025 483a 254d 3a25 5360 2c20  m-%d %H:%M:%S`, 
+0001cd70: 6f72 2060 2559 2d25 6d2d 2564 2025 483a  or `%Y-%m-%d %H:
+0001cd80: 254d 3a25 532e 2566 602e 0a20 2020 2020  %M:%S.%f`..     
+0001cd90: 2020 2020 2020 206c 696d 6974 3a20 4e75         limit: Nu
+0001cda0: 6d62 6572 206f 6620 636f 6d6d 6974 7320  mber of commits 
+0001cdb0: 746f 2072 6574 7269 6576 652e 2044 6566  to retrieve. Def
+0001cdc0: 6175 6c74 7320 746f 2060 4e6f 6e65 602e  aults to `None`.
+0001cdd0: 0a0a 2020 2020 2020 2020 2320 5265 7475  ..        # Retu
+0001cde0: 726e 730a 2020 2020 2020 2020 2020 2020  rns.            
+0001cdf0: 6044 6963 745b 7374 722c 2044 6963 745b  `Dict[str, Dict[
+0001ce00: 7374 722c 2073 7472 5d5d 602e 2044 6963  str, str]]`. Dic
+0001ce10: 7469 6f6e 6172 7920 6f62 6a65 6374 206f  tionary object o
+0001ce20: 6620 636f 6d6d 6974 206d 6574 6164 6174  f commit metadat
+0001ce30: 6120 7469 6d65 6c69 6e65 2c20 7768 6572  a timeline, wher
+0001ce40: 6520 4b65 7920 6973 2063 6f6d 6d69 7420  e Key is commit 
+0001ce50: 6964 2061 6e64 2076 616c 7565 0a20 2020  id and value.   
+0001ce60: 2020 2020 2020 2020 2069 7320 6044 6963           is `Dic
+0001ce70: 745b 7374 722c 2073 7472 5d60 2077 6974  t[str, str]` wit
+0001ce80: 6820 6b65 7920 7661 6c75 6520 7061 6972  h key value pair
+0001ce90: 7320 6f66 2064 6174 6520 636f 6d6d 6974  s of date commit
+0001cea0: 7465 6420 6f6e 2c20 6e75 6d62 6572 206f  ted on, number o
+0001ceb0: 6620 726f 7773 2075 7064 6174 6564 2c20  f rows updated, 
+0001cec0: 696e 7365 7274 6564 2061 6e64 2064 656c  inserted and del
+0001ced0: 6574 6564 2e0a 0a20 2020 2020 2020 2023  eted...        #
+0001cee0: 2052 6169 7365 730a 2020 2020 2020 2020   Raises.        
+0001cef0: 2020 2020 6068 7366 732e 636c 6965 6e74      `hsfs.client
+0001cf00: 2e65 7863 6570 7469 6f6e 732e 5265 7374  .exceptions.Rest
+0001cf10: 4150 4945 7272 6f72 602e 0a20 2020 2020  APIError`..     
+0001cf20: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
+0001cf30: 656e 742e 6578 6365 7074 696f 6e73 2e46  ent.exceptions.F
+0001cf40: 6561 7475 7265 5374 6f72 6545 7863 6570  eatureStoreExcep
+0001cf50: 7469 6f6e 602e 2049 6620 7468 6520 6665  tion`. If the fe
+0001cf60: 6174 7572 6520 6772 6f75 7020 646f 6573  ature group does
+0001cf70: 206e 6f74 2068 6176 6520 6048 5544 4960   not have `HUDI`
+0001cf80: 2074 696d 6520 7472 6176 656c 2066 6f72   time travel for
+0001cf90: 6d61 740a 2020 2020 2020 2020 2222 220a  mat.        """.
+0001cfa0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+0001cfb0: 656c 662e 5f66 6561 7475 7265 5f67 726f  elf._feature_gro
+0001cfc0: 7570 5f65 6e67 696e 652e 636f 6d6d 6974  up_engine.commit
+0001cfd0: 5f64 6574 6169 6c73 2873 656c 662c 2077  _details(self, w
+0001cfe0: 616c 6c63 6c6f 636b 5f74 696d 652c 206c  allclock_time, l
+0001cff0: 696d 6974 290a 0a20 2020 2064 6566 2063  imit)..    def c
+0001d000: 6f6d 6d69 745f 6465 6c65 7465 5f72 6563  ommit_delete_rec
+0001d010: 6f72 6428 0a20 2020 2020 2020 2073 656c  ord(.        sel
+0001d020: 662c 0a20 2020 2020 2020 2064 656c 6574  f,.        delet
+0001d030: 655f 6466 3a20 5479 7065 5661 7228 2270  e_df: TypeVar("p
+0001d040: 7973 7061 726b 2e73 716c 2e44 6174 6146  yspark.sql.DataF
+0001d050: 7261 6d65 2229 2c20 2023 206e 6f71 613a  rame"),  # noqa:
+0001d060: 2046 3832 310a 2020 2020 2020 2020 7772   F821.        wr
+0001d070: 6974 655f 6f70 7469 6f6e 733a 204f 7074  ite_options: Opt
+0001d080: 696f 6e61 6c5b 4469 6374 5b41 6e79 2c20  ional[Dict[Any, 
+0001d090: 416e 795d 5d20 3d20 7b7d 2c0a 2020 2020  Any]] = {},.    
+0001d0a0: 293a 0a20 2020 2020 2020 2022 2222 4472  ):.        """Dr
+0001d0b0: 6f70 7320 7265 636f 7264 7320 7072 6573  ops records pres
+0001d0c0: 656e 7420 696e 2074 6865 2070 726f 7669  ent in the provi
+0001d0d0: 6465 6420 4461 7461 4672 616d 6520 616e  ded DataFrame an
+0001d0e0: 6420 636f 6d6d 6974 7320 6974 2061 7320  d commits it as 
+0001d0f0: 7570 6461 7465 2074 6f20 7468 6973 0a20  update to this. 
+0001d100: 2020 2020 2020 2046 6561 7475 7265 2067         Feature g
+0001d110: 726f 7570 2e20 5468 6973 206d 6574 686f  roup. This metho
+0001d120: 6420 6361 6e20 6f6e 6c79 2062 6520 7573  d can only be us
+0001d130: 6564 206f 6e20 6665 6174 7572 6520 6772  ed on feature gr
+0001d140: 6f75 7073 2073 746f 7265 6420 6173 2048  oups stored as H
+0001d150: 5544 4920 6f72 2044 454c 5441 2e0a 0a20  UDI or DELTA... 
+0001d160: 2020 2020 2020 2023 2041 7267 756d 656e         # Argumen
+0001d170: 7473 0a20 2020 2020 2020 2020 2020 2064  ts.            d
+0001d180: 656c 6574 655f 6466 3a20 6461 7461 4672  elete_df: dataFr
+0001d190: 616d 6520 636f 6e74 6169 6e69 6e67 2072  ame containing r
+0001d1a0: 6563 6f72 6473 2074 6f20 6265 2064 656c  ecords to be del
+0001d1b0: 6574 6564 2e0a 2020 2020 2020 2020 2020  eted..          
+0001d1c0: 2020 7772 6974 655f 6f70 7469 6f6e 733a    write_options:
+0001d1d0: 2055 7365 7220 7072 6f76 6964 6564 2077   User provided w
+0001d1e0: 7269 7465 206f 7074 696f 6e73 2e20 4465  rite options. De
+0001d1f0: 6661 756c 7473 2074 6f20 607b 7d60 2e0a  faults to `{}`..
+0001d200: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
+0001d210: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
+0001d220: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+0001d230: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
+0001d240: 6f72 602e 0a20 2020 2020 2020 2022 2222  or`..        """
+0001d250: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+0001d260: 6561 7475 7265 5f67 726f 7570 5f65 6e67  eature_group_eng
+0001d270: 696e 652e 636f 6d6d 6974 5f64 656c 6574  ine.commit_delet
+0001d280: 6528 7365 6c66 2c20 6465 6c65 7465 5f64  e(self, delete_d
+0001d290: 662c 2077 7269 7465 5f6f 7074 696f 6e73  f, write_options
+0001d2a0: 290a 0a20 2020 2064 6566 2061 735f 6f66  )..    def as_of
+0001d2b0: 280a 2020 2020 2020 2020 7365 6c66 2c0a  (.        self,.
+0001d2c0: 2020 2020 2020 2020 7761 6c6c 636c 6f63          wallcloc
+0001d2d0: 6b5f 7469 6d65 3a20 4f70 7469 6f6e 616c  k_time: Optional
+0001d2e0: 5b55 6e69 6f6e 5b73 7472 2c20 696e 742c  [Union[str, int,
+0001d2f0: 2064 6174 6574 696d 652c 2064 6174 655d   datetime, date]
+0001d300: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0001d310: 2020 6578 636c 7564 655f 756e 7469 6c3a    exclude_until:
+0001d320: 204f 7074 696f 6e61 6c5b 556e 696f 6e5b   Optional[Union[
+0001d330: 7374 722c 2069 6e74 2c20 6461 7465 7469  str, int, dateti
+0001d340: 6d65 2c20 6461 7465 5d5d 203d 204e 6f6e  me, date]] = Non
+0001d350: 652c 0a20 2020 2029 3a0a 2020 2020 2020  e,.    ):.      
+0001d360: 2020 2222 2247 6574 2051 7565 7279 206f    """Get Query o
+0001d370: 626a 6563 7420 746f 2072 6574 7269 6576  bject to retriev
+0001d380: 6520 616c 6c20 6665 6174 7572 6573 206f  e all features o
+0001d390: 6620 7468 6520 6772 6f75 7020 6174 2061  f the group at a
+0001d3a0: 2070 6f69 6e74 2069 6e20 7468 6520 7061   point in the pa
+0001d3b0: 7374 2e0a 0a20 2020 2020 2020 2054 6869  st...        Thi
+0001d3c0: 7320 6d65 7468 6f64 2073 656c 6563 7473  s method selects
+0001d3d0: 2061 6c6c 2066 6561 7475 7265 7320 696e   all features in
+0001d3e0: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+0001d3f0: 7570 2061 6e64 2072 6574 7572 6e73 2061  up and returns a
+0001d400: 2051 7565 7279 206f 626a 6563 740a 2020   Query object.  
+0001d410: 2020 2020 2020 6174 2074 6865 2073 7065        at the spe
+0001d420: 6369 6669 6564 2070 6f69 6e74 2069 6e20  cified point in 
+0001d430: 7469 6d65 2e20 4f70 7469 6f6e 616c 6c79  time. Optionally
+0001d440: 2c20 636f 6d6d 6974 7320 6265 666f 7265  , commits before
+0001d450: 2061 2073 7065 6369 6669 6564 2070 6f69   a specified poi
+0001d460: 6e74 2069 6e20 7469 6d65 2063 616e 2062  nt in time can b
+0001d470: 650a 2020 2020 2020 2020 6578 636c 7564  e.        exclud
+0001d480: 6564 2066 726f 6d20 7468 6520 7175 6572  ed from the quer
+0001d490: 792e 2054 6865 2051 7565 7279 2063 616e  y. The Query can
+0001d4a0: 2074 6865 6e20 6569 7468 6572 2062 6520   then either be 
+0001d4b0: 7265 6164 2069 6e74 6f20 6120 4461 7461  read into a Data
+0001d4c0: 6672 616d 650a 2020 2020 2020 2020 6f72  frame.        or
+0001d4d0: 2075 7365 6420 6675 7274 6865 7220 746f   used further to
+0001d4e0: 2070 6572 666f 726d 206a 6f69 6e73 206f   perform joins o
+0001d4f0: 7220 636f 6e73 7472 7563 7420 6120 7472  r construct a tr
+0001d500: 6169 6e69 6e67 2064 6174 6173 6574 2e0a  aining dataset..
+0001d510: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+0001d520: 6d70 6c65 2022 5265 6164 696e 6720 6665  mple "Reading fe
+0001d530: 6174 7572 6573 2061 7420 6120 7370 6563  atures at a spec
+0001d540: 6966 6963 2070 6f69 6e74 2069 6e20 7469  ific point in ti
+0001d550: 6d65 3a22 0a20 2020 2020 2020 2020 2020  me:".           
+0001d560: 2060 6060 7079 7468 6f6e 0a20 2020 2020   ```python.     
+0001d570: 2020 2020 2020 2023 2063 6f6e 6e65 6374         # connect
+0001d580: 2074 6f20 7468 6520 4665 6174 7572 6520   to the Feature 
+0001d590: 5374 6f72 650a 2020 2020 2020 2020 2020  Store.          
+0001d5a0: 2020 6673 203d 202e 2e2e 0a0a 2020 2020    fs = .....    
+0001d5b0: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+0001d5c0: 6520 4665 6174 7572 6520 4772 6f75 7020  e Feature Group 
+0001d5d0: 696e 7374 616e 6365 0a20 2020 2020 2020  instance.       
+0001d5e0: 2020 2020 2066 6720 3d20 6673 2e67 6574       fg = fs.get
+0001d5f0: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+0001d600: 7265 5f67 726f 7570 282e 2e2e 290a 0a20  re_group(...).. 
+0001d610: 2020 2020 2020 2020 2020 2023 2067 6574             # get
+0001d620: 2064 6174 6120 6174 2061 2073 7065 6369   data at a speci
+0001d630: 6669 6320 706f 696e 7420 696e 2074 696d  fic point in tim
+0001d640: 6520 616e 6420 7368 6f77 2069 740a 2020  e and show it.  
+0001d650: 2020 2020 2020 2020 2020 6667 2e61 735f            fg.as_
+0001d660: 6f66 2822 3230 3230 2d31 302d 3230 2030  of("2020-10-20 0
+0001d670: 373a 3334 3a31 3122 292e 7265 6164 2829  7:34:11").read()
+0001d680: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0001d690: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
+0001d6a0: 2021 2121 2065 7861 6d70 6c65 2022 5265   !!! example "Re
+0001d6b0: 6164 696e 6720 636f 6d6d 6974 7320 696e  ading commits in
+0001d6c0: 6372 656d 656e 7461 6c6c 7920 6265 7477  crementally betw
+0001d6d0: 6565 6e20 7370 6563 6966 6965 6420 706f  een specified po
+0001d6e0: 696e 7473 2069 6e20 7469 6d65 3a22 0a20  ints in time:". 
+0001d6f0: 2020 2020 2020 2020 2020 2060 6060 7079             ```py
+0001d700: 7468 6f6e 0a20 2020 2020 2020 2020 2020  thon.           
+0001d710: 2066 672e 6173 5f6f 6628 2232 3032 302d   fg.as_of("2020-
+0001d720: 3130 2d32 3020 3037 3a33 343a 3131 222c  10-20 07:34:11",
+0001d730: 2065 7863 6c75 6465 5f75 6e74 696c 3d22   exclude_until="
+0001d740: 3230 3230 2d31 302d 3139 2030 373a 3334  2020-10-19 07:34
+0001d750: 3a31 3122 292e 7265 6164 2829 2e73 686f  :11").read().sho
+0001d760: 7728 290a 2020 2020 2020 2020 2020 2020  w().            
+0001d770: 6060 600a 0a20 2020 2020 2020 2054 6865  ```..        The
+0001d780: 2066 6972 7374 2070 6172 616d 6574 6572   first parameter
+0001d790: 2069 7320 696e 636c 7573 6976 6520 7768   is inclusive wh
+0001d7a0: 696c 6520 7468 6520 6c61 7474 6572 2069  ile the latter i
+0001d7b0: 7320 6578 636c 7573 6976 652e 0a20 2020  s exclusive..   
+0001d7c0: 2020 2020 2054 6861 7420 6d65 616e 732c       That means,
+0001d7d0: 2069 6e20 6f72 6465 7220 746f 2071 7565   in order to que
+0001d7e0: 7279 2061 2073 696e 676c 6520 636f 6d6d  ry a single comm
+0001d7f0: 6974 2c20 796f 7520 6e65 6564 2074 6f20  it, you need to 
+0001d800: 7175 6572 7920 7468 6174 2063 6f6d 6d69  query that commi
+0001d810: 7420 7469 6d65 0a20 2020 2020 2020 2061  t time.        a
+0001d820: 6e64 2065 7863 6c75 6465 2065 7665 7279  nd exclude every
+0001d830: 7468 696e 6720 6a75 7374 2062 6566 6f72  thing just befor
+0001d840: 6520 7468 6520 636f 6d6d 6974 2e0a 0a20  e the commit... 
+0001d850: 2020 2020 2020 2021 2121 2065 7861 6d70         !!! examp
+0001d860: 6c65 2022 5265 6164 696e 6720 6f6e 6c79  le "Reading only
+0001d870: 2074 6865 2063 6861 6e67 6573 2066 726f   the changes fro
+0001d880: 6d20 6120 7369 6e67 6c65 2063 6f6d 6d69  m a single commi
+0001d890: 7422 0a20 2020 2020 2020 2020 2020 2060  t".            `
+0001d8a0: 6060 7079 7468 6f6e 0a20 2020 2020 2020  ``python.       
+0001d8b0: 2020 2020 2066 672e 6173 5f6f 6628 2232       fg.as_of("2
+0001d8c0: 3032 302d 3130 2d32 3020 3037 3a33 313a  020-10-20 07:31:
+0001d8d0: 3338 222c 2065 7863 6c75 6465 5f75 6e74  38", exclude_unt
+0001d8e0: 696c 3d22 3230 3230 2d31 302d 3230 2030  il="2020-10-20 0
+0001d8f0: 373a 3331 3a33 3722 292e 7265 6164 2829  7:31:37").read()
+0001d900: 2e73 686f 7728 290a 2020 2020 2020 2020  .show().        
+0001d910: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
+0001d920: 2057 6865 6e20 6e6f 2077 616c 6c63 6c6f   When no wallclo
+0001d930: 636b 5f74 696d 6520 6973 2067 6976 656e  ck_time is given
+0001d940: 2c20 7468 6520 6c61 7465 7374 2073 7461  , the latest sta
+0001d950: 7465 206f 6620 6665 6174 7572 6573 2069  te of features i
+0001d960: 7320 7265 7475 726e 6564 2e20 4f70 7469  s returned. Opti
+0001d970: 6f6e 616c 6c79 2c20 636f 6d6d 6974 7320  onally, commits 
+0001d980: 6265 666f 7265 0a20 2020 2020 2020 2061  before.        a
+0001d990: 2073 7065 6369 6669 6564 2070 6f69 6e74   specified point
+0001d9a0: 2069 6e20 7469 6d65 2063 616e 2073 7469   in time can sti
+0001d9b0: 6c6c 2062 6520 6578 636c 7564 6564 2e0a  ll be excluded..
+0001d9c0: 0a20 2020 2020 2020 2021 2121 2065 7861  .        !!! exa
+0001d9d0: 6d70 6c65 2022 5265 6164 696e 6720 7468  mple "Reading th
+0001d9e0: 6520 6c61 7465 7374 2073 7461 7465 206f  e latest state o
+0001d9f0: 6620 6665 6174 7572 6573 2c20 6578 636c  f features, excl
+0001da00: 7564 696e 6720 636f 6d6d 6974 7320 6265  uding commits be
+0001da10: 666f 7265 2061 2073 7065 6369 6669 6564  fore a specified
+0001da20: 2070 6f69 6e74 2069 6e20 7469 6d65 3a22   point in time:"
+0001da30: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+0001da40: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+0001da50: 2020 2066 672e 6173 5f6f 6628 4e6f 6e65     fg.as_of(None
+0001da60: 2c20 6578 636c 7564 655f 756e 7469 6c3d  , exclude_until=
+0001da70: 2232 3032 302d 3130 2d32 3020 3037 3a33  "2020-10-20 07:3
+0001da80: 313a 3338 2229 2e72 6561 6428 292e 7368  1:38").read().sh
+0001da90: 6f77 2829 0a20 2020 2020 2020 2020 2020  ow().           
+0001daa0: 2060 6060 0a0a 2020 2020 2020 2020 4e6f   ```..        No
+0001dab0: 7465 2074 6861 7420 7468 6520 696e 7465  te that the inte
+0001dac0: 7276 616c 2077 696c 6c20 6265 2061 7070  rval will be app
+0001dad0: 6c69 6564 2074 6f20 616c 6c20 6a6f 696e  lied to all join
+0001dae0: 7320 696e 2074 6865 2071 7565 7279 2e0a  s in the query..
+0001daf0: 2020 2020 2020 2020 4966 2079 6f75 2077          If you w
+0001db00: 616e 7420 746f 2071 7565 7279 2064 6966  ant to query dif
+0001db10: 6665 7265 6e74 2069 6e74 6572 7661 6c73  ferent intervals
+0001db20: 2066 6f72 2064 6966 6665 7265 6e74 2066   for different f
+0001db30: 6561 7475 7265 2067 726f 7570 7320 696e  eature groups in
+0001db40: 0a20 2020 2020 2020 2074 6865 2071 7565  .        the que
+0001db50: 7279 2c20 796f 7520 6861 7665 2074 6f20  ry, you have to 
+0001db60: 6170 706c 7920 7468 656d 2069 6e20 6120  apply them in a 
+0001db70: 6e65 7374 6564 2066 6173 6869 6f6e 3a0a  nested fashion:.
+0001db80: 2020 2020 2020 2020 2121 2120 6578 616d          !!! exam
+0001db90: 706c 650a 2020 2020 2020 2020 2020 2020  ple.            
+0001dba0: 6060 6070 7974 686f 6e0a 2020 2020 2020  ```python.      
+0001dbb0: 2020 2020 2020 2320 636f 6e6e 6563 7420        # connect 
+0001dbc0: 746f 2074 6865 2046 6561 7475 7265 2053  to the Feature S
+0001dbd0: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
+0001dbe0: 2066 7320 3d20 2e2e 2e0a 0a20 2020 2020   fs = .....     
+0001dbf0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
+0001dc00: 2046 6561 7475 7265 2047 726f 7570 2069   Feature Group i
+0001dc10: 6e73 7461 6e63 650a 2020 2020 2020 2020  nstance.        
+0001dc20: 2020 2020 6667 3120 3d20 6673 2e67 6574      fg1 = fs.get
+0001dc30: 5f6f 725f 6372 6561 7465 5f66 6561 7475  _or_create_featu
+0001dc40: 7265 5f67 726f 7570 282e 2e2e 290a 2020  re_group(...).  
+0001dc50: 2020 2020 2020 2020 2020 6667 3220 3d20            fg2 = 
+0001dc60: 6673 2e67 6574 5f6f 725f 6372 6561 7465  fs.get_or_create
+0001dc70: 5f66 6561 7475 7265 5f67 726f 7570 282e  _feature_group(.
+0001dc80: 2e2e 290a 0a20 2020 2020 2020 2020 2020  ..)..           
+0001dc90: 2066 6731 2e73 656c 6563 745f 616c 6c28   fg1.select_all(
+0001dca0: 292e 6173 5f6f 6628 2232 3032 302d 3130  ).as_of("2020-10
+0001dcb0: 2d32 3022 2c20 6578 636c 7564 655f 756e  -20", exclude_un
+0001dcc0: 7469 6c3d 2232 3032 302d 3130 2d31 3922  til="2020-10-19"
+0001dcd0: 290a 2020 2020 2020 2020 2020 2020 2020  ).              
+0001dce0: 2020 2e6a 6f69 6e28 6667 322e 7365 6c65    .join(fg2.sele
+0001dcf0: 6374 5f61 6c6c 2829 2e61 735f 6f66 2822  ct_all().as_of("
+0001dd00: 3230 3230 2d31 302d 3230 222c 2065 7863  2020-10-20", exc
+0001dd10: 6c75 6465 5f75 6e74 696c 3d22 3230 3230  lude_until="2020
+0001dd20: 2d31 302d 3139 2229 290a 2020 2020 2020  -10-19")).      
+0001dd30: 2020 2020 2020 6060 600a 0a20 2020 2020        ```..     
+0001dd40: 2020 2049 6620 696e 7374 6561 6420 796f     If instead yo
+0001dd50: 7520 6170 706c 7920 616e 6f74 6865 7220  u apply another 
+0001dd60: 6061 735f 6f66 6020 7365 6c65 6374 696f  `as_of` selectio
+0001dd70: 6e20 6166 7465 7220 7468 6520 6a6f 696e  n after the join
+0001dd80: 2c20 616c 6c0a 2020 2020 2020 2020 6a6f  , all.        jo
+0001dd90: 696e 6564 2066 6561 7475 7265 2067 726f  ined feature gro
+0001dda0: 7570 7320 7769 6c6c 2062 6520 7175 6572  ups will be quer
+0001ddb0: 6965 6420 7769 7468 2074 6869 7320 696e  ied with this in
+0001ddc0: 7465 7276 616c 3a0a 2020 2020 2020 2020  terval:.        
+0001ddd0: 2121 2120 6578 616d 706c 650a 2020 2020  !!! example.    
+0001dde0: 2020 2020 2020 2020 6060 6070 7974 686f          ```pytho
+0001ddf0: 6e0a 2020 2020 2020 2020 2020 2020 6667  n.            fg
+0001de00: 312e 7365 6c65 6374 5f61 6c6c 2829 2e61  1.select_all().a
+0001de10: 735f 6f66 2822 3230 3230 2d31 302d 3230  s_of("2020-10-20
+0001de20: 222c 2065 7863 6c75 6465 5f75 6e74 696c  ", exclude_until
+0001de30: 3d22 3230 3230 2d31 302d 3139 2229 2020  ="2020-10-19")  
+0001de40: 2320 6173 5f6f 6620 6973 206e 6f74 2061  # as_of is not a
+0001de50: 7070 6c69 6564 0a20 2020 2020 2020 2020  pplied.         
+0001de60: 2020 2020 2020 202e 6a6f 696e 2866 6732         .join(fg2
+0001de70: 2e73 656c 6563 745f 616c 6c28 292e 6173  .select_all().as
+0001de80: 5f6f 6628 2232 3032 302d 3130 2d32 3022  _of("2020-10-20"
+0001de90: 2c20 6578 636c 7564 655f 756e 7469 6c3d  , exclude_until=
+0001dea0: 2232 3032 302d 3130 2d31 3522 2929 2020  "2020-10-15"))  
+0001deb0: 2320 6173 5f6f 6620 6973 206e 6f74 2061  # as_of is not a
+0001dec0: 7070 6c69 6564 0a20 2020 2020 2020 2020  pplied.         
+0001ded0: 2020 2020 2020 202e 6173 5f6f 6628 2232         .as_of("2
+0001dee0: 3032 302d 3130 2d32 3022 2c20 6578 636c  020-10-20", excl
+0001def0: 7564 655f 756e 7469 6c3d 2232 3032 302d  ude_until="2020-
+0001df00: 3130 2d31 3922 290a 2020 2020 2020 2020  10-19").        
+0001df10: 2020 2020 6060 600a 0a20 2020 2020 2020      ```..       
+0001df20: 2021 2121 2077 6172 6e69 6e67 0a20 2020   !!! warning.   
+0001df30: 2020 2020 2020 2020 2054 6869 7320 6675           This fu
+0001df40: 6e63 7469 6f6e 206f 6e6c 7920 776f 726b  nction only work
+0001df50: 7320 666f 7220 6665 6174 7572 6520 6772  s for feature gr
+0001df60: 6f75 7073 2077 6974 6820 7469 6d65 5f74  oups with time_t
+0001df70: 7261 7665 6c5f 666f 726d 6174 3d27 4855  ravel_format='HU
+0001df80: 4449 272e 0a0a 2020 2020 2020 2020 2121  DI'...        !!
+0001df90: 2120 7761 726e 696e 670a 2020 2020 2020  ! warning.      
+0001dfa0: 2020 2020 2020 4578 636c 7564 696e 6720        Excluding 
+0001dfb0: 636f 6d6d 6974 7320 7669 6120 6578 636c  commits via excl
+0001dfc0: 7564 655f 756e 7469 6c20 6973 206f 6e6c  ude_until is onl
+0001dfd0: 7920 706f 7373 6962 6c65 2077 6974 6869  y possible withi
+0001dfe0: 6e20 7468 6520 7261 6e67 6520 6f66 2074  n the range of t
+0001dff0: 6865 2048 7564 6920 6163 7469 7665 2074  he Hudi active t
+0001e000: 696d 656c 696e 652e 0a20 2020 2020 2020  imeline..       
+0001e010: 2020 2020 2042 7920 6465 6661 756c 742c       By default,
+0001e020: 2048 7564 6920 6b65 6570 7320 7468 6520   Hudi keeps the 
+0001e030: 6c61 7374 2032 3020 746f 2033 3020 636f  last 20 to 30 co
+0001e040: 6d6d 6974 7320 696e 2074 6865 2061 6374  mmits in the act
+0001e050: 6976 6520 7469 6d65 6c69 6e65 2e0a 2020  ive timeline..  
+0001e060: 2020 2020 2020 2020 2020 4966 2079 6f75            If you
+0001e070: 206e 6565 6420 746f 206b 6565 7020 6120   need to keep a 
+0001e080: 6c6f 6e67 6572 2061 6374 6976 6520 7469  longer active ti
+0001e090: 6d65 6c69 6e65 2c20 796f 7520 6361 6e20  meline, you can 
+0001e0a0: 6f76 6572 7772 6974 6520 7468 6520 6f70  overwrite the op
+0001e0b0: 7469 6f6e 733a 0a20 2020 2020 2020 2020  tions:.         
+0001e0c0: 2020 2060 686f 6f64 6965 2e6b 6565 702e     `hoodie.keep.
+0001e0d0: 6d69 6e2e 636f 6d6d 6974 7360 2061 6e64  min.commits` and
+0001e0e0: 2060 686f 6f64 6965 2e6b 6565 702e 6d61   `hoodie.keep.ma
+0001e0f0: 782e 636f 6d6d 6974 7360 0a20 2020 2020  x.commits`.     
+0001e100: 2020 2020 2020 2077 6865 6e20 6361 6c6c         when call
+0001e110: 696e 6720 7468 6520 6069 6e73 6572 7428  ing the `insert(
+0001e120: 2960 206d 6574 686f 642e 0a0a 2020 2020  )` method...    
+0001e130: 2020 2020 2320 4172 6775 6d65 6e74 730a      # Arguments.
+0001e140: 2020 2020 2020 2020 2020 2020 7761 6c6c              wall
+0001e150: 636c 6f63 6b5f 7469 6d65 3a20 5265 6164  clock_time: Read
+0001e160: 2064 6174 6120 6173 206f 6620 7468 6973   data as of this
+0001e170: 2070 6f69 6e74 2069 6e20 7469 6d65 2e20   point in time. 
+0001e180: 5374 7269 6e67 7320 7368 6f75 6c64 2062  Strings should b
+0001e190: 6520 666f 726d 6174 7465 6420 696e 206f  e formatted in o
+0001e1a0: 6e65 206f 6620 7468 650a 2020 2020 2020  ne of the.      
+0001e1b0: 2020 2020 2020 2020 2020 666f 6c6c 6f77            follow
+0001e1c0: 696e 6720 666f 726d 6174 7320 6025 592d  ing formats `%Y-
+0001e1d0: 256d 2d25 6460 2c20 6025 592d 256d 2d25  %m-%d`, `%Y-%m-%
+0001e1e0: 6420 2548 602c 2060 2559 2d25 6d2d 2564  d %H`, `%Y-%m-%d
+0001e1f0: 2025 483a 254d 602c 206f 7220 6025 592d   %H:%M`, or `%Y-
+0001e200: 256d 2d25 6420 2548 3a25 4d3a 2553 602e  %m-%d %H:%M:%S`.
+0001e210: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
+0001e220: 6c75 6465 5f75 6e74 696c 3a20 4578 636c  lude_until: Excl
+0001e230: 7564 6520 636f 6d6d 6974 7320 756e 7469  ude commits unti
+0001e240: 6c20 7468 6973 2070 6f69 6e74 2069 6e20  l this point in 
+0001e250: 7469 6d65 2e20 5374 7269 6e67 2073 686f  time. String sho
+0001e260: 756c 6420 6265 2066 6f72 6d61 7474 6564  uld be formatted
+0001e270: 2069 6e20 6f6e 6520 6f66 2074 6865 0a20   in one of the. 
+0001e280: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001e290: 6f6c 6c6f 7769 6e67 2066 6f72 6d61 7473  ollowing formats
+0001e2a0: 2060 2559 2d25 6d2d 2564 602c 2060 2559   `%Y-%m-%d`, `%Y
+0001e2b0: 2d25 6d2d 2564 2025 4860 2c20 6025 592d  -%m-%d %H`, `%Y-
+0001e2c0: 256d 2d25 6420 2548 3a25 4d60 2c20 6f72  %m-%d %H:%M`, or
+0001e2d0: 2060 2559 2d25 6d2d 2564 2025 483a 254d   `%Y-%m-%d %H:%M
+0001e2e0: 3a25 5360 2e0a 0a20 2020 2020 2020 2023  :%S`...        #
+0001e2f0: 2052 6574 7572 6e73 0a20 2020 2020 2020   Returns.       
+0001e300: 2020 2020 2060 5175 6572 7960 2e20 5468       `Query`. Th
+0001e310: 6520 7175 6572 7920 6f62 6a65 6374 2077  e query object w
+0001e320: 6974 6820 7468 6520 6170 706c 6965 6420  ith the applied 
+0001e330: 7469 6d65 2074 7261 7665 6c20 636f 6e64  time travel cond
+0001e340: 6974 696f 6e2e 0a20 2020 2020 2020 2022  ition..        "
+0001e350: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+0001e360: 6e20 7365 6c66 2e73 656c 6563 745f 616c  n self.select_al
+0001e370: 6c28 292e 6173 5f6f 6628 0a20 2020 2020  l().as_of(.     
+0001e380: 2020 2020 2020 2077 616c 6c63 6c6f 636b         wallclock
+0001e390: 5f74 696d 653d 7761 6c6c 636c 6f63 6b5f  _time=wallclock_
+0001e3a0: 7469 6d65 2c20 6578 636c 7564 655f 756e  time, exclude_un
+0001e3b0: 7469 6c3d 6578 636c 7564 655f 756e 7469  til=exclude_unti
+0001e3c0: 6c0a 2020 2020 2020 2020 290a 0a20 2020  l.        )..   
+0001e3d0: 2064 6566 2067 6574 5f73 7461 7469 7374   def get_statist
+0001e3e0: 6963 735f 6279 5f63 6f6d 6d69 745f 7769  ics_by_commit_wi
+0001e3f0: 6e64 6f77 280a 2020 2020 2020 2020 7365  ndow(.        se
+0001e400: 6c66 2c0a 2020 2020 2020 2020 6672 6f6d  lf,.        from
+0001e410: 5f63 6f6d 6d69 745f 7469 6d65 3a20 4f70  _commit_time: Op
+0001e420: 7469 6f6e 616c 5b55 6e69 6f6e 5b73 7472  tional[Union[str
+0001e430: 2c20 696e 742c 2064 6174 6574 696d 652c  , int, datetime,
+0001e440: 2064 6174 655d 5d20 3d20 4e6f 6e65 2c0a   date]] = None,.
+0001e450: 2020 2020 2020 2020 746f 5f63 6f6d 6d69          to_commi
+0001e460: 745f 7469 6d65 3a20 4f70 7469 6f6e 616c  t_time: Optional
+0001e470: 5b55 6e69 6f6e 5b73 7472 2c20 696e 742c  [Union[str, int,
+0001e480: 2064 6174 6574 696d 652c 2064 6174 655d   datetime, date]
+0001e490: 5d20 3d20 4e6f 6e65 2c0a 2020 2020 2020  ] = None,.      
+0001e4a0: 2020 6665 6174 7572 655f 6e61 6d65 733a    feature_names:
+0001e4b0: 204f 7074 696f 6e61 6c5b 4c69 7374 5b73   Optional[List[s
+0001e4c0: 7472 5d5d 203d 204e 6f6e 652c 0a20 2020  tr]] = None,.   
+0001e4d0: 2029 3a0a 2020 2020 2020 2020 2222 2252   ):.        """R
+0001e4e0: 6574 7572 6e73 2074 6865 2073 7461 7469  eturns the stati
+0001e4f0: 7374 6963 7320 636f 6d70 7574 6564 206f  stics computed o
+0001e500: 6e20 6120 7370 6563 6966 6963 2063 6f6d  n a specific com
+0001e510: 6d69 7420 7769 6e64 6f77 2066 6f72 2074  mit window for t
+0001e520: 6869 7320 6665 6174 7572 6520 6772 6f75  his feature grou
+0001e530: 702e 2049 6620 7469 6d65 2074 7261 7665  p. If time trave
+0001e540: 6c20 6973 206e 6f74 2065 6e61 626c 6564  l is not enabled
+0001e550: 2c20 6974 2072 6169 7365 7320 616e 2065  , it raises an e
+0001e560: 7863 6570 7469 6f6e 2e0a 0a20 2020 2020  xception...     
+0001e570: 2020 2049 6620 6066 726f 6d5f 636f 6d6d     If `from_comm
+0001e580: 6974 5f74 696d 6560 2069 7320 604e 6f6e  it_time` is `Non
+0001e590: 6560 2c20 7468 6520 636f 6d6d 6974 2077  e`, the commit w
+0001e5a0: 696e 646f 7720 7374 6172 7473 2066 726f  indow starts fro
+0001e5b0: 6d20 7468 6520 6669 7273 7420 636f 6d6d  m the first comm
+0001e5c0: 6974 2e0a 2020 2020 2020 2020 4966 2060  it..        If `
+0001e5d0: 746f 5f63 6f6d 6d69 745f 7469 6d65 6020  to_commit_time` 
+0001e5e0: 6973 2060 4e6f 6e65 602c 2074 6865 2063  is `None`, the c
+0001e5f0: 6f6d 6d69 7420 7769 6e64 6f77 2065 6e64  ommit window end
+0001e600: 7320 6174 2074 6865 206c 6173 7420 636f  s at the last co
+0001e610: 6d6d 6974 2e0a 0a20 2020 2020 2020 2021  mmit...        !
+0001e620: 2121 2065 7861 6d70 6c65 0a20 2020 2020  !! example.     
+0001e630: 2020 2020 2020 2060 6060 7079 7468 6f6e         ```python
+0001e640: 0a20 2020 2020 2020 2020 2020 2023 2063  .            # c
+0001e650: 6f6e 6e65 6374 2074 6f20 7468 6520 4665  onnect to the Fe
+0001e660: 6174 7572 6520 5374 6f72 650a 2020 2020  ature Store.    
+0001e670: 2020 2020 2020 2020 6673 203d 202e 2e2e          fs = ...
+0001e680: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
+0001e690: 6574 2074 6865 2046 6561 7475 7265 2047  et the Feature G
+0001e6a0: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+0001e6b0: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+0001e6c0: 732e 6765 745f 6f72 5f63 7265 6174 655f  s.get_or_create_
+0001e6d0: 6665 6174 7572 655f 6772 6f75 7028 2e2e  feature_group(..
+0001e6e0: 2e29 0a20 2020 2020 2020 2020 2020 2066  .).            f
+0001e6f0: 675f 7374 6174 6973 7469 6373 203d 2066  g_statistics = f
+0001e700: 672e 6765 745f 7374 6174 6973 7469 6373  g.get_statistics
+0001e710: 5f62 795f 636f 6d6d 6974 5f77 696e 646f  _by_commit_windo
+0001e720: 7728 6672 6f6d 5f63 6f6d 6d69 745f 7469  w(from_commit_ti
+0001e730: 6d65 3d4e 6f6e 652c 2074 6f5f 636f 6d6d  me=None, to_comm
+0001e740: 6974 5f74 696d 653d 4e6f 6e65 290a 2020  it_time=None).  
+0001e750: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+0001e760: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+0001e770: 730a 2020 2020 2020 2020 2020 2020 746f  s.            to
+0001e780: 5f63 6f6d 6d69 745f 7469 6d65 3a20 4461  _commit_time: Da
+0001e790: 7465 2061 6e64 2074 696d 6520 6f66 2074  te and time of t
+0001e7a0: 6865 206c 6173 7420 636f 6d6d 6974 206f  he last commit o
+0001e7b0: 6620 7468 6520 7769 6e64 6f77 2e20 4465  f the window. De
+0001e7c0: 6661 756c 7473 2074 6f20 604e 6f6e 6560  faults to `None`
+0001e7d0: 2e20 5374 7269 6e67 7320 7368 6f75 6c64  . Strings should
+0001e7e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001e7f0: 2062 6520 666f 726d 6174 7465 6420 696e   be formatted in
+0001e800: 206f 6e65 206f 6620 7468 6520 666f 6c6c   one of the foll
+0001e810: 6f77 696e 6720 666f 726d 6174 7320 6025  owing formats `%
+0001e820: 592d 256d 2d25 6460 2c20 6025 592d 256d  Y-%m-%d`, `%Y-%m
+0001e830: 2d25 6420 2548 602c 2060 2559 2d25 6d2d  -%d %H`, `%Y-%m-
+0001e840: 2564 2025 483a 254d 602c 2060 2559 2d25  %d %H:%M`, `%Y-%
+0001e850: 6d2d 2564 2025 483a 254d 3a25 5360 2c0a  m-%d %H:%M:%S`,.
+0001e860: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e870: 6f72 2060 2559 2d25 6d2d 2564 2025 483a  or `%Y-%m-%d %H:
+0001e880: 254d 3a25 532e 2566 602e 0a20 2020 2020  %M:%S.%f`..     
+0001e890: 2020 2020 2020 2066 726f 6d5f 636f 6d6d         from_comm
+0001e8a0: 6974 5f74 696d 653a 2044 6174 6520 616e  it_time: Date an
+0001e8b0: 6420 7469 6d65 206f 6620 7468 6520 6669  d time of the fi
+0001e8c0: 7273 7420 636f 6d6d 6974 206f 6620 7468  rst commit of th
+0001e8d0: 6520 7769 6e64 6f77 2e20 4465 6661 756c  e window. Defaul
+0001e8e0: 7473 2074 6f20 604e 6f6e 6560 2e20 5374  ts to `None`. St
+0001e8f0: 7269 6e67 7320 7368 6f75 6c64 0a20 2020  rings should.   
+0001e900: 2020 2020 2020 2020 2020 2020 2062 6520               be 
+0001e910: 666f 726d 6174 7465 6420 696e 206f 6e65  formatted in one
+0001e920: 206f 6620 7468 6520 666f 6c6c 6f77 696e   of the followin
+0001e930: 6720 666f 726d 6174 7320 6025 592d 256d  g formats `%Y-%m
+0001e940: 2d25 6460 2c20 6025 592d 256d 2d25 6420  -%d`, `%Y-%m-%d 
+0001e950: 2548 602c 2060 2559 2d25 6d2d 2564 2025  %H`, `%Y-%m-%d %
+0001e960: 483a 254d 602c 2060 2559 2d25 6d2d 2564  H:%M`, `%Y-%m-%d
+0001e970: 2025 483a 254d 3a25 5360 2c0a 2020 2020   %H:%M:%S`,.    
+0001e980: 2020 2020 2020 2020 2020 2020 6f72 2060              or `
+0001e990: 2559 2d25 6d2d 2564 2025 483a 254d 3a25  %Y-%m-%d %H:%M:%
+0001e9a0: 532e 2566 602e 0a20 2020 2020 2020 2020  S.%f`..         
+0001e9b0: 2020 2066 6561 7475 7265 5f6e 616d 6573     feature_names
+0001e9c0: 3a20 4c69 7374 206f 6620 6665 6174 7572  : List of featur
+0001e9d0: 6520 6e61 6d65 7320 6f66 2077 6869 6368  e names of which
+0001e9e0: 2073 7461 7469 7374 6963 7320 6172 6520   statistics are 
+0001e9f0: 7265 7472 6965 7665 642e 0a20 2020 2020  retrieved..     
+0001ea00: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
+0001ea10: 2020 2020 2020 2020 2060 5374 6174 6973           `Statis
+0001ea20: 7469 6373 602e 2053 7461 7469 7374 6963  tics`. Statistic
+0001ea30: 7320 6f62 6a65 6374 2e0a 2020 2020 2020  s object..      
+0001ea40: 2020 2320 5261 6973 6573 0a20 2020 2020    # Raises.     
+0001ea50: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
+0001ea60: 656e 742e 6578 6365 7074 696f 6e73 2e52  ent.exceptions.R
+0001ea70: 6573 7441 5049 4572 726f 7260 2e0a 2020  estAPIError`..  
+0001ea80: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001ea90: 2020 6966 206e 6f74 2073 656c 662e 5f69    if not self._i
+0001eaa0: 735f 7469 6d65 5f74 7261 7665 6c5f 656e  s_time_travel_en
+0001eab0: 6162 6c65 6428 293a 0a20 2020 2020 2020  abled():.       
+0001eac0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
+0001ead0: 4572 726f 7228 2254 696d 6520 7472 6176  Error("Time trav
+0001eae0: 656c 2069 7320 6e6f 7420 656e 6162 6c65  el is not enable
+0001eaf0: 6420 666f 7220 7468 6973 2066 6561 7475  d for this featu
+0001eb00: 7265 2067 726f 7570 2229 0a20 2020 2020  re group").     
+0001eb10: 2020 2072 6574 7572 6e20 7365 6c66 2e5f     return self._
+0001eb20: 7374 6174 6973 7469 6373 5f65 6e67 696e  statistics_engin
+0001eb30: 652e 6765 745f 6279 5f74 696d 655f 7769  e.get_by_time_wi
+0001eb40: 6e64 6f77 280a 2020 2020 2020 2020 2020  ndow(.          
+0001eb50: 2020 7365 6c66 2c0a 2020 2020 2020 2020    self,.        
+0001eb60: 2020 2020 7374 6172 745f 636f 6d6d 6974      start_commit
+0001eb70: 5f74 696d 653d 6672 6f6d 5f63 6f6d 6d69  _time=from_commi
+0001eb80: 745f 7469 6d65 2c0a 2020 2020 2020 2020  t_time,.        
+0001eb90: 2020 2020 656e 645f 636f 6d6d 6974 5f74      end_commit_t
+0001eba0: 696d 653d 746f 5f63 6f6d 6d69 745f 7469  ime=to_commit_ti
+0001ebb0: 6d65 2c0a 2020 2020 2020 2020 2020 2020  me,.            
+0001ebc0: 6665 6174 7572 655f 6e61 6d65 733d 6665  feature_names=fe
+0001ebd0: 6174 7572 655f 6e61 6d65 732c 0a20 2020  ature_names,.   
+0001ebe0: 2020 2020 2029 0a0a 2020 2020 6465 6620       )..    def 
+0001ebf0: 636f 6d70 7574 655f 7374 6174 6973 7469  compute_statisti
+0001ec00: 6373 280a 2020 2020 2020 2020 7365 6c66  cs(.        self
+0001ec10: 2c20 7761 6c6c 636c 6f63 6b5f 7469 6d65  , wallclock_time
+0001ec20: 3a20 4f70 7469 6f6e 616c 5b55 6e69 6f6e  : Optional[Union
+0001ec30: 5b73 7472 2c20 696e 742c 2064 6174 6574  [str, int, datet
+0001ec40: 696d 652c 2064 6174 655d 5d20 3d20 4e6f  ime, date]] = No
+0001ec50: 6e65 0a20 2020 2029 3a0a 2020 2020 2020  ne.    ):.      
+0001ec60: 2020 2222 2252 6563 6f6d 7075 7465 2074    """Recompute t
+0001ec70: 6865 2073 7461 7469 7374 6963 7320 666f  he statistics fo
+0001ec80: 7220 7468 6520 6665 6174 7572 6520 6772  r the feature gr
+0001ec90: 6f75 7020 616e 6420 7361 7665 2074 6865  oup and save the
+0001eca0: 6d20 746f 2074 6865 0a20 2020 2020 2020  m to the.       
+0001ecb0: 2066 6561 7475 7265 2073 746f 7265 2e0a   feature store..
+0001ecc0: 0a20 2020 2020 2020 2053 7461 7469 7374  .        Statist
+0001ecd0: 6963 7320 6172 6520 6f6e 6c79 2063 6f6d  ics are only com
+0001ece0: 7075 7465 6420 666f 7220 6461 7461 2069  puted for data i
+0001ecf0: 6e20 7468 6520 6f66 666c 696e 6520 7374  n the offline st
+0001ed00: 6f72 6167 6520 6f66 2074 6865 2066 6561  orage of the fea
+0001ed10: 7475 7265 0a20 2020 2020 2020 2067 726f  ture.        gro
+0001ed20: 7570 2e0a 0a20 2020 2020 2020 2023 2041  up...        # A
+0001ed30: 7267 756d 656e 7473 0a20 2020 2020 2020  rguments.       
+0001ed40: 2020 2020 2077 616c 6c63 6c6f 636b 5f74       wallclock_t
+0001ed50: 696d 653a 2049 6620 7370 6563 6966 6965  ime: If specifie
+0001ed60: 6420 7769 6c6c 2072 6563 6f6d 7075 7465  d will recompute
+0001ed70: 2073 7461 7469 7374 6963 7320 6f6e 0a20   statistics on. 
+0001ed80: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+0001ed90: 6561 7475 7265 2067 726f 7570 2061 7320  eature group as 
+0001eda0: 6f66 2073 7065 6369 6669 6320 706f 696e  of specific poin
+0001edb0: 7420 696e 2074 696d 652e 2049 6620 6e6f  t in time. If no
+0001edc0: 7420 7370 6563 6966 6965 6420 7468 656e  t specified then
+0001edd0: 2077 696c 6c20 636f 6d70 7574 6520 7374   will compute st
+0001ede0: 6174 6973 7469 6373 0a20 2020 2020 2020  atistics.       
+0001edf0: 2020 2020 2020 2020 2061 7320 6f66 206d           as of m
+0001ee00: 6f73 7420 7265 6365 6e74 2074 696d 6520  ost recent time 
+0001ee10: 6f66 2074 6869 7320 6665 6174 7572 6520  of this feature 
+0001ee20: 6772 6f75 702e 2044 6566 6175 6c74 7320  group. Defaults 
+0001ee30: 746f 2060 4e6f 6e65 602e 2053 7472 696e  to `None`. Strin
+0001ee40: 6773 2073 686f 756c 640a 2020 2020 2020  gs should.      
+0001ee50: 2020 2020 2020 2020 2020 6265 2066 6f72            be for
+0001ee60: 6d61 7474 6564 2069 6e20 6f6e 6520 6f66  matted in one of
+0001ee70: 2074 6865 2066 6f6c 6c6f 7769 6e67 2066   the following f
+0001ee80: 6f72 6d61 7473 2060 2559 2d25 6d2d 2564  ormats `%Y-%m-%d
+0001ee90: 602c 2060 2559 2d25 6d2d 2564 2025 4860  `, `%Y-%m-%d %H`
+0001eea0: 2c20 6025 592d 256d 2d25 6420 2548 3a25  , `%Y-%m-%d %H:%
+0001eeb0: 4d60 2c20 6025 592d 256d 2d25 6420 2548  M`, `%Y-%m-%d %H
+0001eec0: 3a25 4d3a 2553 602c 0a20 2020 2020 2020  :%M:%S`,.       
+0001eed0: 2020 2020 2020 2020 206f 7220 6025 592d           or `%Y-
+0001eee0: 256d 2d25 6420 2548 3a25 4d3a 2553 2e25  %m-%d %H:%M:%S.%
+0001eef0: 6660 2e0a 0a20 2020 2020 2020 2023 2052  f`...        # R
+0001ef00: 6574 7572 6e73 0a20 2020 2020 2020 2020  eturns.         
+0001ef10: 2020 2060 5374 6174 6973 7469 6373 602e     `Statistics`.
+0001ef20: 2054 6865 2073 7461 7469 7374 6963 7320   The statistics 
+0001ef30: 6d65 7461 6461 7461 206f 626a 6563 742e  metadata object.
+0001ef40: 0a0a 2020 2020 2020 2020 2320 5261 6973  ..        # Rais
+0001ef50: 6573 0a20 2020 2020 2020 2020 2020 2060  es.            `
+0001ef60: 6873 6673 2e63 6c69 656e 742e 6578 6365  hsfs.client.exce
+0001ef70: 7074 696f 6e73 2e52 6573 7441 5049 4572  ptions.RestAPIEr
+0001ef80: 726f 7260 2e20 556e 6162 6c65 2074 6f20  ror`. Unable to 
+0001ef90: 7065 7273 6973 7420 7468 6520 7374 6174  persist the stat
+0001efa0: 6973 7469 6373 2e0a 2020 2020 2020 2020  istics..        
+0001efb0: 2222 220a 2020 2020 2020 2020 6966 2073  """.        if s
+0001efc0: 656c 662e 7374 6174 6973 7469 6373 5f63  elf.statistics_c
+0001efd0: 6f6e 6669 672e 656e 6162 6c65 643a 0a20  onfig.enabled:. 
+0001efe0: 2020 2020 2020 2020 2020 2069 6620 7365             if se
+0001eff0: 6c66 2e5f 6973 5f74 696d 655f 7472 6176  lf._is_time_trav
+0001f000: 656c 5f65 6e61 626c 6564 2829 206f 7220  el_enabled() or 
+0001f010: 7761 6c6c 636c 6f63 6b5f 7469 6d65 2069  wallclock_time i
+0001f020: 7320 6e6f 7420 4e6f 6e65 3a0a 2020 2020  s not None:.    
+0001f030: 2020 2020 2020 2020 2020 2020 7761 6c6c              wall
+0001f040: 636c 6f63 6b5f 7469 6d65 203d 2077 616c  clock_time = wal
+0001f050: 6c63 6c6f 636b 5f74 696d 6520 6f72 2064  lclock_time or d
+0001f060: 6174 6574 696d 652e 6e6f 7728 290a 2020  atetime.now().  
+0001f070: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f080: 5265 7472 6965 7665 2066 6720 636f 6d6d  Retrieve fg comm
+0001f090: 6974 2069 6420 7265 6c61 7465 6420 746f  it id related to
+0001f0a0: 2074 6869 7320 7761 6c6c 2063 6c6f 636b   this wall clock
+0001f0b0: 2074 696d 6520 616e 6420 7265 636f 6d70   time and recomp
+0001f0c0: 7574 6520 7374 6174 6973 7469 6373 2e20  ute statistics. 
+0001f0d0: 4974 2077 696c 6c20 7468 726f 770a 2020  It will throw.  
+0001f0e0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+0001f0f0: 6578 6365 7074 696f 6e20 6966 2069 7473  exception if its
+0001f100: 206e 6f74 2074 696d 6520 7472 6176 656c   not time travel
+0001f110: 2065 6e61 626c 6564 2066 6561 7475 7265   enabled feature
+0001f120: 2067 726f 7570 2e0a 2020 2020 2020 2020   group..        
+0001f130: 2020 2020 2020 2020 6667 5f63 6f6d 6d69          fg_commi
+0001f140: 745f 6964 203d 205b 0a20 2020 2020 2020  t_id = [.       
+0001f150: 2020 2020 2020 2020 2020 2020 2063 6f6d               com
+0001f160: 6d69 745f 6964 0a20 2020 2020 2020 2020  mit_id.         
+0001f170: 2020 2020 2020 2020 2020 2066 6f72 2063             for c
+0001f180: 6f6d 6d69 745f 6964 2069 6e20 7365 6c66  ommit_id in self
+0001f190: 2e5f 6665 6174 7572 655f 6772 6f75 705f  ._feature_group_
+0001f1a0: 656e 6769 6e65 2e63 6f6d 6d69 745f 6465  engine.commit_de
+0001f1b0: 7461 696c 7328 0a20 2020 2020 2020 2020  tails(.         
+0001f1c0: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001f1d0: 656c 662c 2077 616c 6c63 6c6f 636b 5f74  elf, wallclock_t
+0001f1e0: 696d 652c 2031 0a20 2020 2020 2020 2020  ime, 1.         
+0001f1f0: 2020 2020 2020 2020 2020 2029 2e6b 6579             ).key
+0001f200: 7328 290a 2020 2020 2020 2020 2020 2020  s().            
+0001f210: 2020 2020 5d5b 305d 0a20 2020 2020 2020      ][0].       
+0001f220: 2020 2020 2020 2020 2072 6567 6973 7465           registe
+0001f230: 7265 645f 7374 6174 7320 3d20 7365 6c66  red_stats = self
+0001f240: 2e67 6574 5f73 7461 7469 7374 6963 735f  .get_statistics_
+0001f250: 6279 5f63 6f6d 6d69 745f 7769 6e64 6f77  by_commit_window
+0001f260: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001f270: 2020 2020 2020 746f 5f63 6f6d 6d69 745f        to_commit_
+0001f280: 7469 6d65 3d66 675f 636f 6d6d 6974 5f69  time=fg_commit_i
+0001f290: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+0001f2a0: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+0001f2b0: 2020 2020 6966 2072 6567 6973 7465 7265      if registere
+0001f2c0: 645f 7374 6174 7320 6973 206e 6f74 204e  d_stats is not N
+0001f2d0: 6f6e 6520 616e 6420 7365 6c66 2e5f 6172  one and self._ar
+0001f2e0: 655f 7374 6174 6973 7469 6373 5f6d 6973  e_statistics_mis
+0001f2f0: 7369 6e67 280a 2020 2020 2020 2020 2020  sing(.          
+0001f300: 2020 2020 2020 2020 2020 7265 6769 7374            regist
+0001f310: 6572 6564 5f73 7461 7473 0a20 2020 2020  ered_stats.     
+0001f320: 2020 2020 2020 2020 2020 2029 3a0a 2020             ):.  
+0001f330: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f340: 2020 7265 6769 7374 6572 6564 5f73 7461    registered_sta
+0001f350: 7473 203d 204e 6f6e 650a 2020 2020 2020  ts = None.      
+0001f360: 2020 2020 2020 2020 2020 2320 446f 6e27            # Don'
+0001f370: 7420 7265 6164 2074 6865 2064 6174 6166  t read the dataf
+0001f380: 7261 6d65 2068 6572 652c 2074 6f20 6176  rame here, to av
+0001f390: 6f69 6420 7472 6967 6765 7269 6e67 2061  oid triggering a
+0001f3a0: 2072 6561 6420 6f70 6572 6174 696f 6e0a   read operation.
+0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f3c0: 2320 666f 7220 7468 6520 5079 7468 6f6e  # for the Python
+0001f3d0: 2065 6e67 696e 652e 2054 6865 2050 7974   engine. The Pyt
+0001f3e0: 686f 6e20 656e 6769 6e65 2069 7320 676f  hon engine is go
+0001f3f0: 696e 6720 746f 2073 6574 7570 2061 2053  ing to setup a S
+0001f400: 7061 726b 204a 6f62 0a20 2020 2020 2020  park Job.       
+0001f410: 2020 2020 2020 2020 2023 2074 6f20 7570           # to up
+0001f420: 6461 7465 2074 6865 2073 7461 7469 7374  date the statist
+0001f430: 6963 732e 0a20 2020 2020 2020 2020 2020  ics..           
+0001f440: 2020 2020 2072 6574 7572 6e20 280a 2020       return (.  
+0001f450: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f460: 2020 7265 6769 7374 6572 6564 5f73 7461    registered_sta
+0001f470: 7473 0a20 2020 2020 2020 2020 2020 2020  ts.             
+0001f480: 2020 2020 2020 206f 7220 7365 6c66 2e5f         or self._
+0001f490: 7374 6174 6973 7469 6373 5f65 6e67 696e  statistics_engin
+0001f4a0: 652e 636f 6d70 7574 655f 616e 645f 7361  e.compute_and_sa
+0001f4b0: 7665 5f73 7461 7469 7374 6963 7328 0a20  ve_statistics(. 
+0001f4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4d0: 2020 2020 2020 2073 656c 662c 0a20 2020         self,.   
+0001f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f4f0: 2020 2020 2066 6561 7475 7265 5f67 726f       feature_gro
+0001f500: 7570 5f63 6f6d 6d69 745f 6964 3d66 675f  up_commit_id=fg_
+0001f510: 636f 6d6d 6974 5f69 642c 0a20 2020 2020  commit_id,.     
+0001f520: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001f530: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f540: 2029 0a20 2020 2020 2020 2072 6574 7572   ).        retur
+0001f550: 6e20 7375 7065 7228 292e 636f 6d70 7574  n super().comput
+0001f560: 655f 7374 6174 6973 7469 6373 2829 0a0a  e_statistics()..
+0001f570: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
+0001f580: 0a20 2020 2064 6566 2066 726f 6d5f 7265  .    def from_re
+0001f590: 7370 6f6e 7365 5f6a 736f 6e28 636c 732c  sponse_json(cls,
+0001f5a0: 206a 736f 6e5f 6469 6374 293a 0a20 2020   json_dict):.   
+0001f5b0: 2020 2020 206a 736f 6e5f 6465 6361 6d65       json_decame
+0001f5c0: 6c69 7a65 6420 3d20 6875 6d70 732e 6465  lized = humps.de
+0001f5d0: 6361 6d65 6c69 7a65 286a 736f 6e5f 6469  camelize(json_di
+0001f5e0: 6374 290a 2020 2020 2020 2020 6966 2069  ct).        if i
+0001f5f0: 7369 6e73 7461 6e63 6528 6a73 6f6e 5f64  sinstance(json_d
+0001f600: 6563 616d 656c 697a 6564 2c20 6469 6374  ecamelized, dict
+0001f610: 293a 0a20 2020 2020 2020 2020 2020 2069  ):.            i
+0001f620: 6620 2274 7970 6522 2069 6e20 6a73 6f6e  f "type" in json
+0001f630: 5f64 6563 616d 656c 697a 6564 3a0a 2020  _decamelized:.  
+0001f640: 2020 2020 2020 2020 2020 2020 2020 6a73                js
+0001f650: 6f6e 5f64 6563 616d 656c 697a 6564 5b22  on_decamelized["
+0001f660: 7374 7265 616d 225d 203d 2028 0a20 2020  stream"] = (.   
+0001f670: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f680: 206a 736f 6e5f 6465 6361 6d65 6c69 7a65   json_decamelize
+0001f690: 645b 2274 7970 6522 5d20 3d3d 2022 7374  d["type"] == "st
+0001f6a0: 7265 616d 4665 6174 7572 6547 726f 7570  reamFeatureGroup
+0001f6b0: 4454 4f22 0a20 2020 2020 2020 2020 2020  DTO".           
+0001f6c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+0001f6d0: 2020 205f 203d 206a 736f 6e5f 6465 6361     _ = json_deca
+0001f6e0: 6d65 6c69 7a65 642e 706f 7028 2274 7970  melized.pop("typ
+0001f6f0: 6522 2c20 4e6f 6e65 290a 2020 2020 2020  e", None).      
+0001f700: 2020 2020 2020 6a73 6f6e 5f64 6563 616d        json_decam
+0001f710: 656c 697a 6564 2e70 6f70 2822 7661 6c69  elized.pop("vali
+0001f720: 6461 7469 6f6e 5f74 7970 6522 2c20 4e6f  dation_type", No
+0001f730: 6e65 290a 2020 2020 2020 2020 2020 2020  ne).            
+0001f740: 6966 2022 656d 6265 6464 696e 675f 696e  if "embedding_in
+0001f750: 6465 7822 2069 6e20 6a73 6f6e 5f64 6563  dex" in json_dec
+0001f760: 616d 656c 697a 6564 3a0a 2020 2020 2020  amelized:.      
+0001f770: 2020 2020 2020 2020 2020 6a73 6f6e 5f64            json_d
+0001f780: 6563 616d 656c 697a 6564 5b22 656d 6265  ecamelized["embe
+0001f790: 6464 696e 675f 696e 6465 7822 5d20 3d20  dding_index"] = 
+0001f7a0: 456d 6265 6464 696e 6749 6e64 6578 2e66  EmbeddingIndex.f
+0001f7b0: 726f 6d5f 6a73 6f6e 5f72 6573 706f 6e73  rom_json_respons
+0001f7c0: 6528 0a20 2020 2020 2020 2020 2020 2020  e(.             
+0001f7d0: 2020 2020 2020 206a 736f 6e5f 6465 6361         json_deca
+0001f7e0: 6d65 6c69 7a65 645b 2265 6d62 6564 6469  melized["embeddi
+0001f7f0: 6e67 5f69 6e64 6578 225d 0a20 2020 2020  ng_index"].     
+0001f800: 2020 2020 2020 2020 2020 2029 0a20 2020             ).   
+0001f810: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+0001f820: 636c 7328 2a2a 6a73 6f6e 5f64 6563 616d  cls(**json_decam
+0001f830: 656c 697a 6564 290a 2020 2020 2020 2020  elized).        
+0001f840: 666f 7220 6667 2069 6e20 6a73 6f6e 5f64  for fg in json_d
+0001f850: 6563 616d 656c 697a 6564 3a0a 2020 2020  ecamelized:.    
+0001f860: 2020 2020 2020 2020 6966 2022 7479 7065          if "type
+0001f870: 2220 696e 2066 673a 0a20 2020 2020 2020  " in fg:.       
+0001f880: 2020 2020 2020 2020 2066 675b 2273 7472           fg["str
+0001f890: 6561 6d22 5d20 3d20 6667 5b22 7479 7065  eam"] = fg["type
+0001f8a0: 225d 203d 3d20 2273 7472 6561 6d46 6561  "] == "streamFea
+0001f8b0: 7475 7265 4772 6f75 7044 544f 220a 2020  tureGroupDTO".  
+0001f8c0: 2020 2020 2020 2020 2020 5f20 3d20 6667            _ = fg
+0001f8d0: 2e70 6f70 2822 7479 7065 222c 204e 6f6e  .pop("type", Non
+0001f8e0: 6529 0a20 2020 2020 2020 2020 2020 2066  e).            f
+0001f8f0: 672e 706f 7028 2276 616c 6964 6174 696f  g.pop("validatio
+0001f900: 6e5f 7479 7065 222c 204e 6f6e 6529 0a20  n_type", None). 
+0001f910: 2020 2020 2020 2020 2020 2069 6620 2265             if "e
+0001f920: 6d62 6564 6469 6e67 5f69 6e64 6578 2220  mbedding_index" 
+0001f930: 696e 2066 673a 0a20 2020 2020 2020 2020  in fg:.         
+0001f940: 2020 2020 2020 2066 675b 2265 6d62 6564         fg["embed
+0001f950: 6469 6e67 5f69 6e64 6578 225d 203d 2045  ding_index"] = E
+0001f960: 6d62 6564 6469 6e67 496e 6465 782e 6672  mbeddingIndex.fr
+0001f970: 6f6d 5f6a 736f 6e5f 7265 7370 6f6e 7365  om_json_response
+0001f980: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+0001f990: 2020 2020 2020 6667 5b22 656d 6265 6464        fg["embedd
+0001f9a0: 696e 675f 696e 6465 7822 5d0a 2020 2020  ing_index"].    
+0001f9b0: 2020 2020 2020 2020 2020 2020 290a 2020              ).  
+0001f9c0: 2020 2020 2020 7265 7475 726e 205b 636c        return [cl
+0001f9d0: 7328 2a2a 6667 2920 666f 7220 6667 2069  s(**fg) for fg i
+0001f9e0: 6e20 6a73 6f6e 5f64 6563 616d 656c 697a  n json_decameliz
+0001f9f0: 6564 5d0a 0a20 2020 2064 6566 2075 7064  ed]..    def upd
+0001fa00: 6174 655f 6672 6f6d 5f72 6573 706f 6e73  ate_from_respons
+0001fa10: 655f 6a73 6f6e 2873 656c 662c 206a 736f  e_json(self, jso
+0001fa20: 6e5f 6469 6374 293a 0a20 2020 2020 2020  n_dict):.       
+0001fa30: 206a 736f 6e5f 6465 6361 6d65 6c69 7a65   json_decamelize
+0001fa40: 6420 3d20 6875 6d70 732e 6465 6361 6d65  d = humps.decame
+0001fa50: 6c69 7a65 286a 736f 6e5f 6469 6374 290a  lize(json_dict).
+0001fa60: 2020 2020 2020 2020 6a73 6f6e 5f64 6563          json_dec
+0001fa70: 616d 656c 697a 6564 5b22 7374 7265 616d  amelized["stream
+0001fa80: 225d 203d 206a 736f 6e5f 6465 6361 6d65  "] = json_decame
+0001fa90: 6c69 7a65 645b 2274 7970 6522 5d20 3d3d  lized["type"] ==
+0001faa0: 2022 7374 7265 616d 4665 6174 7572 6547   "streamFeatureG
+0001fab0: 726f 7570 4454 4f22 0a20 2020 2020 2020  roupDTO".       
+0001fac0: 205f 203d 206a 736f 6e5f 6465 6361 6d65   _ = json_decame
+0001fad0: 6c69 7a65 642e 706f 7028 2274 7970 6522  lized.pop("type"
+0001fae0: 290a 2020 2020 2020 2020 6966 2022 656d  ).        if "em
+0001faf0: 6265 6464 696e 675f 696e 6465 7822 2069  bedding_index" i
+0001fb00: 6e20 6a73 6f6e 5f64 6563 616d 656c 697a  n json_decameliz
+0001fb10: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+0001fb20: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
+0001fb30: 5b22 656d 6265 6464 696e 675f 696e 6465  ["embedding_inde
+0001fb40: 7822 5d20 3d20 456d 6265 6464 696e 6749  x"] = EmbeddingI
+0001fb50: 6e64 6578 2e66 726f 6d5f 6a73 6f6e 5f72  ndex.from_json_r
+0001fb60: 6573 706f 6e73 6528 0a20 2020 2020 2020  esponse(.       
+0001fb70: 2020 2020 2020 2020 206a 736f 6e5f 6465           json_de
+0001fb80: 6361 6d65 6c69 7a65 645b 2265 6d62 6564  camelized["embed
+0001fb90: 6469 6e67 5f69 6e64 6578 225d 0a20 2020  ding_index"].   
+0001fba0: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+0001fbb0: 2020 2073 656c 662e 5f5f 696e 6974 5f5f     self.__init__
+0001fbc0: 282a 2a6a 736f 6e5f 6465 6361 6d65 6c69  (**json_decameli
+0001fbd0: 7a65 6429 0a20 2020 2020 2020 2072 6574  zed).        ret
+0001fbe0: 7572 6e20 7365 6c66 0a0a 2020 2020 6465  urn self..    de
+0001fbf0: 6620 6a73 6f6e 2873 656c 6629 3a0a 2020  f json(self):.  
+0001fc00: 2020 2020 2020 2222 2247 6574 2073 7065        """Get spe
+0001fc10: 6369 6669 6320 4665 6174 7572 6520 4772  cific Feature Gr
+0001fc20: 6f75 7020 6d65 7461 6461 7461 2069 6e20  oup metadata in 
+0001fc30: 6a73 6f6e 2066 6f72 6d61 742e 0a0a 2020  json format...  
+0001fc40: 2020 2020 2020 2121 2120 6578 616d 706c        !!! exampl
+0001fc50: 650a 2020 2020 2020 2020 2020 2020 6060  e.            ``
+0001fc60: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+0001fc70: 2020 2020 6667 2e6a 736f 6e28 290a 2020      fg.json().  
+0001fc80: 2020 2020 2020 2020 2020 6060 600a 2020            ```.  
+0001fc90: 2020 2020 2020 2222 220a 2020 2020 2020        """.      
+0001fca0: 2020 7265 7475 726e 206a 736f 6e2e 6475    return json.du
+0001fcb0: 6d70 7328 7365 6c66 2c20 636c 733d 7574  mps(self, cls=ut
+0001fcc0: 696c 2e46 6561 7475 7265 5374 6f72 6545  il.FeatureStoreE
+0001fcd0: 6e63 6f64 6572 290a 0a20 2020 2064 6566  ncoder)..    def
+0001fce0: 2074 6f5f 6469 6374 2873 656c 6629 3a0a   to_dict(self):.
+0001fcf0: 2020 2020 2020 2020 2222 2247 6574 2073          """Get s
+0001fd00: 7472 7563 7475 7265 6420 696e 666f 2061  tructured info a
+0001fd10: 626f 7574 2073 7065 6369 6669 6320 4665  bout specific Fe
+0001fd20: 6174 7572 6520 4772 6f75 7020 696e 2070  ature Group in p
+0001fd30: 7974 686f 6e20 6469 6374 696f 6e61 7279  ython dictionary
+0001fd40: 2066 6f72 6d61 742e 0a0a 2020 2020 2020   format...      
+0001fd50: 2020 2121 2120 6578 616d 706c 650a 2020    !!! example.  
+0001fd60: 2020 2020 2020 2020 2020 6060 6070 7974            ```pyt
+0001fd70: 686f 6e0a 2020 2020 2020 2020 2020 2020  hon.            
+0001fd80: 2320 636f 6e6e 6563 7420 746f 2074 6865  # connect to the
+0001fd90: 2046 6561 7475 7265 2053 746f 7265 0a20   Feature Store. 
+0001fda0: 2020 2020 2020 2020 2020 2066 7320 3d20             fs = 
+0001fdb0: 2e2e 2e0a 0a20 2020 2020 2020 2020 2020  .....           
+0001fdc0: 2023 2067 6574 2074 6865 2046 6561 7475   # get the Featu
+0001fdd0: 7265 2047 726f 7570 2069 6e73 7461 6e63  re Group instanc
+0001fde0: 650a 2020 2020 2020 2020 2020 2020 6667  e.            fg
+0001fdf0: 203d 2066 732e 6765 745f 6f72 5f63 7265   = fs.get_or_cre
+0001fe00: 6174 655f 6665 6174 7572 655f 6772 6f75  ate_feature_grou
+0001fe10: 7028 2e2e 2e29 0a0a 2020 2020 2020 2020  p(...)..        
+0001fe20: 2020 2020 6667 2e74 6f5f 6469 6374 2829      fg.to_dict()
+0001fe30: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+0001fe40: 0a20 2020 2020 2020 2022 2222 0a20 2020  .        """.   
+0001fe50: 2020 2020 2066 675f 6d65 7461 5f64 6963       fg_meta_dic
+0001fe60: 7420 3d20 7b0a 2020 2020 2020 2020 2020  t = {.          
+0001fe70: 2020 2269 6422 3a20 7365 6c66 2e5f 6964    "id": self._id
+0001fe80: 2c0a 2020 2020 2020 2020 2020 2020 226e  ,.            "n
+0001fe90: 616d 6522 3a20 7365 6c66 2e5f 6e61 6d65  ame": self._name
+0001fea0: 2c0a 2020 2020 2020 2020 2020 2020 2276  ,.            "v
+0001feb0: 6572 7369 6f6e 223a 2073 656c 662e 5f76  ersion": self._v
+0001fec0: 6572 7369 6f6e 2c0a 2020 2020 2020 2020  ersion,.        
+0001fed0: 2020 2020 2264 6573 6372 6970 7469 6f6e      "description
+0001fee0: 223a 2073 656c 662e 5f64 6573 6372 6970  ": self._descrip
+0001fef0: 7469 6f6e 2c0a 2020 2020 2020 2020 2020  tion,.          
+0001ff00: 2020 226f 6e6c 696e 6545 6e61 626c 6564    "onlineEnabled
+0001ff10: 223a 2073 656c 662e 5f6f 6e6c 696e 655f  ": self._online_
+0001ff20: 656e 6162 6c65 642c 0a20 2020 2020 2020  enabled,.       
+0001ff30: 2020 2020 2022 7469 6d65 5472 6176 656c       "timeTravel
+0001ff40: 466f 726d 6174 223a 2073 656c 662e 5f74  Format": self._t
+0001ff50: 696d 655f 7472 6176 656c 5f66 6f72 6d61  ime_travel_forma
+0001ff60: 742c 0a20 2020 2020 2020 2020 2020 2022  t,.            "
+0001ff70: 6665 6174 7572 6573 223a 2073 656c 662e  features": self.
+0001ff80: 5f66 6561 7475 7265 732c 0a20 2020 2020  _features,.     
+0001ff90: 2020 2020 2020 2022 6665 6174 7572 6573         "features
+0001ffa0: 746f 7265 4964 223a 2073 656c 662e 5f66  toreId": self._f
+0001ffb0: 6561 7475 7265 5f73 746f 7265 5f69 642c  eature_store_id,
+0001ffc0: 0a20 2020 2020 2020 2020 2020 2022 7479  .            "ty
+0001ffd0: 7065 223a 2022 6361 6368 6564 4665 6174  pe": "cachedFeat
+0001ffe0: 7572 6567 726f 7570 4454 4f22 0a20 2020  uregroupDTO".   
+0001fff0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
+00020000: 7365 6c66 2e5f 7374 7265 616d 0a20 2020  self._stream.   
+00020010: 2020 2020 2020 2020 2065 6c73 6520 2273           else "s
+00020020: 7472 6561 6d46 6561 7475 7265 4772 6f75  treamFeatureGrou
+00020030: 7044 544f 222c 0a20 2020 2020 2020 2020  pDTO",.         
+00020040: 2020 2022 7374 6174 6973 7469 6373 436f     "statisticsCo
+00020050: 6e66 6967 223a 2073 656c 662e 5f73 7461  nfig": self._sta
+00020060: 7469 7374 6963 735f 636f 6e66 6967 2c0a  tistics_config,.
+00020070: 2020 2020 2020 2020 2020 2020 2265 7665              "eve
+00020080: 6e74 5469 6d65 223a 2073 656c 662e 6576  ntTime": self.ev
+00020090: 656e 745f 7469 6d65 2c0a 2020 2020 2020  ent_time,.      
+000200a0: 2020 2020 2020 2265 7870 6563 7461 7469        "expectati
+000200b0: 6f6e 5375 6974 6522 3a20 7365 6c66 2e5f  onSuite": self._
+000200c0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+000200d0: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+000200e0: 7061 7265 6e74 7322 3a20 7365 6c66 2e5f  parents": self._
+000200f0: 7061 7265 6e74 732c 0a20 2020 2020 2020  parents,.       
+00020100: 2020 2020 2022 746f 7069 634e 616d 6522       "topicName"
+00020110: 3a20 7365 6c66 2e74 6f70 6963 5f6e 616d  : self.topic_nam
+00020120: 652c 0a20 2020 2020 2020 2020 2020 2022  e,.            "
+00020130: 6e6f 7469 6669 6361 7469 6f6e 546f 7069  notificationTopi
+00020140: 634e 616d 6522 3a20 7365 6c66 2e6e 6f74  cName": self.not
+00020150: 6966 6963 6174 696f 6e5f 746f 7069 635f  ification_topic_
+00020160: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00020170: 2020 2264 6570 7265 6361 7465 6422 3a20    "deprecated": 
+00020180: 7365 6c66 2e64 6570 7265 6361 7465 642c  self.deprecated,
+00020190: 0a20 2020 2020 2020 207d 0a20 2020 2020  .        }.     
+000201a0: 2020 2069 6620 7365 6c66 2e65 6d62 6564     if self.embed
+000201b0: 6469 6e67 5f69 6e64 6578 3a0a 2020 2020  ding_index:.    
+000201c0: 2020 2020 2020 2020 6667 5f6d 6574 615f          fg_meta_
+000201d0: 6469 6374 5b22 656d 6265 6464 696e 6749  dict["embeddingI
+000201e0: 6e64 6578 225d 203d 2073 656c 662e 656d  ndex"] = self.em
+000201f0: 6265 6464 696e 675f 696e 6465 780a 2020  bedding_index.  
+00020200: 2020 2020 2020 6966 2073 656c 662e 5f73        if self._s
+00020210: 7472 6561 6d3a 0a20 2020 2020 2020 2020  tream:.         
+00020220: 2020 2066 675f 6d65 7461 5f64 6963 745b     fg_meta_dict[
+00020230: 2264 656c 7461 5374 7265 616d 6572 4a6f  "deltaStreamerJo
+00020240: 6243 6f6e 6622 5d20 3d20 7365 6c66 2e5f  bConf"] = self._
+00020250: 6465 6c74 6173 7472 6561 6d65 725f 6a6f  deltastreamer_jo
+00020260: 6263 6f6e 660a 2020 2020 2020 2020 7265  bconf.        re
+00020270: 7475 726e 2066 675f 6d65 7461 5f64 6963  turn fg_meta_dic
+00020280: 740a 0a20 2020 2064 6566 205f 6765 745f  t..    def _get_
+00020290: 7461 626c 655f 6e61 6d65 2873 656c 6629  table_name(self)
+000202a0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000202b0: 2073 656c 662e 6665 6174 7572 655f 7374   self.feature_st
+000202c0: 6f72 655f 6e61 6d65 202b 2022 2e22 202b  ore_name + "." +
+000202d0: 2073 656c 662e 6765 745f 6667 5f6e 616d   self.get_fg_nam
+000202e0: 6528 290a 0a20 2020 2064 6566 205f 6973  e()..    def _is
+000202f0: 5f74 696d 655f 7472 6176 656c 5f65 6e61  _time_travel_ena
+00020300: 626c 6564 2873 656c 6629 3a0a 2020 2020  bled(self):.    
+00020310: 2020 2020 2222 2257 6865 7468 6572 2074      """Whether t
+00020320: 696d 652d 7472 6176 656c 2069 7320 656e  ime-travel is en
+00020330: 6162 6c65 6420 6f72 206e 6f74 2222 220a  abled or not""".
+00020340: 2020 2020 2020 2020 7265 7475 726e 2028          return (
+00020350: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00020360: 662e 5f74 696d 655f 7472 6176 656c 5f66  f._time_travel_f
+00020370: 6f72 6d61 7420 6973 206e 6f74 204e 6f6e  ormat is not Non
+00020380: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
+00020390: 6420 7365 6c66 2e5f 7469 6d65 5f74 7261  d self._time_tra
+000203a0: 7665 6c5f 666f 726d 6174 2e75 7070 6572  vel_format.upper
+000203b0: 2829 203d 3d20 2248 5544 4922 0a20 2020  () == "HUDI".   
+000203c0: 2020 2020 2029 0a0a 2020 2020 4070 726f       )..    @pro
+000203d0: 7065 7274 790a 2020 2020 6465 6620 6964  perty.    def id
+000203e0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+000203f0: 2222 2246 6561 7475 7265 2067 726f 7570  """Feature group
+00020400: 2069 642e 2222 220a 2020 2020 2020 2020   id.""".        
+00020410: 7265 7475 726e 2073 656c 662e 5f69 640a  return self._id.
+00020420: 0a20 2020 2040 7072 6f70 6572 7479 0a20  .    @property. 
+00020430: 2020 2064 6566 2064 6573 6372 6970 7469     def descripti
+00020440: 6f6e 2873 656c 6629 3a0a 2020 2020 2020  on(self):.      
+00020450: 2020 2222 2244 6573 6372 6970 7469 6f6e    """Description
+00020460: 206f 6620 7468 6520 6665 6174 7572 6520   of the feature 
+00020470: 6772 6f75 7020 636f 6e74 656e 7473 2e22  group contents."
+00020480: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+00020490: 6e20 7365 6c66 2e5f 6465 7363 7269 7074  n self._descript
+000204a0: 696f 6e0a 0a20 2020 2040 7072 6f70 6572  ion..    @proper
+000204b0: 7479 0a20 2020 2064 6566 2074 696d 655f  ty.    def time_
+000204c0: 7472 6176 656c 5f66 6f72 6d61 7428 7365  travel_format(se
+000204d0: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000204e0: 5365 7474 696e 6720 6f66 2074 6865 2066  Setting of the f
+000204f0: 6561 7475 7265 2067 726f 7570 2074 696d  eature group tim
+00020500: 6520 7472 6176 656c 2066 6f72 6d61 742e  e travel format.
+00020510: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00020520: 726e 2073 656c 662e 5f74 696d 655f 7472  rn self._time_tr
+00020530: 6176 656c 5f66 6f72 6d61 740a 0a20 2020  avel_format..   
+00020540: 2040 7072 6f70 6572 7479 0a20 2020 2064   @property.    d
+00020550: 6566 2070 6172 7469 7469 6f6e 5f6b 6579  ef partition_key
+00020560: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00020570: 2222 224c 6973 7420 6f66 2066 6561 7475  """List of featu
+00020580: 7265 7320 6275 696c 6469 6e67 2074 6865  res building the
+00020590: 2070 6172 7469 7469 6f6e 206b 6579 2e22   partition key."
+000205a0: 2222 0a20 2020 2020 2020 2072 6574 7572  "".        retur
+000205b0: 6e20 7365 6c66 2e5f 7061 7274 6974 696f  n self._partitio
+000205c0: 6e5f 6b65 790a 0a20 2020 2040 7072 6f70  n_key..    @prop
+000205d0: 6572 7479 0a20 2020 2064 6566 2068 7564  erty.    def hud
+000205e0: 695f 7072 6563 6f6d 6269 6e65 5f6b 6579  i_precombine_key
+000205f0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00020600: 2222 2246 6561 7475 7265 206e 616d 6520  """Feature name 
+00020610: 7468 6174 2069 7320 7468 6520 6875 6469  that is the hudi
+00020620: 2070 7265 636f 6d62 696e 6520 6b65 792e   precombine key.
+00020630: 2222 220a 2020 2020 2020 2020 7265 7475  """.        retu
+00020640: 726e 2073 656c 662e 5f68 7564 695f 7072  rn self._hudi_pr
+00020650: 6563 6f6d 6269 6e65 5f6b 6579 0a0a 2020  ecombine_key..  
+00020660: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00020670: 6465 6620 6665 6174 7572 655f 7374 6f72  def feature_stor
+00020680: 655f 6e61 6d65 2873 656c 6629 3a0a 2020  e_name(self):.  
+00020690: 2020 2020 2020 2222 224e 616d 6520 6f66        """Name of
+000206a0: 2074 6865 2066 6561 7475 7265 2073 746f   the feature sto
+000206b0: 7265 2069 6e20 7768 6963 6820 7468 6520  re in which the 
+000206c0: 6665 6174 7572 6520 6772 6f75 7020 6973  feature group is
+000206d0: 206c 6f63 6174 6564 2e22 2222 0a20 2020   located.""".   
+000206e0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+000206f0: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
+00020700: 6e61 6d65 0a0a 2020 2020 4070 726f 7065  name..    @prope
+00020710: 7274 790a 2020 2020 6465 6620 6372 6561  rty.    def crea
+00020720: 746f 7228 7365 6c66 293a 0a20 2020 2020  tor(self):.     
+00020730: 2020 2022 2222 5573 6572 6e61 6d65 206f     """Username o
+00020740: 6620 7468 6520 6372 6561 746f 722e 2222  f the creator.""
+00020750: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00020760: 2073 656c 662e 5f63 7265 6174 6f72 0a0a   self._creator..
+00020770: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00020780: 2020 6465 6620 6372 6561 7465 6428 7365    def created(se
+00020790: 6c66 293a 0a20 2020 2020 2020 2022 2222  lf):.        """
+000207a0: 5469 6d65 7374 616d 7020 7768 656e 2074  Timestamp when t
+000207b0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+000207c0: 2077 6173 2063 7265 6174 6564 2e22 2222   was created."""
+000207d0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000207e0: 7365 6c66 2e5f 6372 6561 7465 640a 0a20  self._created.. 
+000207f0: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00020800: 2064 6566 2073 7472 6561 6d28 7365 6c66   def stream(self
+00020810: 293a 0a20 2020 2020 2020 2022 2222 5768  ):.        """Wh
+00020820: 6574 6865 7220 746f 2065 6e61 626c 6520  ether to enable 
+00020830: 7265 616c 2074 696d 6520 7374 7265 616d  real time stream
+00020840: 2077 7269 7469 6e67 2063 6170 6162 696c   writing capabil
+00020850: 6974 6965 732e 2222 220a 2020 2020 2020  ities.""".      
+00020860: 2020 7265 7475 726e 2073 656c 662e 5f73    return self._s
+00020870: 7472 6561 6d0a 0a20 2020 2040 7072 6f70  tream..    @prop
+00020880: 6572 7479 0a20 2020 2064 6566 2070 6172  erty.    def par
+00020890: 656e 7473 2873 656c 6629 3a0a 2020 2020  ents(self):.    
+000208a0: 2020 2020 2222 2250 6172 656e 7420 6665      """Parent fe
+000208b0: 6174 7572 6520 6772 6f75 7073 2061 7320  ature groups as 
+000208c0: 6f72 6967 696e 206f 6620 7468 6520 6461  origin of the da
+000208d0: 7461 2069 6e20 7468 6520 6375 7272 656e  ta in the curren
+000208e0: 7420 6665 6174 7572 6520 6772 6f75 702e  t feature group.
+000208f0: 0a20 2020 2020 2020 2054 6869 7320 6973  .        This is
+00020900: 2070 6172 7420 6f66 2065 7870 6c69 6369   part of explici
+00020910: 7420 7072 6f76 656e 616e 6365 2222 220a  t provenance""".
+00020920: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00020930: 656c 662e 5f70 6172 656e 7473 0a0a 2020  elf._parents..  
+00020940: 2020 4070 726f 7065 7274 790a 2020 2020    @property.    
+00020950: 6465 6620 6d61 7465 7269 616c 697a 6174  def materializat
+00020960: 696f 6e5f 6a6f 6228 7365 6c66 293a 0a20  ion_job(self):. 
+00020970: 2020 2020 2020 2022 2222 4765 7420 7468         """Get th
+00020980: 6520 4a6f 6220 6f62 6a65 6374 2072 6566  e Job object ref
+00020990: 6572 656e 6365 2066 6f72 2074 6865 206d  erence for the m
+000209a0: 6174 6572 6961 6c69 7a61 7469 6f6e 206a  aterialization j
+000209b0: 6f62 2066 6f72 2074 6869 730a 2020 2020  ob for this.    
+000209c0: 2020 2020 4665 6174 7572 6520 4772 6f75      Feature Grou
+000209d0: 702e 2222 220a 2020 2020 2020 2020 6966  p.""".        if
+000209e0: 2073 656c 662e 5f6d 6174 6572 6961 6c69   self._materiali
+000209f0: 7a61 7469 6f6e 5f6a 6f62 2069 7320 6e6f  zation_job is no
+00020a00: 7420 4e6f 6e65 3a0a 2020 2020 2020 2020  t None:.        
+00020a10: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00020a20: 5f6d 6174 6572 6961 6c69 7a61 7469 6f6e  _materialization
+00020a30: 5f6a 6f62 0a20 2020 2020 2020 2065 6c73  _job.        els
+00020a40: 653a 0a20 2020 2020 2020 2020 2020 2066  e:.            f
+00020a50: 6561 7475 7265 5f67 726f 7570 5f6e 616d  eature_group_nam
+00020a60: 6520 3d20 7574 696c 2e66 6561 7475 7265  e = util.feature
+00020a70: 5f67 726f 7570 5f6e 616d 6528 7365 6c66  _group_name(self
+00020a80: 290a 2020 2020 2020 2020 2020 2020 6a6f  ).            jo
+00020a90: 625f 7375 6666 6978 5f6c 6973 7420 3d20  b_suffix_list = 
+00020aa0: 5b22 6d61 7465 7269 616c 697a 6174 696f  ["materializatio
+00020ab0: 6e22 2c20 2262 6163 6b66 696c 6c22 5d0a  n", "backfill"].
+00020ac0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00020ad0: 6a6f 625f 7375 6666 6978 2069 6e20 6a6f  job_suffix in jo
+00020ae0: 625f 7375 6666 6978 5f6c 6973 743a 0a20  b_suffix_list:. 
+00020af0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+00020b00: 6f62 5f6e 616d 6520 3d20 227b 7d5f 6f66  ob_name = "{}_of
+00020b10: 666c 696e 655f 6667 5f7b 7d22 2e66 6f72  fline_fg_{}".for
+00020b20: 6d61 7428 6665 6174 7572 655f 6772 6f75  mat(feature_grou
+00020b30: 705f 6e61 6d65 2c20 6a6f 625f 7375 6666  p_name, job_suff
+00020b40: 6978 290a 2020 2020 2020 2020 2020 2020  ix).            
+00020b50: 2020 2020 666f 7220 5f20 696e 2072 616e      for _ in ran
+00020b60: 6765 2833 293a 2020 2320 7265 7472 7920  ge(3):  # retry 
+00020b70: 7374 6172 7469 6e67 206a 6f62 0a20 2020  starting job.   
+00020b80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020b90: 2074 7279 3a0a 2020 2020 2020 2020 2020   try:.          
+00020ba0: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00020bb0: 6c66 2e5f 6d61 7465 7269 616c 697a 6174  lf._materializat
+00020bc0: 696f 6e5f 6a6f 6220 3d20 6a6f 625f 6170  ion_job = job_ap
+00020bd0: 692e 4a6f 6241 7069 2829 2e67 6574 286a  i.JobApi().get(j
+00020be0: 6f62 5f6e 616d 6529 0a20 2020 2020 2020  ob_name).       
+00020bf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c00: 2072 6574 7572 6e20 7365 6c66 2e5f 6d61   return self._ma
+00020c10: 7465 7269 616c 697a 6174 696f 6e5f 6a6f  terialization_jo
+00020c20: 620a 2020 2020 2020 2020 2020 2020 2020  b.              
+00020c30: 2020 2020 2020 6578 6365 7074 2052 6573        except Res
+00020c40: 7441 5049 4572 726f 7220 6173 2065 3a0a  tAPIError as e:.
+00020c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020c60: 2020 2020 2020 2020 6966 2065 2e72 6573          if e.res
+00020c70: 706f 6e73 652e 7374 6174 7573 5f63 6f64  ponse.status_cod
+00020c80: 6520 3d3d 2034 3034 3a0a 2020 2020 2020  e == 404:.      
+00020c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020ca0: 2020 2020 2020 6966 2065 2e72 6573 706f        if e.respo
+00020cb0: 6e73 652e 6a73 6f6e 2829 2e67 6574 2822  nse.json().get("
+00020cc0: 6572 726f 7243 6f64 6522 2c20 2222 2920  errorCode", "") 
+00020cd0: 3d3d 2031 3330 3030 393a 0a20 2020 2020  == 130009:.     
+00020ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020cf0: 2020 2020 2020 2020 2020 2062 7265 616b             break
+00020d00: 2020 2320 6e6f 206e 6565 6420 746f 2072    # no need to r
+00020d10: 6574 7279 2c20 7369 6e63 6520 6e6f 2073  etry, since no s
+00020d20: 7563 6820 6a6f 6220 6578 6973 7473 0a20  uch job exists. 
+00020d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d40: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00020d50: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00020d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020d70: 2074 696d 652e 736c 6565 7028 3129 2020   time.sleep(1)  
+00020d80: 2320 6261 636b 6f66 6620 616e 6420 7468  # backoff and th
+00020d90: 656e 2072 6574 7279 0a20 2020 2020 2020  en retry.       
+00020da0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00020db0: 2020 2020 2020 2020 2063 6f6e 7469 6e75           continu
+00020dc0: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00020dd0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00020de0: 650a 2020 2020 2020 2020 2020 2020 7261  e.            ra
+00020df0: 6973 6520 4665 6174 7572 6553 746f 7265  ise FeatureStore
+00020e00: 4578 6365 7074 696f 6e28 224e 6f20 6d61  Exception("No ma
+00020e10: 7465 7269 616c 697a 6174 696f 6e20 6a6f  terialization jo
+00020e20: 6220 7761 7320 666f 756e 6422 290a 0a20  b was found").. 
+00020e30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00020e40: 2064 6566 2073 7461 7469 7374 6963 7328   def statistics(
+00020e50: 7365 6c66 293a 0a20 2020 2020 2020 2022  self):.        "
+00020e60: 2222 4765 7420 7468 6520 6c61 7465 7374  ""Get the latest
+00020e70: 2063 6f6d 7075 7465 6420 7374 6174 6973   computed statis
+00020e80: 7469 6373 2066 6f72 2074 6865 2077 686f  tics for the who
+00020e90: 6c65 2066 6561 7475 7265 2067 726f 7570  le feature group
+00020ea0: 2e22 2222 0a20 2020 2020 2020 2069 6620  .""".        if 
+00020eb0: 7365 6c66 2e5f 6973 5f74 696d 655f 7472  self._is_time_tr
+00020ec0: 6176 656c 5f65 6e61 626c 6564 2829 3a0a  avel_enabled():.
+00020ed0: 2020 2020 2020 2020 2020 2020 2320 7265              # re
+00020ee0: 7472 6965 7665 2074 6865 206c 6174 6573  trieve the lates
+00020ef0: 7473 2073 7461 7469 7374 6963 7320 636f  ts statistics co
+00020f00: 6d70 7574 6564 206f 6e20 7468 6520 7768  mputed on the wh
+00020f10: 6f6c 6520 4665 6174 7572 6520 4772 6f75  ole Feature Grou
+00020f20: 702c 2069 6e63 6c75 6469 6e67 2061 6c6c  p, including all
+00020f30: 2074 6865 2063 6f6d 6d69 7473 2e0a 2020   the commits..  
+00020f40: 2020 2020 2020 2020 2020 6e6f 7720 3d20            now = 
+00020f50: 7574 696c 2e63 6f6e 7665 7274 5f65 7665  util.convert_eve
+00020f60: 6e74 5f74 696d 655f 746f 5f74 696d 6573  nt_time_to_times
+00020f70: 7461 6d70 2864 6174 6574 696d 652e 6e6f  tamp(datetime.no
+00020f80: 7728 2929 0a20 2020 2020 2020 2020 2020  w()).           
+00020f90: 2072 6574 7572 6e20 7365 6c66 2e5f 7374   return self._st
+00020fa0: 6174 6973 7469 6373 5f65 6e67 696e 652e  atistics_engine.
+00020fb0: 6765 745f 6279 5f74 696d 655f 7769 6e64  get_by_time_wind
+00020fc0: 6f77 280a 2020 2020 2020 2020 2020 2020  ow(.            
+00020fd0: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00020fe0: 2020 2020 2020 2020 2020 7374 6172 745f            start_
+00020ff0: 636f 6d6d 6974 5f74 696d 653d 4e6f 6e65  commit_time=None
+00021000: 2c0a 2020 2020 2020 2020 2020 2020 2020  ,.              
+00021010: 2020 656e 645f 636f 6d6d 6974 5f74 696d    end_commit_tim
+00021020: 653d 6e6f 772c 0a20 2020 2020 2020 2020  e=now,.         
+00021030: 2020 2029 0a20 2020 2020 2020 2072 6574     ).        ret
+00021040: 7572 6e20 7375 7065 7228 292e 7374 6174  urn super().stat
+00021050: 6973 7469 6373 0a0a 2020 2020 4064 6573  istics..    @des
+00021060: 6372 6970 7469 6f6e 2e73 6574 7465 720a  cription.setter.
+00021070: 2020 2020 6465 6620 6465 7363 7269 7074      def descript
+00021080: 696f 6e28 7365 6c66 2c20 6e65 775f 6465  ion(self, new_de
+00021090: 7363 7269 7074 696f 6e29 3a0a 2020 2020  scription):.    
+000210a0: 2020 2020 7365 6c66 2e5f 6465 7363 7269      self._descri
+000210b0: 7074 696f 6e20 3d20 6e65 775f 6465 7363  ption = new_desc
+000210c0: 7269 7074 696f 6e0a 0a20 2020 2040 7469  ription..    @ti
+000210d0: 6d65 5f74 7261 7665 6c5f 666f 726d 6174  me_travel_format
+000210e0: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+000210f0: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
+00021100: 6174 2873 656c 662c 206e 6577 5f74 696d  at(self, new_tim
+00021110: 655f 7472 6176 656c 5f66 6f72 6d61 7429  e_travel_format)
+00021120: 3a0a 2020 2020 2020 2020 7365 6c66 2e5f  :.        self._
+00021130: 7469 6d65 5f74 7261 7665 6c5f 666f 726d  time_travel_form
+00021140: 6174 203d 206e 6577 5f74 696d 655f 7472  at = new_time_tr
+00021150: 6176 656c 5f66 6f72 6d61 740a 0a20 2020  avel_format..   
+00021160: 2040 7061 7274 6974 696f 6e5f 6b65 792e   @partition_key.
+00021170: 7365 7474 6572 0a20 2020 2064 6566 2070  setter.    def p
+00021180: 6172 7469 7469 6f6e 5f6b 6579 2873 656c  artition_key(sel
+00021190: 662c 206e 6577 5f70 6172 7469 7469 6f6e  f, new_partition
+000211a0: 5f6b 6579 3a20 4c69 7374 5b73 7472 5d29  _key: List[str])
+000211b0: 202d 3e20 4e6f 6e65 3a0a 2020 2020 2020   -> None:.      
+000211c0: 2020 7365 6c66 2e5f 7061 7274 6974 696f    self._partitio
+000211d0: 6e5f 6b65 7920 3d20 5b0a 2020 2020 2020  n_key = [.      
+000211e0: 2020 2020 2020 7574 696c 2e61 7574 6f66        util.autof
+000211f0: 6978 5f66 6561 7475 7265 5f6e 616d 6528  ix_feature_name(
+00021200: 706b 2920 666f 7220 706b 2069 6e20 6e65  pk) for pk in ne
+00021210: 775f 7061 7274 6974 696f 6e5f 6b65 790a  w_partition_key.
+00021220: 2020 2020 2020 2020 5d0a 0a20 2020 2040          ]..    @
+00021230: 6875 6469 5f70 7265 636f 6d62 696e 655f  hudi_precombine_
+00021240: 6b65 792e 7365 7474 6572 0a20 2020 2064  key.setter.    d
+00021250: 6566 2068 7564 695f 7072 6563 6f6d 6269  ef hudi_precombi
+00021260: 6e65 5f6b 6579 2873 656c 662c 2068 7564  ne_key(self, hud
+00021270: 695f 7072 6563 6f6d 6269 6e65 5f6b 6579  i_precombine_key
+00021280: 3a20 7374 7229 202d 3e20 4e6f 6e65 3a0a  : str) -> None:.
+00021290: 2020 2020 2020 2020 7365 6c66 2e5f 6875          self._hu
+000212a0: 6469 5f70 7265 636f 6d62 696e 655f 6b65  di_precombine_ke
+000212b0: 7920 3d20 7574 696c 2e61 7574 6f66 6978  y = util.autofix
+000212c0: 5f66 6561 7475 7265 5f6e 616d 6528 6875  _feature_name(hu
+000212d0: 6469 5f70 7265 636f 6d62 696e 655f 6b65  di_precombine_ke
+000212e0: 7929 0a0a 2020 2020 4073 7472 6561 6d2e  y)..    @stream.
+000212f0: 7365 7474 6572 0a20 2020 2064 6566 2073  setter.    def s
+00021300: 7472 6561 6d28 7365 6c66 2c20 7374 7265  tream(self, stre
+00021310: 616d 293a 0a20 2020 2020 2020 2073 656c  am):.        sel
+00021320: 662e 5f73 7472 6561 6d20 3d20 7374 7265  f._stream = stre
+00021330: 616d 0a0a 2020 2020 4070 6172 656e 7473  am..    @parents
+00021340: 2e73 6574 7465 720a 2020 2020 6465 6620  .setter.    def 
+00021350: 7061 7265 6e74 7328 7365 6c66 2c20 6e65  parents(self, ne
+00021360: 775f 7061 7265 6e74 7329 3a0a 2020 2020  w_parents):.    
+00021370: 2020 2020 7365 6c66 2e5f 7061 7265 6e74      self._parent
+00021380: 7320 3d20 6e65 775f 7061 7265 6e74 730a  s = new_parents.
+00021390: 0a0a 636c 6173 7320 4578 7465 726e 616c  ..class External
+000213a0: 4665 6174 7572 6547 726f 7570 2846 6561  FeatureGroup(Fea
+000213b0: 7475 7265 4772 6f75 7042 6173 6529 3a0a  tureGroupBase):.
+000213c0: 2020 2020 4558 5445 524e 414c 5f46 4541      EXTERNAL_FEA
+000213d0: 5455 5245 5f47 524f 5550 203d 2022 4f4e  TURE_GROUP = "ON
+000213e0: 5f44 454d 414e 445f 4645 4154 5552 455f  _DEMAND_FEATURE_
+000213f0: 4752 4f55 5022 0a20 2020 2045 4e54 4954  GROUP".    ENTIT
+00021400: 595f 5459 5045 203d 2022 6665 6174 7572  Y_TYPE = "featur
+00021410: 6567 726f 7570 7322 0a0a 2020 2020 6465  egroups"..    de
+00021420: 6620 5f5f 696e 6974 5f5f 280a 2020 2020  f __init__(.    
+00021430: 2020 2020 7365 6c66 2c0a 2020 2020 2020      self,.      
+00021440: 2020 7374 6f72 6167 655f 636f 6e6e 6563    storage_connec
+00021450: 746f 722c 0a20 2020 2020 2020 2071 7565  tor,.        que
+00021460: 7279 3d4e 6f6e 652c 0a20 2020 2020 2020  ry=None,.       
+00021470: 2064 6174 615f 666f 726d 6174 3d4e 6f6e   data_format=Non
+00021480: 652c 0a20 2020 2020 2020 2070 6174 683d  e,.        path=
+00021490: 4e6f 6e65 2c0a 2020 2020 2020 2020 6f70  None,.        op
+000214a0: 7469 6f6e 733d 7b7d 2c0a 2020 2020 2020  tions={},.      
+000214b0: 2020 6e61 6d65 3d4e 6f6e 652c 0a20 2020    name=None,.   
+000214c0: 2020 2020 2076 6572 7369 6f6e 3d4e 6f6e       version=Non
+000214d0: 652c 0a20 2020 2020 2020 2064 6573 6372  e,.        descr
+000214e0: 6970 7469 6f6e 3d4e 6f6e 652c 0a20 2020  iption=None,.   
+000214f0: 2020 2020 2070 7269 6d61 7279 5f6b 6579       primary_key
+00021500: 3d4e 6f6e 652c 0a20 2020 2020 2020 2066  =None,.        f
+00021510: 6561 7475 7265 7374 6f72 655f 6964 3d4e  eaturestore_id=N
+00021520: 6f6e 652c 0a20 2020 2020 2020 2066 6561  one,.        fea
+00021530: 7475 7265 7374 6f72 655f 6e61 6d65 3d4e  turestore_name=N
+00021540: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
+00021550: 6174 6564 3d4e 6f6e 652c 0a20 2020 2020  ated=None,.     
+00021560: 2020 2063 7265 6174 6f72 3d4e 6f6e 652c     creator=None,
+00021570: 0a20 2020 2020 2020 2069 643d 4e6f 6e65  .        id=None
+00021580: 2c0a 2020 2020 2020 2020 6665 6174 7572  ,.        featur
+00021590: 6573 3d4e 6f6e 652c 0a20 2020 2020 2020  es=None,.       
+000215a0: 206c 6f63 6174 696f 6e3d 4e6f 6e65 2c0a   location=None,.
+000215b0: 2020 2020 2020 2020 7374 6174 6973 7469          statisti
+000215c0: 6373 5f63 6f6e 6669 673d 4e6f 6e65 2c0a  cs_config=None,.
+000215d0: 2020 2020 2020 2020 6576 656e 745f 7469          event_ti
+000215e0: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
+000215f0: 2065 7870 6563 7461 7469 6f6e 5f73 7569   expectation_sui
+00021600: 7465 3d4e 6f6e 652c 0a20 2020 2020 2020  te=None,.       
+00021610: 206f 6e6c 696e 655f 656e 6162 6c65 643d   online_enabled=
+00021620: 4661 6c73 652c 0a20 2020 2020 2020 2068  False,.        h
+00021630: 7265 663d 4e6f 6e65 2c0a 2020 2020 2020  ref=None,.      
+00021640: 2020 6f6e 6c69 6e65 5f74 6f70 6963 5f6e    online_topic_n
+00021650: 616d 653d 4e6f 6e65 2c0a 2020 2020 2020  ame=None,.      
+00021660: 2020 746f 7069 635f 6e61 6d65 3d4e 6f6e    topic_name=Non
+00021670: 652c 0a20 2020 2020 2020 206e 6f74 6966  e,.        notif
+00021680: 6963 6174 696f 6e5f 746f 7069 635f 6e61  ication_topic_na
+00021690: 6d65 3d4e 6f6e 652c 0a20 2020 2020 2020  me=None,.       
+000216a0: 2073 7069 6e65 3d46 616c 7365 2c0a 2020   spine=False,.  
+000216b0: 2020 2020 2020 6465 7072 6563 6174 6564        deprecated
+000216c0: 3d46 616c 7365 2c0a 2020 2020 2020 2020  =False,.        
+000216d0: 2a2a 6b77 6172 6773 2c0a 2020 2020 293a  **kwargs,.    ):
+000216e0: 0a20 2020 2020 2020 2073 7570 6572 2829  .        super()
+000216f0: 2e5f 5f69 6e69 745f 5f28 0a20 2020 2020  .__init__(.     
+00021700: 2020 2020 2020 206e 616d 652c 0a20 2020         name,.   
+00021710: 2020 2020 2020 2020 2076 6572 7369 6f6e           version
+00021720: 2c0a 2020 2020 2020 2020 2020 2020 6665  ,.            fe
+00021730: 6174 7572 6573 746f 7265 5f69 642c 0a20  aturestore_id,. 
+00021740: 2020 2020 2020 2020 2020 206c 6f63 6174             locat
+00021750: 696f 6e2c 0a20 2020 2020 2020 2020 2020  ion,.           
+00021760: 2065 7665 6e74 5f74 696d 653d 6576 656e   event_time=even
+00021770: 745f 7469 6d65 2c0a 2020 2020 2020 2020  t_time,.        
+00021780: 2020 2020 6f6e 6c69 6e65 5f65 6e61 626c      online_enabl
+00021790: 6564 3d6f 6e6c 696e 655f 656e 6162 6c65  ed=online_enable
+000217a0: 642c 0a20 2020 2020 2020 2020 2020 2069  d,.            i
+000217b0: 643d 6964 2c0a 2020 2020 2020 2020 2020  d=id,.          
+000217c0: 2020 6578 7065 6374 6174 696f 6e5f 7375    expectation_su
+000217d0: 6974 653d 6578 7065 6374 6174 696f 6e5f  ite=expectation_
+000217e0: 7375 6974 652c 0a20 2020 2020 2020 2020  suite,.         
+000217f0: 2020 206f 6e6c 696e 655f 746f 7069 635f     online_topic_
+00021800: 6e61 6d65 3d6f 6e6c 696e 655f 746f 7069  name=online_topi
+00021810: 635f 6e61 6d65 2c0a 2020 2020 2020 2020  c_name,.        
+00021820: 2020 2020 746f 7069 635f 6e61 6d65 3d74      topic_name=t
+00021830: 6f70 6963 5f6e 616d 652c 0a20 2020 2020  opic_name,.     
+00021840: 2020 2020 2020 206e 6f74 6966 6963 6174         notificat
+00021850: 696f 6e5f 746f 7069 635f 6e61 6d65 3d6e  ion_topic_name=n
+00021860: 6f74 6966 6963 6174 696f 6e5f 746f 7069  otification_topi
+00021870: 635f 6e61 6d65 2c0a 2020 2020 2020 2020  c_name,.        
+00021880: 2020 2020 6465 7072 6563 6174 6564 3d64      deprecated=d
+00021890: 6570 7265 6361 7465 642c 0a20 2020 2020  eprecated,.     
+000218a0: 2020 2029 0a0a 2020 2020 2020 2020 7365     )..        se
+000218b0: 6c66 2e5f 6665 6174 7572 655f 7374 6f72  lf._feature_stor
+000218c0: 655f 6e61 6d65 203d 2066 6561 7475 7265  e_name = feature
+000218d0: 7374 6f72 655f 6e61 6d65 0a20 2020 2020  store_name.     
+000218e0: 2020 2073 656c 662e 5f64 6573 6372 6970     self._descrip
+000218f0: 7469 6f6e 203d 2064 6573 6372 6970 7469  tion = descripti
+00021900: 6f6e 0a20 2020 2020 2020 2073 656c 662e  on.        self.
+00021910: 5f63 7265 6174 6564 203d 2063 7265 6174  _created = creat
+00021920: 6564 0a20 2020 2020 2020 2073 656c 662e  ed.        self.
+00021930: 5f63 7265 6174 6f72 203d 2075 7365 722e  _creator = user.
+00021940: 5573 6572 2e66 726f 6d5f 7265 7370 6f6e  User.from_respon
+00021950: 7365 5f6a 736f 6e28 6372 6561 746f 7229  se_json(creator)
+00021960: 0a20 2020 2020 2020 2073 656c 662e 5f71  .        self._q
+00021970: 7565 7279 203d 2071 7565 7279 0a20 2020  uery = query.   
+00021980: 2020 2020 2073 656c 662e 5f64 6174 615f       self._data_
+00021990: 666f 726d 6174 203d 2064 6174 615f 666f  format = data_fo
+000219a0: 726d 6174 2e75 7070 6572 2829 2069 6620  rmat.upper() if 
+000219b0: 6461 7461 5f66 6f72 6d61 7420 656c 7365  data_format else
+000219c0: 204e 6f6e 650a 2020 2020 2020 2020 7365   None.        se
+000219d0: 6c66 2e5f 7061 7468 203d 2070 6174 680a  lf._path = path.
+000219e0: 0a20 2020 2020 2020 2073 656c 662e 5f66  .        self._f
+000219f0: 6561 7475 7265 7320 3d20 5b0a 2020 2020  eatures = [.    
+00021a00: 2020 2020 2020 2020 6665 6174 7572 652e          feature.
+00021a10: 4665 6174 7572 652e 6672 6f6d 5f72 6573  Feature.from_res
+00021a20: 706f 6e73 655f 6a73 6f6e 2866 6561 7429  ponse_json(feat)
+00021a30: 2069 6620 6973 696e 7374 616e 6365 2866   if isinstance(f
+00021a40: 6561 742c 2064 6963 7429 2065 6c73 6520  eat, dict) else 
+00021a50: 6665 6174 0a20 2020 2020 2020 2020 2020  feat.           
+00021a60: 2066 6f72 2066 6561 7420 696e 2028 6665   for feat in (fe
+00021a70: 6174 7572 6573 206f 7220 5b5d 290a 2020  atures or []).  
+00021a80: 2020 2020 2020 5d0a 0a20 2020 2020 2020        ]..       
+00021a90: 2073 656c 662e 5f66 6561 7475 7265 5f67   self._feature_g
+00021aa0: 726f 7570 5f65 6e67 696e 6520 3d20 280a  roup_engine = (.
+00021ab0: 2020 2020 2020 2020 2020 2020 6578 7465              exte
+00021ac0: 726e 616c 5f66 6561 7475 7265 5f67 726f  rnal_feature_gro
+00021ad0: 7570 5f65 6e67 696e 652e 4578 7465 726e  up_engine.Extern
+00021ae0: 616c 4665 6174 7572 6547 726f 7570 456e  alFeatureGroupEn
+00021af0: 6769 6e65 2866 6561 7475 7265 7374 6f72  gine(featurestor
+00021b00: 655f 6964 290a 2020 2020 2020 2020 290a  e_id).        ).
+00021b10: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00021b20: 2e5f 6964 3a0a 2020 2020 2020 2020 2020  ._id:.          
+00021b30: 2020 2320 476f 7420 6672 6f6d 2048 6f70    # Got from Hop
+00021b40: 7377 6f72 6b73 2c20 6465 7365 7269 616c  sworks, deserial
+00021b50: 697a 6520 6665 6174 7572 6573 2061 6e64  ize features and
+00021b60: 2073 746f 7261 6765 2063 6f6e 6e65 6374   storage connect
+00021b70: 6f72 0a20 2020 2020 2020 2020 2020 2073  or.            s
+00021b80: 656c 662e 5f66 6561 7475 7265 7320 3d20  elf._features = 
+00021b90: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00021ba0: 2020 5b0a 2020 2020 2020 2020 2020 2020    [.            
+00021bb0: 2020 2020 2020 2020 6665 6174 7572 652e          feature.
+00021bc0: 4665 6174 7572 652e 6672 6f6d 5f72 6573  Feature.from_res
+00021bd0: 706f 6e73 655f 6a73 6f6e 2866 6561 7429  ponse_json(feat)
+00021be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021bf0: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
+00021c00: 6365 2866 6561 742c 2064 6963 7429 0a20  ce(feat, dict). 
+00021c10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c20: 2020 2065 6c73 6520 6665 6174 0a20 2020     else feat.   
+00021c30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021c40: 2066 6f72 2066 6561 7420 696e 2066 6561   for feat in fea
+00021c50: 7475 7265 730a 2020 2020 2020 2020 2020  tures.          
+00021c60: 2020 2020 2020 5d0a 2020 2020 2020 2020        ].        
+00021c70: 2020 2020 2020 2020 6966 2066 6561 7475          if featu
+00021c80: 7265 730a 2020 2020 2020 2020 2020 2020  res.            
+00021c90: 2020 2020 656c 7365 204e 6f6e 650a 2020      else None.  
+00021ca0: 2020 2020 2020 2020 2020 290a 2020 2020            ).    
+00021cb0: 2020 2020 2020 2020 7365 6c66 2e70 7269          self.pri
+00021cc0: 6d61 7279 5f6b 6579 203d 2028 0a20 2020  mary_key = (.   
+00021cd0: 2020 2020 2020 2020 2020 2020 205b 6665               [fe
+00021ce0: 6174 2e6e 616d 6520 666f 7220 6665 6174  at.name for feat
+00021cf0: 2069 6e20 7365 6c66 2e5f 6665 6174 7572   in self._featur
+00021d00: 6573 2069 6620 6665 6174 2e70 7269 6d61  es if feat.prima
+00021d10: 7279 2069 7320 5472 7565 5d0a 2020 2020  ry is True].    
+00021d20: 2020 2020 2020 2020 2020 2020 6966 2073              if s
+00021d30: 656c 662e 5f66 6561 7475 7265 730a 2020  elf._features.  
+00021d40: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00021d50: 7365 205b 5d0a 2020 2020 2020 2020 2020  se [].          
+00021d60: 2020 290a 2020 2020 2020 2020 2020 2020    ).            
+00021d70: 7365 6c66 2e73 7461 7469 7374 6963 735f  self.statistics_
+00021d80: 636f 6e66 6967 203d 2073 7461 7469 7374  config = statist
+00021d90: 6963 735f 636f 6e66 6967 0a0a 2020 2020  ics_config..    
+00021da0: 2020 2020 2020 2020 7365 6c66 2e5f 6f70          self._op
+00021db0: 7469 6f6e 7320 3d20 280a 2020 2020 2020  tions = (.      
+00021dc0: 2020 2020 2020 2020 2020 7b6f 7074 696f            {optio
+00021dd0: 6e5b 226e 616d 6522 5d3a 206f 7074 696f  n["name"]: optio
+00021de0: 6e5b 2276 616c 7565 225d 2066 6f72 206f  n["value"] for o
+00021df0: 7074 696f 6e20 696e 206f 7074 696f 6e73  ption in options
+00021e00: 7d0a 2020 2020 2020 2020 2020 2020 2020  }.              
+00021e10: 2020 6966 206f 7074 696f 6e73 0a20 2020    if options.   
+00021e20: 2020 2020 2020 2020 2020 2020 2065 6c73               els
+00021e30: 6520 4e6f 6e65 0a20 2020 2020 2020 2020  e None.         
+00021e40: 2020 2029 0a20 2020 2020 2020 2065 6c73     ).        els
+00021e50: 653a 0a20 2020 2020 2020 2020 2020 2073  e:.            s
+00021e60: 656c 662e 7072 696d 6172 795f 6b65 7920  elf.primary_key 
+00021e70: 3d20 7072 696d 6172 795f 6b65 790a 2020  = primary_key.  
+00021e80: 2020 2020 2020 2020 2020 7365 6c66 2e73            self.s
+00021e90: 7461 7469 7374 6963 735f 636f 6e66 6967  tatistics_config
+00021ea0: 203d 2073 7461 7469 7374 6963 735f 636f   = statistics_co
+00021eb0: 6e66 6967 0a20 2020 2020 2020 2020 2020  nfig.           
+00021ec0: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
+00021ed0: 3d20 6665 6174 7572 6573 0a20 2020 2020  = features.     
+00021ee0: 2020 2020 2020 2073 656c 662e 5f6f 7074         self._opt
+00021ef0: 696f 6e73 203d 206f 7074 696f 6e73 0a0a  ions = options..
+00021f00: 2020 2020 2020 2020 6966 2073 746f 7261          if stora
+00021f10: 6765 5f63 6f6e 6e65 6374 6f72 2069 7320  ge_connector is 
+00021f20: 6e6f 7420 4e6f 6e65 2061 6e64 2069 7369  not None and isi
+00021f30: 6e73 7461 6e63 6528 7374 6f72 6167 655f  nstance(storage_
+00021f40: 636f 6e6e 6563 746f 722c 2064 6963 7429  connector, dict)
+00021f50: 3a0a 2020 2020 2020 2020 2020 2020 7365  :.            se
+00021f60: 6c66 2e5f 7374 6f72 6167 655f 636f 6e6e  lf._storage_conn
+00021f70: 6563 746f 7220 3d20 7363 2e53 746f 7261  ector = sc.Stora
+00021f80: 6765 436f 6e6e 6563 746f 722e 6672 6f6d  geConnector.from
+00021f90: 5f72 6573 706f 6e73 655f 6a73 6f6e 280a  _response_json(.
+00021fa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021fb0: 7374 6f72 6167 655f 636f 6e6e 6563 746f  storage_connecto
+00021fc0: 720a 2020 2020 2020 2020 2020 2020 290a  r.            ).
+00021fd0: 2020 2020 2020 2020 656c 7365 3a0a 2020          else:.  
+00021fe0: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00021ff0: 7374 6f72 6167 655f 636f 6e6e 6563 746f  storage_connecto
+00022000: 7220 3d20 7374 6f72 6167 655f 636f 6e6e  r = storage_conn
+00022010: 6563 746f 720a 0a20 2020 2020 2020 2073  ector..        s
+00022020: 656c 662e 5f68 7265 6620 3d20 6872 6566  elf._href = href
+00022030: 0a0a 2020 2020 6465 6620 7361 7665 2873  ..    def save(s
+00022040: 656c 6629 3a0a 2020 2020 2020 2020 2222  elf):.        ""
+00022050: 2250 6572 7369 7374 2074 6865 206d 6574  "Persist the met
+00022060: 6164 6174 6120 666f 7220 7468 6973 2065  adata for this e
+00022070: 7874 6572 6e61 6c20 6665 6174 7572 6520  xternal feature 
+00022080: 6772 6f75 702e 0a0a 2020 2020 2020 2020  group...        
+00022090: 5769 7468 6f75 7420 6361 6c6c 696e 6720  Without calling 
+000220a0: 7468 6973 206d 6574 686f 642c 2079 6f75  this method, you
+000220b0: 7220 6665 6174 7572 6520 6772 6f75 7020  r feature group 
+000220c0: 7769 6c6c 206f 6e6c 7920 6578 6973 740a  will only exist.
+000220d0: 2020 2020 2020 2020 696e 2079 6f75 7220          in your 
+000220e0: 5079 7468 6f6e 204b 6572 6e65 6c2c 2062  Python Kernel, b
+000220f0: 7574 206e 6f74 2069 6e20 486f 7073 776f  ut not in Hopswo
+00022100: 726b 732e 0a0a 2020 2020 2020 2020 6060  rks...        ``
+00022110: 6070 7974 686f 6e0a 2020 2020 2020 2020  `python.        
+00022120: 7175 6572 7920 3d20 2253 454c 4543 5420  query = "SELECT 
+00022130: 2a20 4652 4f4d 2073 616c 6573 220a 0a20  * FROM sales".. 
+00022140: 2020 2020 2020 2066 6720 3d20 6665 6174         fg = feat
+00022150: 7572 655f 7374 6f72 652e 6372 6561 7465  ure_store.create
+00022160: 5f65 7874 6572 6e61 6c5f 6665 6174 7572  _external_featur
+00022170: 655f 6772 6f75 7028 6e61 6d65 3d22 7361  e_group(name="sa
+00022180: 6c65 7322 2c0a 2020 2020 2020 2020 2020  les",.          
+00022190: 2020 7665 7273 696f 6e3d 312c 0a20 2020    version=1,.   
+000221a0: 2020 2020 2020 2020 2064 6573 6372 6970           descrip
+000221b0: 7469 6f6e 3d22 5068 7973 6963 616c 2073  tion="Physical s
+000221c0: 686f 7020 7361 6c65 7320 6665 6174 7572  hop sales featur
+000221d0: 6573 222c 0a20 2020 2020 2020 2020 2020  es",.           
+000221e0: 2071 7565 7279 3d71 7565 7279 2c0a 2020   query=query,.  
+000221f0: 2020 2020 2020 2020 2020 7374 6f72 6167            storag
+00022200: 655f 636f 6e6e 6563 746f 723d 636f 6e6e  e_connector=conn
+00022210: 6563 746f 722c 0a20 2020 2020 2020 2020  ector,.         
+00022220: 2020 2070 7269 6d61 7279 5f6b 6579 3d5b     primary_key=[
+00022230: 2773 735f 7374 6f72 655f 736b 275d 2c0a  'ss_store_sk'],.
+00022240: 2020 2020 2020 2020 2020 2020 6576 656e              even
+00022250: 745f 7469 6d65 3d27 7361 6c65 5f64 6174  t_time='sale_dat
+00022260: 6527 0a20 2020 2020 2020 2029 0a0a 2020  e'.        )..  
+00022270: 2020 2020 2020 6667 2e73 6176 6528 290a        fg.save().
+00022280: 2020 2020 2020 2020 2222 220a 2020 2020          """.    
+00022290: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
+000222a0: 655f 6772 6f75 705f 656e 6769 6e65 2e73  e_group_engine.s
+000222b0: 6176 6528 7365 6c66 290a 2020 2020 2020  ave(self).      
+000222c0: 2020 7365 6c66 2e5f 636f 6465 5f65 6e67    self._code_eng
+000222d0: 696e 652e 7361 7665 5f63 6f64 6528 7365  ine.save_code(se
+000222e0: 6c66 290a 0a20 2020 2020 2020 2069 6620  lf)..        if 
+000222f0: 7365 6c66 2e73 7461 7469 7374 6963 735f  self.statistics_
+00022300: 636f 6e66 6967 2e65 6e61 626c 6564 3a0a  config.enabled:.
+00022310: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00022320: 2e5f 7374 6174 6973 7469 6373 5f65 6e67  ._statistics_eng
+00022330: 696e 652e 636f 6d70 7574 655f 616e 645f  ine.compute_and_
+00022340: 7361 7665 5f73 7461 7469 7374 6963 7328  save_statistics(
+00022350: 7365 6c66 290a 0a20 2020 2064 6566 2069  self)..    def i
+00022360: 6e73 6572 7428 0a20 2020 2020 2020 2073  nsert(.        s
+00022370: 656c 662c 0a20 2020 2020 2020 2066 6561  elf,.        fea
+00022380: 7475 7265 733a 2055 6e69 6f6e 5b0a 2020  tures: Union[.  
+00022390: 2020 2020 2020 2020 2020 7064 2e44 6174            pd.Dat
+000223a0: 6146 7261 6d65 2c0a 2020 2020 2020 2020  aFrame,.        
+000223b0: 2020 2020 5479 7065 5661 7228 2270 7973      TypeVar("pys
+000223c0: 7061 726b 2e73 716c 2e44 6174 6146 7261  park.sql.DataFra
+000223d0: 6d65 2229 2c20 2023 206e 6f71 613a 2046  me"),  # noqa: F
+000223e0: 3832 310a 2020 2020 2020 2020 2020 2020  821.            
+000223f0: 5479 7065 5661 7228 2270 7973 7061 726b  TypeVar("pyspark
+00022400: 2e52 4444 2229 2c20 2023 206e 6f71 613a  .RDD"),  # noqa:
+00022410: 2046 3832 310a 2020 2020 2020 2020 2020   F821.          
+00022420: 2020 6e70 2e6e 6461 7272 6179 2c0a 2020    np.ndarray,.  
+00022430: 2020 2020 2020 2020 2020 4c69 7374 5b6c            List[l
+00022440: 6973 745d 2c0a 2020 2020 2020 2020 5d2c  ist],.        ],
+00022450: 0a20 2020 2020 2020 2077 7269 7465 5f6f  .        write_o
+00022460: 7074 696f 6e73 3a20 4f70 7469 6f6e 616c  ptions: Optional
+00022470: 5b44 6963 745b 7374 722c 2041 6e79 5d5d  [Dict[str, Any]]
+00022480: 203d 207b 7d2c 0a20 2020 2020 2020 2076   = {},.        v
+00022490: 616c 6964 6174 696f 6e5f 6f70 7469 6f6e  alidation_option
+000224a0: 733a 204f 7074 696f 6e61 6c5b 4469 6374  s: Optional[Dict
+000224b0: 5b73 7472 2c20 416e 795d 5d20 3d20 7b7d  [str, Any]] = {}
+000224c0: 2c0a 2020 2020 2020 2020 7361 7665 5f63  ,.        save_c
+000224d0: 6f64 653a 204f 7074 696f 6e61 6c5b 626f  ode: Optional[bo
+000224e0: 6f6c 5d20 3d20 5472 7565 2c0a 2020 2020  ol] = True,.    
+000224f0: 2020 2020 7761 6974 3a20 626f 6f6c 203d      wait: bool =
+00022500: 2046 616c 7365 2c0a 2020 2020 2920 2d3e   False,.    ) ->
+00022510: 2054 7570 6c65 5b4f 7074 696f 6e61 6c5b   Tuple[Optional[
+00022520: 4a6f 625d 2c20 4f70 7469 6f6e 616c 5b56  Job], Optional[V
+00022530: 616c 6964 6174 696f 6e52 6570 6f72 745d  alidationReport]
+00022540: 5d3a 0a20 2020 2020 2020 2022 2222 496e  ]:.        """In
+00022550: 7365 7274 2074 6865 2064 6174 6166 7261  sert the datafra
+00022560: 6d65 2066 6561 7475 7265 2076 616c 7565  me feature value
+00022570: 7320 4f4e 4c59 2069 6e20 7468 6520 6f6e  s ONLY in the on
+00022580: 6c69 6e65 2066 6561 7475 7265 2073 746f  line feature sto
+00022590: 7265 2e0a 0a20 2020 2020 2020 2045 7874  re...        Ext
+000225a0: 6572 6e61 6c20 4665 6174 7572 6520 4772  ernal Feature Gr
+000225b0: 6f75 7073 2063 6f6e 7461 696e 7320 6d65  oups contains me
+000225c0: 7461 6461 7461 2061 626f 7574 2066 6561  tadata about fea
+000225d0: 7475 7265 2064 6174 6120 696e 2061 6e20  ture data in an 
+000225e0: 6578 7465 726e 616c 2073 746f 7261 6765  external storage
+000225f0: 2073 7973 7465 6d2e 0a20 2020 2020 2020   system..       
+00022600: 2045 7874 6572 6e61 6c20 7374 6f72 6167   External storag
+00022610: 6520 7379 7374 656d 2061 7265 2075 7375  e system are usu
+00022620: 616c 6c79 206f 6666 6c69 6e65 2c20 6d65  ally offline, me
+00022630: 616e 696e 6720 6665 6174 7572 6520 7661  aning feature va
+00022640: 6c75 6573 2063 616e 6e6f 7420 6265 2072  lues cannot be r
+00022650: 6574 7269 6576 6564 2069 6e20 7265 616c  etrieved in real
+00022660: 2d74 696d 652e 0a20 2020 2020 2020 2049  -time..        I
+00022670: 6e20 6f72 6465 7220 746f 2075 7365 2074  n order to use t
+00022680: 6865 2066 6561 7475 7265 2076 616c 7565  he feature value
+00022690: 7320 666f 7220 7265 616c 2d74 696d 6520  s for real-time 
+000226a0: 7573 652d 6361 7365 732c 2079 6f75 2063  use-cases, you c
+000226b0: 616e 2069 6e73 6572 7420 7468 656d 0a20  an insert them. 
+000226c0: 2020 2020 2020 2069 6e20 486f 7073 6f77         in Hopsow
+000226d0: 6f72 6b73 204f 6e6c 696e 6520 4665 6174  orks Online Feat
+000226e0: 7572 6520 5374 6f72 6520 7669 6120 7468  ure Store via th
+000226f0: 6973 206d 6574 686f 642e 0a0a 2020 2020  is method...    
+00022700: 2020 2020 5468 6520 4f6e 6c69 6e65 2046      The Online F
+00022710: 6561 7475 7265 2053 746f 7265 2068 6173  eature Store has
+00022720: 2061 2073 696e 676c 652d 656e 7472 7920   a single-entry 
+00022730: 7065 7220 7072 696d 6172 7920 6b65 7920  per primary key 
+00022740: 7661 6c75 652c 206d 6561 696e 696e 6720  value, meaining 
+00022750: 7468 6174 2070 726f 7669 6469 6e67 2061  that providing a
+00022760: 206e 6577 2076 616c 7565 2077 6974 680a   new value with.
+00022770: 2020 2020 2020 2020 666f 7220 6120 6769          for a gi
+00022780: 7665 6e20 7072 696d 6172 7920 6b65 7920  ven primary key 
+00022790: 7769 6c6c 206f 7665 7277 7269 7465 2074  will overwrite t
+000227a0: 6865 2065 7869 7374 696e 6720 7661 6c75  he existing valu
+000227b0: 652e 204e 6f20 7265 636f 7264 206f 6620  e. No record of 
+000227c0: 7468 6520 7072 6576 696f 7573 2076 616c  the previous val
+000227d0: 7565 2069 7320 6b65 7074 2e0a 0a20 2020  ue is kept...   
+000227e0: 2020 2020 2021 2121 2065 7861 6d70 6c65       !!! example
+000227f0: 0a20 2020 2020 2020 2020 2020 2060 6060  .            ```
+00022800: 7079 7468 6f6e 0a20 2020 2020 2020 2020  python.         
+00022810: 2020 2023 2063 6f6e 6e65 6374 2074 6f20     # connect to 
+00022820: 7468 6520 4665 6174 7572 6520 5374 6f72  the Feature Stor
+00022830: 650a 2020 2020 2020 2020 2020 2020 6673  e.            fs
+00022840: 203d 202e 2e2e 0a0a 2020 2020 2020 2020   = .....        
+00022850: 2020 2020 2320 6765 7420 7468 6520 4578      # get the Ex
+00022860: 7465 726e 616c 2046 6561 7475 7265 2047  ternal Feature G
+00022870: 726f 7570 2069 6e73 7461 6e63 650a 2020  roup instance.  
+00022880: 2020 2020 2020 2020 2020 6667 203d 2066            fg = f
+00022890: 732e 6765 745f 6665 6174 7572 655f 6772  s.get_feature_gr
+000228a0: 6f75 7028 6e61 6d65 3d22 6578 7465 726e  oup(name="extern
+000228b0: 616c 5f73 616c 6573 5f72 6563 6f72 6473  al_sales_records
+000228c0: 222c 2076 6572 7369 6f6e 3d31 290a 0a20  ", version=1).. 
+000228d0: 2020 2020 2020 2020 2020 2023 2067 6574             # get
+000228e0: 2074 6865 2066 6561 7475 7265 2076 616c   the feature val
+000228f0: 7565 732c 2065 2e67 2072 6561 6469 6e67  ues, e.g reading
+00022900: 2066 726f 6d20 6373 7620 6669 6c65 7320   from csv files 
+00022910: 696e 2061 2053 3320 6275 636b 6574 0a20  in a S3 bucket. 
+00022920: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00022930: 7265 5f76 616c 7565 7320 3d20 2e2e 2e0a  re_values = ....
+00022940: 0a20 2020 2020 2020 2020 2020 2023 2069  .            # i
+00022950: 6e73 6572 7420 7468 6520 6665 6174 7572  nsert the featur
+00022960: 6520 7661 6c75 6573 2069 6e20 7468 6520  e values in the 
+00022970: 6f6e 6c69 6e65 2066 6561 7475 7265 2073  online feature s
+00022980: 746f 7265 0a20 2020 2020 2020 2020 2020  tore.           
+00022990: 2066 672e 696e 7365 7274 2866 6561 7475   fg.insert(featu
+000229a0: 7265 5f76 616c 7565 7329 0a20 2020 2020  re_values).     
+000229b0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
+000229c0: 2020 2020 2121 2120 4e6f 7465 0a20 2020      !!! Note.   
+000229d0: 2020 2020 2020 2020 2044 6174 6120 5661           Data Va
+000229e0: 6c69 6461 7469 6f6e 2076 6961 2047 7265  lidation via Gre
+000229f0: 6174 2045 7870 6563 7461 7469 6f6e 2069  at Expectation i
+00022a00: 7320 7375 7070 6f72 7465 6420 6966 2079  s supported if y
+00022a10: 6f75 2068 6176 6520 6174 7461 6368 6564  ou have attached
+00022a20: 2061 6e20 6578 7065 6374 6174 696f 6e20   an expectation 
+00022a30: 7375 6974 6520 746f 0a20 2020 2020 2020  suite to.       
+00022a40: 2020 2020 2079 6f75 7220 4578 7465 726e       your Extern
+00022a50: 616c 2046 6561 7475 7265 2047 726f 7570  al Feature Group
+00022a60: 2e20 486f 7765 7665 722c 2061 7320 6f70  . However, as op
+00022a70: 706f 7365 6420 746f 2072 6567 756c 6172  posed to regular
+00022a80: 2046 6561 7475 7265 2047 726f 7570 732c   Feature Groups,
+00022a90: 2074 6869 7320 6361 6e20 6c65 6164 2074   this can lead t
+00022aa0: 6f0a 2020 2020 2020 2020 2020 2020 6469  o.            di
+00022ab0: 7363 7265 7061 6e63 6965 7320 6265 7477  screpancies betw
+00022ac0: 6565 6e20 7468 6520 6461 7461 2069 6e20  een the data in 
+00022ad0: 7468 6520 6578 7465 726e 616c 2073 746f  the external sto
+00022ae0: 7261 6765 2073 7973 7465 6d20 616e 6420  rage system and 
+00022af0: 7468 6520 6f6e 6c69 6e65 2066 6561 7475  the online featu
+00022b00: 7265 2073 746f 7265 2e0a 0a20 2020 2020  re store...     
+00022b10: 2020 2023 2041 7267 756d 656e 7473 0a20     # Arguments. 
+00022b20: 2020 2020 2020 2020 2020 2066 6561 7475             featu
+00022b30: 7265 733a 2044 6174 6146 7261 6d65 2c20  res: DataFrame, 
+00022b40: 5244 442c 204e 6461 7272 6179 2c20 6c69  RDD, Ndarray, li
+00022b50: 7374 2e20 4665 6174 7572 6573 2074 6f20  st. Features to 
+00022b60: 6265 2073 6176 6564 2e0a 2020 2020 2020  be saved..      
+00022b70: 2020 2020 2020 7772 6974 655f 6f70 7469        write_opti
+00022b80: 6f6e 733a 2041 6464 6974 696f 6e61 6c20  ons: Additional 
+00022b90: 7772 6974 6520 6f70 7469 6f6e 7320 6173  write options as
+00022ba0: 206b 6579 2d76 616c 7565 2070 6169 7273   key-value pairs
+00022bb0: 2c20 6465 6661 756c 7473 2074 6f20 607b  , defaults to `{
+00022bc0: 7d60 2e0a 2020 2020 2020 2020 2020 2020  }`..            
+00022bd0: 2020 2020 5768 656e 2075 7369 6e67 2074      When using t
+00022be0: 6865 2060 7079 7468 6f6e 6020 656e 6769  he `python` engi
+00022bf0: 6e65 2c20 7772 6974 655f 6f70 7469 6f6e  ne, write_option
+00022c00: 7320 6361 6e20 636f 6e74 6169 6e20 7468  s can contain th
+00022c10: 650a 2020 2020 2020 2020 2020 2020 2020  e.              
+00022c20: 2020 666f 6c6c 6f77 696e 6720 656e 7472    following entr
+00022c30: 6965 733a 0a20 2020 2020 2020 2020 2020  ies:.           
+00022c40: 2020 2020 202a 206b 6579 2060 6b61 666b       * key `kafk
+00022c50: 615f 7072 6f64 7563 6572 5f63 6f6e 6669  a_producer_confi
+00022c60: 6760 2061 6e64 2076 616c 7565 2061 6e20  g` and value an 
+00022c70: 6f62 6a65 6374 206f 6620 7479 7065 205b  object of type [
+00022c80: 7072 6f70 6572 7469 6573 5d28 6874 7470  properties](http
+00022c90: 733a 2f2f 646f 6373 2e63 6f6e 666c 7565  s://docs.conflue
+00022ca0: 6e74 2e69 6f2f 706c 6174 666f 726d 2f63  nt.io/platform/c
+00022cb0: 7572 7265 6e74 2f63 6c69 656e 7473 2f6c  urrent/clients/l
+00022cc0: 6962 7264 6b61 666b 612f 6874 6d6c 2f6d  ibrdkafka/html/m
+00022cd0: 645f 434f 4e46 4947 5552 4154 494f 4e2e  d_CONFIGURATION.
+00022ce0: 6874 6d6c 6e29 0a20 2020 2020 2020 2020  htmln).         
+00022cf0: 2020 2020 2020 2020 2075 7365 6420 746f           used to
+00022d00: 2063 6f6e 6669 6775 7265 2074 6865 204b   configure the K
+00022d10: 6166 6b61 2063 6c69 656e 742e 2054 6f20  afka client. To 
+00022d20: 6f70 7469 6d69 7a65 2066 6f72 2074 6872  optimize for thr
+00022d30: 6f75 6768 7075 7420 696e 2068 6967 6820  oughput in high 
+00022d40: 6c61 7465 6e63 7920 636f 6e6e 6563 7469  latency connecti
+00022d50: 6f6e 2063 6f6e 7369 6465 720a 2020 2020  on consider.    
+00022d60: 2020 2020 2020 2020 2020 2020 2020 6368                ch
+00022d70: 616e 6769 6e67 205b 7072 6f64 7563 6572  anging [producer
+00022d80: 2070 726f 7065 7274 6965 735d 2868 7474   properties](htt
+00022d90: 7073 3a2f 2f64 6f63 732e 636f 6e66 6c75  ps://docs.conflu
+00022da0: 656e 742e 696f 2f63 6c6f 7564 2f63 7572  ent.io/cloud/cur
+00022db0: 7265 6e74 2f63 6c69 656e 742d 6170 7073  rent/client-apps
+00022dc0: 2f6f 7074 696d 697a 696e 672f 7468 726f  /optimizing/thro
+00022dd0: 7567 6870 7574 2e68 746d 6c23 7072 6f64  ughput.html#prod
+00022de0: 7563 6572 292e 0a20 2020 2020 2020 2020  ucer)..         
+00022df0: 2020 2020 2020 202a 206b 6579 2060 696e         * key `in
+00022e00: 7465 726e 616c 5f6b 6166 6b61 6020 616e  ternal_kafka` an
+00022e10: 6420 7661 6c75 6520 6054 7275 6560 206f  d value `True` o
+00022e20: 7220 6046 616c 7365 6020 696e 2063 6173  r `False` in cas
+00022e30: 6520 796f 7520 6573 7461 626c 6973 6865  e you establishe
+00022e40: 640a 2020 2020 2020 2020 2020 2020 2020  d.              
+00022e50: 2020 2020 636f 6e6e 6563 7469 7669 7479      connectivity
+00022e60: 2066 726f 6d20 796f 7520 5079 7468 6f6e   from you Python
+00022e70: 2065 6e76 6972 6f6e 6d65 6e74 2074 6f20   environment to 
+00022e80: 7468 6520 696e 7465 726e 616c 2061 6476  the internal adv
+00022e90: 6572 7469 7365 640a 2020 2020 2020 2020  ertised.        
+00022ea0: 2020 2020 2020 2020 2020 6c69 7374 656e            listen
+00022eb0: 6572 7320 6f66 2074 6865 2048 6f70 7377  ers of the Hopsw
+00022ec0: 6f72 6b73 204b 6166 6b61 2043 6c75 7374  orks Kafka Clust
+00022ed0: 6572 2e20 4465 6661 756c 7473 2074 6f20  er. Defaults to 
+00022ee0: 6046 616c 7365 6020 616e 640a 2020 2020  `False` and.    
+00022ef0: 2020 2020 2020 2020 2020 2020 2020 7769                wi
+00022f00: 6c6c 2075 7365 2065 7874 6572 6e61 6c20  ll use external 
+00022f10: 6c69 7374 656e 6572 7320 7768 656e 2063  listeners when c
+00022f20: 6f6e 6e65 6374 696e 6720 6672 6f6d 206f  onnecting from o
+00022f30: 7574 7369 6465 206f 6620 486f 7073 776f  utside of Hopswo
+00022f40: 726b 732e 0a20 2020 2020 2020 2020 2020  rks..           
+00022f50: 2076 616c 6964 6174 696f 6e5f 6f70 7469   validation_opti
+00022f60: 6f6e 733a 2041 6464 6974 696f 6e61 6c20  ons: Additional 
+00022f70: 7661 6c69 6461 7469 6f6e 206f 7074 696f  validation optio
+00022f80: 6e73 2061 7320 6b65 792d 7661 6c75 6520  ns as key-value 
+00022f90: 7061 6972 732c 2064 6566 6175 6c74 7320  pairs, defaults 
+00022fa0: 746f 2060 7b7d 602e 0a20 2020 2020 2020  to `{}`..       
+00022fb0: 2020 2020 2020 2020 202a 206b 6579 2060           * key `
+00022fc0: 7275 6e5f 7661 6c69 6461 7469 6f6e 6020  run_validation` 
+00022fd0: 626f 6f6c 6561 6e20 7661 6c75 652c 2073  boolean value, s
+00022fe0: 6574 2074 6f20 6046 616c 7365 6020 746f  et to `False` to
+00022ff0: 2073 6b69 7020 7661 6c69 6461 7469 6f6e   skip validation
+00023000: 2074 656d 706f 7261 7269 6c79 206f 6e20   temporarily on 
+00023010: 696e 6765 7374 696f 6e2e 0a20 2020 2020  ingestion..     
+00023020: 2020 2020 2020 2020 2020 202a 206b 6579             * key
+00023030: 2060 7361 7665 5f72 6570 6f72 7460 2062   `save_report` b
+00023040: 6f6f 6c65 616e 2076 616c 7565 2c20 7365  oolean value, se
+00023050: 7420 746f 2060 4661 6c73 6560 2074 6f20  t to `False` to 
+00023060: 736b 6970 2075 706c 6f61 6420 6f66 2074  skip upload of t
+00023070: 6865 2076 616c 6964 6174 696f 6e20 7265  he validation re
+00023080: 706f 7274 2074 6f20 486f 7073 776f 726b  port to Hopswork
+00023090: 732e 0a20 2020 2020 2020 2020 2020 2020  s..             
+000230a0: 2020 202a 206b 6579 2060 6765 5f76 616c     * key `ge_val
+000230b0: 6964 6174 655f 6b77 6172 6773 6020 6120  idate_kwargs` a 
+000230c0: 6469 6374 696f 6e61 7279 2063 6f6e 7461  dictionary conta
+000230d0: 696e 696e 6720 6b77 6172 6773 2066 6f72  ining kwargs for
+000230e0: 2074 6865 2076 616c 6964 6174 6520 6d65   the validate me
+000230f0: 7468 6f64 206f 6620 4772 6561 7420 4578  thod of Great Ex
+00023100: 7065 6374 6174 696f 6e73 2e0a 2020 2020  pectations..    
+00023110: 2020 2020 2020 2020 2020 2020 2a20 6b65              * ke
+00023120: 7920 6066 6574 6368 5f65 7870 6563 7461  y `fetch_expecta
+00023130: 7469 6f6e 5f73 7569 7465 6020 6120 626f  tion_suite` a bo
+00023140: 6f6c 6561 6e20 7661 6c75 652c 2062 7920  olean value, by 
+00023150: 6465 6661 756c 7420 6054 7275 6560 2c20  default `True`, 
+00023160: 746f 2063 6f6e 7472 6f6c 2077 6865 7468  to control wheth
+00023170: 6572 2074 6865 2065 7870 6563 7461 7469  er the expectati
+00023180: 6f6e 0a20 2020 2020 2020 2020 2020 2020  on.             
+00023190: 2020 2020 2020 7375 6974 6520 6f66 2074        suite of t
+000231a0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+000231b0: 2073 686f 756c 6420 6265 2066 6574 6368   should be fetch
+000231c0: 6564 2062 6566 6f72 6520 6576 6572 7920  ed before every 
+000231d0: 696e 7365 7274 2e0a 2020 2020 2020 2020  insert..        
+000231e0: 2020 2020 7361 7665 5f63 6f64 653a 2057      save_code: W
+000231f0: 6865 6e20 7275 6e6e 696e 6720 4853 4653  hen running HSFS
+00023200: 206f 6e20 486f 7073 776f 726b 7320 6f72   on Hopsworks or
+00023210: 2044 6174 6162 7269 636b 732c 2048 5346   Databricks, HSF
+00023220: 5320 6361 6e20 7361 7665 2074 6865 2063  S can save the c
+00023230: 6f64 652f 6e6f 7465 626f 6f6b 2075 7365  ode/notebook use
+00023240: 6420 746f 2063 7265 6174 650a 2020 2020  d to create.    
+00023250: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+00023260: 6665 6174 7572 6520 6772 6f75 7020 6f72  feature group or
+00023270: 2075 7365 6420 746f 2069 6e73 6572 7420   used to insert 
+00023280: 6461 7461 2074 6f20 6974 2e20 5768 656e  data to it. When
+00023290: 2063 616c 6c69 6e67 2074 6865 2060 696e   calling the `in
+000232a0: 7365 7274 6020 6d65 7468 6f64 2072 6570  sert` method rep
+000232b0: 6561 7465 646c 790a 2020 2020 2020 2020  eatedly.        
+000232c0: 2020 2020 2020 2020 7769 7468 2073 6d61          with sma
+000232d0: 6c6c 2062 6174 6368 6573 206f 6620 6461  ll batches of da
+000232e0: 7461 2c20 7468 6973 2063 616e 2073 6c6f  ta, this can slo
+000232f0: 7720 646f 776e 2074 6865 2077 7269 7465  w down the write
+00023300: 732e 2055 7365 2074 6869 7320 6f70 7469  s. Use this opti
+00023310: 6f6e 2074 6f20 7475 726e 206f 6666 2073  on to turn off s
+00023320: 6176 696e 670a 2020 2020 2020 2020 2020  aving.          
+00023330: 2020 2020 2020 636f 6465 2e20 4465 6661        code. Defa
+00023340: 756c 7473 2074 6f20 6054 7275 6560 2e0a  ults to `True`..
+00023350: 0a20 2020 2020 2020 2023 2052 6574 7572  .        # Retur
+00023360: 6e73 0a20 2020 2020 2020 2020 2020 2054  ns.            T
+00023370: 7570 6c65 2860 4a6f 6260 2c20 6056 616c  uple(`Job`, `Val
+00023380: 6964 6174 696f 6e52 6570 6f72 7460 2920  idationReport`) 
+00023390: 5468 6520 7661 6c69 6461 7469 6f6e 2072  The validation r
+000233a0: 6570 6f72 7420 6966 2076 616c 6964 6174  eport if validat
+000233b0: 696f 6e20 6973 2065 6e61 626c 6564 2e0a  ion is enabled..
+000233c0: 0a20 2020 2020 2020 2023 2052 6169 7365  .        # Raise
+000233d0: 730a 2020 2020 2020 2020 2020 2020 6068  s.            `h
+000233e0: 7366 732e 636c 6965 6e74 2e65 7863 6570  sfs.client.excep
+000233f0: 7469 6f6e 732e 5265 7374 4150 4945 7272  tions.RestAPIErr
+00023400: 6f72 602e 2065 2e67 2066 6169 6c20 746f  or`. e.g fail to
+00023410: 2063 7265 6174 6520 6665 6174 7572 6520   create feature 
+00023420: 6772 6f75 702c 2064 6174 6166 7261 6d65  group, dataframe
+00023430: 2073 6368 656d 6120 646f 6573 206e 6f74   schema does not
+00023440: 206d 6174 6368 0a20 2020 2020 2020 2020   match.         
+00023450: 2020 2020 2020 2065 7869 7374 696e 6720         existing 
+00023460: 6665 6174 7572 6520 6772 6f75 7020 7363  feature group sc
+00023470: 6865 6d61 2c20 6574 632e 0a20 2020 2020  hema, etc..     
+00023480: 2020 2020 2020 2060 6873 6673 2e63 6c69         `hsfs.cli
+00023490: 656e 742e 6578 6365 7074 696f 6e73 2e44  ent.exceptions.D
+000234a0: 6174 6156 616c 6964 6174 696f 6e45 7863  ataValidationExc
+000234b0: 6570 7469 6f6e 602e 2049 6620 6461 7461  eption`. If data
+000234c0: 2076 616c 6964 6174 696f 6e20 6661 696c   validation fail
+000234d0: 7320 616e 6420 7468 6520 6578 7065 6374  s and the expect
+000234e0: 6174 696f 6e0a 2020 2020 2020 2020 2020  ation.          
+000234f0: 2020 2020 2020 7375 6974 6520 6076 616c        suite `val
+00023500: 6964 6174 696f 6e5f 696e 6765 7374 696f  idation_ingestio
+00023510: 6e5f 706f 6c69 6379 6020 6973 2073 6574  n_policy` is set
+00023520: 2074 6f20 6053 5452 4943 5460 2e20 4461   to `STRICT`. Da
+00023530: 7461 2069 7320 4e4f 5420 696e 6765 7374  ta is NOT ingest
+00023540: 6564 2e0a 0a20 2020 2020 2020 2022 2222  ed...        """
+00023550: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00023560: 5f64 6174 6166 7261 6d65 203d 2065 6e67  _dataframe = eng
+00023570: 696e 652e 6765 745f 696e 7374 616e 6365  ine.get_instance
+00023580: 2829 2e63 6f6e 7665 7274 5f74 6f5f 6465  ().convert_to_de
+00023590: 6661 756c 745f 6461 7461 6672 616d 6528  fault_dataframe(
+000235a0: 6665 6174 7572 6573 290a 0a20 2020 2020  features)..     
+000235b0: 2020 2069 6620 7772 6974 655f 6f70 7469     if write_opti
+000235c0: 6f6e 7320 6973 204e 6f6e 653a 0a20 2020  ons is None:.   
+000235d0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
+000235e0: 7074 696f 6e73 203d 207b 7d0a 2020 2020  ptions = {}.    
+000235f0: 2020 2020 6966 2022 7761 6974 5f66 6f72      if "wait_for
+00023600: 5f6a 6f62 2220 6e6f 7420 696e 2077 7269  _job" not in wri
+00023610: 7465 5f6f 7074 696f 6e73 3a0a 2020 2020  te_options:.    
+00023620: 2020 2020 2020 2020 7772 6974 655f 6f70          write_op
+00023630: 7469 6f6e 735b 2277 6169 745f 666f 725f  tions["wait_for_
+00023640: 6a6f 6222 5d20 3d20 7761 6974 0a0a 2020  job"] = wait..  
+00023650: 2020 2020 2020 6a6f 622c 2067 655f 7265        job, ge_re
+00023660: 706f 7274 203d 2073 656c 662e 5f66 6561  port = self._fea
+00023670: 7475 7265 5f67 726f 7570 5f65 6e67 696e  ture_group_engin
+00023680: 652e 696e 7365 7274 280a 2020 2020 2020  e.insert(.      
+00023690: 2020 2020 2020 7365 6c66 2c0a 2020 2020        self,.    
+000236a0: 2020 2020 2020 2020 6665 6174 7572 655f          feature_
+000236b0: 6461 7461 6672 616d 653d 6665 6174 7572  dataframe=featur
+000236c0: 655f 6461 7461 6672 616d 652c 0a20 2020  e_dataframe,.   
+000236d0: 2020 2020 2020 2020 2077 7269 7465 5f6f           write_o
+000236e0: 7074 696f 6e73 3d77 7269 7465 5f6f 7074  ptions=write_opt
+000236f0: 696f 6e73 2c0a 2020 2020 2020 2020 2020  ions,.          
+00023700: 2020 7661 6c69 6461 7469 6f6e 5f6f 7074    validation_opt
+00023710: 696f 6e73 3d7b 2273 6176 655f 7265 706f  ions={"save_repo
+00023720: 7274 223a 2054 7275 652c 202a 2a76 616c  rt": True, **val
+00023730: 6964 6174 696f 6e5f 6f70 7469 6f6e 737d  idation_options}
+00023740: 2c0a 2020 2020 2020 2020 290a 0a20 2020  ,.        )..   
+00023750: 2020 2020 2069 6620 7361 7665 5f63 6f64       if save_cod
+00023760: 6520 616e 6420 280a 2020 2020 2020 2020  e and (.        
+00023770: 2020 2020 6765 5f72 6570 6f72 7420 6973      ge_report is
+00023780: 204e 6f6e 6520 6f72 2067 655f 7265 706f   None or ge_repo
+00023790: 7274 2e69 6e67 6573 7469 6f6e 5f72 6573  rt.ingestion_res
+000237a0: 756c 7420 3d3d 2022 494e 4745 5354 4544  ult == "INGESTED
+000237b0: 220a 2020 2020 2020 2020 293a 0a20 2020  ".        ):.   
+000237c0: 2020 2020 2020 2020 2073 656c 662e 5f63           self._c
+000237d0: 6f64 655f 656e 6769 6e65 2e73 6176 655f  ode_engine.save_
+000237e0: 636f 6465 2873 656c 6629 0a0a 2020 2020  code(self)..    
+000237f0: 2020 2020 6966 2073 656c 662e 7374 6174      if self.stat
+00023800: 6973 7469 6373 5f63 6f6e 6669 672e 656e  istics_config.en
+00023810: 6162 6c65 643a 0a20 2020 2020 2020 2020  abled:.         
+00023820: 2020 2077 6172 6e69 6e67 732e 7761 726e     warnings.warn
+00023830: 280a 2020 2020 2020 2020 2020 2020 2020  (.              
+00023840: 2020 280a 2020 2020 2020 2020 2020 2020    (.            
+00023850: 2020 2020 2020 2020 2253 7461 7469 7374          "Statist
+00023860: 6963 7320 6172 6520 6e6f 7420 636f 6d70  ics are not comp
+00023870: 7574 6564 2066 6f72 2069 6e73 6572 7469  uted for inserti
+00023880: 6f6e 2074 6f20 6f6e 6c69 6e65 2065 6e61  on to online ena
+00023890: 626c 6564 2065 7874 6572 6e61 6c20 6665  bled external fe
+000238a0: 6174 7572 6520 6772 6f75 7020 607b 7d60  ature group `{}`
+000238b0: 2c20 7769 7468 2076 6572 7369 6f6e 220a  , with version".
+000238c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000238d0: 2020 2020 2220 607b 7d60 2e20 4361 6c6c      " `{}`. Call
+000238e0: 2060 636f 6d70 7574 655f 7374 6174 6973   `compute_statis
+000238f0: 7469 6373 6020 6578 706c 6963 6974 6c79  tics` explicitly
+00023900: 2074 6f20 636f 6d70 7574 6520 7374 6174   to compute stat
+00023910: 6973 7469 6373 206f 7665 7220 7468 6520  istics over the 
+00023920: 6461 7461 2069 6e20 7468 6520 6578 7465  data in the exte
+00023930: 726e 616c 2073 746f 7261 6765 2073 7973  rnal storage sys
+00023940: 7465 6d2e 220a 2020 2020 2020 2020 2020  tem.".          
+00023950: 2020 2020 2020 292e 666f 726d 6174 2873        ).format(s
+00023960: 656c 662e 5f6e 616d 652c 2073 656c 662e  elf._name, self.
+00023970: 5f76 6572 7369 6f6e 292c 0a20 2020 2020  _version),.     
+00023980: 2020 2020 2020 2020 2020 2075 7469 6c2e             util.
+00023990: 5374 6f72 6167 6557 6172 6e69 6e67 2c0a  StorageWarning,.
+000239a0: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+000239b0: 2020 2020 2020 2072 6574 7572 6e20 280a         return (.
+000239c0: 2020 2020 2020 2020 2020 2020 6a6f 622c              job,
+000239d0: 0a20 2020 2020 2020 2020 2020 2067 655f  .            ge_
+000239e0: 7265 706f 7274 2e74 6f5f 6765 5f74 7970  report.to_ge_typ
+000239f0: 6528 2920 6966 2067 655f 7265 706f 7274  e() if ge_report
+00023a00: 2069 7320 6e6f 7420 4e6f 6e65 2065 6c73   is not None els
+00023a10: 6520 4e6f 6e65 2c0a 2020 2020 2020 2020  e None,.        
+00023a20: 290a 0a20 2020 2064 6566 2072 6561 6428  )..    def read(
+00023a30: 0a20 2020 2020 2020 2073 656c 662c 2064  .        self, d
+00023a40: 6174 6166 7261 6d65 5f74 7970 653a 204f  ataframe_type: O
+00023a50: 7074 696f 6e61 6c5b 7374 725d 203d 2022  ptional[str] = "
+00023a60: 6465 6661 756c 7422 2c20 6f6e 6c69 6e65  default", online
+00023a70: 3a20 4f70 7469 6f6e 616c 5b62 6f6f 6c5d  : Optional[bool]
+00023a80: 203d 2046 616c 7365 0a20 2020 2029 3a0a   = False.    ):.
+00023a90: 2020 2020 2020 2020 2222 2247 6574 2074          """Get t
+00023aa0: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00023ab0: 2061 7320 6120 4461 7461 4672 616d 652e   as a DataFrame.
+00023ac0: 0a0a 2020 2020 2020 2020 2121 2120 6578  ..        !!! ex
+00023ad0: 616d 706c 650a 2020 2020 2020 2020 2020  ample.          
+00023ae0: 2020 6060 6070 7974 686f 6e0a 2020 2020    ```python.    
+00023af0: 2020 2020 2020 2020 2320 636f 6e6e 6563          # connec
+00023b00: 7420 746f 2074 6865 2046 6561 7475 7265  t to the Feature
+00023b10: 2053 746f 7265 0a20 2020 2020 2020 2020   Store.         
+00023b20: 2020 2066 7320 3d20 2e2e 2e0a 0a20 2020     fs = .....   
+00023b30: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
+00023b40: 6865 2046 6561 7475 7265 2047 726f 7570  he Feature Group
+00023b50: 2069 6e73 7461 6e63 650a 2020 2020 2020   instance.      
+00023b60: 2020 2020 2020 6667 203d 2066 732e 6765        fg = fs.ge
+00023b70: 745f 6f72 5f63 7265 6174 655f 6665 6174  t_or_create_feat
+00023b80: 7572 655f 6772 6f75 7028 2e2e 2e29 0a0a  ure_group(...)..
+00023b90: 2020 2020 2020 2020 2020 2020 6466 203d              df =
+00023ba0: 2066 672e 7265 6164 2829 0a20 2020 2020   fg.read().     
+00023bb0: 2020 2020 2020 2060 6060 0a0a 2020 2020         ```..    
+00023bc0: 2020 2020 2121 2120 7761 726e 696e 6720      !!! warning 
+00023bd0: 2245 6e67 696e 6520 5375 7070 6f72 7422  "Engine Support"
+00023be0: 0a20 2020 2020 2020 2020 2020 202a 2a53  .            **S
+00023bf0: 7061 726b 206f 6e6c 792a 2a0a 0a20 2020  park only**..   
+00023c00: 2020 2020 2020 2020 2052 6561 6469 6e67           Reading
+00023c10: 2061 6e20 4578 7465 726e 616c 2046 6561   an External Fea
+00023c20: 7475 7265 2047 726f 7570 2064 6972 6563  ture Group direc
+00023c30: 746c 7920 696e 746f 2061 2050 616e 6461  tly into a Panda
+00023c40: 7320 4461 7461 6672 616d 6520 7573 696e  s Dataframe usin
+00023c50: 670a 2020 2020 2020 2020 2020 2020 5079  g.            Py
+00023c60: 7468 6f6e 2f50 616e 6461 7320 6173 2045  thon/Pandas as E
+00023c70: 6e67 696e 6520 6973 206e 6f74 2073 7570  ngine is not sup
+00023c80: 706f 7274 6564 2c20 686f 7765 7665 722c  ported, however,
+00023c90: 2079 6f75 2063 616e 2075 7365 2074 6865   you can use the
+00023ca0: 0a20 2020 2020 2020 2020 2020 2051 7565  .            Que
+00023cb0: 7279 2041 5049 2074 6f20 6372 6561 7465  ry API to create
+00023cc0: 2046 6561 7475 7265 2056 6965 7773 2f54   Feature Views/T
+00023cd0: 7261 696e 696e 6720 4461 7461 2063 6f6e  raining Data con
+00023ce0: 7461 696e 696e 6720 4578 7465 726e 616c  taining External
+00023cf0: 0a20 2020 2020 2020 2020 2020 2046 6561  .            Fea
+00023d00: 7475 7265 2047 726f 7570 732e 0a0a 2020  ture Groups...  
+00023d10: 2020 2020 2020 2320 4172 6775 6d65 6e74        # Argument
+00023d20: 730a 2020 2020 2020 2020 2020 2020 6461  s.            da
+00023d30: 7461 6672 616d 655f 7479 7065 3a20 7374  taframe_type: st
+00023d40: 722c 206f 7074 696f 6e61 6c2e 2050 6f73  r, optional. Pos
+00023d50: 7369 626c 6520 7661 6c75 6573 2061 7265  sible values are
+00023d60: 2060 2264 6566 6175 6c74 2260 2c20 6022   `"default"`, `"
+00023d70: 7370 6172 6b22 602c 0a20 2020 2020 2020  spark"`,.       
+00023d80: 2020 2020 2020 2020 2060 2270 616e 6461           `"panda
+00023d90: 7322 602c 2060 226e 756d 7079 2260 206f  s"`, `"numpy"` o
+00023da0: 7220 6022 7079 7468 6f6e 2260 2c20 6465  r `"python"`, de
+00023db0: 6661 756c 7473 2074 6f20 6022 6465 6661  faults to `"defa
+00023dc0: 756c 7422 602e 0a20 2020 2020 2020 2020  ult"`..         
+00023dd0: 2020 206f 6e6c 696e 653a 2062 6f6f 6c2c     online: bool,
+00023de0: 206f 7074 696f 6e61 6c2e 2049 6620 6054   optional. If `T
+00023df0: 7275 6560 2072 6561 6420 6672 6f6d 206f  rue` read from o
+00023e00: 6e6c 696e 6520 6665 6174 7572 6520 7374  nline feature st
+00023e10: 6f72 652c 2064 6566 6175 6c74 730a 2020  ore, defaults.  
+00023e20: 2020 2020 2020 2020 2020 2020 2020 746f                to
+00023e30: 2060 4661 6c73 6560 2e0a 0a20 2020 2020   `False`...     
+00023e40: 2020 2023 2052 6574 7572 6e73 0a20 2020     # Returns.   
+00023e50: 2020 2020 2020 2020 2060 4461 7461 4672           `DataFr
+00023e60: 616d 6560 3a20 5468 6520 7370 6172 6b20  ame`: The spark 
+00023e70: 6461 7461 6672 616d 6520 636f 6e74 6169  dataframe contai
+00023e80: 6e69 6e67 2074 6865 2066 6561 7475 7265  ning the feature
+00023e90: 2064 6174 612e 0a20 2020 2020 2020 2020   data..         
+00023ea0: 2020 2060 7079 7370 6172 6b2e 4461 7461     `pyspark.Data
+00023eb0: 4672 616d 6560 2e20 4120 5370 6172 6b20  Frame`. A Spark 
+00023ec0: 4461 7461 4672 616d 652e 0a20 2020 2020  DataFrame..     
+00023ed0: 2020 2020 2020 2060 7061 6e64 6173 2e44         `pandas.D
+00023ee0: 6174 6146 7261 6d65 602e 2041 2050 616e  ataFrame`. A Pan
+00023ef0: 6461 7320 4461 7461 4672 616d 652e 0a20  das DataFrame.. 
+00023f00: 2020 2020 2020 2020 2020 2060 6e75 6d70             `nump
+00023f10: 792e 6e64 6172 7261 7960 2e20 4120 7477  y.ndarray`. A tw
+00023f20: 6f2d 6469 6d65 6e73 696f 6e61 6c20 4e75  o-dimensional Nu
+00023f30: 6d70 7920 6172 7261 792e 0a20 2020 2020  mpy array..     
+00023f40: 2020 2020 2020 2060 6c69 7374 602e 2041         `list`. A
+00023f50: 2074 776f 2d64 696d 656e 7369 6f6e 616c   two-dimensional
+00023f60: 2050 7974 686f 6e20 6c69 7374 2e0a 0a20   Python list... 
+00023f70: 2020 2020 2020 2023 2052 6169 7365 730a         # Raises.
+00023f80: 2020 2020 2020 2020 2020 2020 6068 7366              `hsf
+00023f90: 732e 636c 6965 6e74 2e65 7863 6570 7469  s.client.excepti
+00023fa0: 6f6e 732e 5265 7374 4150 4945 7272 6f72  ons.RestAPIError
+00023fb0: 602e 0a20 2020 2020 2020 2022 2222 0a0a  `..        """..
+00023fc0: 2020 2020 2020 2020 6966 2028 0a20 2020          if (.   
+00023fd0: 2020 2020 2020 2020 2065 6e67 696e 652e           engine.
+00023fe0: 6765 745f 7479 7065 2829 203d 3d20 2270  get_type() == "p
+00023ff0: 7974 686f 6e22 0a20 2020 2020 2020 2020  ython".         
+00024000: 2020 2061 6e64 206e 6f74 206f 6e6c 696e     and not onlin
+00024010: 650a 2020 2020 2020 2020 2020 2020 616e  e.            an
+00024020: 6420 6e6f 7420 656e 6769 6e65 2e67 6574  d not engine.get
+00024030: 5f69 6e73 7461 6e63 6528 292e 6973 5f66  _instance().is_f
+00024040: 6c79 696e 6764 7563 6b5f 7175 6572 795f  lyingduck_query_
+00024050: 7375 7070 6f72 7465 6428 0a20 2020 2020  supported(.     
+00024060: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00024070: 7365 6c65 6374 5f61 6c6c 2829 0a20 2020  select_all().   
+00024080: 2020 2020 2020 2020 2029 0a20 2020 2020           ).     
+00024090: 2020 2029 3a0a 2020 2020 2020 2020 2020     ):.          
+000240a0: 2020 7261 6973 6520 4665 6174 7572 6553    raise FeatureS
+000240b0: 746f 7265 4578 6365 7074 696f 6e28 0a20  toreException(. 
+000240c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000240d0: 5265 6164 696e 6720 616e 2045 7874 6572  Reading an Exter
+000240e0: 6e61 6c20 4665 6174 7572 6520 4772 6f75  nal Feature Grou
+000240f0: 7020 6469 7265 6374 6c79 2069 6e74 6f20  p directly into 
+00024100: 6120 5061 6e64 6173 2044 6174 6166 7261  a Pandas Datafra
+00024110: 6d65 2075 7369 6e67 2022 0a20 2020 2020  me using ".     
+00024120: 2020 2020 2020 2020 2020 202b 2022 5079             + "Py
+00024130: 7468 6f6e 2f50 616e 6461 7320 6173 2045  thon/Pandas as E
+00024140: 6e67 696e 6520 6672 6f6d 2074 6865 2065  ngine from the e
+00024150: 7874 6572 6e61 6c20 7374 6f72 6167 6520  xternal storage 
+00024160: 7379 7374 656d 2022 0a20 2020 2020 2020  system ".       
+00024170: 2020 2020 2020 2020 202b 2022 6973 206e           + "is n
+00024180: 6f74 2073 7570 706f 7274 6564 2c20 686f  ot supported, ho
+00024190: 7765 7665 722c 2069 6620 7468 6520 6665  wever, if the fe
+000241a0: 6174 7572 6520 6772 6f75 7020 6973 206f  ature group is o
+000241b0: 6e6c 696e 6520 656e 6162 6c65 642c 2079  nline enabled, y
+000241c0: 6f75 2063 616e 2072 6561 6420 220a 2020  ou can read ".  
+000241d0: 2020 2020 2020 2020 2020 2020 2020 2b20                + 
+000241e0: 2266 726f 6d20 6f6e 6c69 6e65 2073 746f  "from online sto
+000241f0: 7261 6765 206f 7220 796f 7520 6361 6e20  rage or you can 
+00024200: 7573 6520 7468 6520 220a 2020 2020 2020  use the ".      
+00024210: 2020 2020 2020 2020 2020 2b20 2251 7565            + "Que
+00024220: 7279 2041 5049 2074 6f20 6372 6561 7465  ry API to create
+00024230: 2046 6561 7475 7265 2056 6965 7773 2f54   Feature Views/T
+00024240: 7261 696e 696e 6720 4461 7461 2063 6f6e  raining Data con
+00024250: 7461 696e 696e 6720 4578 7465 726e 616c  taining External
+00024260: 2022 0a20 2020 2020 2020 2020 2020 2020   ".             
+00024270: 2020 202b 2022 4665 6174 7572 6520 4772     + "Feature Gr
+00024280: 6f75 7073 2e22 0a20 2020 2020 2020 2020  oups.".         
+00024290: 2020 2029 0a20 2020 2020 2020 2065 6e67     ).        eng
+000242a0: 696e 652e 6765 745f 696e 7374 616e 6365  ine.get_instance
+000242b0: 2829 2e73 6574 5f6a 6f62 5f67 726f 7570  ().set_job_group
+000242c0: 280a 2020 2020 2020 2020 2020 2020 2246  (.            "F
+000242d0: 6574 6368 696e 6720 4665 6174 7572 6520  etching Feature 
+000242e0: 6772 6f75 7022 2c0a 2020 2020 2020 2020  group",.        
+000242f0: 2020 2020 2247 6574 7469 6e67 2066 6561      "Getting fea
+00024300: 7475 7265 2067 726f 7570 3a20 7b7d 2066  ture group: {} f
+00024310: 726f 6d20 7468 6520 6665 6174 7572 6573  rom the features
+00024320: 746f 7265 207b 7d22 2e66 6f72 6d61 7428  tore {}".format(
+00024330: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00024340: 2073 656c 662e 5f6e 616d 652c 2073 656c   self._name, sel
+00024350: 662e 5f66 6561 7475 7265 5f73 746f 7265  f._feature_store
+00024360: 5f6e 616d 650a 2020 2020 2020 2020 2020  _name.          
+00024370: 2020 292c 0a20 2020 2020 2020 2029 0a20    ),.        ). 
+00024380: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+00024390: 6c66 2e73 656c 6563 745f 616c 6c28 292e  lf.select_all().
+000243a0: 7265 6164 2864 6174 6166 7261 6d65 5f74  read(dataframe_t
+000243b0: 7970 653d 6461 7461 6672 616d 655f 7479  ype=dataframe_ty
+000243c0: 7065 2c20 6f6e 6c69 6e65 3d6f 6e6c 696e  pe, online=onlin
+000243d0: 6529 0a0a 2020 2020 6465 6620 7368 6f77  e)..    def show
+000243e0: 2873 656c 662c 206e 293a 0a20 2020 2020  (self, n):.     
+000243f0: 2020 2022 2222 5368 6f77 2074 6865 2066     """Show the f
+00024400: 6972 7374 206e 2072 6f77 7320 6f66 2074  irst n rows of t
+00024410: 6865 2066 6561 7475 7265 2067 726f 7570  he feature group
+00024420: 2e0a 0a20 2020 2020 2020 2021 2121 2065  ...        !!! e
+00024430: 7861 6d70 6c65 0a20 2020 2020 2020 2020  xample.         
+00024440: 2020 2060 6060 7079 7468 6f6e 0a20 2020     ```python.   
+00024450: 2020 2020 2020 2020 2023 2063 6f6e 6e65           # conne
+00024460: 6374 2074 6f20 7468 6520 4665 6174 7572  ct to the Featur
+00024470: 6520 5374 6f72 650a 2020 2020 2020 2020  e Store.        
+00024480: 2020 2020 6673 203d 202e 2e2e 0a0a 2020      fs = .....  
+00024490: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
+000244a0: 7468 6520 4665 6174 7572 6520 4772 6f75  the Feature Grou
+000244b0: 7020 696e 7374 616e 6365 0a20 2020 2020  p instance.     
+000244c0: 2020 2020 2020 2066 6720 3d20 6673 2e67         fg = fs.g
+000244d0: 6574 5f6f 725f 6372 6561 7465 5f66 6561  et_or_create_fea
+000244e0: 7475 7265 5f67 726f 7570 282e 2e2e 290a  ture_group(...).
+000244f0: 0a20 2020 2020 2020 2020 2020 2066 672e  .            fg.
+00024500: 7368 6f77 2835 290a 2020 2020 2020 2020  show(5).        
+00024510: 2020 2020 6060 600a 2020 2020 2020 2020      ```.        
+00024520: 2222 220a 2020 2020 2020 2020 656e 6769  """.        engi
+00024530: 6e65 2e67 6574 5f69 6e73 7461 6e63 6528  ne.get_instance(
+00024540: 292e 7365 745f 6a6f 625f 6772 6f75 7028  ).set_job_group(
+00024550: 0a20 2020 2020 2020 2020 2020 2022 4665  .            "Fe
+00024560: 7463 6869 6e67 2046 6561 7475 7265 2067  tching Feature g
+00024570: 726f 7570 222c 0a20 2020 2020 2020 2020  roup",.         
+00024580: 2020 2022 4765 7474 696e 6720 6665 6174     "Getting feat
+00024590: 7572 6520 6772 6f75 703a 207b 7d20 6672  ure group: {} fr
+000245a0: 6f6d 2074 6865 2066 6561 7475 7265 7374  om the featurest
+000245b0: 6f72 6520 7b7d 222e 666f 726d 6174 280a  ore {}".format(.
+000245c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000245d0: 7365 6c66 2e5f 6e61 6d65 2c20 7365 6c66  self._name, self
+000245e0: 2e5f 6665 6174 7572 655f 7374 6f72 655f  ._feature_store_
+000245f0: 6e61 6d65 0a20 2020 2020 2020 2020 2020  name.           
+00024600: 2029 2c0a 2020 2020 2020 2020 290a 2020   ),.        ).  
+00024610: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00024620: 662e 7365 6c65 6374 5f61 6c6c 2829 2e73  f.select_all().s
+00024630: 686f 7728 6e29 0a0a 2020 2020 4063 6c61  how(n)..    @cla
+00024640: 7373 6d65 7468 6f64 0a20 2020 2064 6566  ssmethod.    def
+00024650: 2066 726f 6d5f 7265 7370 6f6e 7365 5f6a   from_response_j
+00024660: 736f 6e28 636c 732c 206a 736f 6e5f 6469  son(cls, json_di
+00024670: 6374 293a 0a20 2020 2020 2020 206a 736f  ct):.        jso
+00024680: 6e5f 6465 6361 6d65 6c69 7a65 6420 3d20  n_decamelized = 
+00024690: 6875 6d70 732e 6465 6361 6d65 6c69 7a65  humps.decamelize
+000246a0: 286a 736f 6e5f 6469 6374 290a 2020 2020  (json_dict).    
+000246b0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+000246c0: 6528 6a73 6f6e 5f64 6563 616d 656c 697a  e(json_decameliz
+000246d0: 6564 2c20 6469 6374 293a 0a20 2020 2020  ed, dict):.     
+000246e0: 2020 2020 2020 205f 203d 206a 736f 6e5f         _ = json_
+000246f0: 6465 6361 6d65 6c69 7a65 642e 706f 7028  decamelized.pop(
+00024700: 2274 7970 6522 2c20 4e6f 6e65 290a 2020  "type", None).  
+00024710: 2020 2020 2020 2020 2020 7265 7475 726e            return
+00024720: 2063 6c73 282a 2a6a 736f 6e5f 6465 6361   cls(**json_deca
+00024730: 6d65 6c69 7a65 6429 0a20 2020 2020 2020  melized).       
+00024740: 2066 6f72 2066 6720 696e 206a 736f 6e5f   for fg in json_
+00024750: 6465 6361 6d65 6c69 7a65 643a 0a20 2020  decamelized:.   
+00024760: 2020 2020 2020 2020 205f 203d 2066 672e           _ = fg.
+00024770: 706f 7028 2274 7970 6522 2c20 4e6f 6e65  pop("type", None
+00024780: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+00024790: 205b 636c 7328 2a2a 6667 2920 666f 7220   [cls(**fg) for 
+000247a0: 6667 2069 6e20 6a73 6f6e 5f64 6563 616d  fg in json_decam
+000247b0: 656c 697a 6564 5d0a 0a20 2020 2064 6566  elized]..    def
+000247c0: 2075 7064 6174 655f 6672 6f6d 5f72 6573   update_from_res
+000247d0: 706f 6e73 655f 6a73 6f6e 2873 656c 662c  ponse_json(self,
+000247e0: 206a 736f 6e5f 6469 6374 293a 0a20 2020   json_dict):.   
+000247f0: 2020 2020 206a 736f 6e5f 6465 6361 6d65       json_decame
+00024800: 6c69 7a65 6420 3d20 6875 6d70 732e 6465  lized = humps.de
+00024810: 6361 6d65 6c69 7a65 286a 736f 6e5f 6469  camelize(json_di
+00024820: 6374 290a 2020 2020 2020 2020 6966 2022  ct).        if "
+00024830: 7479 7065 2220 696e 206a 736f 6e5f 6465  type" in json_de
+00024840: 6361 6d65 6c69 7a65 643a 0a20 2020 2020  camelized:.     
+00024850: 2020 2020 2020 205f 203d 206a 736f 6e5f         _ = json_
+00024860: 6465 6361 6d65 6c69 7a65 642e 706f 7028  decamelized.pop(
+00024870: 2274 7970 6522 290a 2020 2020 2020 2020  "type").        
+00024880: 7365 6c66 2e5f 5f69 6e69 745f 5f28 2a2a  self.__init__(**
+00024890: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
+000248a0: 290a 2020 2020 2020 2020 7265 7475 726e  ).        return
+000248b0: 2073 656c 660a 0a20 2020 2064 6566 206a   self..    def j
+000248c0: 736f 6e28 7365 6c66 293a 0a20 2020 2020  son(self):.     
+000248d0: 2020 2072 6574 7572 6e20 6a73 6f6e 2e64     return json.d
+000248e0: 756d 7073 2873 656c 662c 2063 6c73 3d75  umps(self, cls=u
+000248f0: 7469 6c2e 4665 6174 7572 6553 746f 7265  til.FeatureStore
+00024900: 456e 636f 6465 7229 0a0a 2020 2020 6465  Encoder)..    de
+00024910: 6620 746f 5f64 6963 7428 7365 6c66 293a  f to_dict(self):
+00024920: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024930: 7b0a 2020 2020 2020 2020 2020 2020 2269  {.            "i
+00024940: 6422 3a20 7365 6c66 2e5f 6964 2c0a 2020  d": self._id,.  
+00024950: 2020 2020 2020 2020 2020 226e 616d 6522            "name"
+00024960: 3a20 7365 6c66 2e5f 6e61 6d65 2c0a 2020  : self._name,.  
+00024970: 2020 2020 2020 2020 2020 2264 6573 6372            "descr
+00024980: 6970 7469 6f6e 223a 2073 656c 662e 5f64  iption": self._d
+00024990: 6573 6372 6970 7469 6f6e 2c0a 2020 2020  escription,.    
+000249a0: 2020 2020 2020 2020 2276 6572 7369 6f6e          "version
+000249b0: 223a 2073 656c 662e 5f76 6572 7369 6f6e  ": self._version
+000249c0: 2c0a 2020 2020 2020 2020 2020 2020 2266  ,.            "f
+000249d0: 6561 7475 7265 7322 3a20 7365 6c66 2e5f  eatures": self._
+000249e0: 6665 6174 7572 6573 2c0a 2020 2020 2020  features,.      
+000249f0: 2020 2020 2020 2266 6561 7475 7265 7374        "featurest
+00024a00: 6f72 6549 6422 3a20 7365 6c66 2e5f 6665  oreId": self._fe
+00024a10: 6174 7572 655f 7374 6f72 655f 6964 2c0a  ature_store_id,.
+00024a20: 2020 2020 2020 2020 2020 2020 2271 7565              "que
+00024a30: 7279 223a 2073 656c 662e 5f71 7565 7279  ry": self._query
+00024a40: 2c0a 2020 2020 2020 2020 2020 2020 2264  ,.            "d
+00024a50: 6174 6146 6f72 6d61 7422 3a20 7365 6c66  ataFormat": self
+00024a60: 2e5f 6461 7461 5f66 6f72 6d61 742c 0a20  ._data_format,. 
+00024a70: 2020 2020 2020 2020 2020 2022 7061 7468             "path
+00024a80: 223a 2073 656c 662e 5f70 6174 682c 0a20  ": self._path,. 
+00024a90: 2020 2020 2020 2020 2020 2022 6f70 7469             "opti
+00024aa0: 6f6e 7322 3a20 5b7b 226e 616d 6522 3a20  ons": [{"name": 
+00024ab0: 6b2c 2022 7661 6c75 6522 3a20 767d 2066  k, "value": v} f
+00024ac0: 6f72 206b 2c20 7620 696e 2073 656c 662e  or k, v in self.
+00024ad0: 5f6f 7074 696f 6e73 2e69 7465 6d73 2829  _options.items()
+00024ae0: 5d0a 2020 2020 2020 2020 2020 2020 6966  ].            if
+00024af0: 2073 656c 662e 5f6f 7074 696f 6e73 0a20   self._options. 
+00024b00: 2020 2020 2020 2020 2020 2065 6c73 6520             else 
+00024b10: 4e6f 6e65 2c0a 2020 2020 2020 2020 2020  None,.          
+00024b20: 2020 2273 746f 7261 6765 436f 6e6e 6563    "storageConnec
+00024b30: 746f 7222 3a20 7365 6c66 2e5f 7374 6f72  tor": self._stor
+00024b40: 6167 655f 636f 6e6e 6563 746f 722e 746f  age_connector.to
+00024b50: 5f64 6963 7428 292c 0a20 2020 2020 2020  _dict(),.       
+00024b60: 2020 2020 2022 7479 7065 223a 2022 6f6e       "type": "on
+00024b70: 4465 6d61 6e64 4665 6174 7572 6567 726f  DemandFeaturegro
+00024b80: 7570 4454 4f22 2c0a 2020 2020 2020 2020  upDTO",.        
+00024b90: 2020 2020 2273 7461 7469 7374 6963 7343      "statisticsC
+00024ba0: 6f6e 6669 6722 3a20 7365 6c66 2e5f 7374  onfig": self._st
+00024bb0: 6174 6973 7469 6373 5f63 6f6e 6669 672c  atistics_config,
+00024bc0: 0a20 2020 2020 2020 2020 2020 2022 6576  .            "ev
+00024bd0: 656e 7454 696d 6522 3a20 7365 6c66 2e5f  entTime": self._
+00024be0: 6576 656e 745f 7469 6d65 2c0a 2020 2020  event_time,.    
+00024bf0: 2020 2020 2020 2020 2265 7870 6563 7461          "expecta
+00024c00: 7469 6f6e 5375 6974 6522 3a20 7365 6c66  tionSuite": self
+00024c10: 2e5f 6578 7065 6374 6174 696f 6e5f 7375  ._expectation_su
+00024c20: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
+00024c30: 2022 6f6e 6c69 6e65 456e 6162 6c65 6422   "onlineEnabled"
+00024c40: 3a20 7365 6c66 2e5f 6f6e 6c69 6e65 5f65  : self._online_e
+00024c50: 6e61 626c 6564 2c0a 2020 2020 2020 2020  nabled,.        
+00024c60: 2020 2020 2273 7069 6e65 223a 2046 616c      "spine": Fal
+00024c70: 7365 2c0a 2020 2020 2020 2020 2020 2020  se,.            
+00024c80: 2274 6f70 6963 4e61 6d65 223a 2073 656c  "topicName": sel
+00024c90: 662e 746f 7069 635f 6e61 6d65 2c0a 2020  f.topic_name,.  
+00024ca0: 2020 2020 2020 2020 2020 226e 6f74 6966            "notif
+00024cb0: 6963 6174 696f 6e54 6f70 6963 4e61 6d65  icationTopicName
+00024cc0: 223a 2073 656c 662e 6e6f 7469 6669 6361  ": self.notifica
+00024cd0: 7469 6f6e 5f74 6f70 6963 5f6e 616d 652c  tion_topic_name,
+00024ce0: 0a20 2020 2020 2020 2020 2020 2022 6465  .            "de
+00024cf0: 7072 6563 6174 6564 223a 2073 656c 662e  precated": self.
+00024d00: 6465 7072 6563 6174 6564 2c0a 2020 2020  deprecated,.    
+00024d10: 2020 2020 7d0a 0a20 2020 2040 7072 6f70      }..    @prop
+00024d20: 6572 7479 0a20 2020 2064 6566 2069 6428  erty.    def id(
 00024d30: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00024d40: 6574 7572 6e20 7365 6c66 2e5f 7061 7468  eturn self._path
-00024d50: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
-00024d60: 2020 2020 6465 6620 6f70 7469 6f6e 7328      def options(
-00024d70: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
-00024d80: 6574 7572 6e20 7365 6c66 2e5f 6f70 7469  eturn self._opti
-00024d90: 6f6e 730a 0a20 2020 2040 7072 6f70 6572  ons..    @proper
-00024da0: 7479 0a20 2020 2064 6566 2073 746f 7261  ty.    def stora
-00024db0: 6765 5f63 6f6e 6e65 6374 6f72 2873 656c  ge_connector(sel
-00024dc0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00024dd0: 726e 2073 656c 662e 5f73 746f 7261 6765  rn self._storage
-00024de0: 5f63 6f6e 6e65 6374 6f72 0a0a 2020 2020  _connector..    
-00024df0: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
-00024e00: 6620 6372 6561 746f 7228 7365 6c66 293a  f creator(self):
-00024e10: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00024e20: 7365 6c66 2e5f 6372 6561 746f 720a 0a20  self._creator.. 
-00024e30: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
-00024e40: 2064 6566 2063 7265 6174 6564 2873 656c   def created(sel
-00024e50: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
-00024e60: 726e 2073 656c 662e 5f63 7265 6174 6564  rn self._created
-00024e70: 0a0a 2020 2020 4064 6573 6372 6970 7469  ..    @descripti
-00024e80: 6f6e 2e73 6574 7465 720a 2020 2020 6465  on.setter.    de
-00024e90: 6620 6465 7363 7269 7074 696f 6e28 7365  f description(se
-00024ea0: 6c66 2c20 6e65 775f 6465 7363 7269 7074  lf, new_descript
-00024eb0: 696f 6e29 3a0a 2020 2020 2020 2020 7365  ion):.        se
-00024ec0: 6c66 2e5f 6465 7363 7269 7074 696f 6e20  lf._description 
-00024ed0: 3d20 6e65 775f 6465 7363 7269 7074 696f  = new_descriptio
-00024ee0: 6e0a 0a20 2020 2040 7072 6f70 6572 7479  n..    @property
-00024ef0: 0a20 2020 2064 6566 2066 6561 7475 7265  .    def feature
-00024f00: 5f73 746f 7265 5f6e 616d 6528 7365 6c66  _store_name(self
-00024f10: 293a 0a20 2020 2020 2020 2022 2222 4e61  ):.        """Na
-00024f20: 6d65 206f 6620 7468 6520 6665 6174 7572  me of the featur
-00024f30: 6520 7374 6f72 6520 696e 2077 6869 6368  e store in which
-00024f40: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
-00024f50: 7570 2069 7320 6c6f 6361 7465 642e 2222  up is located.""
-00024f60: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
-00024f70: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
-00024f80: 746f 7265 5f6e 616d 650a 0a0a 636c 6173  tore_name...clas
-00024f90: 7320 5370 696e 6547 726f 7570 2846 6561  s SpineGroup(Fea
-00024fa0: 7475 7265 4772 6f75 7042 6173 6529 3a0a  tureGroupBase):.
-00024fb0: 2020 2020 5350 494e 455f 4752 4f55 5020      SPINE_GROUP 
-00024fc0: 3d20 224f 4e5f 4445 4d41 4e44 5f46 4541  = "ON_DEMAND_FEA
-00024fd0: 5455 5245 5f47 524f 5550 220a 2020 2020  TURE_GROUP".    
-00024fe0: 454e 5449 5459 5f54 5950 4520 3d20 2266  ENTITY_TYPE = "f
-00024ff0: 6561 7475 7265 6772 6f75 7073 220a 0a20  eaturegroups".. 
-00025000: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
-00025010: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
-00025020: 2020 2020 2020 2073 746f 7261 6765 5f63         storage_c
-00025030: 6f6e 6e65 6374 6f72 3d4e 6f6e 652c 0a20  onnector=None,. 
-00025040: 2020 2020 2020 2071 7565 7279 3d4e 6f6e         query=Non
-00025050: 652c 0a20 2020 2020 2020 2064 6174 615f  e,.        data_
-00025060: 666f 726d 6174 3d4e 6f6e 652c 0a20 2020  format=None,.   
-00025070: 2020 2020 2070 6174 683d 4e6f 6e65 2c0a       path=None,.
-00025080: 2020 2020 2020 2020 6f70 7469 6f6e 733d          options=
-00025090: 7b7d 2c0a 2020 2020 2020 2020 6e61 6d65  {},.        name
-000250a0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2076  =None,.        v
-000250b0: 6572 7369 6f6e 3d4e 6f6e 652c 0a20 2020  ersion=None,.   
-000250c0: 2020 2020 2064 6573 6372 6970 7469 6f6e       description
-000250d0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
-000250e0: 7269 6d61 7279 5f6b 6579 3d4e 6f6e 652c  rimary_key=None,
-000250f0: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
-00025100: 7374 6f72 655f 6964 3d4e 6f6e 652c 0a20  store_id=None,. 
-00025110: 2020 2020 2020 2066 6561 7475 7265 7374         featurest
-00025120: 6f72 655f 6e61 6d65 3d4e 6f6e 652c 0a20  ore_name=None,. 
-00025130: 2020 2020 2020 2063 7265 6174 6564 3d4e         created=N
-00025140: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
-00025150: 6174 6f72 3d4e 6f6e 652c 0a20 2020 2020  ator=None,.     
-00025160: 2020 2069 643d 4e6f 6e65 2c0a 2020 2020     id=None,.    
-00025170: 2020 2020 6665 6174 7572 6573 3d4e 6f6e      features=Non
-00025180: 652c 0a20 2020 2020 2020 206c 6f63 6174  e,.        locat
-00025190: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  ion=None,.      
-000251a0: 2020 7374 6174 6973 7469 6373 5f63 6f6e    statistics_con
-000251b0: 6669 673d 4e6f 6e65 2c0a 2020 2020 2020  fig=None,.      
-000251c0: 2020 6576 656e 745f 7469 6d65 3d4e 6f6e    event_time=Non
-000251d0: 652c 0a20 2020 2020 2020 2065 7870 6563  e,.        expec
-000251e0: 7461 7469 6f6e 5f73 7569 7465 3d4e 6f6e  tation_suite=Non
-000251f0: 652c 0a20 2020 2020 2020 206f 6e6c 696e  e,.        onlin
-00025200: 655f 656e 6162 6c65 643d 4661 6c73 652c  e_enabled=False,
-00025210: 0a20 2020 2020 2020 2068 7265 663d 4e6f  .        href=No
-00025220: 6e65 2c0a 2020 2020 2020 2020 6f6e 6c69  ne,.        onli
-00025230: 6e65 5f74 6f70 6963 5f6e 616d 653d 4e6f  ne_topic_name=No
-00025240: 6e65 2c0a 2020 2020 2020 2020 746f 7069  ne,.        topi
-00025250: 635f 6e61 6d65 3d4e 6f6e 652c 0a20 2020  c_name=None,.   
-00025260: 2020 2020 2073 7069 6e65 3d54 7275 652c       spine=True,
-00025270: 0a20 2020 2020 2020 2064 6174 6166 7261  .        datafra
-00025280: 6d65 3d22 7370 696e 6522 2c0a 2020 2020  me="spine",.    
-00025290: 2020 2020 6465 7072 6563 6174 6564 3d46      deprecated=F
-000252a0: 616c 7365 2c0a 2020 2020 2020 2020 2a2a  alse,.        **
-000252b0: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
-000252c0: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
-000252d0: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
-000252e0: 2020 2020 206e 616d 652c 0a20 2020 2020       name,.     
-000252f0: 2020 2020 2020 2076 6572 7369 6f6e 2c0a         version,.
-00025300: 2020 2020 2020 2020 2020 2020 6665 6174              feat
-00025310: 7572 6573 746f 7265 5f69 642c 0a20 2020  urestore_id,.   
-00025320: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
-00025330: 6e2c 0a20 2020 2020 2020 2020 2020 2065  n,.            e
-00025340: 7665 6e74 5f74 696d 653d 6576 656e 745f  vent_time=event_
-00025350: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
-00025360: 2020 6f6e 6c69 6e65 5f65 6e61 626c 6564    online_enabled
-00025370: 3d6f 6e6c 696e 655f 656e 6162 6c65 642c  =online_enabled,
-00025380: 0a20 2020 2020 2020 2020 2020 2069 643d  .            id=
-00025390: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
-000253a0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
-000253b0: 653d 6578 7065 6374 6174 696f 6e5f 7375  e=expectation_su
-000253c0: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
-000253d0: 206f 6e6c 696e 655f 746f 7069 635f 6e61   online_topic_na
-000253e0: 6d65 3d6f 6e6c 696e 655f 746f 7069 635f  me=online_topic_
-000253f0: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
-00025400: 2020 746f 7069 635f 6e61 6d65 3d74 6f70    topic_name=top
-00025410: 6963 5f6e 616d 652c 0a20 2020 2020 2020  ic_name,.       
-00025420: 2020 2020 2064 6570 7265 6361 7465 643d       deprecated=
-00025430: 6465 7072 6563 6174 6564 2c0a 2020 2020  deprecated,.    
-00025440: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
-00025450: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-00025460: 7265 5f6e 616d 6520 3d20 6665 6174 7572  re_name = featur
-00025470: 6573 746f 7265 5f6e 616d 650a 2020 2020  estore_name.    
-00025480: 2020 2020 7365 6c66 2e5f 6465 7363 7269      self._descri
-00025490: 7074 696f 6e20 3d20 6465 7363 7269 7074  ption = descript
-000254a0: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
-000254b0: 2e5f 6372 6561 7465 6420 3d20 6372 6561  ._created = crea
-000254c0: 7465 640a 2020 2020 2020 2020 7365 6c66  ted.        self
-000254d0: 2e5f 6372 6561 746f 7220 3d20 7573 6572  ._creator = user
-000254e0: 2e55 7365 722e 6672 6f6d 5f72 6573 706f  .User.from_respo
-000254f0: 6e73 655f 6a73 6f6e 2863 7265 6174 6f72  nse_json(creator
-00025500: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
-00025510: 5f66 6561 7475 7265 7320 3d20 5b0a 2020  _features = [.  
-00025520: 2020 2020 2020 2020 2020 6665 6174 7572            featur
-00025530: 652e 4665 6174 7572 652e 6672 6f6d 5f72  e.Feature.from_r
-00025540: 6573 706f 6e73 655f 6a73 6f6e 2866 6561  esponse_json(fea
-00025550: 7429 2069 6620 6973 696e 7374 616e 6365  t) if isinstance
-00025560: 2866 6561 742c 2064 6963 7429 2065 6c73  (feat, dict) els
-00025570: 6520 6665 6174 0a20 2020 2020 2020 2020  e feat.         
-00025580: 2020 2066 6f72 2066 6561 7420 696e 2028     for feat in (
-00025590: 6665 6174 7572 6573 206f 7220 5b5d 290a  features or []).
-000255a0: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
-000255b0: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
-000255c0: 5f67 726f 7570 5f65 6e67 696e 6520 3d20  _group_engine = 
-000255d0: 7370 696e 655f 6772 6f75 705f 656e 6769  spine_group_engi
-000255e0: 6e65 2e53 7069 6e65 4772 6f75 7045 6e67  ne.SpineGroupEng
-000255f0: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
-00025600: 2066 6561 7475 7265 7374 6f72 655f 6964   featurestore_id
-00025610: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
-00025620: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
-00025630: 0a20 2020 2020 2020 2020 2020 2023 2047  .            # G
-00025640: 6f74 2066 726f 6d20 486f 7073 776f 726b  ot from Hopswork
-00025650: 732c 2064 6573 6572 6961 6c69 7a65 2066  s, deserialize f
-00025660: 6561 7475 7265 7320 616e 6420 7374 6f72  eatures and stor
-00025670: 6167 6520 636f 6e6e 6563 746f 720a 2020  age connector.  
-00025680: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00025690: 6665 6174 7572 6573 203d 2028 0a20 2020  features = (.   
-000256a0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
-000256b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000256c0: 2020 2066 6561 7475 7265 2e46 6561 7475     feature.Featu
-000256d0: 7265 2e66 726f 6d5f 7265 7370 6f6e 7365  re.from_response
-000256e0: 5f6a 736f 6e28 6665 6174 290a 2020 2020  _json(feat).    
-000256f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00025700: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
-00025710: 6174 2c20 6469 6374 290a 2020 2020 2020  at, dict).      
-00025720: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00025730: 7365 2066 6561 740a 2020 2020 2020 2020  se feat.        
-00025740: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-00025750: 6665 6174 2069 6e20 6665 6174 7572 6573  feat in features
-00025760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00025770: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
-00025780: 2020 2069 6620 6665 6174 7572 6573 0a20     if features. 
-00025790: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-000257a0: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
-000257b0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
-000257c0: 2020 2073 656c 662e 7072 696d 6172 795f     self.primary_
-000257d0: 6b65 7920 3d20 280a 2020 2020 2020 2020  key = (.        
-000257e0: 2020 2020 2020 2020 5b66 6561 742e 6e61          [feat.na
-000257f0: 6d65 2066 6f72 2066 6561 7420 696e 2073  me for feat in s
-00025800: 656c 662e 5f66 6561 7475 7265 7320 6966  elf._features if
-00025810: 2066 6561 742e 7072 696d 6172 7920 6973   feat.primary is
-00025820: 2054 7275 655d 0a20 2020 2020 2020 2020   True].         
-00025830: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
-00025840: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
-00025850: 2020 2020 2020 2020 2065 6c73 6520 5b5d           else []
-00025860: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
-00025870: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00025880: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-00025890: 6720 3d20 7374 6174 6973 7469 6373 5f63  g = statistics_c
-000258a0: 6f6e 6669 670a 2020 2020 2020 2020 656c  onfig.        el
-000258b0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
-000258c0: 7365 6c66 2e70 7269 6d61 7279 5f6b 6579  self.primary_key
-000258d0: 203d 2070 7269 6d61 7279 5f6b 6579 0a20   = primary_key. 
-000258e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000258f0: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
-00025900: 6720 3d20 7374 6174 6973 7469 6373 5f63  g = statistics_c
-00025910: 6f6e 6669 670a 2020 2020 2020 2020 2020  onfig.          
-00025920: 2020 7365 6c66 2e5f 6665 6174 7572 6573    self._features
-00025930: 203d 2066 6561 7475 7265 730a 0a20 2020   = features..   
-00025940: 2020 2020 2073 656c 662e 5f68 7265 6620       self._href 
-00025950: 3d20 6872 6566 0a0a 2020 2020 2020 2020  = href..        
-00025960: 2320 6861 7320 746f 2068 6170 7065 6e20  # has to happen 
-00025970: 6c61 7374 202d 3e20 6665 6174 7572 6573  last -> features
-00025980: 2061 6e64 2069 6420 6172 6520 6e65 6564   and id are need
-00025990: 6564 2066 6f72 2073 6368 656d 6120 7665  ed for schema ve
-000259a0: 7269 6669 6361 7469 6f6e 0a20 2020 2020  rification.     
-000259b0: 2020 2023 2075 7365 2073 6574 7465 7220     # use setter 
-000259c0: 746f 2063 6f6e 7665 7274 2074 6f20 6465  to convert to de
-000259d0: 6661 756c 7420 6461 7461 6672 616d 6520  fault dataframe 
-000259e0: 7479 7065 2066 6f72 2065 6e67 696e 650a  type for engine.
-000259f0: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
-00025a00: 6166 7261 6d65 203d 2064 6174 6166 7261  aframe = datafra
-00025a10: 6d65 0a0a 2020 2020 6465 6620 5f73 6176  me..    def _sav
-00025a20: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
-00025a30: 2022 2222 5065 7273 6973 7420 7468 6520   """Persist the 
-00025a40: 6d65 7461 6461 7461 2066 6f72 2074 6869  metadata for thi
-00025a50: 7320 7370 696e 6520 6772 6f75 702e 0a0a  s spine group...
-00025a60: 2020 2020 2020 2020 5769 7468 6f75 7420          Without 
-00025a70: 6361 6c6c 696e 6720 7468 6973 206d 6574  calling this met
-00025a80: 686f 642c 2079 6f75 7220 6665 6174 7572  hod, your featur
-00025a90: 6520 6772 6f75 7020 7769 6c6c 206f 6e6c  e group will onl
-00025aa0: 7920 6578 6973 740a 2020 2020 2020 2020  y exist.        
-00025ab0: 696e 2079 6f75 7220 5079 7468 6f6e 204b  in your Python K
-00025ac0: 6572 6e65 6c2c 2062 7574 206e 6f74 2069  ernel, but not i
-00025ad0: 6e20 486f 7073 776f 726b 732e 0a0a 2020  n Hopsworks...  
-00025ae0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
-00025af0: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
-00025b00: 2253 454c 4543 5420 2a20 4652 4f4d 2073  "SELECT * FROM s
-00025b10: 616c 6573 220a 0a20 2020 2020 2020 2066  ales"..        f
-00025b20: 6720 3d20 6665 6174 7572 655f 7374 6f72  g = feature_stor
-00025b30: 652e 6372 6561 7465 5f73 7069 6e65 5f67  e.create_spine_g
-00025b40: 726f 7570 286e 616d 653d 2273 616c 6573  roup(name="sales
-00025b50: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
-00025b60: 6572 7369 6f6e 3d31 2c0a 2020 2020 2020  ersion=1,.      
-00025b70: 2020 2020 2020 6465 7363 7269 7074 696f        descriptio
-00025b80: 6e3d 2250 6879 7369 6361 6c20 7368 6f70  n="Physical shop
-00025b90: 2073 616c 6573 2066 6561 7475 7265 7322   sales features"
-00025ba0: 2c0a 2020 2020 2020 2020 2020 2020 7072  ,.            pr
-00025bb0: 696d 6172 795f 6b65 793d 5b27 7373 5f73  imary_key=['ss_s
-00025bc0: 746f 7265 5f73 6b27 5d2c 0a20 2020 2020  tore_sk'],.     
-00025bd0: 2020 2020 2020 2065 7665 6e74 5f74 696d         event_tim
-00025be0: 653d 2773 616c 655f 6461 7465 272c 0a20  e='sale_date',. 
-00025bf0: 2020 2020 2020 2020 2020 2064 6174 6166             dataf
-00025c00: 7261 6d65 3d64 662c 0a20 2020 2020 2020  rame=df,.       
-00025c10: 2029 0a0a 2020 2020 2020 2020 6667 2e5f   )..        fg._
-00025c20: 7361 7665 2829 0a20 2020 2020 2020 2022  save().        "
-00025c30: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
-00025c40: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
-00025c50: 6e67 696e 652e 7361 7665 2873 656c 6629  ngine.save(self)
-00025c60: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00025c70: 7365 6c66 0a0a 2020 2020 4070 726f 7065  self..    @prope
-00025c80: 7274 790a 2020 2020 6465 6620 6461 7461  rty.    def data
-00025c90: 6672 616d 6528 7365 6c66 293a 0a20 2020  frame(self):.   
-00025ca0: 2020 2020 2022 2222 5370 696e 6520 6461       """Spine da
-00025cb0: 7461 6672 616d 6520 7769 7468 2070 7269  taframe with pri
-00025cc0: 6d61 7279 206b 6579 2c20 6576 656e 7420  mary key, event 
-00025cd0: 7469 6d65 2061 6e64 0a20 2020 2020 2020  time and.       
-00025ce0: 206c 6162 656c 2063 6f6c 756d 6e20 746f   label column to
-00025cf0: 2075 7365 2066 6f72 2070 6f69 6e74 2069   use for point i
-00025d00: 6e20 7469 6d65 206a 6f69 6e20 7768 656e  n time join when
-00025d10: 2066 6574 6368 696e 6720 6665 6174 7572   fetching featur
-00025d20: 6573 2e0a 2020 2020 2020 2020 2222 220a  es..        """.
-00025d30: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00025d40: 656c 662e 5f64 6174 6166 7261 6d65 0a0a  elf._dataframe..
-00025d50: 2020 2020 4064 6174 6166 7261 6d65 2e73      @dataframe.s
-00025d60: 6574 7465 720a 2020 2020 6465 6620 6461  etter.    def da
-00025d70: 7461 6672 616d 6528 7365 6c66 2c20 6461  taframe(self, da
-00025d80: 7461 6672 616d 6529 3a0a 2020 2020 2020  taframe):.      
-00025d90: 2020 2222 2255 7064 6174 6520 7468 6520    """Update the 
-00025da0: 7370 696e 6520 6461 7461 6672 616d 6520  spine dataframe 
-00025db0: 636f 6e74 6169 6e65 6420 696e 2074 6865  contained in the
-00025dc0: 2073 7069 6e65 2067 726f 7570 2e22 2222   spine group."""
-00025dd0: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
-00025de0: 6174 6166 7261 6d65 203d 2065 6e67 696e  ataframe = engin
-00025df0: 652e 6765 745f 696e 7374 616e 6365 2829  e.get_instance()
-00025e00: 2e63 6f6e 7665 7274 5f74 6f5f 6465 6661  .convert_to_defa
-00025e10: 756c 745f 6461 7461 6672 616d 6528 6461  ult_dataframe(da
-00025e20: 7461 6672 616d 6529 0a0a 2020 2020 2020  taframe)..      
-00025e30: 2020 2320 696e 2066 7320 7175 6572 7920    # in fs query 
-00025e40: 7468 6520 6665 6174 7572 6573 2061 7265  the features are
-00025e50: 206e 6f74 2073 656e 742c 2073 6f20 7468   not sent, so th
-00025e60: 656e 2064 6f6e 2774 2064 6f20 7661 6c69  en don't do vali
-00025e70: 6461 7469 6f6e 0a20 2020 2020 2020 2069  dation.        i
-00025e80: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
-00025e90: 7365 6c66 2e5f 6964 2069 7320 6e6f 7420  self._id is not 
-00025ea0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
-00025eb0: 2061 6e64 2073 656c 662e 5f64 6174 6166   and self._dataf
-00025ec0: 7261 6d65 2069 7320 6e6f 7420 4e6f 6e65  rame is not None
-00025ed0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00025ee0: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
-00025ef0: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
-00025f00: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
-00025f10: 2020 2064 6174 6166 7261 6d65 5f66 6561     dataframe_fea
-00025f20: 7475 7265 7320 3d20 656e 6769 6e65 2e67  tures = engine.g
-00025f30: 6574 5f69 6e73 7461 6e63 6528 292e 7061  et_instance().pa
-00025f40: 7273 655f 7363 6865 6d61 5f66 6561 7475  rse_schema_featu
-00025f50: 7265 5f67 726f 7570 280a 2020 2020 2020  re_group(.      
-00025f60: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00025f70: 6461 7461 6672 616d 650a 2020 2020 2020  dataframe.      
-00025f80: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
-00025f90: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
-00025fa0: 655f 6772 6f75 705f 656e 6769 6e65 2e5f  e_group_engine._
-00025fb0: 7665 7269 6679 5f73 6368 656d 615f 636f  verify_schema_co
-00025fc0: 6d70 6174 6962 696c 6974 7928 0a20 2020  mpatibility(.   
-00025fd0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-00025fe0: 662e 5f66 6561 7475 7265 732c 2064 6174  f._features, dat
-00025ff0: 6166 7261 6d65 5f66 6561 7475 7265 730a  aframe_features.
-00026000: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
-00026010: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
-00026020: 2020 2020 6465 6620 6672 6f6d 5f72 6573      def from_res
-00026030: 706f 6e73 655f 6a73 6f6e 2863 6c73 2c20  ponse_json(cls, 
-00026040: 6a73 6f6e 5f64 6963 7429 3a0a 2020 2020  json_dict):.    
-00026050: 2020 2020 6a73 6f6e 5f64 6563 616d 656c      json_decamel
-00026060: 697a 6564 203d 2068 756d 7073 2e64 6563  ized = humps.dec
-00026070: 616d 656c 697a 6528 6a73 6f6e 5f64 6963  amelize(json_dic
-00026080: 7429 0a20 2020 2020 2020 2069 6620 6973  t).        if is
-00026090: 696e 7374 616e 6365 286a 736f 6e5f 6465  instance(json_de
-000260a0: 6361 6d65 6c69 7a65 642c 2064 6963 7429  camelized, dict)
-000260b0: 3a0a 2020 2020 2020 2020 2020 2020 5f20  :.            _ 
-000260c0: 3d20 6a73 6f6e 5f64 6563 616d 656c 697a  = json_decameliz
-000260d0: 6564 2e70 6f70 2822 7479 7065 222c 204e  ed.pop("type", N
-000260e0: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
-000260f0: 2072 6574 7572 6e20 636c 7328 2a2a 6a73   return cls(**js
-00026100: 6f6e 5f64 6563 616d 656c 697a 6564 290a  on_decamelized).
-00026110: 2020 2020 2020 2020 666f 7220 6667 2069          for fg i
-00026120: 6e20 6a73 6f6e 5f64 6563 616d 656c 697a  n json_decameliz
-00026130: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
-00026140: 5f20 3d20 6667 2e70 6f70 2822 7479 7065  _ = fg.pop("type
-00026150: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
-00026160: 2072 6574 7572 6e20 5b63 6c73 282a 2a66   return [cls(**f
-00026170: 6729 2066 6f72 2066 6720 696e 206a 736f  g) for fg in jso
-00026180: 6e5f 6465 6361 6d65 6c69 7a65 645d 0a0a  n_decamelized]..
-00026190: 2020 2020 6465 6620 7570 6461 7465 5f66      def update_f
-000261a0: 726f 6d5f 7265 7370 6f6e 7365 5f6a 736f  rom_response_jso
-000261b0: 6e28 7365 6c66 2c20 6a73 6f6e 5f64 6963  n(self, json_dic
-000261c0: 7429 3a0a 2020 2020 2020 2020 6a73 6f6e  t):.        json
-000261d0: 5f64 6563 616d 656c 697a 6564 203d 2068  _decamelized = h
-000261e0: 756d 7073 2e64 6563 616d 656c 697a 6528  umps.decamelize(
-000261f0: 6a73 6f6e 5f64 6963 7429 0a20 2020 2020  json_dict).     
-00026200: 2020 2069 6620 2274 7970 6522 2069 6e20     if "type" in 
-00026210: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
-00026220: 3a0a 2020 2020 2020 2020 2020 2020 5f20  :.            _ 
-00026230: 3d20 6a73 6f6e 5f64 6563 616d 656c 697a  = json_decameliz
-00026240: 6564 2e70 6f70 2822 7479 7065 2229 0a20  ed.pop("type"). 
-00026250: 2020 2020 2020 2073 656c 662e 5f5f 696e         self.__in
-00026260: 6974 5f5f 282a 2a6a 736f 6e5f 6465 6361  it__(**json_deca
-00026270: 6d65 6c69 7a65 6429 0a20 2020 2020 2020  melized).       
-00026280: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
-00026290: 2020 6465 6620 6a73 6f6e 2873 656c 6629    def json(self)
-000262a0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
-000262b0: 206a 736f 6e2e 6475 6d70 7328 7365 6c66   json.dumps(self
-000262c0: 2c20 636c 733d 7574 696c 2e46 6561 7475  , cls=util.Featu
-000262d0: 7265 5374 6f72 6545 6e63 6f64 6572 290a  reStoreEncoder).
-000262e0: 0a20 2020 2064 6566 2074 6f5f 6469 6374  .    def to_dict
-000262f0: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
-00026300: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
-00026310: 2020 2020 2022 6964 223a 2073 656c 662e       "id": self.
-00026320: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
-00026330: 2022 6e61 6d65 223a 2073 656c 662e 5f6e   "name": self._n
-00026340: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
-00026350: 2022 6465 7363 7269 7074 696f 6e22 3a20   "description": 
-00026360: 7365 6c66 2e5f 6465 7363 7269 7074 696f  self._descriptio
-00026370: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
-00026380: 7665 7273 696f 6e22 3a20 7365 6c66 2e5f  version": self._
-00026390: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
-000263a0: 2020 2020 2022 6665 6174 7572 6573 223a       "features":
-000263b0: 2073 656c 662e 5f66 6561 7475 7265 732c   self._features,
-000263c0: 0a20 2020 2020 2020 2020 2020 2022 6665  .            "fe
-000263d0: 6174 7572 6573 746f 7265 4964 223a 2073  aturestoreId": s
-000263e0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
-000263f0: 7265 5f69 642c 0a20 2020 2020 2020 2020  re_id,.         
-00026400: 2020 2022 7479 7065 223a 2022 6f6e 4465     "type": "onDe
-00026410: 6d61 6e64 4665 6174 7572 6567 726f 7570  mandFeaturegroup
-00026420: 4454 4f22 2c0a 2020 2020 2020 2020 2020  DTO",.          
-00026430: 2020 2273 7461 7469 7374 6963 7343 6f6e    "statisticsCon
-00026440: 6669 6722 3a20 7365 6c66 2e5f 7374 6174  fig": self._stat
-00026450: 6973 7469 6373 5f63 6f6e 6669 672c 0a20  istics_config,. 
-00026460: 2020 2020 2020 2020 2020 2022 6576 656e             "even
-00026470: 7454 696d 6522 3a20 7365 6c66 2e5f 6576  tTime": self._ev
-00026480: 656e 745f 7469 6d65 2c0a 2020 2020 2020  ent_time,.      
-00026490: 2020 2020 2020 2273 7069 6e65 223a 2054        "spine": T
-000264a0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
-000264b0: 2022 746f 7069 634e 616d 6522 3a20 7365   "topicName": se
-000264c0: 6c66 2e74 6f70 6963 5f6e 616d 652c 0a20  lf.topic_name,. 
-000264d0: 2020 2020 2020 2020 2020 2022 6465 7072             "depr
-000264e0: 6563 6174 6564 223a 2073 656c 662e 6465  ecated": self.de
-000264f0: 7072 6563 6174 6564 2c0a 2020 2020 2020  precated,.      
-00026500: 2020 7d0a                                  }.
+00024d40: 6574 7572 6e20 7365 6c66 2e5f 6964 0a0a  eturn self._id..
+00024d50: 2020 2020 4070 726f 7065 7274 790a 2020      @property.  
+00024d60: 2020 6465 6620 6465 7363 7269 7074 696f    def descriptio
+00024d70: 6e28 7365 6c66 293a 0a20 2020 2020 2020  n(self):.       
+00024d80: 2072 6574 7572 6e20 7365 6c66 2e5f 6465   return self._de
+00024d90: 7363 7269 7074 696f 6e0a 0a20 2020 2040  scription..    @
+00024da0: 7072 6f70 6572 7479 0a20 2020 2064 6566  property.    def
+00024db0: 2071 7565 7279 2873 656c 6629 3a0a 2020   query(self):.  
+00024dc0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00024dd0: 662e 5f71 7565 7279 0a0a 2020 2020 4070  f._query..    @p
+00024de0: 726f 7065 7274 790a 2020 2020 6465 6620  roperty.    def 
+00024df0: 6461 7461 5f66 6f72 6d61 7428 7365 6c66  data_format(self
+00024e00: 293a 0a20 2020 2020 2020 2072 6574 7572  ):.        retur
+00024e10: 6e20 7365 6c66 2e5f 6461 7461 5f66 6f72  n self._data_for
+00024e20: 6d61 740a 0a20 2020 2040 7072 6f70 6572  mat..    @proper
+00024e30: 7479 0a20 2020 2064 6566 2070 6174 6828  ty.    def path(
+00024e40: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00024e50: 6574 7572 6e20 7365 6c66 2e5f 7061 7468  eturn self._path
+00024e60: 0a0a 2020 2020 4070 726f 7065 7274 790a  ..    @property.
+00024e70: 2020 2020 6465 6620 6f70 7469 6f6e 7328      def options(
+00024e80: 7365 6c66 293a 0a20 2020 2020 2020 2072  self):.        r
+00024e90: 6574 7572 6e20 7365 6c66 2e5f 6f70 7469  eturn self._opti
+00024ea0: 6f6e 730a 0a20 2020 2040 7072 6f70 6572  ons..    @proper
+00024eb0: 7479 0a20 2020 2064 6566 2073 746f 7261  ty.    def stora
+00024ec0: 6765 5f63 6f6e 6e65 6374 6f72 2873 656c  ge_connector(sel
+00024ed0: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00024ee0: 726e 2073 656c 662e 5f73 746f 7261 6765  rn self._storage
+00024ef0: 5f63 6f6e 6e65 6374 6f72 0a0a 2020 2020  _connector..    
+00024f00: 4070 726f 7065 7274 790a 2020 2020 6465  @property.    de
+00024f10: 6620 6372 6561 746f 7228 7365 6c66 293a  f creator(self):
+00024f20: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00024f30: 7365 6c66 2e5f 6372 6561 746f 720a 0a20  self._creator.. 
+00024f40: 2020 2040 7072 6f70 6572 7479 0a20 2020     @property.   
+00024f50: 2064 6566 2063 7265 6174 6564 2873 656c   def created(sel
+00024f60: 6629 3a0a 2020 2020 2020 2020 7265 7475  f):.        retu
+00024f70: 726e 2073 656c 662e 5f63 7265 6174 6564  rn self._created
+00024f80: 0a0a 2020 2020 4064 6573 6372 6970 7469  ..    @descripti
+00024f90: 6f6e 2e73 6574 7465 720a 2020 2020 6465  on.setter.    de
+00024fa0: 6620 6465 7363 7269 7074 696f 6e28 7365  f description(se
+00024fb0: 6c66 2c20 6e65 775f 6465 7363 7269 7074  lf, new_descript
+00024fc0: 696f 6e29 3a0a 2020 2020 2020 2020 7365  ion):.        se
+00024fd0: 6c66 2e5f 6465 7363 7269 7074 696f 6e20  lf._description 
+00024fe0: 3d20 6e65 775f 6465 7363 7269 7074 696f  = new_descriptio
+00024ff0: 6e0a 0a20 2020 2040 7072 6f70 6572 7479  n..    @property
+00025000: 0a20 2020 2064 6566 2066 6561 7475 7265  .    def feature
+00025010: 5f73 746f 7265 5f6e 616d 6528 7365 6c66  _store_name(self
+00025020: 293a 0a20 2020 2020 2020 2022 2222 4e61  ):.        """Na
+00025030: 6d65 206f 6620 7468 6520 6665 6174 7572  me of the featur
+00025040: 6520 7374 6f72 6520 696e 2077 6869 6368  e store in which
+00025050: 2074 6865 2066 6561 7475 7265 2067 726f   the feature gro
+00025060: 7570 2069 7320 6c6f 6361 7465 642e 2222  up is located.""
+00025070: 220a 2020 2020 2020 2020 7265 7475 726e  ".        return
+00025080: 2073 656c 662e 5f66 6561 7475 7265 5f73   self._feature_s
+00025090: 746f 7265 5f6e 616d 650a 0a0a 636c 6173  tore_name...clas
+000250a0: 7320 5370 696e 6547 726f 7570 2846 6561  s SpineGroup(Fea
+000250b0: 7475 7265 4772 6f75 7042 6173 6529 3a0a  tureGroupBase):.
+000250c0: 2020 2020 5350 494e 455f 4752 4f55 5020      SPINE_GROUP 
+000250d0: 3d20 224f 4e5f 4445 4d41 4e44 5f46 4541  = "ON_DEMAND_FEA
+000250e0: 5455 5245 5f47 524f 5550 220a 2020 2020  TURE_GROUP".    
+000250f0: 454e 5449 5459 5f54 5950 4520 3d20 2266  ENTITY_TYPE = "f
+00025100: 6561 7475 7265 6772 6f75 7073 220a 0a20  eaturegroups".. 
+00025110: 2020 2064 6566 205f 5f69 6e69 745f 5f28     def __init__(
+00025120: 0a20 2020 2020 2020 2073 656c 662c 0a20  .        self,. 
+00025130: 2020 2020 2020 2073 746f 7261 6765 5f63         storage_c
+00025140: 6f6e 6e65 6374 6f72 3d4e 6f6e 652c 0a20  onnector=None,. 
+00025150: 2020 2020 2020 2071 7565 7279 3d4e 6f6e         query=Non
+00025160: 652c 0a20 2020 2020 2020 2064 6174 615f  e,.        data_
+00025170: 666f 726d 6174 3d4e 6f6e 652c 0a20 2020  format=None,.   
+00025180: 2020 2020 2070 6174 683d 4e6f 6e65 2c0a       path=None,.
+00025190: 2020 2020 2020 2020 6f70 7469 6f6e 733d          options=
+000251a0: 7b7d 2c0a 2020 2020 2020 2020 6e61 6d65  {},.        name
+000251b0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2076  =None,.        v
+000251c0: 6572 7369 6f6e 3d4e 6f6e 652c 0a20 2020  ersion=None,.   
+000251d0: 2020 2020 2064 6573 6372 6970 7469 6f6e       description
+000251e0: 3d4e 6f6e 652c 0a20 2020 2020 2020 2070  =None,.        p
+000251f0: 7269 6d61 7279 5f6b 6579 3d4e 6f6e 652c  rimary_key=None,
+00025200: 0a20 2020 2020 2020 2066 6561 7475 7265  .        feature
+00025210: 7374 6f72 655f 6964 3d4e 6f6e 652c 0a20  store_id=None,. 
+00025220: 2020 2020 2020 2066 6561 7475 7265 7374         featurest
+00025230: 6f72 655f 6e61 6d65 3d4e 6f6e 652c 0a20  ore_name=None,. 
+00025240: 2020 2020 2020 2063 7265 6174 6564 3d4e         created=N
+00025250: 6f6e 652c 0a20 2020 2020 2020 2063 7265  one,.        cre
+00025260: 6174 6f72 3d4e 6f6e 652c 0a20 2020 2020  ator=None,.     
+00025270: 2020 2069 643d 4e6f 6e65 2c0a 2020 2020     id=None,.    
+00025280: 2020 2020 6665 6174 7572 6573 3d4e 6f6e      features=Non
+00025290: 652c 0a20 2020 2020 2020 206c 6f63 6174  e,.        locat
+000252a0: 696f 6e3d 4e6f 6e65 2c0a 2020 2020 2020  ion=None,.      
+000252b0: 2020 7374 6174 6973 7469 6373 5f63 6f6e    statistics_con
+000252c0: 6669 673d 4e6f 6e65 2c0a 2020 2020 2020  fig=None,.      
+000252d0: 2020 6576 656e 745f 7469 6d65 3d4e 6f6e    event_time=Non
+000252e0: 652c 0a20 2020 2020 2020 2065 7870 6563  e,.        expec
+000252f0: 7461 7469 6f6e 5f73 7569 7465 3d4e 6f6e  tation_suite=Non
+00025300: 652c 0a20 2020 2020 2020 206f 6e6c 696e  e,.        onlin
+00025310: 655f 656e 6162 6c65 643d 4661 6c73 652c  e_enabled=False,
+00025320: 0a20 2020 2020 2020 2068 7265 663d 4e6f  .        href=No
+00025330: 6e65 2c0a 2020 2020 2020 2020 6f6e 6c69  ne,.        onli
+00025340: 6e65 5f74 6f70 6963 5f6e 616d 653d 4e6f  ne_topic_name=No
+00025350: 6e65 2c0a 2020 2020 2020 2020 746f 7069  ne,.        topi
+00025360: 635f 6e61 6d65 3d4e 6f6e 652c 0a20 2020  c_name=None,.   
+00025370: 2020 2020 2073 7069 6e65 3d54 7275 652c       spine=True,
+00025380: 0a20 2020 2020 2020 2064 6174 6166 7261  .        datafra
+00025390: 6d65 3d22 7370 696e 6522 2c0a 2020 2020  me="spine",.    
+000253a0: 2020 2020 6465 7072 6563 6174 6564 3d46      deprecated=F
+000253b0: 616c 7365 2c0a 2020 2020 2020 2020 2a2a  alse,.        **
+000253c0: 6b77 6172 6773 2c0a 2020 2020 293a 0a20  kwargs,.    ):. 
+000253d0: 2020 2020 2020 2073 7570 6572 2829 2e5f         super()._
+000253e0: 5f69 6e69 745f 5f28 0a20 2020 2020 2020  _init__(.       
+000253f0: 2020 2020 206e 616d 652c 0a20 2020 2020       name,.     
+00025400: 2020 2020 2020 2076 6572 7369 6f6e 2c0a         version,.
+00025410: 2020 2020 2020 2020 2020 2020 6665 6174              feat
+00025420: 7572 6573 746f 7265 5f69 642c 0a20 2020  urestore_id,.   
+00025430: 2020 2020 2020 2020 206c 6f63 6174 696f           locatio
+00025440: 6e2c 0a20 2020 2020 2020 2020 2020 2065  n,.            e
+00025450: 7665 6e74 5f74 696d 653d 6576 656e 745f  vent_time=event_
+00025460: 7469 6d65 2c0a 2020 2020 2020 2020 2020  time,.          
+00025470: 2020 6f6e 6c69 6e65 5f65 6e61 626c 6564    online_enabled
+00025480: 3d6f 6e6c 696e 655f 656e 6162 6c65 642c  =online_enabled,
+00025490: 0a20 2020 2020 2020 2020 2020 2069 643d  .            id=
+000254a0: 6964 2c0a 2020 2020 2020 2020 2020 2020  id,.            
+000254b0: 6578 7065 6374 6174 696f 6e5f 7375 6974  expectation_suit
+000254c0: 653d 6578 7065 6374 6174 696f 6e5f 7375  e=expectation_su
+000254d0: 6974 652c 0a20 2020 2020 2020 2020 2020  ite,.           
+000254e0: 206f 6e6c 696e 655f 746f 7069 635f 6e61   online_topic_na
+000254f0: 6d65 3d6f 6e6c 696e 655f 746f 7069 635f  me=online_topic_
+00025500: 6e61 6d65 2c0a 2020 2020 2020 2020 2020  name,.          
+00025510: 2020 746f 7069 635f 6e61 6d65 3d74 6f70    topic_name=top
+00025520: 6963 5f6e 616d 652c 0a20 2020 2020 2020  ic_name,.       
+00025530: 2020 2020 2064 6570 7265 6361 7465 643d       deprecated=
+00025540: 6465 7072 6563 6174 6564 2c0a 2020 2020  deprecated,.    
+00025550: 2020 2020 290a 0a20 2020 2020 2020 2073      )..        s
+00025560: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
+00025570: 7265 5f6e 616d 6520 3d20 6665 6174 7572  re_name = featur
+00025580: 6573 746f 7265 5f6e 616d 650a 2020 2020  estore_name.    
+00025590: 2020 2020 7365 6c66 2e5f 6465 7363 7269      self._descri
+000255a0: 7074 696f 6e20 3d20 6465 7363 7269 7074  ption = descript
+000255b0: 696f 6e0a 2020 2020 2020 2020 7365 6c66  ion.        self
+000255c0: 2e5f 6372 6561 7465 6420 3d20 6372 6561  ._created = crea
+000255d0: 7465 640a 2020 2020 2020 2020 7365 6c66  ted.        self
+000255e0: 2e5f 6372 6561 746f 7220 3d20 7573 6572  ._creator = user
+000255f0: 2e55 7365 722e 6672 6f6d 5f72 6573 706f  .User.from_respo
+00025600: 6e73 655f 6a73 6f6e 2863 7265 6174 6f72  nse_json(creator
+00025610: 290a 0a20 2020 2020 2020 2073 656c 662e  )..        self.
+00025620: 5f66 6561 7475 7265 7320 3d20 5b0a 2020  _features = [.  
+00025630: 2020 2020 2020 2020 2020 6665 6174 7572            featur
+00025640: 652e 4665 6174 7572 652e 6672 6f6d 5f72  e.Feature.from_r
+00025650: 6573 706f 6e73 655f 6a73 6f6e 2866 6561  esponse_json(fea
+00025660: 7429 2069 6620 6973 696e 7374 616e 6365  t) if isinstance
+00025670: 2866 6561 742c 2064 6963 7429 2065 6c73  (feat, dict) els
+00025680: 6520 6665 6174 0a20 2020 2020 2020 2020  e feat.         
+00025690: 2020 2066 6f72 2066 6561 7420 696e 2028     for feat in (
+000256a0: 6665 6174 7572 6573 206f 7220 5b5d 290a  features or []).
+000256b0: 2020 2020 2020 2020 5d0a 0a20 2020 2020          ]..     
+000256c0: 2020 2073 656c 662e 5f66 6561 7475 7265     self._feature
+000256d0: 5f67 726f 7570 5f65 6e67 696e 6520 3d20  _group_engine = 
+000256e0: 7370 696e 655f 6772 6f75 705f 656e 6769  spine_group_engi
+000256f0: 6e65 2e53 7069 6e65 4772 6f75 7045 6e67  ne.SpineGroupEng
+00025700: 696e 6528 0a20 2020 2020 2020 2020 2020  ine(.           
+00025710: 2066 6561 7475 7265 7374 6f72 655f 6964   featurestore_id
+00025720: 0a20 2020 2020 2020 2029 0a0a 2020 2020  .        )..    
+00025730: 2020 2020 6966 2073 656c 662e 5f69 643a      if self._id:
+00025740: 0a20 2020 2020 2020 2020 2020 2023 2047  .            # G
+00025750: 6f74 2066 726f 6d20 486f 7073 776f 726b  ot from Hopswork
+00025760: 732c 2064 6573 6572 6961 6c69 7a65 2066  s, deserialize f
+00025770: 6561 7475 7265 7320 616e 6420 7374 6f72  eatures and stor
+00025780: 6167 6520 636f 6e6e 6563 746f 720a 2020  age connector.  
+00025790: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+000257a0: 6665 6174 7572 6573 203d 2028 0a20 2020  features = (.   
+000257b0: 2020 2020 2020 2020 2020 2020 205b 0a20               [. 
+000257c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000257d0: 2020 2066 6561 7475 7265 2e46 6561 7475     feature.Featu
+000257e0: 7265 2e66 726f 6d5f 7265 7370 6f6e 7365  re.from_response
+000257f0: 5f6a 736f 6e28 6665 6174 290a 2020 2020  _json(feat).    
+00025800: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00025810: 6966 2069 7369 6e73 7461 6e63 6528 6665  if isinstance(fe
+00025820: 6174 2c20 6469 6374 290a 2020 2020 2020  at, dict).      
+00025830: 2020 2020 2020 2020 2020 2020 2020 656c                el
+00025840: 7365 2066 6561 740a 2020 2020 2020 2020  se feat.        
+00025850: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00025860: 6665 6174 2069 6e20 6665 6174 7572 6573  feat in features
+00025870: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00025880: 205d 0a20 2020 2020 2020 2020 2020 2020   ].             
+00025890: 2020 2069 6620 6665 6174 7572 6573 0a20     if features. 
+000258a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+000258b0: 6c73 6520 4e6f 6e65 0a20 2020 2020 2020  lse None.       
+000258c0: 2020 2020 2029 0a20 2020 2020 2020 2020       ).         
+000258d0: 2020 2073 656c 662e 7072 696d 6172 795f     self.primary_
+000258e0: 6b65 7920 3d20 280a 2020 2020 2020 2020  key = (.        
+000258f0: 2020 2020 2020 2020 5b66 6561 742e 6e61          [feat.na
+00025900: 6d65 2066 6f72 2066 6561 7420 696e 2073  me for feat in s
+00025910: 656c 662e 5f66 6561 7475 7265 7320 6966  elf._features if
+00025920: 2066 6561 742e 7072 696d 6172 7920 6973   feat.primary is
+00025930: 2054 7275 655d 0a20 2020 2020 2020 2020   True].         
+00025940: 2020 2020 2020 2069 6620 7365 6c66 2e5f         if self._
+00025950: 6665 6174 7572 6573 0a20 2020 2020 2020  features.       
+00025960: 2020 2020 2020 2020 2065 6c73 6520 5b5d           else []
+00025970: 0a20 2020 2020 2020 2020 2020 2029 0a20  .            ). 
+00025980: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00025990: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+000259a0: 6720 3d20 7374 6174 6973 7469 6373 5f63  g = statistics_c
+000259b0: 6f6e 6669 670a 2020 2020 2020 2020 656c  onfig.        el
+000259c0: 7365 3a0a 2020 2020 2020 2020 2020 2020  se:.            
+000259d0: 7365 6c66 2e70 7269 6d61 7279 5f6b 6579  self.primary_key
+000259e0: 203d 2070 7269 6d61 7279 5f6b 6579 0a20   = primary_key. 
+000259f0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00025a00: 7374 6174 6973 7469 6373 5f63 6f6e 6669  statistics_confi
+00025a10: 6720 3d20 7374 6174 6973 7469 6373 5f63  g = statistics_c
+00025a20: 6f6e 6669 670a 2020 2020 2020 2020 2020  onfig.          
+00025a30: 2020 7365 6c66 2e5f 6665 6174 7572 6573    self._features
+00025a40: 203d 2066 6561 7475 7265 730a 0a20 2020   = features..   
+00025a50: 2020 2020 2073 656c 662e 5f68 7265 6620       self._href 
+00025a60: 3d20 6872 6566 0a0a 2020 2020 2020 2020  = href..        
+00025a70: 2320 6861 7320 746f 2068 6170 7065 6e20  # has to happen 
+00025a80: 6c61 7374 202d 3e20 6665 6174 7572 6573  last -> features
+00025a90: 2061 6e64 2069 6420 6172 6520 6e65 6564   and id are need
+00025aa0: 6564 2066 6f72 2073 6368 656d 6120 7665  ed for schema ve
+00025ab0: 7269 6669 6361 7469 6f6e 0a20 2020 2020  rification.     
+00025ac0: 2020 2023 2075 7365 2073 6574 7465 7220     # use setter 
+00025ad0: 746f 2063 6f6e 7665 7274 2074 6f20 6465  to convert to de
+00025ae0: 6661 756c 7420 6461 7461 6672 616d 6520  fault dataframe 
+00025af0: 7479 7065 2066 6f72 2065 6e67 696e 650a  type for engine.
+00025b00: 2020 2020 2020 2020 7365 6c66 2e64 6174          self.dat
+00025b10: 6166 7261 6d65 203d 2064 6174 6166 7261  aframe = datafra
+00025b20: 6d65 0a0a 2020 2020 6465 6620 5f73 6176  me..    def _sav
+00025b30: 6528 7365 6c66 293a 0a20 2020 2020 2020  e(self):.       
+00025b40: 2022 2222 5065 7273 6973 7420 7468 6520   """Persist the 
+00025b50: 6d65 7461 6461 7461 2066 6f72 2074 6869  metadata for thi
+00025b60: 7320 7370 696e 6520 6772 6f75 702e 0a0a  s spine group...
+00025b70: 2020 2020 2020 2020 5769 7468 6f75 7420          Without 
+00025b80: 6361 6c6c 696e 6720 7468 6973 206d 6574  calling this met
+00025b90: 686f 642c 2079 6f75 7220 6665 6174 7572  hod, your featur
+00025ba0: 6520 6772 6f75 7020 7769 6c6c 206f 6e6c  e group will onl
+00025bb0: 7920 6578 6973 740a 2020 2020 2020 2020  y exist.        
+00025bc0: 696e 2079 6f75 7220 5079 7468 6f6e 204b  in your Python K
+00025bd0: 6572 6e65 6c2c 2062 7574 206e 6f74 2069  ernel, but not i
+00025be0: 6e20 486f 7073 776f 726b 732e 0a0a 2020  n Hopsworks...  
+00025bf0: 2020 2020 2020 6060 6070 7974 686f 6e0a        ```python.
+00025c00: 2020 2020 2020 2020 7175 6572 7920 3d20          query = 
+00025c10: 2253 454c 4543 5420 2a20 4652 4f4d 2073  "SELECT * FROM s
+00025c20: 616c 6573 220a 0a20 2020 2020 2020 2066  ales"..        f
+00025c30: 6720 3d20 6665 6174 7572 655f 7374 6f72  g = feature_stor
+00025c40: 652e 6372 6561 7465 5f73 7069 6e65 5f67  e.create_spine_g
+00025c50: 726f 7570 286e 616d 653d 2273 616c 6573  roup(name="sales
+00025c60: 222c 0a20 2020 2020 2020 2020 2020 2076  ",.            v
+00025c70: 6572 7369 6f6e 3d31 2c0a 2020 2020 2020  ersion=1,.      
+00025c80: 2020 2020 2020 6465 7363 7269 7074 696f        descriptio
+00025c90: 6e3d 2250 6879 7369 6361 6c20 7368 6f70  n="Physical shop
+00025ca0: 2073 616c 6573 2066 6561 7475 7265 7322   sales features"
+00025cb0: 2c0a 2020 2020 2020 2020 2020 2020 7072  ,.            pr
+00025cc0: 696d 6172 795f 6b65 793d 5b27 7373 5f73  imary_key=['ss_s
+00025cd0: 746f 7265 5f73 6b27 5d2c 0a20 2020 2020  tore_sk'],.     
+00025ce0: 2020 2020 2020 2065 7665 6e74 5f74 696d         event_tim
+00025cf0: 653d 2773 616c 655f 6461 7465 272c 0a20  e='sale_date',. 
+00025d00: 2020 2020 2020 2020 2020 2064 6174 6166             dataf
+00025d10: 7261 6d65 3d64 662c 0a20 2020 2020 2020  rame=df,.       
+00025d20: 2029 0a0a 2020 2020 2020 2020 6667 2e5f   )..        fg._
+00025d30: 7361 7665 2829 0a20 2020 2020 2020 2022  save().        "
+00025d40: 2222 0a20 2020 2020 2020 2073 656c 662e  "".        self.
+00025d50: 5f66 6561 7475 7265 5f67 726f 7570 5f65  _feature_group_e
+00025d60: 6e67 696e 652e 7361 7665 2873 656c 6629  ngine.save(self)
+00025d70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00025d80: 7365 6c66 0a0a 2020 2020 4070 726f 7065  self..    @prope
+00025d90: 7274 790a 2020 2020 6465 6620 6461 7461  rty.    def data
+00025da0: 6672 616d 6528 7365 6c66 293a 0a20 2020  frame(self):.   
+00025db0: 2020 2020 2022 2222 5370 696e 6520 6461       """Spine da
+00025dc0: 7461 6672 616d 6520 7769 7468 2070 7269  taframe with pri
+00025dd0: 6d61 7279 206b 6579 2c20 6576 656e 7420  mary key, event 
+00025de0: 7469 6d65 2061 6e64 0a20 2020 2020 2020  time and.       
+00025df0: 206c 6162 656c 2063 6f6c 756d 6e20 746f   label column to
+00025e00: 2075 7365 2066 6f72 2070 6f69 6e74 2069   use for point i
+00025e10: 6e20 7469 6d65 206a 6f69 6e20 7768 656e  n time join when
+00025e20: 2066 6574 6368 696e 6720 6665 6174 7572   fetching featur
+00025e30: 6573 2e0a 2020 2020 2020 2020 2222 220a  es..        """.
+00025e40: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00025e50: 656c 662e 5f64 6174 6166 7261 6d65 0a0a  elf._dataframe..
+00025e60: 2020 2020 4064 6174 6166 7261 6d65 2e73      @dataframe.s
+00025e70: 6574 7465 720a 2020 2020 6465 6620 6461  etter.    def da
+00025e80: 7461 6672 616d 6528 7365 6c66 2c20 6461  taframe(self, da
+00025e90: 7461 6672 616d 6529 3a0a 2020 2020 2020  taframe):.      
+00025ea0: 2020 2222 2255 7064 6174 6520 7468 6520    """Update the 
+00025eb0: 7370 696e 6520 6461 7461 6672 616d 6520  spine dataframe 
+00025ec0: 636f 6e74 6169 6e65 6420 696e 2074 6865  contained in the
+00025ed0: 2073 7069 6e65 2067 726f 7570 2e22 2222   spine group."""
+00025ee0: 0a20 2020 2020 2020 2073 656c 662e 5f64  .        self._d
+00025ef0: 6174 6166 7261 6d65 203d 2065 6e67 696e  ataframe = engin
+00025f00: 652e 6765 745f 696e 7374 616e 6365 2829  e.get_instance()
+00025f10: 2e63 6f6e 7665 7274 5f74 6f5f 6465 6661  .convert_to_defa
+00025f20: 756c 745f 6461 7461 6672 616d 6528 6461  ult_dataframe(da
+00025f30: 7461 6672 616d 6529 0a0a 2020 2020 2020  taframe)..      
+00025f40: 2020 2320 696e 2066 7320 7175 6572 7920    # in fs query 
+00025f50: 7468 6520 6665 6174 7572 6573 2061 7265  the features are
+00025f60: 206e 6f74 2073 656e 742c 2073 6f20 7468   not sent, so th
+00025f70: 656e 2064 6f6e 2774 2064 6f20 7661 6c69  en don't do vali
+00025f80: 6461 7469 6f6e 0a20 2020 2020 2020 2069  dation.        i
+00025f90: 6620 280a 2020 2020 2020 2020 2020 2020  f (.            
+00025fa0: 7365 6c66 2e5f 6964 2069 7320 6e6f 7420  self._id is not 
+00025fb0: 4e6f 6e65 0a20 2020 2020 2020 2020 2020  None.           
+00025fc0: 2061 6e64 2073 656c 662e 5f64 6174 6166   and self._dataf
+00025fd0: 7261 6d65 2069 7320 6e6f 7420 4e6f 6e65  rame is not None
+00025fe0: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00025ff0: 2073 656c 662e 5f66 6561 7475 7265 7320   self._features 
+00026000: 6973 206e 6f74 204e 6f6e 650a 2020 2020  is not None.    
+00026010: 2020 2020 293a 0a20 2020 2020 2020 2020      ):.         
+00026020: 2020 2064 6174 6166 7261 6d65 5f66 6561     dataframe_fea
+00026030: 7475 7265 7320 3d20 656e 6769 6e65 2e67  tures = engine.g
+00026040: 6574 5f69 6e73 7461 6e63 6528 292e 7061  et_instance().pa
+00026050: 7273 655f 7363 6865 6d61 5f66 6561 7475  rse_schema_featu
+00026060: 7265 5f67 726f 7570 280a 2020 2020 2020  re_group(.      
+00026070: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
+00026080: 6461 7461 6672 616d 650a 2020 2020 2020  dataframe.      
+00026090: 2020 2020 2020 290a 2020 2020 2020 2020        ).        
+000260a0: 2020 2020 7365 6c66 2e5f 6665 6174 7572      self._featur
+000260b0: 655f 6772 6f75 705f 656e 6769 6e65 2e5f  e_group_engine._
+000260c0: 7665 7269 6679 5f73 6368 656d 615f 636f  verify_schema_co
+000260d0: 6d70 6174 6962 696c 6974 7928 0a20 2020  mpatibility(.   
+000260e0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+000260f0: 662e 5f66 6561 7475 7265 732c 2064 6174  f._features, dat
+00026100: 6166 7261 6d65 5f66 6561 7475 7265 730a  aframe_features.
+00026110: 2020 2020 2020 2020 2020 2020 290a 0a20              ).. 
+00026120: 2020 2040 636c 6173 736d 6574 686f 640a     @classmethod.
+00026130: 2020 2020 6465 6620 6672 6f6d 5f72 6573      def from_res
+00026140: 706f 6e73 655f 6a73 6f6e 2863 6c73 2c20  ponse_json(cls, 
+00026150: 6a73 6f6e 5f64 6963 7429 3a0a 2020 2020  json_dict):.    
+00026160: 2020 2020 6a73 6f6e 5f64 6563 616d 656c      json_decamel
+00026170: 697a 6564 203d 2068 756d 7073 2e64 6563  ized = humps.dec
+00026180: 616d 656c 697a 6528 6a73 6f6e 5f64 6963  amelize(json_dic
+00026190: 7429 0a20 2020 2020 2020 2069 6620 6973  t).        if is
+000261a0: 696e 7374 616e 6365 286a 736f 6e5f 6465  instance(json_de
+000261b0: 6361 6d65 6c69 7a65 642c 2064 6963 7429  camelized, dict)
+000261c0: 3a0a 2020 2020 2020 2020 2020 2020 5f20  :.            _ 
+000261d0: 3d20 6a73 6f6e 5f64 6563 616d 656c 697a  = json_decameliz
+000261e0: 6564 2e70 6f70 2822 7479 7065 222c 204e  ed.pop("type", N
+000261f0: 6f6e 6529 0a20 2020 2020 2020 2020 2020  one).           
+00026200: 2072 6574 7572 6e20 636c 7328 2a2a 6a73   return cls(**js
+00026210: 6f6e 5f64 6563 616d 656c 697a 6564 290a  on_decamelized).
+00026220: 2020 2020 2020 2020 666f 7220 6667 2069          for fg i
+00026230: 6e20 6a73 6f6e 5f64 6563 616d 656c 697a  n json_decameliz
+00026240: 6564 3a0a 2020 2020 2020 2020 2020 2020  ed:.            
+00026250: 5f20 3d20 6667 2e70 6f70 2822 7479 7065  _ = fg.pop("type
+00026260: 222c 204e 6f6e 6529 0a20 2020 2020 2020  ", None).       
+00026270: 2072 6574 7572 6e20 5b63 6c73 282a 2a66   return [cls(**f
+00026280: 6729 2066 6f72 2066 6720 696e 206a 736f  g) for fg in jso
+00026290: 6e5f 6465 6361 6d65 6c69 7a65 645d 0a0a  n_decamelized]..
+000262a0: 2020 2020 6465 6620 7570 6461 7465 5f66      def update_f
+000262b0: 726f 6d5f 7265 7370 6f6e 7365 5f6a 736f  rom_response_jso
+000262c0: 6e28 7365 6c66 2c20 6a73 6f6e 5f64 6963  n(self, json_dic
+000262d0: 7429 3a0a 2020 2020 2020 2020 6a73 6f6e  t):.        json
+000262e0: 5f64 6563 616d 656c 697a 6564 203d 2068  _decamelized = h
+000262f0: 756d 7073 2e64 6563 616d 656c 697a 6528  umps.decamelize(
+00026300: 6a73 6f6e 5f64 6963 7429 0a20 2020 2020  json_dict).     
+00026310: 2020 2069 6620 2274 7970 6522 2069 6e20     if "type" in 
+00026320: 6a73 6f6e 5f64 6563 616d 656c 697a 6564  json_decamelized
+00026330: 3a0a 2020 2020 2020 2020 2020 2020 5f20  :.            _ 
+00026340: 3d20 6a73 6f6e 5f64 6563 616d 656c 697a  = json_decameliz
+00026350: 6564 2e70 6f70 2822 7479 7065 2229 0a20  ed.pop("type"). 
+00026360: 2020 2020 2020 2073 656c 662e 5f5f 696e         self.__in
+00026370: 6974 5f5f 282a 2a6a 736f 6e5f 6465 6361  it__(**json_deca
+00026380: 6d65 6c69 7a65 6429 0a20 2020 2020 2020  melized).       
+00026390: 2072 6574 7572 6e20 7365 6c66 0a0a 2020   return self..  
+000263a0: 2020 6465 6620 6a73 6f6e 2873 656c 6629    def json(self)
+000263b0: 3a0a 2020 2020 2020 2020 7265 7475 726e  :.        return
+000263c0: 206a 736f 6e2e 6475 6d70 7328 7365 6c66   json.dumps(self
+000263d0: 2c20 636c 733d 7574 696c 2e46 6561 7475  , cls=util.Featu
+000263e0: 7265 5374 6f72 6545 6e63 6f64 6572 290a  reStoreEncoder).
+000263f0: 0a20 2020 2064 6566 2074 6f5f 6469 6374  .    def to_dict
+00026400: 2873 656c 6629 3a0a 2020 2020 2020 2020  (self):.        
+00026410: 7265 7475 726e 207b 0a20 2020 2020 2020  return {.       
+00026420: 2020 2020 2022 6964 223a 2073 656c 662e       "id": self.
+00026430: 5f69 642c 0a20 2020 2020 2020 2020 2020  _id,.           
+00026440: 2022 6e61 6d65 223a 2073 656c 662e 5f6e   "name": self._n
+00026450: 616d 652c 0a20 2020 2020 2020 2020 2020  ame,.           
+00026460: 2022 6465 7363 7269 7074 696f 6e22 3a20   "description": 
+00026470: 7365 6c66 2e5f 6465 7363 7269 7074 696f  self._descriptio
+00026480: 6e2c 0a20 2020 2020 2020 2020 2020 2022  n,.            "
+00026490: 7665 7273 696f 6e22 3a20 7365 6c66 2e5f  version": self._
+000264a0: 7665 7273 696f 6e2c 0a20 2020 2020 2020  version,.       
+000264b0: 2020 2020 2022 6665 6174 7572 6573 223a       "features":
+000264c0: 2073 656c 662e 5f66 6561 7475 7265 732c   self._features,
+000264d0: 0a20 2020 2020 2020 2020 2020 2022 6665  .            "fe
+000264e0: 6174 7572 6573 746f 7265 4964 223a 2073  aturestoreId": s
+000264f0: 656c 662e 5f66 6561 7475 7265 5f73 746f  elf._feature_sto
+00026500: 7265 5f69 642c 0a20 2020 2020 2020 2020  re_id,.         
+00026510: 2020 2022 7479 7065 223a 2022 6f6e 4465     "type": "onDe
+00026520: 6d61 6e64 4665 6174 7572 6567 726f 7570  mandFeaturegroup
+00026530: 4454 4f22 2c0a 2020 2020 2020 2020 2020  DTO",.          
+00026540: 2020 2273 7461 7469 7374 6963 7343 6f6e    "statisticsCon
+00026550: 6669 6722 3a20 7365 6c66 2e5f 7374 6174  fig": self._stat
+00026560: 6973 7469 6373 5f63 6f6e 6669 672c 0a20  istics_config,. 
+00026570: 2020 2020 2020 2020 2020 2022 6576 656e             "even
+00026580: 7454 696d 6522 3a20 7365 6c66 2e5f 6576  tTime": self._ev
+00026590: 656e 745f 7469 6d65 2c0a 2020 2020 2020  ent_time,.      
+000265a0: 2020 2020 2020 2273 7069 6e65 223a 2054        "spine": T
+000265b0: 7275 652c 0a20 2020 2020 2020 2020 2020  rue,.           
+000265c0: 2022 746f 7069 634e 616d 6522 3a20 7365   "topicName": se
+000265d0: 6c66 2e74 6f70 6963 5f6e 616d 652c 0a20  lf.topic_name,. 
+000265e0: 2020 2020 2020 2020 2020 2022 6465 7072             "depr
+000265f0: 6563 6174 6564 223a 2073 656c 662e 6465  ecated": self.de
+00026600: 7072 6563 6174 6564 2c0a 2020 2020 2020  precated,.      
+00026610: 2020 7d0a                                  }.
```

### Comparing `hsfs-3.7.3/hsfs/feature_group_commit.py` & `hsfs-3.7.4/hsfs/feature_group_commit.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/feature_group_writer.py` & `hsfs-3.7.4/hsfs/feature_group_writer.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/feature_store.py` & `hsfs-3.7.4/hsfs/feature_store.py`

 * *Files 2% similar despite different names*

```diff
@@ -10,18 +10,19 @@
 #   Unless required by applicable law or agreed to in
 #   writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import warnings
 import datetime
-from typing import Optional, Union, List, Dict, TypeVar
+from typing import Any, Optional, Union, List, Dict, TypeVar
 
 import humps
 import numpy
 import great_expectations as ge
 import pandas as pd
 import numpy as np
 
@@ -37,14 +38,15 @@
     util,
     storage_connector,
     expectation_suite,
     feature_view,
     usage,
 )
 from hsfs.core import (
+    arrow_flight_client,
     feature_group_api,
     storage_connector_api,
     training_dataset_api,
     feature_group_engine,
     feature_view_engine,
 )
 from hsfs.constructor.query import Query
@@ -85,27 +87,38 @@
         self._mysql_server_endpoint = mysql_server_endpoint
         self._online_enabled = online_enabled
         self._num_feature_groups = num_feature_groups
         self._num_training_datasets = num_training_datasets
         self._num_storage_connectors = num_storage_connectors
         self._num_feature_views = num_feature_views
 
-        self._feature_group_api = feature_group_api.FeatureGroupApi()
-        self._storage_connector_api = storage_connector_api.StorageConnectorApi()
-        self._training_dataset_api = training_dataset_api.TrainingDatasetApi(self._id)
+        self._feature_group_api: feature_group_api.FeatureGroupApi = (
+            feature_group_api.FeatureGroupApi()
+        )
+        self._storage_connector_api: storage_connector_api.StorageConnectorApi = (
+            storage_connector_api.StorageConnectorApi()
+        )
+        self._training_dataset_api: training_dataset_api.TrainingDatasetApi = (
+            training_dataset_api.TrainingDatasetApi(self._id)
+        )
 
-        self._feature_group_engine = feature_group_engine.FeatureGroupEngine(self._id)
+        self._feature_group_engine: feature_group_engine.FeatureGroupEngine = (
+            feature_group_engine.FeatureGroupEngine(self._id)
+        )
 
-        self._transformation_function_engine = (
-            transformation_function_engine.TransformationFunctionEngine(self._id)
+        self._transformation_function_engine: transformation_function_engine.TransformationFunctionEngine = transformation_function_engine.TransformationFunctionEngine(
+            self._id
+        )
+        self._feature_view_engine: feature_view_engine.FeatureViewEngine = (
+            feature_view_engine.FeatureViewEngine(self._id)
         )
         self._feature_view_engine = feature_view_engine.FeatureViewEngine(self._id)
 
     @classmethod
-    def from_response_json(cls, json_dict):
+    def from_response_json(cls, json_dict: Dict[str, Any]) -> FeatureStore:
         json_decamelized = humps.decamelize(json_dict)
         # fields below are removed from 3.4. remove them for backward compatibility.
         json_decamelized.pop("hdfs_store_path", None)
         json_decamelized.pop("featurestore_description", None)
         json_decamelized.pop("inode_id", None)
         return cls(**json_decamelized)
 
@@ -142,17 +155,15 @@
             warnings.warn(
                 "No version provided for getting feature group `{}`, defaulting to `{}`.".format(
                     name, self.DEFAULT_VERSION
                 ),
                 util.VersionWarning,
             )
             version = self.DEFAULT_VERSION
-        feature_group_object = self._feature_group_api.get(
-            self.id, name, version, feature_group_api.FeatureGroupApi.CACHED
-        )
+        feature_group_object = self._feature_group_api.get(self.id, name, version)
         feature_group_object.feature_store = self
         return feature_group_object
 
     def get_feature_groups(self, name: str):
         """Get a list of all versions of a feature group entity from the feature store.
 
         Getting a feature group from the Feature Store means getting its metadata handle
@@ -174,17 +185,15 @@
 
         # Returns
             `FeatureGroup`: List of feature group metadata objects.
 
         # Raises
             `hsfs.client.exceptions.RestAPIError`: If unable to retrieve feature group from the feature store.
         """
-        feature_group_object = self._feature_group_api.get(
-            self.id, name, None, feature_group_api.FeatureGroupApi.CACHED
-        )
+        feature_group_object = self._feature_group_api.get(self.id, name, None)
         for fg_object in feature_group_object:
             fg_object.feature_store = self
         return feature_group_object
 
     @usage.method_logger
     def get_on_demand_feature_group(self, name: str, version: int = None):
         """Get a external feature group entity from the feature store.
@@ -241,15 +250,17 @@
                 "No version provided for getting feature group `{}`, defaulting to `{}`.".format(
                     name, self.DEFAULT_VERSION
                 ),
                 util.VersionWarning,
             )
             version = self.DEFAULT_VERSION
         feature_group_object = self._feature_group_api.get(
-            self.id, name, version, feature_group_api.FeatureGroupApi.ONDEMAND
+            self.id,
+            name,
+            version,
         )
         feature_group_object.feature_store = self
         return feature_group_object
 
     @usage.method_logger
     def get_on_demand_feature_groups(self, name: str):
         """Get a list of all versions of an external feature group entity from the feature store.
@@ -294,15 +305,15 @@
         # Returns
             `ExternalFeatureGroup`: List of external feature group metadata objects.
 
         # Raises
             `hsfs.client.exceptions.RestAPIError`: If unable to retrieve feature group from the feature store.
         """
         feature_group_object = self._feature_group_api.get(
-            self.id, name, None, feature_group_api.FeatureGroupApi.ONDEMAND
+            feature_store_id=self.id, name=name, version=None
         )
         for fg_object in feature_group_object:
             fg_object.feature_store = self
         return feature_group_object
 
     def get_training_dataset(self, name: str, version: int = None):
         """Get a training dataset entity from the feature store.
@@ -685,17 +696,15 @@
             notification_topic_name: Optionally, define the name of the topic used for sending notifications when entries
                 are inserted or updated on the online feature store. If left undefined no notifications are sent.
 
         # Returns
             `FeatureGroup`. The feature group metadata object.
         """
         try:
-            feature_group_object = self._feature_group_api.get(
-                self.id, name, version, feature_group_api.FeatureGroupApi.CACHED
-            )
+            feature_group_object = self._feature_group_api.get(self.id, name, version)
             feature_group_object.feature_store = self
             return feature_group_object
         except exceptions.RestAPIError as e:
             if (
                 e.response.json().get("errorCode", "") == 270009
                 and e.response.status_code == 404
             ):
@@ -1096,17 +1105,15 @@
             dataframe: DataFrame, RDD, Ndarray, list. Spine dataframe with primary key, event time and
                 label column to use for point in time join when fetching features.
 
         # Returns
             `SpineGroup`. The spine group metadata object.
         """
         try:
-            spine = self._feature_group_api.get(
-                self.id, name, version, feature_group_api.FeatureGroupApi.SPINE
-            )
+            spine = self._feature_group_api.get(self.id, name, version)
             spine.feature_store = self
             spine.dataframe = dataframe
             return spine
         except exceptions.RestAPIError as e:
             if (
                 e.response.json().get("errorCode", "") == 270009
                 and e.response.status_code == 404
@@ -1677,14 +1684,23 @@
             `FeatureView`: List of feature view metadata objects.
 
         # Raises
             `hsfs.client.exceptions.RestAPIError`: If unable to retrieve feature view from the feature store.
         """
         return self._feature_view_engine.get(name)
 
+    def _disable_hopsworks_feature_query_service_client(self):
+        """Disable Hopsworks feature query service for the current session. This behaviour is not persisted on reset."""
+        arrow_flight_client._disable_feature_query_service_client()
+
+    def _reset_hopsworks_feature_query_service_client(self):
+        """Reset Hopsworks feature query service for the current session."""
+        arrow_flight_client.close()
+        arrow_flight_client.get_instance()
+
     @property
     def id(self):
         """Id of the feature store."""
         return self._id
 
     @property
     def name(self):
```

### Comparing `hsfs-3.7.3/hsfs/feature_view.py` & `hsfs-3.7.4/hsfs/feature_view.py`

 * *Files 1% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import warnings
 from datetime import datetime, date
 from typing import Optional, Union, List, Dict, Any, TypeVar
 from hsfs.client.exceptions import FeatureStoreException
 from hsfs.core import feature_monitoring_config as fmc
@@ -40,15 +41,15 @@
     feature_view_engine,
     transformation_function_engine,
     vector_server,
     statistics_engine,
     feature_monitoring_config_engine,
     feature_monitoring_result_engine,
 )
-from hsfs.transformation_function import TransformationFunction
+from hsfs import transformation_function as tf_mod
 from hsfs.statistics_config import StatisticsConfig
 from hsfs.statistics import Statistics
 from hsfs.core.feature_view_api import FeatureViewApi
 from hsfs.training_dataset_split import TrainingDatasetSplit
 from hsfs.serving_key import ServingKey
 from hsfs.core.vector_db_client import VectorDbClient
 from hsfs.feature import Feature
@@ -64,15 +65,17 @@
         featurestore_id,
         id=None,
         version: Optional[int] = None,
         description: Optional[str] = "",
         labels: Optional[List[str]] = [],
         inference_helper_columns: Optional[List[str]] = [],
         training_helper_columns: Optional[List[str]] = [],
-        transformation_functions: Optional[Dict[str, TransformationFunction]] = {},
+        transformation_functions: Optional[
+            Dict[str, tf_mod.TransformationFunction]
+        ] = {},
         featurestore_name=None,
         serving_keys: Optional[List[ServingKey]] = None,
         **kwargs,
     ):
         self._name = name
         self._id = id
         self._query = query
@@ -1023,15 +1026,15 @@
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             end_time: End event time for the batch query, exclusive. Optional. Strings should be
                 formatted in one of the following formats `%Y-%m-%d`, `%Y-%m-%d %H`, `%Y-%m-%d %H:%M`, `%Y-%m-%d %H:%M:%S`,
                 or `%Y-%m-%d %H:%M:%S.%f`. Int, i.e Unix Epoch should be in seconds.
             read_options: User provided read options.
                 Dictionary of read options for python engine:
                 * key `"use_hive"` and value `True` to read batch data with Hive instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 Defaults to `{}`.
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
             spine: Spine dataframe with primary key, event time and
                 label column to use for point in time join when fetching features. Defaults to `None` and is only required
                 when feature view was created with spine group in the feature query.
                 It is possible to directly pass a spine group instead of a dataframe to overwrite the left side of the
@@ -1349,15 +1352,15 @@
                 statistics computation pass `statistics_config=False`. Defaults to
                 `None` and will compute only descriptive statistics.
             write_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, write_options can contain the
                 following entries:
                 * key `use_spark` and value `True` to materialize training dataset
-                  with Spark instead of [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  with Spark instead of [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
@@ -1634,15 +1637,15 @@
                 statistics computation pass `statistics_config=False`. Defaults to
                 `None` and will compute only descriptive statistics.
             write_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, write_options can contain the
                 following entries:
                 * key `use_spark` and value `True` to materialize training dataset
-                  with Spark instead of [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  with Spark instead of [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
@@ -1917,15 +1920,15 @@
                 statistics computation pass `statistics_config=False`. Defaults to
                 `None` and will compute only descriptive statistics.
             write_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, write_options can contain the
                 following entries:
                 * key `use_spark` and value `True` to materialize training dataset
-                  with Spark instead of [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  with Spark instead of [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
@@ -2048,15 +2051,15 @@
                 statistics computation pass `statistics_config=False`. Defaults to
                 `None` and will compute only descriptive statistics.
             write_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, write_options can contain the
                 following entries:
                 * key `use_spark` and value `True` to materialize training dataset
-                  with Spark instead of [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  with Spark instead of [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `spark` and value an object of type
                 [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
                 * key `wait_for_job` and value `True` or `False` to configure
                   whether or not to the save call should return only
                   after the Hopsworks Job has finished. By default it waits.
                 Defaults to `{}`.
@@ -2170,15 +2173,15 @@
                 `None` and will compute only descriptive statistics.
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, read_options can contain the
                 following entries:
                 * key `"use_hive"` and value `True` to create in-memory training dataset
                   with Hive instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 * key `spark` and value an object of type
                   [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
@@ -2334,15 +2337,15 @@
                 `None` and will compute only descriptive statistics.
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, read_options can contain the
                 following entries:
                 * key `"use_hive"` and value `True` to create in-memory training dataset
                   with Hive instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 * key `spark` and value an object of type
                   [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
@@ -2532,15 +2535,15 @@
                 `None` and will compute only descriptive statistics.
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 When using the `python` engine, read_options can contain the
                 following entries:
                 * key `"use_hive"` and value `True` to create in-memory training dataset
                   with Hive instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 * key `spark` and value an object of type
                   [hsfs.core.job_configuration.JobConfiguration](../job_configuration)
                   to configure the Hopsworks Job used to compute the training dataset.
@@ -2669,15 +2672,15 @@
         # Arguments
             training_dataset_version: training dataset version
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 For python engine:
                 * key `"use_hive"` and value `True` to read training dataset
                   with the Hopsworks API instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 Defaults to `{}`.
             primary_keys: whether to include primary key features or not.  Defaults to `False`, no primary key
                 features.
@@ -2729,15 +2732,15 @@
         # Arguments
             training_dataset_version: training dataset version
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 For python engine:
                 * key `"use_hive"` and value `True` to read training dataset
                   with the Hopsworks API instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 Defaults to `{}`.
             primary_keys: whether to include primary key features or not.  Defaults to `False`, no primary key
                 features.
@@ -2791,15 +2794,15 @@
         # Arguments
             training_dataset_version: training dataset version
             read_options: Additional options as key/value pairs to pass to the execution engine.
                 For spark engine: Dictionary of read options for Spark.
                 For python engine:
                 * key `"use_hive"` and value `True` to read training dataset
                   with the Hopsworks API instead of
-                  [ArrowFlight Server](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
+                  [Hopsworks Feature Query Service](https://docs.hopsworks.ai/latest/setup_installation/common/arrow_flight_duckdb/).
                 * key `"arrow_flight_config"` to pass a dictionary of arrow flight configurations.
                   For example: `{"arrow_flight_config": {"timeout": 900}}`
                 * key `"hive_config"` to pass a dictionary of hive or tez configurations.
                   For example: `{"hive_config": {"hive.tez.cpu.vcores": 2, "tez.grouping.split-count": "3"}}`
                 Defaults to `{}`.
             primary_keys: whether to include primary key features or not.  Defaults to `False`, no primary key
                 features.
@@ -3484,42 +3487,44 @@
         """The labels/prediction feature of the feature view.
 
         Can be a composite of multiple features.
         """
         return self._labels
 
     @labels.setter
-    def labels(self, labels):
-        self._labels = [lb.lower() for lb in labels]
+    def labels(self, labels: List[str]) -> None:
+        self._labels = [util.autofix_feature_name(lb) for lb in labels]
 
     @property
     def inference_helper_columns(self):
         """The helper column sof the feature view.
 
         Can be a composite of multiple features.
         """
         return self._inference_helper_columns
 
     @inference_helper_columns.setter
     def inference_helper_columns(self, inference_helper_columns):
         self._inference_helper_columns = [
-            exf.lower() for exf in inference_helper_columns
+            util.autofix_feature_name(exf) for exf in inference_helper_columns
         ]
 
     @property
     def training_helper_columns(self):
         """The helper column sof the feature view.
 
         Can be a composite of multiple features.
         """
         return self._training_helper_columns
 
     @training_helper_columns.setter
-    def training_helper_columns(self, training_helper_columns):
-        self._training_helper_columns = [exf.lower() for exf in training_helper_columns]
+    def training_helper_columns(self, training_helper_columns: List[str]) -> None:
+        self._training_helper_columns = [
+            util.autofix_feature_name(exf) for exf in training_helper_columns
+        ]
 
     @property
     def description(self):
         """Description of the feature view."""
         return self._description
 
     @description.setter
```

### Comparing `hsfs-3.7.3/hsfs/ge_expectation.py` & `hsfs-3.7.4/hsfs/ge_expectation.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/ge_validation_result.py` & `hsfs-3.7.4/hsfs/ge_validation_result.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/serving_key.py` & `hsfs-3.7.4/hsfs/serving_key.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/split_statistics.py` & `hsfs-3.7.4/hsfs/split_statistics.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/statistics.py` & `hsfs-3.7.4/hsfs/statistics.py`

 * *Files 11% similar despite different names*

```diff
@@ -9,22 +9,23 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import humps
 from typing import Optional, List, Union
 
 from hsfs import util
 from hsfs.split_statistics import SplitStatistics
-from hsfs.core.feature_descriptive_statistics import FeatureDescriptiveStatistics
+from hsfs.core import feature_descriptive_statistics as fds_mod
 
 
 class Statistics:
     DEFAULT_ROW_PERCENTAGE = 1.0
 
     def __init__(
         self,
@@ -62,33 +63,35 @@
         self._feature_view_version = feature_view_version
         self._training_dataset_version = training_dataset_version
         self._split_statistics = self._parse_split_statistics(split_statistics)
         self._before_transformation = before_transformation
 
     def _parse_descriptive_statistics(
         self,
-        desc_statistics: Union[dict, FeatureDescriptiveStatistics],
-    ) -> Optional[List[FeatureDescriptiveStatistics]]:
+        desc_statistics: Union[dict, fds_mod.FeatureDescriptiveStatistics],
+    ) -> Optional[List[fds_mod.FeatureDescriptiveStatistics]]:
         if desc_statistics is None:
             return None
-        elif isinstance(desc_statistics, FeatureDescriptiveStatistics):
+        elif isinstance(desc_statistics, fds_mod.FeatureDescriptiveStatistics):
             return [desc_statistics]
         elif isinstance(desc_statistics, dict) and "items" not in desc_statistics:
-            return [FeatureDescriptiveStatistics.from_response_json(desc_statistics)]
+            return [
+                fds_mod.FeatureDescriptiveStatistics.from_response_json(desc_statistics)
+            ]
         elif isinstance(desc_statistics, dict) and "items" in desc_statistics:
             return [
-                FeatureDescriptiveStatistics.from_response_json(fds)
+                fds_mod.FeatureDescriptiveStatistics.from_response_json(fds)
                 for fds in desc_statistics["items"]
             ]
         elif isinstance(desc_statistics, list):
             return [
                 (
                     fds
-                    if isinstance(fds, FeatureDescriptiveStatistics)
-                    else FeatureDescriptiveStatistics.from_response_json(fds)
+                    if isinstance(fds, fds_mod.FeatureDescriptiveStatistics)
+                    else fds_mod.FeatureDescriptiveStatistics.from_response_json(fds)
                 )
                 for fds in desc_statistics
             ]
         else:
             raise ValueError(
                 "Descriptive statistics must be a FeatureDescriptiveStatistics object or a dictionary"
             )
@@ -170,15 +173,15 @@
             self._row_percentage = self.DEFAULT_ROW_PERCENTAGE
         else:
             raise TypeError("Row percentage must be a float between 0 and 1.")
 
     @property
     def feature_descriptive_statistics(
         self,
-    ) -> Optional[List[FeatureDescriptiveStatistics]]:
+    ) -> Optional[List[fds_mod.FeatureDescriptiveStatistics]]:
         """List of feature descriptive statistics."""
         return self._feature_descriptive_statistics
 
     @property
     def feature_group_id(self) -> Optional[int]:
         """Id of the feature group on whose data the statistics were computed."""
         return self._feature_group_id
```

### Comparing `hsfs-3.7.3/hsfs/statistics_config.py` & `hsfs-3.7.4/hsfs/statistics_config.py`

 * *Files 1% similar despite different names*

```diff
@@ -9,14 +9,15 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import humps
 
 from hsfs import util
```

### Comparing `hsfs-3.7.3/hsfs/storage_connector.py` & `hsfs-3.7.4/hsfs/storage_connector.py`

 * *Files 0% similar despite different names*

```diff
@@ -9,14 +9,16 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
+
 import os
 import re
 from abc import ABC, abstractmethod
 from typing import Optional
 
 import humps
 import base64
```

### Comparing `hsfs-3.7.3/hsfs/tag.py` & `hsfs-3.7.4/hsfs/tag.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/training_dataset.py` & `hsfs-3.7.4/hsfs/training_dataset.py`

 * *Files 2% similar despite different names*

```diff
@@ -8,14 +8,15 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import json
 import warnings
 from typing import Optional, Union, Any, Dict, List, TypeVar
 
 import humps
 import pandas as pd
@@ -29,15 +30,16 @@
     training_dataset_api,
     training_dataset_engine,
     statistics_engine,
     code_engine,
     transformation_function_engine,
     vector_server,
 )
-from hsfs.constructor import query, filter
+from hsfs.constructor import query as query_mod
+from hsfs.constructor import filter as filter_mod
 from hsfs.client.exceptions import RestAPIError
 
 
 class TrainingDatasetBase:
     # NOTE: This class is exposed to users with the only purpose of providing information about a Training Dataset
     # and, therefore, it should not implement any functionality and remain with as minimal as possible
 
@@ -124,16 +126,16 @@
                 train_end,
                 validation_start,
                 validation_end,
                 test_start,
                 test_end,
             )
             self._extra_filter = (
-                filter.Logic(filter.Logic.SINGLE, left_f=extra_filter)
-                if isinstance(extra_filter, filter.Filter)
+                filter_mod.Logic(filter_mod.Logic.SINGLE, left_f=extra_filter)
+                if isinstance(extra_filter, filter_mod.Filter)
                 else extra_filter
             )
         else:
             self._start_time = event_start_time
             self._end_time = event_end_time
             # type available -> init from backend response
             # make rest call to get all connector information, description etc.
@@ -149,16 +151,20 @@
             ]
             self._splits = [
                 TrainingDatasetSplit.from_response_json(split) for split in splits
             ]
             self._statistics_config = StatisticsConfig.from_response_json(
                 statistics_config
             )
-            self._label = [feat.name.lower() for feat in self._features if feat.label]
-            self._extra_filter = filter.Logic.from_response_json(extra_filter)
+            self._label = [
+                util.autofix_feature_name(feat.name)
+                for feat in self._features
+                if feat.label
+            ]
+            self._extra_filter = filter_mod.Logic.from_response_json(extra_filter)
 
     def _set_time_splits(
         self,
         time_split_size,
         train_start=None,
         train_end=None,
         validation_start=None,
@@ -585,15 +591,15 @@
         self._vector_server = vector_server.VectorServer(
             featurestore_id, features=self._features
         )
 
     def save(
         self,
         features: Union[
-            query.Query,
+            query_mod.Query,
             pd.DataFrame,
             TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
             TypeVar("pyspark.RDD"),  # noqa: F821
             np.ndarray,
             List[list],
         ],
         write_options: Optional[Dict[Any, Any]] = {},
@@ -648,15 +654,15 @@
             )
 
         return td_job
 
     def insert(
         self,
         features: Union[
-            query.Query,
+            query_mod.Query,
             pd.DataFrame,
             TypeVar("pyspark.sql.DataFrame"),  # noqa: F821
             TypeVar("pyspark.RDD"),  # noqa: F821
             np.ndarray,
             List[list],
         ],
         overwrite: bool,
@@ -1045,31 +1051,31 @@
             positions of this features in training dataset query.
         """
         if self._vector_server.prepared_statements is None:
             self.init_prepared_statement(None, external)
         return self._vector_server.get_feature_vectors(entry)
 
     @property
-    def label(self):
+    def label(self) -> Union[str, List[str]]:
         """The label/prediction feature of the training dataset.
 
         Can be a composite of multiple features.
         """
         return self._label
 
     @label.setter
-    def label(self, label):
-        self._label = [lb.lower() for lb in label]
+    def label(self, label: str) -> None:
+        self._label = [util.autofix_feature_name(lb) for lb in label]
 
     @property
-    def feature_store_id(self):
+    def feature_store_id(self) -> int:
         return self._feature_store_id
 
     @property
-    def feature_store_name(self):
+    def feature_store_name(self) -> str:
         """Name of the feature store in which the feature group is located."""
         return self._feature_store_name
 
     @property
     def transformation_functions(self):
         """Set transformation functions."""
         if self._id is not None and self._transformation_functions is None:
```

### Comparing `hsfs-3.7.3/hsfs/training_dataset_feature.py` & `hsfs-3.7.4/hsfs/training_dataset_feature.py`

 * *Files 4% similar despite different names*

```diff
@@ -9,20 +9,22 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import humps
 
-import hsfs.feature_group as feature_group
-from hsfs.feature import Feature
-from hsfs.transformation_function import TransformationFunction
+from hsfs import feature as feature_mod
+from hsfs import feature_group as feature_group_mod
+from hsfs import transformation_function as tf_mod
+from hsfs import util
 
 
 class TrainingDatasetFeature:
     def __init__(
         self,
         name,
         type=None,
@@ -31,28 +33,28 @@
         feature_group_feature_name=None,
         label=False,
         inference_helper_column=False,
         training_helper_column=False,
         transformation_function=None,
         **kwargs,
     ):
-        self._name = name.lower()
+        self._name = util.autofix_feature_name(name)
         self._type = type
         self._index = index
         self._feature_group = (
-            feature_group.FeatureGroup.from_response_json(featuregroup)
+            feature_group_mod.FeatureGroup.from_response_json(featuregroup)
             if isinstance(featuregroup, dict)
             else featuregroup
         )
         self._feature_group_feature_name = feature_group_feature_name
         self._label = label
         self._inference_helper_column = inference_helper_column
         self._training_helper_column = training_helper_column
         self._transformation_function = (
-            TransformationFunction.from_response_json(transformation_function)
+            tf_mod.TransformationFunction.from_response_json(transformation_function)
             if isinstance(transformation_function, dict)
             else transformation_function
         )
 
     def to_dict(self):
         return {
             "name": self._name,
@@ -69,15 +71,17 @@
     @classmethod
     def from_response_json(cls, json_dict):
         json_decamelized = humps.decamelize(json_dict)
         return cls(**json_decamelized)
 
     def is_complex(self):
         """Returns true if the feature has a complex type."""
-        return any(map(self._type.upper().startswith, Feature.COMPLEX_TYPES))
+        return any(
+            map(self._type.upper().startswith, feature_mod.Feature.COMPLEX_TYPES)
+        )
 
     @property
     def name(self):
         """Name of the feature."""
         return self._name
 
     @property
```

### Comparing `hsfs-3.7.3/hsfs/training_dataset_split.py` & `hsfs-3.7.4/hsfs/training_dataset_split.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/transformation_function.py` & `hsfs-3.7.4/hsfs/transformation_function.py`

 * *Files 1% similar despite different names*

```diff
@@ -8,14 +8,15 @@
 #
 #  Unless required by applicable law or agreed to in writing, software
 #  distributed under the License is distributed on an "AS IS" BASIS,
 #  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #  See the License for the specific language governing permissions and
 #  limitations under the License.
 #
+from __future__ import annotations
 
 import humps
 import json
 import inspect
 import ast
 
 from hsfs import util
```

### Comparing `hsfs-3.7.3/hsfs/transformation_function_attached.py` & `hsfs-3.7.4/hsfs/transformation_function_attached.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/usage.py` & `hsfs-3.7.4/hsfs/usage.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/user.py` & `hsfs-3.7.4/hsfs/user.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/util.py` & `hsfs-3.7.4/hsfs/util.py`

 * *Files 2% similar despite different names*

```diff
@@ -9,29 +9,32 @@
 #
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
+from __future__ import annotations
 
 import re
 import json
+from typing import Union
 import pandas as pd
 import numpy as np
 import time
 import threading
 import itertools
 
 from datetime import datetime, date, timezone
 from urllib.parse import urljoin, urlparse
 
 from sqlalchemy import create_engine
 
 from hsfs import client, feature
+from hsfs import feature_group as fg_mod
 from hsfs.client import exceptions
 from hsfs.core import variable_api
 from aiomysql.sa import create_engine as async_create_engine
 import asyncio
 from sqlalchemy.engine.url import make_url
 
 FEATURE_STORE_NAME_SUFFIX = "_featurestore"
@@ -59,15 +62,26 @@
         return [validate_feature(feature_names)]
     elif isinstance(feature_names, list) and len(feature_names) > 0:
         return [validate_feature(feat) for feat in feature_names]
     else:
         return []
 
 
-def feature_group_name(feature_group):
+def autofix_feature_name(name: str) -> str:
+    # replace spaces with underscores and enforce lower case
+    return name.lower().replace(" ", "_")
+
+
+def feature_group_name(
+    feature_group: Union[
+        fg_mod.FeatureGroup,
+        fg_mod.ExternalFeatureGroup,
+        fg_mod.SpineGroup,
+    ],
+) -> str:
     return feature_group.name + "_" + str(feature_group.version)
 
 
 def append_feature_store_suffix(name):
     name = name.lower()
     if name.endswith(FEATURE_STORE_NAME_SUFFIX):
         return name
```

### Comparing `hsfs-3.7.3/hsfs/validation_report.py` & `hsfs-3.7.4/hsfs/validation_report.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs/version.py` & `hsfs-3.7.4/hsfs/version.py`

 * *Files 1% similar despite different names*

```diff
@@ -10,8 +10,8 @@
 #   Unless required by applicable law or agreed to in writing, software
 #   distributed under the License is distributed on an "AS IS" BASIS,
 #   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 #   See the License for the specific language governing permissions and
 #   limitations under the License.
 #
 
-__version__ = "3.7.3"
+__version__ = "3.7.4"
```

### Comparing `hsfs-3.7.3/hsfs.egg-info/PKG-INFO` & `hsfs-3.7.4/hsfs.egg-info/PKG-INFO`

 * *Files 1% similar despite different names*

```diff
@@ -1,16 +1,16 @@
 Metadata-Version: 2.1
 Name: hsfs
-Version: 3.7.3
+Version: 3.7.4
 Summary: HSFS: An environment independent client to interact with the Hopsworks Featurestore
 Home-page: https://github.com/logicalclocks/feature-store-api
 Author: Hopsworks AB
 Author-email: moritz@logicalclocks.com
 License: Apache License 2.0
-Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.3
+Download-URL: https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.4
 Description: # Hopsworks Feature Store
         
         <p align="center">
           <a href="https://community.hopsworks.ai"><img
             src="https://img.shields.io/discourse/users?label=Hopsworks%20Community&server=https%3A%2F%2Fcommunity.hopsworks.ai"
             alt="Hopsworks Community"
           /></a>
```

#### html2text {}

```diff
@@ -1,12 +1,12 @@
-Metadata-Version: 2.1 Name: hsfs Version: 3.7.3 Summary: HSFS: An environment
+Metadata-Version: 2.1 Name: hsfs Version: 3.7.4 Summary: HSFS: An environment
 independent client to interact with the Hopsworks Featurestore Home-page:
 https://github.com/logicalclocks/feature-store-api Author: Hopsworks AB Author-
 email: moritz@logicalclocks.com License: Apache License 2.0 Download-URL:
-https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.3
+https://github.com/logicalclocks/feature-store-api/releases/tag/3.7.4
 Description: # Hopsworks Feature Store
 _[_H_o_p_s_w_o_r_k_s_ _C_o_m_m_u_n_i_t_y_]_[_H_o_p_s_w_o_r_k_s_ _F_e_a_t_u_r_e_ _S_t_o_r_e_ _D_o_c_u_m_e_n_t_a_t_i_o_n_]_[_P_y_P_i_S_t_a_t_u_s_]_[_S_c_a_l_a_/
                 _J_a_v_a_ _A_r_t_i_f_a_c_t_s_]_[_D_o_w_n_l_o_a_d_s_]_[_C_o_d_e_S_t_y_l_e_][License]
 HSFS is the library to interact with the Hopsworks Feature Store. The library
 makes creating new features, feature groups and training datasets easy. The
 library is environment independent and can be used in two modes: - Spark mode:
 For data engineering jobs that create and write features into the feature store
```

### Comparing `hsfs-3.7.3/hsfs.egg-info/SOURCES.txt` & `hsfs-3.7.4/hsfs.egg-info/SOURCES.txt`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/hsfs.egg-info/requires.txt` & `hsfs-3.7.4/hsfs.egg-info/requires.txt`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/setup.py` & `hsfs-3.7.4/setup.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/tests/__init__.py` & `hsfs-3.7.4/tests/__init__.py`

 * *Files identical despite different names*

### Comparing `hsfs-3.7.3/tests/test_storage_connector.py` & `hsfs-3.7.4/tests/test_storage_connector.py`

 * *Files identical despite different names*

